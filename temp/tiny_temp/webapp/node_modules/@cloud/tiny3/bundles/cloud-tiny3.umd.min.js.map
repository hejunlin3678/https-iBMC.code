{"version":3,"sources":["../../../../@cloud/tiny3/utils/TiBrowser.ts","../../../../@cloud/tiny3/utils/TiKeymap.ts","../../../../node_modules/tslib/tslib.es6.js","../../../../@cloud/tiny3/utils/TiLog.ts","../../../../@cloud/tiny3/utils/TiDateUtil.ts","../../../../@cloud/tiny3/utils/TiTheme.ts","../../../../@cloud/tiny3/utils/ObservableMap.ts","../../../../@cloud/tiny3/utils/ObservableSet.ts","../../../../@cloud/tiny3/utils/Util.ts","../../../../@cloud/tiny3/directives/collapse/TiCollapseDirective.ts","../../../../@cloud/tiny3/directives/collapse/TiCollapseModule.ts","../../../../@cloud/tiny3/directives/outline/TiOutlineDirective.ts","../../../../@cloud/tiny3/directives/outline/TiOutlineModule.ts","../../../../@cloud/tiny3/components/icon/TiIconClassComponent.ts","../../../../@cloud/tiny3/components/base/TiBaseComponent.ts","../../../../@cloud/tiny3/components/base/TiFormComponent.ts","../../../../@cloud/tiny3/components/base/TiRadioBaseComponent.ts","../../../../@cloud/tiny3/components/base/TiWholeComponent.ts","../../../../@cloud/tiny3/components/base/TiAutofocusComponent.ts","../../../../@cloud/tiny3/components/base/TiBaseModule.ts","../../../../@cloud/tiny3/components/icon/TiIconComponent.ts","../../../../@cloud/tiny3/components/icon/TiIconModule.ts","../../../../@cloud/tiny3/components/accordion/TiAccordionComponent.ts","../../../../@cloud/tiny3/components/accordion/TiAccordionItemComponent.ts","../../../../@cloud/tiny3/components/accordion/TiAccordionHeadComponent.ts","../../../../@cloud/tiny3/components/accordion/TiAccordionModule.ts","../../../../@cloud/tiny3/utils/Position.ts","../../../../@cloud/tiny3/components/drop/TiDropComponent.ts","../../../../@cloud/tiny3/components/drop/TiDropModule.ts","../../../../@cloud/tiny3/services/popup/TiPopupModule.ts","../../../../@cloud/tiny3/services/popup/TiPopupService.ts","../../../../@cloud/tiny3/services/renderer/TiRendererModule.ts","../../../../@cloud/tiny3/services/renderer/TiRenderer.ts","../../../../@cloud/tiny3/services/tip/TiTipContainerComponent.ts","../../../../@cloud/tiny3/services/tip/TiTipServiceModule.ts","../../../../@cloud/tiny3/services/tip/TiTipService.ts","../../../../@cloud/tiny3/directives/tip/TiTipDirective.ts","../../../../@cloud/tiny3/directives/tip/TiTipModule.ts","../../../../@cloud/tiny3/locale/i18n/zh_CN.ts","../../../../@cloud/tiny3/locale/i18n/en_US.ts","../../../../@cloud/tiny3/locale/i18n/de_DE.ts","../../../../@cloud/tiny3/locale/i18n/es_ES.ts","../../../../@cloud/tiny3/locale/i18n/es_US.ts","../../../../@cloud/tiny3/locale/i18n/fr_FR.ts","../../../../@cloud/tiny3/locale/i18n/pt_BR.ts","../../../../@cloud/tiny3/locale/TiLocale.ts","../../../../@cloud/tiny3/locale/TiTranslatePipe.ts","../../../../@cloud/tiny3/locale/TiLocaleFormat.ts","../../../../@cloud/tiny3/locale/TiLocaleModule.ts","../../../../@cloud/tiny3/components/list/TiListComponent.ts","../../../../@cloud/tiny3/components/list/TiListModule.ts","../../../../@cloud/tiny3/components/menu/TiMenuListComponent.ts","../../../../@cloud/tiny3/components/menu/TiMenuComponent.ts","../../../../@cloud/tiny3/components/menu/TiMenuModule.ts","../../../../@cloud/tiny3/components/actionmenu/TiActionmenuComponent.ts","../../../../@cloud/tiny3/directives/popconfirm/TiPopconfirmComponent.ts","../../../../@cloud/tiny3/components/button/TiButtonComponent.ts","../../../../@cloud/tiny3/components/loading/TiLoadingComponent.ts","../../../../@cloud/tiny3/components/loading/TiLoadingModule.ts","../../../../@cloud/tiny3/components/button/TiButtonModule.ts","../../../../@cloud/tiny3/directives/popconfirm/TiPopconfirmDirective.ts","../../../../@cloud/tiny3/directives/popconfirm/TiPopconfirmModule.ts","../../../../@cloud/tiny3/components/actionmenu/TiActionmenuModule.ts","../../../../@cloud/tiny3/components/alert/TiAlertComponent.ts","../../../../@cloud/tiny3/components/alert/TiAlertModule.ts","../../../../@cloud/tiny3/components/droplist/TiDroplistComponent.ts","../../../../@cloud/tiny3/components/droplist/TiDroplistModule.ts","../../../../@cloud/tiny3/components/text/TiTextComponent.ts","../../../../@cloud/tiny3/components/text/TiTextModule.ts","../../../../@cloud/tiny3/components/autocomplete/TiAutocompleteComponent.ts","../../../../@cloud/tiny3/components/autocomplete/TiAutocompleteModule.ts","../../../../@cloud/tiny3/components/buttongroup/TiButtongroupComponent.ts","../../../../@cloud/tiny3/components/buttongroup/TiButtongroupModule.ts","../../../../@cloud/tiny3/components/checkbox/TiCheckboxComponent.ts","../../../../@cloud/tiny3/components/checkbox/TiCheckboxModule.ts","../../../../@cloud/tiny3/components/checkgroup/TiCheckitemComponent.ts","../../../../@cloud/tiny3/components/checkgroup/TiCheckgroupComponent.ts","../../../../@cloud/tiny3/components/checkgroup/TiCheckgroupModule.ts","../../../../@cloud/tiny3/services/overflow/TiOverflowServiceModule.ts","../../../../@cloud/tiny3/services/overflow/TiOverflowService.ts","../../../../@cloud/tiny3/directives/overflow/TiOverflowDirective.ts","../../../../@cloud/tiny3/directives/overflow/TiOverflowMaxlineDirective.ts","../../../../@cloud/tiny3/directives/overflow/TiOverflowModule.ts","../../../../@cloud/tiny3/components/datedominator/TiDateDominatorComponent.ts","../../../../@cloud/tiny3/components/datedominator/TiDateDominatorModule.ts","../../../../@cloud/tiny3/components/dateedit/TiDateEditComponent.ts","../../../../@cloud/tiny3/components/dateedit/TiDateEditModule.ts","../../../../@cloud/tiny3/components/datebase/TiDateBaseComponent.ts","../../../../@cloud/tiny3/components/datebase/TiDateBaseModule.ts","../../../../@cloud/tiny3/components/datepanel/TiDatePanelComponent.ts","../../../../@cloud/tiny3/components/datepanel/TiDatePanelModule.ts","../../../../@cloud/tiny3/components/date/TiDateComponent.ts","../../../../@cloud/tiny3/components/date/TiDateModule.ts","../../../../@cloud/tiny3/components/daterange/TiDateRangeComponent.ts","../../../../@cloud/tiny3/components/daterange/TiDateRangeModule.ts","../../../../@cloud/tiny3/components/datetime/TiDatetimeComponent.ts","../../../../@cloud/tiny3/components/time/TiTimeComponent.ts","../../../../@cloud/tiny3/components/time/TiTimeModule.ts","../../../../@cloud/tiny3/components/datetime/TiDatetimeModule.ts","../../../../@cloud/tiny3/components/datetimerange/TiDatetimeRangeComponent.ts","../../../../@cloud/tiny3/components/datetimerange/TiDatetimeRangeModule.ts","../../../../@cloud/tiny3/components/dominator/TiDominatorComponent.ts","../../../../@cloud/tiny3/components/tag/TiTagComponent.ts","../../../../@cloud/tiny3/components/tag/TiTagModule.ts","../../../../@cloud/tiny3/components/dominator/TiDominatorModule.ts","../../../../@cloud/tiny3/components/searchbox/TiSearchboxComponent.ts","../../../../@cloud/tiny3/components/searchbox/TiSearchboxNotsearchComponent.ts","../../../../@cloud/tiny3/components/searchbox/TiSearchboxModule.ts","../../../../@cloud/tiny3/components/dropsearch/TiDropsearchComponent.ts","../../../../@cloud/tiny3/components/dropsearch/TiDropsearchModule.ts","../../../../@cloud/tiny3/directives/include/TiIncludeDirective.ts","../../../../@cloud/tiny3/directives/include/TiIncludeModule.ts","../../../../@cloud/tiny3/components/formfield/TiFormfieldComponent.ts","../../../../@cloud/tiny3/components/formfield/TiItemComponent.ts","../../../../@cloud/tiny3/components/formfield/TiItemLabelComponent.ts","../../../../@cloud/tiny3/components/formfield/TiButtonItemComponent.ts","../../../../@cloud/tiny3/components/formfield/TiFormfieldModule.ts","../../../../@cloud/tiny3/components/imagepreview/TiImagepreviewComponent.ts","../../../../@cloud/tiny3/services/modal/TiModalComponent.ts","../../../../@cloud/tiny3/services/modal/TiModalNoAnimationComponent.ts","../../../../@cloud/tiny3/services/modal/TiBackdropComponent.ts","../../../../@cloud/tiny3/services/modal/TiBackdropNoAnimationComponent.ts","../../../../@cloud/tiny3/services/modal/TiModalHeaderComponent.ts","../../../../@cloud/tiny3/services/modal/TiModalBodyComponent.ts","../../../../@cloud/tiny3/services/modal/TiModalFooterComponent.ts","../../../../@cloud/tiny3/services/drag/TiDragServiceModule.ts","../../../../@cloud/tiny3/services/drag/TiDragService.ts","../../../../@cloud/tiny3/directives/drag/TiDraggableDirective.ts","../../../../@cloud/tiny3/directives/drag/TiDraggableModule.ts","../../../../@cloud/tiny3/services/modal/TiModalModule.ts","../../../../@cloud/tiny3/components/imagepreview/TiImagepreviewModule.ts","../../../../@cloud/tiny3/components/ip/TiIpComponent.ts","../../../../@cloud/tiny3/components/ip/TiIpModule.ts","../../../../@cloud/tiny3/components/ipsection/TiIpsectionComponent.ts","../../../../@cloud/tiny3/components/select/TiSelectComponent.ts","../../../../@cloud/tiny3/components/select/TiSelectModule.ts","../../../../@cloud/tiny3/directives/maskinput/TiMaskDirective.ts","../../../../@cloud/tiny3/directives/maskinput/TiMaskModule.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/CheckHandle.ts","../../../../@cloud/tiny3/directives/validation/TiPendingStateComponent.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/AsyncCheck.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/ChangeCheck.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/BlurCheck.ts","../../../../@cloud/tiny3/directives/validation/TiPwdMsgComponent.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/TiPwdConfig.ts","../../../../@cloud/tiny3/directives/validation/TiValidationConfig.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/PwdCheck.ts","../../../../@cloud/tiny3/directives/validation/TiErrorMsgComponent.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/CommonServiceModule.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/CommonService.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/CheckStyleModule.ts","../../../../@cloud/tiny3/directives/validation/checkHandle/CheckStyleService.ts","../../../../@cloud/tiny3/directives/validation/TiValidationDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/TiValidators.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/BaseValidator.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/MaxLengthValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/RangeSizeValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/RangeValueValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/MinLengthValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/EmailValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/NotScriptValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/ContainsValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/NotContainsValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/DateValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/DigitsValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/EqualValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/Ipv4ValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/Ipv6ValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/MaxValueValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/IntegerValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/MinValueValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/NotEqualValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/NumberValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/PasswordValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/PortValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/RegExpValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/UrlValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/validators/directives/RequiredValidatorDirective.ts","../../../../@cloud/tiny3/directives/validation/TiValidationModule.ts","../../../../@cloud/tiny3/components/ipsection/TiIpsectionModule.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuHeadComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuGroupItemComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuGroupComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuItemComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuLevel1Component.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuLevel2Component.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuFootComponent.ts","../../../../@cloud/tiny3/components/leftmenu/TiLeftmenuModule.ts","../../../../@cloud/tiny3/components/table/TiTableFixedHeadServiceModule.ts","../../../../@cloud/tiny3/components/table/TiTableFixedHeadService.ts","../../../../@cloud/tiny3/components/table/TiTableComponent.ts","../../../../@cloud/tiny3/components/table/TiHeadFilterDropComponent.ts","../../../../@cloud/tiny3/components/table/TiHeadFilterComponent.ts","../../../../@cloud/tiny3/components/table/TiHeadSortComponent.ts","../../../../@cloud/tiny3/components/table/TiDetailsIconComponent.ts","../../../../@cloud/tiny3/components/table/TiDetailsTrDirective.ts","../../../../@cloud/tiny3/components/table/TiColspanDirective.ts","../../../../@cloud/tiny3/components/table/TiColsToggleDropComponent.ts","../../../../@cloud/tiny3/components/table/TiColsToggleComponent.ts","../../../../@cloud/tiny3/components/table/TiColsResizableDirective.ts","../../../../@cloud/tiny3/components/table/TiCellTextComponent.ts","../../../../@cloud/tiny3/components/table/TiCellIconsComponent.ts","../../../../@cloud/tiny3/components/table/TiColumnsPipe.ts","../../../../@cloud/tiny3/components/table/TiColumnFixedDirective.ts","../../../../@cloud/tiny3/components/table/TiColClickDirective.ts","../../../../@cloud/tiny3/components/table/TiTableModule.ts","../../../../@cloud/tiny3/components/pagination/TiPaginationComponent.ts","../../../../@cloud/tiny3/components/pagination/TiPaginationModule.ts","../../../../@cloud/tiny3/components/progressbar/TiProgressbarComponent.ts","../../../../@cloud/tiny3/components/progressbar/TiProgressbarModule.ts","../../../../@cloud/tiny3/components/progresspie/TiProgresspieComponent.ts","../../../../@cloud/tiny3/components/progresspie/TiProgresspieModule.ts","../../../../@cloud/tiny3/components/radio/TiRadioComponent.ts","../../../../@cloud/tiny3/components/radio/TiRadioModule.ts","../../../../@cloud/tiny3/directives/scroll/TiScrollDirective.ts","../../../../@cloud/tiny3/directives/scroll/TiScrollModule.ts","../../../../@cloud/tiny3/components/slider/TiSliderComponent.ts","../../../../@cloud/tiny3/components/slider/TiSliderModule.ts","../../../../@cloud/tiny3/directives/inputnumber/TiInputNumberDirective.ts","../../../../@cloud/tiny3/directives/inputnumber/TiInputNumberModule.ts","../../../../@cloud/tiny3/components/spinner/TiSpinnerComponent.ts","../../../../@cloud/tiny3/components/spinner/TiSpinnerModule.ts","../../../../@cloud/tiny3/components/steps/TiStepsComponent.ts","../../../../@cloud/tiny3/components/steps/TiStepsModule.ts","../../../../@cloud/tiny3/components/switch/TiSwitchComponent.ts","../../../../@cloud/tiny3/components/switch/TiSwitchModule.ts","../../../../@cloud/tiny3/components/tab/TiTabsComponent.ts","../../../../@cloud/tiny3/components/tab/TiTabComponent.ts","../../../../@cloud/tiny3/components/tab/TiTabHeaderComponent.ts","../../../../@cloud/tiny3/components/tab/TiTabModule.ts","../../../../@cloud/tiny3/components/tagsinput/TiTagsInputComponent.ts","../../../../@cloud/tiny3/components/tagsinput/TiTagsInputModule.ts","../../../../@cloud/tiny3/components/textarea/TiTextareaComponent.ts","../../../../@cloud/tiny3/components/textarea/TiFormatNumPipe.ts","../../../../@cloud/tiny3/components/textarea/TiTextareaModule.ts","../../../../@cloud/tiny3/components/tree/TiTreeUtil.ts","../../../../@cloud/tiny3/components/tree/TiTreeComponent.ts","../../../../@cloud/tiny3/components/tree/TiHighlightPipe.ts","../../../../@cloud/tiny3/components/tree/TiAutoSelectDirective.ts","../../../../@cloud/tiny3/components/tree/TiTreeModule.ts","../../../../@cloud/tiny3/components/treeselect/TiTreeselectComponent.ts","../../../../@cloud/tiny3/components/treeselect/TiTreeselectModule.ts","../../../../@cloud/tiny3/services/upload/TiUploadUtil.ts","../../../../@cloud/tiny3/components/upload/TiFileSelectDirective.ts","../../../../@cloud/tiny3/services/upload/TiFileItemUtil.ts","../../../../@cloud/tiny3/services/upload/TiUploadServiceModule.ts","../../../../@cloud/tiny3/services/upload/TiUploadService.ts","../../../../@cloud/tiny3/components/upload/TiUploadbaseComponent.ts","../../../../@cloud/tiny3/components/upload/TiUploadComponent.ts","../../../../@cloud/tiny3/components/upload/TiDisabledDirective.ts","../../../../@cloud/tiny3/services/modal/TiModalService.ts","../../../../@cloud/tiny3/components/upload/TiUploadimageComponent.ts","../../../../@cloud/tiny3/components/upload/TiUploadModule.ts","../../../../@cloud/tiny3/services/intro/TiIntromodalComponent.ts","../../../../@cloud/tiny3/services/intro/TiIntrotipComponent.ts","../../../../@cloud/tiny3/services/intro/TiIntroModule.ts","../../../../@cloud/tiny3/services/intro/TiIntroService.ts","../../../../@cloud/tiny3/services/message/TiMessageComponent.ts","../../../../@cloud/tiny3/services/message/TiContentWrapperComponent.ts","../../../../@cloud/tiny3/services/message/TiTranscludeDirective.ts","../../../../@cloud/tiny3/services/message/TiMessageModule.ts","../../../../@cloud/tiny3/services/message/TiMessageService.ts","../../../../@cloud/tiny3/components/zoom/TiZoomComponent.ts","../../../../@cloud/tiny3/components/zoom/TiZoomModule.ts"],"names":["TiBrowser","browser","init","_browser","version","_version","isEdge","EDGE","isIE","IE","isFirefox","FIREFOX","isChrome","CHROME","isOpera","OPERA","isSafari","SAFARI","isOther","OTHER","isInit","aAgentInfo","userAgent","navigator","toLowerCase","match","parseInt","split","TiKeymap","initFirefox","KEY_SEMICOLON","KEY_COLON","KEY_EQUALS_SIGN","KEY_PLUS","KEY_MINUS","KEY_UNDERSCORE","KEY_BACKSPACE","KEY_TAB","KEY_ENTER","KEY_SHIFT","KEY_CONTROL","KEY_ALT","KEY_PAUSE_BREAK","KEY_CAPS_LOCK","KEY_ESCAPE","KEY_SPACE","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_ARROW_LEFT","KEY_ARROW_UP","KEY_ARROW_RIGHT","KEY_ARROW_DOWN","KEY_PRINT_SCREEN","KEY_INSERT","KEY_DELETE","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","KEY_META_LEFT","KEY_META_RIGHT","KEY_CONTEXT_MENU","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_NUMPAD_MULTIPLY","KEY_NUMPAD_ADD","KEY_NUMPAD_ENTER","KEY_NUMPAD_SUBTRACT","KEY_NUMPAD_DECIMAL","KEY_NUMPAD_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F11","KEY_F12","KEY_F13","KEY_F14","KEY_F15","KEY_F16","KEY_F17","KEY_F18","KEY_F19","KEY_F20","KEY_F21","KEY_F22","KEY_F23","KEY_F24","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_COMMA","KEY_LESS_THAN_SIGN","KEY_PERIOD","KEY_GREATER_THAN_SIGN","KEY_FORWARD_SLASH","KEY_QUESTION_MARK","KEY_BACKTICK","KEY_TILDE","KEY_OPENING_SQUACE_BRACKET","KEY_OPENING_CURLY_BRACE","KEY_BACKSLASH","KEY_PIPE","KEY_CLOSING_SQUARE_BRACKET","KEY_CLOSING_CURLY_BRACE","KEY_SINGLE_QUOTE","KEY_DOUBLE_QUOTE","MOUSE_LEFT_BUTTON","MOUSE_MIDDLE_BUTTON","MOUSE_RIGHT_BUTTON","MOUSE_BACK_BUTTON","MOUSE_FORWARD_BUTTON","staticCode","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__rest","s","e","t","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","__values","o","Symbol","iterator","m","next","value","done","TypeError","__read","n","r","ar","push","error","__spread","arguments","concat","TiLog","setLevel","level","log","message","optionalParams","_i","LEVEL_LOG","console","apply","warn","LEVEL_WARN","LEVEL_ERROR","LEVEL_OFF","TiDateUtil","minDate","Date","maxDate","isDate","date","toString","String","changeMaxTime","maxValue","getFullYear","getMonth","getDate","changeMinTime","minValue","isDateEqual","newValue","oldValue","newDate","oldDate","getTime","isDatetimeEqual","isValidNowDateTime","nowDateTime","min","max","isBigger","value1","value2","isBiggerOrEqual","isSmaller","getDateStr","getTimeStr","getHours","getMinutes","getSeconds","isValidMaxValue","isValidMinValue","isBetweenMaxAndmin","addAmPm","timeFormat","addColon","ampm","TiTheme","loadCss","cssPath","id","link","document","getElementById","createElement","head","appendChild","href","rel","type","hasAttribute","removeAttribute","isNativeSupportCssVar","window","CSS","supports","bootstrapModule","app","platformBrowserDynamic","catch","err","ObservableMap","map","Map","handlerSet","Set","defineProperty","size","addObserver","handlerFn","add","removeObserver","delete","notify","key","from","forEach","set","has","get","undefined","getMap","ObservableSet","items","item","isAdd","Util","getUniqueId","prefix","idCounter","isUndefined","isNull","isString","isNumber","isNaN","isEmptyString","isArray","isFunction","formatEntry","source","params","formatSource","param","replace","RegExp","trigger","ele","eventName","canBubble","event","createEvent","initEvent","dispatchEvent","isElement","nodeType","supportsCssVars","focusInDialogOnTabchange","focusableElements","firstFocusableEle","lastFocusableEle","target","shiftKey","focus","preventDefault","TiCollapseDirective","elementRef","renderer","builder","isCollapse","toggleDone","EventEmitter","element","nativeElement","ngOnInit","expandPlayer","build","style","max-height","overflow","animate","ANIMATE_IN","collapsePlayer","ANIMATE_OUT","finish","collapse","expand","ngOnChanges","changes","_this","isCollapseObj","firstChange","currentValue","emit","reset","play","onDone","setStyle","Directive","args","selector","ElementRef","Renderer2","AnimationBuilder","Input","Output","NgModule","imports","CommonModule","exports","declarations","TiOutlineDirective","hostEle","zone","ngAfterViewInit","runOutsideAngular","outlineHostEle","listen","NgZone","hostRef","Component","template","encapsulation","ViewEncapsulation","None","TiBaseComponent","setId","ngDoCheck","ngAfterContentInit","ngAfterContentChecked","ngAfterViewChecked","ngOnDestroy","setProperty","creatId","appendId","suffix","TiFormComponent","_super","tabindex","focusEvent","blurEvent","changeEvent","focusableElems","ngAfterViewCheckedFirst","focusCallbackFn","focusedElem","tiFocusFrom","includes","relatedTarget","setAttr","focusModel","model","blurCallbackFn","activeElement","onModelTouched","getValueAccessor","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","attributes","tiFocused","attr","setAttribute","setDisabledState","autoFocus","ngOnModelChange","setFocusableElems","elems","setFocusElem","setElemsTabindex","setNativeElementFocusFn","setFocusEvents","focusElem","_b","_c","elem","disabled","setTabindex","getFocusableElems","global","blur","focusCancelFns","fn","blurCancelFns","mousedownCancelFns","autofocus","_model","onModelChange","writeValue","registerOnChange","registerOnTouched","isDisabled","tagName","TiRadioBaseComponent","proxyRef","moveNode","removeChild","parentNode","nextSibling","nextNode","insertBefore","labelRef","onHostClick","onHostChange","stopPropagation","onLabelClick","onSpaceKeydown","onSpaceKeyup","canChange","checked","ViewChild","static","HostListener","TiWholeComponent","valueFn","valueKey","_modelWhole","options","filter","find","TiAutofocusComponent","TiIconComponent","nameChange","removeClass","previousValue","addClass","host","[class.ti3-icon]","TiIconClassComponent","TiAccordionComponent","closeOthers","headClass","bodyClass","closeOtherItems","openItem","open","addItem","removeItem","index","splice","[class.ti3-accordion-group]","TiAccordionItemComponent","accordion","clickToggle","headClick","isOpen","toggleOpen","$event","[class.ti3-accordion-panel]","decorators","Inject","TiCollapseModule","TiIconModule","TiOutlineModule","TiAccordionHeadComponent","Position","setPosition","targetEle","position","avilableHeight","curLayout","getLayout","hostEleX","hostSpace","determinPositionFn","determinPosition","browserSpace","elePos","getLayoutParam","hasOffsetFix","hOffset","setLayout","setMaxHeight","fixMaxHeight","setDominatorDropDetachState","hostLayout","addPosChangeEvts","eventCallback","render","eventHandles","eventType","callback","removePosChangeEvts","horizonHostEle","getHostEleLayout","targetLayout","getEleLayout","avilableLayout","getAvilableLayout","layout","isValidPosition","avilableLeft","left","avilableRight","right","avilableTop","top","avilableBottom","bottom","targetMaxWidth","width","targetMaxHeight","height","positionTop","determinHorizon","positionRight","determinVertical","positionBottom","positionLeft","avilableMaxLeft","maxLeft","avilableMaxRight","maxRight","targetWidth","targetCenterWidth","avilableMaxTop","maxTop","avilableMaxBottom","maxBottom","targetHeight","targetMiddleHeight","positionArr","positionFragments","isValidHorizonPosition","isValidVerticalPosition","horizonPosition","verticalPosition","layoutParam","isFixed","pageXOffset","pageYOffset","maxHeight","classList","remove","offsetTop","offsetLeft","getBoundingClientRect","horizonEle","getComputedStyle","body","offsetWidth","offsetHeight","isFixedPos","curBrowseWidth","documentElement","clientWidth","curBrowseheight","clientHeight","nodeName","getHorizionParam","verticalParam","getVerticalParam","posArr","space","offset","getOffsetFixVal","hostHeight","hostLayoutSize","ADAPTIVE_SIZE","TiDropComponent","applicationRef","panelWidth","panelMaxHeight","theme","dominatorSpace","DOMINATOR_SPACE","BROWSER_SPACE","panelAlign","dropSubject","Subject","posHandles","defaultDeterminPositionFn","needHeight","display","unlistenPosition","toggle","isShow","hide","show","appendToBodyFarAway","setShow","setPanelWidth","listenPosition","embeddedViewRef","dropTemplateRef","createEmbeddedView","attachView","rootNodes","dominatorElem","resetPosition","panelWidthNum","scrollWidth","dominatorElemWidth","minWidth","[class.ti3-dropdown-container]","[class.ti3-dropdown-container-border]","[style.height]","ApplicationRef","ContentRef","nodes","viewRef","componentRef","TiPopupService","injector","rendererFactory","componentFactoryResolver","domSanitizer","getContentRef","content","context","TemplateRef","createCompoentRef","componentType","notDetectChanges","location","hostView","HTMLElement","wrapEle","innerHTML","sanitize","SecurityContext","HTML","childNodes","createRenderer","getParentEle","containerOpt","destroyComponentRef","_componentRef","destroy","destroyContentRef","contentRef","_contentRef","contentContext","parentEle","container","markForCheck","detectChanges","changeDetectorRef","tiContentRef","resolveComponentFactory","assign","instance","outputs","subscribe","Injectable","providedIn","TiPopupModule","Injector","RendererFactory2","ComponentFactoryResolver","DomSanitizer","DOCUMENT","TiRenderer","insertAfter","sourceEle","parent","lastChild","hasClass","className","contains","setAttributes","setStyles","styles","prepend","firstElementChild","findChildrenByClassName","children","child","findChildrenByTagName","TiRendererModule","[class.ti3-tooltip]","TiTipContainerComponent","entryComponents","TiTipService","popService","tiRenderer","getVisibleChangeEventName","config","tipInstance","createTip","addTriggerEvent","tipComponentRef","visibleChangeEvtHandle","popInstance","visibilityChangeEvent","hideFn","registerVisibilityChangeEvent","showTip","unlistenMouseenterFn","showFn","showInfo","run","unlistenMouseleaveFn","setTipTheme","setTipWidth","maxWidth","DEFAULT_WIDTH","result","SPACE","hasArrow","querySelector","TiTipServiceModule","TiTipDirective","tipService","hostEleRef","tiTipPosition","tiTipMaxWidth","tiTipHasArrow","tiTipTrigger","isInValidValue","tiTipHostEleX","_tiTip","tiTipContext","exportAs","zh_CN","tiLocaleKey","tiLocaleDate","time","tiCommon","okBtn","cancelBtn","tiActionmenu","more","operation","tiValid","errorMsg","required","maxLength","minLength","rangeSize","rangeValue","regExp","notContains","notScript","equal","notEqual","port","path","email","url","integer","number","digits","ipv4","ipv6","password","minCharType","notEqualPosRev","passwordStrength","securityText","levelDecArr","tiPagination","gotoLabel","prevTitle","nextTitle","totalLabel","tiMessage","prompt","confirm","ok","cancel","tiUpload","addFile","successInfo","uploadingSingleInfo","errorSingleInfo","addSuccessMutiInfo","uploadingMutiInfo","errorMultiInfo","clearAll","upload","reload","autoUploadFilePlaceholder","autoUploadFilesPlaceholder","notAutoUploadFilePlaceholder","notAutoUploadFilesPlaceholder","tiDate","datePlaceholder","datetimePlaceholder","weekNamesAbb","weeknamesTitle","monthNamesAbb","btnSliderArr","yearSuffixLabel","rangeBeginLabel","rangeEndLabel","selectTime","selectDate","hour","minute","second","tiSelect","search","selected","tiTable","colsToggleTip","tiList","selectAll","tiIntro","skip","previous","tiPopconfirm","yesLabel","noLabel","tiTree","loadError","newNode","en_US","de_DE","es_ES","es_US","fr_FR","pt_BR","TiLocale","initWordsAndLocale","getWords","setWords","zh-CN","en-US","de-DE","es-ES","es-US","fr-FR","pt-BR","getLocale","setLocale","ZH_CN","words","tiWords","locale","tiLocale","getLocaleWords","translate","keyValue","keyArr","EN_US","DE_DE","ES_ES","ES_US","FR_FR","PT_BR","TiTranslatePipe","transform","Pipe","name","TiLocaleFormat","getLocaleKey","getLocaleId","DEFAULT_LOCALE","parseNumWithDecimal","isIntegerValid","groupSep","getNumberSymbol","decimalSep","numberFormat","test","NaN","groupReg","decimalReg","numberFormatString","numberFloat","parseFloat","localeNumber","formatNumber","charAt","format","minimumIntegerDigits","substring","minimumFractionDigits","maximumFractionDigits","Intl","NumberFormat","parseNumber","formatTime","timezone","formatDate","TIME_FORMAT","DATE_FORMAT","formatDateTime","dateTime","DATETIME_FORMAT","deleteGroupSep","res","groupSepReg","isInvalidFormat","toUpperCase","Number","slice","TiListComponent","multiple","labelKey","tipPosition","noDataText","hideEmptyOption","showChildren","scrollTop","select","hover","stopBlur","unlistenIEScrollbarBugFns","selectAllText","optionSelectAll","optionScrollTopLastTime","isDisabledFn","_hoverOption","hoverOption","onKeydown","keyCode","selectOption","nextOption","setSelectedAllState","setScrollFn","setHoverOption","scrollTo","onMousedownItem","own","onMouseupItem","onMouseleaveItem","onClickItem","option","isGroup","button","selectAllOptions","listOptions","getListOptions","isChange","selectAllState","isSelectable","insertIndex","getInsertIndex","selectedOptions","selectableOptions","indexOfList","onMouseenterItem","SCROLL_TOP_TIME","isUp","unshift","x","curIndex","optionScollTop","scrollToSelected","selectedItem","scrollToEle","_a","hasSelectedinList","getHoverOptionInModel","getGroupHoverOption","listOption","groupHoverOption","isScrollBySelected","ulRef","scrollTopOptionIndex","Math","getElementsByTagName","isSelected","listenIESrollbarBug","unlistenIESrollbarBug","_d","_e","providers","ContentChild","TiTipModule","TiMenuListComponent","hasBorder","indexPre","groupId","TiMenuComponent","panelMaxWidth","beforeOpen","itemsArr","mytoggleRef","itemTemplate","firstTemplate","tipTemplate","initListMaxHeight","dropComs","first","listComs","restyleListMaxHeight","toArray","listCom","close","onHover","onMousedown","onKeydownLastHoverList","observers","onSelect","panelIndex","onBlur","dropComArr","listComArr","setTimeout","currentPanel","nextPanel","leftOffset","itemIndex","itemElmTop","bottomOffset","itemHeight","nextPanelTop","onMouseoutDrop","dropRect","clientX","clientY","menulistMaxHeight","dropCurMaxHeight","(blur)","ViewChildren","TiDropModule","TiActionmenuComponent","iterableDiffers","keyValueDiffers","showDivider","maxShowNum","panelItems","halfSpace","needInitItems","localeWords","moreText","menuText","isEqualOffsetTop","elem1","elem2","abs","data","dataDiffer","diff","dataToItemsFn","itemsDiffer","initItems","itemElems","getElementsByClassName","dividingElems","menuElem","menuCom","moreTextElem","menuTextElem","setDisplay","firstChildrenIndex","focusItems","outShowNum","Promise","resolve","then","trackByFn","[style.max-width]","IterableDiffers","KeyValueDiffers","TiPopconfirmComponent","yesText","noText","offsetParent","[class.ti3-popconfirm-container]","[tabindex]","TiButtonComponent","color","icon","onlyIcon","loading","[class.ti3-btn-primary]","[class.ti3-btn-danger]","[class.ti3-btn-icon]","[class.ti3-btn-onlyIcon]","[class.ti3-btn-large]","[class.ti3-btn-middle]","[class.ti3-btn-small]","[class.ti3-btn-xs]","[class.ti3-btn-loading]","TiLoadingComponent","getBorderWidth","TiLoadingModule","TiPopconfirmDirective","tiTipService","popoverComponentRef","focusableElementsString","tipConfig","hostElement","addClickEvent","unlistenClick","unListenDocumentKeydown","tipElement","showPopandFocus","which","clickTab","dialogModalEle","querySelectorAll","popContainerEle","destroyPopover","dismiss","TiLocaleModule","TiButtonModule","TiMenuModule","TiPopconfirmModule","TiAlertComponent","typeIcon","closeIcon","triggerScroll","darkTheme","boxShadow","openChange","dismissOnTime","clearTimeout","triggerScrollEvent","timeoutId","dismissOnTimeout","TiDroplistComponent","defaultListMaxHeight","heightExcludeList","footerHeight","isShowAfterSelect","dominatorLastBottom","dominatorLastLeft","listenKeydown","unlistenKendown","dropCom","rePosition","unlistenKeydownFn","optionsChange","footerElemRef","rect","dropMaxHeightAdapted","dropMaxHeight","computedListMaxHeight","nextLevel","SEARCHBOX_EXCLUDE_HEIGHT","FormsModule","TiListModule","TiTextComponent","formControl","clear","isPassword","isFirstFocus","hasClear","lastIsHover","lastDisabled","isVisible","isNoEye","handleMousemove","isShowClear","isClearActive","isIconField","setClearBackgroud","handleMouseout","handleMousedown","handleClick","controlEyeShow","isNoBorder","initFn","handlePassword","autocomplete","controlClearShow","valueChanges","pwdHackEle","handleFocus","setSelectionRange","isHover","urlStr","colorStr","varName","getPropertyValue","styleName","trim","parentElement","lastIsShowClear","removeStyle","iconWidth","PASSWORD_WIDTH","CLEAR_WIDTH","[class.ti3-text-input-show-icon]","[class.ti3-text-input-show-clear]","[class.ti3-text-input-show-password]","[class.ti3-text-input-noborder]","(focus)","NgControl","TiAutocompleteComponent","placeholder","clearable","suggest","suggestions","isFocused","lastSuggestions","inputChangeObserve","textComp","createInputChangeObserve","inputChangeSub","unsubscribe","onInputChange","onDroplistChange","label","onFocus","isInputClear","showSuggestions","dropListComp","onInputMousedown","onClear","pipe","debounceTime","switchMap","empty","setSuggestions","searchWord","searchResult","[class.ti3-autocomplete-container]","TiDroplistModule","TiTextModule","TiButtongroupComponent","renderer2","deselectable","multiline","actClass","activeClass","focusElements_1","btns","supTemplate","isSuperScript","sup","class","text","setActiveClass","hasSelected","onClick","selectItem","modelWhole","is","[class.ti3-button-group-bottom-space]","ChangeDetectorRef","TiCheckboxComponent","lastIndeterminate","indeterminate","lastChecked","TiCheckitemComponent","globeCheckedMapObserverItemFn","globeCheckedMap","beCheckedSet","getValue","initBeCheckedSet","initGlobeCheckedSetItem","setCheckedItem","isFirstChange","deleteGlobeRef","setDisabledStateGlobe","globeDisabledSet","beCheckedsChanges","beCheckedsDiffer","beCheckeds","forEachAddedItem","record","forEachRemovedItem","tiCheckbox","TiCheckgroupComponent","checkedsChange","disabledSet","globeCheckedMapObserverFn","checkedMap","globeDisabledSetObserverFn","checkAll","initCheckedMap","initGlobeCheckedMap","initDisabledSet","setChecked","itemsChanges","checkedsChanges","checkedsDiffer","checkeds","getItem","isChecked","newItem","getCheckedStatus","checkedableNum","isTotalCount","checkedNum","notCheckedNum","obj","TiOverflowService","whiteSpace","textOverflow","generateTip","isOverflow","eleStyles","cloneEle","cloneNode","fontSize","fontWeight","fontFamily","padding","paddingLeft","paddingRight","border","boxSizing","visibility","toFixed","textWidth","hostEleConfig","tipHostEle","tipHostEleX","tipMaxWidth","tipContent","textContent","TiOverflowServiceModule","TiOverflowDirective","overflowService","overflowRef","tiTipContent","TiOverflowMaxlineDirective","maxLine","iconTip","character","iconFocusable","iconDisabled","iconClick","shaveTextFn","fontHtml","iconName","multiLineHeight","insertAdjacentHTML","setEvents","isShave","charHtml","middle","spanEle","windowResizeListener","listenFns","icontipInstance","clickIconEle_1","TiDateDominatorComponent","onIconClearClick","onMouseenter","showClear","onMouseleave","(mouseenter)","(mouseleave)","[class.ti3-date-dominator-container]","TiOverflowModule","TiDateEditComponent","inputValue","MAX","MIN","formatValue","inputRef","validateFormat","validateMinAndMax","setPlacehoderText","oldMinvalue","oldMaxvalue","englishFormatArr","formatPureArr","filterEmptyFn","placehoderText","oldModel","oldInputvalue","handleInputValue","getValidModel","isValidValue","maxTimeChanged","minTimeChanged","dateValue","reg","dateArr","formatArr","arr","totalDays","isDisabledDays","disabledDays","HostBinding","TiDateBaseComponent","clearIcon","isBeginFixed","isEndFixed","isAllowBeginEqualEnd","okClick","dayClick","defaultValue","begin","end","datePanel","datePanelWidth","daterangePanelWidth","focusedPosition","timeplaceholder","hasCustomizeTime","focusElementsArr","keydownHandlerFn","hidePanel","dominatorCom","tabKeydown","getFocusElements","focusComs","focusElements","focusCom","responseEnter","isRange","customizeOptions","isDatetime","documentKeydownListener","dateEditComs","textComs","textCom","buttonComs","_f","buttonCom","focusChanged","panelFocusElementsArr","onShowClick","isClearClick","setPickerDate","last","customizeTimeClickFn","val","selectTimeFn","timeEditDisabled","selectDateFn","dateEditClick","dateEditFocus","timeFocus","setTimeFn","beginTime","endTime","endTimeArr","timePosition","timeOption","beginTimeArr","join","oldBeginValue","oldEndValue","hideDrop","setInputStyle","isValidDatetimeFormat","dateCofig","maxChanged","minChanged","validateDatetimeFormat","validateDateFormat","rangeValueIsEqual","setModel","setFormat","oldFormat","setOkBtnState","setBeginTimeMaxValue","setBeginTimeMinValue","setEndTimeMaxValue","setEndTimeMinValue","TiDatePanelComponent","drop","valueChange","picker","pickerChange","dayArr","nextdayArr","monthArr","endpanelMonthArr","yearArr","endpanelYearArr","pickerValue","nextPickerValue","hourOptions","setOptions","minuteOptions","secondOptions","endHourOptions","endMinuteOptions","endSecondOptions","isChinese","local","weekArr","weekTitleArr","yearText","setValue","setDatePanel","beginTimeStrArr_1","beginHour","beginMinute","beginSecond","endTimeStrArr_1","endHour","endMinute","endSecond","timeHandleFn","beginHourContainerRef","beginMinuteContainerRef","beginSecondContainerRef","endHourContainerRef","endMinuteContainerRef","endSecondContainerRef","beginTimeArr_1","endTimeArr_1","onPreYearClick","isPickerYearMinValue","year","minValueRange","getYearRange","currentYearRange","setYearMonthText","setYearRangePreNextState","setYearArr","setEndpanelYearArr","isSmallerThanMinMonth","month","setPreNextState","setDayMonthArr","onPreMonthClick","isMinMonth","setDayArr","setNextDayArr","onNextMonthClick","isMaxMonth","isBiggerThanMaxMonth","onNextYearClick","isPickerYearMaxValue","maxValueRange","onHeadTextClick","onDayClick","isNext","day","state","dateSelect","JSON","parse","stringify","onMonthClick","isEndClick","onYearClick","setMonthArr","setEndpanelMonthArr","today","isBiggerThanMaxDay","isSmallerThanMinDay","isDisabledDay","isFixedWithDisabled","start","isEqualToMaxMonth","isEqualToMinMonth","isMaxYear","isMinYear","preMonthDayState","getDay","preMonthStart","dayNum","j","isEqualToValue","isBetweenInRange","isToday","isEqualToToday","nextMonthDayState","k","q","sss","yyy","isOutInRange","curValue","beginVal","endVal","beginV","endV","isEqualValue","beginValue","endValue","innerMonth","isMonth","isMaxYearRange","isMinYearRange","minDateRange","innerYear","preYearRange","isYear","nextYearRange","num","pos","endTimeDisabled","beginTimeDisabled","TiDateComponent","setInputValue","onKeydownFn","[class.ti3-date-input-container]","TiDateEditModule","TiDatePanelModule","TiDateDominatorModule","TiDateRangeComponent","dateEditBlur","onOkClick","inValidValue","isValidRange","startDate","endDate","isBeginSmallorEqualEnd","[class.ti3-date-range-input-container]","TiDatetimeComponent","dateStr","setBeginTime","datetimeStr","editBlur","setTime","setTimeValue","setTimeMaxValue","setTimeMinValue","inputvalue","timeBlur","handleTimeValue","timeKeydown","dateReg","isNotInteger","timeArr","datetime","dateVal","isValidTime","[class.ti3-datetime-input-container]","TiTimeComponent","timeValue","timePanelWidth","buttonDisabled","oldInputValue","addZero","zeroNum","substr","verifyTime","newVal","isSmallerOrEqual","initVariable","validateMaxAndMin","showTimeWithFormat","setTimeOptions","onlyHour","onlyHourMinute","setDisableData","containerRef","inputEle","buttonEle","setSelectVal","getScrollData","hourScroll","minuteScroll","secondScroll","okClickFn","title","selectedHour","selectedMinute","selectedSecond","newtimeArr","hourVal","minuteVal","secondVal","getSelectedVal","onInputChangeFn","timeKeydownFn","maxArr","minArr","minuteItem","secondItem","validateValue","formatStr","[class.ti3-time-container]","TiTimeModule","TiDatetimeRangeComponent","oldBegintimeValue","oldEndtimeValue","dominatorFormat","beginDateStr","endDateStr","newModel","setDatePanelOptions","validTime","beginDateTime","endDateTime","timeVal","beginDateVal","isSmallerThanMin","beginDate","isBeginSmallerThanEnd","endDateVal","isBiggerThanMax","firstChild","setBeginTimeOptions","setEndTimeOptions","setBeginTimeValue","setEndTimeValue","inputvalue1","[class.ti3-datetime-range-input-container]","TiDominatorComponent","buttonStyle","selectedTipPosition","dropshow","showSelectedNumber","isMouseIn","placeholderTemplate","onDelete","onClickClear","focused","[class.ti3-select-dominator-container]","[class.ti3-multiselect-container]","TiTagComponent","onClickDelete","[class.ti3-multiselect-box-cell]","[class.ti3-multiselect-option-disabled]","[style.maxWidth]","TiTagModule","TiSearchboxComponent","trimmed","onInputEnter","isSearchWithHoverOption","onSearch","searchValue","trimValue","[class.ti3-searchbox-container]","TiSearchboxNotsearchComponent","TiDropsearchComponent","searchable","beforeSearch","oldSearchable","focusableElemsInSearch","focusableElemsInPagination","searchWordChange","searchboxCom","focusableElemsChange","pagination","updateFocusableElems","hideWithoutFocus","hasBeforeSearchObservers","searchResult_1","group","searchKeys","searchKey","setSearchResult","TiSearchboxModule","TiIncludeDirective","tiInclude","node","createText","TiFormfieldComponent","changeDetector","colsNumber","colsGap","verticalAlign","colsWidth","textType","btnItems","groupedItems","colsNum","itemTotal","isVertical","setColsNumber","setFieldStyle","containterObj","vertical-align","isSupportGrid","useGrid","labelWidth","calcWidth","margin-left","addCntItem","sort","a","chunkArray","removeCntItem","addBtnItem","removeBtnItem","array","rowspanNums_1","onegroup_1","colIndex_1","rowspan","colspan","gapWidth","COLS_GAP","getRequire","hasRequire","groupedItem","contentStyle","hasLabel","TiItemComponent","formfield","labelParm","setItemLabel","decorateItem","showObj","detach","verticalAlignObj","labelStyle","textLineHeight","itemStyle","grid-area","itemLabel","TiItemLabelComponent","TiButtonItemComponent","btnContent","btnColspan","TD_NUM_PER_ITEM","TiIncludeModule","TiImagepreviewComponent","sanitizer","fileList","showFileName","addImgLoadListener","toNext","toPrevious","imgTemplate","onload","imgHeight","switchBtnTemplate","animateStyle","TiModalComponent","_showState","preventEvent","onhashchange","modalInstance","_remove","onResize","closeOnEsc","dismissModal","onTabChange","onTiScroll","dragOptions","handle","drag","opts","eleRect","helper","minLeft","scrollLeft","minTop","onAnimationDone","toState","reStyleModal","focusInModal","draggable","headerAlign","modalHeaderEle","modalHeaderHeight","modalFooterEle","modalFooterHeight","modalBodyMaxHeight","MODAL_MAX_HEIGHT","focusEle","modalEleRef","focusableElementList","getFocusableElesInModal","focusableListLength","contentEle","elements","tababbleSelector","animations","opacity","transition","TiModalNoAnimationComponent","TiBackdropComponent","TiBackdropNoAnimationComponent","[class.ti3-modal-header]","[class.ti3-modal-body]","[class.ti3-modal-footer]","TiDragService","originalPagePos","originalPos","mouseMoveEvt","mouseUpEvt","mouseStart","pageX","pageY","triggerEvt","evt","onMouseMove","onMouseUp","topPos","axis","leftPos","evtType","ret","TiDragServiceModule","TiDraggableDirective","dragService","tiDragDisabled","tiDraggable","dragInstance","TiDraggableModule","TiModalHeaderComponent","TiModalFooterComponent","TiModalBodyComponent","TiModalModule","TiIpComponent","pasteHandle","pasteValue","getData","clipboardData","unmaskpaste","unmask","isValidIP","updateValue","ipsValues","splitToIPArray","blurHandle","ipValue","generateIPValue","fixedVaule","blurFixed","mask","getGlbInfo","ver","ip","joinToIPValue","ipv6Version","ipv4Version","ipValueArray","ipInputs","isInputting","keydown","keydownHandle","input","change","ipValues","separator","ipv4Reg","ipv6Reg","ipInfo","part","partLength","partNumber","partItem","iPInfo","placeReg","cellArray","ipvCheckReg","thisInput","nextCell","prevCell","isMoveToNext","caret","isMoveToPrevous","isFullToNext","checkIpv4MoveToNext","checkIpv6MoveToNext","isRightToNext","isNumeric","isHexaDecimal","ctrlKey","code","el","createTextRange","range","moveEnd","moveStart","createRange","duplicate","lastIndexOf","selectionStart","selectionEnd","fill","[class.ti_input_ip_container_ipv4]","[class.ti_input_ip_container_ipv6]","(paste)","TiIpsectionComponent","fb","controls","maskInput","formGroup","ipArray","this_1","configs","FormControl","addControl","updateIpValue","initIpValue","onChange","this_2","setValidators","validationRules","disable","enable","[class.ti3-ipsection-container]","FormBuilder","TiSelectComponent","dropsearchCom","firstTemplateEle","selectedTemplate","footerTemplate","wantOpen","onClickDominator","onDeleteDominator","onClearDominator","onBeforeSearch","getSearchWord","[class.ti3-select-small]","TiDominatorModule","TiDropsearchModule","TiMaskDirective","composing","getClearValue","formatNumLen","clearValue","valueCharPos","formatChar","clearValueLen","valueCharPosOffset","len","NUM_SIGN","modelValue","getAntiFormatValue","onChangeFn","handleInput","parser","handleCompositionStart","handleCompositionEnd","onTouched","formattedValue","setCtxPos","ctxPos","initCtxPos","setCharPos","valueChar","setPosWithNum","setPosWithoutNum","valueLen","ctxPositon","DefaultValueAccessor","(input)","(compositionstart)","(compositionend)","CheckHandle","validationConf","commonHandle","onStatusChange","destroyTip","TiPendingStateComponent","validElement","[class.ti3-validation-pending-container]","ChangeCheck","_checkHandle","errors","control","pristine","untouched","_addTip","tip","_addValidTip","tipContentDom","getErrorMsg","AsyncCheck","clearValidMsg","ruleErrors","keys","tiAsyncErrorMessage","addValidMsg","onAsyncStatusChange","pending","addPendingIcon","clearPendingIcon","tiPendingStateRef","pendingStateRef","getPendingStateRef","pendingDom","_tiRenderer","_tiPopupService","BlurCheck","addTip","TiPwdMsgComponent","msgModel","msgItems","securityStatus","_getPwdStrengthLan","_getMsgItems","msgObj","validStatus","msgInfoArr","msgItem","msg","_getValidStatus","_getLevel","validator","levelFn","TiPwdConfig","pwdLevelFn","validatorParam","minCharLength","minCharTypeNumber","charTypeRegObject","specialCharReg","lowerCharReg","upperCharReg","digitsCharReg","rangeSizeParams","minCharTypeParams","minCharLen","minCharTypeNum","charTypeRegObj","getValidatorParam","pwdScore","lastIndex","score","psdLen","psdType","str","typeNum","getCharType","pwdLevel","levelHandle","countLevel","pwdTipPostion","pwdTipMaxWidth","pwdCharTypeRegObj","pwdValidator","rule","TiValidationDefaultConfig","PwdCheck","common","pwdConfig","passwordConfig","_setValidator","_setMsgItems","_setLevelFn","updateValueAndValidity","pwdValidatorConfig","msgStr","validatorConfig","msgConfig","paramsConfig","getMsg","inputsObj","configAssigned","TiErrorMsgComponent","[class.ti3-unifyvalid-error-container]","[class.ti3-unifyvalid-tip-error-container]","CommonService","_renderer","_tipService","_getSourceStr","ruleKey","isAsync","errMsgConf","errorMessage","tiErrorMessage","_getErrorStr","values","messageStr","isAppendBody","tiValidTip","tipEle","errorDom","errorMessageWrapper","errMsgDom","CommonServiceModule","CheckStyleService","commonService","createHandler","resultType","CheckStyleModule","TiValidationDirective","checkStyleFactory","eleNative","_setHandleFn","formStatusSubscription","statusChanges","_validationHandleFn","asyncValidator","asyncFormStatusSubscription","debounce","timer","ASYNC_DEBOUNCE_TIME","_markAsFocus","_markAsBlur","validationConfig","tiValidation","TiValidators","isEmptyInputValue","Validators","requiredLength","actualLength","requiredMinLength","requiredMaxLength","requiredMaxValue","actual","requiredMinValue","pattern","regexStr","regex","requiredPattern","actualValue","nullValidator","EMAIL_REGEXP","contain","requiredContains","requiredNotContains","requiredEqual","requiredNotEqual","SCRIPT_REGEXP","DIGITS_REGEXP","PORT_RANGE","URL_REGEXP","INTEGER_REGEXP","NUMBER_REGEXP","IPV4_REGEXP","IPV6_REGEXP","regExpToString","regExpStr","charRegObj","checkValidNum","replacedValue","getControlFn","refreValue","reverse","pValue","rangeSizeParamArr","minCharTypeParamArr","validatorComposeArr","arrayOfErrors","validators","v","_executeValidators","reduce","resource","check","form","updateValueAndValidityConfig","checkedErrors","markAsTouched","BaseValidator","enabled","_validator","getDirectiveConfig","validatorClass","NG_VALIDATORS","getValidatorStr","_createValidator","_onChange","validate","c","registerOnValidatorChange","validatorStr","baseValue","MaxLengthValidatorDirective","NAME","RangeSizeValidatorDirective","RangeValueValidatorDirective","MinLengthValidatorDirective","EmailValidatorDirective","NotScriptValidatorDirective","ContainsValidatorDirective","NotContainsValidatorDirective","DateValidatorDirective","DigitsValidatorDirective","EqualValidatorDirective","Ipv4ValidatorDirective","Ipv6ValidatorDirective","MaxValueValidatorDirective","IntegerValidatorDirective","MinValueValidatorDirective","NotEqualValidatorDirective","NumberValidatorDirective","PasswordValidatorDirective","PortValidatorDirective","RegExpValidatorDirective","UrlValidatorDirective","RequiredValidatorDirective","TiMaskModule","TiSelectModule","ReactiveFormsModule","TiValidationModule","TiLeftmenuComponent","router","activeRoute","activeChange","reloadState","reloadStateChange","routable","toggleable","collapsed","collapsedChange","level1Items","resolvedPromise","isUrlChange","isDefaultActiveChildRoute","getScrollbarSize","urlActiveItem","getActiveItemByUrl","active","navigationSubscription","events","NavigationEnd","newActiveItem","panelContainer","headCloneElement","headElement","activeObj","level1Item","setShowChildren","setActiveState","toggleClickFn","resultItem","arr_1","arr_1_1","component","isActived","relativeRoute","getRelativeRoute","routerExtras","isMatchCurrentUrl","routerList","itemUrlTree","createUrlTree","isActive","navigate","routeConfig","rootUrl","routerState","snapshot","getNavigationExtras","triggerReload","relativeTo","direction","outerDiv","innerDiv","field","noScrollSize","withScrollSize","[class.ti3-leftmenu-container]","[class.ti3-leftmenu-hide]","Router","Optional","ActivatedRoute","[class.ti3-leftmenu-head]","TiLeftmenuGroupComponent","expanded","clickGroup","hasActivedChild","level1","hasActivedChildren","[class.ti3-leftmenu-group-container]","[class.ti3-leftmenu-level1-label]","TiLeftmenuLevel1Component","leftmenu","changeRef","leftmenuGroup","groupIndex","selectFn","openHref","oldactive","hasChildren","level2","onStateIconClick","leftmenuItem","newTab","URL","opener","[class.ti3-leftmenu-level1]","[class.ti3-leftmenu-level1-dividing]","TiLeftmenuItemComponent","TiLeftmenuLevel2Component","level2Ele","[class.ti3-leftmenu-level2]","[class.ti3-leftmenu-level2-active]","[attr.tabindex]","[id]","(click)","(keyup.enter)","TiLeftmenuFootComponent","tiLeftmenu","templateDom","panelDom","spaceRight","[class.ti3-leftmenu-foot]","TiLeftmenuHeadComponent","TiLeftmenuGroupItemComponent","TiTableFixedHeadService","getTheadContainer","getTbodyContainer","theadContainer","tbodyContainer","nextElementSibling","processOverflowY","tableCom","headTable","scrollBarWidth","getScrollBarWidth","isOverflowedY","overflowedResult","isOverflowedX","fixheadFiller","fillerWidth","fixedColumnInfo","thFixedRight","headerFiller","removeTbodyContainerBorderBottom","displayedData","tbody","hasNodataTbody","hasNodataGuideTbody","hasLoadfailTbody","hasNodataSimpleTbody","noBorderTerm","isNum","containerSize","tbodySize","tbodyTable","numRound","processYScrollStateChange","colsResizableDire","resizableOpts","ths","newYScrollState","yScrollState","newXScrollState","lastColIndex","lastTh","lastThWidth","storedSizes","xScrollState","storeTableWidthChange","isfirstYScrollStateChange","getMaxWidthTh","getAttribute","setWidth","secondThs","hasFixedColumn","processFixedColumn","updateStoredSizes","sortedThs","th","notResizableAttr","isLastColumn","indexA","indexB","handleYOverflowedWithX","isYOverflowedWithX","handleYNotOverflowedWithX","scrollBarWidthX","scrollBarWidthY","overflowedHeight","overflowedWidth","temporaryDiv","nestDiv","noScrollWidth","noScrollHeight","scrollHeight","decimal","TiTableFixedHeadServiceModule","TiTableComponent","fixedHeadService","srcData","DEFAULT_SRC_DATA","storageConfig","displayedDataChange","columns","searchWords","closeOtherDetails","stateUpdate","promise","enableSort","paginationSubject","viewInitSubject","containerScrollXChangeSubject","thResizeSubject","updateFixedThLeftSubject","updateFixedTdLeftSubject","updateColumnsSubject","dataState","sortKey","asc","currentPage","itemsPerPage","isDataStateChange","oldSearchWords","oldSearchKeys","oldPagination","oldSort","searchedResult","isFixedHead","oldTbodyHeight","compareTo","v1","v2","customCompareFn","doCompare","predicateValueObj","isMatched","testStr","keywords","searchByOneWord","src","output","searchKeys_1","searchKeys_1_1","searchByMoreThanOneWord","getSearchedData","inputData","outData","getPredicateValue","predicate","getPredicateValueObj","resultVal","resultValue","safeCopy","isValueEqual","srcDataDiffer","storageId","initStorageDataState","initFixedHead","addFixedColumnBehavior","unlistenWindowBeforeunload","updateStorageDataState","dataArr","updateSafeCopy","data2displayed","triggerEvent","updateTable","getTbodyHeight","processYScrollStateChangeWithColsResizable","containerWidth","unlistenFixedHeadWindowResize","unlistenFixedColumnWindowResize","sessionStorageState","sessionStorage","localStorageState","localStorage","setItem","updatePagination","updateSort","isDefaultSort","compareFn","getDataState","getTriggerEvent","getSearchedResult","isFrontPagination","isFrontSort","isFrontSearch","dataProcessor","totalNumber_1","totalNumber","getSortedData","srcState","getSrcState","searched","sorted","paginated","resultArr","compareArr","predicateValue","closeOtherDetailsFn","currentRow","row","isRightColumnFloat","[class.ti3-table]","TiHeadFilterDropComponent","heightExcludeContent","buttonHeight","btnContainerMousedown","cancelClick","TiHeadFilterComponent","filterIconEleRef","outlineStyle","[class.ti3-head-filter-container]","TiHeadSortComponent","table","clickNum","isDesc","[class.ti3-sort-container]","[class.ti3-sort-ascent]","[class.ti3-sort-descent]","TiDetailsIconComponent","beforeToggle","oldShowDetails","showDetails","parentTr","TABLE_ClASS_DETAIL_BASE","ceil","TiDetailsTrDirective","templateRef","viewContainerRef","updateView","detailTr","previousSibling","ViewContainerRef","TiColspanDirective","tableFirstTr","MutationObserver","firstTrObserver","mutationsList","mutationsList_1","mutationsList_1_1","observe","childList","disconnect","TiColsToggleDropComponent","listLabelKey","optionsChangeInner","DROP_VERTICAL_PADDING","SEARCHBOX_AREA_HEIGHT","LIST_WITH_SEARCHBOX_MAX_HEIGHT","DEFAULT_LIST_MAX_HEIGHT","columnsDiffer","selectedColumns","column","onMousedownSearchBoxOuter","[class.ti3-cols-toggle-drop-container]","TiColsToggleComponent","shouldUpdateFocusableElems","tiTip","setDropPanelWidth","toggleMenuEleRef","MAX_PANEL_WIDTH","MIN_PANEL_WIDTH","DEFAULT_PANEL_WIDTH","[class.ti3-cols-toggle-container]","TiColsResizableDirective","wrap","mouseXPosition","storedSortEleSizes","isDragStart","isColumnsInit","ti-visible-index","getWidth","getThs","subscription","processColsResizable","initStorageColsWidth","columsDiffer","setDefaultWidth","documentMouseMoveListener","documentMouseUpListener","setTableWidthChange","getTable","thead","secondTable","getSecondTable","overflowedX","overflowedY","currentTh","thWidth","round","COL_BORDER_RANGE","createDividingLine","removeDividingLine","updateTableInfo","toggleTextSelection","tableContainer","mouseMove","stopResize","curColIndex","colWidth","leftEdge","getColMinWidth","thElement","sortEle","iconsEle","headFilterEle","tableContainerClassName","bodyTable","tr","needDividingLine","td","setComputedWidth","classes_1","classes_1_1","secondTableContainer","UNSELECTABLE_CLASS","TiCellTextComponent","setMaxWidth","otherWidth","iconsContainer","sortContainer","headFilterContainer","renameContainer","cellTextEle","[class.ti3-cell-text-container]","[class.ti3-cell-icons-container]","TiColumnsPipe","TiColumnFixedDirective","columnFixedLeftLast","floatingFixedColumn","firstAfterViewChecked","notSupportBrowser","addBehavior","containerScrollXChangeSubscription","thResizeSubscription","updateFixedThLeftSubscription","updateFixedTdLeftSubscription","processTh","processTd","scrollInfo","processLastFixedColumn","thResizeInfo","siblings","changeColumnsIndex_1","fixedColumnLeftValues","needFixedColumnTr","columnIndex","tdLeft","columnFixedLeftLastIndex","current","[class.ti3-table-column-fixed-right]","[class.ti3-table-column-fixed-left]","TiColClickDirective","checkboxLabelEle","radioLabelEle","click","TiCellIconsComponent","TiPaginationComponent","totalNumberChange","currentPageChange","showTotalNumber","showGotoLink","autoHide","showLastPage","pageNumChange","pageUpdate","mini","gotoPage","hidePage","defaultPageSize","makePage","initData","renderPage","isWithTable","verifyCurrentPage","updateFromStorage","currentPageObj","totalNumberObj","pageSize","oldSize","oldTotalNumber","oldSelected","oldCurrentPage","setTotalNumberFormat","getFormatedSize","isStorageCurrentPage","isStorageItemsPerPage","currentPage_1","itemsPerPage_1","configMini","page","pages","getPages","formatTotalNumber","sizeConfig","syncPageSize","pageSizeNum","noPrevious","MIN_PAGE","noNext","totalPageNum","isEllipse","onSizeChange","selectPage","selectedPage","calculateTotalPages","totalPages","itemsMini","startAndEndPage","getInterval","startPagNum","endPagNum","restPageNum","triggerPageUpdate","enterPageHandler","gotoPageHandler","onPrevClick","onPageClick","onNextClick","ngModelChange","newPage","[class.ti3-page-container]","[class.ti3-pag-container-disable]","[attr.unselectable]","TiProgressbarComponent","progressClass","animation","verifyNum","calcPercentage","setChanges","changeKey","oldVal","_newValue","percent","[class.ti3-progress]","TiProgresspieComponent","defaultConfig","lineWidth","draw","canvasElement","canvasEle","calcPercent","drawProgressPie","canvas","ctx","getContext","clearRect","cx","cy","startPoint","PI","fillStyle","strokeStyle","beginPath","arc","stroke","endPoint","moveTo","lineTo","closePath","TiRadioComponent","TiScrollDirective","TiSliderComponent","step","tipMode","changeStop","isDouble","isTipAutoShow","hostMousedownEvent","stepSliderFromClick","tipMouseoverHandle","tipMouseleaveHandle","firstTickX","trackELe","pointerMaxEleWidth","pointerX","limitValue","getBarWidth","positionToValue","pointer","pointerMaxEle","valueMin","splitValueToArray","midValue","valueMax","pointerMinEle","isMinPointerActive","getStepValue","valueToPosition","dragStartHandle","ui","dragStartModel","dragHandle","dragCommonHandle","setTip","dragStopHandle","isLimitExceed","translateScales","scaleFormat","tickArray","formatRet","parseToCalcStyle","subValue","updateValuePosition","initDom","initVars","trackRef","selectionEle","selectionRef","pointerMinRef","pointerMaxRef","tipMinEle","tipMinRef","tipMaxEle","tipMaxRef","setMinMax","decimalDigit","getDecimalDigit","scales","setScales","setTipConfig","addTipEvent","stop","isVisibleInit","pointerMaxWidth","scalesDiffer","writeValueHandle","limitDragPosition","positionToStepValue","pointerMinLeft","pointerMaxLeft","barWidth","pointerWidthHalf","ratios","unequalPositionToValue","stepValue","stepN","limitWidth","selectLength","ratiosWidth","ticksLen","ticksArr","pointerWidth","valueTmp","restrictDoubleValue","restrictSingleValue","isInvalidValueMin","isInvalidValueMax","tipFormatterFn","ticks","ratiosSum","sumArray","ratiosLen","getTicks","minScale","pow","calcTickMaxWidth","spacePercent","calcTickLeftPosition","isSelectTick","isLargeThanValMin","isSmallThanValMax","decimalArr","getValuePercent","paragraph","setPointerPos","valuePercent","tick","ticksArrLen","pointerLeft","barLeft","curTipEle","tipDisplay","renderTipStyle","selectionWidth","[class.ti3-slider-container]","[class.ti3-slider-disable]","(mousedown)","TiInputNumberDirective","localeable","precision","isValidInput","getCorrectValue","localeValue","parseValue","deleteGroupSepValue","normalValue","changeModel","validationValue","cursorPos","focusFn","groupSepNum","blurFn","TiSpinnerComponent","method","METHOD_ADD","METHOD_SUB","correctable","maxlength","stepChange","model_1","getModelByMinMax","correctValue","parseFormatValue","inputChange","keydownFn","stepNumber","stepNumberMousedown","accOperate","r1","r2","_value","_step","getLength","replacePeriod","cm","TiInputNumberModule","TiStepsComponent","clickable","adaptive","activeStepChange","beforeStep","isInitLabelChange","explainTotalWidth","setLineWidth","getExplainTotalWidth","lineRef","stepLine","steps","stepsDiffer","trackByLabelFn","labelChange","activeStep","explainRef","trackByIndexFn","getStepState","activedIndex","TiSwitchComponent","beforeChange","initialized","hasAnimation","aRef","[class.ti3-switch-container]","TiTabsComponent","tabs","isNotVisibleInit","destroyed","hasSlider","headerWidthChange","selectedTab","setActiveValue","activeTab","showMorePanel","onlistenClick","setMoreStyle","setTabStyle","moreRef","addTab","tab","tabElements","tabContentContainer","removeTab","newActiveIndex","getNewActiveIndex","enableAnimate","deActiveOthers","loaded","selectTab","targetTab","headNode","tagetLeft","transitionSet","slider","setTabScroll","distance","moreWidth","tabsHeaderWidth","tabsHeaderRef","listWidth","tabsListRef","tabsContainerRef","tabsContainerClientRect","targetClientRect","marginLeftDistance","maxDistance","headerWidth","[class.ti3-tabs-container]","TiTabComponent","tabset","createHeadNode","header","[class.ti3-tab-pane]","TiTabHeaderComponent","innerText","oldHeaderWidth","[class.ti3-tab-head-no-outline]","TiTagsInputComponent","selectDrop","getSuggestions","onInputBlur","findFirstIndex","addTagToSelected","onInputFocus","showSelectDrop","onInputKeyup","onInputKeydown","responseBackspace","modelLength","lastSelected","pop","newTag","newSuggestions","selected_1","selected_1_1","TiTextareaComponent","resize","$target","storeWidth","storeHeight","mouseYPosition","defaultStyle","minHeight","mouseMoveHandlerFn","mouseUpHandlerFn","isResizing","attrs","hasMaxlength","setCountLength","setContainerSize","setContainerClass","setMaxLengthFn","resizeFn","containerHeight","containerMargin","margin","cNameArr","cNameArr_1","cNameArr_1_1","cName","pNode","resizeIconRef","eleCharacterRef","textAreaMinWidth","getSizeNumber","textAreaMinHeight","textAreaMaxWidth","textAreaMaxHeight","updateTextAreaSize","countLength","horizonWidth","verticalHeight","TiFormatNumPipe","TiTreeUtil","getParentNode","data_1","data_1_1","isLeaf","traverse","traverseFn","data_2","data_2_1","updateChecked","allData","resultData","data_3","data_3_1","isLeafsParentNode","computedChecked","computeChecked","selectParents","deSelectParents","childrens","selectedNum","unSelectedNum","childrens_1","childrens_1_1","addNode","resuleIndex","removeNode","deleteArr","selectNode","selectAllChildren","travNode","deSelectNode","deSelectAllChildren","expandNode","data_4","data_4_1","matchFn","findNum","getSelectedData","onlySelectLeaf","selectedData","querySelectedNode","tempNode","checkedParentNode","pnode","checkedLeafNode","childrens_2","childrens_2_1","childrens_3","childrens_3_1","dropApply","dragNode","dragParentNode","dropNode","targetNode","dropParentNode","dropPosition","TiTreeComponent","cdRef","parentCheckable","changedByCheckbox","nodeDraggable","beforeExpand","nodeDrop","nodeAdded","nodeEdited","nodeDeleted","treeLan","setSeletedState","deSelectAllNode","initActived","actived","showCheckboxFn","onClickPnodeIcon","beforeExpandNode","getBeforeExpandNode","getItemIcon","expandIcon","collapseIcon","onItemWrapperClick","editing","setKeyDownUp","setKeyleft","setKeyright","parArr","pareNode","findIndex","setFocusNode","childnoDisabledArr","childNode","parList","targetIndex","_curIndex","focusNode","onDragstart","onDragenter","overNode","onDragover","dataTransfer","effectAllowed","clearDragClass","calcDropPosition","currentTarget","setDragOverClass","onDragleave","onDrop","loadStatus","onDragend","gapHeight","onMousenode","onBlurEdit","deleteNode","editNode","TiHighlightPipe","keyword","Reg","word","pure","TiAutoSelectDirective","TiCheckboxModule","TiTreeselectComponent","isAllSelected","searchPlaceholder","searchText","isInSearch","leafShallowClone","clone","keys_1","keys_1_1","oldOptions","restyleDropMaxHeight","SEARCHBOX_HEIGHT","dataTemplate","setAllSelectCheckboxState","closeWithoutFocus","searchTextChange","onDeleteDominatorTag","deletedItem","setSelectState","cnode","getItemIndexFromModel","getRealSelectedNode","getRealUnselectedNode","unselectedNode","getSelectedChildren","selectedChildren","setModelWhenSelected","selectedNode","deleteIndex","setModelWhenUnselected","setModelWhenSearch","selectedLeafNodes","getLeafNodes","selectedLeafNodes_1","selectedLeafNodes_1_1","leafNode","leafNodes","isAllUnSelected","onTreeSelect","onSelectAllChange","onClickSelectAll","onMouseDownDropOuter","onMouseWheel","TiTreeModule","TiUploadUtil","uploadItems","isValidFileItem","isUploading","onBeforeSend","isCancel","isHTML5","uploadXhr","uploadForm","cancelItems","_xhr","abort","_form","onCancel","onComplete","removeItems","uploader","queue","getItemIndex","onRemove","onBeforeRemove","handleEvent","itemInQueue","generateUploadData","uploadDataObj","FormData","append","alias","_file","file","addFormData","formData","formDataFirst","setXhr","xhr","onprogress","lengthComputable","total","progress","onProgress","response","status","isSuccessCode","onSuccess","onError","onerror","onabort","setheaders","headers","setRequestHeader","XMLHttpRequest","send","items_1","items_1_1","replaceChild","_input","items_2","items_2_1","inputSubmit","formDataDomItem","iframe","submit","newProgress","progressInterval","setInterval","loadEvent","clearInterval","contentDocument","addEventListener","removeEventListener","items_3","items_3_1","isReady","isUploaded","isSuccess","isError","onEventTypeItems","items_4","items_4_1","items_5","items_5_1","items_6","items_6_1","readyItemsArr","getReadyItems","items_7","items_7_1","File","TiFileSelectDirective","hostElementRef","fileChangeEvent","tiFileSelect","onFileChange","fileSel","uploadInst","files","addedItems","_addToQueue","isRemoveInput","replaceFileInput","autoUpload","fileSelNew","TiFileItemUtil","createFileItem","tifileObject","fileOrInput","Element","batchSend","isRemove","createFileObject","fileThis","fileName","lastModifiedDate","sizeWithUnit","formatSize","fileSize","kbSize","TiUploadService","initFilter","rules","isSingleFile","isSingleFileFn","filters","maxCountIndex","getInvalidRules","filtersRules","fileQueue","filterLen","invalidRetArr","filterConfig","filterName","ruleFn","filterRules","getNotUploadedItems","item1","item2","getErrorItems","reloadAllError","reloadAll","uploadAll","isUploadedAll","removeAll","cancelAll","fileIndex","invalidArr","isValid","fileItem","onAddItemSuccess","onAddItemFailed","maxSize","fileObj","minSize","isValidType","maxCount","TiUploadServiceModule","TiUploadbaseComponent","addItemFailed","addItemSuccess","beforeSendItems","progressItems","completeItems","successItems","errorItems","completeAllItems","beforeRemoveItems","uploadLan","uploadConfig","validResults","onBeforeSendItems","fileItems","onProgressItems","onCompleteItems","onSuccessItems","onErrorItems","onCancelItems","onRemoveItems","onBeforeRemoveItems","onCompleteAllItems","accept","TiUploadComponent","uploaderService","tiOverflow","onSelectClick","fileInput","setPlaceholder","showSubmitButton","onItemMouseenter","fileNameEle","onItemMouseleave","getUploadState","uploadingLen","uploadErrLen","uploadSuccLen","fileQueueLen","stateInfo","TiDisabledDirective","TiModalService","openedModals","backdropComponentRef","backdrop","modalComponentRef","modal","modalConfig","_id","reason","beforeClose","destroyModal","showState","destroyBackdrop","generateModal","generateBackdrop","modalComponent","modalContext","backdropComponent","backdropRef","TiUploadimageComponent","tiModal","deletable","listType","uploadLimit","uploadBtnWidth","uploadBtnHeight","setUploadConfig","uploadBtn","setFilters","addPreviewList","setPreviewInfo","removePreviewList","uploadFilters","imgInfoItem","imgFileItem","previewUrl","isImage","createObjectURL","preview","previewList","firstIndex","modalClass","tempArray","extension","toLocaleLowerCase","supportTypes","img","selectFile","uploadInputEle","TiProgresspieModule","TiProgressbarModule","TiImagepreviewModule","TiIntromodalComponent","totalArray","isStringContent","templateContent","[class.ti3-intromodal-wrapper]","TiIntrotipComponent","TiIntroService","modalService","commonConfig","clearCircle","y","radius","stepClear","calcHeight","sqrt","posX","posY","widthX","heightY","newStepClear","scrollToViewport","introRef","introModalRef","introTipRef","introMultiTipRefs","curStep","lastStep","closeMultiTipEle","isAction","flag","hidePreStep","onFinish","onExit","unListenWindowResize","unListenWindowHashchange","closeMultiTipEleClickListener","wantStep","isInvalidStepNum","goStep","backdropEle","currentStep","currentSteps","drawBackdrop","currentNumber","finishButtonText","highlight","shape","introtipRef","proceed","introModal","browserWidth","browserHeight","fillRect","highlightLayout","TiIntroServiceModule","TiMessageComponent","CONST_CONFIG","validType","defaultType","setBtn","defaults","defaultOpts","setType","setTitle","setBtns","setContent","okButton","cancelButton","setBtnUniqueState","prop","contentConfig","TiTranscludeDirective","eleRef","wrapperRef","TiContentWrapperComponent","tiTransclude","TiMessageService","TiMessageModule","TiZoomComponent","zoomSelectorLength","zoomViewerLength","imgSrc","setParentEle","ratio","onHostLoad","onHostMouseEnter","createZoomSelector","createZoomViewer","reStyleResults","onHostMouseLeave","zoomSelectorEle","removeZoomEle","selectorMouseMoveHandler","selectorMouseLeaveHandler","zoomViewerEle","hostEleRect","parentEleRect","ZOOM_VIEWER_BORDER_WIDTH","background","background-size","getCursorPos","mouseEvent","zoomSelectorWidth","viewerPosX","viewerPosY"],"mappings":"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","sourcesContent":["/* eslint-disable no-cond-assign */\r\n// 另，angular也有brower-util.ts，但是没有对浏览器版本号的判断。\r\n\r\n/*\r\n * 浏览器类型的枚举定义。字符串枚举，提供了运行时可读性。\r\n */\r\n/* export enum Browser {  // export是为了不成为全局定义。此文件存在2个export\r\n    EDGE = 'EDGE',\r\n    IE = 'IE',\r\n    FIREFOX = 'FIREFOX',\r\n    CHROME = 'CHROME',\r\n    OPERA = 'OPERA',\r\n    SAFARI = 'SAFARI',\r\n    OTHER = 'OTHER'\r\n} */\r\n\r\n/**\r\n * BrowserInfo浏览器工具类，提供浏览器类别和版本信息\r\n *\r\n * 浏览器的类型及版本信息\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/utils/browser-basic\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nexport class TiBrowser {\r\n    /**\r\n     * EDGE浏览器字符串\r\n     */\r\n    public static readonly EDGE: string = 'EDGE';\r\n    /**\r\n     * IE浏览器字符串\r\n     */\r\n    public static readonly IE: string = 'IE';\r\n    /**\r\n     * FIREFOX浏览器字符串\r\n     */\r\n    public static readonly FIREFOX: string = 'FIREFOX';\r\n    /**\r\n     * CHROME浏览器字符串\r\n     */\r\n    public static readonly CHROME: string = 'CHROME';\r\n    /**\r\n     * OPERA浏览器字符串\r\n     */\r\n    public static readonly OPERA: string = 'OPERA';\r\n    /**\r\n     * SAFARI浏览器字符串\r\n     */\r\n    public static readonly SAFARI: string = 'SAFARI';\r\n    /**\r\n     * OTHER浏览器字符串\r\n     */\r\n    public static readonly OTHER: string = 'OTHER';\r\n\r\n    private static _browser: string = TiBrowser.OTHER;\r\n    private static _version: number = 0;  // 浏览器的大版本号，整数。取第一个小数点前\r\n    private static isInit: boolean = false;\r\n\r\n    /**\r\n     * 浏览器类型\r\n     * @returns 返回枚举型浏览器类型字符串\r\n     */\r\n    public static browser(): string {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser._browser;\r\n    }\r\n    /**\r\n     * 浏览器版本\r\n     */\r\n    public static version(): number {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser._version;\r\n    }\r\n    /**\r\n     * 是否Edge\r\n     */\r\n    public static isEdge(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.EDGE;\r\n    }\r\n    /**\r\n     * 是否IE\r\n     */\r\n    public static isIE(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.IE;\r\n    }\r\n    /**\r\n     * 是否Firefox\r\n     */\r\n    public static isFirefox(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.FIREFOX;\r\n    }\r\n    /**\r\n     * 是否Chrome\r\n     */\r\n    public static isChrome(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.CHROME;\r\n    }\r\n    /**\r\n     * 是否Opera\r\n     */\r\n    public static isOpera(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.OPERA;\r\n    }\r\n    /**\r\n     * 是否Safari\r\n     */\r\n    public static isSafari(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.SAFARI;\r\n    }\r\n    /**\r\n     * 是否Other\r\n     */\r\n    public static isOther(): boolean {\r\n        TiBrowser.init();\r\n\r\n        return TiBrowser.browser() === TiBrowser.OTHER;\r\n    }\r\n\r\n    private static init(): void {\r\n        if (TiBrowser.isInit) {// 如果已经初始化，那么返回\r\n            return;\r\n        }\r\n        // 浏览器判断，已支持SSR\r\n        const userAgent: string = typeof navigator !== 'undefined' ? navigator.userAgent.toLowerCase():'';\r\n        let aAgentInfo: Array<any>|null;\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/edge\\/([\\d.]+)/)) ? TiBrowser._browser = TiBrowser.EDGE :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/rv:([\\d.]+)\\) like gecko/)) ? TiBrowser._browser = TiBrowser.IE :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/msie ([\\d.]+)/)) ? TiBrowser._browser = TiBrowser.IE :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/firefox\\/([\\d.]+)/)) ? TiBrowser._browser = TiBrowser.FIREFOX :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/chrome\\/([\\d.]+)/)) ? TiBrowser._browser = TiBrowser.CHROME :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/opera.([\\d.]+)/)) ? TiBrowser._browser = TiBrowser.OPERA :\r\n        // tslint:disable-next-line:no-conditional-assignment\r\n        (aAgentInfo = userAgent.match(/version\\/([\\d.]+).*safari/)) ? TiBrowser._browser = TiBrowser.SAFARI :\r\n        TiBrowser._browser = TiBrowser.OTHER;\r\n        // 版本号取整\r\n        TiBrowser._version = (aAgentInfo !== null) ? parseInt(aAgentInfo[1].split('.')[0], 10) : 0;\r\n        // 改变初始化值\r\n        TiBrowser.isInit = true;\r\n    }\r\n}\r\n","import { TiBrowser } from './TiBrowser';\r\n\r\n// 另，Angular官方键值调用方法：\r\n// import {DOWN_ARROW, ENTER, ESCAPE, UP_ARROW, TAB} from '@angular/cdk/keycodes';\r\n\r\n/* 使用键值请参考：\r\nhttps://blog.csdn.net/q1054261752/article/details/50359617\r\nhttp://www.runoob.com/try/try.php?filename=tryjsref_event_key_keycode2\r\nhttps://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent\r\n事件顺序：onkeydown > onkeypress >onkeyup\r\n早期标准：\r\nkeydown和keyup捕获具体物理按键，event.keyCode输出键值，可以区分主副键盘的具体按键；\r\nkeypress捕获按键经过处理后的字符，event.charCode输出ASCII字符编码，可以区分大小写字母，主副键盘相同符号取值相同。\r\nevent.which根据情况输出charCode（keypress时）或keyCode（keydown时）。\r\nIE8只有keyCode属性，IE9起已支持which和charCode。\r\nChrome和IE等，在keypress时，keyCode也存放了charCode值。（是为了兼容只有keyCode属性的IE8）\r\nFireFox，keypress只输出event.charCode，keydown只输出event.keycode；另一个值为0。\r\n现今情况：\r\nkeyCode/charCode/which都已废弃，但keyCode依然是目前最好选择！（2018年4月，须兼容IE9）\r\n未来情况：\r\nkeypress和keydown时，都可用event.key（\"z\"）和event.code(\"KeyZ\")，是推荐标准，都是字符串可读性值。\r\nIE9不支持event.code。\r\nIE9的event.key是旧标准。小键盘符号支持很差：和大键盘取值不同，且keypress和keydown时取值不同。有时符号，有时符号名称。\r\n\r\n综上：建议只使用keydow和keyup事件和event.keyCode键值，不使用keypress/which/charCode\r\n很少有需求使用keypress，仅配合 event.charCode取出字符编码即可。\r\n再配合'A'.charCodeAt(0)===event.charCode或者'A'===String.fromCharCode(event.charCode);\r\n*/\r\n/* HTML W3C标准键值查找类，已经屏蔽浏览器差异\r\n *\r\n * 参考文档：\r\n *\r\n * https://www.w3.org/TR/uievents/\r\n *\r\n * https://www.w3.org/TR/uievents-code/\r\n *\r\n * https://www.w3.org/TR/uievents-key\r\n *\r\n * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code\r\n *\r\n * https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\r\n *\r\n * https://github.com/kabirbaidhya/keycode-js  这份代码采用了Mac命名方式，比如回车键叫Return\r\n *\r\n * https://github.com/wesbos/keycodes/blob/gh-pages/scripts.js\r\n *\r\n * http://blog.csdn.net/joeblackzqq/article/details/46442121\r\n *\r\n * W3C规定了一些固定键值，其他键值可能随硬件（PC/Mac）、操作系统、浏览器而不同。\r\n *\r\n * 命名规范统一按照W3C名称，已涵盖标准101键盘，其他键盘暂未涵盖。\r\n *\r\n *  js中左右Ctrl、大小键盘Enter是同一键值，所以比windows编程环境的键值要少一些。\r\n *\r\n * 多余Mac键盘值已删除。\r\n *\r\n * 标点符号，因为Firefox与其他浏览器有三个不同，已做兼容性处理\r\n */\r\n\r\n/**\r\n * KeyMap键值工具类，提高键值可读性，已经屏蔽浏览器差异\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/utils/keymap-basic\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nexport class TiKeymap {\r\n    /* 此部分为W3C规定的固定键值 start↓ */\r\n    /**\r\n     * Mac称作Delete 【注意： Backspace 8/Delete 46（windows用后向删除）是两个不同键值。】\r\n     */\r\n    public static readonly KEY_BACKSPACE: number = 8;\r\n    /**\r\n     * Table键\r\n     */\r\n    public static readonly KEY_TAB: number = 9;\r\n    /**\r\n     * 回车键，数字小键盘回车也是13。 Mac称作Return。【注意：108是Mac数字小键盘Enter】\r\n     */\r\n    public static readonly KEY_ENTER: number = 13;\r\n    /**\r\n     * 左右Shift\r\n     */\r\n    public static readonly KEY_SHIFT: number = 16;\r\n    /**\r\n     * 左右Ctrl\r\n     */\r\n    public static readonly KEY_CONTROL: number = 17;\r\n    /**\r\n     * 左右Alt    Mac称作Option\r\n     */\r\n    public static readonly KEY_ALT: number = 18;\r\n    /**\r\n     * W3C未规定固定或者不固定，是PC（非Mac）独有\r\n     */\r\n    public static readonly KEY_PAUSE_BREAK: number = 19;\r\n    /**\r\n     * 大小写锁定\r\n     */\r\n    public static readonly KEY_CAPS_LOCK: number = 20;\r\n    /**\r\n     * 左上角Esc\r\n     */\r\n    public static readonly KEY_ESCAPE: number = 27;\r\n    public static readonly KEY_SPACE: number = 32;\r\n    public static readonly KEY_PAGE_UP: number = 33;\r\n    public static readonly KEY_PAGE_DOWN: number = 34;\r\n    public static readonly KEY_END: number = 35;\r\n    public static readonly KEY_HOME: number = 36;\r\n    /**\r\n     * 箭头方向键\r\n     */\r\n    public static readonly KEY_ARROW_LEFT: number = 37;\r\n    public static readonly KEY_ARROW_UP: number = 38;\r\n    public static readonly KEY_ARROW_RIGHT: number = 39;\r\n    public static readonly KEY_ARROW_DOWN: number = 40;\r\n    /**\r\n     * W3C未规定固定或非固定，是PC（非Mac）独有\r\n     */\r\n    public static readonly KEY_PRINT_SCREEN: number = 44; // W3C未规定固定或非固定，是PC（非Mac）独有\r\n    /**\r\n     * W3C未规定固定或非固定，是PC（非Mac）独有\r\n     */\r\n    public static readonly KEY_INSERT: number = 45; // W3C未规定固定或非固定，是PC（非Mac）独有\r\n    /**\r\n     * 后向删除\r\n     */\r\n    public static readonly KEY_DELETE: number = 46;\r\n    public static readonly KEY_0: number = 48;\r\n    public static readonly KEY_1: number = 49;\r\n    public static readonly KEY_2: number = 50;\r\n    public static readonly KEY_3: number = 51;\r\n    public static readonly KEY_4: number = 52;\r\n    public static readonly KEY_5: number = 53;\r\n    public static readonly KEY_6: number = 54;\r\n    public static readonly KEY_7: number = 55;\r\n    public static readonly KEY_8: number = 56;\r\n    public static readonly KEY_9: number = 57;\r\n    public static readonly KEY_A: number = 65;\r\n    public static readonly KEY_B: number = 66;\r\n    public static readonly KEY_C: number = 67;\r\n    public static readonly KEY_D: number = 68;\r\n    public static readonly KEY_E: number = 69;\r\n    public static readonly KEY_F: number = 70;\r\n    public static readonly KEY_G: number = 71;\r\n    public static readonly KEY_H: number = 72;\r\n    public static readonly KEY_I: number = 73;\r\n    public static readonly KEY_J: number = 74;\r\n    public static readonly KEY_K: number = 75;\r\n    public static readonly KEY_L: number = 76;\r\n    public static readonly KEY_M: number = 77;\r\n    public static readonly KEY_N: number = 78;\r\n    public static readonly KEY_O: number = 79;\r\n    public static readonly KEY_P: number = 80;\r\n    public static readonly KEY_Q: number = 81;\r\n    public static readonly KEY_R: number = 82;\r\n    public static readonly KEY_S: number = 83;\r\n    public static readonly KEY_T: number = 84;\r\n    public static readonly KEY_U: number = 85;\r\n    public static readonly KEY_V: number = 86;\r\n    public static readonly KEY_W: number = 87;\r\n    public static readonly KEY_X: number = 88;\r\n    public static readonly KEY_Y: number = 89;\r\n    public static readonly KEY_Z: number = 90;\r\n    /* 此部分为W3C规定的固定键值 end↑ */\r\n    /**\r\n     * \"Windows Key Left/ Left Command⌘ (Mac)/ Chromebook Search key\";\r\n     */\r\n    public static readonly KEY_META_LEFT: number = 91;\r\n    /**\r\n     * \"Windows Key Right\r\n     */\r\n    public static readonly KEY_META_RIGHT: number = 92;\r\n    /**\r\n     *  \"Windows Menu / Right Command⌘(Mac)\";\r\n     */\r\n    public static readonly KEY_CONTEXT_MENU: number = 93;\r\n    public static readonly KEY_NUMPAD_0: number = 96;\r\n    public static readonly KEY_NUMPAD_1: number = 97;\r\n    public static readonly KEY_NUMPAD_2: number = 98;\r\n    public static readonly KEY_NUMPAD_3: number = 99;\r\n    public static readonly KEY_NUMPAD_4: number = 100;\r\n    public static readonly KEY_NUMPAD_5: number = 101;\r\n    public static readonly KEY_NUMPAD_6: number = 102;\r\n    public static readonly KEY_NUMPAD_7: number = 103;\r\n    public static readonly KEY_NUMPAD_8: number = 104;\r\n    public static readonly KEY_NUMPAD_9: number = 105;\r\n    /**\r\n     * 小键盘*\r\n     */\r\n    public static readonly KEY_NUMPAD_MULTIPLY: number = 106;\r\n    /**\r\n     * 小键盘+\r\n     */\r\n    public static readonly KEY_NUMPAD_ADD: number = 107;\r\n    /**\r\n     * Mac小键盘Enter。可能某些键盘除法符号。且这个键值可能在Firefox与其他浏览器不同。\r\n     */\r\n    public static readonly KEY_NUMPAD_ENTER: number = 108;\r\n    /**\r\n     * 小键盘-\r\n     */\r\n    public static readonly KEY_NUMPAD_SUBTRACT: number = 109;\r\n    /**\r\n     * 小键盘. (小数点)\r\n     */\r\n    public static readonly KEY_NUMPAD_DECIMAL: number = 110;\r\n    /**\r\n     * 小键盘/\r\n     */\r\n    public static readonly KEY_NUMPAD_DIVIDE: number = 111;\r\n    public static readonly KEY_F1: number = 112;\r\n    public static readonly KEY_F2: number = 113;\r\n    public static readonly KEY_F3: number = 114;\r\n    public static readonly KEY_F4: number = 115;\r\n    public static readonly KEY_F5: number = 116;\r\n    public static readonly KEY_F6: number = 117;\r\n    public static readonly KEY_F7: number = 118;\r\n    public static readonly KEY_F8: number = 119;\r\n    public static readonly KEY_F9: number = 120;\r\n    public static readonly KEY_F10: number = 121;\r\n    public static readonly KEY_F11: number = 122;\r\n    public static readonly KEY_F12: number = 123;\r\n    public static readonly KEY_F13: number = 124;\r\n    public static readonly KEY_F14: number = 125;\r\n    public static readonly KEY_F15: number = 126;\r\n    public static readonly KEY_F16: number = 127;\r\n    public static readonly KEY_F17: number = 128;\r\n    public static readonly KEY_F18: number = 129;\r\n    public static readonly KEY_F19: number = 130;\r\n    public static readonly KEY_F20: number = 131;\r\n    public static readonly KEY_F21: number = 132;\r\n    public static readonly KEY_F22: number = 133;\r\n    public static readonly KEY_F23: number = 134;\r\n    public static readonly KEY_F24: number = 135;\r\n    /**\r\n     * W3C未规定固定或不固定，是PC（非Mac）独有。  在Mac上这个键值给numpad_clear用了。\r\n     */\r\n    public static readonly KEY_NUM_LOCK: number = 144;\r\n    /**\r\n     * W3C未规定固定或不固定，是PC（非Mac）独有\r\n     */\r\n    public static readonly KEY_SCROLL_LOCK: number = 145;\r\n    /* 下面是W3C符号美标键值，不固定。Firefox符号键值有3个与其他浏览器不同 */\r\n    /**\r\n     * \";\" Firefox键值是59，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_SEMICOLON: number = 186;\r\n    /**\r\n     * \":\" Firefox键值是59，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_COLON: number = TiKeymap.KEY_SEMICOLON;\r\n    /**\r\n     * \"=\" Firefox键值是61，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_EQUALS_SIGN: number = 187;\r\n    /**\r\n     * \"+\" Firefox键值是61，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_PLUS: number = TiKeymap.KEY_EQUALS_SIGN;\r\n    /**\r\n     * \"-\" Firefox键值是173，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_MINUS: number = 189;\r\n    /**\r\n     * \"_\" Firefox键值是173，使用时已经屏蔽差异\r\n     */\r\n    public static KEY_UNDERSCORE: number = TiKeymap.KEY_MINUS;\r\n    // public static get KEY_SEMICOLON() { // \";\"\r\n    //     if (BrowserInfo.isFirefox()) { return 59; }\r\n    //     return 186;\r\n    // }\r\n    // public static get KEY_COLON() { // \":\"\r\n    //     return KeyMap.KEY_SEMICOLON;\r\n    // }\r\n    // public static get KEY_EQUALS_SIGN() { // \"=\"\r\n    //     if (BrowserInfo.isFirefox()) { return 61; }\r\n    //     return 187;\r\n    // }\r\n    // public static get KEY_PLUS() { // \"+\"\r\n    //     return KeyMap.KEY_EQUALS_SIGN;\r\n    // }\r\n    // public static get KEY_MINUS() { // \"-\"\r\n    //     if (BrowserInfo.isFirefox()) { return 173; }\r\n    //     return 189;\r\n    // }\r\n    // public static get KEY_UNDERSCORE() { // \"_\"\r\n    //     return KeyMap.KEY_MINUS;\r\n    // }\r\n    /**\r\n     * \",\"\r\n     */\r\n    public static readonly KEY_COMMA: number = 188;\r\n    /**\r\n     * \"<\"\r\n     */\r\n    public static readonly KEY_LESS_THAN_SIGN: number = 188;\r\n    /**\r\n     * \".\"\r\n     */\r\n    public static readonly KEY_PERIOD: number = 190;\r\n    /**\r\n     * \">\"\r\n     */\r\n    public static readonly KEY_GREATER_THAN_SIGN: number = 190;\r\n    /**\r\n     * \"/\"\r\n     */\r\n    public static readonly KEY_FORWARD_SLASH: number = 191;\r\n    /**\r\n     * \"?\"\r\n     */\r\n    public static readonly KEY_QUESTION_MARK: number = 191;\r\n    /**\r\n     * \"`\"\r\n     */\r\n    public static readonly KEY_BACKTICK: number = 192;\r\n    /**\r\n     * \"~\"\r\n     */\r\n    public static readonly KEY_TILDE: number = 192;\r\n    /**\r\n     * \"[\"\r\n     */\r\n    public static readonly KEY_OPENING_SQUACE_BRACKET: number = 219;\r\n    /**\r\n     * \"{\"\r\n     */\r\n    public static readonly KEY_OPENING_CURLY_BRACE: number = 219;\r\n    /**\r\n     * \"\\\"\r\n     */\r\n    public static readonly KEY_BACKSLASH: number = 220;\r\n    /**\r\n     * \"|\"\r\n     */\r\n    public static readonly KEY_PIPE: number = 220;\r\n    /**\r\n     * \"]\"\r\n     */\r\n    public static readonly KEY_CLOSING_SQUARE_BRACKET: number = 221;\r\n    /**\r\n     * \"}\"\r\n     */\r\n    public static readonly KEY_CLOSING_CURLY_BRACE: number = 221;\r\n    /**\r\n     * \"'\"\r\n     */\r\n    public static readonly KEY_SINGLE_QUOTE: number = 222;\r\n    /**\r\n     * \"\"\"\r\n     */\r\n    public static readonly KEY_DOUBLE_QUOTE: number = 222;\r\n\r\n    /* 鼠标键值，前三个为W3C固定，命名暂时按照程序员习惯。 */\r\n    /**\r\n     * 鼠标键值：primary button\r\n     */\r\n    public static readonly MOUSE_LEFT_BUTTON: number = 0; // primary button\r\n    /**\r\n     * 鼠标键值：auxiliary button  wheel button\r\n     */\r\n    public static readonly MOUSE_MIDDLE_BUTTON: number = 1; // auxiliary button  wheel button\r\n    /**\r\n     * 鼠标键值：secondary button\r\n     */\r\n    public static readonly MOUSE_RIGHT_BUTTON: number = 2; // secondary button\r\n    /**\r\n     * 鼠标键值：浏览器后退\r\n     */\r\n    public static readonly MOUSE_BACK_BUTTON: number = 3; // 浏览器后退\r\n    /**\r\n     * 鼠标键值：浏览器前进\r\n     */\r\n    public static readonly MOUSE_FORWARD_BUTTON: number = 4; // 浏览器前进\r\n    /**\r\n     * Typescript没有静态代码段，所以这样代替静态代码段\r\n     */\r\n    protected static staticCode: void = TiKeymap.initFirefox();\r\n    /* Firefox符号键值有3个与其他浏览器不同\r\n        Semicolon\t\";\"\t186 //Firefox 59\r\n        Colon\t\":\"\t186 //Firefox 59\r\n        Equals sign\t\"=\"\t187 //Firefox 61\r\n        Plus\t\"+\"\t187 //Firefox 61\r\n        Minus\t\"-\"\t189  //Firefox 173\r\n        Underscore\t\"_\"\t189 //Firefox 173\r\n    */\r\n    private static initFirefox(): void {\r\n        if (TiBrowser.isFirefox()) {\r\n            TiKeymap.KEY_SEMICOLON = 59; // \";\"\r\n            TiKeymap.KEY_COLON = TiKeymap.KEY_SEMICOLON; // \":\"\r\n            TiKeymap.KEY_EQUALS_SIGN = 61; // \"=\"\r\n            TiKeymap.KEY_PLUS = TiKeymap.KEY_EQUALS_SIGN; // \"+\"\r\n            TiKeymap.KEY_MINUS = 173; // \"-\"\r\n            TiKeymap.KEY_UNDERSCORE = TiKeymap.KEY_MINUS; // \"_\"\r\n        }\r\n    }\r\n}\r\n// 因为Typescript没有类的静态代码段。所以对类的static变量初始化，写在这里。\r\n\r\n\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/*\r\n * Logger工具类提供全局日志输出级别控制。\r\n *\r\n * 提供三个静态日志方法，log()/warn()/error()\r\n *\r\n * log()是调试期日志，产品时一定关闭。组件对打包对外提供时也关闭，不干扰用户开发。\r\n *\r\n * info()是产品期也可以输出的重要日志。暂不提供。\r\n *\r\n * warn()/error()产品期，可酌情打开。后期可以考虑，error日志回传给服务器。\r\n *\r\n */\r\n\r\n/**\r\n * Logger工具类, 提供全局日志输出和级别控制。\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/utils/log-basic\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nexport class TiLog {\r\n\r\n    /**\r\n     * 可以输出Log以上日志，包含Log/Warn/Error，log表示一般的调试和运行信息。\r\n     */\r\n    public static readonly LEVEL_LOG: number = 1;\r\n    /**\r\n     * 可以输出Warn以上日志，包含Warn/Error日志，Warn表示会出现潜在错误的提示。\r\n     */\r\n    public static readonly LEVEL_WARN: number = 2;\r\n    /**\r\n     * 可以输出Error日志，Error表示发生错误事件，已经影响系统的正常运行。\r\n     */\r\n    public static readonly LEVEL_ERROR: number = 3;\r\n    /**\r\n     * 关闭输出所有日志\r\n     */\r\n    public static readonly LEVEL_OFF: number = 10;\r\n\r\n    private static level: number = TiLog.LEVEL_OFF;\r\n    /**\r\n     * 设置输出日志级别：LOG/WARN/ERROR/OFF. 默认是关闭\r\n     */\r\n    public static setLevel(level: number): void {\r\n            TiLog.level = level;\r\n    }\r\n    /**\r\n     *  一般的调试和运行信息\r\n     * @param [message] 信息\r\n     * @param optionalParams 参数\r\n     */\r\n    public static log(message?: any, ...optionalParams: Array<any>): void {\r\n        if (TiLog.LEVEL_LOG >= TiLog.level && console.log) {\r\n            console.log(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    // public static info(message?: any, ...optionalParams: Array<any>): void {\r\n    //     if (Logger.infoable && console.log) {\r\n    //         // 在Chrome, console.info()只是log()的别名，tslint不建议使用。\r\n    //         console.log(message, ...optionalParams);\r\n    //     }\r\n    // }\r\n\r\n    /**\r\n     *  会出现潜在错误的提示\r\n     * @param [message] 信息\r\n     * @param optionalParams 参数\r\n     */\r\n    public static warn(message?: any, ...optionalParams: Array<any>): void {\r\n        if (TiLog.LEVEL_WARN >= TiLog.level && console.warn) {\r\n            console.warn(message, ...optionalParams);\r\n        }\r\n    }\r\n    /**\r\n     * 发生错误事件，已经影响系统的正常运行\r\n     * @param [message] 信息\r\n     * @param optionalParams 参数\r\n     */\r\n    public static error(message?: any, ...optionalParams: Array<any>): void {\r\n        if (TiLog.LEVEL_ERROR >= TiLog.level && console.error) {\r\n            console.error(message, ...optionalParams);\r\n        }\r\n    }\r\n}\r\n","/**\r\n * @ignore\r\n */\r\nexport class TiDateUtil {\r\n    /**\r\n     * 日期类组件的默认最小值\r\n     */\r\n    public static minDate(): Date {\r\n        return new Date(1970, 0, 1, 0, 0, 0);\r\n    }\r\n    /**\r\n     * 日期类组件的默认最大值\r\n     */\r\n    public static maxDate(): Date {\r\n        return new Date(2099, 11, 31, 23, 59, 59);\r\n    }\r\n    /**\r\n     * 判断是不是合法的时间对象\r\n     */\r\n    public static isDate(date: object | string): boolean {\r\n        // tslint:disable-next-line:triple-equals\r\n        if (Object.prototype.toString.call(date) === '[object Date]' && String(date) !== 'Invalid Date') {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @description 最大值时分秒置为23:59:59。\r\n     * 原因：date或者dateRange组件中，如果用户动态设置的value为最大年月日并带有时分秒，而设置的maxValue时分秒比较小时，\r\n     * 校验该value是否小于或等于最大值时，会出错。\r\n     * @param maxValue 最大值\r\n     */\r\n    public static changeMaxTime(maxValue: Date): Date {\r\n        if (!TiDateUtil.isDate(maxValue)) {\r\n            return TiDateUtil.maxDate();\r\n        }\r\n\r\n        return new Date(maxValue.getFullYear(), maxValue.getMonth(),\r\n            maxValue.getDate(), 23, 59, 59);\r\n    }\r\n\r\n    /**\r\n     * @description 最小值时分秒置为0:0:0。\r\n     * 原因：date或者dateRange组件中，如果用户设置的minValue带有时分秒，这时动态更新value为最小值年月日并时分秒为很小时，会出错。\r\n     * @param minValue 最小值\r\n     * @returns Date\r\n     */\r\n    public static changeMinTime(minValue: Date): Date {\r\n        if (!TiDateUtil.isDate(minValue)) {\r\n            return TiDateUtil.minDate();\r\n        }\r\n\r\n        return new Date(minValue.getFullYear(), minValue.getMonth(),\r\n            minValue.getDate(), 0, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * @description 判断两个日期是不是相等：只包括年月日\r\n     * @param newValue 新值\r\n     * @param oldValue 旧值\r\n     */\r\n    public static isDateEqual(newValue: Date, oldValue: Date): boolean {\r\n        if (newValue === oldValue) {\r\n            return true;\r\n        }\r\n\r\n        // 当两个value都是Date类型时，要判断两个值的年月日是否相等，直接用‘===’判断不准确\r\n        if (TiDateUtil.isDate(newValue) && TiDateUtil.isDate(oldValue)) {\r\n            // 转换成年月日，然后重新生成一个Date，再将其转换成毫秒数进行判断\r\n            const newDate: Date = new Date(newValue.getFullYear(), newValue.getMonth(), newValue.getDate());\r\n            const oldDate: Date = new Date(oldValue.getFullYear(), oldValue.getMonth(), oldValue.getDate());\r\n            if (newDate.getTime() === oldDate.getTime()) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @description 判断两个时间日期是不是相等；\r\n     * @param newValue 新值\r\n     * @param oldValue 旧值\r\n     */\r\n    public static isDatetimeEqual(newValue: Date, oldValue: Date): boolean {\r\n        if (newValue === oldValue) {\r\n            return true;\r\n        }\r\n\r\n        if (TiDateUtil.isDate(newValue) && TiDateUtil.isDate(oldValue)) {\r\n            if (newValue.getTime() === oldValue.getTime()) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @description 判断是不是合法的NowDateTime值\r\n     * 存在nowDateTime值，并且是时间对象，且大于最小值小于最大值\r\n     */\r\n    public static isValidNowDateTime(nowDateTime: Date, min: Date, max: Date): boolean {\r\n        return nowDateTime && TiDateUtil.isDate(nowDateTime) &&\r\n                (nowDateTime.getTime() >= min.getTime()) &&\r\n                (nowDateTime.getTime() <= max.getTime());\r\n    }\r\n\r\n    /**\r\n     * @description 判断value1是否大于value2\r\n     */\r\n    public static isBigger(value1: Date, value2: Date): boolean {\r\n        return value1.getTime() > value2.getTime();\r\n    }\r\n\r\n    /**\r\n     * @description 判断value1是否大于value2\r\n     */\r\n    public static isBiggerOrEqual(value1: Date, value2: Date): boolean {\r\n        return value1.getTime() >= value2.getTime();\r\n    }\r\n\r\n    /**\r\n     * @description 判断value1是否小于value2\r\n     */\r\n    public static isSmaller(value1: Date, value2: Date): boolean {\r\n        return value1.getTime() < value2.getTime();\r\n    }\r\n\r\n    /**\r\n     * @description 将Date类型的日期转换成年月日字符串\r\n     * @param date 要进行转换的日期值\r\n     */\r\n    public static getDateStr(date: Date): string {\r\n        return `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`;\r\n    }\r\n\r\n    /**\r\n     * @description 将Date类型的日期转换成时分秒字符串\r\n     * @param date 要进行转换的日期值\r\n     */\r\n    public static getTimeStr(date: Date): string {\r\n        const hour = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();\r\n        const minute = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\r\n        const second = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds();\r\n\r\n        return `${hour}:${minute}:${second}`;\r\n    }\r\n\r\n    /**\r\n     * @description 判断是不是一个合法的最大值\r\n     * @param min 最小值\r\n     * @param max 最大值\r\n     */\r\n    public static isValidMaxValue(min: Date, max: Date): boolean {\r\n        return TiDateUtil.isDate(max) && (max.getTime() >= min.getTime());\r\n    }\r\n\r\n    /**\r\n     * @description 判断是不是一个合法的最小值\r\n     * @param min 最小值\r\n     * @param max 最大值\r\n     */\r\n    public static isValidMinValue(min: Date, max: Date): boolean {\r\n        return TiDateUtil.isDate(min) && (max.getTime() >= min.getTime());\r\n    }\r\n\r\n    /**\r\n     * @description 是否在最大值最小值区间\r\n     * @param min 最小值\r\n     * @param max 最大值\r\n     */\r\n    public static isBetweenMaxAndmin(value: Date, min: Date, max: Date): boolean {\r\n        return (value.getTime() >= min.getTime()) && (value.getTime() <= max.getTime());\r\n    }\r\n\r\n    /**\r\n     * @description  12小时制添加AMPM\r\n     */\r\n    public static addAmPm(timeFormat: string): string {\r\n        if (timeFormat.match(/h/) && !timeFormat.match(/a/)) { // 已设置ampm格式情况下，不做处理\r\n            return timeFormat + ' a'; // Angular 的datePipe 设置时间时，\"a\"代表AMPM\r\n        }\r\n\r\n        return timeFormat;\r\n    }\r\n\r\n    /**\r\n     * @description: 若时间字符串没有一个冒号时处理成合法的事件字符串（加冒号）\r\n     * @param value 时间字符串\r\n     */\r\n    public static addColon(value: string): string {\r\n        if (value.match(/:/)) {\r\n            return value;\r\n        }\r\n\r\n        const ampm: any = value.match(/am|AM|pm|PM/) || '';\r\n\r\n        return `${parseInt(value, 10)}: ${ampm}`;\r\n    }\r\n}\r\n","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n/**\r\n * 主题工具类\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/theme/theme-basic\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nexport class TiTheme {\r\n\r\n    /**\r\n     * 加载CSS文件，挂在head link\r\n     * @param cssPath css路径\r\n     * @param id link id\r\n     */\r\n    public static loadCss(cssPath: string, id: string): HTMLLinkElement {\r\n        let link: HTMLLinkElement = document.getElementById(id) as HTMLLinkElement;\r\n\r\n        // 原本没有link，那么创建link\r\n        if (!link) {\r\n            link = document.createElement('link');\r\n            document.head.appendChild(link);\r\n        }\r\n        // 如果link href没变，那么就不处理了。\r\n        if (link.href === cssPath) {\r\n            return;\r\n        }\r\n        link.href = cssPath;\r\n        link.id = id;\r\n        link.rel = 'stylesheet';\r\n        link.type = 'text/css';\r\n\r\n        // 被CSSVar补丁处理后，补丁会给link打上disabled。去除disabled，才能再次补丁生效。\r\n        if (link.hasAttribute('disabled')) {\r\n            link.removeAttribute('disabled');\r\n        }\r\n\r\n        return link;\r\n    }\r\n    /**\r\n     * 检测浏览器是否原生支持CSSVar\r\n     * @returns 是否支持CSSVar\r\n     */\r\n    public static isNativeSupportCssVar(): boolean {\r\n        const isBrowser: boolean = typeof window !== 'undefined';\r\n        const isNativeSupport: boolean = isBrowser && window.CSS && window.CSS.supports && window.CSS.supports('(--a: 0)');\r\n\r\n        return isNativeSupport;\r\n    }\r\n    /**\r\n     * 启动AppModule\r\n     * @param app 传入的AppModule\r\n     */\r\n    public static bootstrapModule(app: any): void {\r\n        platformBrowserDynamic()\r\n            .bootstrapModule(app)\r\n            .catch((err: any) => console.error(err));\r\n    }\r\n}\r\n","/**\r\n * @ignore\r\n */\r\nexport type HandlerFnType = (key: any, value: any, add: boolean, from?: any) => void;\r\n// TODO:未来看typescript如何继承Map\r\n/**\r\n * @ignore\r\n */\r\nexport class ObservableMap {\r\n\r\n    // 代理模式\r\n    private map: Map<any, any> = new Map<any, any>();\r\n    get size(): number {\r\n        return this.map.size;\r\n    }\r\n    constructor() {\r\n        this.map = new Map();\r\n    }\r\n    // 观察者模式\r\n    private handlerSet: Set<HandlerFnType> = new Set<HandlerFnType>();\r\n    public addObserver(handlerFn: HandlerFnType): void {\r\n        this.handlerSet.add(handlerFn);\r\n    }\r\n    public removeObserver(handlerFn: HandlerFnType): void {\r\n        this.handlerSet.delete(handlerFn);\r\n    }\r\n    // 通知函数，不会通知到发起源\r\n    private notify(key: any, value: any, add: boolean, from: any): void {\r\n        this.handlerSet.forEach((handlerFn: HandlerFnType) => {\r\n            handlerFn(key, value, add, from);\r\n        });\r\n    }\r\n    //  设置，可以添加发起源，那么消息不会通知到发起源。\r\n    public set(key: any, value: any, from?: any): this {\r\n        if (!this.map.has(key) || (this.map.has(key) && this.map.get(key) !== value)) {\r\n            this.map.set(key, value);\r\n            this.notify(key, value, true, from);\r\n        }\r\n\r\n        return this;\r\n    }\r\n    //  删除，可以添加发起源，那么消息不会通知到发起源。\r\n    public delete(key: any, from?: any): boolean {\r\n        if (this.map.has(key)) {\r\n            this.map.delete(key);\r\n            this.notify(key, undefined, false, from);\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    public has(key: any): boolean {\r\n        return this.map.has(key);\r\n    }\r\n    public get(key: any): boolean {\r\n        return this.map.get(key);\r\n    }\r\n    public getMap(): Map<any, any> { // 方便遍历Map，所有有了这个方法。\r\n        return this.map;\r\n    }\r\n}\r\n","/**\r\n * @ignore\r\n */\r\nexport type SetHandlerFnType = (item: any, add: boolean) => void;\r\n// TODO:未来看typescript如何继承Set\r\n/**\r\n * @ignore\r\n */\r\nexport class ObservableSet {\r\n    // 代理模式\r\n    private set: Set<any> = new Set<any>();\r\n    get size(): number {\r\n        return this.set.size;\r\n    }\r\n    constructor(items?: any) {\r\n        this.set = new Set(items);\r\n    }\r\n    // 观察者模式\r\n    private handlerSet: Set<SetHandlerFnType> = new Set<SetHandlerFnType>();\r\n    public addObserver(handlerFn: SetHandlerFnType): void {\r\n        this.handlerSet.add(handlerFn);\r\n    }\r\n    public removeObserver(handlerFn: SetHandlerFnType): void {\r\n        this.handlerSet.delete(handlerFn);\r\n    }\r\n    private notify(item: any, isAdd: boolean): void {\r\n        this.handlerSet.forEach((handlerFn: SetHandlerFnType) => {\r\n            handlerFn(item, isAdd);\r\n        });\r\n    }\r\n    public add(item: any): this {\r\n        if (!this.set.has(item)) {\r\n            this.set.add(item);\r\n            this.notify(item, true);\r\n        }\r\n\r\n        return this;\r\n    }\r\n    public delete(item: any): boolean {\r\n        if (this.set.has(item)) {\r\n            this.set.delete(item);\r\n            this.notify(item, false);\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    public has(item: any): boolean {\r\n        return this.set.has(item);\r\n    }\r\n}","/**\r\n * @ignore\r\n * 工具类\r\n */\r\nexport class Util {\r\n    // Generate a unique integer id (unique within the entire client session).\r\n    // Useful for temporary DOM ids.\r\n    private static idCounter: number = 0;\r\n    /**\r\n     * 获得一个唯一标示\r\n     * @param prefix 前缀\r\n     * @returns 唯一标示字符串\r\n     */\r\n    public static getUniqueId(prefix: string): string {\r\n        Util.idCounter++;\r\n        const id: string = `${prefix}_${Util.idCounter}`;\r\n\r\n        return id;\r\n    }\r\n    // TODO: 是否可以去除？\r\n    /**\r\n     * 是否未定义\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isUndefined(value: any): boolean {\r\n        return value === undefined;\r\n    }\r\n    // TODO: 是否可以去除？\r\n    /**\r\n     * 是否空\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isNull(value: any): boolean {\r\n        return value === null;\r\n    }\r\n    // TODO: 是否可以去除？\r\n    /**\r\n     * 是否String\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isString(value: any): boolean {\r\n        return typeof value === 'string';\r\n    }\r\n    // TODO: 是否可以去除？\r\n    /**\r\n     * 是否Number\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isNumber(value: any): boolean {\r\n        return typeof value === 'number' && !isNaN(value);\r\n    }\r\n\r\n    /**\r\n     * 是否空字符串\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isEmptyString(value: string): boolean {\r\n        return value === undefined || value === null || value === '';\r\n    }\r\n    // TODO: 是否可以去除\r\n    /**\r\n     * 是否Array\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isArray(value: any): boolean {\r\n        return Array.isArray(value);\r\n    }\r\n    // TODO: 是否可以去除\r\n    /**\r\n     * 是否函数\r\n     * @param value 值\r\n     * @returns 是否\r\n     */\r\n    public static isFunction(value: any): boolean {\r\n        return typeof value === 'function';\r\n    }\r\n\r\n    /**\r\n     * 使用固定参数值格式化填充字串\r\n     * @param source 源字串,其中使用{N}代表需要匹配的参数次序,N从0开始\r\n     * @param params Array 参数数组\r\n     */\r\n    public static formatEntry(source: string, params: Array<any>): string {\r\n        let formatSource: string = source;\r\n        if (!this.isArray(params) || formatSource === '') {\r\n            return formatSource;\r\n        }\r\n        params.forEach((param: any, i: number) => {\r\n            formatSource = formatSource.replace(new RegExp(`\\\\{${i}\\\\}`, 'g'), () => {\r\n                return param;\r\n            });\r\n        });\r\n\r\n        return formatSource;\r\n    }\r\n\r\n    /**\r\n     * 发出一个HTML事件\r\n     * @param: ele 触发事件的DOM\r\n     * @param: eventName 事件名称\r\n     * @param: [canBubble] 是否冒泡，可选参数默认不冒泡 false\r\n     */\r\n    public static trigger(ele: any, eventName: string, canBubble?: boolean): void {\r\n        // 修复SSR错误：ERROR ReferenceError: document is not defined\r\n        if (typeof document === 'undefined') {\r\n            return;\r\n        }\r\n        const event: Event = document.createEvent('HTMLEvents');\r\n        event.initEvent(eventName, canBubble || false, true);\r\n        // event.initEvent(eventType,canBubble,cancelable)\r\n        ele.dispatchEvent(event);\r\n    }\r\n    /**\r\n     * 判断是否为dom元素\r\n     */\r\n    public static isElement(ele: any): boolean {\r\n        if (ele && ele.nodeType) {\r\n            return ele.nodeType === 1;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n    /**\r\n     * 判断是否支持CSS Var\r\n     */\r\n    public static supportsCssVars(): boolean {\r\n        return typeof(window) !== 'undefined' && (window as any).CSS && (window as any).CSS.supports && (window as any).CSS.supports('(--a: 0)');\r\n    }\r\n    /**\r\n     * 通过tab键在弹窗内切换的时候，焦点需要一直在弹窗内部循环。\r\n     */\r\n    public static focusInDialogOnTabchange(event: KeyboardEvent, focusableElements: NodeList): void {\r\n        if (!focusableElements || focusableElements.length === 0) {\r\n            return;\r\n        }\r\n        const firstFocusableEle: any = focusableElements[0];\r\n        const lastFocusableEle: any = focusableElements[focusableElements.length - 1];\r\n        const target: EventTarget = event.target; // 获得触发事件的元素\r\n\r\n        // 按下tab+shift键时，如果当前已获取焦点元素是弹出框中的第一个可获取焦点元素，则聚焦最后一个元素\r\n        if (event.shiftKey) {\r\n            if (target === firstFocusableEle) {\r\n                lastFocusableEle.focus();\r\n                event.preventDefault(); // 阻止默认事件，确保此处手动focus生效\r\n            }\r\n        } else if (target === lastFocusableEle) { // 按下tab键时，如当前已获取焦点元素是最后一个可获取焦点元素，则聚焦第一个元素\r\n            firstFocusableEle.focus();\r\n            event.preventDefault(); // 阻止默认事件，确保此处手动focus生效\r\n        }\r\n    }\r\n}\r\nexport { TiBrowser } from './TiBrowser';\r\nexport { TiKeymap } from './TiKeymap';\r\nexport { TiLog } from './TiLog';\r\nexport { TiDateUtil } from './TiDateUtil';\r\nexport { TiTheme } from './TiTheme';\r\nexport { ObservableMap } from './ObservableMap';\r\nexport { ObservableSet } from './ObservableSet';\r\n","import {\r\n    Directive,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    OnChanges,\r\n    OnInit,\r\n    Output,\r\n    Renderer2,\r\n    SimpleChange,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { animate, AnimationBuilder, AnimationPlayer, style } from '@angular/animations';\r\nimport { TiBrowser } from '../../utils/Util';\r\n/**\r\n * TiCollapseDirective指令主要功能为动态控制某一DOM节点的显示(展开)与隐藏(收起)\r\n *\r\n * <p><span style=\"color: red\">使用此组件时需要开发者在项目模块(建议在根模块)\r\n * 中引入BrowserAnimationsModule。</span>这是因为此组件中使用了Angular动画，需要引入BrowserAnimationsModule，\r\n * 但是 BrowserAnimationsModule 不能在懒加载模块被重复引入，所以需要开发者来引入BrowserAnimationsModule，保证其引入一次。</p>\r\n *\r\n * <example-url>../tiny3demo/#/collapse/collapse-all</example-url>\r\n */\r\n@Directive ({\r\n    selector: '[tiCollapse]'\r\n})\r\nexport class TiCollapseDirective implements OnInit, OnChanges {\r\n    private static ANIMATE_IN: string = '600ms cubic-bezier(0.755, 0.05, 0.855, 0.06)'; // easeInQuint\r\n    private static ANIMATE_OUT: string = '600ms cubic-bezier(0.23, 1, 0.32, 1)'; // easeOutQuint\r\n    /**\r\n     * 控制折叠面板的收起/展开\r\n     */\r\n    @Input('tiCollapse') isCollapse: boolean = true; // 是否收起\r\n    /**\r\n     * 折叠面板在收起/展开结束后(即收起/展开动画结束后)的回调；\r\n     * 回调的参数为布尔值，true: 收起结束后, false: 展开结束后\r\n     */\r\n    @Output() readonly toggleDone: EventEmitter<boolean> = new EventEmitter();\r\n    private element: HTMLElement;\r\n    private expandPlayer: AnimationPlayer;\r\n    private collapsePlayer: AnimationPlayer;\r\n\r\n    constructor(private elementRef: ElementRef, private renderer: Renderer2,\r\n                private builder: AnimationBuilder) {\r\n        this.element = this.elementRef.nativeElement;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if (!TiBrowser.isIE() || TiBrowser.version() > 9) {\r\n            // 创建展开时动效的实例\r\n            this.expandPlayer = this.builder.build([\r\n                style({ 'max-height': '0px', overflow: 'hidden' }),\r\n                animate(TiCollapseDirective.ANIMATE_IN, style({ 'max-height': '2999px', overflow: 'visible' }))])\r\n                .create(this.element);\r\n\r\n            // 创建收起时动效的实例\r\n            this.collapsePlayer = this.builder.build([\r\n                style({ 'max-height': '2999px', overflow: 'visible' }),\r\n                animate(TiCollapseDirective.ANIMATE_OUT, style({ 'max-height': '0px', overflow: 'hidden' }))])\r\n                .create(this.element);\r\n\r\n            // 初始没有动画效果\r\n            if (this.isCollapse) {\r\n                this.collapsePlayer.finish();\r\n            } else {\r\n                this.expandPlayer.finish();\r\n            }\r\n        }\r\n\r\n        if (this.isCollapse) {\r\n            this.collapse();\r\n        } else {\r\n            this.expand();\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        const isCollapseObj: SimpleChange = changes['isCollapse'];\r\n\r\n        if (!isCollapseObj || isCollapseObj.firstChange) {\r\n            return;\r\n        }\r\n\r\n        if (TiBrowser.isIE() && (TiBrowser.version() === 9)) {\r\n            if (isCollapseObj.currentValue) {\r\n               this.collapse();\r\n            } else {\r\n                this.expand();\r\n            }\r\n            this.toggleDone.emit(isCollapseObj.currentValue);\r\n\r\n            return;\r\n        }\r\n\r\n        if (isCollapseObj.currentValue) {\r\n            // 执行收起动画前一定要重置展开动画，否则会影响收起动画\r\n            this.expandPlayer.reset();\r\n            // 执行收起动画\r\n            this.collapsePlayer.play();\r\n            // 收起动画结束后，设置元素display:none\r\n            this.collapsePlayer.onDone(() => {\r\n                // 设置元素display:none必须在收起动画结束后，否则没有动画效果\r\n                this.collapse();\r\n                this.toggleDone.emit(true);\r\n            });\r\n        } else {\r\n            // 执行展开动画前一定要重置收起动画，否则会影响展开动画\r\n             this.collapsePlayer.reset();\r\n             // 设置元素display:block\r\n             this.expand();\r\n             // 执行展开动画\r\n             this.expandPlayer.play();\r\n             this.expandPlayer.onDone(() => {\r\n                 this.toggleDone.emit(false);\r\n             });\r\n        }\r\n    }\r\n\r\n    private expand(): void {\r\n        this.renderer.setStyle(this.element, 'display', 'block');\r\n    }\r\n\r\n    private collapse(): void {\r\n        this.renderer.setStyle(this.element, 'display', 'none');\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiCollapseDirective } from './TiCollapseDirective';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiCollapseDirective],\r\n  declarations: [TiCollapseDirective]\r\n})\r\nexport class TiCollapseModule {\r\n}\r\nexport { TiCollapseDirective } from './TiCollapseDirective';\r\n","import { Directive, ElementRef, Renderer2, NgZone, AfterViewInit, OnDestroy } from '@angular/core';\r\n/**\r\n * @ignore\r\n * 点击需要和聚焦区分开。当点击的时候，不需要有outline。\r\n * 10.1.4新增\r\n */\r\n@Directive({\r\n    selector: '[tiOutline]'\r\n})\r\nexport class TiOutlineDirective implements AfterViewInit {\r\n    constructor(private renderer: Renderer2, public hostEle: ElementRef, private zone: NgZone) {\r\n    }\r\n    ngAfterViewInit(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            const outlineHostEle: any = this.hostEle.nativeElement;\r\n            if (outlineHostEle) {\r\n                this.renderer.listen(outlineHostEle, 'mousedown', (): void => {\r\n                    this.renderer.setStyle(outlineHostEle, 'outline', 'none');\r\n                });\r\n                this.renderer.listen(outlineHostEle, 'blur', (): void => {\r\n                    this.renderer.setStyle(outlineHostEle, 'outline', '');\r\n                });\r\n            }\r\n        });\r\n    }\r\n }","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiOutlineDirective } from './TiOutlineDirective';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiOutlineDirective],\r\n  declarations: [TiOutlineDirective]\r\n})\r\nexport class TiOutlineModule {\r\n}\r\nexport { TiOutlineDirective } from './TiOutlineDirective';\r\n","import { Component, ElementRef, ViewEncapsulation } from '@angular/core';\r\n/**\r\n * @ignore\r\n * ti-icon组件，为了防止多个组件重复使用字体图标文件，导致最终用户打包文件成倍增大，因此封装该组件，确保最终打包只引用一份字体图标样式及文件\r\n * TODO：考虑逐步去除这个i封装组件，采用ti-icon封装\r\n */\r\n@Component({\r\n  selector: ':not(ti-icon).ti3-icon',\r\n  template: '<ng-content></ng-content>',\r\n  styleUrls: ['./icon.less'],\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\n\r\nexport class TiIconClassComponent {\r\n  public nativeElement: any; // 宿主元素\r\n  constructor(protected hostRef: ElementRef) {\r\n    this.nativeElement = this.hostRef.nativeElement;\r\n  }\r\n}\r\n","import { AfterContentChecked, AfterContentInit, AfterViewChecked, AfterViewInit, Component, DoCheck, ElementRef,\r\n    Input, OnChanges, OnDestroy, OnInit, Renderer2, SimpleChanges } from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\n\r\n\r\n// 如果base有@Component，那么所有子类都不必写constructor了，应该跟constructor注入有关\r\n/**\r\n * 基类，已实现[id]，子类也可以使用hostRef, nativeElement, renderer\r\n */\r\n@Component({\r\n    selector: 'ti-base',\r\n    template: ''\r\n})\r\nexport class TiBaseComponent implements OnChanges, OnInit, DoCheck, AfterContentInit,\r\n    AfterContentChecked, AfterViewInit, AfterViewChecked, OnDestroy {\r\n    /**\r\n     * HTML属性id，自动化测试要求必须给id赋值\r\n     */\r\n    // TODO：改名字\r\n    @Input() id: string; // TODO:覆盖Angular的[id]变量。因为Angular[id]变量只能在ngAfterViewInit拿到，太迟。\r\n    /**\r\n     * @ignore\r\n     * 这里用any，原因HTMLElement->Element->Node, attributes定义的格式太死，不能有多余字段，可能是类型定义bug\r\n     * interface Node extends EventTarget {readonly attributes: NamedNodeMap;\r\n     */\r\n    public nativeElement: any; // 宿主元素\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2) {\r\n        this.nativeElement = this.hostRef.nativeElement;\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // id动态变化时，重新设置id\r\n        if (changes['id'] && !changes['id'].firstChange) {\r\n            this.setId();\r\n        }\r\n    }\r\n    ngOnInit(): void {\r\n        this.setId();\r\n    }\r\n    ngDoCheck(): void {\r\n    }\r\n    ngAfterContentInit(): void {\r\n    }\r\n    ngAfterContentChecked(): void {\r\n    }\r\n    ngAfterViewInit(): void {\r\n    }\r\n    ngAfterViewChecked(): void {\r\n    }\r\n    ngOnDestroy(): void {\r\n    }\r\n    // 给宿主设置Id\r\n    private setId(): void {\r\n        // 空id都自动创建id\r\n        if (Util.isEmptyString(this.id)) {\r\n            this.id = Util.getUniqueId('ti_auto_id');\r\n        }\r\n        this.renderer.setProperty(this.nativeElement, 'id', this.id);\r\n    }\r\n    /**\r\n     * 生成宿主Id：如果组件必须要有Id，那么调用此方法，无ID时会自动生成一个ID。\r\n     */\r\n    protected creatId(): void {\r\n        // 如果用户没有写宿主id\r\n        if (Util.isEmptyString(this.id)) {\r\n            // 生成唯一id\r\n            this.id = Util.getUniqueId('ti_auto_id');\r\n            this.setId();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 供内部子元素使用\r\n     * @example\r\n     * <span  [id]='appendId(\"label_span\")'>{{label}}</span>\r\n     * @param suffix 传入的字符串\r\n     * @returns 返回的字符串this.id + '_' + suffix\r\n     */\r\n    public appendId(suffix: string): string {\r\n        // 应该不存在空id了，因为所有组件都有自动生成id\r\n        return `${this.id}_${suffix}`;\r\n    }\r\n}\r\n/*\r\n用户写宿主id三种方式：\r\n1）给HTML属性id赋字符串id='mycheckbox',\r\n2）给HTML属性id赋变量[attr.id]='mycheckboxid',用户不太会这么用，暂不考虑支持。\r\n3）给DOM属性id赋变量[id]='mycheckboxid'\r\n组件开发读写宿主id的三种方法：\r\n1）读HTML属性id constructor(@Attribute('id') public id )\r\n2）写HTML属性id @HostBinding('attr.id') id: string;\r\n写DOM属性id @HostBinding('id') id: string;\r\n3）读写DOM属性id constructor(private hostRef: ElementRef ) ngAfterViewInit() { ...this.hostRef.nativeElement.id... }\r\n注意：\r\n1）开发Checkbox时，是类似属性指令的组件，宿主元素是input，其他组件暂未尝试。\r\n2）id='mycheckbox'，constructor就能拿到。但Angular[id]变量最早能在ngAfterViewInit()拿到，很迟。\r\n3）自己定义一个id变量，会覆盖angular的id变量，在ngOnInit()就可以拿到，很早。\r\n综上，nativeElement.id读写id，可以兼容以上三种用户写宿主id。\r\n方案一：ngAfterViewInit()取到Angular的id,很晚。但模板中需要使用id，设置太迟，需要强制刷新。\r\nngAfterViewInit() {\r\nthis.setId(); // 取得[id]变量赋值，必须在ngAfterViewInit()。其他周期拿不到。\r\n...\r\n}\r\nprivate setId() {\r\n// 如果用户没有写宿主id\r\nif (Util.isEmptyString(this.hostNode.id)) {\r\n// 生成唯一id\r\nthis.hostNode.id = Util.getUniqueId('checkbox');\r\n}\r\n// 获取宿主id\r\nthis.id = this.hostNode.id;\r\nthis.cdRef.detectChanges(); // 强制检测，刷新视图中使用的id变量。因为有时视图绘制更早，变量变化后试图未更新。\r\n// TODO: 强制检测变化会不会有性能负担？\r\n}\r\n方案二：自定义id覆盖覆盖Angular的[id]变量，ngOnInit()取到id，很早。无需强制刷新。\r\n@Input('id') id: string; // 覆盖Angular的[id]变量。因为Angular[id]变量只能在ngAfterViewInit拿到，太迟。\r\nngOnInit() {\r\n...\r\nthis.setId();\r\n}\r\nprivate setId() {\r\n// 如果用户没有写宿主id\r\nif (Util.isEmptyString(this.id)) {\r\n// 生成唯一id\r\nthis.id = Util.getUniqueId('checkbox');\r\n}\r\n// 设置宿主id\r\nthis.renderer.setProperty(this.hostNode, 'id', this.id);\r\n// this.cdRef.detectChanges(); // 无需强制检测\r\n}\r\n方案三：想办法尽早取到Angular的[id],暂无接口。\r\n可能Angular确实是在AfterViewInit前一刻才取到[id][disabled]。\r\nPrimeNG等库，也是用@Input('id')去覆盖[id] [disabled]等。\r\n\r\nChorme79版报相同id警告：\r\n<span  [id]='appendId(\"label_span\")'>{{label}}</span>\r\n原生标签这样写法，哪怕appendID函数返回空字符串，也会有存在id属性。这样页面中存在多个相同空id。\r\n解决方案：哪怕用户没有赋id，组件都会自动创建id，那么所有组件都有不同id，内部的span等也会有不同id。\r\n*/\r\n","import { Component, EventEmitter, forwardRef, Input, Output, SimpleChanges, Type } from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport { TiBaseComponent } from './TiBaseComponent';\r\nimport { TiBrowser } from '../../utils/Util';\r\n\r\n// SSR环境需要\r\ndeclare let global: any;\r\n\r\n// TODO: aria-label\r\n/**\r\n * 表单基类，已实现autofocus tabindex disabled focus() blur() focus/blur/change事件 ControlValueAccessor\r\n */\r\n@Component({// lib编译要求@Component\r\n    selector: 'ti-form',\r\n    template: ''\r\n})\r\nexport class TiFormComponent extends TiBaseComponent implements ControlValueAccessor {\r\n    /**\r\n     * HTML属性tabindex\r\n     */\r\n    @Input() tabindex: string = '0';\r\n    /**\r\n     * 是否禁用\r\n     */\r\n    @Input() disabled: boolean; // 因为Angualr原生[disabled]->setDisabledState机制在单选多选没有生效。所以，这里接管了。\r\n    /**\r\n     * HTML事件focus\r\n     */\r\n    // TODO：ip组件等是触发原生HTML的focus事件，便于校验？\r\n    // TODO：一行有两个tslint错误，无法临时消除\r\n    // tslint:disable-next-line:no-output-rename\r\n    @Output('focus') readonly focusEvent: EventEmitter<FocusEvent> = new EventEmitter<FocusEvent>();\r\n    /**\r\n     * HTML事件blur\r\n     */\r\n    // tslint:disable-next-line:no-output-rename\r\n    @Output('blur') readonly blurEvent: EventEmitter<FocusEvent> = new EventEmitter<FocusEvent>();\r\n    /**\r\n     * @ignore\r\n     * HTML事件change\r\n     */\r\n    // blur时model值改变触发change\r\n    // tslint:disable-next-line:no-output-rename\r\n    @Output('change') readonly changeEvent: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n    private focusCancelFns: Array<() => void>; // 监听foucs事件的取消句柄\r\n    private blurCancelFns: Array<() => void>; // 监听blur事件的取消句柄\r\n    private mousedownCancelFns: Array<() => void>; // 监听blur事件的取消句柄\r\n    private focusModel: any; // 落焦点时，记录model值\r\n\r\n    protected focusElem: any; // autofocus focus()将要聚焦的元素。默认是宿主元素，子类设置focusableElems后，为第一个非disabled可聚焦元素。\r\n    /**\r\n     * 整体focus/blur事件参与的元素，和disabled设置。\r\n     * 组件具有多个input输入框:\r\n     * 1)无元素聚焦->任一元素聚焦=整体聚焦事件。\r\n     * 2)任一元素失焦->其他元素无焦点=整体失焦事件。\r\n     */\r\n    private focusableElems: Array<any> = [];\r\n    // 实现表单4接口1注册\r\n    private _model: any;  // 传入模型值\r\n    private ngAfterViewCheckedFirst: boolean = true; // 是否第一次执行初始化\r\n\r\nprotected onModelChange: (model: any) => void; // 模型change回调函数，触发模型值改变\r\n    protected onModelTouched: () => void; // 模型blur回调函数，触发校验\r\n    protected focusedElem: any; // 已聚焦元素, 在子组件中有使用\r\n    /**\r\n     * @ignore\r\n     * 实现表单注册接口\r\n     * @param type 类型\r\n     * @returns 对象\r\n     */\r\n    public static getValueAccessor(type: Type<any>): any {\r\n        return {\r\n            provide: NG_VALUE_ACCESSOR,\r\n            // tslint:disable-next-line:no-forward-ref\r\n            useExisting: forwardRef(() => type),\r\n            multi: true\r\n        };\r\n    }\r\n    /**\r\n     * 是否组件整体聚焦\r\n     */\r\n    public get focused(): boolean {\r\n        return this.nativeElement.attributes.tiFocused !== undefined;\r\n    }\r\n    /**\r\n     * 为Dom元素添加/移除属性，此处用于disabled和focused属性的操作\r\n     * @param  element 需要操作的Dom元素\r\n     * @param  attr 操作的属性\r\n     * @param  value 属性值，为true时属性值即为属性值,为false时，移除属性\r\n     */\r\n    protected setAttr(element: any, attr: string, value: boolean): void {\r\n        // 如果可聚焦元素是原生input等，[disabled]属性会生效。\r\n        // this.renderer.setProperty(this.focusElem, 'disabled', isDisabled); // 参照angular官方设置disabled源码，true和fasle都考虑了\r\n        // 如果可聚焦元素是组件、div，[disabled]属性不会生效。但setAttribute会增加一项html属性。setProperty不增加。\r\n        if (value) {\r\n            this.renderer.setAttribute(element, attr, attr);\r\n        } else {\r\n            this.renderer.removeAttribute(element, attr);\r\n        }\r\n    }\r\n    ngOnInit() {\r\n        super.ngOnInit();\r\n        // 表单中统一加该属性，用于表单校验中的样式选择器\r\n        this.renderer.setAttribute(this.nativeElement, 'tiForm', '');\r\n    }\r\n    /**\r\n     * 监听disabled变化\r\n     */\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        if (changes['disabled']) {\r\n            this.setDisabledState(changes['disabled'].currentValue);\r\n        }\r\n    }\r\n    /**\r\n     * 注意：子类继承自Form基类，如果有this.setFocusableElems([xxx]), 那么要更晚调用super.ngAfterViewChecked()。\r\n     * 子类ngAfterViewChecked(): void {\r\n     *      this.setFocusableElems([xxx]);\r\n     *      // 更晚调用super\r\n     *      super.ngAfterViewChecked();\r\n     * }\r\n     */\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        if (this.ngAfterViewCheckedFirst) {\r\n            this.ngAfterViewCheckedFirst = false;\r\n            // 尽量延迟autoFocus的执行。因为有些组件在ngAfterViewInit才拿得到ngFor ngIf内的元素作为可聚焦元素。\r\n            this.autoFocus();\r\n        }\r\n    }\r\n    /**\r\n     * 当做生命周期用吧，监听模型值变化。包括writeValue和this.model=赋值 这两个时刻。\r\n     * @param model 模型值\r\n     */\r\n    protected ngOnModelChange(model: any): void {\r\n    }\r\n    /**\r\n     * 设置tab键/点击时的聚焦元素，会顺便设置组件focus()聚焦时可聚焦元素（第一个非disabled的可聚焦元素）。\r\n     * 当可聚焦元素变动，或者单一元素disabled状态变动，都要重新调用此方法设置。\r\n     * 建议一般在ngOnInit生命周期调用，如果ngFor/ngIf内元素在ngOnInit找不到那么可在ngAfterViewInit生命周期调用。\r\n     * 注意：所有生命周期，都要调用类似super.ngOnInit()\r\n     *\r\n     * @param elems 可聚焦元素数组Array<Element>，第一个非disabled元素为整个组件的可聚焦元素。\r\n     *\r\n     * 目前使用分为几种情况：\r\n     * 1）一般表单组件，含有可聚焦子元素。\r\n     * 组件主动设置可聚焦元素数组this.setFocusableElems([xxxElement, yyyElement]);\r\n     * 2）有的表单组件，永远不聚焦。\r\n     * slider/list/menulist/droplist，统一不调用此接口。\r\n     * a.不调用接口时，@Input() tabindex: string = '0';未生效。但用户在html标签上设置的属性tabindex=\"0\"等，会生效。\r\n     * b.调用了this.setFocusableElems([]);时，强制清除了标签属性tabindex。用户设置的属性tabindex=\"1\"，会无效，不出现在标签上。\r\n     * 3）少量组件，内部没有可聚焦元素。但是皮儿需要聚焦，ti-dominator。\r\n     * 需要设置this.setFocusableElems([this.nativeElement]);\r\n     */\r\n    protected setFocusableElems(elems: Array<any>): void {\r\n        if (!elems) {\r\n            // 不支持组件传入 null 和undefined，支持传入[]\r\n            return ;\r\n        }\r\n        // TODO: 第二次调用时，如果焦点元素减少，那么需要处理tabindex\r\n        // TODO: 支持用户动态第二次设置setFocusableElems。其实，actionmenu会动态设置\r\n        this.focusableElems = elems;\r\n        // 将要上焦点的元素\r\n        this.setFocusElem();\r\n        // 给所有子元素添加tabindex。\r\n        this.setElemsTabindex();\r\n        // 设置宿主标签上的focus()/blur()方法\r\n        this.setNativeElementFocusFn();\r\n        // 设置focus/blur事件监听\r\n        this.setFocusEvents();\r\n    }\r\n    /**\r\n     *  调用focus()函数，会触发组件整体聚焦，此时焦点元素。\r\n     */\r\n    private setFocusElem(): void {\r\n        this.focusElem = undefined;\r\n        // 寻找第一个非disabled元素，作为可聚焦元素\r\n        for (const elem of this.focusableElems) {\r\n            if (elem && elem.attributes.disabled === undefined) {\r\n                this.focusElem = elem;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 去除皮上的tabindex，给内部可聚焦子元素添加tabindex\r\n     * 当然，特殊情况：this.setFocusableElems([this.nativeElement]);时，又会给皮上补上tabindex\r\n     * 本来此方法，可以合入setFocusEvents()，减少遍历循环。但为了清晰，依然单独为函数。\r\n     */\r\n    private setElemsTabindex(): void {\r\n        // 去除组件标签上的tabindex属性。\r\n        this.renderer.removeAttribute(this.nativeElement, 'tabindex');\r\n        this.focusableElems.forEach((elem: any) => {\r\n            // 给每一个元素添加tabindex\r\n            this.setTabindex(elem);\r\n        });\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public getFocusableElems(): Array<any> {\r\n        return this.focusableElems;\r\n    }\r\n    /**\r\n     * 宿主元素标签上添加类似原生focus()方法。\r\n     * 用户调用方法: document.getElementById('ti-xxx').focus();\r\n     * 其实，更推荐调用组件实例上的方法tiXxxComp.focus();\r\n     */\r\n    private setNativeElementFocusFn(): void {\r\n        // 注意：这里必须用箭头函数，以保证运行时this变量不变。\r\n        if (this.focusElem !== this.nativeElement) { // 避免无限循环调用，所以要有此条件限制\r\n            // SSR环境直接返回，是因为SSR环境报错：Cannot assign to read only property 'focus' of object \r\n            // 采用['nativeElement']['focus']也解决不了\r\n            if (typeof global !== 'undefined') {\r\n                return;\r\n            }\r\n            this.nativeElement.focus = (): void => {\r\n                this.focus();\r\n            };\r\n            this.nativeElement.blur = (): void => {\r\n                this.blur();\r\n            };\r\n        }\r\n    }\r\n    /**\r\n     * 设置组件中的可聚焦元素并监听事件\r\n     */\r\n    private setFocusEvents(): void {\r\n        // if (elems.length === 1 && this.focusableElems && this.focusableElems.length > 1) {\r\n        //     // 多聚焦元素，第二次setFocusElem()时，elems长度为1，也会走到这里，返回。\r\n        //     return;\r\n        // }\r\n        // 取消原有的focus/blur监听\r\n        if (this.focusCancelFns) {\r\n            this.focusCancelFns.forEach((fn: () => void) => fn());\r\n        }\r\n        if (this.blurCancelFns) {\r\n            this.blurCancelFns.forEach((fn: () => void) => fn());\r\n        }\r\n        if (this.mousedownCancelFns) {\r\n            this.mousedownCancelFns.forEach((fn: () => void) => fn());\r\n        }\r\n        // 建立新的focus/blur监听\r\n        this.focusCancelFns = new Array<any>();\r\n        this.blurCancelFns = new Array<any>();\r\n        this.mousedownCancelFns = new Array<any>();\r\n\r\n        this.focusableElems.forEach((elem: any) => {\r\n            this.focusCancelFns.push(this.renderer.listen(elem, 'focus', this.focusCallbackFn));\r\n            this.blurCancelFns.push(this.renderer.listen(elem, 'blur', this.blurCallbackFn));\r\n        });\r\n    }\r\n    /**\r\n     * focus回调函数\r\n     */\r\n    private focusCallbackFn: ((event: FocusEvent) => void) = (event: FocusEvent) => {\r\n        this.focusedElem = event.target;\r\n        // 非IE浏览器支持event.relatedTarget，使用event.relatedTarget进行处理\r\n        if (!TiBrowser.isIE()) {\r\n            // 当为内部焦点转移，不做处理\r\n            if (this.focusableElems.length > 1 &&\r\n                this.focusableElems.includes(event.relatedTarget)) {\r\n                return;\r\n            }\r\n        } else {// IE浏览器的处理：浏览器不支持relatedTarget情况下的处理，参见blur中的说明\r\n            if ((event.target as any).tiFocusFrom) {\r\n\r\n                // return;\r\n                // 情况一：失焦后强制聚焦\r\n                if (event.target === (event.target as any).tiFocusFrom) {\r\n                    // 面板滚动条IE兼容：在focusin中，让失焦元素强制聚焦，会走到这里。\r\n\r\n                    return;\r\n                }\r\n                // 情况二：内部焦点转移\r\n                if (this.focusableElems.length > 1 &&\r\n                    this.focusableElems.includes((event.target as any).tiFocusFrom)) {\r\n\r\n                    return;\r\n                }\r\n                // 情况三：较难理解：外部焦点转移时，(event.target as any).tiFocusFrom也是有值的。\r\n                // 这种情况，是因为组件嵌套使用，此聚焦元素分别从属于多个组件。\r\n                // 对于A组件来说，是焦点内部转移。对于B组件来说，是焦点外部转移。\r\n            }\r\n        }\r\n        // 设置宿主元素的聚焦属性，用于标识该组件处于聚焦状态，该属性可用于css选择器：在宿主元素上增加属性focused\r\n        this.setAttr(this.nativeElement, 'tiFocused', true);\r\n        // 触发整体聚焦事件\r\n        this.focusEvent.emit(event);\r\n        // 保存focus时model值，blur时如果model值改变，则发送change事件\r\n        this.focusModel = this.model;\r\n    }\r\n    /**\r\n     * blur 回调函数\r\n     */\r\n    private blurCallbackFn: ((event: FocusEvent) => void) = (event: FocusEvent) => {\r\n        // 非IE浏览器支持event.relatedTarget，使用event.relatedTarget进行处理\r\n        if (!TiBrowser.isIE()) {\r\n            // 当为内部焦点转移，不做处理\r\n            if (this.focusableElems.length > 1 &&\r\n                this.focusableElems.includes(event.relatedTarget)) {\r\n                return;\r\n            }\r\n        } else {\r\n\r\n            // 已经失焦的元素，清除记录焦点从哪里而来。\r\n            (event.target as any).tiFocusFrom = undefined;\r\n\r\n            // 如果失焦元素强制聚焦，不触发整体失焦事件。\r\n            if (event.target === document.activeElement) {\r\n                // 面板滚动条IE兼容：在focusin中，让失焦元素强制聚焦，会走到这里。\r\n                // 即将聚焦（实际上已经聚焦）的元素，记录一下焦点从哪儿来：从自己来的\r\n                (document.activeElement as any).tiFocusFrom = event.target;\r\n\r\n                return;\r\n            }\r\n\r\n            // 浏览器不支持relatedTarget:IE下不支持\r\n            // 判断是否为内部焦点转移通过元素方法：\r\n            // 两个元素的焦点切换时，会先触发a元素的失焦，再触发b元素的聚焦\r\n            // a失焦处理：当前聚焦元素为该元素的可聚焦元素时，则认为是内部焦点转移，并且将聚焦元素的relatedTarget赋值为当前失焦元素，方便blur时的处理；\r\n            // b聚焦处理：判断当前聚焦元素的relatedTarget是否为内部可聚焦元素，如果是的话，则判定其为内部焦点转移\r\n            if (this.focusableElems.length > 1 &&\r\n                this.focusableElems.includes(document.activeElement)) {\r\n                // 即将聚焦（实际上已经聚焦）的元素，记录一下焦点从哪儿来。\r\n                (document.activeElement as any).tiFocusFrom = event.target; // element setAttribute赋值不支持对象形式，因此使用该方式\r\n\r\n                return;\r\n            }\r\n        }\r\n        this.focusedElem = undefined;\r\n        // 取消宿主元素的聚焦属性\r\n        this.setAttr(this.nativeElement, 'tiFocused', false);\r\n        // 触发整体失焦事件\r\n        this.blurEvent.emit(event);\r\n        // blur时如果model值改变，则发送change事件\r\n        if (this.model !== this.focusModel) {\r\n            this.changeEvent.emit(this.model);\r\n        }\r\n        // 触发组件的touched回调，标志其已被touch过\r\n        if (this.onModelTouched) {\r\n            this.onModelTouched();\r\n        }\r\n    }\r\n    /**\r\n     * 聚焦方法。类似HTML DOM节点方法focus\r\n     */\r\n    public focus(): void {\r\n        if (this.focusElem) {\r\n            this.focusElem.focus();\r\n        }\r\n    }\r\n    /**\r\n     * 失焦方法。类似HTML DOM节点方法blur\r\n     */\r\n    public blur(): void {\r\n        if (this.focusedElem) {\r\n            this.focusedElem.blur(); // 只对当前聚焦元素进行失焦处理\r\n        }\r\n    }\r\n    /**\r\n     * Tiny组件各种行为，尽量和原生一致。 autofocus也许可以做成一个指令\r\n     * Tiny3新增：增加初始化焦点autofocus支持。IE9本来不支持autofocus，这时也支持了\r\n     */\r\n    private autoFocus(): void {\r\n        if (this.nativeElement.attributes.autofocus) {\r\n            this.focus();\r\n        }\r\n    }\r\n    /**\r\n     * 实现类表单组件的set和get方法\r\n     */\r\n    get model(): any {\r\n      return this._model;\r\n    }\r\n    /**\r\n     * 设置model值，如果有变化，则触发ngModelChange\r\n     */\r\n    set model(model: any) {\r\n        if (this._model === model) {\r\n            return;\r\n        }\r\n        this._model = model;\r\n        if (this.onModelChange) {\r\n            this.onModelChange(model);\r\n        }\r\n        this.ngOnModelChange(model);\r\n    }\r\n    /* 表单4接口start */\r\n    /**\r\n     * @ignore\r\n     * 如果用户改变了[ngModel]绑定的变量，那么Angular会通知到这里\r\n     * 子类如果没有特殊需求，都需要首行调用super.writeValue（xxx）\r\n     *\r\n     * super.writeValue 和 this.model=xxx的区别：\r\n     * super.writeValue不会触发ngModelChange\r\n     * this.model=xxx会触发ngModelChange\r\n     * @param model any类型\r\n     */\r\n    writeValue(model: any): void {\r\n        this._model = model;\r\n        this.ngOnModelChange(model);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * Angular将(ngModelChange)绑定的函数，通知到这里。\r\n     * 当组件内部model值改变，需要调用这个函数向外通知。\r\n     * @param fn 回调函数\r\n     */\r\n    registerOnChange(fn: (model: any) => void): void {\r\n        this.onModelChange = fn;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * Blur时，或者需要校验时，需要调用此函数。（可能描述不准确，需要再查资料）\r\n     * @param fn 回调函数\r\n     */\r\n    registerOnTouched(fn: () => void): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 用户绑定在[disabled]上的变量变化，会通知到这里。\r\n     * ti-xxx组件皮上设置[disabled]，会给皮上设置disabled属性，也会给所有可聚焦元素设置disabled属性。\r\n     * 如有特殊需求，子类可以不使用super.setDisabledState(), 而是直接覆盖。\r\n     * Angular原生[disabled]机制：checkbox/radio走不进原生setDisabledState()。原生[disabled][id]等取值也很晚。\r\n     * 注意: Form基类@Input() disabled已经接管了Angular原生[disabled]机制。\r\n     * ngOnChanges监听到disabled值（第一次和后续改变），会通知到这里。\r\n     * @param isDisabled 是否禁用\r\n     */\r\n    setDisabledState?(isDisabled: boolean): void {\r\n        // 表单this.form.controls.myselect.disable();会直接通知到这里，但不会通知到ngOnChanges。所以要设置this.disabled =\r\n        this.disabled = isDisabled;\r\n        // 给宿主添加disabled属性\r\n        this.setAttr(this.nativeElement, 'disabled', isDisabled);\r\n        // 给聚焦事件元素添加disabled属性\r\n        this.focusableElems.forEach((element: any) => {\r\n            this.setAttr(element, 'disabled', isDisabled);\r\n            // 如果可聚焦元素是自定义组件、div等，那么标签上的disabled属性不生效。\r\n            // 需要借助于tabindex控制是否允许焦点。\r\n            // 控制禁用样式，方案一：（推荐）less里[disabled]属性模仿伪类，ti-xxx皮上的[disabled]更可靠\r\n            // 方案二：html的ngClass用Form基类disabled变量。\r\n            this.setTabindex(element);\r\n        });\r\n    }\r\n    /**\r\n     * 设置tabindex\r\n     * @param element 原生标签元素\r\n     */\r\n    private setTabindex(element: any): void {\r\n        // 整体禁用，或者小元素被禁用。\r\n        if (element.attributes.disabled) {\r\n            // 禁用时\r\n            this.renderer.removeAttribute(element, 'tabindex');\r\n            // A和input已经有disabled属性了，不需要加tabindex\r\n            // 普通元素，也不需要加tabindex\r\n\r\n            // A标签禁用时想要点击和tab都不落焦点，唯一方法是去除href\r\n            if (element.tagName === 'A') {\r\n                this.renderer.removeAttribute(element, 'href');\r\n            }\r\n        } else {\r\n            if (element.tagName === 'A') {\r\n                // 特例：A标签不设置tabindex='0'。Chrome浏览器不设置tabindex效果：点击时无蓝框，tab时有蓝框。\r\n                if (this.tabindex === '0') {\r\n                    this.renderer.removeAttribute(element, 'tabindex');\r\n                } else {\r\n                    this.renderer.setAttribute(element, 'tabindex', this.tabindex);\r\n                }\r\n                // disabled时去除的href，添加回来\r\n                if (!element.attributes.href) {\r\n                    // 默认所有的A标签都是tiny使用的标签，href都是javascript:void(0)\r\n                    this.renderer.setAttribute(element, 'href', 'javascript:void(0)');\r\n                }\r\n            } else {\r\n                this.renderer.setAttribute(element, 'tabindex', this.tabindex);\r\n            }\r\n        }\r\n    }\r\n    /* 表单4接口end */\r\n}\r\n/**\r\n * tabindex相关知识：\r\n * 所有已设置tabindex的元素，都会点击聚焦。哪怕<div tabindex=\"-1\">test</div>也会点击聚焦。\r\n * Tab键，会按照顺序聚焦：1,2,3,4，...0，按照此顺序聚焦。\r\n * tabindex='-1'不参与Tab键, 但是可以点击聚焦。\r\n * A标签不设置tabindex效果：Chrome浏览器点击时无蓝框，tab时有蓝框。其他浏览器有差异。\r\n * A标签禁用时想要点击和tab都不落焦点，唯一方法是去除href\r\n * input标签不设置tabindex效果：Chrome浏览器点击时/tab时都有蓝框。\r\n * 如果设置tabindex='',或者tabindex='tabindex'，这样非法设置，Chrome相当于没有设置。其他浏览器有差异\r\n */\r\n","import { Component, ElementRef, HostListener, Input, ViewChild } from '@angular/core';\r\nimport { Util } from '../../utils/Util'\r\nimport { TiFormComponent } from './TiFormComponent';\r\n// 编译lib要求注册Component，不能用抽象类\r\n/**\r\n * 单选/多选共同的基类。单选多选唯一的差异：单选只有在未选状态才接受空格键改变状态。\r\n */\r\n@Component({// lib编译要求@Component\r\n    selector: 'ti-radiobase',\r\n    template: ''\r\n})\r\nexport class TiRadioBaseComponent extends TiFormComponent {\r\n    /**\r\n     * 绑定的可点击文字。\r\n     */\r\n    @Input() label: string; // Tiny3新增\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('labelRef', /* TODO: add static flag */ { static: true }) private labelRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('proxyRef', /* TODO: add static flag */ { static: true }) private proxyRef: ElementRef;\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.creatId();\r\n        this.setFocusableElems([this.proxyRef.nativeElement]);\r\n        this.moveNode();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        this.renderer.removeChild(this.renderer.parentNode(this.nativeElement), this.renderer.nextSibling(this.nativeElement));\r\n    }\r\n\r\n    /**\r\n     * 将input子元素label，调整为兄弟元素。\r\n     */\r\n    private moveNode(): void {\r\n        const parentNode: any = this.renderer.parentNode(this.nativeElement);\r\n        const nextNode: any  = this.renderer.nextSibling(this.nativeElement);\r\n        this.renderer.insertBefore(parentNode, this.labelRef.nativeElement, nextNode);\r\n    }\r\n\r\n    // Tiny3 TODO: 原始节点改为0高度，不显示。那么所有宿主元素focus都转移到proxy。\r\n    // @HostListener('focus') onHostFocus() {\r\n    //       Logger.log('onHostFocus');\r\n    //       this.proxyNode.focus();\r\n    //   }\r\n    /**\r\n     * @ignore\r\n     * 点选元素后，聚集到对应的checkbox-skin\r\n     * 经赵梦测试，这段逻辑，是为了解决radio火狐下tab键只聚焦不选中。\r\n     * @param event 鼠标点击事件\r\n     */\r\n    @HostListener('click', ['$event']) public onHostClick(event: MouseEvent): void {\r\n        if (!this.nativeElement.disabled) {\r\n            this.focusElem.focus();\r\n        }\r\n    }\r\n\r\n    // 阻止事件冒泡：当子组件中有input元素时，change事件会冒泡到父组件\r\n    // 问题：多选树模板包含复选框组件，树组件中有自己的change事件，点击复选框会触发两次change事件\r\n    // 一次是树组件自身触发，一次是复选框组件冒泡，故需阻止该事件，例如下边代码会打印日志\r\n    @HostListener('change', ['$event']) public onHostChange(event: Event): void {\r\n        event.stopPropagation();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 阻止checkbox-skin和checkbox-label的事件冒泡，防止上层dom绑定的事件被多次触发\r\n     * 原因：span和label使用for和input关联，input上的click等事件也会触发span/label的事件处理，\r\n     * 如果不做处理，上层dom绑定的事件会被触发两次\r\n     * @param event 鼠标点击事件\r\n     */\r\n    public onLabelClick(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 快捷键的处理(Enter和Space)：考虑到交互的友好性及与原生的一致性，\r\n     * 在keyup中做相应的事件处理(keydown和keypress会存在一次点击，多次触发的情况);\r\n     * 此外，需要阻止浏览器默认事件（空格键会触发页面滚动条滚到底部的行为，\r\n     * 默认事件的阻止需要在keyup之前，因此此处在keydown中阻止）\r\n     * @param event 键盘按键事件\r\n     */\r\n    public onSpaceKeydown(event: KeyboardEvent): void { // with type info\r\n        if (!this.nativeElement.disabled) {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @param event 键盘按键事件\r\n     */\r\n    public onSpaceKeyup(event: KeyboardEvent): void { // with type info\r\n        if (!this.nativeElement.disabled && this.canChange()) {\r\n            this.nativeElement.checked = !this.nativeElement.checked; // 设置元素的选中状态\r\n            // this.cdRef.detectChanges();  执行并不能触发checked改变检查，所以只有下面的change事件才可以。\r\n            // 触发check原生的change事件\"createEvent\" in document. 因为原生只有blur时才触发onchange\r\n            Util.trigger(this.nativeElement, 'change');\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 这是单选多选唯一的差异：单选只有在未选状态才接受空格键改变状态。\r\n     * @returns 默认返回true，多选框会继承这个方法。单选框重写这个方法。\r\n     */\r\n    protected canChange(): boolean {\r\n        return true;\r\n    }\r\n}// end of class\r\n\r\n// Tiny3去除：不再操作宿主tabindex。取消input元素的tab聚焦行为(input 可聚焦情况下，tab键切换时会聚焦该元素)\r\n// this.renderer.setAttribute(hostNode, 'tabindex', '-1'); // 经测试，display：none元素压根拿不到焦点。\r\n// Tiny3去除：不再支持fosused属性。\r\n// if ( this.nativeElement.focused !== this.hostAttrOld.focused) {\r\n//   Logger.log('change hostAttrOld.focused');\r\n//   if (this.nativeElement.focused) {\r\n//       this.mySkinRef.nativeElement.focus();\r\n//   }\r\n//   this.hostAttrOld.focused = this.nativeElement.focused;\r\n// Tiny3去除：增加对半选状态的支持。改为用户在模板上直接操作indeterminate\r\n// const partialCheck = this.nativeElement.getAttribute('partialCheck');\r\n// if (partialCheck !== this.hostAttrOld.partialCheck) {\r\n//   Logger.log('change partialCheck=' + partialCheck);\r\n//   this.nativeElement.indeterminate = partialCheck;\r\n//   this.hostAttrOld.partialCheck = partialCheck;\r\n// }\r\n// Tiny3去除：event.which ||\r\n","import { Component, Input, SimpleChanges } from '@angular/core';\r\nimport { TiFormComponent } from './TiFormComponent';\r\n/**\r\n * 复原完整model对象基类，基于valueKey时，select/buttongroup实现复原选中值到完整对象\r\n */\r\n@Component({// lib编译要求@Component\r\n    selector: 'ti-whole',\r\n    template: ''\r\n})\r\nexport class TiWholeComponent extends TiFormComponent {\r\n    /**\r\n     * 当存在valueKey时，选中值基于valueKey\r\n     *\r\n     * 10.0.1新增\r\n     */\r\n    @Input() valueKey: string;\r\n    private _modelWhole: any;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public get modelWhole(): any {\r\n        return this._modelWhole;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 用户点选时modelWhole改变，要同时更改model\r\n     */\r\n    public set modelWhole(value: any) {\r\n\r\n        this._modelWhole = value;\r\n        if (this.valueKey && value !== undefined && value !== null) {\r\n            // 存在valueKey，且value不为空\r\n            this.model = this['multiple'] ?\r\n                value.map((item: any) => this.valueFn(item))\r\n                : this.valueFn(value);\r\n        } else {\r\n            this.model = value;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 找到value值的函数\r\n     */\r\n    @Input() valueFn: (item: any) => any = (item: any) => {\r\n        return item[this.valueKey];\r\n        // tslint:disable-next-line:semicolon\r\n    }; // 这个分号是书写正确的\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // 监听 options/items 变化\r\n        if ((changes['options'] || changes['items']) && this.valueKey && this.model) {\r\n            // 存在 valueKey 时，modelWhole 需通过匹配 valueKey 来重新赋值（解决动态改变options/items时选中项不高亮问题 issues#1332）\r\n            this.writeValue(this.model);\r\n        }\r\n    }\r\n    /**\r\n     * 每次用户主动设置ngModel值时，需要顺便更改modelWhole\r\n     * @param model 设置的ngModel值\r\n     */\r\n    writeValue(model: any): void {\r\n        super.writeValue(model);\r\n        if (this.valueKey && model !== undefined && model !== null) { // 存在valueKey，且value不为空\r\n            // 历史设计缺陷：select总数据集是options，buttongroup总数据集时items\r\n            const options: Array<any> = this['options'] ? this['options'] : this['items'];\r\n            // 直接去写内部值，不触发set函数\r\n            this._modelWhole = this['multiple'] ?\r\n                options.filter((item: any) => model.includes(this.valueFn(item))) :\r\n                options.find((item: any) => this.valueFn(item) === model);\r\n        } else {\r\n            this._modelWhole = model;\r\n        }\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { TiBaseComponent } from './TiBaseComponent';\r\n\r\n/**\r\n * @ignore\r\n * 该基类用于组件设置autofocsu时获取焦点，涉及组件button、text、textarea\r\n */\r\n\r\n@Component({\r\n    selector: 'ti-autofocus',\r\n    template: ''\r\n})\r\n\r\nexport class TiAutofocusComponent extends TiBaseComponent {\r\n    /**\r\n     * 此处在ngAfterViewInit生命周期内调用focus方法，因为textarea组件较为特殊\r\n     * textarea组件在ngAfterViewInit会将宿主元素包裹在一层dom中，在此之前调用focus方法，获取不到焦点\r\n     */\r\n    ngAfterViewInit(): void {\r\n        if (this.nativeElement.attributes.autofocus) {\r\n            this.nativeElement.focus();\r\n        }\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { TiBaseComponent } from './TiBaseComponent';\r\nimport { TiFormComponent } from './TiFormComponent';\r\nimport { TiRadioBaseComponent } from './TiRadioBaseComponent';\r\nimport { TiWholeComponent } from './TiWholeComponent';\r\nimport { TiAutofocusComponent } from './TiAutofocusComponent';\r\n// 在使用tiny npm包生产环境编辑时，要求基类也注册。\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [],\r\n  exports: [],\r\n  declarations: [\r\n    TiBaseComponent,\r\n    TiFormComponent,\r\n    TiRadioBaseComponent,\r\n    TiWholeComponent,\r\n    TiAutofocusComponent\r\n  ]\r\n})\r\nexport class TiBaseModule {\r\n}\r\nexport { TiBaseComponent } from './TiBaseComponent';\r\nexport { TiFormComponent } from './TiFormComponent';\r\nexport { TiRadioBaseComponent } from './TiRadioBaseComponent';\r\nexport { TiWholeComponent } from './TiWholeComponent';\r\nexport { TiAutofocusComponent } from './TiAutofocusComponent';\r\n","import { Component, Input, SimpleChange, SimpleChanges, ViewEncapsulation } from '@angular/core';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n// TODO：如果封装为胶囊样式，DOM内部多一层，比现在优劣？\r\n/**\r\n *  Icon组件\r\n *\r\n *  Icon组件可以设置显示Icon。\r\n *\r\n * <example-url>../tiny3demo/#/icon/icon-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-icon',\r\n    template: '<ng-content></ng-content>',\r\n    styleUrls: ['./icon.less'],\r\n    host: {\r\n        '[class.ti3-icon]': 'true'\r\n    },\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class TiIconComponent extends TiBaseComponent {\r\n    /**\r\n     * icon名称\r\n     */\r\n    @Input() name: string;\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        const nameChange: SimpleChange = changes['name'];\r\n        if (nameChange) {\r\n            this.renderer.removeClass(this.nativeElement, `ti3-icon-${nameChange.previousValue}`);\r\n            this.renderer.addClass(this.nativeElement, `ti3-icon-${nameChange.currentValue}`);\r\n        }\r\n    }\r\n}\r\n/* ti-icon组件，为了防止多个组件重复使用字体图标文件，导致最终用户打包文件成倍增大。\r\n因此封装该组件，确保最终打包只引用一份字体图标样式及文件 */\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIconClassComponent } from './TiIconClassComponent';\r\nimport { TiIconComponent } from './TiIconComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiIconClassComponent, TiIconComponent],\r\n  declarations: [TiIconClassComponent, TiIconComponent]\r\n})\r\nexport class TiIconModule {\r\n}\r\nexport { TiIconComponent } from './TiIconComponent';\r\nexport { TiIconClassComponent } from './TiIconClassComponent';\r\n","import { Component, Input } from '@angular/core';\r\nimport { TiAccordionItemComponent } from './TiAccordionItemComponent';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * 手风琴组件，\r\n * 用于实现多个折叠面板的呈现方式，通过ti-accordion、ti-accordion-item、ti-accordion-head组件嵌套方式实现\r\n *\r\n * <p><span style=\"color: red\">使用此组件时需要开发者在项目模块(建议在根模块)\r\n * 中引入BrowserAnimationsModule。</span>这是因为此组件中使用了Angular动画，需要引入BrowserAnimationsModule，\r\n * 但是 BrowserAnimationsModule 不能在懒加载模块被重复引入，所以需要开发者来引入BrowserAnimationsModule，保证其引入一次。</p>\r\n *\r\n * <example-url>../tiny3demo/#/accordion/acc-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-accordion',\r\n    templateUrl: './accordion.html',\r\n    styleUrls: ['./accordion.less'],\r\n    host: {\r\n        '[class.ti3-accordion-group]': 'true'\r\n    }\r\n})\r\nexport class TiAccordionComponent extends TiBaseComponent {\r\n    /**\r\n     * 展开某一项时，是否关闭其它项\r\n     */\r\n    @Input() closeOthers: boolean = true;\r\n    /**\r\n     * 头部样式类\r\n     */\r\n    @Input() headClass: string = '';\r\n    /**\r\n     * 内容体样式类\r\n     */\r\n    @Input() bodyClass: string = '';\r\n\r\n    protected items: Array<TiAccordionItemComponent> = [];\r\n    /**\r\n     * @ignore\r\n     * 关闭其余item\r\n     */\r\n    closeOtherItems(openItem: TiAccordionItemComponent): void {\r\n        if (!this.closeOthers) {\r\n            return;\r\n        }\r\n        this.items.forEach((item: TiAccordionItemComponent) => {\r\n            if (item.open && item !== openItem) {\r\n                item.open = false;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 添加某一accordion条目到items数组中\r\n     */\r\n    addItem(item: TiAccordionItemComponent): void {\r\n        this.items.push(item);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 从items数组中删除某一accordion条目\r\n     */\r\n    removeItem(item: TiAccordionItemComponent): void {\r\n        const index: number = this.items.indexOf(item);\r\n        if (index !== -1) {\r\n            this.items.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n","import { Component, ElementRef, EventEmitter, Inject, Input, Output, Renderer2, ViewEncapsulation } from '@angular/core';\r\nimport { TiAccordionComponent } from './TiAccordionComponent';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * 定义手风琴组件单个折叠面板，该组件包含在ti-accordion标签中\r\n * <example-url>../tiny3demo/#/accordion/acc-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-accordion-item',\r\n    templateUrl: './accordion-item.html',\r\n    styleUrls: ['./accordion.less'],\r\n    host: {\r\n        '[class.ti3-accordion-panel]': 'true'\r\n    }\r\n})\r\nexport class TiAccordionItemComponent extends TiBaseComponent {\r\n    /**\r\n     * 单个折叠面板项是否灰化\r\n     */\r\n    @Input() disabled: boolean = false;\r\n    /**\r\n     * 设置用户点击某一折叠面板的head时是否自动实现内容体展示状态切换\r\n     *\r\n     * 头部局部点击可切换场景，需要通过设置该变量实现\r\n     */\r\n    @Input() clickToggle: boolean = true;\r\n    /**\r\n     * 某一折叠面板的头部点击回调\r\n     */\r\n    @Output() readonly headClick: EventEmitter<Event> = new EventEmitter();\r\n\r\n    /**\r\n     * @ignore\r\n     * 头部class,需要显示声明，否则ngClass会报错\r\n     */\r\n    public headClass: string = '';\r\n    /**\r\n     * @ignore\r\n     * body class,需要显示声明，否则ngClass会报错\r\n     */\r\n    public bodyClass: string = '';\r\n    /**\r\n     * @ignore\r\n     * 依赖注入tiAccordion（后续使用其方法）\r\n     */\r\n    constructor(@Inject(TiAccordionComponent) private accordion: TiAccordionComponent,\r\n                hostRef: ElementRef, renderer: Renderer2) {\r\n        super(hostRef, renderer);\r\n    }\r\n\r\n    // 面板展开状态获取/设置：此处处理涉及到内部和外部修改，因此此处通过set/get进行处理\r\n    private isOpen: boolean = false;\r\n    /**\r\n     * 单个折叠面板是否处于展开状态，用于初始化设置，默认值为false\r\n     *\r\n     */\r\n    @Input()\r\n    /**\r\n     * @ignore\r\n     */\r\n    get open(): boolean {\r\n        return this.isOpen;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    set open(value: boolean) {\r\n        if (value !== this.open) {\r\n            if (value) {// open属性更新且open值为true时，处理其它item的关闭状态\r\n                this.accordion.closeOtherItems(this);\r\n            }\r\n            this.isOpen = value;\r\n        }\r\n    }\r\n\r\n    // 初始化处理：添加当前item到列表中,设置该item的id值\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.accordion.addItem(this);\r\n        this.headClass = this.accordion.headClass;\r\n        this.bodyClass = this.accordion.bodyClass;\r\n    }\r\n\r\n    // item销毁处理：移除item列表中的该项数据\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        this.accordion.removeItem(this);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * item头部点击事件逻辑处理\r\n     */\r\n    toggleOpen($event: Event): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        if (this.clickToggle) {\r\n            this.open = !this.open;\r\n        }\r\n        this.headClick.emit($event);\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n/**\r\n * 定义单个手风琴折叠面板头部内容,该组件包含在ti-accordion-item中使用\r\n * <example-url>../tiny3demo/#/accordion/acc-all</example-url>\r\n */\r\n@Component({\r\n  selector: 'ti-accordion-head',\r\n  template: '<ng-content></ng-content>'\r\n})\r\nexport class TiAccordionHeadComponent {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiCollapseModule } from '../../directives/collapse/TiCollapseModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n\r\nimport { TiAccordionComponent } from './TiAccordionComponent';\r\nimport { TiAccordionItemComponent } from './TiAccordionItemComponent';\r\nimport { TiAccordionHeadComponent } from './TiAccordionHeadComponent';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, TiCollapseModule, TiIconModule, TiOutlineModule],\r\n  exports: [TiAccordionComponent, TiAccordionItemComponent, TiAccordionHeadComponent],\r\n  declarations: [TiAccordionComponent, TiAccordionItemComponent, TiAccordionHeadComponent]\r\n})\r\nexport class TiAccordionModule {}\r\n\r\nexport { TiAccordionComponent } from './TiAccordionComponent';\r\nexport { TiAccordionItemComponent } from './TiAccordionItemComponent';\r\nexport { TiAccordionHeadComponent } from './TiAccordionHeadComponent';\r\n","import { TiLog } from './TiLog';\r\nimport { Util } from './Util';\r\n/**\r\n * 位置显示类型定义，其中auto代表自适应位置显示\r\n */\r\nexport type TiPositionType = 'top'| 'top-left'| 'top-right'| 'bottom'| 'bottom-left'| 'bottom-right'|\r\n'left'| 'left-top'| 'left-bottom'| 'right'| 'right-top'| 'right-bottom'| 'center' | 'auto' | 'none';\r\ninterface TiPositionLayout {\r\n    hostLayout: TiHostLayout;\r\n    targetLayout: TiEleLayout;\r\n    avilableLayout: TiAvilableLayout;\r\n}\r\nexport interface TiHostLayout {\r\n    top: number;\r\n    left: number;\r\n    width: number;\r\n    height: number;\r\n    isFixed: boolean;\r\n}\r\ninterface TiEleLayout {\r\n    top: number;\r\n    left: number;\r\n    width: number;\r\n    height: number;\r\n}\r\ninterface TiAvilableLayout {\r\n    left: number;\r\n    maxLeft: number;\r\n    right: number;\r\n    maxRight: number;\r\n    top: number;\r\n    maxTop: number;\r\n    bottom: number;\r\n    maxBottom: number;\r\n    clientHeight: number;\r\n    clientWidth: number;\r\n}\r\nexport interface TiPositionResult {\r\n    position: TiPositionType;\r\n    avilableHeight: number;\r\n    hostLayout?: TiHostLayout;\r\n}\r\ninterface TiLayoutParams {\r\n    left: number;\r\n    top: number;\r\n    avilableHeight: number;\r\n}\r\ninterface TiVerticalParams {\r\n    avilableHeight: number;\r\n    top: number;\r\n}\r\n/**\r\n * @ignore\r\n * 该类提供公共静态类方法，用于设置在body定位元素基于参照元素的位置信息,提供的核心方法如下：\r\n * setPosition()\r\n * 1. 入参为对象，参数信息如下：\r\n * {\r\n *   targetEle:需要定位的元素\r\n *   hostEle：参照元素\r\n *   position:定位位置\r\n *   hostSpace：待定位元素和参照元素间距\r\n *   browserSpace ：待定位元素和浏览器间距, 暂时只在上下位置生效\r\n *   hOffset: 自定义水平方向的偏移（在定位基础上的水平偏移，向左偏移为负值，向右偏移为正值）\r\n *   fixMaxHeight: 定位元素最大高度是否固定不变(显示不下时不用压缩高度)\r\n *   determinPositionFn：决定位置的函数\r\n * }\r\n * 2. 返回值为对象，信息如下：\r\n * {\r\n *   position:string 最终元素定位位置（当外部定义位置非13个可选位置时，会重新计算合适的位置进行定位，因此提供此位置信息供外部使用）\r\n *   avilableHeight:number 元素可用高度占位信息(外部可使用该信息进行高度的重新定义)\r\n * }\r\n */\r\nexport class Position {\r\n    private static positionArr: Array<string> = ['top', 'top-left', 'top-right', 'bottom', 'bottom-left', 'bottom-right',\r\n                       'left', 'left-top', 'left-bottom', 'right', 'right-top', 'right-bottom', 'center'];\r\n    /* tip 针对较小元素做位置自适应处理，保证 tip 的箭头在被提示元素的中间，这是宽度或者高度的阈值\r\n     * 取值为 15 的原因： 箭头定位偏移量9 + 箭头宽度的一半6 = 15px 相关变量变化时需要修改该常量\r\n     */\r\n    private static readonly ADAPTIVE_SIZE: number = 15;\r\n    public static setPosition(options: {\r\n        targetEle: any,\r\n        hostEle: any,\r\n        hostEleX?: any, // 决定定位元素水平方向的元素，用于宿主元素水平方向位置与host元素不一致的场景，暂不对外开放\r\n        position?: TiPositionType,\r\n        hostSpace?: number,\r\n        browserSpace?: number, // 与浏览器距离像素\r\n        hOffset?: number // 自定义水平方向的偏移（在定位基础上的水平偏移，向左偏移为负值，向右偏移为正值）\r\n        fixMaxHeight?: boolean // 定位元素最大高度是否固定不变(显示不下时不用压缩高度)\r\n        determinPositionFn?(layout: any): string,\r\n        hasOffsetFix?: boolean // 是否存在定位偏差量（针对 tip 组件：当被提示元素尺寸较小时，保证 tip 的箭头在被提示元素的中间）\r\n    }): TiPositionResult {\r\n        // 入参非有效元素情况下，不做处理\r\n        if (!Util.isElement(options.hostEle) || !Util.isElement(options.targetEle)) {\r\n            TiLog.warn('position: hostEle or targetEle type is not element');\r\n\r\n            // 防止外部使用报错，此处做返回值处理\r\n            return {\r\n                position: 'top',\r\n                avilableHeight: 9999\r\n            };\r\n        }\r\n        // 分别获取宿主和待定位元素当前位置\r\n        const curLayout: TiPositionLayout = Position.getLayout(options.hostEle, options.targetEle, options.hostEleX);\r\n        const hostSpace: number = options.hostSpace || 0;\r\n        // 判断元素位置\r\n        const position: any = (options.determinPositionFn) ? options.determinPositionFn(curLayout)\r\n                    : Position.determinPosition(options.position, curLayout, hostSpace, options.browserSpace || 0);\r\n        const elePos: TiLayoutParams = Position.getLayoutParam(curLayout, position, hostSpace, options.browserSpace || 0, options.hasOffsetFix || false);\r\n        const hOffset: number = options.hOffset || 0;\r\n        Position.setLayout(options.targetEle, elePos, curLayout, hOffset);\r\n        Position.setMaxHeight(options.targetEle, elePos, curLayout, options.fixMaxHeight);\r\n        Position.setDominatorDropDetachState(options.targetEle, elePos, curLayout, options.fixMaxHeight);\r\n\r\n        return {\r\n            position, // 最终元素定位位置\r\n            avilableHeight: elePos.avilableHeight, // 元素可用高度占位\r\n            hostLayout: curLayout.hostLayout\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 添加影响host position的事件并返回其事件句柄\r\n     * 由于Angular listen不支持多事件定义，因此在此处封装函数进行单独处理；此外，事件也不支持定义命名空间\r\n     * 监听全局事件，用于处理页面位置出现变化导致宿主元素位置偏移，而tip的特殊情况下tip消失，\r\n     * 并定义组件事件监听句柄，事件取消时会用到\r\n     * 特殊场景包括：\r\n     * 1. 拖动弹框位置导致的宿主元素位置变化\r\n     * 2. 页面局部出滚动条，滚动条位置变化导致的宿主元素位置变化\r\n     *    鼠标导致的滚轮事件可通过mousewheel/DOMMouseScroll监听（有冒泡的特性）\r\n     *    拖拽导致的滚轮变化，需要业务通过trigger Tiny自定义事件tiScroll进行处理（无事件冒泡的特性）\r\n     * 3.页面缩放\r\n     * 4.路由切换页面\r\n     */\r\n    public static addPosChangeEvts(eventCallback: any, render: any): Array<() => void> {\r\n        const eventHandles: Array<() => void> = [];\r\n        // 修复SSR报错：ERROR ReferenceError: document is not defined\r\n        if(typeof document === 'undefined'){\r\n            return [];\r\n        }\r\n        // 需要添加的事件数据抽象\r\n        const eventArr: Array<any> = [\r\n            { // 鼠标拖动页面内滚动条场景，该事件需要业务通过trigger tiScroll事件进行处理\r\n                ele: typeof document !== 'undefined' ? document : null,\r\n                eventType: 'tiScroll',\r\n                callback: eventCallback\r\n            }, { // 页面缩放\r\n                ele: typeof window !== 'undefined' ? window : null,\r\n                eventType: 'resize',\r\n                callback: eventCallback\r\n            }, { // 路由切换页面\r\n                ele: typeof window !== 'undefined' ? window : null,\r\n                eventType: 'hashchange',\r\n                callback: eventCallback\r\n            }];\r\n        eventArr.forEach((item: any) => {\r\n            // 修复SSR问题： ERROR TypeError: Cannot read property 'addEventListener' of null\r\n            if (item.ele) {\r\n                return eventHandles.push(render.listen(item.ele, item.eventType, item.callback));\r\n            }\r\n        });\r\n\r\n        return eventHandles;\r\n    }\r\n    /**\r\n     * 清除绑定事件，与addPosChangeEvts对称\r\n     */\r\n    public static removePosChangeEvts(eventHandles: any): void {\r\n        eventHandles.forEach((item: any) => {\r\n            if (item) {\r\n                item();\r\n            }\r\n        });\r\n    }\r\n    // 获取host和target元素的布局参数\r\n    private static getLayout(hostEle: any, targetEle: any, horizonHostEle: any): TiPositionLayout {\r\n        const hostLayout: TiHostLayout = Position.getHostEleLayout(hostEle, horizonHostEle);\r\n\r\n        return {\r\n            hostLayout,\r\n            targetLayout: Position.getEleLayout(targetEle),\r\n            avilableLayout: Position.getAvilableLayout(hostLayout)\r\n        };\r\n    }\r\n    /**\r\n     * 根据高亮浮层位置及提示弹窗位置情况计算具体显示位置\r\n     * @param  position 元素位置定义信息\r\n     * @param  layout 宿主和待定位元素位置信息\r\n     * @param  hostSpace 宿主和待定位元素间距\r\n     * @param  browserSpace 浏览器和待定位元素间距\r\n     * @returns 提示弹窗呈现位置\r\n     */\r\n    private static determinPosition(position: TiPositionType, layout: TiPositionLayout, hostSpace: number, browserSpace: number):\r\n        string {\r\n        // position定义有效情况下，不做处理\r\n        if (Position.isValidPosition(position, layout, hostSpace, browserSpace)) {\r\n            return position;\r\n        }\r\n        const targetLayout: TiEleLayout = layout.targetLayout;\r\n        const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n        // 元素位置距各部分位置\r\n        const avilableLeft: number = avilableLayout.left;\r\n        const avilableRight: number = avilableLayout.right;\r\n        const avilableTop: number = avilableLayout.top;\r\n        const avilableBottom: number = avilableLayout.bottom;\r\n        const targetMaxWidth: number = targetLayout.width + hostSpace + browserSpace;\r\n        const targetMaxHeight: number = targetLayout.height + hostSpace + browserSpace;\r\n        const hostLayout: TiHostLayout = layout.hostLayout;\r\n        if (avilableTop >= targetMaxHeight) { // 上方可显示完全\r\n            const positionTop: string = Position.determinHorizon(layout, hostLayout);\r\n            if (positionTop !== undefined) {\r\n                return 'top' + positionTop;\r\n            }\r\n        }\r\n        if (avilableRight >= targetMaxWidth) { // 右侧可显示完全，具体思路同上方可显示完全情况\r\n            const positionRight: string = Position.determinVertical(layout, hostLayout);\r\n            if (positionRight !== undefined) {\r\n                return 'right' + positionRight;\r\n            }\r\n        }\r\n        if (avilableBottom >= targetMaxHeight) { // 下方可显示完全，具体思路同上方可显示完全情况\r\n            const positionBottom: string = Position.determinHorizon(layout, hostLayout);\r\n            if (positionBottom !== undefined) {\r\n                return 'bottom' + positionBottom;\r\n            }\r\n        }\r\n        if (avilableLeft >= targetMaxWidth) { // 左侧足够显示情况下，左侧居中显示\r\n            const positionLeft: string = Position.determinVertical(layout, hostLayout);\r\n            if (positionLeft !== undefined) {\r\n                return 'left' + positionLeft;\r\n            }\r\n        }\r\n\r\n        return 'center'; // 上下左右均无法足够显示情况下，居中显示内容\r\n    }\r\n    /**\r\n     * 垂直位置确定后，确定水平位置\r\n     */\r\n    private static determinHorizon(layout: TiPositionLayout, hostLayout: TiHostLayout): string {\r\n        const targetLayout: TiEleLayout = layout.targetLayout;\r\n        const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n        const avilableLeft: number = avilableLayout.left;\r\n        const avilableMaxLeft: number = avilableLayout.maxLeft;\r\n        const avilableRight: number = avilableLayout.right;\r\n        const avilableMaxRight: number = avilableLayout.maxRight;\r\n        const targetWidth: number = targetLayout.width;\r\n        const targetCenterWidth: number = (targetLayout.width - hostLayout.width) / 2; // 水平居中情况下，左右侧占用的宽度分别比宿主元素宽多少\r\n        if ((avilableRight >= targetCenterWidth) &&\r\n                (avilableLeft >= targetCenterWidth)) { // 提示元素超出被提示元素部分足够显示的情况下，优先居中显示\r\n            return '';\r\n        }\r\n        if (avilableMaxRight >= targetWidth) { // 提示元素可在被提示元素左边界靠右完全显示情况下，向右显示\r\n            return '-left';\r\n        }\r\n        if (avilableMaxLeft >= targetWidth) { // 提示元素可在被提示元素左边界靠左完全显示情况下，向左显示\r\n            return '-right';\r\n        }\r\n    }\r\n    /**\r\n     * 水平位置确定后，确定垂直位置\r\n     */\r\n    private static determinVertical(layout: TiPositionLayout, hostLayout: TiHostLayout): string {\r\n        const targetLayout: TiEleLayout = layout.targetLayout;\r\n        const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n        const avilableTop: number = avilableLayout.top;\r\n        const avilableMaxTop: number = avilableLayout.maxTop;\r\n        const avilableBottom: number = avilableLayout.bottom;\r\n        const avilableMaxBottom: number = avilableLayout.maxBottom;\r\n        const targetHeight: number = targetLayout.height;\r\n        const targetMiddleHeight: number = (targetLayout.height - hostLayout.height) / 2; // 垂直居中情况下，上下两侧占用的高度分别比宿主元素高多少\r\n        if ((avilableTop >= targetMiddleHeight) &&\r\n            (avilableBottom >= targetMiddleHeight)) {\r\n            return '';\r\n        }\r\n        if (avilableMaxBottom >= targetHeight) {\r\n            return '-top';\r\n        }\r\n        if (avilableMaxTop >= targetHeight) {\r\n            return '-bottom';\r\n        }\r\n    }\r\n\r\n     // 判断定义的position是否为有效位置\r\n     private static isValidPosition(position: TiPositionType, layout: TiPositionLayout, hostSpace: number, browserSpace: number): boolean {\r\n         if (Position.positionArr.indexOf(position) === -1) {\r\n            return false;\r\n         }\r\n         // 判断在指定的position是否能显示下\r\n         const positionFragments: Array<string> = position.split('-');\r\n         const targetLayout: TiEleLayout = layout.targetLayout;\r\n         const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n         // 元素位置距各部分位置\r\n         const avilableLeft: number = avilableLayout.left;\r\n         const avilableRight: number = avilableLayout.right;\r\n         const avilableTop: number = avilableLayout.top;\r\n         const avilableBottom: number = avilableLayout.bottom;\r\n         const targetMaxWidth: number = targetLayout.width + hostSpace + browserSpace;\r\n         const targetMaxHeight: number = targetLayout.height + hostSpace + browserSpace;\r\n         if (positionFragments[0] === 'top') {\r\n             if (avilableTop < targetMaxHeight) {\r\n                return false;\r\n             }\r\n\r\n             return Position.isValidHorizonPosition(positionFragments[1], layout);\r\n         }\r\n         if (positionFragments[0] === 'bottom') {\r\n            if (avilableBottom < targetMaxHeight) {\r\n               return false;\r\n            }\r\n\r\n            return Position.isValidHorizonPosition(positionFragments[1], layout);\r\n         }\r\n         if (positionFragments[0] === 'left') {\r\n             if (avilableLeft < targetMaxWidth) {\r\n                 return false;\r\n             }\r\n\r\n             return Position.isValidVerticalPosition(positionFragments[1], layout);\r\n         }\r\n         if (positionFragments[0] === 'right') {\r\n             if (avilableRight < targetMaxWidth) {\r\n                 return false;\r\n             }\r\n\r\n             return Position.isValidVerticalPosition(positionFragments[1], layout);\r\n         }\r\n\r\n         return true;\r\n    }\r\n\r\n    // 确定垂直位置是有效的后，判断水平位置是否有效\r\n    private static isValidHorizonPosition(horizonPosition: string, layout: TiPositionLayout): boolean {\r\n        const targetLayout: TiEleLayout = layout.targetLayout;\r\n        const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n        const hostLayout: TiHostLayout = layout.hostLayout;\r\n        const avilableLeft: number = avilableLayout.left;\r\n        const avilableRight: number = avilableLayout.right;\r\n        const avilableMaxLeft: number = avilableLayout.maxLeft;\r\n        const avilableMaxRight: number = avilableLayout.maxRight;\r\n        const targetWidth: number = targetLayout.width;\r\n        const targetCenterWidth: number = (targetLayout.width - hostLayout.width) / 2; // 水平居中情况下，左右侧占用的宽度分别比宿主元素宽多少\r\n        if (!horizonPosition) {\r\n            return (avilableRight >= targetCenterWidth) && (avilableLeft >= targetCenterWidth);\r\n        }\r\n        if (horizonPosition === 'left') {\r\n            return avilableMaxRight >= targetWidth;\r\n        }\r\n        if (horizonPosition === 'right') {\r\n            return avilableMaxLeft >= targetWidth;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // 确定水平位置是有效的后，判断垂直位置是否有效\r\n    private static isValidVerticalPosition(verticalPosition: string, layout: TiPositionLayout): boolean {\r\n        const targetLayout: TiEleLayout = layout.targetLayout;\r\n        const avilableLayout: TiAvilableLayout = layout.avilableLayout;\r\n        const hostLayout: TiHostLayout = layout.hostLayout;\r\n        const avilableTop: number = avilableLayout.top;\r\n        const avilableBottom: number = avilableLayout.bottom;\r\n        const avilableMaxTop: number = avilableLayout.maxTop;\r\n        const avilableMaxBottom: number = avilableLayout.maxBottom;\r\n        const targetHeight: number = targetLayout.height;\r\n        const targetMiddleHeight: number = (targetLayout.height - hostLayout.height) / 2; // 垂直居中情况下，上下两侧占用的高度分别比宿主元素高多少\r\n        if (!verticalPosition) {\r\n            return (avilableTop >= targetMiddleHeight) && (avilableBottom >= targetMiddleHeight);\r\n        }\r\n        if (verticalPosition === 'top') {\r\n            return avilableMaxBottom >= targetHeight;\r\n        }\r\n        if (verticalPosition === 'bottom') {\r\n            return avilableMaxTop >= targetHeight;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // 设置提示弹窗位置\r\n    private static setLayout(ele: any, position: TiLayoutParams, layoutParam: TiPositionLayout, hOffset: number): void {\r\n        if (layoutParam.hostLayout.isFixed) { // fixed定位情况下，滚动条对其不受影响，因此此处需要减掉滚动条的位置影响\r\n            ele.style.position = 'fixed';\r\n            ele.style.left = `${position.left - window.pageXOffset + hOffset}px`;\r\n            ele.style.top = `${position.top - window.pageYOffset}px`;\r\n        } else {\r\n            ele.style.left = `${position.left + hOffset}px`;\r\n            ele.style.top = `${position.top}px`;\r\n        }\r\n    }\r\n    // 设置提示弹窗的MaxHeight\r\n    private static setMaxHeight(ele: any, position: any, layoutParam: any, fixMaxHeight: boolean): void {\r\n        if (fixMaxHeight || position.avilableHeight >= layoutParam.targetLayout.height) {\r\n            return;\r\n        }\r\n        ele.style.maxHeight = `${position.avilableHeight}px`;\r\n    }\r\n    /**\r\n     * 当drop固定高度（设置fixMaxHeight=ture)，且空间不足时，dominator和drop不相邻，此场景需要隐藏drop中的边框覆盖线，\r\n     * 添加样式类'ti3-detach-dominator-drop'标记drop的这种场景状态，通过css样式控制drop中边框覆盖线的隐藏和显示\r\n     * 目前该场景出现在日期类组件中\r\n     */\r\n    public static setDominatorDropDetachState(ele: HTMLElement, position: any, layoutParam: any, fixMaxHeight: boolean): void{\r\n        if (!fixMaxHeight) {\r\n            return;\r\n        }\r\n        if (position.avilableHeight < layoutParam.targetLayout.height) {\r\n            ele.classList.add('ti3-detach-dominator-drop');\r\n        } else {\r\n            ele.classList.remove('ti3-detach-dominator-drop');\r\n        }\r\n    }\r\n\r\n    private static getEleLayout(ele: any): TiEleLayout {\r\n        // 修复SSR报错：ERROR TypeError: ele.getBoundingClientRect is not a function\r\n        return {\r\n            top: ele.offsetTop,\r\n            left: ele.offsetLeft,\r\n            width: (typeof ele.getBoundingClientRect) === 'function' ? ele.getBoundingClientRect().width : 0,\r\n            height: (typeof ele.getBoundingClientRect) === 'function' ? ele.getBoundingClientRect().height : 0\r\n        };\r\n    }\r\n    public static getHostEleLayout(hostEle: any, horizonHostEle?: any): TiHostLayout {\r\n        let horizonEle = hostEle;\r\n        if (Util.isElement(horizonHostEle)) {\r\n            horizonEle = horizonHostEle;\r\n        }\r\n        // 修复SSR报错：ERROR TypeError: hostEle.getBoundingClientRect is not a function\r\n        // 元素相对于windows的位置\r\n        let top: number = (typeof hostEle.getBoundingClientRect) === 'function' ? hostEle.getBoundingClientRect().top : 0;\r\n        let left: number = (typeof hostEle.getBoundingClientRect) === 'function' ? horizonEle.getBoundingClientRect().left : 0;\r\n        // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n        // 下面利用body相对于windows的位置，计算元素相对于body的位置。\r\n        /* tslint:disable:no-null-keyword */\r\n        const bodyPositon: string = (typeof getComputedStyle === 'function') ? getComputedStyle(document.body, null).position : 'static';\r\n        // body是static|relative|absolute|fixed都已测试，Chrome高低版本/Firefox/IE11已测。\r\n        if (bodyPositon === 'static') {// static时，body对window没有偏移，但是需要考虑页面滚动条\r\n            if (typeof window !== 'undefined') {\r\n                top += window.pageYOffset;\r\n                left += window.pageXOffset;\r\n            }\r\n        } else {\r\n            // relative|fix|absolute时，需要考虑body相对于windows的偏移。\r\n            top -= document.body.getBoundingClientRect().top;\r\n            left -=  document.body.getBoundingClientRect().left;\r\n        }\r\n\r\n        return {\r\n            top,\r\n            left,\r\n            width: horizonEle.offsetWidth,\r\n            height: hostEle.offsetHeight,\r\n            isFixed: this.isFixedPos(hostEle)\r\n        };\r\n    }\r\n\r\n    private static getAvilableLayout(hostLayout: TiHostLayout): TiAvilableLayout {\r\n        // 修复报错：ERROR ReferenceError: document is not defined\r\n        // 当前浏览器可视区域的宽高\r\n        const curBrowseWidth: number = (typeof document !== 'undefined') ? document.documentElement.clientWidth : 0;\r\n        const curBrowseheight: number = (typeof document !== 'undefined') ? document.documentElement.clientHeight : 0;\r\n        // 元素位置距各部分位置:\r\n        // 1.以元素四个边为边界，上下左右预留的可用宽高，用avilableLeft等标识\r\n        // 2.去掉元素的宽高占位，计算的最大可用宽高，用avilableMax...标识\r\n        // 修复SSR错误：ERROR ReferenceError: pageXOffset is not defined\r\n        const avilableLeft: number = hostLayout.left - ((typeof window !== 'undefined') ? window.pageXOffset : 0);\r\n        const avilableMaxLeft: number = avilableLeft + hostLayout.width;\r\n        const avilableRight: number = curBrowseWidth - avilableMaxLeft;\r\n        const avilableMaxRight: number = curBrowseWidth - avilableLeft;\r\n        // document.body.scrollTop  document.documentElement.scrollTop存在浏览器差异，chrome高低版本表现不同。\r\n        const avilableTop: number = hostLayout.top - ((typeof window !== 'undefined') ? window.pageYOffset : 0); // pageYOffset支持IE9以上。\r\n        const avilableMaxTop: number = avilableTop + hostLayout.height;\r\n        const avilableBottom: number = curBrowseheight - avilableMaxTop;\r\n        const avilableMaxBottom: number = curBrowseheight - avilableTop;\r\n\r\n        return {\r\n            left: avilableLeft,\r\n            maxLeft: avilableMaxLeft,\r\n            right: avilableRight,\r\n            maxRight: avilableMaxRight,\r\n            top: avilableTop,\r\n            maxTop: avilableMaxTop,\r\n            bottom: avilableBottom,\r\n            maxBottom: avilableMaxBottom,\r\n            clientHeight: curBrowseheight,\r\n            clientWidth: curBrowseWidth\r\n        };\r\n    }\r\n    // 确定元素是否为fixed定位\r\n    private static isFixedPos(ele: any): boolean {\r\n        if (!ele || ele.nodeName === 'HTML') {\r\n            return false;\r\n        }\r\n        // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n        if (typeof getComputedStyle === 'undefined') {\r\n            return false;\r\n        }\r\n        if (getComputedStyle(ele).position === 'fixed') {\r\n            return true;\r\n        }\r\n\r\n        return this.isFixedPos(ele.parentNode);\r\n    }\r\n    private static getLayoutParam(layout: TiPositionLayout, position: string, hostSpace: number, browserSpace: number, hasOffsetFix: boolean): TiLayoutParams {\r\n        const positionArr: Array<string> = position.split('-'); // 跟上面静态变量重名,最好改一下\r\n        const left: number = Position.getHorizionParam(layout, positionArr, hostSpace, hasOffsetFix);\r\n        const verticalParam: TiVerticalParams = Position.getVerticalParam(layout, positionArr, hostSpace, browserSpace, hasOffsetFix);\r\n\r\n        return {\r\n            left,\r\n            top: verticalParam.top,\r\n            avilableHeight: verticalParam.avilableHeight\r\n        };\r\n    }\r\n    private static getHorizionParam(curLayout: TiPositionLayout, posArr: Array<string>, space: number, hasOffsetFix: boolean): number {\r\n        const hostLayout: TiHostLayout = curLayout.hostLayout;\r\n        const targetLayout: TiEleLayout = curLayout.targetLayout;\r\n\r\n        // 定位偏差调整量（该偏差量针对较小元素，保证 tip 的箭头在被提示元素的中间）\r\n        const offset = hasOffsetFix ? this.getOffsetFixVal(curLayout.hostLayout.width) : 0;\r\n\r\n        // 'left', 'left-top', 'left-bottom'\r\n        if (posArr[0] === 'left') {\r\n            return hostLayout.left - targetLayout.width - space;\r\n        }\r\n        // 'right', 'right-top', 'right-bottom'\r\n        if (posArr[0] === 'right') {\r\n            return hostLayout.left + hostLayout.width + space;\r\n        }\r\n        // 'top-left', 'bottom-left'\r\n        if (posArr[1] === 'left') {\r\n            return hostLayout.left - offset;\r\n        }\r\n        // 'top-right', 'bottom-right'\r\n        if (posArr[1] === 'right') {\r\n            return hostLayout.left + hostLayout.width - targetLayout.width + offset;\r\n        }\r\n\r\n        // 'top', 'bottom', 'center'\r\n        return hostLayout.left - (targetLayout.width - hostLayout.width) / 2;\r\n    }\r\n    private static getVerticalParam(curLayout: TiPositionLayout, posArr: Array<string>, hostSpace: number, browserSpace: number, hasOffsetFix: boolean):\r\n    TiVerticalParams {\r\n        const avilableLayout: TiAvilableLayout = curLayout.avilableLayout; // 宿主元素对应的可用位置参数\r\n        const hostHeight: number = curLayout.hostLayout.height; // 宿主元素本身高度\r\n        const targetLayout: TiEleLayout = curLayout.targetLayout;\r\n        const hostLayout: TiHostLayout = curLayout.hostLayout;\r\n\r\n        // 定位偏差调整量（该偏差量针对较小元素，保证 tip 的箭头在被提示元素的中间）\r\n        const offset = hasOffsetFix ? this.getOffsetFixVal(curLayout.hostLayout.height) : 0;\r\n\r\n        // 纵向可用高度是根据位置中top、bottom、居中情况进行的处理,因此,此处先将position进行分割，再根据其情况进行可用高度计算\r\n        // 弹出元素下边线与宿主元素上边线相接后，弹出元素向上延伸情况，对应位置包含'top', 'top-left', 'top-right'\r\n        if (posArr[0] === 'top') {\r\n            const avilableHeight: number = avilableLayout.top - hostSpace - browserSpace;\r\n            const top: number = (avilableHeight >= targetLayout.height) ?\r\n                (hostLayout.top - targetLayout.height - hostSpace) :\r\n                (hostLayout.top - avilableLayout.top + browserSpace);\r\n\r\n            return {\r\n                avilableHeight,\r\n                top\r\n            };\r\n        }\r\n        // 弹出元素上边线与宿主元素下边线相接后，弹出元素向下延伸情况，对应位置包含'bottom', 'bottom-left', 'bottom-right'\r\n        if (posArr[0] === 'bottom') {\r\n            return {\r\n                avilableHeight: avilableLayout.bottom - hostSpace - browserSpace,\r\n                top: hostLayout.top + hostLayout.height + hostSpace\r\n            };\r\n        }\r\n        // 弹出元素上边线与宿主元素上边线对齐情况，对应位置包含'left-top', 'right-top'\r\n        if (posArr[1] === 'top') {\r\n            return {\r\n                avilableHeight: avilableLayout.bottom + hostHeight,\r\n                top: hostLayout.top - offset\r\n            };\r\n        }\r\n        // 弹出元素上边线与宿主元素下边线对齐情况，对应位置包含'right-bottom', 'left-bottom'\r\n        if (posArr[1] === 'bottom') {\r\n            return {\r\n                avilableHeight: avilableLayout.top + hostHeight,\r\n                top: hostLayout.top + hostLayout.height - targetLayout.height + offset\r\n            };\r\n        }\r\n\r\n        // 弹出元素中线与宿主元素中线对齐情况，对应位置包含'left', 'right', 'center'\r\n        return {\r\n            avilableHeight: avilableLayout.clientHeight,\r\n            top: hostLayout.top - (targetLayout.height - hostLayout.height) / 2\r\n        };\r\n    }\r\n    // 获取定位偏差调整量\r\n    private static getOffsetFixVal(hostLayoutSize: number): number {\r\n        return hostLayoutSize / 2 < Position.ADAPTIVE_SIZE ?\r\n            Position.ADAPTIVE_SIZE - hostLayoutSize / 2 : 0;\r\n    }\r\n}\r\n","import { ApplicationRef, Component, ElementRef, EmbeddedViewRef, Input, Renderer2, TemplateRef, ViewChild } from '@angular/core';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\nimport { Position, TiHostLayout, TiPositionResult } from '../../utils/Position';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { Subject } from 'rxjs';\r\n\r\n/**\r\n * @ignore\r\n * 纯下拉面板组件，只有面板，没有内容。因为有时朝上弹，dropdown/dropup合称drop\r\n */\r\n@Component({\r\n    selector: 'ti-drop',\r\n    templateUrl: './drop.html',\r\n    styleUrls: ['./drop.less'],\r\n    host: {\r\n        '[class.ti3-dropdown-container]': 'true',\r\n        '[class.ti3-dropdown-container-border]': 'theme ===\"border\"',\r\n        '[style.height]': 'panelHeight'\r\n    }\r\n})\r\nexport class TiDropComponent extends TiBaseComponent {\r\n    /**\r\n     * 设置下拉距离dominator的距离：默认没有间距\r\n     */\r\n    public static readonly DOMINATOR_SPACE: number = 4;\r\n    /**\r\n     * 控制下拉框距离浏览器上下边沿的距离为5px，预留一个余量，防止显示不了边框\r\n     */\r\n    private static readonly BROWSER_SPACE: number = 5;\r\n    /**\r\n     * 下拉面板的最大显示宽度，该变量与下拉类组件保持一致\r\n     *\r\n     * 1.\"justified\"(默认): 下拉框的宽度与Select组件的宽度保持一致；\r\n     *\r\n     * 2.\"auto\": 下拉框的宽度根据下拉选项的内容自动撑开；\r\n     *\r\n     * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于Select组件的宽度)。例如：\"200px\"\r\n     */\r\n    @Input() panelWidth: string = 'justified'; // 面板宽度\r\n    /**\r\n     * 面板最大高度\r\n     */\r\n    @Input() panelMaxHeight: string = '9999px';   // 面板最大高度\r\n    /**\r\n     * 10.0.4新增\r\n     * 面板高度\r\n     */\r\n    @Input() panelHeight: string;\r\n    /**\r\n     * 参考位置元素\r\n     */\r\n    @Input() dominatorElem: any; // 参考位置元素\r\n    /**\r\n     * 空间不足时，依然保持固定高度。 select search等是可变最大高度，日历是固定最大高度。\r\n     * 再就是上下空间都不足时，日历从下方弹出。\r\n     */\r\n    @Input() fixMaxHeight: boolean = false; // 再就是上下空间都不足时，日历从下方弹出。\r\n    /**\r\n     * 主题样式控制\r\n     */\r\n    @Input() theme: 'border' | 'noborder' = 'border';\r\n    /**\r\n     * 距离宿主元素距离，像素值\r\n     */\r\n    @Input() dominatorSpace: string = TiDropComponent.DOMINATOR_SPACE + 'px';\r\n    /**\r\n     * 距离浏览器上或下边沿的距离，像素值\r\n     */\r\n    @Input() browserSpace: string = TiDropComponent.BROWSER_SPACE + 'px';\r\n    /**\r\n     * 在定位基础上的水平方向的偏移，向左偏移为负值，向右偏移为正值，像素值\r\n     */\r\n    @Input() hOffset: number = 0;\r\n    /**\r\n     * 准备去除\r\n     */\r\n    @Input() determinPositionFn: (layout: any) => string;\r\n    /**\r\n     * 面板对齐方式\r\n     */\r\n    @Input() panelAlign: 'left' | 'right' = 'left';\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('dropTemplateRef', { static: true }) dropTemplateRef: TemplateRef<any>;\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isUp: Boolean; // 面板展开的方向\r\n    /**\r\n     * @ignore\r\n     */\r\n    public dropSubject: Subject<any> = new Subject<any>();\r\n    private posHandles: Array<() => void> = [];\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2, private applicationRef: ApplicationRef) {\r\n        super(hostRef, renderer);\r\n    }\r\n\r\n    /**\r\n     * 外部接口: 获取当前状态, 只读不写\r\n     */\r\n    public get isShow(): boolean {\r\n        return this.hostRef.nativeElement.style.display === 'block';\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        // 从body上摘除。\r\n        this.renderer.removeChild(this.renderer.parentNode(this.hostRef.nativeElement), this.hostRef.nativeElement);\r\n        this.unlistenPosition();\r\n    }\r\n\r\n    /**\r\n     * 切换面板状态：打开/关闭\r\n     */\r\n    public toggle(): void {\r\n        this.isShow ? this.hide() : this.show();\r\n    }\r\n    /**\r\n     * 打开面板\r\n     */\r\n    public show(): void {\r\n        if (this.isShow) {\r\n            return;\r\n        }\r\n        // 挂在body上，极远处\r\n        this.appendToBodyFarAway();\r\n        // 先显示，才能再计算\r\n        this.setShow();\r\n        this.setPanelWidth();\r\n        // 设置位置：居下优先，居上其次\r\n        this.setPosition();\r\n\r\n        this.listenPosition();\r\n        this.dropSubject.next(true);\r\n        // const result = this.setPosition();\r\n        // setTimeout(()=>{this.setPosition()},0);\r\n        // 设置MaxHeight //此逻辑已经放入Position\r\n        // this.setPanelMaxHeight(result.avilableHeight);\r\n\r\n        // 设置Width。确保在显示之后设置下拉框的宽度，避免滚动条的影响\r\n        // this.setPanelWidth();\r\n    }\r\n    /**\r\n     * 关闭面板\r\n     */\r\n    public hide(): void {\r\n        if (!this.isShow) {\r\n            return;\r\n        }\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'display', 'none');\r\n        this.unlistenPosition();\r\n    }\r\n    private appendToBodyFarAway(): void {\r\n        // 如果不在body上，那么挂在body上。（逻辑应该移入Position.setPosition吧，因为那位置就是按照body定的，不在body会出错。）\r\n        if (this.renderer.parentNode(this.hostRef.nativeElement) !== document.body) {\r\n            this.renderer.appendChild(document.body, this.hostRef.nativeElement);\r\n            const embeddedViewRef: EmbeddedViewRef<any> = this.dropTemplateRef.createEmbeddedView(null);\r\n            this.applicationRef.attachView(embeddedViewRef); // 不做此处处理，ng-template中的标签不会解析\r\n            Array.from(embeddedViewRef.rootNodes)\r\n                .forEach((item: any) => {\r\n                    this.renderer.appendChild(this.hostRef.nativeElement, item);\r\n                });\r\n        }\r\n        // 设置在极远处（逻辑应该移入Position.setPosition吧）\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'left', '-9999px');\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'top', '-9999px');\r\n        // 更新max-height为默认值panelMaxHeight，因为上次显示可能更改了max-height\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'max-height', this.panelMaxHeight);\r\n        // 设置width,当出现滚动条时,更新width为默认的panelWidth，避免滚动条宽度的影响\r\n        if (this.panelWidth === 'auto') {\r\n            this.renderer.setStyle(this.hostRef.nativeElement, 'width', this.panelWidth);\r\n        }\r\n    }\r\n    private setShow(): void {\r\n        // 显示才能计算宽度\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'display', 'block');\r\n    }\r\n    /**\r\n     * 监听位置变化, 并隐藏面板。打开面板时监听，关闭和销毁时取消监听。\r\n     * TODO: 尝试hide改为rePosition\r\n     */\r\n    private listenPosition(): void {\r\n        this.posHandles = Position.addPosChangeEvts(() => {\r\n            this.hide();\r\n        }, this.renderer);\r\n    }\r\n    private unlistenPosition(): void {\r\n        Position.removePosChangeEvts(this.posHandles);\r\n    }\r\n    /**\r\n     * 确定元素的显示样式，包括位置、最大高度、向上或向下\r\n     * @returns 定位结果对象\r\n     */\r\n    public setPosition(): TiHostLayout {\r\n        const dominatorSpace: number = parseInt(this.dominatorSpace, 10);\r\n        const browserSpace: number = parseInt(this.browserSpace, 10);\r\n        const determinPositionFn: (layout: any) => string = Util.isFunction(this.determinPositionFn) ? this.determinPositionFn :\r\n            this.defaultDeterminPositionFn;\r\n\r\n        // 设置位置\r\n        const result: TiPositionResult = Position.setPosition({\r\n            targetEle: this.hostRef.nativeElement,\r\n            hostEle: this.dominatorElem,\r\n            // position: undefined, // 可选参数\r\n            hostSpace: dominatorSpace,\r\n            browserSpace,\r\n            fixMaxHeight: this.fixMaxHeight,\r\n            hOffset: this.hOffset,\r\n            determinPositionFn\r\n        });\r\n\r\n        return result.hostLayout;\r\n    }\r\n\r\n    public resetPosition(): void {\r\n        // 记录上一次dominator left值\r\n        const hostLayout: TiHostLayout = this.setPosition();\r\n        const dominatorLastLeft: number = hostLayout && hostLayout.left;\r\n        // 记录当前dominator left值\r\n        const dominatorCurLeft: number = Position.getHostEleLayout(this.dominatorElem).left;\r\n\r\n        // dominator发生水平位移且面板处于打开状态时，需重新定位\r\n        // 主要场景：下拉面板数据量变动引起body出现竖向滚动条，dominator发生水平方向偏移;\r\n        if (dominatorLastLeft !== dominatorCurLeft) {\r\n            if (this.isShow) {\r\n                this.setPosition();\r\n            }\r\n        }\r\n    }\r\n\r\n    private setPanelWidth(): void {\r\n        const panelWidthNum: number = parseInt(this.panelWidth, 10);\r\n        const scrollWidth: number = this.hostRef.nativeElement.offsetWidth - this.hostRef.nativeElement.clientWidth;\r\n        const dominatorElemWidth: number = this.dominatorElem.offsetWidth;\r\n        let width: string;\r\n        if (!isNaN(panelWidthNum)) {\r\n            width = panelWidthNum + 'px';\r\n        } else if (this.panelWidth === 'auto') {\r\n            width = 'auto';\r\n            // Fix bug: 非IE下滚动条会覆盖部分内容\r\n            if (!TiBrowser.isIE()) {\r\n                // 需要重置宽度设置，根据下拉面板的真实宽度确定是否需要增加滚动条宽度\r\n                width = null;\r\n                // 有滚动条出现且文本较长时，需要再增加滚动条的宽度，否则内容显示不全\r\n                if (scrollWidth) {\r\n                    width = this.hostRef.nativeElement.offsetWidth + scrollWidth + 'px';\r\n                }\r\n            }\r\n            const minWidth: string = dominatorElemWidth + 'px';\r\n            this.renderer.setStyle(this.hostRef.nativeElement, 'min-width', minWidth);\r\n        } else {\r\n            // 默认宽度设置，包含justified\r\n            width = dominatorElemWidth + 'px';\r\n        }\r\n        // 设置\r\n        this.renderer.setStyle(this.hostRef.nativeElement, 'width', width);\r\n    }\r\n\r\n    // 决定上下位置的函数\r\n    private defaultDeterminPositionFn: (layout: any) => string = (layout: any) => {\r\n        const dominatorSpace: number = parseInt(this.dominatorSpace, 10);\r\n        const browserSpace: number = parseInt(this.browserSpace, 10);\r\n        const needHeight: number = layout.targetLayout.height + dominatorSpace + browserSpace;\r\n        if (layout.avilableLayout.bottom >= needHeight) { // 下方空间足够，向下展开\r\n            return this.panelAlign === 'left' ? 'bottom-left' : 'bottom-right';\r\n        } else if (layout.avilableLayout.top >= needHeight) { // 上方空间足够，向上展开\r\n            return this.panelAlign === 'left' ? 'top-left' : 'top-right';\r\n        } else if (layout.avilableLayout.bottom >= layout.avilableLayout.top) { // 下方空间较大，则向下展开\r\n            // 因为日历组件存在问题，最大高度不压缩，极端情况时会显示在top为负显示不全。所以日历组件尽量向下弹出。\r\n            return this.panelAlign === 'left' ? 'bottom-left' : 'bottom-right';\r\n        }\r\n\r\n        return this.panelAlign === 'left' ? 'top-left' : 'top-right'; // 向上展开\r\n    }\r\n\r\n}\r\n\r\n// offsetWidth属性可以返回对象的padding+border+width属性值之和, 是整数。与jQuery的outerWidth()完全相同，outerWidth(true)带有外边距。\r\n// Element.clientWidth 属性表示元素的内部宽度，以像素计。该属性包括内边距，但不包括垂直滚动条（如果有）、边框和外边距。\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiDropComponent } from './TiDropComponent';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiDropComponent],\r\n  declarations: [TiDropComponent]\r\n})\r\nexport class TiDropModule {\r\n}\r\nexport { TiDropComponent } from './TiDropComponent';\r\n","import { NgModule } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: []\r\n})\r\nexport class TiPopupModule {\r\n}\r\n","/* eslint-disable no-param-reassign */\r\n/**\r\n * 该类提供一个服务，用于管理弹出类组件的创建和销毁\r\n * 服务中提供三个方法:\r\n * create(componentType) 生成一个popup实例并返回对象，\r\n *   componentType：包裹内容的父容器元素类\r\n * 返回的实例对象中提供方法:\r\n * {\r\n *  show({ // 生成元素并在指定容器中显示\r\n *   content:弹出组件内容\r\n *   context:弹出组件上下文\r\n *   container:弹出组件最终放置的容器位置\r\n * }) : componentRef // 返回生成的组件实例\r\n *  hide():隐藏并销毁元素\r\n * }\r\n */\r\nimport { ApplicationRef, ComponentFactoryResolver, ComponentRef, ElementRef,\r\n    EmbeddedViewRef, Injectable, Injector,\r\n    Renderer2, RendererFactory2, SecurityContext, TemplateRef, ViewRef, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\nimport { TiPopupModule } from './TiPopupModule';\r\nimport { Util } from '../../utils/Util';\r\n/**\r\n * @ignore\r\n * 类型中any代表组件形式\r\n */\r\nexport type TiContentType = string | TemplateRef<any> | any;\r\n/**\r\n * @ignore\r\n * popup show方法配置\r\n */\r\ninterface TiPopUpShowConfig {\r\n    content?: TiContentType; // 弹出组件内容\r\n    context?: any; // 弹出组件上下文\r\n    contentContext?: any; // 内容部分的组件上下文\r\n    container?: any; // 弹出组件最终放置的容器位置\r\n}\r\n/**\r\n * @ignore\r\n * popup create返回值\r\n */\r\nexport interface TiPopUpRef {\r\n    show(config: TiPopUpShowConfig | {}): ComponentRef<any>;\r\n    hide(): void;\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass ContentRef {\r\n    constructor(public nodes: Array<any>, public viewRef?: ViewRef,\r\n                public componentRef?: ComponentRef<any>) {\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\n@Injectable({\r\n    providedIn: TiPopupModule\r\n})\r\nexport class TiPopupService<T> {\r\n    /**\r\n     * 由于该服务可能被其他服务使用到，并以服务的形式提供给外部；\r\n     * 而Renderer2本身不能脱离于component之外定义或依赖，所以使用RendererFactory2方式实例化进行处理\r\n     * 具体说明见如下：\r\n     * https://stackoverflow.com/questions/43070308/using-renderer-in-angular-4\r\n     */\r\n    private renderer: Renderer2;\r\n    constructor(private injector: Injector, rendererFactory: RendererFactory2,\r\n                private componentFactoryResolver: ComponentFactoryResolver,\r\n                private applicationRef: ApplicationRef,\r\n                private domSanitizer: DomSanitizer,\r\n                @Inject(DOCUMENT) private document) {\r\n            /* tslint:disable:no-null-keyword */\r\n            this.renderer = rendererFactory.createRenderer(null, null);\r\n    }\r\n\r\n    private getParentEle(containerOpt: string | ElementRef): Element {\r\n        if (containerOpt instanceof ElementRef) {// 父元素为正常element元素情况下\r\n            return containerOpt.nativeElement;\r\n        } else if (containerOpt === 'body') {// 父容器为body元素情况下\r\n            return this.document.body;\r\n        }\r\n    }\r\n\r\n    // 销毁组件相关内容\r\n    private static destroyComponentRef(_componentRef: ComponentRef<any>): void {\r\n        if (!_componentRef) {\r\n            return;\r\n        }\r\n        // 销毁组件实例\r\n        _componentRef.destroy();\r\n        _componentRef = null;\r\n    }\r\n\r\n    // 销毁弹出内容相关内容\r\n    private static destroyContentRef(contentRef: ContentRef): void {\r\n        // 弹出内容如果有组件实例对象时，销毁组件实例\r\n        if (contentRef.componentRef) {\r\n            contentRef.componentRef.destroy();\r\n        }\r\n        // 销毁页面视图实例\r\n        if (contentRef.viewRef) {\r\n            contentRef.viewRef.destroy();\r\n        }\r\n        // 销毁内容实例\r\n        contentRef = null;\r\n    }\r\n    public create(componentType: any): TiPopUpRef {\r\n        let _contentRef: ContentRef; // 弹出内容实例\r\n        let _componentRef: ComponentRef<T> | any; // 生成的组件实例对象\r\n\r\n        return {\r\n            show: (options?: TiPopUpShowConfig): ComponentRef<T> => {\r\n                // component已生成情况下，不再重复生成\r\n                if (_componentRef) {\r\n                    return _componentRef;\r\n                }\r\n                // 获取内容相关信息,包括：组件节点信息、组件实例信息、组件最小视图信息\r\n                _contentRef = this.getContentRef(options && options.content,\r\n                    options && options.contentContext);\r\n\r\n                // 创建组件实例：为内容本身再包一层父容器组件，用于控制组件（componentType）\r\n                _componentRef = this.createCompoentRef({\r\n                    componentType,\r\n                    nodes: _contentRef.nodes,\r\n                    context: options && options.context\r\n                });\r\n\r\n                // 将元素放置在指定容器中\r\n                const parentEle: Element = this.getParentEle(options && options.container);\r\n                if (parentEle) {\r\n                    parentEle.appendChild(_componentRef.location.nativeElement);\r\n                }\r\n\r\n                // 这时弹出内容已经append,可以对弹出内容进行解析了。\r\n                // 弹出内容中某些元素会在初始化时需要获取自身DOM宽高等，所以要保证弹出内容先append，然后再解析。\r\n                // 解析ng-template形式的弹出内容实例\r\n                if (options.content instanceof TemplateRef) {\r\n                    // 确保数据变化均可以被检测到\r\n                    _contentRef.viewRef.markForCheck();\r\n                    // 执行一次变化检测\r\n                    _contentRef.viewRef.detectChanges();\r\n                }\r\n                // 解析component形式的弹出内容实例\r\n                if (typeof options.content === 'function') {\r\n                    // 在组件的 metadata 中如果设置了OnPush 条件，那么变化检测不会再次执行,\r\n                    // 但是调用该方法，可以确保数据变化被检测到\r\n                    _contentRef.componentRef.changeDetectorRef.markForCheck();\r\n                    // 从该组件到其子组件执行一次变化检测\r\n                    _contentRef.componentRef.changeDetectorRef.detectChanges();\r\n                }\r\n\r\n                _componentRef.tiContentRef = _contentRef;\r\n\r\n                return _componentRef;\r\n            },\r\n            hide: (): void => {\r\n                if (!_componentRef) {\r\n                    return;\r\n                }\r\n                TiPopupService.destroyComponentRef(_componentRef);\r\n                TiPopupService.destroyContentRef(_contentRef);\r\n                // 由于该变量在destroyComponentRef函数中赋为null不会改变外部值的改变，导致下次show时判断错误，因此此处需要做处理\r\n                _componentRef = null;\r\n            }\r\n        };\r\n    }\r\n\r\n    private getContentRef = (content: TiContentType, context?: any): ContentRef => {\r\n        // ng-template形式\r\n        if (content instanceof TemplateRef) {\r\n            // 将template实例化为内嵌视图,并将其放在可运行环境中进行解析\r\n            const embeddedViewRef: EmbeddedViewRef<any> = content.createEmbeddedView({context});\r\n            this.applicationRef.attachView(embeddedViewRef); // 不做此处处理，ng-template中的标签不会解析\r\n\r\n            return new ContentRef([embeddedViewRef.rootNodes], embeddedViewRef);\r\n        }\r\n        // 组件形式\r\n        if (typeof content === 'function') {\r\n            // 根据传入的component类（即content）创建组件引用\r\n            const componentRef: ComponentRef<any> = this.createCompoentRef({\r\n                componentType: content,\r\n                context,\r\n                notDetectChanges: true});\r\n\r\n            return new ContentRef(\r\n                [[componentRef.location.nativeElement]],\r\n                componentRef.hostView,\r\n                componentRef\r\n            );\r\n        }\r\n        // element Dom形式\r\n        if (content instanceof HTMLElement) {\r\n            return new ContentRef([[content]]);\r\n        }\r\n\r\n        // string形式 或 SafeHtml(object类型) 形式，\r\n        if (typeof content === 'string' || typeof content === 'object') {\r\n            const wrapEle: Element = this.renderer.createElement('div');\r\n            wrapEle.innerHTML = this.domSanitizer.sanitize(SecurityContext.HTML, content)\r\n\r\n            return new ContentRef([wrapEle.childNodes]);\r\n        }\r\n\r\n        return new ContentRef([]);\r\n    }\r\n    /**\r\n     * 创建组件实例\r\n     * options {\r\n     *   componentType: 组件类\r\n     *   nodes：组件中的可注入节点\r\n     *   context: 组件属性配置,inputs属性均可在此配置\r\n     * }\r\n     */\r\n    public createCompoentRef(options: {\r\n        componentType?: any,\r\n        nodes?: Array<any>,\r\n        context?: { outputs?: Object, [propName: string]: any },\r\n        notDetectChanges?: boolean\r\n    }): ComponentRef<any> {\r\n        // 1. 根据component类创建组件引用\r\n        const componentRef: ComponentRef<any> = this.componentFactoryResolver\r\n            .resolveComponentFactory(options.componentType)\r\n            .create(this.injector, options.nodes);\r\n\r\n        // 2. 将组件绑定在ng component树上，不做绑定情况下，内容中的指令无法解析\r\n        this.applicationRef.attachView(componentRef.hostView);\r\n\r\n        // 3. 绑定组件上下文定义\r\n        Object.assign(componentRef.instance, options.context);\r\n        // outputs事件绑定\r\n        if (options.context && !Util.isUndefined(options.context.outputs)) {\r\n            for (const key in options.context.outputs) {\r\n                if (options.context.outputs.hasOwnProperty(key)) {\r\n                    componentRef.instance[key].subscribe(options.context.outputs[key]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 4. 确保组件视图根据数据能实时刷新上。\r\n        // 通过该处理可以确保组件及子组件都完成解析\r\n        if (!options.notDetectChanges) {\r\n            // 在组件的 metadata 中如果设置了OnPush 条件，那么变化检测不会再次执行,\r\n            // 但是调用该方法，可以确保数据变化被检测到\r\n            componentRef.changeDetectorRef.markForCheck();\r\n            // 从该组件到其子组件执行一次变化检测\r\n            componentRef.changeDetectorRef.detectChanges();\r\n        }\r\n\r\n        return componentRef;\r\n    }\r\n}\r\n","import {NgModule} from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: []\r\n})\r\nexport class TiRendererModule {\r\n}\r\n","import {Renderer2, Injectable, RendererFactory2} from '@angular/core';\r\nimport { TiRendererModule } from './TiRendererModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Injectable({\r\n    providedIn: TiRendererModule\r\n  })\r\nexport class TiRenderer {\r\n    private renderer: Renderer2;\r\n    constructor(rendererFactory: RendererFactory2) {\r\n        this.renderer = rendererFactory.createRenderer(null, null);\r\n    }\r\n    /**\r\n     * @description: 将节点插入某节点元素之后\r\n     * @param: sourceEle 被插入节点\r\n     * @param: targetEle 节点插入位置\r\n     */\r\n    public insertAfter(sourceEle, targetEle) {\r\n        const parent = targetEle.parentNode;\r\n        // 如果最后的节点是目标元素,则直接添加\r\n        if (parent.lastChild === targetEle) {\r\n            this.renderer.appendChild(parent, sourceEle);\r\n        } else {// 如果不是,则插在目标元素的下一个兄弟节点之前\r\n            this.renderer.insertBefore(parent, sourceEle, targetEle.nextSibling);\r\n        }\r\n    }\r\n    /**\r\n     * @description: 判读一个元素上是否存在某个样式类名\r\n     * @param: ele 被判断的元素\r\n     * @param: className 样式类名\r\n     */\r\n    public hasClass(element, className): boolean {\r\n      const classList = element.classList;\r\n      return classList.contains(className);\r\n    }\r\n    /**\r\n     * @description: 给指定元素设置属性\r\n     * @param: element 被设置的元素\r\n     * @param: attr Object 属性对象\r\n     */\r\n    public setAttributes(element, attr: Object) {\r\n        for (const key in attr) {\r\n            if (attr.hasOwnProperty(key)) {\r\n                this.renderer.setAttribute(element, key, String(attr[key]));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 为元素添加多个样式\r\n     * @param: ele 元素对象\r\n     * @param: styles  Object 样式对象，如：{width: 100, height: 200}\r\n     */\r\n    public setStyles(ele, styles) {\r\n        for (const key in styles) {\r\n            if (styles.hasOwnProperty(key)) {\r\n                this.renderer.setStyle(ele, key, styles[key]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 将节点插入某父容器，作为第一个元素\r\n     * @param: parentEle 父节点元素\r\n     * @param: sourceEle 需要插入的节点元素\r\n     */\r\n    public prepend(parentEle, sourceEle) {\r\n        if (!parentEle) {\r\n            return;\r\n        }\r\n        this.renderer.insertBefore(parentEle, sourceEle, parentEle.firstElementChild);\r\n    }\r\n\r\n    /**\r\n     * @description: 查找一个元素下有某个样式类的子元素\r\n     * @param: element 被查找的元素\r\n     * @param: className 子元素的样式类名\r\n     */\r\n    public findChildrenByClassName(element, className): Array<any> {\r\n        let resultChildren = [];\r\n        resultChildren = Array.from(element.children).filter((child: any) => {\r\n            return this.hasClass(child, className);\r\n        });\r\n\r\n        return resultChildren;\r\n    }\r\n    /**\r\n     * @description: 查找一个元素下有某个样式类的子元素\r\n     * @param: element 被查找的元素\r\n     * @param: className 子元素的样式类名\r\n     */\r\n    public findChildrenByTagName(element, tagName: string): Array<any> {\r\n        let resultChildren = [];\r\n        resultChildren = Array.from(element.children).filter((child: any) => {\r\n            return child.tagName === tagName;\r\n        });\r\n\r\n        return resultChildren;\r\n    }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n  selector: 'ti-tip-container',\r\n  template: `\r\n    <div class='ti3-tooltip-content'><ng-content></ng-content></div>\r\n    <div class='ti3-tooltip-sqr'></div>`,\r\n  host: {\r\n    '[class.ti3-tooltip]': 'true'\r\n  },\r\n  styleUrls: ['./tip.less']\r\n})\r\nexport class TiTipContainerComponent{\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiTipContainerComponent } from './TiTipContainerComponent';\r\nimport { TiPopupModule } from '../popup/TiPopupModule';\r\nimport { TiRendererModule } from '../renderer/TiRendererModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    TiPopupModule,\r\n    TiRendererModule\r\n  ],\r\n  exports: [],\r\n  declarations: [TiTipContainerComponent],\r\n  entryComponents: [TiTipContainerComponent]\r\n})\r\nexport class TiTipServiceModule {\r\n}\r\n","/* eslint-disable no-eq-null */\r\n/* eslint-disable eqeqeq */\r\n/**\r\n * 该类提供服务，用于管理Tip组件的创建和销毁\r\n * 服务中提供三个方法:\r\n * create(hostEle, config) 生成一个tip实例并返回对象，\r\n *   hostEle:宿主元素\r\n *   config:{\r\n *      position：tip元素位置\r\n *      maxWidth：最大宽度\r\n *      hasArrow：是否带箭头\r\n *      theme：tip色系 'black'/default\r\n *  }\r\n * 返回的实例对象中提供方法:\r\n * {\r\n *  show({ // 显示Tip组件\r\n *   content:弹出组件内容\r\n *   context:弹出组件上下文\r\n * })\r\n *  hide():隐藏并销毁Tip\r\n * }\r\n */\r\nimport { ComponentRef, Injectable, NgZone, Renderer2, RendererFactory2, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiContentType, TiPopUpRef, TiPopupService } from '../popup/TiPopupService';\r\nimport { Position, TiPositionResult, TiPositionType } from '../../utils/Position';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiRenderer } from '../renderer/TiRenderer';\r\n\r\nimport { TiTipContainerComponent } from './TiTipContainerComponent';\r\nimport { TiTipServiceModule } from './TiTipServiceModule';\r\nimport { TiTipConfig, TiTipRef, TiTipShowInfo } from './TiTipInterface';\r\n/**\r\n * @ignore\r\n */\r\nexport interface TiTipShowConfig {\r\n    popInstance: TiPopUpRef;\r\n    hostEle: Element;\r\n    content: TiContentType;\r\n    context: any;\r\n    config: TiTipConfig;\r\n}\r\n/**\r\n * tip提供了两种使用方式:\r\n *\r\n * 1.服务方式（见如下说明），使用该服务时需要引入模块TiTipServiceModule\r\n *\r\n * 2.指令方式：[TiTipDirective]{@link ../directives/TiTipDirective.html}\r\n *\r\n * <example-url>../tiny3demo/#/tip/tip-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiTipServiceModule\r\n})\r\nexport class TiTipService {\r\n    private static readonly DEFAULT_WIDTH: number = 276; // tip换行宽度\r\n    private static readonly SPACE: number = 6.5 + 5; // tip框与元素本身的距离 = 三角宽高 + tip三角到触发tip的内容区域的距离\r\n    private render: Renderer2;\r\n    constructor(private popService: TiPopupService<TiTipContainerComponent>,\r\n                rendererFactory: RendererFactory2, private tiRenderer: TiRenderer, private zone: NgZone\r\n                , @Inject(DOCUMENT) private document) {\r\n            /* tslint:disable:no-null-keyword */\r\n            this.render = rendererFactory.createRenderer(null, null);\r\n    }\r\n    /**\r\n     * 页面激活窗口改变事件处理，此处获取事件名称，该事件后续会在tip显示时注册，隐藏时销毁\r\n     * 添加该事件用于解决的问题现象是：tip带链接，并且点击链接跳转至新开页面，因此，当返回先前页面时，tip不消失（因为未触发任何tip消失的事件），\r\n     * 且移入其他出tip的元素，会出现页面有多个tip的现象\r\n     */\r\n    private getVisibleChangeEventName(): string {\r\n        const hiddenProperty: string = 'hidden' in this.document ? 'hidden' :\r\n            'webkitHidden' in this.document ? 'webkitHidden' :\r\n                'mozHidden' in this.document ? 'mozHidden' :\r\n                    '';\r\n\r\n        return hiddenProperty.replace(/hidden/i, 'visibilitychange');\r\n    }\r\n    public create(hostEle: Element, config?: TiTipConfig): TiTipRef {\r\n        // 宿主元素不存在情况下，不做处理\r\n        if (!Util.isElement(hostEle)) {\r\n            return;\r\n        }\r\n        const tipInstance: TiTipRef = this.createTip(hostEle, config);\r\n        this.addTriggerEvent(hostEle, config, tipInstance);\r\n\r\n        return tipInstance;\r\n    }\r\n    /**\r\n     * 创建Tip实例\r\n     *\r\n     * @param hostEle tip生成所依附的宿主元素\r\n     *\r\n     * @param config tip属性配置\r\n     *\r\n     * @returns 生成的Tip实例对象如下：\r\n     *\r\n     * ```\r\n     * {\r\n     *      // 显示tip方法\r\n     *      // @param content {string | TemplateRef<any> | any} tip显示内容，可为字符串/ng-template/component，具体用法见示例\r\n     *      // @param context {any} tip显示内容对应的上下文，content类型为templateRef或Component形式时会用到该参数\r\n     *      show: (content: string | TemplateRef<any> | any, context?: any) => void;\r\n     *\r\n     *      // 隐藏tip方法\r\n     *      hide: () => void;\r\n     * }\r\n     * ```\r\n     */\r\n    private createTip(hostEle: Element, config?: TiTipConfig): TiTipRef {\r\n        const popInstance: TiPopUpRef = this.popService.create(TiTipContainerComponent); // tip弹出服务实例，可通过调用show/hide方法切换组件的显示状态\r\n        let tipComponentRef: any; // 生成好的 tip 组件实例对象componentRef\r\n        const visibilityChangeEvent: string = this.getVisibleChangeEventName();\r\n        let visibleChangeEvtHandle: () => void;\r\n\r\n        // 组件添加全局事件销毁相关处理\r\n        let eventHandles: Array<() => void> = []; // 用于存储事件句柄，事件句柄在事件取消时需要用到\r\n\r\n        // 隐藏处理函数\r\n        const hideFn: () => void =\r\n           (): void => {\r\n            if (tipComponentRef != null) {\r\n                // 销毁弹出元素\r\n                popInstance.hide();\r\n                // 通过执行事件返回句柄方法解绑事件\r\n                Position.removePosChangeEvts(eventHandles);\r\n                if (config.registerVisibilityChangeEvent !== false) {\r\n                    visibleChangeEvtHandle();\r\n                }\r\n                tipComponentRef = null;\r\n            }\r\n        };\r\n\r\n        return {\r\n            show: (content: string, context?: any): ComponentRef<any> | undefined => {\r\n                if (Util.isUndefined(content) || content === '') {\r\n                    return;\r\n                }\r\n                // 显示Tip元素\r\n                tipComponentRef = this.showTip({\r\n                    popInstance,\r\n                    hostEle,\r\n                    content,\r\n                    context,\r\n                    config\r\n                });\r\n                // 添加全局事件，用于控制特殊情况下宿主位置改变时Tip的隐藏\r\n                eventHandles = Position.addPosChangeEvts(hideFn, this.render);\r\n                if (config.registerVisibilityChangeEvent !== false) {\r\n                    visibleChangeEvtHandle = this.render.listen(this.document, visibilityChangeEvent, hideFn);\r\n                }\r\n\r\n                return tipComponentRef;\r\n            },\r\n            hide: (): void => {\r\n                hideFn();\r\n            },\r\n            // 销毁tip\r\n            destroy: (): void => {\r\n                // 销毁tip前先隐藏\r\n                hideFn();\r\n            }\r\n\r\n        };\r\n    }\r\n\r\n    // 根据trigger配置为宿主元素添加事件，该事件用于控制tip的显示/隐藏\r\n    private addTriggerEvent(hostEle: Element, config: TiTipConfig, tipInstance: TiTipRef): void {\r\n        // 非mouse情况下，不用做事件处理\r\n        if (config.trigger !== 'mouse') {\r\n            return;\r\n        }\r\n        let tipComponentRef: ComponentRef<any> = null;\r\n        // 默认情况下，使用mouse进行tip显示和隐藏控制（只对指令形式有效）\r\n        this.zone.runOutsideAngular(() => {\r\n            const unlistenMouseenterFn: () => void = this.render.listen(hostEle, 'mouseenter', () => {\r\n                if (typeof config.showFn !== 'function') {\r\n                    return;\r\n                }\r\n                const showInfo: TiTipShowInfo = config.showFn();\r\n                if (!showInfo) {\r\n                    return;\r\n                }\r\n                this.zone.run(() => {\r\n                    tipComponentRef = tipInstance.show(showInfo.content, showInfo.context);\r\n                    if (!tipComponentRef) {\r\n                        return;\r\n                    }\r\n                    // 根据trigger配置添加tip元素本身事件，此处事件用于支持移出tip元素时tip消失\r\n                    const targetEle: Element = tipComponentRef.location.nativeElement;\r\n                    // eslint-disable-next-line max-nested-callbacks\r\n                    this.render.listen(targetEle, 'mouseleave', (event: MouseEvent) => {\r\n                        /**\r\n                         * 此处处理是为了解决Chrome高版本下，连续点击tip区域情况下，导致tip消失的问题\r\n                         * 【问题原因】chrome高版本（chrome60以上版本）下，连续的click事件会触发tipEle的mouseleave事件,\r\n                         * 从而导致tip消失\r\n                         * 【解决方案】如mouseleve事件是由tip元素本身点击触发的，则event.relatedTarget为null，则通过该\r\n                         * 方式进行特殊情况排除\r\n                         */\r\n                        if (event.relatedTarget === null) {\r\n                            return;\r\n                        }\r\n                        tipInstance.hide();\r\n                        tipComponentRef = null;\r\n                    });\r\n                });\r\n            });\r\n            const unlistenMouseleaveFn: () => void = this.render.listen(hostEle, 'mouseleave', (event: MouseEvent) => {\r\n                // 鼠标移入tip时，tip不消失\r\n                if (tipComponentRef && !tipComponentRef.location.nativeElement.contains(event.relatedTarget)) {\r\n                    this.zone.run(() => {\r\n                        tipInstance.hide();\r\n                        tipComponentRef = null;\r\n                    });\r\n                }\r\n            });\r\n            // 给实例添加销毁方法\r\n            tipInstance.destroy = (): void => {\r\n                // 先隐藏tip示例再取消监听事件\r\n                tipInstance.hide();\r\n                unlistenMouseenterFn();\r\n                unlistenMouseleaveFn();\r\n            };\r\n        });\r\n    }\r\n\r\n    private showTip(options: TiTipShowConfig): ComponentRef<any> {\r\n        const tipComponentRef: ComponentRef<any> = options.popInstance.show({\r\n            content: options.content,\r\n            contentContext: options.context,\r\n            container: 'body'\r\n        });\r\n        const targetEle: Element = tipComponentRef.location.nativeElement;\r\n        this.tiRenderer.setStyles(targetEle, {\r\n            left: '-9999px',\r\n            top: '-9999px'\r\n        });\r\n        this.setTipTheme(targetEle, options.config);\r\n        // 计算元素宽高时，需要确保元素已生成\r\n        this.setTipWidth(targetEle, options.config);\r\n        this.setPosition(options.hostEle, targetEle, options.config);\r\n\r\n        return tipComponentRef;\r\n    }\r\n\r\n    private setTipTheme(ele: Element, config: TiTipConfig): void {\r\n        if (!config || !config.theme) {\r\n            return;\r\n        }\r\n        if (config.theme === 'black') {\r\n            this.render.addClass(ele, 'ti3-tip-black-theme');\r\n        } else if (config.theme === 'white') {\r\n            this.render.addClass(ele, 'ti3-tip-white-theme');\r\n        }\r\n    }\r\n\r\n    private setTipWidth(ele: Element, config: TiTipConfig): void {\r\n        const maxWidth: number = parseInt((config && config.maxWidth) || TiTipService.DEFAULT_WIDTH as any, 10);\r\n        // 修复SSR错误：ERROR TypeError: ele.getBoundingClientRect is not a function\r\n        if (typeof ele.getBoundingClientRect !== 'function') {\r\n            return;\r\n        }\r\n        const targetWidth: number = ele.getBoundingClientRect().width;\r\n        if (targetWidth > maxWidth) {\r\n            // 如果宽度超过最大值，重新设置当前tip的内容宽度\r\n            this.render.setStyle(ele, 'width', `${maxWidth}px`);\r\n        }\r\n    }\r\n\r\n    private setPosition(hostEle: Element, targetEle: Element, config: TiTipConfig): void {\r\n        const result: TiPositionResult = Position.setPosition({\r\n            targetEle,\r\n            hostEle,\r\n            hostEleX: config.hostEleX,\r\n            position: config && config.position || 'auto',\r\n            hostSpace: TiTipService.SPACE,\r\n            fixMaxHeight: true,\r\n            hasOffsetFix: true\r\n        });\r\n        const position: TiPositionType = result.position;\r\n        if (!config || config.hasArrow !== false) {// 未定义或定义为false情况下都需要加该样式类控制三角样式\r\n            this.render.addClass(targetEle, `ti3-tooltip-${position}`);\r\n        }\r\n        // 设置该样式类是为了支持鼠标移入Tip不消失：使用该样式类用于确保tip和宿主元素连接处的DOM在tip范围内\r\n        this.render.addClass(targetEle.querySelector('.ti3-tooltip-sqr'), `ti3-tooltip-${position}-sqr`);\r\n        // 设置当前tip的内容最大高度，超出显示滚动条\r\n        this.tiRenderer.setStyles(targetEle.querySelector('.ti3-tooltip-content'), {\r\n            maxHeight: result.avilableHeight\r\n        });\r\n    }\r\n}\r\n","import { ComponentRef, Directive, ElementRef, Input, OnDestroy, OnInit, Renderer2, TemplateRef } from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\nimport { TiTipRef, TiTipShowInfo } from '../../services/tip/TiTipInterface';\r\nimport { TiTipService } from '../../services/tip/TiTipService';\r\n\r\n// TODO:exportAs: 'tiTip' 可去除？\r\n/**\r\n * tip提供了两种使用方式:\r\n * 1.服务方式：[TiTipService]{@link ../injectables/TiTipService.html}\r\n *\r\n * 2.指令方式（见如下说明）\r\n *\r\n * <example-url>../tiny3demo/#/tip/tip-all</example-url>\r\n */\r\n@Directive({\r\n  selector: '[tiTip]',\r\n  exportAs: 'tiTip'\r\n})\r\nexport class TiTipDirective implements OnInit, OnDestroy {\r\n    /**\r\n     * Tip显示位置属性配置\r\n     */\r\n    @Input() tiTipPosition?: TiPositionType = 'auto';\r\n   /**\r\n    * 最大宽度\r\n    *\r\n    */\r\n   @Input() tiTipMaxWidth: string = '276px';\r\n    /**\r\n     * 是否带箭头\r\n     */\r\n    @Input() tiTipHasArrow?: boolean = true;\r\n    /**\r\n     * tip显示内容对应的上下文，tip内容类型为templateRef或Component形式时会用到该参数，参数为自定义对象形式\r\n     *\r\n     * 注意：指令形式时才会使用到该参数\r\n     */\r\n    @Input() tiTipContext?: any;\r\n    /**\r\n     * tip生成方式，默认支持鼠标移入移出时显示/隐藏\r\n     *\r\n     * 注意：指令形式时才会使用到该参数\r\n     */\r\n    @Input() tiTipTrigger?: 'mouse'|'manual' = 'mouse';\r\n    /**\r\n     * @ignore\r\n     * 决定tip水平方向位置的宿主元素配置\r\n     */\r\n    @Input() tiTipHostEleX: Element;\r\n    protected tipInstance: TiTipRef;\r\n    private hostEle: Element;\r\n    private _tiTip: string | TemplateRef<any>;\r\n    constructor(private tipService: TiTipService,\r\n                hostEleRef: ElementRef) {\r\n        this.hostEle = hostEleRef.nativeElement;\r\n    }\r\n\r\n    private static isInValidValue(value: string | TemplateRef<any>): boolean {\r\n        return Util.isUndefined(value) || Util.isNull(value) || value === '';\r\n    }\r\n    ngOnInit(): void {\r\n        // 初始创建tip实例\r\n        this.tipInstance = this.tipService.create(this.hostEle, {\r\n            position: this.tiTipPosition,\r\n            maxWidth: this.tiTipMaxWidth,\r\n            hasArrow: this.tiTipHasArrow,\r\n            hostEleX: this.tiTipHostEleX,\r\n            trigger: this.tiTipTrigger || 'mouse', // 指令方式，默认为'mouse'\r\n            showFn: (): TiTipShowInfo => {\r\n                if (!this.tipInstance || TiTipDirective.isInValidValue(this._tiTip)) {\r\n                    return;\r\n                }\r\n\r\n                return { content: this._tiTip, context: this.tiTipContext };\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * tip显示内容配置\r\n     *\r\n     * 类型：string | TemplateRef<any> | any\r\n     *\r\n     * 传入string类型时，在v3.0.6及之前的版本存在XSS攻击风险；v3.0.7做了安全处理后不存在XSS风险了，把传入的字符串当做纯文本解析，传入什么显示什么；\r\n     * v10.1.4版本支持html字符串片段，也已做安全处理。\r\n     */\r\n    @Input()\r\n    // 监听tip值的变化，当tip为''或undefined情况下，直接隐藏tip组件\r\n    /**\r\n     * @ignore\r\n     */\r\n    set tiTip(value: string | TemplateRef<any>) {\r\n        this._tiTip = value;\r\n        if (TiTipDirective.isInValidValue(value)) {\r\n            this.hide();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    get tiTip(): string | TemplateRef<any> {\r\n        return this._tiTip;\r\n    }\r\n    /**\r\n     * 显示tip方法\r\n     */\r\n    public show(): ComponentRef<any> {\r\n        if (!this.tipInstance || TiTipDirective.isInValidValue(this._tiTip)) {\r\n            return;\r\n        }\r\n\r\n        return this.tipInstance.show(this._tiTip, this.tiTipContext);\r\n    }\r\n    /**\r\n     * 隐藏tip方法\r\n     */\r\n    public hide(): void {\r\n        if (this.tipInstance) {\r\n            this.tipInstance.hide();\r\n        }\r\n    }\r\n    // 宿主销毁，tip连带销毁\r\n    ngOnDestroy(): void {\r\n        this.tipInstance.hide();\r\n        /* tslint:disable:no-null-keyword */\r\n        this.tipInstance = null;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTipDirective } from './TiTipDirective';\r\nimport { TiTipServiceModule } from '../../services/tip/TiTipServiceModule';\r\n// 引用TiTipModule，可以使用Tip指令和Tip服务\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiTipServiceModule\r\n  ],\r\n  exports: [TiTipDirective],\r\n  declarations: [TiTipDirective]\r\n})\r\nexport class TiTipModule {\r\n}\r\nexport { TiTipDirective } from './TiTipDirective';\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的中文国际化词条\r\n */\r\nexport const zh_CN: TiLocaleWords = {\r\n  tiLocaleKey: 'zh-CN',\r\n  tiLocaleDate: {\r\n    date: 'yyyy/MM/dd',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: '确定',\r\n    cancelBtn: '取消'\r\n  },\r\n  tiActionmenu: {\r\n    more: '更多',\r\n    operation: '操作'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: '输入不能为空。',\r\n      maxLength: '输入长度不能超过{0}个字符。',\r\n      minLength: '输入长度不能小于{0}个字符。',\r\n      rangeSize: '输入长度范围为{0}到{1}个字符。',\r\n      maxValue: '输入值不能超过{0}。',\r\n      minValue: '输入值不能小于{0}。',\r\n      rangeValue: '输入值必须在{0}到{1}之间。',\r\n      regExp: '输入值无效。',\r\n      contains: '输入值必须包含有字符{0}。',\r\n      notContains: '输入值不能含有非法字符{0}。',\r\n      notScript: '输入值不能含有script标签。',\r\n      equal: '输入值必须等于{0}。',\r\n      notEqual: '输入值不能等于{0}。',\r\n      port: '端口号为{0}到{1}的整数。',\r\n      path: '输入值未满足路径格式要求。',\r\n      email: '输入email地址无效。',\r\n      date: '输入日期无效。',\r\n      url: '输入URL无效。',\r\n      integer: '输入值不是有效整数。',\r\n      number: '输入值不是有效数字。',\r\n      digits: '输入值不是有效数字字符。',\r\n      ipv4: '输入值不是有效IPv4地址。',\r\n      ipv6: '输入值不是有效IPv6地址。',\r\n      password: '密码输入不符合要求，请重新输入。'\r\n    },\r\n    message: {\r\n      rangeSize: '{0}~{1}个字符。',\r\n      minCharType: '至少包含以下字符中的{0}种：大写字母、小写字母、数字、特殊字符`~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/?  和空格。',\r\n      notEqualPosRev: '不能与用户名或倒序的用户名相同。'\r\n    },\r\n    passwordStrength: {\r\n      securityText: '安全程度:',\r\n      levelDecArr: ['弱', '中', '强']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: '跳转',\r\n    prevTitle: '上一页',\r\n    nextTitle: '下一页',\r\n    totalLabel: '总条数：'\r\n  },\r\n  tiMessage: {\r\n    prompt: '提示',\r\n    warn: '警告',\r\n    confirm: '确认',\r\n    error: '错误',\r\n    ok: '确认',\r\n    cancel: '取消'\r\n  },\r\n  tiUpload: {\r\n    addFile: '添加文件',\r\n    error: '上传失败！', // upload_error_info\r\n    successInfo: '上传成功！',\r\n    uploadingSingleInfo: '正在上传',\r\n    errorSingleInfo: '上传失败！',\r\n    addSuccessMutiInfo: '已添加{0}个文件',\r\n    uploadingMutiInfo: '{0} 正在上传',\r\n    errorMultiInfo: '{0}个文件上传失败！',\r\n    clearAll: '清空选择',\r\n    upload: '上传文件',\r\n    cancel: '取消上传',\r\n    reload: '重新上传',\r\n    autoUploadFilePlaceholder: '点击右侧按钮上传文件',\r\n    autoUploadFilesPlaceholder: '点击右侧按钮上传文件',\r\n    notAutoUploadFilePlaceholder: '点击右侧按钮先添加再上传',\r\n    notAutoUploadFilesPlaceholder: '点击右侧按钮先添加再上传'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: '请选择日期',\r\n    datetimePlaceholder: '请选择日期时间',\r\n    weekNamesAbb: ['日', '一', '二', '三', '四', '五', '六'],\r\n    weeknamesTitle: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],\r\n    monthNamesAbb: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9个月', '1 年', '2 年', '3 年'],\r\n    yearSuffixLabel: '年',\r\n    rangeBeginLabel: '开始日期',\r\n    rangeEndLabel: '结束日期',\r\n    selectTime: '选择时间',\r\n    selectDate: '选择日期',\r\n    hour: '时',\r\n    minute: '分',\r\n    second: '秒'\r\n  },\r\n  tiSelect: {\r\n    search: '搜索',\r\n    selected: '已选'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: '自定义列表项'\r\n  },\r\n  tiList: {\r\n    selectAll: '(全选)'\r\n  },\r\n  tiIntro: {\r\n    skip: '跳过',\r\n    previous: '上一步',\r\n    next: '下一步',\r\n    finish: '立即体验'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: '是',\r\n    noLabel: '否'\r\n  },\r\n  tiTree: {\r\n    reload: '重新加载',\r\n    loadError: '加载失败，',\r\n    newNode: '新节点'\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的英文国际化词条\r\n */\r\nexport const en_US: TiLocaleWords = {\r\n  tiLocaleKey: 'en-US',\r\n  tiLocaleDate: {\r\n    date: 'MMM dd, yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'OK',\r\n    cancelBtn: 'Cancel'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'More',\r\n    operation: 'Operation'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'This field cannot be left blank.',\r\n      maxLength: 'Enter a maximum of {0} characters.',\r\n      minLength: 'Enter at least {0} characters.',\r\n      rangeSize: 'Enter {0} to {1} characters.',\r\n      maxValue: 'Enter a value less than or equal to {0}.',\r\n      minValue: 'Enter a value greater than or equal to {0}.',\r\n      rangeValue: 'Enter a value from {0} to {1}.',\r\n      regExp: 'Invalid value.',\r\n      contains: 'The value must contain the following characters: {0}.',\r\n      notContains: 'The value cannot contain the following invalid characters: {0}.',\r\n      notScript: 'The value cannot contain script tags.',\r\n      equal: 'The value must be {0}.',\r\n      notEqual: 'The value cannot be {0}.',\r\n      port: 'Enter an integer from {0} to {1}.',\r\n      path: 'Enter a valid file path.',\r\n      email: 'Enter a valid email address.',\r\n      date: 'Enter a valid date.',\r\n      url: 'Enter a valid URL.',\r\n      integer: 'Enter a valid integer.',\r\n      number: 'Enter a valid number.',\r\n      digits: 'Enter a valid number.',\r\n      ipv4: 'Enter a valid IPv4 address.',\r\n      ipv6: 'Enter a valid IPv6 address.',\r\n      password: 'Invalid password.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Must be {0} to {1} characters long.',\r\n      minCharType: 'Must contain at least {0} of the following character types: ' +\r\n                  'letters, digits, and special characters ( `~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/? and spaces). ',\r\n      notEqualPosRev: 'Cannot be the username or the username spelled backwards.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Password Strength:',\r\n      levelDecArr: ['Weak', 'Medium', 'Strong']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Go',\r\n    prevTitle: 'Previous',\r\n    nextTitle: 'Next',\r\n    totalLabel: 'Total Records: '\r\n  },\r\n  // message控件词条\r\n  tiMessage: {\r\n    prompt: 'Information',\r\n    warn: 'Warning',\r\n    confirm: 'Confirm',\r\n    error: 'Error',\r\n    ok: 'OK',\r\n    cancel: 'Cancel'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Select File', // upload_add_file_btn\r\n    error: 'Failed to upload the file.', // upload_error_info\r\n    successInfo: 'File uploaded successfully.', // upload_success_info\r\n    uploadingSingleInfo: 'Uploading', // upload_single_uploading_general_info\r\n    errorSingleInfo: 'Failed to upload the file.', // upload_single_error_general_info\r\n    addSuccessMutiInfo: 'You have added {0} files.', // upload_add_success_general_info\r\n    uploadingMutiInfo: 'Uploading: {0}', // upload_uploading_general_info\r\n    errorMultiInfo: 'Failed to upload {0} files.', // upload_error_general_info\r\n    clearAll: 'Clear All', // upload_remove_files\r\n    upload: 'Upload', // upload_file_btn\r\n    cancel: 'Cancel', // upload_cancel_files\r\n    reload: 'Upload Again', // upload_reload_files\r\n    autoUploadFilePlaceholder: 'Select a file to upload.',\r\n    autoUploadFilesPlaceholder: 'Select files to upload.',\r\n    notAutoUploadFilePlaceholder: 'Add a file and upload it.',\r\n    notAutoUploadFilesPlaceholder: 'Add files and upload them.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Select a date.',\r\n    datetimePlaceholder: 'Select a date and time.',\r\n    weekNamesAbb: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\r\n    weeknamesTitle: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\r\n    monthNamesAbb: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 months', '1 year', '2 years', '3 years'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Start Date',\r\n    rangeEndLabel: 'End Date',\r\n    selectTime: 'Select Time',\r\n    selectDate: 'Select Date',\r\n    hour: 'Hour',\r\n    minute: 'Minute',\r\n    second: 'Second'\r\n  },\r\n  tiSelect: {\r\n    search: 'Search',\r\n    selected: 'Selected'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Customize Column'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Select all)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Skip',\r\n    previous: 'Previous',\r\n    next: 'Next',\r\n    finish: 'Finish'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Yes',\r\n    noLabel: 'No'\r\n  },\r\n  tiTree: {\r\n    reload: 'Reload',\r\n    loadError: 'Loading failed. ',\r\n    newNode: 'New node '\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的德语国际化词条\r\n */\r\nexport const de_DE: TiLocaleWords = {\r\n  tiLocaleKey: 'de-DE',\r\n  tiLocaleDate: {\r\n    date: 'dd.MM.yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'OK',\r\n    cancelBtn: 'Abbrechen'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'Mehr',\r\n    operation: 'Betrieb'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'Die Eingabe muss erfolgen.',\r\n      maxLength: 'Die Länge der Eingabe kann {0} nicht überschreiten.',\r\n      minLength: 'Die Länge der Eingabe kann nicht kleiner als {0} sein.',\r\n      rangeSize: 'Die Länge der Eingabe muss zwischen {0} und {1} liegen.',\r\n      maxValue: 'Der Eingabewert kann {0} nicht überschreiten.',\r\n      minValue: 'Der Eingabewert kann nicht kleiner als {0} sein.',\r\n      rangeValue: 'Der Eingabewert muss im Bereich zwischen {0} und {1} liegen.',\r\n      regExp: 'Der Eingabewert ist ungültig.',\r\n      contains: 'The value must contain the following characters: {0}.',\r\n      notContains: 'Der Eingabewert kann keine unzulässigen Zeichen enthalten {0}.',\r\n      notScript: 'Der Eingabewert kann keinen Skript-Tag enthalten.',\r\n      equal: 'Der Eingabewert muss gleich {0} sein.',\r\n      notEqual: 'The value cannot be {0}.',\r\n      port: 'Die Portnummer ist eine ganze Zahl zwischen {0} und {1}.',\r\n      path: 'Der Eingabewert entspricht nicht den Anforderungen an das Pfadformat.',\r\n      email: 'Der Eingabewert ist keine gültige E-Mails-Adresse.',\r\n      date: '\"Der Eingabewert ist keine gültiges Datum.',\r\n      url: 'Der Eingabewert ist keine gültige URL.',\r\n      integer: 'Der Eingabewert ist keine gültige ganze Zahl.',\r\n      number: '\"Der Eingabewert ist keine gültige Zahl.',\r\n      digits: 'Der Eingabewert ist keine gültige Zahl.',\r\n      ipv4: 'Der Eingabewert ist keine gültige IPv4-Adresse.',\r\n      ipv6: 'Der Eingabewert ist keine gültige IPv6-Adresse.',\r\n      password: 'Invalid password.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Must be {0} to {1} characters long.',\r\n      minCharType: 'Must contain at least {0} of the following character types: ' +\r\n                  'uppercase letters, lowercase letters, digits, and special characters ( `~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/? and spaces).',\r\n      notEqualPosRev: 'Cannot be the username or the username spelled backwards.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Password Strength:',\r\n      levelDecArr: ['Weak', 'Medium', 'Strong']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Navigieren Sie',\r\n    prevTitle: 'Vorherige',\r\n    nextTitle: 'Weiter',\r\n    totalLabel: 'Gesamtzahl der Datensätze: '\r\n  },\r\n  tiMessage: {\r\n    prompt: 'Informationen',\r\n    warn: 'Warnung',\r\n    confirm: 'Bestätigen',\r\n    error: 'Fehler',\r\n    ok: 'OK',\r\n    cancel: 'Abbrechen'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Datei hinzufügen',\r\n    error: 'Failed to upload the file.',\r\n    successInfo: 'Hochladen.',\r\n    uploadingSingleInfo: 'Uploading',\r\n    errorSingleInfo: 'Failed to upload the file.',\r\n    addSuccessMutiInfo: 'You have added {0} files.',\r\n    uploadingMutiInfo: 'Uploading: {0}',\r\n    errorMultiInfo: 'Failed to upload {0} files.',\r\n    clearAll: 'Clear All',\r\n    upload: 'Upload',\r\n    cancel: 'Cancel',\r\n    reload: 'Upload Again',\r\n    autoUploadFilePlaceholder: 'Select a file to upload.',\r\n    autoUploadFilesPlaceholder: 'Select files to upload.',\r\n    notAutoUploadFilePlaceholder: 'Add a file and upload it.',\r\n    notAutoUploadFilesPlaceholder: 'Add files and upload them.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Select a date.',\r\n    datetimePlaceholder: 'Select a date and time.',\r\n    weekNamesAbb: ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'],\r\n    weeknamesTitle: ['Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Sonntag'],\r\n    monthNamesAbb: ['Jan', 'Feb', 'Mrz', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 months', '1 year', '2 years', '3 years'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Start Date',\r\n    rangeEndLabel: 'End Date',\r\n    selectTime: 'Select Time',\r\n    selectDate: 'Select Date',\r\n    hour: 'Hour',\r\n    minute: 'Minute',\r\n    second: 'Second'\r\n  },\r\n  tiSelect: {\r\n    search: 'Search',\r\n    selected: 'Selected'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Customize Column'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Alle auswählen)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Skip',\r\n    previous: 'Previous',\r\n    next: 'Next',\r\n    finish: 'Try Now'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Yes',\r\n    noLabel: 'No'\r\n  },\r\n  tiTree: {\r\n    reload: 'Reload',\r\n    loadError: 'Loading failed. ',\r\n    newNode: 'New node '\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的欧洲西语国际化词条\r\n */\r\nexport const es_ES: TiLocaleWords = {\r\n  tiLocaleKey: 'es-ES',\r\n  tiLocaleDate: {\r\n    date: 'dd/MM/yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'Aceptar',\r\n    cancelBtn: 'Cancelar'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'Más',\r\n    operation: 'Operar'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'Este campo es obligatorio.',\r\n      maxLength: 'Introduzca {0} caracteres como máximo.',\r\n      minLength: 'Introduzca {0} caracteres como mínimo.',\r\n      rangeSize: 'Introduzca entre {0} y {1} caracteres.',\r\n      maxValue: 'Introduzca un valor inferior o igual a {0}.',\r\n      minValue: 'Introduzca un valor superior o igual a {0}.',\r\n      rangeValue: 'Introduzca un valor entre {0} y {1}.',\r\n      regExp: 'Valor no válido.',\r\n      contains: 'El valor debe contener los siguientes caracteres: {0}.',\r\n      notContains: 'El valor no puede contener los siguientes caracteres no válidos: {0}.',\r\n      notScript: 'El valor no puede contener etiquetas de scripts.',\r\n      equal: 'El valor debe ser {0}',\r\n      notEqual: 'El valor no puede ser {0}.',\r\n      port: 'Introduzca un número entero entre {0} y {1}.',\r\n      path: 'Introduzca una ruta de fichero válida.',\r\n      email: 'Introduzca una dirección de correo electrónico válida.',\r\n      date: 'Introduzca una fecha válida.',\r\n      url: 'Introduzca un URL válido.',\r\n      integer: 'Introduzca un número entero válido.',\r\n      number: 'Introduzca un número válido.',\r\n      digits: 'Introduzca un número válido.',\r\n      ipv4: 'Introduzca una dirección IPv4 válida.',\r\n      ipv6: 'Introduzca una dirección IPv6 válida.',\r\n      password: 'Contraseña no válida.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Debe contener entre {0} y {1} caracteres.',\r\n      minCharType: 'Debe contener al menos {0} de los siguientes tipos de caracteres: ' +\r\n            'letras, dígitos y caracteres especiales ( `~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/?  o espacios). ',\r\n      notEqualPosRev: 'No puede ser el nombre de usuario ni el nombre de usuario escrito al revés.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Nivel de seguridad:',\r\n      levelDecArr: ['Bajo', 'Medio', 'Alto']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Ir',\r\n    prevTitle: 'Anterior',\r\n    nextTitle: 'Siguiente',\r\n    totalLabel: 'Cantidad total de registros: '\r\n  },\r\n  tiMessage: {\r\n    prompt: 'Información',\r\n    warn: 'Advertencia',\r\n    confirm: 'Confirmar',\r\n    error: 'Error',\r\n    ok: 'Aceptar',\r\n    cancel: 'Cancelar'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Seleccionar fichero',\r\n    error: 'Error al cargar el fichero.',\r\n    successInfo: 'Se ha cargado el fichero.',\r\n    uploadingSingleInfo: 'Cargando',\r\n    errorSingleInfo: 'Error al cargar el fichero.',\r\n    addSuccessMutiInfo: 'Se han agregado {0} ficheros.',\r\n    uploadingMutiInfo: 'Cargando: {0}',\r\n    errorMultiInfo: 'Error al cargar {0} ficheros.',\r\n    clearAll: 'Eliminar todo',\r\n    upload: 'Cargar',\r\n    cancel: 'Cancelar',\r\n    reload: 'Volver a cargar',\r\n    autoUploadFilePlaceholder: 'Seleccione un fichero para cargar.',\r\n    autoUploadFilesPlaceholder: 'Seleccione ficheros para cargar.',\r\n    notAutoUploadFilePlaceholder: 'Añada un fichero y cárguelo.',\r\n    notAutoUploadFilesPlaceholder: 'Añada ficheros y cárguelos.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Seleccione una fecha.',\r\n    datetimePlaceholder: 'Seleccione una fecha y hora.',\r\n    weekNamesAbb: ['Do.', 'Lu.', 'Ma.', 'Mi.', 'Ju.', 'Vi.', 'Sá.'],\r\n    weeknamesTitle: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],\r\n    monthNamesAbb: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 meses', '1 año', '2 años', '3 años'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Inicio',\r\n    rangeEndLabel: 'Fin',\r\n    selectTime: 'Seleccionar hora',\r\n    selectDate: 'Seleccionar fecha',\r\n    hour: 'Hora',\r\n    minute: 'Minuto',\r\n    second: 'Segundo'\r\n  },\r\n  tiSelect: {\r\n    search: 'Buscar',\r\n    selected: 'Seleccionados'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Personalizar columna'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Seleccionar todo)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Omitir',\r\n    previous: 'Anterior',\r\n    next: 'Siguiente',\r\n    finish: 'Finalizar'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Sí',\r\n    noLabel: 'No'\r\n  },\r\n  tiTree: {\r\n    reload: 'Volver a cargar',\r\n    loadError: 'Error al cargar. ',\r\n    newNode: 'Nodo nuevo '\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的拉美西语国际化词条\r\n */\r\nexport const es_US: TiLocaleWords = {\r\n  tiLocaleKey: 'es-US',\r\n  tiLocaleDate: {\r\n    date: 'dd/MM/yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'Aceptar',\r\n    cancelBtn: 'Cancelar'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'Más',\r\n    operation: 'Operación'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'Este campo es obligatorio.',\r\n      maxLength: 'Ingrese {0} caracteres como máximo.',\r\n      minLength: 'Ingrese {0} caracteres como mínimo.',\r\n      rangeSize: 'Ingrese entre {0} y {1} caracteres.',\r\n      maxValue: 'Ingrese un valor inferior o igual a {0}.',\r\n      minValue: 'Ingrese un valor superior o igual a {0}.',\r\n      rangeValue: 'Ingrese un valor entre {0} y {1}.',\r\n      regExp: 'Valor no válido.',\r\n      contains: 'El valor debe contener los siguientes caracteres: {0}.',\r\n      notContains: 'El valor no puede contener los siguientes caracteres no válidos: {0}.',\r\n      notScript: 'El valor no puede contener etiquetas de scripts.',\r\n      equal: 'El valor debe ser {0}',\r\n      notEqual: 'El valor no puede ser {0}.',\r\n      port: 'Ingrese un número entero entre {0} y {1}.',\r\n      path: 'Ingrese una ruta de archivo válida.',\r\n      email: 'Ingrese una dirección de correo electrónico válida.',\r\n      date: 'Ingrese una fecha válida.',\r\n      url: 'Ingrese un URL válido.',\r\n      integer: 'Ingrese un número entero válido.',\r\n      number: 'Ingrese un número válido.',\r\n      digits: 'Ingrese un número válido.',\r\n      ipv4: 'Ingrese una dirección IPv4 válida.',\r\n      ipv6: 'Ingrese una dirección IPv6 válida.',\r\n      password: 'Contraseña no válida.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Debe contener entre {0} y {1} caracteres.',\r\n      minCharType: 'Debe contener al menos {0} de los siguientes tipos de caracteres: ' +\r\n            'letras, dígitos y caracteres especiales ( `~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/?  o espacios). ',\r\n      notEqualPosRev: 'No puede ser el nombre de usuario ni el nombre de usuario escrito al revés.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Nivel de seguridad:',\r\n      levelDecArr: ['Bajo', 'Medio', 'Alto']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Ir',\r\n    prevTitle: 'Anterior',\r\n    nextTitle: 'Siguiente',\r\n    totalLabel: 'Cantidad total de registros: '\r\n  },\r\n  tiMessage: {\r\n    prompt: 'Información',\r\n    warn: 'Advertencia',\r\n    confirm: 'Confirmar',\r\n    error: 'Error',\r\n    ok: 'Aceptar',\r\n    cancel: 'Cancelar'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Seleccionar archivo',\r\n    error: 'Error al cargar el archivo.',\r\n    successInfo: 'Se cargó el archivo.',\r\n    uploadingSingleInfo: 'Cargando',\r\n    errorSingleInfo: 'Error al cargar el archivo.',\r\n    addSuccessMutiInfo: 'Se agregaron {0} archivos.',\r\n    uploadingMutiInfo: 'Cargando: {0}',\r\n    errorMultiInfo: 'Error al cargar {0} archivos.',\r\n    clearAll: 'Eliminar todo',\r\n    upload: 'Cargar',\r\n    cancel: 'Cancelar',\r\n    reload: 'Volver a cargar',\r\n    autoUploadFilePlaceholder: 'Seleccione un archivo para cargar.',\r\n    autoUploadFilesPlaceholder: 'Seleccione archivos para cargar.',\r\n    notAutoUploadFilePlaceholder: 'Agregue un archivo y cárguelo.',\r\n    notAutoUploadFilesPlaceholder: 'Agregue archivos y cárguelos.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Seleccione una fecha.',\r\n    datetimePlaceholder: 'Seleccione una fecha y hora.',\r\n    weekNamesAbb: ['Do.', 'Lu.', 'Ma.', 'Mi.', 'Ju.', 'Vi.', 'Sá.'],\r\n    weeknamesTitle: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],\r\n    monthNamesAbb: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 meses', '1 año', '2 años', '3 años'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Inicio',\r\n    rangeEndLabel: 'Fin',\r\n    selectTime: 'Seleccionar hora',\r\n    selectDate: 'Seleccionar fecha',\r\n    hour: 'Hora',\r\n    minute: 'Minuto',\r\n    second: 'Segundo'\r\n  },\r\n  tiSelect: {\r\n    search: 'Buscar',\r\n    selected: 'Seleccionados'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Personalizar columna'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Seleccionar todo)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Omitir',\r\n    previous: 'Anterior',\r\n    next: 'Siguiente',\r\n    finish: 'Finalizar'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Sí',\r\n    noLabel: 'No'\r\n  },\r\n  tiTree: {\r\n    reload: 'Volver a cargar',\r\n    loadError: 'Error al cargar. ',\r\n    newNode: 'Nodo nuevo '\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的法语国际化词条\r\n */\r\nexport const fr_FR: TiLocaleWords = {\r\n  tiLocaleKey: 'fr-FR',\r\n  tiLocaleDate: {\r\n    date: 'dd/MM/yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'OK',\r\n    cancelBtn: 'Annuler'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'Plus',\r\n    operation: 'Opérer'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'Ce champs ne peut pas être vide.',\r\n      maxLength: 'Saisissez un maximum de {0} caractères.',\r\n      minLength: 'Saisissez au moins {0} caractères.',\r\n      rangeSize: 'Saisissez les caractères {0} à {1}.',\r\n      maxValue: 'Saisissez une valeur inférieure ou égale à {0}.',\r\n      minValue: 'Saisissez une valeur supérieure ou égale à {0}.',\r\n      rangeValue: 'Saisissez une valeur comprise entre {0} et {1}.',\r\n      regExp: 'Valeur non valable.',\r\n      contains: 'La valeur doit contenir les caractères suivants : {0}.',\r\n      notContains: 'La valeur ne peut pas contenir les caractères non valables suivants : {0}.',\r\n      notScript: 'La valeur ne peut pas contenir de script tags.',\r\n      equal: 'La valeur d\\'entrée doit être égale à {0}.',\r\n      notEqual: 'La valeur ne peut pas être {0}',\r\n      port: 'Le numéro de port est un nombre entier allant de {0} à {1}.',\r\n      path: 'Entrez un chemin de fichier valide.',\r\n      email: 'Entrez une adresse électronique valide.',\r\n      date: 'Saisissez une date valide.',\r\n      url: 'Saisissez une URL valide.',\r\n      integer: 'Saisissez un nombre entier valide.',\r\n      number: 'Saisissez un nombre valide.',\r\n      digits: 'Saisissez un nombre valide.',\r\n      ipv4: 'Saisissez une adresse IPv4 valide.',\r\n      ipv6: 'Saisissez une adresse IPv6 valide.',\r\n      password: 'Mot de passe non valide.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Doit comporter de {0} à {1} caractères.',\r\n      minCharType: 'Doit contenir au moins {0} des types de caractères suivants: ' +\r\n            'lettres, chiffres et caractères spéciaux ( `~!@#$%^&*()-_=+\\|[{}];:\\'\\\",<.>/ ? et espaces). ',\r\n      notEqualPosRev: 'Il ne peut s\\'agir du nom d\\'utilisateur ou du nom d\\'utilisateur orthographié à l\\'envers.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Force du mot de passe :',\r\n      levelDecArr: ['Faible', 'Moyen', 'Fort']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Aller',\r\n    prevTitle: 'Précédent',\r\n    nextTitle: 'Prochain',\r\n    totalLabel: 'Total des enregistrements: '\r\n  },\r\n  tiMessage: {\r\n    prompt: 'Information',\r\n    warn: 'Attention',\r\n    confirm: 'Confirmer',\r\n    error: 'Erreur',\r\n    ok: 'OK',\r\n    cancel: 'Annuler'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Ajouter le fichier',\r\n    error: 'Échec à télécharger le fichier.',\r\n    successInfo: 'Etape réalisée avec succès.',\r\n    uploadingSingleInfo: 'Téléchargement',\r\n    errorSingleInfo: 'Échec à télécharger le fichier.',\r\n    addSuccessMutiInfo: 'Vous avez ajouté {0} fichiers.',\r\n    uploadingMutiInfo: 'Téléchargement : {0}',\r\n    errorMultiInfo: 'Echec à télécharger {0} fichiers.',\r\n    clearAll: 'Tout effacer',\r\n    upload: 'Télécharger',\r\n    cancel: 'Annuler',\r\n    reload: 'Télécharger à nouveau',\r\n    autoUploadFilePlaceholder: 'Sélectionnez un fichier à télécharger.',\r\n    autoUploadFilesPlaceholder: 'Sélectionnez les fichiers à télécharger.',\r\n    notAutoUploadFilePlaceholder: 'Ajoutez un fichier et le télécharger.',\r\n    notAutoUploadFilesPlaceholder: 'Ajoutez des fichiers et les télécharger.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Sélectionnez une date.',\r\n    datetimePlaceholder: 'Sélectionnez une date et une heure.',\r\n    weekNamesAbb: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],\r\n    weeknamesTitle: ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'],\r\n    monthNamesAbb: ['Jan', 'Feb', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 mois', '1 an', '2 ans', '3 ans'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Date de début',\r\n    rangeEndLabel: 'Date de fin',\r\n    selectTime: `Sélectionner l'heure`,\r\n    selectDate: 'Sélectionner la date',\r\n    hour: 'Heure',\r\n    minute: 'Minute',\r\n    second: 'Second'\r\n  },\r\n  tiSelect: {\r\n    search: 'Recherchez',\r\n    selected: 'Sélectionné'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Personnaliser la colonne'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Sélectionner tout)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Sauter',\r\n    previous: 'Précédent',\r\n    next: 'Suivant',\r\n    finish: 'Terminer'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Oui',\r\n    noLabel: 'Non'\r\n  },\r\n  tiTree: {\r\n    reload: 'Recharger',\r\n    loadError: 'Le chargement a échoué. ',\r\n    newNode: 'Nouveau nœud '\r\n  }\r\n};\r\n","/* tslint:disable:file-name-casing */\r\nimport { TiLocaleWords } from '../TiLocaleWords';\r\n/**\r\n * @ignore\r\n * Tiny组件中使用的葡语国际化词条\r\n */\r\nexport const pt_BR: TiLocaleWords = {\r\n  tiLocaleKey: 'pt-BR',\r\n  tiLocaleDate: {\r\n    date: 'dd/MM/yyyy',\r\n    time: 'HH:mm:ss'\r\n  },\r\n  tiCommon: {\r\n    okBtn: 'OK',\r\n    cancelBtn: 'Cancelar'\r\n  },\r\n  tiActionmenu: {\r\n    more: 'Mais',\r\n    operation: 'Operação'\r\n  },\r\n  tiValid: {\r\n    errorMsg: {\r\n      required: 'Este campo não pode ser deixado em branco.',\r\n      maxLength: 'Insira um máximo de {0} caracteres.',\r\n      minLength: 'Insira pelo menos {0} caracteres.',\r\n      rangeSize: 'Insira de {0} a {1} caracteres.',\r\n      maxValue: 'Insira um valor inferior ou igual a {0}.',\r\n      minValue: 'Insira um valor superior ou igual a {0}.',\r\n      rangeValue: 'Insira um valor de {0} a {1}.',\r\n      regExp: 'Valor inválido.',\r\n      contains: 'O valor deve conter os caracteres a seguir: {0}.',\r\n      notContains: 'O valor não pode conter os caracteres a seguir: {0}.',\r\n      notScript: 'O valor não pode conter tags de scripts.',\r\n      equal: 'O valor deve ser {0}.',\r\n      notEqual: 'O valor não pode ser {0}.',\r\n      port: 'Insira um número inteiro de {0} a {1}.',\r\n      path: 'Insira um caminho de arquivo válido.',\r\n      email: 'Insira um endereço de e-mail válido.',\r\n      date: 'Insira uma data válida.',\r\n      url: 'Insira uma URL válida.',\r\n      integer: 'Insira um número inteiro válido.',\r\n      number: 'Insira um número válido.',\r\n      digits: 'Insira um número válido.',\r\n      ipv4: 'Insira um endereço IPv4 válido.',\r\n      ipv6: 'Insira um endereço IPv6 válido.',\r\n      password: 'Senha inválida.'\r\n    },\r\n    message: {\r\n      rangeSize: 'Deve ter de {0} a {1} caracteres.',\r\n      minCharType: 'Deve conter pelo menos {0} dos seguintes tipos de caracteres: ' +\r\n      'letras, dígitos e caracteres especiais ( `~!@#$%^&*()-_=+\\\\|[{}];:\\'\\\",<.>/? e espaços). ',\r\n      notEqualPosRev: 'Não pode ser o nome de usuário escrito normalmente ou de trás para frente.'\r\n    },\r\n    passwordStrength: {\r\n      securityText: 'Força da senha:',\r\n      levelDecArr: ['Fraca', 'Média', 'Forte']\r\n    }\r\n  },\r\n  tiPagination: {\r\n    gotoLabel: 'Ir',\r\n    prevTitle: 'Anterior',\r\n    nextTitle: 'Próximo',\r\n    totalLabel: 'Total de registros: '\r\n  },\r\n  tiMessage: {\r\n    prompt: 'Informação',\r\n    warn: 'Aviso',\r\n    confirm: 'Confirmar',\r\n    error: 'Erro',\r\n    ok: 'OK',\r\n    cancel: 'Cancelar'\r\n  },\r\n  tiUpload: {\r\n    addFile: 'Selecionar arquivo',\r\n    error: 'Não foi possível carregar o arquivo.',\r\n    successInfo: 'Arquivo carregado com sucesso.',\r\n    uploadingSingleInfo: 'Carregando',\r\n    errorSingleInfo: 'Não foi possível carregar o arquivo.',\r\n    addSuccessMutiInfo: 'Você adicionou {0} arquivos.',\r\n    uploadingMutiInfo: 'Carregando: {0}',\r\n    errorMultiInfo: 'Não foi possível carregar {0} arquivos.',\r\n    clearAll: 'Limpar tudo',\r\n    upload: 'Carregar',\r\n    cancel: 'Cancelar',\r\n    reload: 'Carregar novamente',\r\n    autoUploadFilePlaceholder: 'Selecione um arquivo para ser carregado.',\r\n    autoUploadFilesPlaceholder: 'Selecione arquivos para serem carregados.',\r\n    notAutoUploadFilePlaceholder: 'Adicione um arquivo e carregue-o.',\r\n    notAutoUploadFilesPlaceholder: 'Adicione arquivos e carregue-os.'\r\n  },\r\n  tiDate: {\r\n    datePlaceholder: 'Selecione uma data.',\r\n    datetimePlaceholder: 'Selecione uma data e um horário.',\r\n    weekNamesAbb: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],\r\n    weeknamesTitle: ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'],\r\n    monthNamesAbb: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],\r\n    btnSliderArr: ['1', '2', '3', '4', '5', '6', '7', '8', '9 meses', '1 ano', '2 anos', '3 anos'],\r\n    yearSuffixLabel: '',\r\n    rangeBeginLabel: 'Data de início',\r\n    rangeEndLabel: 'Data de término',\r\n    selectTime: 'Selecionar horário',\r\n    selectDate: 'Selecionar data',\r\n    hour: 'Hora',\r\n    minute: 'Minuto',\r\n    second: 'Segundo'\r\n  },\r\n  tiSelect: {\r\n    search: 'Pesquisar',\r\n    selected: 'Selecionados:'\r\n  },\r\n  tiTable: {\r\n    colsToggleTip: 'Personalizar coluna'\r\n  },\r\n  tiList: {\r\n    selectAll: '(Selecionar tudo)'\r\n  },\r\n  tiIntro: {\r\n    skip: 'Pular',\r\n    previous: 'Anterior',\r\n    next: 'Próximo',\r\n    finish: 'Finalizar'\r\n  },\r\n  tiPopconfirm: {\r\n    yesLabel: 'Sim',\r\n    noLabel: 'Não'\r\n  },\r\n  tiTree: {\r\n    reload: 'Recarregar',\r\n    loadError: 'Erro no carregamento. ',\r\n    newNode: 'Novo nó '\r\n  }\r\n};\r\n","import { zh_CN } from './i18n/zh_CN';\r\nimport { en_US } from './i18n/en_US';\r\nimport { de_DE } from './i18n/de_DE';\r\nimport { es_ES } from './i18n/es_ES';\r\nimport { es_US } from './i18n/es_US';\r\nimport { fr_FR } from './i18n/fr_FR';\r\nimport { pt_BR } from './i18n/pt_BR';\r\nimport { Util } from '../utils/Util';\r\n\r\ndeclare let global: any;\r\n\r\n/**\r\n * Tiny组件中使用的国际化词条配置方法类\r\n *\r\n * 可通过在启动模块中通过配置具体的国际化语种的方式设置组件的国际化，使用方式如下：\r\n *\r\n *\r\n *      import {TiLocale} from '@cloud/tiny3';\r\n *\r\n *      export class AppModule {\r\n *\r\n *          constructor() {\r\n *              TiLocale.setLocale(TiLocale.EN_US);\r\n *          }\r\n *      }\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/locale/locale-basic\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nexport class TiLocale {\r\n    /**\r\n     * 英文语种关键字，关键字均使用中划线形式命名，确保和浏览器保持一致\r\n     */\r\n    public static readonly EN_US: string = 'en-US';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly ZH_CN: string = 'zh-CN';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly DE_DE: string = 'de-DE';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly ES_ES: string = 'es-ES';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly ES_US: string = 'es-US';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly FR_FR: string = 'fr-FR';\r\n    /**\r\n     * 语种关键字\r\n     */\r\n    public static readonly PT_BR: string = 'pt-BR';\r\n\r\n    // private static localeKey: string = TiLocale.ZH_CN; // 语种关键字\r\n\r\n    /**\r\n     * Typescript没有静态代码段，所以这样代替静态代码段\r\n     */\r\n    protected static staticCode: void = TiLocale.initWordsAndLocale();\r\n    /**\r\n     * 静态代码段执行：如过word和locale未初始化，那么执行初始化。\r\n     */\r\n    private static initWordsAndLocale(): void {\r\n        if (!TiLocale.getWords()) {\r\n            // 默认所有语言都打包进来\r\n            TiLocale.setWords({\r\n                'zh-CN': zh_CN,\r\n                'en-US': en_US,\r\n                'de-DE': de_DE,\r\n                'es-ES': es_ES,\r\n                'es-US': es_US,\r\n                'fr-FR': fr_FR,\r\n                'pt-BR': pt_BR\r\n            });\r\n        }\r\n        if (!TiLocale.getLocale()) {\r\n            TiLocale.setLocale(TiLocale.ZH_CN);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets words\r\n     * @param Words 全量的语言包，由语言名称：语言词条包组成。\r\n     *\r\n     * @returns words\r\n     */\r\n    public static setWords(words: any): void {\r\n        // 设计缺陷：如果tiWords放在类成员变量上，会更好。window在SSR环境找不到。\r\n        if (typeof window !== 'undefined') {\r\n            (window as any).tiWords = words;\r\n        } else if(typeof global !== 'undefined'){\r\n            (global as any).tiWords = words;\r\n        }   \r\n    }\r\n    public static getWords(): any {\r\n        if (typeof window !== 'undefined') {\r\n            return (window as any).tiWords;\r\n        } else if(typeof global !== 'undefined'){\r\n            return (global as any).tiWords;\r\n        }     \r\n    }\r\n    /**\r\n     * 设置组件国际化语种\r\n     * @param locale 国际化字符，可通过TiLocale.ZH_CN/TiLocale.EN_US等语种关键字设置参数\r\n     */\r\n    public static setLocale(locale: string): void {\r\n        if (typeof window !== 'undefined') {\r\n            (window as any).tiLocale = locale;\r\n        } else if(typeof global !== 'undefined'){\r\n            (global as any).tiLocale = locale;\r\n        }    \r\n    }\r\n    private static getLocale(): string {\r\n        if (typeof window !== 'undefined') {\r\n            return (window as any).tiLocale;\r\n        } else if(typeof global !== 'undefined'){\r\n            return (global as any).tiLocale;\r\n        }   \r\n    }\r\n\r\n    /**\r\n     * 设置组件国际化语种\r\n     * @param localeKey 国际化字符，可通过TiLocale.ZH_CN/TiLocale.EN_US等语种关键字设置参数\r\n     */\r\n\r\n    /**\r\n     * @ignore\r\n     * 获取当前语言下，组件国际化语种对应的词条集合\r\n     */\r\n    public static getLocaleWords(): any {\r\n        return TiLocale.getWords()[TiLocale.getLocale()];\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 获取单个词条的国际化文本/对象\r\n     * 参数：\r\n     */\r\n    public static translate(keyValue: string, params?: Array<any>): any {\r\n        const keyArr: Array<string> = keyValue.split('.');\r\n        let value: any = TiLocale.getLocaleWords();\r\n        keyArr.forEach((key: string) => {\r\n            value = value[key];\r\n        });\r\n\r\n        return Util.formatEntry(value, params);\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { TiLocale } from './TiLocale';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Pipe({\r\n  name: 'tiTranslate'\r\n})\r\nexport class TiTranslatePipe implements PipeTransform {\r\n  transform(keyValue: string, params?: Array<any>): string {\r\n    return TiLocale.translate(keyValue, params);\r\n  }\r\n}\r\n","/**\r\n * @ignore\r\n *\r\n * 只供内部使用，外部使用tinyplus3提供的国际化方法\r\n *\r\n * 该类提供一个方法集，用于数字、时间日期的国际化处理\r\n * 其中 tiny提供的数字、时间日期和货币的国际化处理方法，用于屏蔽angular方法需要传入format/localeId的复杂处理\r\n *\r\n * <h3>示例</h3>\r\n * <iframe src=\"../tiny3demo/#/locale/locale-format\" frameborder='0' width=\"100%\" onload=\"this.height = document.documentElement.clientHeight\"></iframe>\r\n */\r\nimport { formatDate, formatNumber, getLocaleCurrencySymbol,\r\n    getLocaleId, getLocaleNumberSymbol, NumberSymbol } from '@angular/common';\r\nimport { TiLocale } from './TiLocale';\r\nexport class TiLocaleFormat {\r\n    private static readonly TIME_FORMAT: string = 'mediumTime'; // 'h:mm:ss a' (e.g. 9:03:01 AM)\r\n    private static readonly DATE_FORMAT: string = 'mediumDate'; // 'MMM d, y' (e.g. Jun 15, 2015).\r\n    private static readonly DATETIME_FORMAT: string = 'medium'; // 'MMM d, y, h:mm:ss a' (e.g. Jun 15, 2015, 9:03:01 AM)\r\n    private static readonly DEFAULT_LOCALE: string = 'en';\r\n    /**\r\n     * 获取语种关键字，默认为'en'\r\n     * @return 语种关键字\r\n     */\r\n    private static getLocaleKey(): string {\r\n        let locale: string = TiLocale.getLocaleWords().tiLocaleKey;\r\n        try {// local信息未注册情况下，getLocaleId该方法会报错，因此使用try catch的方式\r\n            getLocaleId(TiLocale.getLocaleWords().tiLocaleKey);\r\n        } catch (error) {\r\n            locale = TiLocaleFormat.DEFAULT_LOCALE;\r\n        }\r\n\r\n        return locale;\r\n    }\r\n    /**\r\n     * @description 对国际化数字进行处理(包含小数点)\r\n     * @param: number 国际化数字\r\n     * @param: isIntegerValid 只针对integer的情况\r\n     * @return 返回数字信息\r\n     */\r\n    private static parseNumWithDecimal(number: string, isIntegerValid?: boolean): any {\r\n        const groupSep: string = TiLocaleFormat.getNumberSymbol('Group');\r\n        const decimalSep: string = TiLocaleFormat.getNumberSymbol('Decimal');\r\n        /* tslint:disable:prefer-template */\r\n        const numberReg: RegExp =\r\n            new RegExp('^(?:-?\\\\d*|-?\\\\d(?:\\\\' + groupSep + '?\\\\d*)+)?(?:\\\\' + decimalSep + '\\\\d*)?$');\r\n        // const numberFormat = number.toString();\r\n        const numberFormat: string = number;\r\n\r\n        if (!numberReg.test(numberFormat)) {\r\n            return NaN;\r\n        }\r\n        const groupReg: RegExp = new RegExp('\\\\' + groupSep, 'g');\r\n        const decimalReg: RegExp = new RegExp('\\\\' + decimalSep, 'g');\r\n        const numberFormatString: string = numberFormat.replace(groupReg, '')\r\n            .replace(decimalReg, '.');\r\n        const numberFloat: number = parseFloat(numberFormatString);\r\n        /*\r\n        * *只针对integer的情况\r\n        * 截取转换前的小数位字符串numFormatSlice\r\n        * 转换前的小数位字符串长度numFormatCount\r\n        * 转换后的小数位为0,就添加小数位个数的0，返回值是string类型\r\n        * */\r\n\r\n        if (isIntegerValid && (numberFormatString.indexOf('.') !== -1)) {\r\n            return numberFormatString;\r\n        }\r\n\r\n        return numberFloat;\r\n    }\r\n    /**\r\n     * 获取数字规则信息\r\n     * key 规则关键字\r\n     */\r\n    public static getNumberSymbol(key: string): string {\r\n        const standardNumber: number = 10000.0;\r\n        const localeNumber: string = TiLocaleFormat.formatNumber(standardNumber, '1.1-1');\r\n\r\n        return key === 'Group' ? localeNumber.charAt(2) : localeNumber.charAt(6);\r\n    }\r\n    /**\r\n     * @description 对数字进行国际化处理\r\n     * @param: number 数字\r\n     * @param: numberFormat 数字格式化形式\r\n     * @return 返回格式化后的信息\r\n     */\r\n    public static formatNumber(number: number, format: string): string {\r\n        let options: any;\r\n        if (format) {\r\n            options = {\r\n                minimumIntegerDigits: format.substring(0, format.indexOf('.')),\r\n                minimumFractionDigits: format.substring(format.indexOf('.') + 1, format.indexOf('-')),\r\n                maximumFractionDigits: format.substring(format.indexOf('-') + 1)\r\n            };\r\n        }\r\n\r\n        // TODO: new Intl.NumberFormat es西语下整数部分有四位时，本地化数字没有千位分隔\r\n        const res: string = new Intl.NumberFormat(TiLocale.getLocaleWords().tiLocaleKey, options)\r\n            .format(number);\r\n\r\n        return res;\r\n    }\r\n\r\n    /**\r\n     * @description 对国际化数字进行标准化处理\r\n     * @param: number 国际化数字\r\n     * @return 返回数字信息\r\n     */\r\n    public static parseNumber(number: string): number {\r\n        return parseFloat(TiLocaleFormat.parseNumWithDecimal(number));\r\n    }\r\n\r\n    /**\r\n     * @description 对时间进行国际化处理\r\n     * @param: time 时间\r\n     * @param: format 时间格式\r\n     * @return 返回格式化后的信息\r\n     */\r\n    public static formatTime(time: string | number | Date, format?: string, timezone?: string): string {\r\n        return formatDate(time, format || TiLocaleFormat.TIME_FORMAT, TiLocaleFormat.getLocaleKey(), timezone);\r\n    }\r\n\r\n    /**\r\n     * @description 对日期进行国际化处理\r\n     * @param date 日期\r\n     * @param format 日期格式\r\n     * @return 返回格式化后的信息\r\n     */\r\n    public static formatDate(date: Date, format?: string, timezone?: string): string {\r\n        return formatDate(date, format || TiLocaleFormat.DATE_FORMAT, TiLocaleFormat.getLocaleKey(), timezone);\r\n    }\r\n\r\n    /**\r\n     * @description 对时间日期进行国际化处理\r\n     * @param: 时间日期\r\n     * @param: 时间日期格式\r\n     * @return 返回格式化后的信息\r\n     */\r\n    public static formatDateTime(dateTime: Date, format?: string, timezone?: string): string {\r\n        return formatDate(dateTime, format || TiLocaleFormat.DATETIME_FORMAT, TiLocaleFormat.getLocaleKey(), timezone);\r\n    }\r\n\r\n    /**\r\n     * 功能描述：去除千位分隔符，得到标准化数字\r\n     * value: 带有千位分隔符的数据\r\n     */\r\n    public static deleteGroupSep(value: any): string {\r\n        let res: any;\r\n        res = String(value);\r\n        const groupSep: string = TiLocaleFormat.getNumberSymbol('Group');\r\n        const groupSepReg: any = new RegExp('\\\\' + groupSep, 'g');\r\n\r\n        return res.replace(groupSepReg, '');\r\n    }\r\n    /**\r\n     * 检测format接口配置是否合法。目前spinner和inputnumber组件会用到\r\n     */\r\n    public static isInvalidFormat(format: string): boolean {\r\n        if (typeof (format) !== 'string'\r\n            || format.charAt(0)\r\n            .toUpperCase() !== 'N'\r\n            || Number.isNaN(parseInt(format.slice(1), 10))) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiTranslatePipe } from './TiTranslatePipe';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  declarations: [ TiTranslatePipe ],\r\n  exports: [ TiTranslatePipe ]\r\n})\r\nexport class TiLocaleModule {}\r\nexport { TiLocale } from './TiLocale';\r\nexport { TiLocaleFormat } from './TiLocaleFormat';\r\nexport { TiLocaleWords } from './TiLocaleWords';\r\nexport { zh_CN, en_US, de_DE, es_ES, es_US, fr_FR, pt_BR } from './i18n';\r\nexport { TiTranslatePipe } from './TiTranslatePipe';\r\n","import { Component, ContentChild, ElementRef, EventEmitter, HostListener,\r\n    Input, NgZone, Output, Renderer2, SimpleChange, SimpleChanges, TemplateRef, ViewChild} from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiBrowser, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\nimport { TiLocale, TiLocaleFormat, TiLocaleWords } from '../../locale/TiLocaleModule'; // 获取词条\r\n\r\n/**\r\n * @ignore\r\n *  列表组件，使用者有menu、droplist\r\n */\r\n@Component({\r\n      selector: 'ti-list',\r\n      templateUrl: './list.html',\r\n      styleUrls: ['./list.less', './list-multi.less'],\r\n      providers: [TiFormComponent.getValueAccessor(TiListComponent)]\r\n})\r\nexport class TiListComponent extends TiFormComponent {\r\n\r\n    protected static readonly SCROLL_TOP_TIME: number = 200; // 设置选中项滚动到TOP所需时间。Chorme下简单测试。TODO：其他浏览器、复杂数据\r\n    // 列表数据配置\r\n    @Input() multiple: boolean = false; // 是否多选\r\n    @Input() options: Array<any>; // 下拉选项的全部数据\r\n    @Input() labelKey: string = 'label'; // 要显示的字段\r\n    @Input() tipPosition: TiPositionType = 'right';\r\n    @Input() noDataText: string = '...';       // 无数据时的显示文本\r\n    @Input() hideEmptyOption: boolean = false;       // 过滤空字符串选项\r\n    @Input() selectAll: boolean = false; // 多选模式下是否有全选功能\r\n    /**\r\n     * 10.0.4 版本新增，\r\n     * 用于配置是否显示children字段数据，大部分场景需要显示children，cascader不需要\r\n     */\r\n    @Input() showChildren: boolean = true;\r\n    /**\r\n     * @ignore\r\n     * 10.1.0新增\r\n     * 适配内部time类组件，点选滚动效果,暂不开放。\r\n     */\r\n    @Input() scrollTop: number = 0;\r\n\r\n    /**\r\n     * 选中事件，向外通知option数据\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly select: EventEmitter<any> = new EventEmitter<any>();\r\n    @Output() readonly hover: EventEmitter<any> = new EventEmitter<any>();\r\n    // item模板\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n    @ViewChild('ulRef') ulRef: ElementRef;\r\n\r\n    /**\r\n     *  需要阻止失焦标记: 点击面板时，会触发失焦，需要阻止失焦。\r\n     *  IE兼容性问题: 点击滚动条，触发失焦，面板会收起\r\n     *  修复方案：点击list面板区域（包含滚动条）后，给失焦元素强制获取焦点。修改Form基类不触发组件整体失焦。\r\n     */\r\n    private stopBlur: boolean = false;\r\n    private unlistenIEScrollbarBugFns: Array<() => void> = [];\r\n    public selectAllState: boolean;\r\n    public selectAllText: string = TiLocale.getLocaleWords().tiList.selectAll;\r\n    public optionSelectAll: string = 'all';\r\n\r\n    private _hoverOption: any;\r\n    public get hoverOption(): any {\r\n        return this._hoverOption;\r\n    }\r\n    public set hoverOption(hoverOption: any) {\r\n        if (this._hoverOption !== hoverOption) {\r\n            this._hoverOption = hoverOption;\r\n            this.hover.emit(hoverOption);\r\n        }\r\n    }\r\n    protected optionScrollTopLastTime: number = 0;\r\n    // 判断是否禁用的函数: 函数类型是(any) => boolean，赋值是(item: any) => {}\r\n    @Input() isDisabledFn: (item: any) => boolean = (item: any) => {\r\n        return item && item.disabled === true;\r\n        // tslint:disable-next-line:semicolon\r\n    };  // 这个分号是书写正确的\r\n    constructor(render: Renderer2, hostRef: ElementRef, private zone: NgZone) {\r\n        super(hostRef, render);\r\n    }\r\n\r\n    // 在Selected使用List时，Selected的聚焦元素是Dominator和Searchbox，它们接收按键，并调用list来处理。\r\n    // 在表格列设置时，List自己聚焦，List处理按键。\r\n    @HostListener('keydown', ['$event']) onKeydown(event: KeyboardEvent): void {\r\n        // 10.0.2删除 KEY_SPACE 空格快捷键的响应\r\n        switch (event.keyCode) {\r\n            case TiKeymap.KEY_ENTER: // ENTER键 相当于click\r\n            case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)\r\n                if (this.hoverOption) {\r\n                    this.selectOption(this.hoverOption);\r\n                }\r\n                break;\r\n            case TiKeymap.KEY_ESCAPE: // Esc键，仅可关闭\r\n            case TiKeymap.KEY_TAB: // Tab键，仅可关闭\r\n                break;\r\n            case TiKeymap.KEY_ARROW_UP: // 向上箭头，上移选项\r\n                event.preventDefault(); // 防止上下按键默认行为：移动滚动条\r\n                this.nextOption(true);\r\n                break;\r\n            case TiKeymap.KEY_ARROW_DOWN: // 向下箭头，下移选项\r\n                event.preventDefault(); // 防止上下按键默认行为：移动滚动条\r\n                this.nextOption(false);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            this.renderer.listen(this.nativeElement, 'mousedown', (event: MouseEvent): void => {\r\n                // Select时，点击滚动条和点击面板，不要触发默认行为：dominator blur\r\n                // 现在，list默认不聚焦。在所有场合，点击面板或者滚动条，都不触发默认焦点事件。\r\n                event.preventDefault(); // 防止dominator blur行为\r\n                // list自身可以落焦点时，需要聚焦的默认行为。\r\n            });\r\n\r\n            // list内部滚动条会引起外部滚动条事件触发，引起弹框内的下拉组件无法使用鼠标拖动滚动条，因此此处阻止事件冒泡\r\n            this.renderer.listen(this.nativeElement, 'mousewheel', (event: MouseEvent): void => {\r\n                event.stopPropagation();\r\n            });\r\n            this.renderer.listen(this.nativeElement, 'DOMMouseScroll', (event: MouseEvent): void => {\r\n                event.stopPropagation();\r\n            });\r\n        });\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        if (this.multiple && this.selectAll) {\r\n            const optionsChange: SimpleChange = changes['options'];\r\n            if (optionsChange) {\r\n                this.setSelectedAllState();\r\n            }\r\n        }\r\n        // time及datetime/datetimeRange组件使用list，点选时候需要滚动效果\r\n        if (changes['scrollTop'] && !changes['scrollTop'].firstChange) {\r\n            this.setScrollFn();\r\n        }\r\n        if (changes['options']) {\r\n            this.setHoverOption();\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if (this.scrollTop > 0) {\r\n            this.setScrollFn();\r\n        }\r\n    }\r\n\r\n    writeValue(model: any): void {\r\n        super.writeValue(model);\r\n        if (this.multiple && this.selectAll) {\r\n            this.setSelectedAllState();\r\n        }\r\n    }\r\n    // time及datetime/datetimeRange组件使用list，点选时候需要滚动效果\r\n    private setScrollFn(): void {\r\n        if (TiBrowser.isIE()) {\r\n            this.renderer.setProperty(this.hostRef.nativeElement, 'scrollTop', this.scrollTop);\r\n            return;\r\n        }\r\n        this.hostRef.nativeElement.scrollTo(0, this.scrollTop);\r\n    }\r\n\r\n\r\n    // 下拉选项的鼠标按下操作\r\n    public onMousedownItem(event: MouseEvent, own: HTMLElement): void {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        own.classList.add('ti3-menu-panel-list-active');\r\n    }\r\n\r\n    // 下拉选项的鼠标按下后的抬起操作\r\n    public onMouseupItem(event: MouseEvent, own: HTMLElement): void {\r\n        this.removeClass(event, own);\r\n    }\r\n\r\n    // 下拉选项的鼠标离开时的操作\r\n    public onMouseleaveItem(event: MouseEvent, own: HTMLElement): void {\r\n        this.removeClass(event, own);\r\n    }\r\n    // 移除li元素上的ti3-menu-panel-list-active类\r\n    public removeClass(event: MouseEvent, own: HTMLElement): void {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        own.classList.remove('ti3-menu-panel-list-active');\r\n    }\r\n\r\n    // 下拉选项的单击操作（包括组名所在的<li>元素）\r\n    public onClickItem(event: MouseEvent, option: any): void {\r\n        // Selected时，点击选项，不要触发默认行为：dominator blur。\r\n        event.preventDefault(); // 防止dominator blur行为\r\n        // Group节点和禁用节点，无需响应。\r\n        if (this.isGroup(option) || this.isDisabledFn(option)) {\r\n            event.stopPropagation();\r\n\r\n            return;\r\n        }\r\n        // 只处理左键和中键\r\n        if (event.button !== TiKeymap.MOUSE_LEFT_BUTTON\r\n            && event.button !== TiKeymap.MOUSE_MIDDLE_BUTTON) { // Tiny2这里逻辑错误TODO：\r\n            return;\r\n        }\r\n\r\n        // 点击选中项\r\n        this.selectOption(option);\r\n        // 更新hover\r\n        this.hoverOption = option;\r\n    }\r\n\r\n    private selectOption(option: any): void {\r\n        // 全选\r\n        if (this.multiple && this.selectAll && option === this.optionSelectAll) {\r\n            this.selectAllOptions();\r\n            this.select.emit(option);\r\n\r\n            return;\r\n        }\r\n\r\n        let index: number = -1;\r\n        if (this.multiple) { // 多选\r\n            if (!this.model) { // 如果为空值\r\n                this.model = [];\r\n            }\r\n            // 是否选中，取反\r\n            index = this.model.indexOf(option);\r\n            if (index === -1) {\r\n                this.model.push(option); // 点击下拉项选中，选中项按用户操作顺序显示\r\n            } else if (index !== -1) {\r\n                this.model.splice(index, 1);\r\n            }\r\n            // 强行向外通知model改变。\r\n            this.model = this.model.concat();\r\n            // 设置全选状态\r\n            if (this.selectAll) {\r\n                this.setSelectedAllState();\r\n            }\r\n        } else { // 单选\r\n            this.model = option;\r\n        }\r\n        this.select.emit(option);\r\n    }\r\n\r\n    private selectAllOptions(): void {\r\n        if (!this.model) { // 如果为空值\r\n            this.model = [];\r\n        }\r\n        const listOptions: Array<any> = this.getListOptions();\r\n        let isChange: boolean = false;\r\n        if (this.selectAllState === false || this.selectAllState === null) {\r\n            listOptions.forEach((item: any) => {\r\n                if (this.model.indexOf(item) === -1 && this.isSelectable(item)) { // 不在当前选中项且为可选数据项（排除禁用项和组名项）\r\n                    // 点击全选按钮时的选中值顺序与option的顺序一致\r\n                    const insertIndex: number = this.getInsertIndex(item);\r\n                    this.model.splice(insertIndex, 0, item);\r\n                    isChange = true;\r\n                }\r\n            });\r\n\r\n            this.selectAllState = true;\r\n        } else {\r\n            listOptions.forEach((item: any) => {\r\n                const index: number = this.model.indexOf(item);\r\n                if (index !== -1 && !this.isDisabledFn(item)) {\r\n                    this.model.splice(index, 1);\r\n                    isChange = true;\r\n                }\r\n            });\r\n            this.selectAllState = false;\r\n        }\r\n        if (isChange) {\r\n            // model的值在以上循环中，多次变化，或者不变，根据isChange，一次性触发变化检测\r\n            this.model = this.model.concat();\r\n        }\r\n    }\r\n\r\n    public setSelectedAllState(): void {\r\n        if (!this.model || this.model.length === 0 || !this.options || this.options.length === 0) {\r\n            this.selectAllState = false;\r\n\r\n            return;\r\n        }\r\n        const listOptions: Array<any> = this.getListOptions();\r\n        const selectedOptions: Array<any> = listOptions.filter((item: any) => {\r\n            return this.isSelectable(item) && this.model.includes(item);\r\n        });\r\n        if (selectedOptions.length === 0) {\r\n            this.selectAllState = false;\r\n\r\n            return;\r\n        }\r\n        const selectableOptions: Array<any> = listOptions.filter((item: any) => {\r\n            return this.isSelectable(item);\r\n        });\r\n        this.selectAllState = selectedOptions.length === selectableOptions.length ? true : null;\r\n    }\r\n\r\n    // 获取新插入元素的插入次序，该次序与list集合中的元素顺序保持一致\r\n    private getInsertIndex(option: any): number {\r\n        const listOptions: Array<any> = this.getListOptions();\r\n        const indexOfList: number = listOptions.indexOf(option); // 当前元素在list中的排序\r\n        // 将该元素与已选中在list中的次序进行比较，如果该元素在某选中项次序之后，则将其插入该元素之后\r\n        for (let i: number = this.model.length; i > 0; i--) {\r\n            const itemIndexOfList: number = listOptions.indexOf(this.model[i - 1]);\r\n            if (itemIndexOfList < indexOfList) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    }\r\n    public onMouseenterItem(event: MouseEvent, option: any): void {\r\n        // 是可选项，且不是在选中项置Top时鼠标经过。\r\n        // tslint:disable-next-line:prefer-conditional-expression\r\n        if (this.isSelectable(option) && new Date().getTime() - this.optionScrollTopLastTime > TiListComponent.SCROLL_TOP_TIME) {\r\n            this.hoverOption = option;  // 更新hover\r\n        }\r\n    }\r\n    // 寻找下一个可选项。参数：向上/向下\r\n    public nextOption(isUp: boolean): void {\r\n        const listOptions: Array<any> = this.getListOptions();\r\n        if (this.multiple && this.selectAll) {\r\n            listOptions.unshift(this.optionSelectAll);\r\n        }\r\n        if (listOptions.filter((x: any) => this.isSelectable(x)).length === 0) { // 没有可选中的项目\r\n            return;\r\n        }\r\n        let nextOption: any = this.hoverOption;\r\n        let curIndex: number = listOptions.indexOf(nextOption);\r\n        do {\r\n            if (isUp) {\r\n                // tslint:disable-next-line:prefer-conditional-expression\r\n                if (curIndex > 0) { // 找到了，且不是第一个元素\r\n                    curIndex = curIndex - 1;\r\n                } else { // -1没有找到, 0第一个元素\r\n                    curIndex = listOptions.length - 1; // 跳到第一个元素。\r\n                }\r\n            } else {\r\n                // tslint:disable-next-line:prefer-conditional-expression\r\n                if (curIndex < listOptions.length - 1) { // -1没有找到, 和不是最后一个\r\n                    curIndex = curIndex + 1;\r\n                } else { // length - 1 最后一个元素\r\n                    curIndex = 0; // 跳到第一个元素。\r\n                }\r\n            }\r\n            nextOption = listOptions[curIndex];\r\n        } while (!(this.isSelectable(nextOption) || nextOption === this.hoverOption)); // 找到停止，或者寻找一圈停止\r\n        // 没有找到结果\r\n        if (nextOption === null ||  nextOption === this.hoverOption) {\r\n            return;\r\n        }\r\n        // 改变hover选项。\r\n        this.hoverOption = nextOption;\r\n        // 更新滚动条\r\n        this.optionScollTop(this.hoverOption);\r\n    }\r\n    protected getListOptions(): Array<any> {\r\n        let listOptions: Array<any> = []; // 装有所有选项的数组\r\n        if (this.options) {\r\n            this.options.forEach(\r\n                (x: any) => {\r\n                    listOptions.push(x);\r\n                    if (this.isGroup(x)) {\r\n                        listOptions = listOptions.concat(x.children);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n\r\n        return listOptions;\r\n    }\r\n    // 滚动到选中项元素，多选定位到第一个选中项元素，无选中项时定义到第一项元素；\r\n    // 适用于每次下拉打开的场景\r\n    public scrollToSelected(): void {\r\n        // 获取当前选中项\r\n        let selectedItem: any;\r\n        // tslint:disable-next-line:prefer-conditional-expression\r\n        if (this.multiple) {\r\n            selectedItem = (this.model && this.model.length > 0) ? this.model[0] : null;\r\n        } else {\r\n            selectedItem = this.model;\r\n        }\r\n        if (selectedItem) { // 有选中项时，自动定位到第一个选中元素\r\n            this.scrollToEle(selectedItem, true);\r\n        } else { // 无选中项时，定位在第一项元素\r\n            this.nativeElement.scrollTop = 0;\r\n        }\r\n        this.setHoverOption();\r\n    }\r\n    /**\r\n     * 设置hoverOption\r\n     * 用于数据更新时，非鼠标或快捷键操作时\r\n     */\r\n    private setHoverOption(): void {\r\n        this.hoverOption = this.options?.length > 0\r\n            ? (this.hasSelectedinList()\r\n                ? this.getHoverOptionInModel()\r\n                : (this.multiple && this.selectAll\r\n                    ? this.optionSelectAll\r\n                    : (this.options[0]?.children\r\n                        ? this.getGroupHoverOption()\r\n                        : this.options.find((option: any) => !this.isDisabledFn(option)))))\r\n            : undefined;\r\n    }\r\n\r\n    /**\r\n     * 单选有model的时候，单选的model不会是禁用项，hoverOption应当是model，\r\n     * 多选有model的时候，hoverOption是第一个非禁用的model，如果model全部禁用，hoverOption是第一个禁用项往下的第一个可用项。\r\n     */\r\n    private getHoverOptionInModel(): any {\r\n        return this.multiple\r\n            ? (this.model.find((item: any) => !this.isDisabledFn(item))\r\n                || this.options.find((item: any, index: number) => {\r\n                    return index > this.options.indexOf(this.model[0]) && !this.isDisabledFn(item);\r\n                }))\r\n            : this.model;\r\n    }\r\n    /**\r\n     * 判断当前list中是否有选中项，过滤后的数据有可能不含有选中项\r\n     */\r\n    private hasSelectedinList(): boolean {\r\n        const listOption: Array<any> = this.getListOptions();\r\n        if (this.multiple && this.model?.length > 0) {\r\n            return !!this.model.find((item: any) => listOption.includes(item));\r\n        } else if (this.model) {\r\n            return listOption.includes(this.model);\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // 分组情况下，找到hoverOption\r\n    private getGroupHoverOption(): any {\r\n        let groupHoverOption: any;\r\n        this.options.find((option: any): boolean => {\r\n            if (option.children.length > 0) {\r\n                groupHoverOption = option.children.find((child: any) => !this.isDisabledFn(child));\r\n\r\n            }\r\n\r\n            return groupHoverOption ? true : false; // 这个return只是为了结束find方法\r\n        });\r\n\r\n        return groupHoverOption; // 这个return是为了返回查找结果\r\n    }\r\n    private scrollToEle(option: any, isScrollBySelected: boolean = false): void {\r\n        if (!option || !this.ulRef) { // 第一次model值改变时, ulRef不存在。\r\n            return;\r\n        }\r\n        const listOptions: Array<any> = this.getListOptions();\r\n        if (this.multiple && this.selectAll) {\r\n            listOptions.unshift(this.optionSelectAll);\r\n        }\r\n        const curIndex: number = listOptions.indexOf(option);\r\n        if (curIndex < 2 && isScrollBySelected) {\r\n            return; // 前两项不需要滚动\r\n        }\r\n        // 下拉框有滚动条时，若上下选项足够，选中项为下拉框的第二项，这样可以展示选中项的前后选项\r\n        const scrollTopOptionIndex: number = Math.max(curIndex - 1, 0);\r\n        const ele: HTMLElement =  this.ulRef.nativeElement.getElementsByTagName('LI')[scrollTopOptionIndex];\r\n        if (ele) {\r\n            this.nativeElement.scrollTop = ele.offsetTop;\r\n        }\r\n    }\r\n    private optionScollTop(option: any): void {\r\n        this.optionScrollTopLastTime = new Date().getTime();\r\n        this.scrollToEle(option);\r\n    }\r\n\r\n    // 是组数据项\r\n    public isGroup(item: any): boolean {\r\n        return item && item.hasOwnProperty('children') && this.showChildren;\r\n    }\r\n    // 是可选数据项\r\n    protected isSelectable(item: any): boolean {\r\n        return !this.isGroup(item) && !this.isDisabledFn(item);\r\n    }\r\n    // 是已选中数据项\r\n    public isSelected(item: any): boolean {\r\n        return (!this.multiple && item === this.model) ||\r\n            (this.multiple && this.model && this.model.includes(item));\r\n    }\r\n    /**\r\n     * 修复点击IE滚动条，面板关闭。\r\n     * 打开面板时监听，关闭和销毁面板时取消监听。\r\n     */\r\n    public listenIESrollbarBug(): void {\r\n        // IE兼容性涉及知识，见本文件底部。\r\n        // IE兼容性问题: 点击滚动条，触发失焦，面板会收起\r\n        // 修复方案：点击list面板区域（包含滚动条）后，给失焦元素强制获取焦点。修改Form基类不触发组件整体失焦。\r\n        if (TiBrowser.isIE()) {\r\n            // 点击面板，阻止Blur\r\n            this.unlistenIEScrollbarBugFns.push(\r\n                this.renderer.listen(this.nativeElement, 'mousedown',\r\n                    (event: FocusEvent) => {\r\n                        this.stopBlur = true; // 标记，以供focusin消耗\r\n                        // 阻止冒泡到document，因为document会把标志位改回false。和下面修复双击滚动条Bug配合\r\n                        event.stopPropagation();\r\n                    }\r\n                )\r\n            );\r\n            // 修复bug：双击滚动条，再点击面板之外，不失焦。\r\n            this.unlistenIEScrollbarBugFns.push(\r\n                this.renderer.listen(document, 'mousedown',\r\n                    (event: FocusEvent) => {\r\n                        // 点击面板之外区域，不阻止blur\r\n                        this.stopBlur = false;\r\n                    }\r\n                )\r\n            );\r\n\r\n            // IE事件顺序：focusout->foucsin->blur->focus, 支持冒泡的focusin/focusout, 不支持冒泡的是focus/blur\r\n            this.unlistenIEScrollbarBugFns.push(\r\n                this.renderer.listen(document.body, 'focusin',\r\n                    (event: FocusEvent) => {\r\n                        if (this.stopBlur && event.relatedTarget !== document.body) {\r\n                            // 本来不需要!==document, 但连续多次点击太快，会发生：刚点击一下，上次的dominator->body focusin, 会进来\r\n\r\n                            // 清零，因为下面的聚焦事件，又会触发focusin事件，并不想处理\r\n                            this.stopBlur = false; // 一般情况这里置为false是可以的。\r\n\r\n                            // focusin事件，target是聚焦元素。relatedTarget是失焦元素。\r\n                            // 强制让失焦元素，重新获得焦点。\r\n                            (event.relatedTarget as HTMLElement).focus();\r\n                        }\r\n                    }\r\n                )\r\n            );\r\n        }\r\n    }\r\n    public unlistenIESrollbarBug(): void {\r\n        if (TiBrowser.isIE()) {\r\n            // 解绑监听\r\n            for (const x of this.unlistenIEScrollbarBugFns) {\r\n                x();\r\n            }\r\n        }\r\n    }\r\n}\r\n/*\r\nIE兼容性问题：点击面板滚动条，触发失焦，无法阻止。\r\n解决方案：给失焦元素强制获取焦点。修改Form基类不触发组件整体失焦。\r\n\r\n涉及知识点：\r\n点击div面板的滚动条，浏览器会失焦，焦点到body。event.preventDefault();，可以阻止默认失焦行为。\r\n点击div面板的滚动条，浏览器会失焦，焦点到body。无法阻止。（问题产生）\r\n\r\nChrome浏览器事件顺序：\r\nblur->focusout->focus->foucsin\r\nIE浏览器事件顺序：\r\nfocusout->focusin->blur->focus\r\n\r\nIE浏览器，在blur事件里，失焦元素.focus(),\t会先显示失焦css，后显示聚焦css，会闪一下。\r\nIE浏览器，在focusout事件里，失焦元素.focus(), 无效。\r\nIE浏览器，在focusin事件里，失焦元素.focus(), 会一直显示聚焦css，不会闪。（作为解决问题的方案）\r\n\r\nChrome blur事件时，document.activeElement是body\r\nIE blur事件时，document.activeElement是将要聚焦的元素。\r\nIE 如果在focusin里，失焦元素.focus()，那么blur时document.activeElement刚好是这个失焦并强制聚焦的元素。\r\n\r\n第一版方案：\r\n强制聚焦，用了延时处理\r\n整体onBlur时，IE特殊处理，不闭合面板\r\n闭合面板时，处理标志位。\r\n解决双击滚动条bug，利用监听面板之外点击。\r\n\r\n第二版方案：\r\n强制聚焦，不用延时。\r\n修复Form基类，不再触发整体失焦/聚焦。\r\n闭合面板时，处理标志位 （TODO: 设法去除。尽量集中对标志位的管理）\r\n解决双击滚动条bug，利用监听面板之外点击。（TODO: 设法去除。尽量集中对标志位的管理）\r\n\r\n第三版方案：\r\n面板打开时监听mouse，面板闭合时不再监听\r\n\r\n */\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiListComponent } from './TiListComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiTipModule\r\n  ],\r\n  exports: [TiListComponent],\r\n  declarations: [TiListComponent]\r\n})\r\nexport class TiListModule {\r\n}\r\nexport { TiListComponent } from './TiListComponent';\r\n","import { Component, Input } from '@angular/core';\r\nimport { TiListComponent } from '../list/TiListModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiMenuItem } from './TiMenuComponent';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n      selector: 'ti-menulist',\r\n      templateUrl: './menulist.html',\r\n      styleUrls: ['./menulist.less'/* , './menu.less' */],\r\n      providers: [TiFormComponent.getValueAccessor(TiMenuListComponent)]\r\n})\r\nexport class TiMenuListComponent extends TiListComponent {\r\n    @Input() panelAlign: 'left' | 'right' = 'right'; // 设置下拉菜单面板与按钮对齐方式。这里是为了决定了面板上箭头方向。\r\n    protected isSelectable(item: TiMenuItem): boolean {// 与普通list区别：group也是可以选中的\r\n        return !this.isDisabledFn(item);\r\n    }\r\n    protected getListOptions(): Array<TiMenuItem> {// 与普通list区别：次级节点不会放入本级别。\r\n        return this.options;\r\n    }\r\n    public hasBorder(item: TiMenuItem, items: Array<TiMenuItem>): boolean { // 分组带线\r\n        const index: number = items.indexOf(item);\r\n        const indexPre: number = (index === 0) ? 0 : index - 1;\r\n\r\n        return item.groupId !== items[indexPre].groupId;\r\n    }\r\n    public onMouseenterItem(event: MouseEvent, option: any): void {\r\n        // 不是在选中项置Top时鼠标经过。\r\n        // tslint:disable-next-line:prefer-conditional-expression\r\n        if (new Date().getTime() - this.optionScrollTopLastTime > TiListComponent.SCROLL_TOP_TIME) {\r\n            this.hoverOption = option;  // 更新hover\r\n        }\r\n    }\r\n    // 防止继承list的ngOnChanges,初始化hoverOption变更触发hover事件，导致menu组件中的onhover事件报错\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnChanges(): void {\r\n    }\r\n}","import { Component, ContentChild, ElementRef, EventEmitter, Input, Output,\r\n      QueryList, SimpleChanges, TemplateRef, ViewChild, ViewChildren } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiMenuListComponent } from './TiMenuListComponent';\r\nimport { TiKeymap } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n// TODO: beforOpen延时打开，需要动态转圈等待\r\n/**\r\n * MenuItem是item项的数据接口\r\n */\r\nexport interface TiMenuItem {\r\n      /**\r\n       * 设置当前菜单项文本内容;\r\n       */\r\n      label?: string;\r\n      /**\r\n       * 设置当前菜单项tip提示内容\r\n       */\r\n      tip?: string;\r\n      /**\r\n       * 设置当前菜单项tip提示位置，默认值为：right；\r\n       */\r\n      tipPosition?: TiPositionType;\r\n      /**\r\n       * 设置当前菜单项是否置灰；\r\n       */\r\n      disabled?: boolean;\r\n      /**\r\n       * 设置当前菜单项的子菜单项，该数组的每个元素都是一个对象，对应子菜单项的一项，\r\n       */\r\n      children?: Array<TiMenuItem>;\r\n      /**\r\n       * 设置下拉面板不同组之间增加分割线，实现分组的效果。其属性也是title、tip、disable、click和childrens。注意：menu组件最多支持3级菜单。 查看示例\r\n       */\r\n      groupId?: string;\r\n      /**\r\n       * 允许有多余的属性字段\r\n       */\r\n      [propName: string]: any;\r\n}\r\n/**\r\n * Menu菜单组件\r\n *\r\n * 提供了一种方便的生成菜单下拉列表的方式，提供分组、自定义内容等功能。\r\n *\r\n * <example-url>../tiny3demo/#/menu/menu-all</example-url>\r\n */\r\n@Component({\r\n      selector: 'ti-menu',\r\n      templateUrl: './menu.html',\r\n      styleUrls: ['./menu.less'],\r\n      host: {\r\n            '(blur)': 'onBlur()'\r\n      }\r\n})\r\nexport class TiMenuComponent extends TiFormComponent {  // 本应继承自BaseComp，但是想要A标签焦点功能\r\n      /**\r\n       * 下拉菜单面板与按钮对齐方式。\r\n       */\r\n      @Input() panelAlign: 'left' | 'right' = 'right';\r\n      /**\r\n       * 下拉面板内容\r\n       */\r\n      @Input() items: Array<TiMenuItem>;\r\n      /**\r\n       * 下拉面板最大宽度，超过时换行，对所有子菜单都生效。\r\n       */\r\n      @Input() panelMaxWidth: string = '9999px';\r\n      /**\r\n       * 下拉面板最大高度，超过时出现竖向滚动条，对所有子菜单都生效。\r\n       */\r\n      @Input() panelMaxHeight: string = '9999px';\r\n      /**\r\n       * 要显示文字的键值\r\n       */\r\n      @Input() labelKey: string = 'label'; // labelKey\r\n      /**\r\n       * @ignore\r\n       */\r\n      @ViewChild('mytoggle', { static: true })  mytoggleRef: ElementRef;\r\n      /**\r\n       * @ignore\r\n       */\r\n      @ViewChildren(TiDropComponent) dropComs: QueryList<TiDropComponent>;\r\n      /**\r\n       * @ignore\r\n       */\r\n      @ViewChildren(TiMenuListComponent) listComs: QueryList<TiMenuListComponent>;\r\n      /**\r\n       * @ignore\r\n       */\r\n      @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) firstTemplate: TemplateRef<any>;\r\n      @ContentChild('item', /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>; // 自定义list中的item的模板\r\n      @ContentChild('tip', /* TODO: add static flag */ { static: false }) tipTemplate: TemplateRef<any>; // 自定义list中的tip的模板\r\n      /**\r\n       * 选中菜单项事件\r\n       */\r\n      @Output() readonly select: EventEmitter<TiMenuItem> = new EventEmitter<TiMenuItem>();\r\n      /**\r\n       * 打开面板之前，通知事件。完全交给业务用户处理。\r\n       */\r\n      @Output() readonly beforeOpen: EventEmitter<TiMenuComponent> = new EventEmitter<TiMenuComponent>();\r\n      /**\r\n       * @ignore\r\n       * itemsArr[0]存放根面板内容，itemArr[1]存放次级面板内容，itemArr[2]存放次次级面板内容\r\n       */\r\n      public itemsArr: Array<Array<TiMenuItem>> = [];\r\n      /**\r\n       * @ignore\r\n       *  与开关距离\r\n       */\r\n      public dominatorSpace: string = '10px';\r\n      /**\r\n       *  为true时为buttonselect组件\r\n       */\r\n      public hasBorder: boolean;\r\n      /**\r\n       * menulist最大高度\r\n       */\r\n      public menulistMaxHeight: number;\r\n      ngOnInit(): void {\r\n            // 基类中做了设置宿主id的操作\r\n            super.ngOnInit();\r\n            this.hasBorder = this.nativeElement.hasAttribute('hasborder');\r\n      }\r\n      ngOnChanges(changes: SimpleChanges): void {\r\n            this.setFocusableElems([this.mytoggleRef.nativeElement]);\r\n            super.ngOnChanges(changes);\r\n            if (changes['items']) { // 外部修改show属性的处理，初始定义在ngOnInit中处理\r\n                  this.itemsArr[0] = this.items;\r\n            }\r\n      }\r\n      /**\r\n       * 兼容旧版：\r\n       * 10.0.3 版本之前只能内嵌一个模板，无命名。\r\n       * 新版可以内嵌两个模板，示例书写要求都命名（#item，#tip）。\r\n       * 但需要兼容旧版无命名测试用例。\r\n       */\r\n      // tslint:disable-next-line: use-life-cycle-interface\r\n      ngAfterContentInit(): void {\r\n            super.ngAfterContentInit();\r\n            // 如果 item 模板为空 && 存在第一个模板，那么把第一个出现的 “非#tip 标签” 的模板作为 item 模板\r\n            if (!this.itemTemplate && this.firstTemplate\r\n                && (this.firstTemplate.elementRef.nativeElement !== (this.tipTemplate && this.tipTemplate.elementRef.nativeElement))) {\r\n                  this.itemTemplate = this.firstTemplate;\r\n            }\r\n      }\r\n      /**\r\n       * 打开面板\r\n       */\r\n      public open(): void {\r\n            if (this.disabled) {\r\n                  return;\r\n            }\r\n            // 打开面板前重置menulist最大高度\r\n            this.initListMaxHeight();\r\n            this.dropComs.first.show();\r\n            this.listComs.first.hoverOption = null;\r\n            // 根据drop的最大高度设置menulist最大高度\r\n            this.restyleListMaxHeight();\r\n            // IE滚动条Bug的监听\r\n            this.listComs.toArray().forEach(listCom => {\r\n                  listCom.listenIESrollbarBug();\r\n            })\r\n      }\r\n      /**\r\n       * 关闭面板\r\n       */\r\n      public close(): void {\r\n            this.dropComs.first.hide();\r\n            this.onHover(null, 0);\r\n            // 解除IE滚动条Bug的监听\r\n            this.listComs.toArray().forEach(listCom => {\r\n                  listCom.unlistenIESrollbarBug();\r\n            })\r\n      }\r\n      /**\r\n       * 切换面板状态：打开/关闭\r\n       */\r\n      public toggle(): void {\r\n            this.dropComs.first.isShow ? this.close() : this.open();\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onKeydown(event: KeyboardEvent): void {\r\n            switch (event.keyCode) {\r\n                  case TiKeymap.KEY_SPACE: // 原生SPACE键仅可打开。但Tiny2,3都跟Enter键保持一致\r\n                  case TiKeymap.KEY_ENTER: // ENTER键 相当于click\r\n                  case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)\r\n                        // 第一级已打开，但无选中项。或者第一级没有打开。相当于鼠标点击逻辑。\r\n                        if ((this.dropComs.first.isShow && !this.listComs.toArray()[0].hoverOption)\r\n                              || !this.dropComs.first.isShow) {\r\n                              this.onMousedown(null); // 相当于鼠标点击\r\n                              break; // 注意:break在if内，如果if不满足，则走到default，list处理按键\r\n                        }\r\n                  // 上面的回车键, 可能继续走到下面分支。\r\n                  // tslint:disable-next-line:no-switch-case-fall-through\r\n                  // eslint-disable-next-line no-fallthrough\r\n                  case TiKeymap.KEY_ARROW_LEFT: // 左右箭头，焦点在左右面板转移\r\n                  case TiKeymap.KEY_ARROW_RIGHT: // 左右箭头，焦点在左右面板转移\r\n                  case TiKeymap.KEY_ARROW_UP: // 上下箭头，上下移动选中项\r\n                  case TiKeymap.KEY_ARROW_DOWN: // 上下箭头，上下移动选中项\r\n                        for (let i = this.dropComs.length - 1; i >= 0; i--) { // 寻找末尾面板且有hover，list处理按键\r\n                              if (this.dropComs.toArray()[i].isShow && this.listComs.toArray()[i].hoverOption) {\r\n                                    this.onKeydownLastHoverList(event, i);\r\n\r\n                                    // break; //这里触发了for循环的break；并没有走到switch的break;所以改为return;\r\n                                    return;\r\n                              }\r\n                        }\r\n                        // 没有hover的面板，那么第一级面板（肯定是展开的）处理按键\r\n                        this.listComs.first.onKeydown(event);\r\n                        break;\r\n                  default:\r\n                        break;\r\n            }\r\n      }\r\n      private onKeydownLastHoverList(event: KeyboardEvent, i: number): void {\r\n            switch (event.keyCode) {\r\n                  case TiKeymap.KEY_ARROW_LEFT: // 左右箭头，焦点在左右面板转移\r\n                  case TiKeymap.KEY_ARROW_RIGHT: // 左右箭头，焦点在左右面板转移\r\n                        if ((this.panelAlign === 'right' && event.keyCode === TiKeymap.KEY_ARROW_LEFT)\r\n                              || (this.panelAlign === 'left' && event.keyCode === TiKeymap.KEY_ARROW_RIGHT)) { // 次级面板方向键\r\n                              if (i + 1 < this.dropComs.length && this.dropComs.toArray()[i + 1].isShow) {// 次级存在且展开\r\n                                    this.listComs.toArray()[i + 1].nextOption(false); // 次级面板hover由null改为下一个\r\n                              }\r\n                        } else { // 上级面板方向键\r\n                              this.listComs.toArray()[i].hoverOption = null;\r\n                        }\r\n                        break;\r\n                  case TiKeymap.KEY_SPACE: // 原生SPACE键仅可打开。但Tiny2,3都跟Enter键保持一致\r\n                  case TiKeymap.KEY_ENTER: // ENTER键 相当于click\r\n                  case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)\r\n                        if (!this.listComs.toArray()[i].isGroup(this.listComs.toArray()[i].hoverOption)) {\r\n                              this.listComs.toArray()[i].onKeydown(event);\r\n                        }\r\n                        break;\r\n                  default: // 上下键等，和上面的回车键也会走到这里。\r\n                        this.listComs.toArray()[i].onKeydown(event);\r\n                        break;\r\n            }\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onMousedown(event: MouseEvent): void {\r\n            if (this.dropComs.first.isShow) { // 已打开，则关闭\r\n                  this.close();\r\n            } else if (this.beforeOpen.observers.length === 0) { // 已打开，且无beforeOpen，则打开\r\n                  this.open();\r\n            } else { // 已打开，有beforeOpen\r\n                  this.beforeOpen.emit(this);\r\n            }\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onSelect(panelIndex: number): void {\r\n            this.select.emit(this.listComs.toArray()[panelIndex].model);\r\n            this.close();\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onBlur(): void {\r\n            this.close();\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onHover(item: any, panelIndex: number): void { // 当item为空，表示鼠标移出当前面板，也需要关闭次级面板。\r\n            if (panelIndex + 1 === this.dropComs.length) {// 当前hover面板，已经是最后一级面板\r\n                  return;\r\n            }\r\n            const dropComArr: Array<TiDropComponent> = this.dropComs.toArray();\r\n            const listComArr: Array<TiMenuListComponent> = this.listComs.toArray();\r\n            if (item && listComArr[panelIndex].isGroup(item) && !listComArr[panelIndex].isDisabledFn(item)) { // 根据数据，是否展开下一级\r\n                  this.itemsArr[panelIndex + 1] = item.children; // 下一级数据，赋新值。\r\n                  listComArr[panelIndex + 1].hoverOption = null; // 下一级面板赋空hoverOption，会触发onHover，进而关闭下一级面板的后续面板。\r\n                  // 赋新值以后，等模板有了新的尺寸，再弹出。\r\n                  setTimeout(() => {\r\n                        const currentPanel: HTMLElement = dropComArr[panelIndex].nativeElement; // 当前面板元素\r\n                        const nextPanel: HTMLElement = dropComArr[panelIndex + 1].nativeElement; // 下一级面板元素\r\n\r\n                        dropComArr[panelIndex + 1].show(); // 打开下一级面板\r\n                        // 位置调整，X方向 // TODO: 使用Position是否可行？\r\n                        const leftOffset: number = (this.panelAlign === 'left') ?\r\n                                                   currentPanel.offsetLeft + currentPanel.offsetWidth :\r\n                                                   currentPanel.offsetLeft - nextPanel.offsetWidth;\r\n                        nextPanel.style.left = `${leftOffset}px`;\r\n                        // 位置调整，Y方向\r\n                        const itemIndex: number = this.itemsArr[panelIndex].indexOf(item);\r\n                        const itemElem: any = listComArr[panelIndex].nativeElement.getElementsByTagName('LI')[itemIndex];\r\n                        // 当前li距离面板顶部的距离 = 当前li距离可视区顶部的距离 - 当前面板到可视区顶部的距离;\r\n                        const itemElmTop: number = itemElem.getBoundingClientRect().top - currentPanel.getBoundingClientRect().top;\r\n                        // 当前li距离页面底部的距离 = 可视区窗口高度 + 文档滚动高度 - 当前面板的offsetTop - 当前li距离面板顶部的距离;\r\n                        const bottomOffset: number = document.documentElement.clientHeight + document.documentElement.scrollTop -\r\n                                             currentPanel.offsetTop - itemElmTop;\r\n                        // 下一级面板的的高度\r\n                        const itemHeight: number = nextPanel.offsetHeight;\r\n                        // 底部空间能放下下一级面板：下一级面板的top = 当前面板的offsetTop + 当前li距离面板顶部的距离 - 面板的上下留白\r\n                        const nextPanelTop: number = currentPanel.offsetTop + itemElmTop - 4;\r\n                        if (bottomOffset > itemHeight) {\r\n                              nextPanel.style.top = nextPanelTop + 'px';\r\n\r\n                              return;\r\n                        }\r\n\r\n                        // 底部空间不足，和浏览器底部对齐\r\n                        nextPanel.style.top = nextPanelTop + bottomOffset - itemHeight + 'px';\r\n                  }, 0);\r\n            } else {\r\n                  // 当hover到具体项目（非分组）或 null（移出当前面板），需要闭合所有后续面板\r\n                  for (let i: number = panelIndex + 1; i < dropComArr.length; i++) {\r\n                        dropComArr[i].hide();\r\n                  }\r\n            }\r\n      }\r\n      /**\r\n       * @ignore\r\n       */\r\n      public onMouseoutDrop(event: MouseEvent, panelIndex: number): void {\r\n            // 默认需要隐藏, 除非鼠标进入面板区域。\r\n            for (let i: number = 0; i < this.dropComs.length; i++) {\r\n                  const dropRect: DOMRect = this.dropComs.toArray()[i].nativeElement\r\n                                                                      .getBoundingClientRect();\r\n                  // 因为慢慢移出本面板时，移出鼠标事件依然停留在本面板内（1px误差），所以面板rect四周范围要更小1px。\r\n                  if (dropRect.left < event.clientX && event.clientX < dropRect.right\r\n                        && dropRect.top < event.clientY && event.clientY < dropRect.bottom) {\r\n                        return;\r\n                  }\r\n            }\r\n            // 给第一级面板置无选中，那么次级面板自然会关闭。\r\n            this.listComs.first.hoverOption = null; // 会触发到上面this.onHover(null, 0);\r\n      }\r\n      // 初始化menulist最大高度\r\n      public initListMaxHeight(): void {\r\n            this.menulistMaxHeight = parseInt(this.panelMaxHeight, 10);\r\n            this.listComs.toArray().forEach(listCom => {\r\n                  this.renderer.setStyle(listCom.nativeElement, 'max-height', this.menulistMaxHeight + 'px');\r\n            });\r\n      }\r\n     // 考虑drop的压缩情况，设置menulist的max-height\r\n      public restyleListMaxHeight(): void {\r\n            const dropCurMaxHeight: number = parseInt(this.dropComs.first.nativeElement.style.maxHeight, 10);\r\n            if (!isNaN(dropCurMaxHeight) && dropCurMaxHeight < this.menulistMaxHeight) {\r\n                  this.listComs.toArray().forEach(listCom => {\r\n                        this.renderer.setStyle(listCom.nativeElement, 'max-height',  dropCurMaxHeight + 'px');\r\n                  });\r\n            }\r\n      }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiMenuComponent } from './TiMenuComponent';\r\nimport { TiMenuListComponent } from './TiMenuListComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiDropModule,\r\n    TiTipModule\r\n  ],\r\n  exports: [TiMenuComponent, TiMenuListComponent],\r\n  declarations: [TiMenuComponent, TiMenuListComponent]\r\n})\r\nexport class TiMenuModule {\r\n}\r\nexport { TiMenuComponent, TiMenuItem } from './TiMenuComponent';\r\nexport { TiMenuListComponent } from './TiMenuListComponent';\r\n","import {\r\n    Component,\r\n    ContentChild,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    IterableChanges,\r\n    IterableDiffer,\r\n    IterableDiffers,\r\n    KeyValueChanges,\r\n    KeyValueDiffer,\r\n    KeyValueDiffers,\r\n    Output,\r\n    Renderer2,\r\n    TemplateRef,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiMenuComponent, TiMenuItem } from '../menu/TiMenuModule';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiPopconfirmConfig } from '../../directives/popconfirm/TiPopconfirmDirective';\r\n\r\n/**\r\n * 10.0.3/9.0.7版本新增该接口\r\n *\r\n * 在此之前版本可直接使用`TiMenuItem`接口\r\n */\r\nexport interface TiActionmenuItem extends TiMenuItem {\r\n    /**\r\n     * 气泡确认框配置，具体可参考tiPopconfirm指令\r\n     *\r\n     * 在actionmenu中，只有暴露在更多按钮外部，直接显示在页面中的菜单项，配置后会显示确认框\r\n     */\r\n    popConfig?: TiPopconfirmConfig;\r\n}\r\n\r\n// 空间设置规则：\r\n// 可显示项目数（children项目必须出现在“更多”），最大显示数目，空间宽度。\r\n// 更多”里面至少两个选项\r\n// 如果只有一个带children项目那么直接用menu。\r\n\r\n/**\r\n * ActionMenu菜单按钮组件\r\n *\r\n * ActionMenu组件主要是一组操作按钮。当按钮数量太多导致预留空间大小无法显示所有按钮时，自动将超出部分的按钮放置在一个menu组件下拉中。\r\n *\r\n * 使用该组件，用户只需关注操作项配置，无需关注操作项显示不足的情况。\r\n *\r\n * 注意：ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked.（本组件在调试环境报此错误，不必理会。生产环境不报错，功能也不受影响。）\r\n *\r\n * <example-url>../tiny3demo/#/actionmenu/actionmenu-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-actionmenu',\r\n    templateUrl: './actionmenu.html',\r\n    styleUrls: ['./actionmenu.less'],\r\n    host: {\r\n        '[style.max-width]': 'maxWidth'\r\n    }\r\n})\r\nexport class TiActionmenuComponent extends TiFormComponent {  // 本应继承自BaseComp，但是想要A标签焦点功能\r\n    /* Menu参数透传start */\r\n    /**\r\n     * 选项数据集\r\n     */\r\n    @Input() items: Array<TiActionmenuItem>;\r\n    /**\r\n     * 下拉面板最大宽度，超过时换行，对所有子菜单都生效。\r\n     */\r\n    @Input() panelMaxWidth: string = '130px';\r\n    /**\r\n     * 下拉面板最大高度度，超过时出现竖向滚动条，对所有子菜单都生效。\r\n     */\r\n    @Input() panelMaxHeight: string = '9999px';\r\n    /**\r\n     * 数据中要显示字符串的key\r\n     */\r\n    @Input() labelKey: string = 'label';\r\n    /**\r\n     * 用户点击选中菜单项事件\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly select: EventEmitter<TiActionmenuItem> = new EventEmitter<TiActionmenuItem>();\r\n    /* Menu参数透传end */\r\n\r\n    /**\r\n     * 外部容器宽度\r\n     */\r\n    @Input() maxWidth: string = '250px';\r\n    /**\r\n     * 各item的间距\r\n     */\r\n    @Input() space: string = '10px';\r\n    // 分割线为divider，分割字符叫做separator（比如分割ip里的点）\r\n    /**\r\n     * 各item之间是否展示分割线\r\n     *\r\n     * 3.1.3新增\r\n     */\r\n    @Input() showDivider: boolean = true;\r\n    /**\r\n     * 最大显示个数, 包含下拉菜单\r\n     */\r\n    @Input() maxShowNum: number = 4;\r\n    /**\r\n     * 下拉菜单上方显示文本\r\n     *\r\n     * 缺省值 : 更多/more（国际化）\r\n     */\r\n    @Input() moreText: string; // = '更多';\r\n    /**\r\n     * 只显示更多项下拉菜单时，下拉菜单上方显示文本\r\n     *\r\n     * 缺省值 : 操作/operation（国际化）\r\n     */\r\n    @Input() menuText: string; // = '操作';\r\n    /**\r\n     * 常常绑定表格本行数据。\r\n     */\r\n    @Input() data: any;\r\n    /**\r\n     * 表格本行data数据，转化为items数据。类型：(data: any) => Array<MenuItem>\r\n     */\r\n    @Input() dataToItemsFn: (data: any) => Array<TiActionmenuItem>;\r\n\r\n    /**\r\n     * @ignore\r\n     * 用户写的自定义模板\r\n     */\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) firstTemplate: TemplateRef<any>;\r\n    @ContentChild('item', /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>; // 自定义 item 模板\r\n    @ContentChild('tip', /* TODO: add static flag */ { static: true }) tipTemplate: TemplateRef<any>; // 自定义 tip 模板\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild(TiMenuComponent, { static: true }) menuCom: TiMenuComponent;\r\n    /**\r\n     * @ignore\r\n     * 下拉菜单绑定的选项数据\r\n     */\r\n    public panelItems: Array<TiActionmenuItem> = [];\r\n    /**\r\n     * @ignore\r\n     * 各item之间间隔的一半距离\r\n     */\r\n    public halfSpace: string = '';\r\n\r\n    private itemsDiffer: IterableDiffer<TiActionmenuItem>;\r\n    private dataDiffer: KeyValueDiffer<any, any>;\r\n    private needInitItems: boolean = false;\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2,\r\n                private iterableDiffers: IterableDiffers, private keyValueDiffers: KeyValueDiffers) {\r\n        super(hostRef, renderer);\r\n        const localeWords: TiLocaleWords = TiLocale.getLocaleWords();\r\n        this.moreText = localeWords.tiActionmenu.more;\r\n        this.menuText = localeWords.tiActionmenu.operation;\r\n    }\r\n\r\n    // 纠正 IE下同一行两个元素 offsetTop 值可能存在的一些(目前测试到有1px)的误差\r\n    private static isEqualOffsetTop(elem1: any, elem2: any): boolean {\r\n        return Math.abs((elem1 as HTMLElement).offsetTop - (elem2 as HTMLElement).offsetTop) <= 2;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     *  选中菜单内选项\r\n     * @param item 菜单项数据\r\n     */\r\n    public onSelect(item: TiActionmenuItem): void {\r\n        if (!item.disabled) {\r\n            this.select.emit(item);\r\n        }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.panelItems = this.items;\r\n        this.halfSpace = Number.parseInt(this.space, 10) / 2 + 'px';\r\n    }\r\n    ngDoCheck(): void {\r\n        if (this.data) {\r\n            if (!this.dataDiffer) { // 首次docheck是ngOnInit()之后\r\n                this.dataDiffer = this.keyValueDiffers.find(this.data)\r\n                    .create();\r\n            }\r\n            const dataChanges: KeyValueChanges<any, any> | null = this.dataDiffer.diff(this.data);\r\n            if (dataChanges) { // 根据data初始化items. 注意：第一次diff会走入changes\r\n                this.items = this.dataToItemsFn(this.data);\r\n            }\r\n        }\r\n        if (this.items) {\r\n            if (!this.itemsDiffer) {\r\n                this.itemsDiffer = this.iterableDiffers.find(this.items)\r\n                    .create();\r\n                this.needInitItems = true;\r\n            }\r\n            const itemsChanges: IterableChanges<TiActionmenuItem> | null = this.itemsDiffer.diff(this.items);\r\n            // 注意：如果有数据，那么第一次diff会就走入changes。如果是空数据，第一次diff结果是null，不会进入changes。\r\n            if (itemsChanges) { // 如果items改变，则重新初始化。\r\n                this.needInitItems = true;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 兼容旧版：\r\n     * 10.0.3 版本之前只能内嵌一个模板，无命名。\r\n     * 新版可以内嵌两个模板，示例书写要求都命名（#item，#tip）。\r\n     * 但需要兼容旧版无命名测试用例。\r\n     */\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterContentInit(): void {\r\n          super.ngAfterContentInit();\r\n          // 如果 item 模板为空 && 存在第一个模板，那么把第一个出现的 “非 #tip 标签” 的模板作为 item 模板\r\n          if (!this.itemTemplate && this.firstTemplate\r\n              && (this.firstTemplate.elementRef.nativeElement !== (this.tipTemplate && this.tipTemplate.elementRef.nativeElement))) {\r\n                this.itemTemplate = this.firstTemplate;\r\n          }\r\n    }\r\n    ngAfterViewChecked(): void {\r\n        if (this.needInitItems) {\r\n            this.initItems();\r\n        }\r\n        super.ngAfterViewChecked(); // 内部执行了autofocus\r\n    }\r\n    /**\r\n     * 计算那些item应该显示在外部，移除不该显示的item，调整pannel上显示的item项，调整menu显示的文字。\r\n     */\r\n    private initItems(): void {\r\n\r\n        this.needInitItems = false;\r\n\r\n        const itemElems: HTMLCollection = this.hostRef.nativeElement.getElementsByClassName('ti3-action-menu-item');\r\n        const dividingElems: HTMLCollection = this.hostRef.nativeElement.getElementsByClassName('ti3-action-menu-divider');\r\n        const menuElem: HTMLElement = this.menuCom.nativeElement;\r\n        const moreTextElem: HTMLElement = this.hostRef.nativeElement.getElementsByClassName('tiMoreText')[0];\r\n        const menuTextElem: HTMLElement = this.hostRef.nativeElement.getElementsByClassName('tiMenuText')[0];\r\n        // 情况一：items为空\r\n        if (!this.items || this.items.length === 0) {\r\n            this.setDisplay(menuElem, false);\r\n\r\n            return;\r\n        } else {\r\n            this.setDisplay(menuElem, true);\r\n        }\r\n        // 注意: itemElems不是数组，并且数据更新时，取到的length不对。所以，得使用items的length\r\n        let firstChildrenIndex: number = -1; // 第一个含有子项目的索引\r\n        // 这个for循环，做了两件事：找含有子项目，重置item可见。\r\n        for (let i: number = 0; i < this.items.length; i++) {\r\n            if (this.items[i].hasOwnProperty('children')) {\r\n                firstChildrenIndex = i; // 找到第一个含有子项目的索引\r\n                // break;\r\n            }\r\n            this.setDisplay(itemElems[i], true); // 因为动态修改item，所以第二次进入时需要重置item可见。\r\n        }\r\n\r\n        // 情况二：不显示menu  //条件：没有超过最大显示个数，且最后一个项目也在第一行, 且没有子项\r\n        if (this.items.length <= this.maxShowNum\r\n            && TiActionmenuComponent.isEqualOffsetTop(itemElems[this.items.length - 1], itemElems[0])\r\n            && firstChildrenIndex === -1) {\r\n\r\n            for (let i: number = 0; i < this.items.length; i++) {\r\n                this.setAttr(itemElems[i], 'disabled', this.items[i].disabled);\r\n            }\r\n            this.setDisplay(menuElem, false);\r\n            // 设置可聚焦元素\r\n            const focusItems: Array<any> = [];\r\n            for (let i: number = 0; i < this.items.length; i++) {\r\n                focusItems.push(itemElems[i]);\r\n            }\r\n            this.setFocusableElems(focusItems);\r\n\r\n            return;\r\n        }\r\n        // 情况三：显示Menu，显示数目条件：有子项目的一定在菜单内/倒数第二个一定在菜单内/最大显示个数（含menu）。3值取最小。\r\n        if (firstChildrenIndex === -1) {\r\n            firstChildrenIndex = this.items.length; // firstChild给一个超越数组大小的索引，方便下面计算\r\n        }\r\n        let outShowNum: number = (this.items.length - 2) < (this.maxShowNum - 1) ? (this.items.length - 2) :\r\n            (this.maxShowNum - 1) < (firstChildrenIndex + 1) ? (this.maxShowNum - 1) : (firstChildrenIndex + 1);\r\n\r\n        for (let i: number = this.items.length - 1; i >= 0; i--) {\r\n            if (i > outShowNum - 1) { // 本项属于超出的数目，先删除掉\r\n                //  TODO: remove和style哪个效率高？\r\n                this.setDisplay(itemElems[i], false);\r\n                if (dividingElems[i]) {\r\n                    this.setDisplay(dividingElems[i], false);\r\n                }\r\n            } else if (!TiActionmenuComponent.isEqualOffsetTop(menuElem, itemElems[0])) { // 菜单没有在第一行，删除本项\r\n                this.setDisplay(itemElems[i], false);\r\n                if (dividingElems[i]) {\r\n                    this.setDisplay(dividingElems[i], false);\r\n                }\r\n                outShowNum--;\r\n            } else {\r\n                this.setAttr(itemElems[i], 'disabled', this.items[i].disabled);\r\n            }\r\n        }\r\n\r\n        // 设置菜单显示文字，设置可聚焦元素\r\n        if (outShowNum === 0) { // 立即生效，否则根据模板变量生效慢\r\n            this.renderer.setStyle(menuElem, 'margin-left', '0px');\r\n            this.setDisplay(moreTextElem, false);\r\n            this.setDisplay(menuTextElem, true);\r\n            // 设置可聚焦元素\r\n            this.setFocusableElems(this.menuCom.getFocusableElems());\r\n        } else {\r\n            this.setDisplay(moreTextElem, true);\r\n            this.setDisplay(menuTextElem, false);\r\n            // 设置可聚焦元素\r\n            const focusItems: Array<any> = [];\r\n            for (let i: number = 0; i < outShowNum; i++) {\r\n                focusItems.push(itemElems[i]);\r\n            }\r\n            this.setFocusableElems(focusItems.concat(this.menuCom.getFocusableElems()));\r\n        }\r\n\r\n        /**\r\n         * 此句改变了模板变量，需要强制刷新\r\n         * 这里引起ng-serve环境报错ExpressionChangedAfterItHasBeenCheckedError, 所以用Promise延时\r\n         */\r\n        Promise.resolve().then(() => {\r\n            this.panelItems = this.items.slice(outShowNum, this.items.length);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 设置显示/隐藏样式，比ngIf更及时生效。\r\n     * @param elem HTML元素\r\n     * @param isShow 是否显示\r\n     */\r\n    private setDisplay(elem: any, isShow: boolean): void {\r\n        this.renderer.setStyle(elem, 'display', isShow ? 'inline-block' : 'none');\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * ngFor遍历的 trackBy函数，防止数据更新导致所有DOM重新渲染。TODO：这里是否该使用trackBy?\r\n     * @param index 索引\r\n     * @param item 数据\r\n     * @returns 索引\r\n     */\r\n    public trackByFn(index: any, item: any): any {\r\n        return index;\r\n    }\r\n}\r\n","import { AfterViewInit, Component, ElementRef, Input, OnInit, Renderer2 } from '@angular/core';\r\nimport { TiLocale } from '../../locale/TiLocaleModule';\r\nimport { TiBaseComponent } from '../../components/base/TiBaseModule';\r\n\r\n@Component({\r\n    templateUrl: 'popconfirm.html',\r\n    styleUrls: ['./popconfirm.less'],\r\n    host: {\r\n        '[class.ti3-popconfirm-container]': 'true',\r\n        '[tabindex]': '0'\r\n    }\r\n})\r\n\r\nexport class TiPopconfirmComponent extends TiBaseComponent implements OnInit, AfterViewInit {\r\n    @Input() config: any;\r\n    @Input() destroyPopover: (result?: boolean) => void;\r\n    private readonly tiPopconfirm: any = TiLocale.getLocaleWords().tiPopconfirm;\r\n\r\n\r\n    ngOnInit(): void {\r\n        this.config.yesText = this.config.yesText ||  this.tiPopconfirm.yesLabel;\r\n        this.config.noText = this.config.noText || this.tiPopconfirm.noLabel;\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        // 轻量级弹窗阴影定制\r\n        this.renderer.addClass(this.nativeElement.offsetParent, 'ti3-popconfirm-tip'); // 在init中设置会影响button样式 TODO: IE下还存在背景闪烁问题\r\n    }\r\n}\r\n","import { Component, Input, Renderer2, ViewEncapsulation, ElementRef, NgZone, AfterViewInit } from '@angular/core';\r\nimport { TiAutofocusComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * Button按钮组件\r\n *\r\n * 尽管这是一个组件，但使用方法有点像属性指令。\r\n *\r\n * 按钮组件基于原生button组件进行扩展，原生button加tiButton属性即为tiny button，button的多种样式则通过为button设置不同的样式类来进行区分，具体用法见示例。\r\n *\r\n * <example-url>../tiny3demo/#/button/button-all</example-url>\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiButton]',\r\n    templateUrl: './button.html',\r\n    styleUrls: ['./button.less'],\r\n    host: {\r\n        '[class.ti3-btn-primary]': 'color === \"primary\"',\r\n        '[class.ti3-btn-danger]': 'color === \"danger\"',\r\n        '[class.ti3-btn-icon]': 'icon',\r\n        '[class.ti3-btn-onlyIcon]': 'onlyIcon',\r\n        '[class.ti3-btn-large]': 'size === \"large\"',\r\n        '[class.ti3-btn-middle]': 'size === \"middle\"',\r\n        '[class.ti3-btn-small]': 'size === \"small\"',\r\n        '[class.ti3-btn-xs]': 'size === \"xs\"',\r\n        '[class.ti3-btn-loading]': 'loading'\r\n    },\r\n    encapsulation: ViewEncapsulation.None // 让宿主元素也用上button.less样式。否则，默认胶囊封装避免CSS污染。\r\n})\r\nexport class TiButtonComponent extends TiAutofocusComponent implements AfterViewInit {\r\n    /**\r\n     * 按钮颜色：默认按钮/强调色按钮/主题色按钮\r\n     */\r\n    @Input() color:  'default' | 'danger' |'primary' = 'default';\r\n    /**\r\n     * 是否含有icon\r\n     */\r\n    @Input() icon: boolean = false;\r\n    /**\r\n     * 是否为纯图标按钮\r\n     */\r\n    @Input() onlyIcon: boolean = false;\r\n    /**\r\n     * 样式大小：XS/S/M/L四个尺寸按钮 默认M尺寸\r\n     */\r\n    @Input() size: 'xs'|'small'|'middle'|'large' = 'middle';\r\n    /**\r\n     * 10.1.4新增\r\n     *\r\n     * 是否处于加载状态，主要用于弹窗的异步任务提交场景\r\n     */\r\n    @Input() loading: boolean = false;\r\n\r\n     constructor(public renderer: Renderer2, private hostEle: ElementRef, private zone: NgZone) {\r\n        super(hostEle, renderer);\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            this.renderer.listen(this.hostEle.nativeElement, 'mousedown', (): void => {\r\n                this.renderer.setStyle(this.hostEle.nativeElement, 'outline', 'none');\r\n            });\r\n            this.renderer.listen(this.hostEle.nativeElement, 'blur', (): void => {\r\n                this.renderer.setStyle(this.hostEle.nativeElement, 'outline', '');\r\n            });\r\n        });\r\n    }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * Loading组件用于加载场景，提供了两种类型\r\n *\r\n * 10.0.3新增\r\n *\r\n * <example-url>../tiny3demo/#/loading/loading-all</example-url>\r\n */\r\n@Component({\r\n  selector: 'ti-loading',\r\n  templateUrl: './loading.html',\r\n  styleUrls: ['./loading.less'],\r\n})\r\n\r\nexport class TiLoadingComponent extends TiBaseComponent {\r\n  /**\r\n   * @ignore\r\n   * 弱类型有4个圈\r\n   */\r\n  public items: Array<any> = [];\r\n\r\n  @Input() type: 'default' | 'weak' = 'default'; // 加载类型\r\n  @Input() size: 'small' | 'middle' | 'large' | string = 'small'; // 加载尺寸\r\n\r\n  // tslint:disable-next-line:use-life-cycle-interface\r\n  ngOnInit(): void {\r\n    super.ngOnInit();\r\n    this.items.length = 4;\r\n  }\r\n\r\n  /**\r\n   * @ignore\r\n   * 根据用户传入尺寸获取border的宽度\r\n   */\r\n  getBorderWidth(size: string): string {\r\n    return parseInt(size, 10) * 0.3 / 2 + 'px';\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiLoadingComponent } from './TiLoadingComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiLoadingComponent],\r\n  declarations: [TiLoadingComponent]\r\n})\r\nexport class TiLoadingModule {\r\n}\r\nexport { TiLoadingComponent } from './TiLoadingComponent';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiButtonComponent } from './TiButtonComponent';\r\nimport { TiLoadingModule } from '../loading/TiLoadingModule';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, TiLoadingModule],\r\n  exports: [TiButtonComponent],\r\n  declarations: [TiButtonComponent]\r\n})\r\nexport class TiButtonModule {\r\n}\r\nexport { TiButtonComponent } from './TiButtonComponent';\r\n","import { ComponentRef, Directive, ElementRef, HostListener, Input, NgZone, OnDestroy, OnInit, Renderer2, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiPositionType } from '../../utils/Position';\r\nimport { TiTipRef } from '../../services/tip/TiTipInterface';\r\nimport { TiTipService } from '../../services/tip/TiTipService';\r\nimport { TiTipDirective } from '../../directives/tip/TiTipDirective';\r\nimport { TiPopconfirmComponent } from './TiPopconfirmComponent';\r\nimport { Util, TiKeymap } from '../../utils/Util';\r\n\r\nexport interface TiPopconfirmConfig {\r\n    /**\r\n     * 设置确认框id\r\n     */\r\n    id?: string;\r\n    /**\r\n     * 设置确认框描述信息\r\n     */\r\n    content: string;\r\n    /**\r\n     * 自定义是按钮文本\r\n     */\r\n    yesText?: string;\r\n    /**\r\n     * 自定义否按钮文本\r\n     */\r\n    noText?: string;\r\n    /**\r\n     * 设置是按钮为强调按钮\r\n     */\r\n    yesPrimary?: boolean;\r\n    /**\r\n     * 设置确认框弹出方向\r\n     */\r\n    position?: TiPositionType;\r\n    /**\r\n     * 触发'是'按钮事件\r\n     */\r\n    close?(data?: any): void;\r\n    /**\r\n     * 触发'否'按钮事件\r\n     */\r\n    dismiss?(data?: any): void;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n\r\n}\r\n\r\n/**\r\n * TiPopconfirm 气泡确认框指令\r\n *\r\n * 一般用于操作执行后对用户业务不会有严重影响的轻量级场景。\r\n *\r\n * 10.0.3/9.0.7版本新增\r\n *\r\n * <example-url>../tiny3demo/#/popconfirm/popconfirm-all</example-url>\r\n */\r\n@Directive({\r\n    selector: '[tiPopconfirm]'\r\n})\r\nexport class TiPopconfirmDirective extends TiTipDirective implements OnInit, OnDestroy {\r\n    /**\r\n     * 气泡确认框配置对象\r\n     */\r\n    @Input() tiPopconfirm: TiPopconfirmConfig;\r\n    /**\r\n     * 10.1.1新增\r\n     *\r\n     * 数据接口， 常常绑定表格本行数据。\r\n     */\r\n    @Input() data: any;\r\n    protected tipInstance: TiTipRef;\r\n    private hostElement: any;\r\n    private popoverComponentRef: ComponentRef<any> = null;\r\n    private unlistenClick: () => void;\r\n     // 可聚焦元素\r\n     private focusableElementsString: string = `a[href], area[href], input:not([disabled]):not([tabindex=\\'-1\\']),\r\n     button:not([disabled]):not([tabindex=\\'-1\\']),select:not([disabled]):not([tabindex=\\'-1\\']),\r\n     textarea:not([disabled]):not([tabindex=\\'-1\\']),\r\n     iframe, object, embed, *[tabindex]:not([tabindex=\\'-1\\']), *[contenteditable=true]`;\r\n    constructor(private tiTipService: TiTipService, private hostEleRef: ElementRef, private zone: NgZone, private render: Renderer2,\r\n                @Inject(DOCUMENT) private document) {\r\n        super(tiTipService, hostEleRef);\r\n    }\r\n    /**\r\n     * tip组件配置\r\n     */\r\n    private tipConfig: any = {\r\n        trigger: 'manual',\r\n        theme: 'white'\r\n    };\r\n    private unListenDocumentKeydown: () => void;\r\n\r\n    ngOnInit(): void {\r\n        if (!this.tiPopconfirm || !this.tiPopconfirm.content) {\r\n            return;\r\n        }\r\n        this.hostElement = this.hostEleRef.nativeElement;\r\n        // 创建实例\r\n        this.tipInstance = this.tiTipService.create(this.hostElement, {\r\n            ...this.tipConfig,\r\n            position: this.tiPopconfirm.position,\r\n            registerVisibilityChangeEvent: false\r\n        });\r\n\r\n        this.addClickEvent();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.tipInstance) {\r\n            super.ngOnDestroy();\r\n        }\r\n        if (this.unlistenClick) {\r\n            this.unlistenClick();\r\n        }\r\n        if (this.unListenDocumentKeydown) {\r\n            this.unListenDocumentKeydown();\r\n        }\r\n\r\n    }\r\n\r\n    private addClickEvent(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            this.unlistenClick = this.render.listen(this.document, 'click', (event: MouseEvent) => {\r\n                if (this.hostElement.contains(event.target) && !this.popoverComponentRef) {\r\n                    this.showPopandFocus();\r\n\r\n                    return;\r\n                }\r\n                const tipElement: any = this.popoverComponentRef && this.popoverComponentRef.location.nativeElement;\r\n                if (!(tipElement && tipElement.contains(event.target))) {\r\n                    this.zone.run(() => {\r\n                        this.hide();\r\n                    });\r\n                    this.popoverComponentRef = null;\r\n                }\r\n            });\r\n\r\n            this.unListenDocumentKeydown = this.render.listen(document, 'keydown', (event: KeyboardEvent): void => {\r\n                switch (event.which) {\r\n                    case TiKeymap.KEY_TAB: // tab键用于处理在提示框内循环获取焦点\r\n                        this.clickTab(event);\r\n                        break;\r\n                    case TiKeymap.KEY_ENTER:\r\n                        if (this.hostElement.contains(event.target) && !this.popoverComponentRef) {\r\n                            this.showPopandFocus();\r\n                        }\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            });\r\n\r\n        });\r\n    }\r\n\r\n    public clickTab(event: KeyboardEvent): void {\r\n        const dialogModalEle: HTMLElement = document.querySelector('.ti3-popconfirm-container');\r\n        const focusableElements: NodeList = dialogModalEle?.querySelectorAll(this.focusableElementsString);\r\n        Util.focusInDialogOnTabchange(event, focusableElements);\r\n    }\r\n    /**\r\n     * 打开气泡组件，并且把焦点转移到提示框内部，为后续把焦点限制在提示框内做准备。\r\n     * @private\r\n     */\r\n    private showPopandFocus(): void {\r\n        this.zone.run(() => {\r\n            this.popoverComponentRef = this.show();\r\n            const popContainerEle: HTMLElement = document.querySelector('.ti3-popconfirm-container');\r\n            if (popContainerEle) {\r\n                popContainerEle.focus();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 显示气泡确认框\r\n     * @ignore\r\n     */\r\n    public show(): ComponentRef<any> {\r\n        if (!this.tipInstance) {\r\n            return;\r\n        }\r\n        const destroyPopover: (result?: boolean) => void = (result?: boolean): void => {\r\n            this.hide();\r\n            if (result && Util.isFunction(this.tiPopconfirm.close)) {\r\n                this.tiPopconfirm.close(this.data);\r\n            } else if (!result && Util.isFunction(this.tiPopconfirm.dismiss)) {\r\n                this.tiPopconfirm.dismiss(this.data);\r\n            }\r\n        };\r\n\r\n        return this.tipInstance.show(TiPopconfirmComponent, {\r\n            id: this.tiPopconfirm.id,\r\n            config: this.tiPopconfirm,\r\n            destroyPopover\r\n        });\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiPopconfirmComponent } from './TiPopconfirmComponent';\r\nimport { TiTipServiceModule } from '../../services/tip/TiTipServiceModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\nimport { TiButtonModule } from '../../components/button/TiButtonModule';\r\nimport { TiPopconfirmDirective } from './TiPopconfirmDirective';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiTipServiceModule,\r\n    TiLocaleModule,\r\n    TiIconModule,\r\n    TiButtonModule\r\n  ],\r\n  exports: [TiPopconfirmDirective],\r\n  declarations: [TiPopconfirmComponent, TiPopconfirmDirective],\r\n  entryComponents: [TiPopconfirmComponent]\r\n})\r\n\r\nexport class TiPopconfirmModule { }\r\nexport { TiPopconfirmComponent } from './TiPopconfirmComponent';\r\nexport { TiPopconfirmDirective, TiPopconfirmConfig } from './TiPopconfirmDirective';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiActionmenuComponent } from './TiActionmenuComponent';\r\nimport { TiMenuModule } from '../menu/TiMenuModule';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiPopconfirmModule } from '../../directives/popconfirm/TiPopconfirmModule';\r\n\r\n@NgModule({\r\n  imports: [ CommonModule,\r\n    TiMenuModule,\r\n    TiTipModule,\r\n    TiPopconfirmModule],\r\n  exports: [TiActionmenuComponent],\r\n  declarations: [TiActionmenuComponent]\r\n})\r\nexport class TiActionmenuModule {\r\n}\r\nexport { TiActionmenuComponent, TiActionmenuItem } from './TiActionmenuComponent';\r\n","import { Component, EventEmitter, Input, Output, ElementRef, Renderer2, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { Util } from '../../utils/Util';\r\n\r\n\r\n/**\r\n * Alert组件用于消息提示，提供了四种类型\r\n *\r\n * <example-url>../tiny3demo/#/alert/alert-all</example-url>\r\n */\r\n@Component({\r\n  selector: 'ti-alert',\r\n  templateUrl: './alert.html',\r\n  styleUrls: ['./alert.less']\r\n})\r\n\r\nexport class TiAlertComponent extends TiBaseComponent {\r\n    /**\r\n     * 是否显示左侧提示类型图标\r\n     */\r\n    @Input() typeIcon: boolean = true;\r\n    /**\r\n     * 是否显示关闭按钮\r\n     */\r\n    @Input() closeIcon: boolean = true;\r\n    /**\r\n     * 显示多长时间后消失，默认不延迟消失，只在点击关闭按钮时消失\r\n     */\r\n    @Input() dismissOnTimeout: number;\r\n    /**\r\n     * 是否触发下拉类组件消失的事件，适用于alert的呈现状态影响页面下拉类组件位置的场景\r\n     */\r\n    @Input() triggerScroll: boolean = false;\r\n    /**\r\n     * 弹框类型\r\n     */\r\n    @Input() type: 'success'|'error'|'warn'|'prompt'|'simple' = 'success';\r\n    /**\r\n     * 样式大小\r\n     */\r\n    @Input() size: 'normal' | 'small' = 'normal';\r\n    private isOpen: boolean = true;\r\n    /**\r\n     * 是否为深色背景提示框\r\n     */\r\n    @Input() darkTheme: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 是否设置阴影，组件规范定义无阴影（页面级及卡片内）\r\n     */\r\n    @Input() boxShadow:boolean = false;\r\n    /* tslint:disable:no-redundant-jsdoc */\r\n    /**\r\n     * 用于设置弹框是否弹出，可动态修改，默认值为true\r\n     *\r\n     * **请注意：动态修改情况下，需要设置为双向绑定，以确保组件延迟消失时open状态的正确感知**\r\n     *\r\n     * @type：boolean\r\n     *\r\n     */\r\n    @Input()\r\n    // 由于内部/外部设置open都会执行同样的逻辑，因此使用set/get\r\n    /**\r\n     * @ignore\r\n     */\r\n    get open(): boolean {\r\n        return this.isOpen;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    set open(value: boolean) {\r\n        if (value === this.open) {\r\n            return;\r\n        }\r\n        if (value) {// 值为true时，才会延迟关闭\r\n            this.dismissOnTime();\r\n        } else {// 值为false时，关闭时清除定时器\r\n            this.clearTimeout();\r\n        }\r\n        // open动态修改均涉及tiScroll事件\r\n        this.triggerScrollEvent();\r\n        this.isOpen = value;\r\n    }\r\n    /**\r\n     * open状态变化事件，点击关闭按钮或延时消失时都会触发\r\n     */\r\n    @Output() readonly openChange: EventEmitter<Boolean> = new EventEmitter();\r\n    private timeoutId: any; // 内部变量，存储定时器ID\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2, @Inject(DOCUMENT) private document) {\r\n        super(hostRef, renderer);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始open值为true时，设置延时关闭\r\n        if (this.open) {\r\n            this.dismissOnTime();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.timeoutId !== undefined) {\r\n            clearTimeout(this.timeoutId);\r\n            if (this.open) {\r\n                this.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * alert呈现后，处理多长时间后消失\r\n     */\r\n    dismissOnTime(): void {\r\n        // 未配置消失时间或当前已处于隐藏状态，则不做处理\r\n        if (isNaN(this.dismissOnTimeout)) {\r\n            return;\r\n        }\r\n        this.timeoutId = setTimeout(() => {\r\n            this.close();\r\n        }, this.dismissOnTimeout);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 关闭alert方法，供内部关闭调用\r\n     */\r\n    close(): void {\r\n        this.open = false;\r\n        this.openChange.emit(this.open); // 及时通知open状态，确保open状态双向绑定功能正常\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * alert出现或者消失时，可能会触发页面滚动，此时需要触发tiScroll事件通知相关组件\r\n     */\r\n    triggerScrollEvent(): void {\r\n        if (!this.triggerScroll) {\r\n            return;\r\n        }\r\n        setTimeout(() => {\r\n            Util.trigger(this.document, 'tiScroll');\r\n        }, 0);\r\n    }\r\n\r\n    private clearTimeout(): void {\r\n        if (this.timeoutId !== undefined) {\r\n            clearTimeout(this.timeoutId);\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiAlertComponent } from './TiAlertComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiAlertComponent],\r\n  declarations: [TiAlertComponent]\r\n})\r\nexport class TiAlertModule {\r\n}\r\nexport { TiAlertComponent } from './TiAlertComponent';\r\n","import { Component, ContentChild, ElementRef, EventEmitter, HostListener, Input, NgZone, Output,\r\n    Renderer2, TemplateRef, ViewChild, SimpleChanges } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiListComponent } from '../list/TiListModule';\r\nimport { TiBrowser, TiKeymap } from '../../utils/Util';\r\nimport { Position, TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * @ignore\r\n * 下拉面板带有数组列表组件，用于aucomplete等。它有子类TiDropsearchComponent\r\n */\r\n@Component({\r\n    selector: 'ti-droplist',\r\n    templateUrl: './droplist.html',\r\n    providers: [TiFormComponent.getValueAccessor(TiDroplistComponent)]\r\n})\r\nexport class TiDroplistComponent extends TiFormComponent {\r\n\r\n    /**\r\n     * 带搜索框情况下需要去除的高度\r\n     */\r\n    // tslint:disable-next-line:binary-expression-operand-order\r\n    protected static readonly SEARCHBOX_EXCLUDE_HEIGHT: number = 28; // 下拉框中的搜索框的高度\r\n    /**\r\n     * 默认高度8条 DEFAULT_LIST_MAX_HEIGHT\r\n     */\r\n    protected defaultListMaxHeight: number = 30 * 8 + 8;\r\n    /**\r\n     * 面板中，除去list外，其它元素的占位高度\r\n     */\r\n    protected heightExcludeList: number = 2;\r\n    /**\r\n     * drop面板最大高度\r\n     */\r\n    private dropMaxHeight: number;\r\n    /**\r\n     * drop面板自定义底部高度\r\n     */\r\n     private footerHeight: number = 0;\r\n    /**\r\n     * droplist依附的元素，需要使用该元素进行droplist的定位处理\r\n     */\r\n    @Input() dominatorElem: HTMLElement;\r\n    /**\r\n     * 是否多选\r\n     */\r\n    @Input() multiple: boolean = false;\r\n    /**\r\n     * 下拉面板的最大显示宽度，该变量与下拉类组件保持一致\r\n     *\r\n     * 1.\"justified\"(默认): 下拉框的宽度与Select组件的宽度保持一致；\r\n     *\r\n     * 2.\"auto\": 下拉框的宽度根据下拉选项的内容自动撑开；\r\n     *\r\n     * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于Select组件的宽度)。例如：\"200px\"\r\n     */\r\n    @Input() panelWidth: 'justified' | 'auto' | string = 'justified';\r\n    /**\r\n     * 下拉面板的最大显示高度，溢出时则出滚动条,该变量名与下拉类组件保持一致\r\n     */\r\n    @Input() panelMaxHeight: string;\r\n    @Input() options: Array<any>;\r\n    @Input() labelKey: string = 'label';\r\n    @Input() noDataText: string = '...';\r\n    @Input() tipPosition: TiPositionType = 'right';\r\n    @Input() dominatorSpace: string = TiDropComponent.DOMINATOR_SPACE + 'px'; // 10.0.1新增\r\n    @Input() panelAlign: 'left'|'right' = 'left'; // 10.0.1新增\r\n    /**\r\n     * 内部接口，用作suggestion时type传入suggestion，默认值default\r\n     */\r\n    @Input() type: 'default' | 'suggestion' = 'default';\r\n    /**\r\n     * 大小样式，default/small. 默认值default\r\n     */\r\n    @Input() size: 'default' | 'small' = 'default';\r\n    /**\r\n     * 选中选项后面板是否保持显示， 默认值false\r\n     */\r\n    @Input() isShowAfterSelect: boolean = false;\r\n\r\n    /**\r\n     * 选中事件，向外通知option数据\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly select: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n    @ViewChild(TiDropComponent, { static: true }) dropCom: TiDropComponent;\r\n    @ViewChild(TiListComponent, { static: true }) listCom: TiListComponent;\r\n    @ViewChild('footer', { static: false }) footerElemRef: ElementRef;\r\n    /**\r\n     * 自定义list中的item的模板\r\n     */\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n    /**\r\n     * 储存donimator bottom旧值\r\n     */\r\n    private dominatorLastBottom: number = undefined;\r\n    /**\r\n     * 储存donimator left旧值\r\n     */\r\n    private dominatorLastLeft: number = undefined;\r\n\r\n    private unlistenKeydownFn: () => void;\r\n    constructor(protected render: Renderer2, hostRef: ElementRef, private zone: NgZone) {\r\n        super(hostRef, render);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始设置list高度\r\n        this.initListMaxHeight();\r\n        this.listenKeydown(this.dominatorElem);\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // dominatorElem 改变后重新添加监听\r\n        if (changes['dominatorElem'] && !changes['dominatorElem'].firstChange) {\r\n            this.unlistenKendown();\r\n            this.listenKeydown(this.dominatorElem);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        // 解除按键监听\r\n        this.unlistenKendown();\r\n        // 解除IE滚动条Bug的监听\r\n        this.listCom.unlistenIESrollbarBug();\r\n    }\r\n    /**\r\n     * 当做生命周期用吧，监听模型值变化。包括writeValue和this.model=赋值 这两个时刻。\r\n     * @param model ngModel值\r\n     */\r\n    protected ngOnModelChange(model: any): void {\r\n        super.ngOnModelChange(model);\r\n        if (!this.multiple || !this.dominatorElem) {  // 多选才会有dominator行高切换\r\n            return;\r\n        }\r\n        if (this.dominatorLastBottom === undefined && this.dominatorElem) { // 第一次只记录位置，不走进重定位逻辑\r\n            // 修复SSR错误：ERROR TypeError: this.dominatorElem.getBoundingClientRect is not a function\r\n            if(typeof this.dominatorElem.getBoundingClientRect === 'function'){\r\n                this.dominatorLastBottom = this.dominatorElem.getBoundingClientRect().bottom;\r\n                this.dominatorLastLeft = this.dominatorElem.getBoundingClientRect().left;\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        this.zone.runOutsideAngular(() => {\r\n            setTimeout(() => { // TODO：这里setTimeout能否去除？\r\n                if(!this.dominatorElem){\r\n                    return;\r\n                }\r\n                // ngModel更新（点击checkbox，或者点击叉叉号）后，dominator有可能一行/两行变换，所以更新下拉面板位置。\r\n                // 甚至donimator本身位置也会变动。（比如测试用例中元素变动，引起donimator本身变动 ???）\r\n                if (this.dominatorLastBottom !== this.dominatorElem.getBoundingClientRect().bottom ||\r\n                    this.dominatorLastLeft !== this.dominatorElem.getBoundingClientRect().left) {\r\n                    if (this.dropCom.isShow) {\r\n                        // 仅当高度变化时，重定位。\r\n                        this.rePosition();\r\n                    }\r\n                    this.dominatorLastBottom = this.dominatorElem.getBoundingClientRect().bottom;\r\n                    this.dominatorLastLeft = this.dominatorElem.getBoundingClientRect().left;\r\n                }\r\n            }, 0);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *  监听keydown\r\n     * @param focusElem 焦点元素\r\n     */\r\n    protected listenKeydown(focusElem: HTMLElement): void {\r\n        if (!focusElem) {\r\n            return;\r\n        }\r\n        this.unlistenKeydownFn = this.renderer.listen(focusElem, 'keydown',\r\n            (event: KeyboardEvent) => {\r\n                if (!this.isShow) {\r\n                    return;\r\n                }\r\n                // 10.0.2删除 KEY_SPACE 空格快捷键的响应\r\n                switch (event.keyCode) {\r\n                    case TiKeymap.KEY_ESCAPE: // Esc键，仅可关闭\r\n                    case TiKeymap.KEY_TAB: // Tab键，仅可关闭\r\n                        event.preventDefault(); // 阻止触发blurFn\r\n                        this.hide();\r\n                        break;\r\n                    case TiKeymap.KEY_ARROW_UP: // 向上箭头，上移选项\r\n                    case TiKeymap.KEY_ARROW_DOWN: // 向下箭头，下移选项\r\n                    case TiKeymap.KEY_ENTER: // ENTER键 相当于click\r\n                    case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)\r\n                        this.listCom.onKeydown(event);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                // 如果droplist响应了按键，那么就不再冒泡。\r\n                event.stopPropagation();\r\n            }\r\n        );\r\n    }\r\n    protected unlistenKendown(): void {\r\n        if (this.unlistenKeydownFn) {\r\n            this.unlistenKeydownFn();\r\n        }\r\n    }\r\n    /**\r\n     * 外部接口: 获取当前状态, 只读不写\r\n     */\r\n    public get isShow(): boolean {\r\n        return this.dropCom.isShow;\r\n    }\r\n\r\n    /**\r\n     * 打开面板\r\n     */\r\n    public show(): void {\r\n        if (!this.isShow) {\r\n            // 打开面板\r\n            // 每次打开面板前需要重置list的高度确保drop高度不受其影响\r\n            this.initListMaxHeight();\r\n            // 打开面板\r\n            this.dropCom.show();\r\n            // 根据drop的最大高度设置list的最大高度\r\n            this.restyleListMaxHeight();\r\n            this.listCom.scrollToSelected();\r\n            // IE滚动条Bug的监听\r\n            this.listCom.listenIESrollbarBug();\r\n        }\r\n    }\r\n    /**\r\n     * 关闭面板的处理\r\n     */\r\n    public hide(): void {\r\n        // this.listCom.hide(); // 隐藏时list也需要做处理：清除当前hover项状态\r\n        if (this.isShow) {\r\n            this.dropCom.hide(); // 关闭面板\r\n            // 解除IE滚动条Bug的监听\r\n            this.listCom.unlistenIESrollbarBug();\r\n        }\r\n    }\r\n    /**\r\n     * 重新设置元素位置\r\n     */\r\n    public rePosition(optionsChange?: boolean): void {\r\n        if (optionsChange) {\r\n            this.dropCom.resetPosition();\r\n        } else {\r\n            this.dropCom.setPosition();\r\n        }\r\n\r\n        this.restyleListMaxHeight();\r\n    }\r\n    /**\r\n     * 根据drop的压缩情况，设置list的max-height\r\n     */\r\n    public restyleListMaxHeight(): void {\r\n        // 计算自定义底部的高度\r\n        if (this.footerElemRef && this.footerElemRef.nativeElement) {\r\n            let rect: any = this.footerElemRef.nativeElement.getBoundingClientRect();\r\n            if (rect.height) {\r\n                this.footerHeight = rect.height;\r\n            }\r\n        }\r\n        // 如果drop被压缩，则根据drop最大高度设置当前list最大高度。\r\n        const dropCurMaxHeight: number = parseInt(this.dropCom.nativeElement.style.maxHeight, 10);\r\n        let dropMaxHeightAdapted: number = this.dropMaxHeight + this.footerHeight;\r\n        if (!isNaN(dropCurMaxHeight) && dropCurMaxHeight < dropMaxHeightAdapted) {\r\n            dropMaxHeightAdapted = dropCurMaxHeight;\r\n            const computedListMaxHeight: number = dropMaxHeightAdapted - this.heightExcludeList - this.footerHeight;\r\n            // 设置list max-height\r\n            this.renderer.setStyle(this.listCom.nativeElement, 'max-height', computedListMaxHeight + 'px');\r\n        }\r\n    }\r\n    // 初始化list最大高度\r\n    private initListMaxHeight(): void {\r\n        this.dropMaxHeight = this.panelMaxHeight ? parseInt(this.panelMaxHeight, 10) :\r\n                this.defaultListMaxHeight + this.heightExcludeList;\r\n        this.renderer.setStyle(this.listCom.nativeElement, 'max-height', (this.dropMaxHeight - this.heightExcludeList) + 'px');\r\n    }\r\n    // 鼠标或enter点击选项后，组件隐藏\r\n    public onSelect(option: any): void {\r\n        this.select.emit(option);\r\n        // nextlevel只用在省市区regionselect组件场景，选中省、市级别面板不关闭\r\n        if (!this.isShowAfterSelect && !this.multiple && !option.nextLevel) {\r\n            this.hide();\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDroplistComponent } from './TiDroplistComponent';\r\nimport { TiListModule } from '../list/TiListModule';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiListModule,\r\n    TiDropModule\r\n  ],\r\n  exports: [TiDroplistComponent],\r\n  declarations: [TiDroplistComponent]\r\n})\r\nexport class TiDroplistModule {\r\n}\r\nexport { TiDroplistComponent } from './TiDroplistComponent';\r\n","import {\r\n    Component,\r\n    DoCheck,\r\n    ElementRef,\r\n    EventEmitter,\r\n    NgZone,\r\n    OnDestroy,\r\n    OnInit,\r\n    Output,\r\n    Renderer2\r\n} from '@angular/core';\r\nimport { NgControl } from '@angular/forms';\r\nimport { TiBrowser, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiAutofocusComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * 本组件基于原生input标签进行扩展，原生input加 tiText 属性即为text组件,\r\n * 原生input的所有属性以及 Angular 的各种属性指令都可以使用。\r\n *\r\n * <example-url>../tiny3demo/#/text/text-all</example-url>\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiText]',\r\n    template: '',\r\n    styleUrls: ['text.less'],\r\n    host: {\r\n        '[class.ti3-text-input-show-icon]': 'isShowClear || isPassword',\r\n        '[class.ti3-text-input-show-clear]': 'isShowClear',\r\n        '[class.ti3-text-input-show-password]': 'isPassword',\r\n        '[class.ti3-text-input-noborder]': 'isNoBorder',\r\n        '(focus)': 'handleFocus()'\r\n    }\r\n})\r\nexport class TiTextComponent extends TiAutofocusComponent implements OnInit, DoCheck, OnDestroy {\r\n    private static readonly CLEAR_WIDTH: number = 26; // 常量，清除按钮区域宽度\r\n    private static readonly PASSWORD_WIDTH: number = 36; // 常量，眼睛按钮区域宽度\r\n    /**\r\n     * clear事件：当开启清除功能时(使用clearable属性)，点击删除按钮触发\r\n     */\r\n    @Output() readonly clear: EventEmitter<MouseEvent> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     *\r\n     * autoComplete 也使用了该变量\r\n     */\r\n    public isClearActive: boolean;\r\n    /**\r\n     * @ignore\r\n     *\r\n     * autoComplete 也使用了该变量\r\n     */\r\n    public isShowClear: boolean;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isNoBorder: boolean;\r\n    /**\r\n     * @ignore\r\n     *\r\n     * 初始获取文本框类型\r\n     */\r\n    public isPassword: boolean = false;\r\n    private isFirstFocus: boolean = true; // 是否为第一次聚焦\r\n    private hasClear: boolean = false; // 是否有清除功能\r\n    private pwdHackEle: HTMLInputElement; // 当类型为password时，动态生成放在password文本框前的input元素\r\n    private lastIsHover: boolean = undefined; // 最后一次绘制叉号的状态。\r\n    private lastDisabled: boolean = undefined; // 最后一次叉号是否禁用。\r\n    private isVisible: boolean = false; // 密码是否可见，默认不可见\r\n    private isNoEye: boolean = false; // 眼睛是否不显示，默认显示\r\n    constructor(elementRef: ElementRef, renderer: Renderer2,\r\n                private tiRenderer: TiRenderer, private formControl: NgControl, private zone: NgZone) {\r\n        super(elementRef, renderer);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.isNoEye = this.nativeElement.hasAttribute('noeye');\r\n        this.isPassword = this.nativeElement.type === 'password' && !this.isNoEye;\r\n        this.hasClear = this.nativeElement.hasAttribute('clearable') && !this.isPassword;\r\n        this.isNoBorder = this.nativeElement.hasAttribute('noborder');\r\n\r\n        // 初始化注册事件\r\n        this.initFn();\r\n        this.handlePassword();\r\n\r\n        // Chrome下输入框有时出现自动联想(该问题出现无规律可寻，比较奇怪)，\r\n        // 将其autocomplete置为off可规避此问题\r\n        // 之后firefox及IE11也出现类似问题，所以不区分浏览器差异，统一添加这层处理\r\n        if (this.nativeElement.type === 'text' && this.nativeElement.autocomplete !== 'on') {\r\n            this.renderer.setAttribute(this.nativeElement, 'autocomplete', 'off');\r\n        }\r\n\r\n        // 由于在valueChanges中监听不到动态表单中文本框的初始值\r\n        // 所以此处对初始值要做单独处理\r\n        this.controlClearShow(this.nativeElement.value);\r\n\r\n        // 文本框的值发生变化时触发\r\n        this.formControl.valueChanges.subscribe((value: any) => {\r\n            this.controlClearShow(value);\r\n        });\r\n\r\n        // 初始设置eye图标\r\n        this.controlEyeShow();\r\n    }\r\n    ngDoCheck(): void {\r\n        const disabled: boolean = this.nativeElement.disabled;\r\n        // 与上次disabled状态相同，则返回\r\n        if (this.lastDisabled === disabled) {\r\n            return;\r\n        }\r\n        // 叉号特殊处理，2）禁用\r\n        if (this.isShowClear || this.isPassword) {\r\n            if (disabled) {\r\n                this.setClearBackgroud(null);\r\n                this.lastDisabled = true;\r\n            } else { // 从禁用改为非禁用\r\n                this.setClearBackgroud(false);\r\n                this.lastDisabled = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        // 销毁组件时需要将内部生成dom也移除\r\n        if (this.pwdHackEle) {\r\n            this.renderer.removeChild(this.renderer.parentNode(this.pwdHackEle), this.pwdHackEle);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public handleFocus(): void {\r\n        // IE和火狐浏览器在首次autofoucus聚焦时会将光标移到文字起始位置，用户体验不好\r\n        // 需要手动设置光标位置到行尾\r\n        if (this.isFirstFocus && this.nativeElement.autofocus &&\r\n            (TiBrowser.isFirefox() || TiBrowser.isIE())) {\r\n            this.nativeElement.setSelectionRange(this.nativeElement.value.length,\r\n                this.nativeElement.value.length);\r\n        }\r\n        this.isFirstFocus = false;\r\n    }\r\n\r\n    private initFn(): void {\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            this.renderer.listen(this.nativeElement, 'mousemove', this.handleMousemove);\r\n            this.renderer.listen(this.nativeElement, 'mouseout', this.handleMouseout);\r\n            this.renderer.listen(this.nativeElement, 'mousedown', this.handleMousedown);\r\n            this.renderer.listen(this.nativeElement, 'click', this.handleClick);\r\n        })\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 鼠标移入清除按钮区域时，给宿主元素添加ti-text-clear-active样式\r\n     */\r\n    public handleMousemove = (event: MouseEvent): void => {\r\n        if (this.nativeElement.disabled || !this.isShowClear && !this.isPassword) {\r\n            return;\r\n        }\r\n\r\n        // 鼠标移入清除按钮区域时，给宿主元素添加ti-text-clear-active样式;\r\n        // 否则去掉ti-text-clear-active样式\r\n        this.isClearActive = this.isIconField(event);\r\n\r\n        this.isClearActive ? this.renderer.addClass(this.nativeElement, 'ti3-text-clear-active') :\r\n                             this.renderer.removeClass(this.nativeElement, 'ti3-text-clear-active');\r\n\r\n        // 密码类型只需要设置悬浮时手型样式\r\n        if (this.isPassword) {\r\n            return;\r\n        }\r\n\r\n        // 叉号特殊处理，3）hover\r\n        this.isClearActive ? this.setClearBackgroud(true) : this.setClearBackgroud(false);\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public handleMouseout = (event: MouseEvent) => {\r\n        if (this.nativeElement.disabled || !this.isShowClear) {\r\n            return;\r\n        }\r\n        // 叉号特殊处理，3）hover\r\n        this.setClearBackgroud(false);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 切换密码可见不可见时，输入框需处于失焦状态\r\n     */\r\n    public handleMousedown = (event: MouseEvent) => {\r\n        if (this.nativeElement.disabled || !this.isPassword || !this.isIconField(event)) {\r\n            return;\r\n        }\r\n\r\n        event.preventDefault();\r\n\r\n        // 聚焦到可输入区域，再点击眼睛图标时，输入框应失焦\r\n        if (document.activeElement === this.nativeElement) {\r\n            this.nativeElement.blur();\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @param isHover true标示悬浮，false标示非悬浮，null标示禁用，undefinded标示不画叉号。\r\n     * @returns\r\n     */\r\n    setClearBackgroud(isHover: boolean): void {\r\n        // 如果跟上次一样，则返回。\r\n        if (this.lastIsHover === isHover) {\r\n            return;\r\n        } else {\r\n            this.lastIsHover = isHover;\r\n        }\r\n\r\n        let colorStr: string = '';\r\n        if (Util.supportsCssVars()) {\r\n            // Chrome等支持CSSVar的浏览器，正常操作,  从CSSVar变量中取出颜色。\r\n            const varName: string =\r\n                isHover === false ? '--ti-input-clear-color' :\r\n                    isHover === true ? '--ti-input-clear-color-hover' :\r\n                        isHover === null ? '--ti-input-clear-color-disabled' : '';\r\n            // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n            if (typeof getComputedStyle !== 'undefined') {\r\n                colorStr = getComputedStyle(document.documentElement).getPropertyValue(varName);\r\n            }\r\n        } else {\r\n            // IE和低版Edge不支持CSSVar的浏览器，从一个CSS样式中取出颜色。\r\n            const styleName: string =\r\n                isHover === false ? 'flood-color' :\r\n                    isHover === true ? 'lighting-color' :\r\n                        isHover === null ? 'stop-color' : '';\r\n            // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n            if (typeof getComputedStyle !== 'undefined') {\r\n                colorStr = getComputedStyle(this.nativeElement).getPropertyValue(styleName);\r\n            }\r\n        }\r\n        colorStr = colorStr.trim().replace('#', '%23'); // URL编码\r\n        let urlStr: string;\r\n        if (this.isPassword) {\r\n            urlStr = this.isVisible ? `url(data:image/svg+xml,%3Csvg%20version=%221.1%22%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2232%22%20height=%2232%22%20viewBox=%220%200%2032%2032%22%3E%3Cpath%20fill%3D%22${colorStr}%22%20d=%22M16%206.4c9.4%200%2016%206.4%2016%209.6%200%203-6.6%209.6-16%209.6-9.2%200-16-6.4-16-9.6s6.8-9.6%2016-9.6zM16%208.2c-4.2%200-7.8%203.6-7.8%207.8%200%204.4%203.4%207.8%207.8%207.8%204.2%200%207.8-3.6%207.8-7.8%200-4.4-3.6-7.8-7.8-7.8zM16%2011c2.8%200%205%202.2%205%205s-2.2%205-5%205-5-2.2-5-5c0-2.8%202.2-5%205-5z%22%3E%3C/path%3E%3C/svg%3E%0A)` :\r\n                `url(data:image/svg+xml,%3Csvg%20version=%221.1%22%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2232%22%20height=%2232%22%3E%3Cpath%20fill%3D%22${colorStr}%22%20d=%22M1.6%202.925c0.6-0.6%201.4-0.6%201.8%200v0l25.6%2024.2c0.2%200.2%200.4%200.6%200.4%201s-0.2%200.6-0.4%201c-0.2%200.2-0.6%200.4-1%200.4s-0.8-0.2-1-0.4v0l-5-5.2c-2%200.6-4%201-6%201-9.2%200-16-6.6-16-9.8%200-1.8%202-4.6%205.4-6.6v0l-3.6-3.8c-0.6-0.4-0.6-1.2-0.2-1.8zM9%2011.725c-0.4%201-0.6%202.2-0.6%203.4%200%204.4%203.4%208%207.8%208%201.4%200%202.8-0.4%203.8-1v0l-2.4-2.4c-0.4%200.2-1%200.4-1.6%200.4-2.8%200-5-2.2-5-5%200-0.4%200-0.8%200.2-1.2v0l-2.2-2.2zM16%205.325c9.4%200%2016%206.6%2016%209.8%200%201.8-2%204.6-5.6%206.8v0l-3.4-3.2c0.6-1%200.8-2.2%200.8-3.4%200-4.4-3.4-8-7.8-8-1.4%200-2.8%200.4-4%201.2v0%200l-2-2c2-1%204-1.2%206-1.2zM16%209.925c2.8%200%205%202.2%205%205%200%200.4%200%201-0.2%201.4v0l-6.6-6c0.6-0.2%201.2-0.4%201.8-0.4z%22%3E%3C/path%3E%3C/svg%3E)`\r\n        } else {\r\n            urlStr = `url(data:image/svg+xml,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216px%22%20height%3D%2216px%22%3E%3Cpath%20fill%3D%22${colorStr}%22%20d%3D%22M12.529%2C11.469L9.061%2C8l3.469-3.469c0.294-0.294%2C0.295-0.768%2C0.001-1.062c-0.293-0.293-0.769-0.293-1.061%2C0L8%2C6.938L4.53%2C3.469c-0.292-0.293-0.767-0.293-1.061%2C0C3.177%2C3.762%2C3.177%2C4.238%2C3.471%2C4.532L6.939%2C8l-3.469%2C3.468c-0.294%2C0.293-0.294%2C0.768-0.001%2C1.062C3.616%2C12.678%2C3.81%2C12.75%2C4%2C12.75s0.384-0.072%2C0.53-0.219L8%2C9.062l3.47%2C3.469c0.147%2C0.146%2C0.339%2C0.219%2C0.53%2C0.219c0.192%2C0%2C0.384-0.072%2C0.53-0.219C12.823%2C12.236%2C12.824%2C11.762%2C12.529%2C11.469z%22%2F%3E%3C%2Fsvg%3E)`;\r\n        }\r\n        this.renderer.setStyle(this.nativeElement, 'backgroundImage', urlStr);\r\n    }\r\n\r\n    /**\r\n     *  @ignore\r\n     * 当在清除按钮区域点击时，清空输入框内容\r\n     */\r\n    public handleClick = (event: MouseEvent) =>{\r\n        if (this.nativeElement.disabled || !this.isShowClear && !this.isPassword || !this.isIconField(event)) {\r\n            return;\r\n        }\r\n\r\n        if (this.isShowClear) {\r\n            this.renderer.setProperty(this.nativeElement, 'value', '');\r\n            Util.trigger(this.nativeElement, 'input');\r\n            this.zone.run(() => {\r\n                this.clear.emit(event);\r\n            })\r\n            // 点击清除按钮后延时才能聚焦元素\r\n            setTimeout(() => {\r\n                this.nativeElement.focus();\r\n            }, 0);\r\n        }\r\n\r\n        if (this.isPassword) {\r\n            this.isVisible = !this.isVisible;\r\n            this.lastIsHover = undefined;\r\n            this.controlEyeShow();\r\n        }\r\n    }\r\n\r\n    private handlePassword(): void {\r\n        // 密码框情况下，默认关闭autocomplete，避免浏览器弹出记住密码提示框引起的安全问题\r\n        if (TiBrowser.isChrome() && this.nativeElement.type === 'password' &&\r\n            this.nativeElement.autocomplete !== 'on') {\r\n            this.pwdHackEle = this.renderer.createElement('input');\r\n            this.tiRenderer.setAttributes(this.pwdHackEle, { type: 'text', tabindex: -1, autocomplete: 'off' });\r\n            this.renderer.addClass(this.pwdHackEle, 'ti3-password-hack-input');\r\n            // 插入一个input元素，阻止密码框前面的input联想用户名\r\n            this.renderer.insertBefore(this.nativeElement.parentElement, this.pwdHackEle, this.nativeElement);\r\n        }\r\n    }\r\n\r\n    // 控制clear是否显示，文本框为空时不显示，有内容时才显示\r\n    private controlClearShow(value: any): void {\r\n        if (!this.hasClear) {\r\n            return;\r\n        }\r\n        const lastIsShowClear: boolean = this.isShowClear;\r\n        this.isShowClear = (Util.isString(value) && value !== '');\r\n        // 与上次状态相同，则返回\r\n        if (this.isShowClear === lastIsShowClear) {\r\n            return;\r\n        }\r\n\r\n        // 叉号特殊处理，1)初始化和监听是否显示\r\n        if (this.isShowClear) {\r\n            this.setClearBackgroud(false);\r\n        } else {\r\n            this.renderer.removeStyle(this.nativeElement, 'background');\r\n            this.lastIsHover = undefined;\r\n        }\r\n    }\r\n\r\n    // 控制eye是否显示，\r\n    private controlEyeShow(): void {\r\n        if (!this.isPassword) {\r\n            return;\r\n        }\r\n        this.setClearBackgroud(false);\r\n        this.nativeElement.type = this.isVisible ? 'text' : 'password';\r\n    }\r\n\r\n    // 判断事件是否在清除按钮区域\r\n    private isIconField(event: MouseEvent): boolean {\r\n        const iconWidth: number = this.isPassword ? TiTextComponent.PASSWORD_WIDTH : TiTextComponent.CLEAR_WIDTH;\r\n\r\n        return event.clientX - this.nativeElement.getBoundingClientRect().left >\r\n            this.nativeElement.getBoundingClientRect().width - iconWidth;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTextComponent } from './TiTextComponent';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiRendererModule\r\n  ],\r\n  exports: [ TiTextComponent ],\r\n  declarations: [ TiTextComponent ]\r\n})\r\n\r\nexport class TiTextModule {\r\n}\r\nexport { TiTextComponent } from './TiTextComponent';\r\n","import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDroplistComponent } from '../droplist/TiDroplistModule';\r\nimport { debounceTime, switchMap } from 'rxjs/operators';\r\nimport { TiTextComponent } from '../text/TiTextModule';\r\nimport { empty, Subject, Subscription } from 'rxjs';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * 自动补全输入框组件\r\n *\r\n * <example-url>../tiny3demo/#/autocomplete/autocomplete-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-autocomplete',\r\n    templateUrl: './autocomplete.html',\r\n    styleUrls: ['./autocomplete.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiAutocompleteComponent)],\r\n    host: {\r\n        '[class.ti3-autocomplete-container]': 'true',\r\n        '(blur)': 'onBlur()',\r\n        '(focus)': 'onFocus()'\r\n    }\r\n})\r\nexport class TiAutocompleteComponent extends TiFormComponent {\r\n    /**\r\n     * 预留提示文本\r\n     */\r\n    @Input() placeholder: string = '';\r\n    /**\r\n     * 是否开启清空输入框内容的功能\r\n     *\r\n     * 10.1.0/9.1.0版本之后默认不开启，在此之前版本默认开启\r\n     */\r\n    @Input() clearable: boolean = false;\r\n    /**\r\n     * 文本最大显示长度\r\n     */\r\n    @Input() maxlength: number;\r\n    /**\r\n     * 1.\"justified\"(默认): 下拉框的宽度与输入框的宽度保持一致；\r\n     *\r\n     * 2.\"auto\": 下拉框的宽度根据下拉项的内容自动撑开；\r\n     *\r\n     * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于输入框的宽度)。例如：\"200px\"。\r\n     */\r\n    @Input() panelWidth: string = 'justified';\r\n    /**\r\n     * 面板最大高度\r\n     */\r\n    @Input() panelMaxHeight: string;\r\n    /**\r\n     * 指定下拉建议项中显示的文本对应的字段关键字\r\n     */\r\n    @Input() labelKey: string = 'label';\r\n    /**\r\n     * 10.0.1版本新增\r\n     *\r\n     * 下拉建议项\r\n     */\r\n    @Input() options: Array<any> = [];\r\n    /**\r\n     * 10.0.2版本新增\r\n     *\r\n     * 下拉建议项文字超长显示...，hover时tip弹出方向\r\n     */\r\n    @Input() tipPosition: TiPositionType = 'right';\r\n    /**\r\n     * suggest事件，当聚焦或值改变时触发事件，为开发者提供设置建议项的时机。\r\n     *\r\n     * 参数：组件实例\r\n     */\r\n    @Output() readonly suggest: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * clear事件，点击清除按钮时触发\r\n     *\r\n     * 10.0.2版本新增(tiAutocomplete组件)\r\n     *\r\n     * 3.0.6版本新增(tiSearchbox组件)\r\n     *\r\n     */\r\n    @Output() readonly clear: EventEmitter<MouseEvent> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     * droplist选项值\r\n     */\r\n    public selected: any;\r\n    /**\r\n     * @ignore\r\n     *\r\n     */\r\n    public suggestions: Array<any> = [];\r\n    /**\r\n     * @ignore\r\n     * 是否聚焦的标志位\r\n     */\r\n    public isFocused: boolean = false;\r\n    /**\r\n     * 最后一次下拉建议项\r\n     */\r\n    private lastSuggestions: Array<any> = [];\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('input', { static: true }) textComp: TiTextComponent;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('droplist', { static: false }) dropListComp: TiDroplistComponent;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public inputChangeObserve: Subject<string> = new Subject();\r\n    private inputChangeSub: Subscription;\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.setFocusableElems([this.textComp.nativeElement]);\r\n        this.createInputChangeObserve();\r\n        if (this.clearable) {\r\n            this.renderer.setAttribute(this.textComp.nativeElement, 'clearable', '');\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        // 修正SSR报错：TypeError: Cannot read property 'unsubscribe' of undefined\r\n        this.inputChangeSub && this.inputChangeSub.unsubscribe();\r\n    }\r\n\r\n    // 组件交互方法集合--start\r\n    /**\r\n     * @ignore\r\n     * 输入框中内容改变事件\r\n     */\r\n    public onInputChange(value: string): void {\r\n        if (this.disabled || !this.isFocused) {\r\n            return;\r\n        }\r\n\r\n        this.inputChangeObserve.next(value);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 两种情况下触发\r\n     * 1.在suggestion面板展开的情况下，通过hover选中一项，然后按下enter\r\n     * 2.在suggestion面板展开的情况下，通过鼠标点击选中一项\r\n     */\r\n    public onDroplistChange(value: { label?: string }): void {\r\n        if (value) {\r\n            this.model = value[this.labelKey] || value.label;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onFocus(): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        this.isFocused = true;\r\n        if (this.isInputClear()) { // 如果是点击清除按钮，值会改变，那么就会在onInputChange中处理\r\n            return;\r\n        }\r\n\r\n        this.showSuggestions();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onBlur(): void {\r\n        this.dropListComp && this.dropListComp.hide();\r\n        this.isFocused = false;\r\n    }\r\n    /**\r\n     * @ignore\r\n     *\r\n     * 避免滚动页面下拉框隐藏之后组件仍聚焦时再次点击，下拉框无法展开\r\n     *\r\n     * mousedown在focus事件之前执行\r\n     */\r\n    public onInputMousedown(): void {\r\n        if (this.disabled || !this.isFocused || this.isInputClear()) { // 如果是点击清除按钮，值会改变，那么就会在onInputChange中处理\r\n            return;\r\n        }\r\n\r\n        this.showSuggestions();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击叉号时触发\r\n     *\r\n     */\r\n    onClear(event: MouseEvent): void {\r\n        this.clear.emit(event);\r\n    }\r\n    // 组件交互方法集合--end\r\n\r\n    // 内部公共方法集合--start\r\n    /**\r\n     * @description: 创建inputValue的observable，确保收集2ms内的数据后再更新下拉\r\n     *  触发该observable时，使用next方法\r\n     */\r\n    private createInputChangeObserve(): void {\r\n        this.inputChangeSub = this.inputChangeObserve\r\n            .pipe(\r\n                debounceTime(200), // 200ms延迟执行，解决请求太频繁问题\r\n                // TODO: 在点击清除按钮或者快捷键删除时数据不准确，可能导致在这些操作时触发不了下面的逻辑\r\n                // distinctUntilChanged(),避免前后两次相同数据重复处理，只有上次数据和200ms后的数据不相等时才触发后续动作。\r\n                switchMap(// TODO: 这个switchMap有可能没有生效。测试用例增加，switchMap\r\n                    (value: string) => {\r\n                        if (this.isFocused) {\r\n                            if (this.suggest.observers.length === 0) {\r\n                                this.lastSuggestions = this.suggestions;\r\n                                this.suggestions = this.filter(value);\r\n                                if (this.suggestions.length > 0) {\r\n                                    this.show();\r\n                                } else {\r\n                                    this.dropListComp && this.dropListComp.hide();\r\n                                }\r\n                            } else {\r\n                                this.suggest.emit(this);\r\n                            }\r\n\r\n                        }\r\n\r\n                        return empty();\r\n                    }\r\n                )\r\n            )\r\n            .subscribe(\r\n            );\r\n    }\r\n    /**\r\n     * 设置下拉建议项数据\r\n     *\r\n     * @param value 下拉建议项数组\r\n     */\r\n    public setSuggestions(value: Array<any>): void {\r\n        this.lastSuggestions = this.suggestions;\r\n        this.suggestions = value;\r\n        if (this.suggestions.length > 0) {\r\n            this.show();\r\n        } else {\r\n            this.dropListComp.hide();\r\n        }\r\n    }\r\n\r\n    private filter(searchWord: string): Array<any> {\r\n        if (this.options && this.options.length >= 0) {\r\n            // 搜索结果临时值。结果默认值，是原数据\r\n            let searchResult: Array<any> = this.options;\r\n            // 如果搜索词存在\r\n            if (!Util.isEmptyString(searchWord)) {\r\n                // 在集合中搜索\r\n                searchResult = searchResult.filter((option: any) => {\r\n                    return option[this.labelKey].toLowerCase()\r\n                        .indexOf(searchWord.toLowerCase()) >= 0;\r\n\r\n                });\r\n            }\r\n\r\n            return searchResult;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    private show(): void {\r\n        if (this.dropListComp.isShow) {\r\n            // 搜索时，按需重新定位\r\n            if (this.lastSuggestions.length !== this.suggestions.length) {\r\n                setTimeout(() => {\r\n                    this.dropListComp.rePosition(true);\r\n                }, 0);\r\n            }\r\n        } else {\r\n             // 数据更新后，未及时通知到droplist，初始化时按照默认值[]绘制视图，需延时处理\r\n             setTimeout(() => {\r\n                 this.dropListComp.show();\r\n                 this.selected = undefined; // 为了去掉选中样式\r\n                 this.dropListComp.listCom.hoverOption = undefined; // 去掉hoverOption\r\n        }, 0);\r\n        }\r\n    }\r\n\r\n    private isInputClear(): boolean {\r\n        return this.textComp.isShowClear && this.textComp.isClearActive;\r\n    }\r\n\r\n    private showSuggestions(): void {\r\n        if (this.suggest.observers.length === 0) {\r\n            this.lastSuggestions = this.suggestions;\r\n            this.suggestions = this.filter(this.model);\r\n            if (this.suggestions.length > 0) {\r\n                this.show();\r\n            }\r\n        } else {\r\n            this.suggest.emit(this);\r\n        }\r\n    }\r\n    // 内部公共方法集合--end\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDroplistModule } from '../droplist/TiDroplistModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiAutocompleteComponent } from './TiAutocompleteComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDroplistModule,\r\n    TiTextModule\r\n  ],\r\n  exports: [TiAutocompleteComponent],\r\n  declarations: [TiAutocompleteComponent]\r\n})\r\nexport class TiAutocompleteModule {\r\n}\r\n\r\nexport { TiAutocompleteComponent } from './TiAutocompleteComponent';\r\n","import {\r\n    AfterViewChecked,\r\n    ChangeDetectorRef,\r\n    Component,\r\n    ContentChild,\r\n    ElementRef,\r\n    Input,\r\n    IterableChanges,\r\n    IterableDiffer,\r\n    IterableDiffers,\r\n    OnInit,\r\n    QueryList,\r\n    Renderer2,\r\n    TemplateRef,\r\n    ViewChildren\r\n} from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiFormComponent, TiWholeComponent } from '../base/TiBaseModule';\r\n// TODO: 标签命名不规范，TiButtongroup应该对应到ti-buttongroup\r\n/**\r\n * 按钮组组件：每个按钮的属性配置\r\n */\r\nexport interface TiButtonItem {\r\n    /**\r\n     * 按钮文本显示\r\n     */\r\n    text?: string;\r\n    /**\r\n     * 设置按钮状态\r\n     */\r\n    disabled?: boolean;\r\n    /**\r\n     * 设置tip内容，类型为文本、TemplateRef或组件\r\n     */\r\n    tipContent?: string| TemplateRef<any> | any;\r\n    /**\r\n     * 设置tip显示方向，\r\n     */\r\n    tipPosition?: string;\r\n    /**\r\n     * 设置按钮标志类型：\r\n     *\r\n     * 对象类型，包含两个属性:1.text: 显示的文本；2.class:标志的样式；eg:{text: string; class: string}\r\n     *\r\n     * 10.1.2版本之后可自定义模板，设置按钮标志样式\r\n     */\r\n    sup?: {\r\n            text?: string;\r\n            class?: string;\r\n            /**\r\n             * 允许有多余的属性字段\r\n             */\r\n            [propName: string]: any;\r\n        };\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * buttonGroup选择按钮组组件\r\n *\r\n * 该组件支持单选、多选两种形式，显示内容支持用户自定义\r\n *\r\n * 单选块：用户要从一个数据集中选择单个选项。\r\n * 分大尺寸，小尺寸，无边框三种类型。\r\n * 支持可取消选中，默认选中时再次点击不取消当前选中项；\r\n *\r\n * 多选块：允许用户从一个数据集中选择多个选项。\r\n * 分大尺寸，小尺寸两种类型。\r\n *\r\n * <example-url>../tiny3demo/#/buttongroup/buttongroup-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-button-group',\r\n    templateUrl: './buttongroup.html',\r\n    styleUrls: ['./buttongroup.less'],\r\n    host: {\r\n        '[class.ti3-button-group-bottom-space]': 'multiline'\r\n    },\r\n    providers: [TiFormComponent.getValueAccessor(TiButtongroupComponent)]\r\n})\r\nexport class TiButtongroupComponent extends TiWholeComponent {\r\n    /**\r\n     * 按钮组属性配置，为数组形式，数组中每一项为一个按钮的属性配置，为对象形式：\r\n     */\r\n    @Input() items: Array<TiButtonItem>;\r\n    /**\r\n     * 激活状态项样式类定义\r\n     */\r\n    @Input() activeClass: string;\r\n    /**\r\n     * 设置单个按钮最小宽度\r\n     */\r\n    @Input() minWidth: string;\r\n    /**\r\n     * 用来控制按钮的尺寸大小:默认是large\r\n     *\r\n     * 单选按钮有大小尺寸、无边框之分：取值 'large','small','noBorder'\r\n     *\r\n     * 多选按钮有空间充足，空间不足之分：取值 'large','small',\r\n     */\r\n    @Input() type: string = 'large';\r\n    /**\r\n     * 设置是否为多选按钮组\r\n     */\r\n    @Input() multiple: boolean = false;\r\n    // TODO:Tiny4 deselectable改为unselectable\r\n    /**\r\n     * 设置单选按钮组是否可以取消选中\r\n     */\r\n    @Input() deselectable: boolean = false;\r\n    /**\r\n     * 10.0.2新增\r\n     *\r\n     * 按钮是否为多行，设置为多行时，按钮块有下边距，否则没有。\r\n     */\r\n    /**\r\n     * 用于取代公共样式类ti3-button-group-bottom-space\r\n     * <ti-button-group class=\"ti3-button-group-bottom-space\"></ti-button-group>\r\n     */\r\n    @Input() multiline: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 获取到用户自定义的模板\r\n     */\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) firstTemplate: TemplateRef<any>;\r\n    @ContentChild('item', /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>; // 自定义 item 模板\r\n    @ContentChild('sup', /* TODO: add static flag */ { static: true }) supTemplate: TemplateRef<any>; // 自定义按钮标志模板\r\n    /**\r\n     * @ignore\r\n     * 获取每个按钮\r\n     */\r\n    @ViewChildren('btn') btns: QueryList<ElementRef>;\r\n    /**\r\n     * @ignore\r\n     * 绑在模板上用户自定义激活样式\r\n     */\r\n    public actClass: string;\r\n    private itemsDiffer: IterableDiffer<TiButtonItem>;\r\n    constructor(protected elementRef: ElementRef,\r\n                protected renderer2: Renderer2,\r\n                protected changeDetectorRef: ChangeDetectorRef,\r\n                private iterableDiffers: IterableDiffers) {\r\n                super(elementRef, renderer2);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 处理激活样式\r\n        this.actClass = this.activeClass || 'ti3-active';\r\n        this.itemsDiffer = this.iterableDiffers.find(this.items || [])\r\n            .create();\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        const itemsDiffer: IterableChanges<TiButtonItem> = this.itemsDiffer.diff(this.items || []);\r\n        if (itemsDiffer) {\r\n            const focusElements: Array<any> = [];\r\n            this.btns.forEach((item: ElementRef) => {\r\n                focusElements.push(item.nativeElement);\r\n            });\r\n            this.setFocusableElems(focusElements);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 兼容旧版：\r\n     * 10.1.2 版本之前只能内嵌一个模板，无命名。\r\n     * 新版可以内嵌两个模板，示例书写要求都命名（#item，#sup）。\r\n     * 但需要兼容旧版无命名测试用例。\r\n     */\r\n    ngAfterContentInit(): void {\r\n        super.ngAfterContentInit();\r\n        // 如果 item 模板为空 && 存在第一个模板，那么把第一个出现的 “非 #sup 标签” 的模板作为 item 模板\r\n        if (!this.itemTemplate && this.firstTemplate\r\n            && (this.firstTemplate.elementRef.nativeElement !== (this.supTemplate && this.supTemplate.elementRef.nativeElement))) {\r\n            this.itemTemplate = this.firstTemplate;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * sup属性存在class类或text存在且有效\r\n     */\r\n    public isSuperScript(item: TiButtonItem): boolean {\r\n        return item.sup && (item.sup.constructor === Object) &&\r\n        ((Util.isString(item.sup.class) && item.sup.class !== '') ||\r\n        (Util.isString(item.sup.text) && item.sup.text !== ''));\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 根据selectedId来设置每个按钮的样式\r\n     * @param: item\r\n     */\r\n    public setActiveClass(item: string): string {\r\n        if (this.hasSelected(item)) {\r\n            return this.actClass;\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 每个item上的点击事件\r\n     */\r\n    public onClick(item: TiButtonItem): void {\r\n        if (item.disabled || this.disabled) { // 灰化状态下 ，点击操作无效\r\n            return;\r\n        }\r\n\r\n        this.selectItem(item);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 每个item上的点击事件\r\n     */\r\n    private selectItem(item: TiButtonItem): void {\r\n        if (this.multiple) {\r\n            if (Util.isUndefined(this.modelWhole)) {\r\n                this.modelWhole = [item];\r\n            } else {\r\n                const index: number = this.modelWhole.indexOf(item);\r\n                if (index !== -1) { // 如果存在，则将其移除\r\n                    this.modelWhole.splice(index, 1);\r\n                } else { // 先前未选中情况下，勾选\r\n                    this.modelWhole.push(item);\r\n                }\r\n                // selectedId是引用类型，内容改变不会触发modelchange，故需改变引用地址\r\n                this.modelWhole = this.modelWhole.concat();\r\n            }\r\n        } else {\r\n            this.modelWhole = (Object.is(item, this.modelWhole) && this.deselectable) ? '' : item;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 判断是不是选中项\r\n     */\r\n    private hasSelected(item: string): boolean {\r\n        if (Util.isUndefined(this.modelWhole) || Util.isNull(this.modelWhole)) {\r\n            return;\r\n        }\r\n\r\n        if (this.multiple) {\r\n            return this.modelWhole.indexOf(item) !== -1;\r\n        } else {\r\n            return Object.is(item, this.modelWhole) ;\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n\r\nimport { TiButtongroupComponent } from './TiButtongroupComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiTipModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [\r\n    TiButtongroupComponent\r\n  ],\r\n  declarations: [\r\n    TiButtongroupComponent\r\n  ]\r\n})\r\nexport class TiButtongroupModule {\r\n\r\n}\r\nexport { TiButtongroupComponent, TiButtonItem } from './TiButtongroupComponent';\r\n","import { Component, HostListener, ViewEncapsulation } from '@angular/core';\r\nimport { TiRadioBaseComponent } from '../base/TiBaseModule';\r\nimport { TiBrowser, TiLog, Util } from '../../utils/Util';\r\n\r\n/**\r\n * Checkbox组件，尽管这是一个组件，但使用方法有点像属性指令。主要功能为设置某一条件是否被选中。\r\n *\r\n * Checkbox组件完全基于原生input checkbox实现，\r\n *\r\n * 可以使用Angular针对原生Checkbox提供的所有指令，包括：disabled, model, click等，\r\n *\r\n * 但是要记得在input中添加TinyUI提供的tiCheckbox属性。\r\n *\r\n * <example-url>../tiny3demo/#/checkbox/checkbox-all</example-url>\r\n */\r\n@Component({\r\n      // tslint:disable-next-line:component-selector\r\n      selector: '[tiCheckbox]',\r\n      templateUrl: './checkbox.html',\r\n      styleUrls: ['./checkbox.less']\r\n})\r\nexport class TiCheckboxComponent extends TiRadioBaseComponent {\r\n    /**\r\n     * 问题一：浏览器兼容性问题：用angular提供的indeterminate属性设置半选，在谷歌下全部正常显示。\r\n     * 在火狐和IE下，checked=true 和indeterminate=true同时存在时，半选样式存在问题，不知道是否和tiny组件的css样式写法有关。\r\n     * 为了统一逻辑和预测，checkgroup和tree组件内部本应该这样使用：置indeterminate=true时，同时会置checked = false\r\n     * 但是，暂时tree组件没有这样做，由TiCheckboxComponent来纠错。\r\n     * TiCheckboxComponent补充效果：tree组件/业务用户，置indeterminate=true时，组件自身会置checked = false\r\n     * 问题二：浏览器兼容性问题：Chrome/Firefox半选点击后变为全选，checked状态改变。IE半选点击后变为不选，checked状态未改变，所以没有通知change事件。\r\n     * 但checkgroup需要change事件去维护子选项\r\n     * TiCheckboxComponent IE补充效果：监听IE的click，当indeterminate从true变为false时，组件会置checked = false，并通知change事件。\r\n     */\r\n    private lastIndeterminate: boolean = undefined;\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        // 补充效果：tree组件/业务用户，置indeterminate=true时，组件自身会置checked = false\r\n        if (this.nativeElement.indeterminate) {\r\n            this.nativeElement.checked = false;\r\n        }\r\n        this.lastIndeterminate = this.nativeElement.indeterminate;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * IE补充效果：监听IE的click，当indeterminate从true变为false时，组件会置checked = false，并通知change事件。\r\n     */\r\n    @HostListener('click', ['$event']) public onHostClick(event: MouseEvent): void {\r\n        if (TiBrowser.isIE() && this.lastIndeterminate && !this.nativeElement.indeterminate) {\r\n            this.checked(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 设置checked属性，indeterminate，同时可能触发change事件。\r\n     * 以后可以考虑开放这个接口，给用户调用\r\n     * @protected\r\n     * @param checked true/false/半选   半选用'indeterminate'或null\r\n     */\r\n    protected checked(checked: boolean|'indeterminate'): void {\r\n\r\n        const lastChecked: boolean = this.nativeElement.checked;\r\n        const lastIndeterminate: boolean = (this.nativeElement.indeterminate === true) ? true : false; // 将undefined也转为false。\r\n        switch (checked) {\r\n            case true: // 全选\r\n                this.nativeElement.checked = true;\r\n                this.nativeElement.indeterminate = false;\r\n                break;\r\n            case false: // 全不选\r\n                this.nativeElement.checked = false;\r\n                this.nativeElement.indeterminate = false;\r\n                break;\r\n            case null: // 半选\r\n            case 'indeterminate': // 半选\r\n                this.nativeElement.checked = false; // TODO: 为了保证IE下点击半选后，变为全选，这里设false。未验证。\r\n                this.nativeElement.indeterminate = true;\r\n                break;\r\n            default: // 不会走到这里。\r\n                TiLog.error('setChecked(),switch default, can not reach code');\r\n                break;\r\n        }\r\n        // indeterminate初始时为undefined。\r\n        if (this.nativeElement.checked !== lastChecked || this.nativeElement.indeterminate !== lastIndeterminate) {\r\n            Util.trigger(this.nativeElement, 'change'); // 必须主动触发change事件，否则ngModel不更新。也走不到change回调。\r\n        }\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { TiCheckboxComponent } from './TiCheckboxComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n@NgModule({\r\n  imports: [\r\n    TiIconModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiCheckboxComponent],\r\n  declarations: [TiCheckboxComponent]\r\n})\r\nexport class TiCheckboxModule {\r\n}\r\nexport { TiCheckboxComponent } from './TiCheckboxComponent';\r\n","import { Component, ElementRef, HostListener, Input, IterableDiffer, IterableDiffers,\r\n     Renderer2, SimpleChanges } from '@angular/core';\r\nimport { TiCheckboxComponent } from '../checkbox/TiCheckboxModule';\r\nimport { ObservableMap, ObservableSet, Util } from '../../utils/Util';\r\n\r\n/**\r\n * Checkitem多选选项组件，尽管这是一个组件，使用时像属性指令。\r\n *\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiCheckitem]',\r\n    templateUrl: '../checkbox/checkbox.html',\r\n    styleUrls: ['../checkbox/checkbox.less'],\r\n    // tslint:disable-next-line:use-host-property-decorator\r\n    host: {\r\n        'tiCheckbox': '' // 给宿主元素添加tiCheckbox属性，实现定制样式\r\n    }\r\n})\r\nexport class TiCheckitemComponent extends TiCheckboxComponent {\r\n\r\n    /**\r\n     * @ignore\r\n     * 全局item数据(多个group的item都在这里)\r\n     */\r\n    public static globeCheckedMap: ObservableMap = new ObservableMap();\r\n    /**\r\n     * @ignore\r\n     * 全局灰化禁用数据(多个group的item都在这里)\r\n     */\r\n    public static globeDisabledSet: ObservableSet = new ObservableSet();\r\n    /**\r\n     * 选择框item数据，item引用也是身份标示。\r\n     */\r\n    @Input() item: any;\r\n    /**\r\n     * 当存在valueKey时，选中值基于valueKey\r\n     * 10.0.4版本新增\r\n     */\r\n    @Input() valueKey: string;\r\n    /**\r\n     * 可选属性，当没有全选按钮，也要获得一组选中项时, 用来绑定已选中数据集。\r\n     */\r\n    @Input() beCheckeds: Set<any>|Array<any>;\r\n    private beCheckedSet: ObservableSet; // 用于存储选中的数据项。如果未配置valueKey，则存储的是整个数据项；如果指定valueKey，则存储的值基于选中项。\r\n    private beCheckedsDiffer: IterableDiffer<any>;\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2, protected iterableDiffers: IterableDiffers) {\r\n        // 是因为group item两个子类都用到differs，所以放在父类这里。\r\n        super(hostRef, renderer);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 监听change事件，会多触发一次DoCheck。 //TODO: 不让这条HostListener('change', ['$event'])在文档显示\r\n     * @param checked\r\n     * @returns\r\n     */\r\n    @HostListener('change', ['$event']) public onHostChange(checked: any): void {\r\n        // item checked同步到globeCheckedSet\r\n        if (!this.item) {\r\n            return;\r\n        }\r\n\r\n        this.nativeElement.checked ?\r\n            TiCheckitemComponent.globeCheckedMap.set(this.item, true, this) :\r\n            this.nativeElement.indeterminate ?\r\n                TiCheckitemComponent.globeCheckedMap.set(this.item, null, this) :\r\n                TiCheckitemComponent.globeCheckedMap.set(this.item, false, this);\r\n        // item checked同步到beCheckedSet\r\n        if (this.beCheckedSet) {\r\n            const value: any = this.getValue(this.item);\r\n            this.nativeElement.checked ? this.beCheckedSet.add(value) : this.beCheckedSet.delete(value);\r\n        }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.initBeCheckedSet();\r\n        if (!this.item) { // 用户忘了设定，或者继承的子类无需设定\r\n            return;\r\n        }\r\n        this.initGlobeCheckedSetItem();\r\n        this.setCheckedItem();\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // 外部直接给item重新赋值了。\r\n        if (changes['item'] && !changes['item'].isFirstChange()) {\r\n            // 删除已使用的静态资源。当然，这里有可能误删除。因为此item还在别处使用。   全选按钮那里，有纠正机制。\r\n            this. deleteGlobeRef(changes['item'].previousValue);\r\n            // 添加新的资源\r\n            this.setCheckedItem();\r\n            // 重新设置disabled\r\n            this.setDisabledStateGlobe();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        // 删除已使用的静态资源\r\n        this. deleteGlobeRef(this.item);\r\n        // 解除监听\r\n        TiCheckitemComponent.globeCheckedMap.removeObserver(this.globeCheckedMapObserverItemFn);\r\n    }\r\n\r\n    // 删除已使用的静态资源\r\n    private deleteGlobeRef(item: any): void {\r\n        TiCheckitemComponent.globeCheckedMap.delete(this.item);\r\n        TiCheckitemComponent.globeDisabledSet.delete(this.item);\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        super.ngDoCheck();\r\n        if (!this.beCheckedSet) {\r\n            return;\r\n        }\r\n        const beCheckedsChanges = this.beCheckedsDiffer.diff(this.beCheckeds);\r\n        if (beCheckedsChanges) {// beCheckeds同步到beCheckedSet\r\n            beCheckedsChanges.forEachAddedItem(\r\n                record => {\r\n                    this.beCheckedSet.add(record.item);\r\n                }\r\n            );\r\n            beCheckedsChanges.forEachRemovedItem(\r\n                record => {\r\n                    this.beCheckedSet.delete(record.item);\r\n                }\r\n            );\r\n        }\r\n    }\r\n    private initBeCheckedSet(): void {\r\n        if (!this.beCheckeds) {\r\n            return;\r\n        }\r\n        this.beCheckedsDiffer = this.iterableDiffers.find(this.beCheckeds).create(null);\r\n        this.beCheckedSet = new ObservableSet(this.beCheckeds); // TODO:写共用的Array/Set转Set\r\n        this.beCheckedSet.addObserver(\r\n            (item: any, isAdd: boolean) => {\r\n                // beCheckedSet的变化同步到beCheckeds\r\n                if (this.beCheckeds instanceof Set) {\r\n                    isAdd ? this.beCheckeds.add(item) : this.beCheckeds.delete(item);\r\n                } else if (this.beCheckeds instanceof Array) { // TODO:写公用的Array remove函数\r\n                    const index: number = this.beCheckeds.indexOf(item);\r\n                    if (isAdd && index === -1) {\r\n                        this.beCheckeds.push(item);\r\n                    } else if (!isAdd && index !== -1) {\r\n                        this.beCheckeds.splice(index, 1);\r\n                    }\r\n                }\r\n                // checkedSet通知到item checked\r\n                this.setCheckedItem();\r\n            }\r\n        );\r\n    }\r\n    /**\r\n     * globeCheckedSet同步到item checked\r\n     */\r\n    private initGlobeCheckedSetItem(): void {\r\n        // 初始化时，不往globeCheckedSet放值，是因为group优先级更高。\r\n        TiCheckitemComponent.globeCheckedMap.addObserver(this.globeCheckedMapObserverItemFn);\r\n    }\r\n\r\n    private globeCheckedMapObserverItemFn =  (item: any, value: any, isAdd: boolean , from: any) => {\r\n        if (from !== this && item === this.item && isAdd) {\r\n            // 从全局同步过来的，可能是半选\r\n            const lastChecked = this.nativeElement.checked;\r\n            const lastIndeterminate = (this.nativeElement.indeterminate === true) ? true : false; // 将undefined也转为false。\r\n            this.nativeElement.checked = (value === true);\r\n            this.nativeElement.indeterminate = (value === null);\r\n            if (this.nativeElement.checked !== lastChecked || this.nativeElement.indeterminate !== lastIndeterminate) {\r\n                Util.trigger(this.nativeElement, 'change'); // 必须主动触发change事件，否则ngModel不更新。\r\n            }\r\n        }\r\n    }\r\n    private setCheckedItem(): void {\r\n        if (!this.item) {\r\n            return;\r\n        }\r\n        const lastChecked: boolean = this.nativeElement.checked;\r\n        const value: any = this.getValue(this.item);\r\n        // 如果beCheckeds存在，优先级更高，以beCheckeds为准。\r\n        this.nativeElement.checked = this.beCheckedSet ? this.beCheckedSet.has(value) : TiCheckitemComponent.globeCheckedMap.get(this.item);\r\n        // 这里应该不用考虑半选吧？\r\n        if (this.nativeElement.checked !== lastChecked) {\r\n            Util.trigger(this.nativeElement, 'change'); // 必须主动触发change事件，否则ngModel不更新。\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    setDisabledState?(isDisabled: boolean): void {\r\n        super.setDisabledState(isDisabled);\r\n        this.setDisabledStateGlobe();\r\n    }\r\n\r\n    private setDisabledStateGlobe(): void {\r\n        this.nativeElement.disabled ? TiCheckitemComponent.globeDisabledSet.add(this.item)\r\n            : TiCheckitemComponent.globeDisabledSet.delete(this.item);\r\n    }\r\n    /**\r\n     * 输入：某个数据项\r\n     * 输出：当有valueKey,返回值基于valueKey；当没有valueKey时，返回输入值\r\n     */\r\n    protected getValue(item: any): any {\r\n        return this.valueKey ? item[this.valueKey] : item;\r\n    }\r\n}\r\n","import { Component, EventEmitter, HostListener, Input, IterableDiffer, Output, ViewEncapsulation } from '@angular/core';\r\n\r\nimport { ObservableMap, ObservableSet, TiLog } from '../../utils/Util';\r\nimport { TiCheckitemComponent } from './TiCheckitemComponent';\r\n// TODO: 有些用户提出，响应式表单里，checkgroup value没有绑定已选中数据，不方便。\r\n/**\r\n * Checkgroup全选框组件，主要功能为从一数据集合中选择某几条数据，与多选组件(Select multiple)功能相同，只是数据规模和视觉呈现不同。\r\n *\r\n * 复选框组通常由一个全选框和多个子复选框构成。\r\n *\r\n * <example-url>../tiny3demo/#/checkgroup/checkgroup-all</example-url>\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiCheckgroup]',\r\n    templateUrl: '../checkbox/checkbox.html',\r\n    styleUrls: ['../checkbox/checkbox.less'],\r\n    // tslint:disable-next-line:use-host-property-decorator\r\n    host: {\r\n        'tiCheckbox': '' // 给宿主元素添加tiCheckbox属性，实现定制样式\r\n    }\r\n})\r\nexport class TiCheckgroupComponent extends TiCheckitemComponent {\r\n\r\n    /**\r\n     * 所有子选项数据\r\n     */\r\n    @Input() items: Array<any>;\r\n    /**\r\n     * 已选中数据集，双向绑定\r\n     */\r\n    @Input() checkeds: Array<any> | Set<any>;\r\n    /**\r\n     * 已选中数据集，双向绑定\r\n     */\r\n    @Output() readonly checkedsChange: EventEmitter<Set<any> | Array<any>> = new EventEmitter<Set<any> | Array<any>>();\r\n\r\n    private checkedMap: ObservableMap; // 储存本组所有子选项状态：key：item，value：true/false/null, 全选/不选/半选\r\n    private disabledSet: ObservableSet = new ObservableSet(); // 储存本组所有禁用的子选项\r\n\r\n    private itemsDiffer: IterableDiffer<any>;\r\n    private checkedsDiffer: IterableDiffer<any>;\r\n\r\n    /**\r\n     * @ignore\r\n     * 监听change事件，会多触发一次DoCheck。\r\n     * @param checked 原生change事件选中状态：全选，全不选\r\n     */\r\n    @HostListener('change', ['$event']) public onHostChange(checked: any): void {\r\n        super.onHostChange(checked);\r\n        if (this.nativeElement.checked === true) {\r\n            // 全选\r\n            this.checkAll(true);\r\n       } else if (this.nativeElement.indeterminate === true) {\r\n            // 半选情况，不作处理。\r\n       } else {\r\n            // 全不选\r\n            this.checkAll(false);\r\n       }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.initCheckedMap();\r\n        this.initGlobeCheckedMap();\r\n        this.initDisabledSet();\r\n        this.setChecked();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        // 解除监听\r\n        TiCheckitemComponent.globeCheckedMap.removeObserver(this.globeCheckedMapObserverFn);\r\n        TiCheckitemComponent.globeDisabledSet.removeObserver(this.globeDisabledSetObserverFn);\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        super.ngDoCheck();\r\n        // 【1】[items][checkeds] →  checkedMap\r\n        const itemsChanges: any = this.itemsDiffer.diff(this.items);\r\n        const checkedsChanges: any = this.checkedsDiffer.diff(this.checkeds);\r\n        if (checkedsChanges) {\r\n            checkedsChanges.forEachAddedItem(\r\n                record => {\r\n                    const item: any = this.getItem(record.item);\r\n                    if (this.items.includes(item)) {\r\n                        this.checkedMap.set(item, true, this.checkeds);\r\n                    } else {\r\n                        // 正常不会走到这里\r\n                        this.checkedMap.delete(item, this.checkeds);\r\n                        // 表格需求：允许用户设置的checkeds，范围大于items。所以会走到这里\r\n                        // TiLog.warn('checkeds new item is not in items');\r\n                    }\r\n                }\r\n            );\r\n            checkedsChanges.forEachRemovedItem(\r\n                record => {\r\n                    const item: any = this.getItem(record.item);\r\n                    if (this.items.includes(item)) {\r\n                        if (this.checkedMap.get(item) === true || this.checkedMap.get(item) === undefined) {\r\n                            this.checkedMap.set(item, false, this.checkeds);\r\n                        }\r\n                    } else {\r\n                        this.checkedMap.delete(item, this.checkeds);\r\n                    }\r\n                    // 强调：如果子选项是半选状态null，就不再置false了。\r\n                    // 规律：父节点，不会下达让子节点由null到false的指令。父节点，只会下达让节点由null到true的指令。\r\n                    // 注意：在树型结构中，外界@Input checkeds不能强制指定某个半选节点，变为不选。（checkeds中去除某个节点，此节点保持半选不变。）\r\n                }\r\n            );\r\n        }\r\n        // 将每次的变化，合入到全局变量中。因为多出来的项目，可能是刚才使用过的，所以需要重新赋值\r\n        if (itemsChanges) {\r\n            itemsChanges.forEachAddedItem(\r\n                record => {\r\n                    // Map中没有此项，会返回undefined\r\n                    if (this.checkedMap.has(record.item)) {\r\n                        //  初始化为什么会走到这里？本以为没有代码可以走到这里\r\n                        // 【5】checkedMap→globeCheckedMap\r\n                        TiCheckitemComponent.globeCheckedMap.set(record.item, this.checkedMap.get(record.item), this.checkedMap);\r\n                    } else {\r\n                        // 表格需求：checkeds允许范围比items更大。所以，根据checkeds来给checkedMap设置。\r\n                        let isChecked: boolean = false;\r\n                        const value = this.getValue(record.item);\r\n                        if (this.checkeds instanceof Array) {\r\n                            isChecked = this.checkeds.includes(value);\r\n                        } else if (this.checkeds instanceof Set) {\r\n                            isChecked = this.checkeds.has(value);\r\n                        }\r\n                        this.checkedMap.set(record.item, isChecked, this.checkeds);\r\n                        if (TiCheckitemComponent.globeDisabledSet.has(record.item)) {\r\n                            this.disabledSet.add(record.item);\r\n                        } else {\r\n                            this.disabledSet.delete(record.item);\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n            itemsChanges.forEachRemovedItem(\r\n                record => {\r\n                    this.checkedMap.delete(record.item, this.checkeds); // from标志从checkeds来，所以词条checkedMap变化，并未同步到checkeds。\r\n                    // 注意：会造成checkeds范围大于items\r\n                    this.disabledSet.delete(record.item);\r\n                }\r\n            );\r\n        }\r\n        if (checkedsChanges || itemsChanges) {\r\n            // 【3】checkedMap →  Group checked\r\n            this.setChecked(); // 设置全选状态。本地checkedMap变化，元素很多，但只初始化一次。\r\n        }\r\n        // 发出事件：checkeds改变\r\n        if (checkedsChanges) {\r\n            // TODO：后面可能要做，更新引用。\r\n            // 一旦更新引用，就得要求所有用户双向绑定[(checkeds)]。但旧版demo里是单向绑定，对一些遗留用户不友好。\r\n            // tslint:disable-next-line:prefer-conditional-expression\r\n            // if (this.checkeds instanceof Array) {\r\n            //     this.checkeds = this.checkeds.concat([]); // 更新引用\r\n            // } else {\r\n            //     this.checkeds = new Set(Array.from(this.checkeds)); // 更新引用\r\n            // }\r\n\r\n            /**\r\n             * checkedsChange 回调中同步修改其他数据会报错，影响正常功能，所以需要延时，\r\n             * 为什么不使用setTimout而使用Promise，Promise.then 是微任务，比setTimout(宏任务)先执行，想尽量早emit事件\r\n             * 宏任务和微任务：https://juejin.cn/post/6844903657264136200\r\n             * issue: https://git.huawei.com/WCC/Tiny3/issues/1588\r\n             * 扩展：ngDoCheck,ngAfterViewChecked中emit事件，在事件回调中同步修改数据，都存在同样问题。\r\n             */\r\n            Promise.resolve(null).then(() => {\r\n                this.checkedsChange.emit(this.checkeds);\r\n            });\r\n        }\r\n    }\r\n    private initCheckedMap(): void {\r\n        // 监听items和checkeds\r\n        this.itemsDiffer = this.iterableDiffers.find(this.items).create(null);\r\n        this.checkedsDiffer = this.iterableDiffers.find(this.checkeds).create(null);\r\n        this.checkedMap = new ObservableMap();\r\n        this.items.forEach(// 【1】[items][checkeds] →  checkedMap\r\n            item => {\r\n                let isChecked: boolean = false;\r\n                const value: any = this.getValue(item);\r\n                if (this.checkeds instanceof Array) {\r\n                    isChecked = this.checkeds.includes(value);\r\n                } else if (this.checkeds instanceof Set) {\r\n                    isChecked = this.checkeds.has(value);\r\n                }\r\n                if (isChecked) { // 选中态，直接添加\r\n                    this.checkedMap.set(item, true, this.checkeds);\r\n                } else if (this.checkedMap.get(item) === true || this.checkedMap.get(item) === undefined) { // 初始化\r\n                    this.checkedMap.set(item, false, this.checkeds);\r\n                    // 强调：如果子选项是半选状态null，就不再置false了。\r\n                    // 规律：父节点，不会下达让子节点由null到false的指令。父节点，只会下达让节点由null到true的指令。\r\n                    // 注意：在树型结构中，外界@Input checkeds不能强制指定某个半选节点，变为不选。（checkeds中去除某个节点，此节点保持半选不变。）\r\n                }\r\n            }\r\n        );\r\n\r\n        this.checkedMap.addObserver(\r\n            (item: any, value: any, isAdd: boolean, from: any) => {\r\n                // 有多个来源：chekceds，（items），checkall，globe\r\n                // 不是从checkeds来的，就要同步到chekeds\r\n                if (from !== this.checkeds ) {\r\n                    // 【2】checkedMap- >[checkeds]\r\n                    const isChecked: boolean = isAdd && this.checkedMap.get(item);\r\n                    const newItem: any = this.getValue(item);\r\n                    if (this.checkeds instanceof Set) {\r\n                        isChecked ? this.checkeds.add(newItem) : this.checkeds.delete(item);\r\n                    } else if (this.checkeds instanceof Array) { // TODO:写公用的Array remove函数\r\n                        const index: number = this.checkeds.indexOf(newItem);\r\n                        if (isChecked && index === -1) {\r\n                            this.checkeds.push(newItem);\r\n                        } else if (!isChecked && index !== -1) {\r\n                            this.checkeds.splice(index, 1);\r\n                        }\r\n                    }\r\n                }\r\n                // 不是从全局来的，就要同步到全球。\r\n                if (from !== TiCheckitemComponent.globeCheckedMap)  {\r\n                    // 【5】checkedMap→globeCheckedMap\r\n                    TiCheckitemComponent.globeCheckedMap.set(item, value, this.checkedMap);\r\n                }\r\n                // 从全局来的，需要更新全选状态。（树形结构层级较多，需要这个逻辑）\r\n                if (from === TiCheckitemComponent.globeCheckedMap) {\r\n                    // 【3】checkedMap →  Group checked\r\n                    this.setChecked();\r\n                }\r\n            }\r\n        );\r\n    }\r\n    private initGlobeCheckedMap(): void {\r\n        // checkedMap以group端优先，disabled以item端优先。\r\n        // checkedMap同步加入到globeCheckedMap\r\n        this.checkedMap.getMap()\r\n        .forEach(\r\n            item => {\r\n                // 【5】checkedMap→globeCheckedMap\r\n                TiCheckitemComponent.globeCheckedMap.set(item[0], item[1], this.checkedMap);\r\n            }\r\n        );\r\n        // 监听globecheckedMap\r\n        TiCheckitemComponent.globeCheckedMap.addObserver(this.globeCheckedMapObserverFn);\r\n    }\r\n    private initDisabledSet(): void {\r\n        // 【7】globeDisabledSet→disabledSet，并监听\r\n        this.items.forEach(\r\n            item => {\r\n                TiCheckitemComponent.globeDisabledSet.has(item) ?\r\n                    this.disabledSet.add(item) : this.disabledSet.delete(item);\r\n            }\r\n        );\r\n        // 【7】globeDisabledSet→disabledSet，监听globeDisabledSet\r\n        TiCheckitemComponent.globeDisabledSet.addObserver(this.globeDisabledSetObserverFn);\r\n        // 【8】disabledSet→Group checked\r\n        this.disabledSet.addObserver(\r\n            (item: any, isAdd: boolean) => {\r\n                this.setChecked();\r\n            }\r\n        );\r\n    }\r\n    /**\r\n     * 【6】globeCheckedMap→checkedMap\r\n     */\r\n    private globeCheckedMapObserverFn = (item: any, value: any, isAdd: boolean, from: any) => {\r\n        if (from !== this.checkedMap && this.items.includes(item)) {\r\n            // 同步globe的改变到本地\r\n            if (isAdd) {\r\n                this.checkedMap.set(item, value, TiCheckitemComponent.globeCheckedMap);\r\n            } else {\r\n                // !isAdd. 如果globe删除了某项，但这项属于自己的子项，那么把这一项添加回globe。（场景：子项item动态改变，并未销毁，却触发了全局delete）\r\n                TiCheckitemComponent.globeCheckedMap.set(item, this.checkedMap.get(item), this.checkedMap);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 【7】globeDisabledSet→disabledSet\r\n     */\r\n    private globeDisabledSetObserverFn = (item: any, isAdd: boolean) => {\r\n        if (isAdd && this.items.includes(item)) {\r\n            this.disabledSet.add(item);\r\n        } else if (!isAdd) {\r\n            this.disabledSet.delete(item);\r\n        }\r\n    }\r\n    /**\r\n     * 设置本group全选框的状态 【3】checkedMap →  Group checked\r\n     */\r\n    private setChecked(): void {\r\n        this.checked(this.getCheckedStatus());\r\n    }\r\n    /**\r\n     * 规则一：disabled状态的复选框不影响全选状态，所以需要将其从统计信息中过滤\r\n     * 例如有3个复选框，前两个为选中状态，最后一个是disabled，则认为整体为全部选中状态\r\n     * 所以无需关心disabled复选框的选中状态，只需关心非disabled状态即可\r\n     * 规则二：但当子复选框全部是disabled状态时，将会影响全选的状态\r\n     * @returns 全选：true，全不选：false，半选：null\r\n     */\r\n    private getCheckedStatus(): boolean {\r\n        if (this.items.length === 0) {// 情景零：没有选项\r\n            return false;\r\n        }\r\n        // 用户可勾选项目数\r\n        let checkedableNum = this.items.length - this.disabledSet.size;\r\n        const isTotalCount = (this.disabledSet.size === 0 || checkedableNum === 0); // 全部可用，或者全部禁用。所有选项进入统计。\r\n        if (checkedableNum === 0) { // 如果全部禁用，那么所有选项都计入统计。\r\n            checkedableNum = this.items.length;\r\n        }\r\n        let checkedNum = 0; // 选中项数目（非禁用）\r\n        let notCheckedNum = 0; // 未选项数目（非禁用）\r\n        for (const item of this.items) {\r\n            if (isTotalCount || !this.disabledSet.has(item)) { // 全部进入统计，或者未禁用项进入统计。\r\n                switch (this.checkedMap.get(item)) {\r\n                    case true:\r\n                        checkedNum++;\r\n                        break;\r\n                    case false:\r\n                        notCheckedNum++;\r\n                        break;\r\n                    case null:\r\n                        return null; // 只要有一个子选项是半选，那么结果是半选。\r\n                    default:\r\n                        // 不会走到这里\r\n                        TiLog.error('getCheckedStatus(),can not reach code, items item is not in checkedMap');\r\n                        break;\r\n                }\r\n                if (checkedNum !== 0 && notCheckedNum !== 0) {\r\n                    // 有选中，有不选中，所以半选。\r\n                    return null; // 半选\r\n                } else if (checkedNum === checkedableNum) {\r\n                    return true;\r\n                } else if (notCheckedNum === checkedableNum) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        // Logger.error('getCheckedStatus(),end, can not reach code,');\r\n        return false;\r\n    }\r\n    /**\r\n     *  设置全选框的状态值\r\n     * 【4】Group checked →  checkedMap\r\n     * @param checked\r\n     */\r\n    private checkAll(checked: boolean): void {\r\n\r\n        this.items.forEach(\r\n            item => {\r\n                if (!this.disabledSet.has(item)) {\r\n                        // 【4】Group checked →  checkedMap\r\n                        this.checkedMap.set(item, checked, this.checkAll);\r\n                }\r\n            }\r\n        );\r\n    }\r\n    /**\r\n     * 输出：得到整个item对象\r\n     * @param value item对象或者数据的身份标识\r\n     *\r\n     */\r\n    private getItem(value: any): any {\r\n        for (const obj of this.items) {\r\n            if (obj === value || obj[this.valueKey] === value) {\r\n                return obj;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n/*\r\n需求：Group checked，Item checked，[(checkedSet)]三者其一改变，都要通知其他二者。所以采用中介者模式。\r\n\r\n版本一：Tiny2,中介者是[(checkedSet)]，但要求Item也去绑定[(groupCheckedSet)]\r\n\r\n                           Group checked    ←  disabledSet\r\n                                     ↕                               ↑\r\n[dataArray]         [checkedSet]            groupDisabledSet\r\n                                     ↕                               ↑\r\n                            Item checked             Item disabled\r\n\r\n版本二：中介者是全局变量globeCheckedSet，不要求Item绑定其他变量。\r\n\r\n                          Group checked   ←   disabledSet\r\n[dataArray]                   ↕                              ↑\r\n[(checkedSet)]↔globeCheckedSet     globeDisabledSet\r\n                                     ↕                              ↑\r\n                            Item checked           Item disabled\r\n\r\n版本三：链条传递，不要求Item绑定其他变量。\r\n\r\n                   Group checked       ←     disabledSet\r\n                            ↕                                         ↑\r\n[dataArray] [checkedSet]                               ↑\r\n                            ↕                                         ↑\r\n                   globeCheckedSet            globeDisabledSet\r\n                            ↕                                         ↑\r\n                    Item checked                  Item disabled\r\n\r\n版本四：Tiny3, 链条传递，不要求Item绑定其他变量。但也可以绑定所属于组织选中变量。Array/Set兼容\r\n\r\n                                    Group checked       ←     disabledSet\r\n                                            ↕                                     ↑\r\n            [checkeds] ↔  checkedSet                            ↑\r\n                                            ↕                                     ↑\r\n                                    globeCheckedSet            globeDisabledSet\r\n                                             ↕                                     ↑\r\n                                    Item checked                   Item disabled\r\n                                             ↕\r\n         [beCheckeds] ↔ beCheckedSet\r\n版本五：Tiny3, 链条传递，不要求Item绑定其他变量。但也可以绑定所属于组织选中变量。Array/Set兼容。\r\n兼容Tree树形结构，子节点也有可能是半选状态。\r\n                                                                    8\r\n                                    Group checked       ←     disabledSet\r\n                             1>         3↑↓4                                 ↑\r\n [items][checkeds] ↔  checkedMap                           ↑\r\n                            <2          5↓↑6                                  ↑7\r\n                                    globeCheckedMap          globeDisabledSet\r\n                                            ↓↑                                     ↑\r\n                                    Item checked                    Item disabled\r\n                                            ↓↑\r\n         [beCheckeds] ↔ beCheckedSet\r\n*/\r\n/*\r\n@Input支持Set<any>|Array<any>\r\n方案一：每次使用时，都判断类型，调用不同方法。\r\n方案二：@Input set时，给Array绑定上has()、add()、delete()方法，但是get size怎么绑定？\r\n方案三：Set<any>|Array，赋值给新的Set。Tiny3采用\r\n */\r\n            /* TODO：Tiny3已去除此逻辑，推测Tiny3应该没有此Bug。等IE环境好了后，再测试。\r\n              解决IE浏览器下的复选框半选状态BUG，\r\n              bug单号：http://code.huawei.com/WCC/TinyPlus/issues/1397\r\n              BUG表现：当复选框的状态为半选状态，\r\n                       点击复选框的时候IE浏览器会把复选框状态为  checked = false，\r\n                       而其他浏览器会直接变成checked = true,\r\n              原因分析参考地址：https://github.com/jquery/jquery/issues/1698\r\n                                http://www.xuebuyuan.com/1322692.html\r\n              解决方案：绑定点击事件，手动更改checked状态，同时更新子复选框选中状态。\r\n             */\r\n","import { NgModule } from '@angular/core';\r\nimport { TiCheckgroupComponent } from './TiCheckgroupComponent';\r\nimport { TiCheckitemComponent } from './TiCheckitemComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    TiIconModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiCheckgroupComponent, TiCheckitemComponent],\r\n  declarations: [TiCheckgroupComponent, TiCheckitemComponent]\r\n})\r\nexport class TiCheckgroupModule {\r\n}\r\nexport { TiCheckgroupComponent } from './TiCheckgroupComponent';\r\nexport { TiCheckitemComponent } from './TiCheckitemComponent';\r\n","import { NgModule } from '@angular/core';\r\nimport { TiRendererModule } from '../renderer/TiRendererModule';\r\nimport { TiTipServiceModule } from '../tip/TiTipServiceModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    TiRendererModule,\r\n    TiTipServiceModule\r\n  ]\r\n})\r\nexport class TiOverflowServiceModule {\r\n}\r\n","import { ComponentRef, Injectable, Renderer2, RendererFactory2 } from '@angular/core';\r\nimport { TiRenderer } from '../renderer/TiRenderer';\r\nimport { TiLog, Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\nimport { TiTipRef, TiTipShowInfo } from '../tip/TiTipInterface';\r\nimport { TiTipService } from '../tip/TiTipService';\r\nimport { TiOverflowServiceModule } from './TiOverflowServiceModule';\r\n\r\n/**\r\n * @ignore\r\n * overflow配置项接口，用于[TiOverflowService.create]{@link ../injectables/TiOverflowService.html#create}参数使用\r\n */\r\nexport interface TiOverflowConfig {\r\n    /**\r\n     * tip显示时所依据的元素，使用该元素位置显示tip位置，默认为宿主元素,当tip显示所依赖的元素的和宿主元素不一致时才需要定义\r\n     */\r\n    tipElement?: Element | Function;\r\n    /**\r\n     * tip内容，默认为宿主元素文本\r\n     */\r\n    tipContent?: string;\r\n    /**\r\n     * tip位置\r\n     */\r\n    tipPosition?: TiPositionType;\r\n    /**\r\n     * tip最大宽度\r\n     */\r\n    tipMaxWidth?: string;\r\n    /**\r\n     * @ignore\r\n     * 决定定位元素水平方向的元素，用于宿主元素水平方向位置与host元素不一致的场景，暂不对外开放\r\n     */\r\n    tipHostEleX?: Element;\r\n}\r\n/**\r\n * @ignore\r\n * create方法返回值\r\n */\r\nexport interface TiOverflowRef {\r\n    destroy(): void;\r\n}\r\n/**\r\n * @ignore\r\n * 文本过长出...并tip提示配置项，使用该服务时需要引入模块TiOverflowServiceModule，该组件提供了两种使用方式:\r\n *\r\n * 1.服务方式（见如下说明）\r\n *\r\n * 2.指令方式：[TiOverflowDirective]{@link ../directives/TiOverflowDirective.html}\r\n *\r\n * <example-url>../tiny3demo/#/overflow/overflow-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiOverflowServiceModule\r\n  })\r\nexport class TiOverflowService {\r\n    private renderer: Renderer2;\r\n    constructor(rendererFactory: RendererFactory2,\r\n                private tiRenderer: TiRenderer,\r\n                private tipService: TiTipService) {\r\n            /* tslint:disable:no-null-keyword */\r\n            this.renderer = rendererFactory.createRenderer(null, null);\r\n    }\r\n    /**\r\n     * 生成tip提示方法\r\n     * @param hostElement 文本过长的宿主对象\r\n     * @param config overflow配置项\r\n     * 返回 {destroy(): void} 销毁文本过长的tip提示，使用服务方式时，需要在宿主元素销毁时，通过调用该方法销毁文本过长的tip提示\r\n     */\r\n    create(hostElement: Element, config?: TiOverflowConfig): TiOverflowRef {\r\n        this.tiRenderer.setStyles(hostElement, {\r\n            whiteSpace: 'nowrap',\r\n            textOverflow: 'ellipsis',\r\n            overflow: 'hidden'\r\n        });\r\n        // 非法情况处理\r\n        if (!Util.isElement(hostElement)) {\r\n            TiLog.warn('overflow: hostEle type is not element');\r\n\r\n            // 防止外部使用报错，此处做返回值处理\r\n            return {\r\n                destroy(): void {}\r\n            };\r\n        }\r\n        // 如果该元素为inline元素时，宽度不生效会导致元素出...样式不生效，因此此处做处理\r\n        // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n        if (typeof getComputedStyle !=='undefined' && getComputedStyle(hostElement).display === 'inline') {\r\n            this.renderer.setStyle(hostElement, 'display', 'inline-block');\r\n        }\r\n        const tipInstance: TiTipRef = this.generateTip(hostElement, config || {});\r\n\r\n        return {\r\n            destroy(): void {\r\n                if (tipInstance) {\r\n                    tipInstance.hide();\r\n                }\r\n            }\r\n        };\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isOverflow(element: Element): boolean {\r\n        // 复制DOM，并计算元素宽度\r\n        // 此处使用clone方式而不使用scrollWidth方式,是因为目前发现scrollWidth在IE下获取到的值有问题，不可作为文本溢出的判断条件\r\n        const eleStyles: any = getComputedStyle(element);\r\n        const cloneEle: any = element.cloneNode(true);\r\n        this.tiRenderer.setStyles(cloneEle, {\r\n            // 涉及内容字体的相关样式处理\r\n            fontSize: eleStyles.fontSize,\r\n            fontWeight: eleStyles.fontWeight,\r\n            fontFamily: eleStyles.fontFamily,\r\n            padding: eleStyles.padding,\r\n            paddingLeft: eleStyles.paddingLeft, // 处理在IE和火狐下获取padding为空问题：在火狐和IE下只能用只能用padding+[方位]的方式来获取元素的padding值\r\n            paddingRight: eleStyles.paddingRight,\r\n            border: eleStyles.border,\r\n            boxSizing: eleStyles.boxSizing,\r\n            height: eleStyles.height,\r\n            // 涉及宽度布局的相关样式处理\r\n            maxWidth: 'none', // 清除最大宽度样式，确保内容可显示完全\r\n            width: 'auto',\r\n            overflow: 'visible',\r\n            display: 'inline-block', // display block的情况下，元素父容器设置margin时，导致导致body变宽，从而与元素本身宽度不匹配，会导致可显示完全但出tip的问题，因此此处改变其display方式\r\n            visibility: 'hidden', // 元素隐藏但做占位处理\r\n            whiteSpace: 'nowrap',\r\n            position: 'absolute', // 避免克隆元素影响页面高度，导致出滚动条\r\n            left: '-9999px',\r\n            top: '-9999px'\r\n\r\n        });\r\n        this.renderer.appendChild(document.body, cloneEle);\r\n        // 使用getBoundingClientRect而不使用getComputedStyle,是因为getComputedStyle在\r\n        // 各浏览器获取到的宽度不一致（IE下取到的是内容宽度，而在Chrome和FF下取到的是整个元素宽度）。\r\n        // IE下计算精度高(小数点后15位)，多数中文和数字或英文混排的文本计算出来的 maxWidth 和 textWidth\r\n        // 由于精度高而导致有微小差距，从而影响了 isOverflow 的判断结果，从实际测试得来结论：保留两位小数能够保证判断结果更准确些。\r\n        const maxWidth: number = parseFloat(element.getBoundingClientRect().width\r\n            .toFixed(2));\r\n        const textWidth: number = parseFloat(cloneEle.getBoundingClientRect().width\r\n            .toFixed(2));\r\n        // 此处没有使用angular的Renderer2是因为Renderer2.removeChild必须有变化检测才能在dom上生效，\r\n        // 此处考虑到性能不触发变化检测，所以选择使用原生的removeChild方法。\r\n        document.body.removeChild(cloneEle);\r\n\r\n        return textWidth > maxWidth;\r\n    }\r\n    private generateTip(element: Element, options: TiOverflowConfig): TiTipRef {\r\n        // 文本超长时，显示tip提示：\r\n        // tip显示位置元素设置：默认为element\r\n        const config: TiOverflowConfig = options || {};\r\n        let hostEleConfig: any = config.tipElement;\r\n        if (typeof hostEleConfig === 'function') {\r\n            hostEleConfig = hostEleConfig(element);\r\n        }\r\n        const tipHostEle: Element = hostEleConfig || element;\r\n\r\n        return this.tipService.create(tipHostEle, {\r\n            hostEleX: config.tipHostEleX,\r\n            position: config.tipPosition,\r\n            maxWidth: config.tipMaxWidth,\r\n            trigger: 'mouse',\r\n            showFn: (): TiTipShowInfo => {\r\n                // tipContent 为空 或者 未溢出情况下，不显示tip\r\n                // tipPosition设置为none是去除Select默认超长tip，改由template内容自定义tip\r\n                if (config.tipPosition === 'none' || config.tipContent === '' || !this.isOverflow(element)) {\r\n                    return;\r\n                }\r\n                // tip内容设置：默认为元素中的文本内容\r\n                let tipContent: string = config.tipContent;\r\n                if (Util.isUndefined(tipContent)) { // content可能为\"\"，因此此处判断undefined而不使用||\r\n                    tipContent = element.textContent;\r\n                }\r\n\r\n                return { content: tipContent };\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\r\nimport { TiOverflowService } from '../../services/overflow/TiOverflowService';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * 超长情况下文本处理出...并tip提示\r\n *\r\n * <example-url>../tiny3demo/#/overflow/overflow-all</example-url>\r\n */\r\n@Directive({\r\n      selector: '[tiOverflow]:not([maxLine])'\r\n})\r\nexport class TiOverflowDirective implements OnInit {\r\n      /**\r\n       * 配置宿主元素支持文本过长提示功能，不需要配置属性值，存在该属性即可\r\n       */\r\n      @Input() tiOverflow: any;\r\n      /**\r\n       * 配置文本过长时显示的tip内容，默认为宿主元素文本\r\n       */\r\n      @Input() tiTipContent: string;\r\n      /**\r\n       * 配置文本过长时显示的tip位置\r\n       */\r\n      @Input() tiTipPosition: TiPositionType;\r\n      /**\r\n       * 配置文本过长时显示的tip的最大宽度。\r\n       *\r\n       * 3.0.9新增\r\n       */\r\n      @Input() tiTipMaxWidth: string = '276px';\r\n      /**\r\n       * @ignore\r\n       * 决定tip水平方向位置的宿主元素配置\r\n       */\r\n      @Input() tiTipHostEleX: Element;\r\n      private overflowRef: any;\r\n      constructor(private ele: ElementRef, private overflowService: TiOverflowService) {\r\n      }\r\n      ngOnInit(): void {\r\n            this.overflowRef = this.overflowService.create(this.ele.nativeElement, {\r\n                  tipContent: this.tiTipContent,\r\n                  tipPosition: this.tiTipPosition,\r\n                  tipHostEleX: this.tiTipHostEleX,\r\n                  tipMaxWidth: this.tiTipMaxWidth\r\n            });\r\n      }\r\n      // 服务方式的overflow无法自销毁，因此此处在组件销毁时销毁服务方式生成的组件实例\r\n      ngOnDestroy(): void {\r\n            if (this.overflowRef) {\r\n                  this.overflowRef.destroy();\r\n            }\r\n      }\r\n}\r\n","import {\r\n    AfterContentChecked,\r\n    AfterViewInit,\r\n    Directive,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    NgZone,\r\n    OnChanges,\r\n    OnDestroy,\r\n    Output,\r\n    Renderer2,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiTipService } from '../../services/tip/TiTipService';\r\nimport { TiTipRef } from '../../services/tip/TiTipInterface';\r\nimport { Util, TiBrowser } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * 多行文本超出情况下文本处理出...并tip提示\r\n *\r\n */\r\n@Directive({\r\n    selector: '[tiOverflow][maxLine]'\r\n})\r\n\r\nexport class TiOverflowMaxlineDirective implements AfterViewInit, AfterContentChecked, OnChanges, OnDestroy {\r\n    public nativeElement: any;\r\n    constructor(\r\n        private hostRef: ElementRef,\r\n        private renderer2: Renderer2,\r\n        private tipService: TiTipService,\r\n        private zone: NgZone) {\r\n        this.nativeElement = this.hostRef.nativeElement;\r\n    }\r\n    /**\r\n     * 文本最大行数，默认3行\r\n     */\r\n    @Input() maxLine: number = 3;\r\n    /**\r\n     * 配置文本过长时显示的tip的最大宽度。\r\n     *\r\n     * 3.0.9新增\r\n     */\r\n    @Input() tiTipMaxWidth: string = '276px';\r\n    /**\r\n     * 文本被截断之后的tip方向\r\n     */\r\n    @Input() tiTipPosition: TiPositionType;\r\n    /**\r\n     * 文本被截断之后的tip内容\r\n     */\r\n    @Input() tiTipContent: string;\r\n    /**\r\n     * @ignore\r\n     * 文本被截断之后末尾图标展示\r\n     */\r\n    @Input() iconName: string;\r\n    /**\r\n     * 图标提示\r\n     */\r\n    @Input() iconTip: string = '';\r\n    /**\r\n     * 宿主文本\r\n     */\r\n    @Input() textContent: string;\r\n    /**\r\n     * @ignore\r\n     * 文本被截断之后的末尾填充符号\r\n     */\r\n    @Input() character: string = '...'; // 暂不开放\r\n    /**\r\n     * @ignore\r\n     * 图标是否可以聚焦，默认不可聚焦。\r\n     */\r\n    @Input() iconFocusable: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 图标是否灰化，默认不灰化\r\n     */\r\n    @Input() iconDisabled: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 文本被截断之后末尾图标点击事件\r\n     */\r\n    @Output() readonly iconClick: EventEmitter<Event> = new EventEmitter();\r\n    private text: string; // 宿主元素文本\r\n    private isShave: boolean; // 是否已经截取\r\n    private tipInstance: TiTipRef;  // tip实例\r\n    private icontipInstance: TiTipRef;  // icontip实例\r\n\r\n    private listenFns: Array<() => void>; // 监听事件\r\n    private windowResizeListener: () => void;\r\n    private tipContent: string; // 最终展示的tip内容\r\n\r\n    private shaveTextFn = (): void => {\r\n        let fontHtml: string;\r\n        if (Util.isEmptyString(this.iconName)) {\r\n            fontHtml = '';\r\n        } else {\r\n            // 此处添加属性tiOverflowEndicon为了适配在plus3中定义末尾图标的样式\r\n            // 在labelEditor组件中，需要可以聚焦。\r\n            fontHtml = this.iconFocusable ? `<span style=\"display:inline-block;width:16px;line-height: 1\"\r\n                tabindex=\"${this.iconDisabled ? -1 : 0}\" tiOverflowEndicon  class=\"ti3-icon-${this.iconName} ti3-icon\"></span>`\r\n                : `<span style=\"display:inline-block;width:16px;line-height: 1\"\r\n                tiOverflowEndicon class=\"ti3-icon-${this.iconName} ti3-icon\"></span>`;\r\n        }\r\n        // 修复SSR错误：ERROR ReferenceError: getComputedStyle is not defined\r\n        if (typeof getComputedStyle === 'undefined') {\r\n            return;\r\n        }\r\n        const lineHeight: number = parseFloat(getComputedStyle(this.nativeElement)\r\n            .getPropertyValue('line-height'));\r\n        const multiLineHeight: number = lineHeight * this.maxLine;\r\n        this.nativeElement.textContent = this.text;\r\n        // 如果该元素为inline元素时，宽度不生效会导致元素出...样式不生效，因此此处做处理\r\n        if (getComputedStyle(this.nativeElement).display === 'inline') {\r\n            this.renderer2.setStyle(this.nativeElement, 'display', 'inline-block');\r\n        }\r\n        this.nativeElement.insertAdjacentHTML('beforeend', fontHtml);\r\n        if (this.text.length < 2 || this.nativeElement.offsetHeight <= multiLineHeight) {\r\n            this.setEvents();\r\n            this.isShave = false;\r\n\r\n            return;\r\n        }\r\n        let charHtml: string = this.character;\r\n        charHtml = charHtml.concat(fontHtml);\r\n        // 以下使用二分算法计算文本截取位置\r\n        let max: number = this.text.length - 1;\r\n        let min: number = 0;\r\n        let middle: number;\r\n        while (min < max) {\r\n            middle = (min + max + 1) / 2;\r\n            this.nativeElement.textContent = this.text.slice(0, middle);\r\n            this.nativeElement.insertAdjacentHTML('beforeend', charHtml);\r\n            if (this.nativeElement.offsetHeight > multiLineHeight + 1) {\r\n                max = middle - 1; // 截取的内容少\r\n            } else {\r\n                min = middle; // 截取的内容多\r\n            }\r\n        }\r\n        this.nativeElement.textContent = this.text.slice(0, max);\r\n        this.nativeElement.insertAdjacentHTML('beforeend', charHtml);\r\n        this.setEvents();\r\n        this.isShave = true;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        this.text = this.textContent || this.nativeElement.innerHTML;\r\n        if ((changes.maxLine && !changes.maxLine.firstChange)\r\n            || (changes.textContent && !changes.textContent.firstChange)) {\r\n            this.shaveTextFn();\r\n        }\r\n\r\n        if (this.iconFocusable && changes.iconDisabled && !changes.iconDisabled.firstChange) {\r\n            const spanEle: HTMLElement = this.nativeElement.querySelector('span[tiOverflowEndicon]');\r\n            if (spanEle) {\r\n                this.renderer2.setAttribute(spanEle, 'tabindex', this.iconDisabled ? '-1' : '0');\r\n            }\r\n        }\r\n    }\r\n    // tip配置\r\n    ngAfterViewInit(): void {\r\n        this.text = this.textContent || this.nativeElement.innerHTML; // 视图初始化完成后获取宿主元素文本\r\n        if (TiBrowser.isIE()) {\r\n            setTimeout(() => {\r\n                this.shaveTextFn(); // IE下需延时处理，否则初始化获取到 offsetHeight 值与谷歌有差异\r\n            }, 0);\r\n        } else {\r\n            this.shaveTextFn();\r\n        }\r\n        this.renderer2.listen(this.nativeElement, 'mouseenter', (): void => {\r\n            if (this.isShave) {\r\n                this.tipContent = this.tiTipContent || this.text;\r\n                if (!this.tipInstance) {\r\n                    this.tipInstance = this.tipService.create(this.nativeElement, {\r\n                        position: this.tiTipPosition || 'right',\r\n                        maxWidth: this.tiTipMaxWidth,\r\n                        trigger: 'mouse'\r\n                    });\r\n                    this.tipInstance.show(this.tipContent);\r\n                } else {\r\n                    this.tipInstance.show(this.tipContent);\r\n                }\r\n            }\r\n        });\r\n        this.renderer2.listen(this.nativeElement, 'mouseleave', (): void => {\r\n            if (this.tipInstance) {\r\n                this.tipInstance.hide();\r\n            }\r\n        });\r\n        // 修复SSR错误：ERROR ReferenceError: window is not defined\r\n        if (typeof window === 'undefined') {\r\n            return;\r\n        }\r\n        this.zone.runOutsideAngular(() => {\r\n            this.windowResizeListener = this.renderer2.listen(window, 'resize', this.shaveTextFn);\r\n        });\r\n    }\r\n\r\n    ngAfterContentChecked(): void {\r\n        if (!this.nativeElement.children || this.nativeElement.children.length < 1) {\r\n            return;\r\n        }\r\n         // 解绑原有监听\r\n        if (this.listenFns) {\r\n            this.listenFns.forEach((fn: () => void) => fn());\r\n        }\r\n        this.listenFns = new Array<any>();\r\n        this.listenFns.push(this.renderer2.listen(this.nativeElement.children[0], 'click', (): void => {\r\n            this.iconClick.emit();\r\n            if (this.icontipInstance) {\r\n                this.icontipInstance.hide();\r\n            }\r\n        }));\r\n        this.listenFns.push(this.renderer2.listen(this.nativeElement.children[0], 'mouseenter', (): void => {\r\n            if (this.tipInstance) {\r\n                this.tipInstance.hide();\r\n            }\r\n            this.icontipInstance = this.tipService.create(this.nativeElement.children[0], {\r\n                position: 'top',\r\n                maxWidth: this.tiTipMaxWidth,\r\n                trigger: 'mouse'\r\n            });\r\n            this.icontipInstance.show(this.iconTip);\r\n        }));\r\n        this.listenFns.push(this.renderer2.listen(this.nativeElement.children[0], 'mouseleave', (): void => {\r\n            if (this.tipInstance) {\r\n                this.tipInstance.show(this.tipContent);\r\n            }\r\n            if (this.icontipInstance) {\r\n                this.icontipInstance.hide();\r\n            }\r\n        }));\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.windowResizeListener) {\r\n            this.windowResizeListener();\r\n        }\r\n        if (this.listenFns) {\r\n            this.listenFns.forEach((fn: () => void) => fn());\r\n        }\r\n    }\r\n\r\n    public setEvents(): void {\r\n        if (this.iconFocusable) {\r\n            const clickIconEle: HTMLElement = this.nativeElement.querySelector('span[tiOverflowEndicon]');\r\n            if (!clickIconEle) {\r\n                return;\r\n            }\r\n            this.zone.runOutsideAngular((): void => {\r\n                this.renderer2.listen(clickIconEle, 'mousedown', (): void => {\r\n                    this.renderer2.setStyle(clickIconEle, 'outline', 'none');\r\n                });\r\n                this.renderer2.listen(clickIconEle, 'blur', (): void => {\r\n                    this.renderer2.setStyle(clickIconEle, 'outline', '');\r\n                });\r\n            });\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiOverflowDirective } from './TiOverflowDirective';\r\nimport { TiOverflowMaxlineDirective } from './TiOverflowMaxlineDirective';\r\nimport { TiOverflowServiceModule } from '../../services/overflow/TiOverflowServiceModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    TiOverflowServiceModule\r\n  ],\r\n  exports: [TiOverflowDirective, TiOverflowMaxlineDirective],\r\n  declarations: [TiOverflowDirective, TiOverflowMaxlineDirective]\r\n})\r\nexport class TiOverflowModule {\r\n}\r\nexport { TiOverflowDirective } from './TiOverflowDirective';\r\nexport { TiOverflowMaxlineDirective } from './TiOverflowMaxlineDirective';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    Output,\r\n    Renderer2,\r\n    ViewChild,\r\n    ViewEncapsulation\r\n} from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-date-dominator',\r\n    templateUrl: './datedominator.html',\r\n    styleUrls: ['./datedominator.less'],\r\n    // tslint:disable-next-line:use-host-property-decorator\r\n    host: {\r\n        '(mouseenter)': 'onMouseenter()',\r\n        '(mouseleave)': 'onMouseleave()',\r\n        '[class.ti3-date-dominator-container]': 'true'\r\n    },\r\n    encapsulation: ViewEncapsulation.None, // 灰化设置样式\r\n    providers: [TiFormComponent.getValueAccessor(TiDateDominatorComponent) ]\r\n})\r\n\r\nexport class TiDateDominatorComponent extends TiFormComponent {\r\n    @Input() clearable: boolean; // 是否显示删除按钮\r\n    @Input() format: string; // 该接口主要用于range组件中线的定位：用于计算宽度\r\n    @Input() type: string; // 类型：'date','range'\r\n    @Input() isTime: boolean; // 是否是纯时间组件\r\n    @Output() readonly clear: EventEmitter<any> = new EventEmitter<any>(); // 点击删除按钮的事件回调\r\n    /**\r\n     * @ignore\r\n     * 是否显示清除图标\r\n     */\r\n    public showClear: boolean;\r\n    constructor(\r\n        protected render: Renderer2,\r\n        protected hostRef: ElementRef) {\r\n            super(hostRef, render);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.setFocusableElems([this.nativeElement]);\r\n    }\r\n\r\n    onIconClearClick(event: MouseEvent): void {\r\n        this.clear.emit(event);\r\n    }\r\n\r\n    onMouseenter(): void {\r\n        this.showClear = true;\r\n    }\r\n    onMouseleave(): void {\r\n        this.showClear = false;\r\n    }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiOverflowModule } from '../../directives/overflow/TiOverflowModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiDateDominatorComponent } from './TiDateDominatorComponent';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiOverflowModule\r\n  ],\r\n  exports: [TiDateDominatorComponent],\r\n  declarations: [TiDateDominatorComponent]\r\n})\r\nexport class TiDateDominatorModule {\r\n\r\n}\r\nexport { TiDateDominatorComponent } from './TiDateDominatorComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    HostBinding,\r\n    Input,\r\n    Renderer2,\r\n    SimpleChanges,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { TiBrowser, TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleFormat, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n   selector: 'ti-date-edit',\r\n   templateUrl: './dateedit.html',\r\n   styleUrls: ['../text/text.less'], // 引用text的less文件\r\n   providers: [TiFormComponent.getValueAccessor(TiDateEditComponent)]\r\n})\r\n\r\nexport class TiDateEditComponent extends TiFormComponent {\r\n    @Input() format: string; // 设置日期显示格式\r\n    @Input() min: Date; // 设置最小日期值\r\n    @Input() max: Date; // 设置最大日期值\r\n    @Input() disabled: boolean; // 支持禁用\r\n\r\n    @Input() disabledDays: Array<any>;\r\n\r\n    @ViewChild('input', { static: true }) inputRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @HostBinding('style.display') display: string = 'inline-block';\r\n\r\n    protected oldMinvalue: Date;\r\n    protected oldMaxvalue: Date;\r\n    private oldModel: Date;\r\n    private oldInputvalue: string;\r\n    public inputValue: string = '';\r\n    public placehoderText: string;\r\n    public MAX: Date = TiDateUtil.maxDate();\r\n    public MIN: Date = TiDateUtil.minDate();\r\n\r\n    constructor(\r\n        protected hostRef: ElementRef,\r\n        protected render: Renderer2) {\r\n            super(hostRef, render);\r\n    }\r\n\r\n    writeValue(value: Date): void {\r\n        super.writeValue(value);\r\n        // model为null时，输入框不显示内容\r\n        if (value === null) {\r\n            return;\r\n        }\r\n\r\n        // 传入的model值是非日期时，设置为当前日期\r\n        if (!TiDateUtil.isDate(value)) {\r\n            this.model = new Date();\r\n        } else if (TiDateUtil.isBigger(value, this.max)) { // 如果大于最大值，设置为最大值\r\n            this.model = this.max;\r\n        } else if (TiDateUtil.isSmaller(value, this.min)) { // 小于最小值，设置为最小值\r\n            this.model = this.min;\r\n        }\r\n    }\r\n\r\n    // model值变化时的回调: dateedit中inputValue变化时未能及时渲染到页面上\r\n    ngOnModelChange(): void {\r\n        setTimeout(() => {\r\n            this.formatValue();\r\n        }, 0);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 设置聚焦元素为input\r\n        this.setFocusableElems([this.inputRef.nativeElement]);\r\n        // format接口校验:对时间日期进行国际化处理\r\n        this.validateFormat();\r\n\r\n        // 最大最小值校验\r\n        this.validateMinAndMax();\r\n\r\n        if (!Util.isUndefined(this.format)) {\r\n            this.setPlacehoderText();\r\n        }\r\n\r\n        this.oldMinvalue = this.min;\r\n        this.oldMaxvalue = this.max;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // format支持动态变更\r\n        if (changes['format'] && !changes['format'].firstChange) {\r\n            // 新的format是非法时，format值保持之前值不变\r\n            if (!Util.isString(changes['format'].currentValue) && !Util.isString(changes['format'].currentValue.date)) {\r\n                this.format = changes['format'].previousValue;\r\n\r\n                return;\r\n            }\r\n            if (!Util.isString(changes['format'].currentValue)) {\r\n                this.format = changes['format'].currentValue.date;\r\n            }\r\n            this.setPlacehoderText();\r\n            this.formatValue();\r\n        }\r\n    }\r\n    /**\r\n     * 不同场景下设置日期输入框placehoder文本\r\n     */\r\n    private setPlacehoderText(): void {\r\n        // 以下是为了处理英文状态下，dateEdit输入时有问题，将其placeholder调整为国际化以后的值\r\n        const englishFormatArr: any = this.format.match(/M/g);\r\n        // tslint:disable-next-line:newline-per-chained-call\r\n        const formatPureArr: any = this.format.split(/[-\\/\\.\\_,\\s]/).filter(this.filterEmptyFn);\r\n        // 确定其为英文显示月份\r\n        if (Util.isArray(englishFormatArr) && englishFormatArr.length === 3) {\r\n            formatPureArr.length === 3 ? this.placehoderText = 'MM/dd/yyyy' : this.placehoderText = 'MM/yyyy';\r\n        } else {\r\n            this.placehoderText = this.format;\r\n        }\r\n    }\r\n\r\n    onFocus(): void {\r\n        // 在输入框聚焦时获取当前合法的model值：\r\n        this.oldModel = this.model;\r\n    }\r\n\r\n    onBlur(): void {\r\n        if (this.oldInputvalue !== this.inputValue) {\r\n            this.handleInputValue();\r\n        }\r\n    }\r\n\r\n    onKeydown(event: KeyboardEvent): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.handleInputValue();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    handleInputValue(): void {\r\n        // blur时拿到输入框的值\r\n        this.inputValue = this.inputRef.nativeElement.value;\r\n        // 校验输入框中值：得到合法的model值\r\n        if (this.inputValue !== '') {\r\n            this.getValidModel();\r\n        } else {\r\n            this.model = null; // 当用户输入为空或者为null的情况,model赋值为null\r\n        }\r\n\r\n        // 根据model值格式化\r\n        this.formatValue();\r\n        this.oldInputvalue = this.inputValue;\r\n    }\r\n\r\n    isValidValue(value: Date): boolean {\r\n        // value值为null时会将输入框清空，是一个合法的value值\r\n        if (value === null) {\r\n            return true;\r\n        }\r\n\r\n        // value值为一个Date类型值并且在最大最小值范围内时，是一个合法值\r\n        if (TiDateUtil.isDate(value) &&\r\n            !TiDateUtil.isBigger(value, this.max) && !TiDateUtil.isSmaller(value, this.min)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public  filterEmptyFn(value: any): any {\r\n        return value !== '';\r\n    }\r\n\r\n    // 日期格式校验\r\n    private validateFormat(): void {\r\n        if (Util.isString(this.format) && this.format !== '') {\r\n            return;\r\n        }\r\n        // TODO:如果配置时间日期国际化\r\n        this.format = (TiLocale.getLocaleWords() as TiLocaleWords).tiLocaleDate['date'];\r\n    }\r\n\r\n    // 最大值最小值校验\r\n    private validateMinAndMax(): void {\r\n        // 最大值合法性校验:(时分秒：23:59:59)\r\n        const maxTimeChanged: Date = TiDateUtil.changeMaxTime(this.max);\r\n        this.max = TiDateUtil.isDate(this.max) ? maxTimeChanged : this.MAX;\r\n\r\n        // 最小值合法性校验:(时分秒：0:0:0)\r\n        const minTimeChanged: Date = TiDateUtil.changeMinTime(this.min);\r\n        this.min = TiDateUtil.isDate(this.min) ? minTimeChanged : this.MIN;\r\n\r\n        // 最大最小值矛盾时，设置为默认值\r\n        if (this.max.getTime() < this.min.getTime()) {\r\n            this.max = this.MAX;\r\n            this.min = this.MIN;\r\n        }\r\n    }\r\n\r\n    // 根据model值和format接口，格式化显示时间日期\r\n    public formatValue(): void {\r\n        this.inputValue = (this.model !== null) ? TiLocaleFormat.formatDate(this.model, this.placehoderText) : '';\r\n        this.oldInputvalue = this.inputValue;\r\n    }\r\n\r\n    // 校验输入框中的值\r\n    private getValidModel(): void {\r\n        // 支持分隔符:中划线，下划线，点，斜杠\r\n        const reg: RegExp = new RegExp('[年\\\\月\\\\日\\\\-\\\\/\\\\.\\\\_]');\r\n        const dateArr: Array<string> = this.inputValue.split(reg);\r\n        const formatArr: Array<string> = this.placehoderText.split(reg);\r\n        let dateValue: any;\r\n        const arr: Array<number> = []; // 保存format格式下年月日的顺序下标；年月日，日月年，月日年，年月。。。\r\n        for (let i: number = 0; i < formatArr.length; i++) {\r\n            if (formatArr[i].indexOf('y') !== -1) {\r\n                arr[0] = i;\r\n            } else if (formatArr[i].indexOf('M') !== -1) {\r\n                arr[1] = i;\r\n            } else if (formatArr[i].indexOf('d') !== -1) {\r\n                arr[2] = i;\r\n            }\r\n        }\r\n        // 处理年月情况\r\n        if (arr.length === 2) {\r\n            dateArr[arr[2]] = '1';\r\n        }\r\n\r\n        // 浏览器兼容性处理：对于非法日期表现不一致：eg:new Date('2018/13/12'),谷歌和火狐处理为非法日期对象，而IE浏览器会处理为2019/1/12；\r\n        // 获取当前月总天数\r\n        const totalDays: number = new Date(parseInt(dateArr[arr[0]], 10), parseInt(dateArr[arr[1]], 10), 0).getDate();\r\n\r\n        // 将时间日期转换成字符串，原因：2018-3-34 不合法日期，用new Date(2018, 2, 34)生成日期对象，会处理成 ==>2018/4/3\r\n        // 将其转换成字符串形式：new Date('2018/2/34')生成日期对象，处理成 ==>Invalid Date对象\r\n        dateValue = TiBrowser.isIE() && (parseInt(dateArr[arr[1]], 10) > 12 || parseInt(dateArr[arr[2]], 10) > totalDays)\r\n           || (String(new Date(parseInt(dateArr[arr[0]], 10), parseInt(dateArr[arr[1]], 10), parseInt(dateArr[arr[2]], 10))) === 'Invalid Date')\r\n           || dateArr.length > 3 ?\r\n                    'Invalid Date' : new Date(`${dateArr[arr[0]]}/${dateArr[arr[1]]}/${dateArr[arr[2]]}`);\r\n\r\n        // 1.输入值为不合法日期：2018-3-34;\r\n        // 2.输入值不在最小值最大值范围内;\r\n        // 3.当前输入框中的值，和上次输入框中的值相同时;\r\n        // tslint:disable-next-line:triple-equals\r\n        this.model = String(dateValue) === 'Invalid Date' || !this.isValidValue(dateValue) || this.isDisabledDays(dateValue)\r\n        ? this.oldModel : new Date(TiDateUtil.getDateStr(dateValue));\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 是否为禁用日期\r\n     */\r\n    public isDisabledDays(value: Date): boolean {\r\n        let isDisabled: boolean = false;\r\n        if (Util.isArray(this.disabledDays) && this.disabledDays.length > 0) {\r\n            this.disabledDays.forEach((item: Date) => {\r\n                if (item.getTime() === value.getTime()) {\r\n                    isDisabled = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        return isDisabled;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDateEditComponent } from './TiDateEditComponent';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiTextModule\r\n  ],\r\n  exports: [TiDateEditComponent],\r\n  declarations: [TiDateEditComponent]\r\n})\r\nexport class TiDateEditModule {\r\n\r\n}\r\nexport { TiDateEditComponent } from './TiDateEditComponent';\r\n","/* eslint-disable no-param-reassign */\r\nimport {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    HostListener,\r\n    Input,\r\n    NgZone,\r\n    Output,\r\n    QueryList,\r\n    Renderer2,\r\n    ViewChild,\r\n    ViewChildren,\r\n    Inject\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDateDominatorComponent } from '../datedominator/TiDateDominatorModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiDateEditComponent } from '../dateedit/TiDateEditModule';\r\nimport { TiButtonComponent } from '../button/TiButtonModule';\r\nimport { TiTextComponent } from '../text/TiTextModule';\r\n\r\n/**\r\n * 时间日期范围类组件value接口\r\n */\r\nexport interface TiDateValue {\r\n    /**\r\n     * 起始时间： Date类型，在最大值最小值范围内\r\n     */\r\n    begin?: Date;\r\n    /**\r\n     * 结束时间： Date类型，在最大值最小值范围内\r\n     */\r\n    end?: Date;\r\n}\r\n\r\nexport interface TiDateCustomizeOptions {\r\n    /**\r\n     * 自定义时间文本\r\n     */\r\n    label: string;\r\n    /**\r\n     * 自定义时间值\r\n     */\r\n    value: TiDateValue;\r\n}\r\n\r\n/**\r\n * 时间日期格式化配置\r\n */\r\nexport interface TiDatetimeFormat {\r\n    /**\r\n     * 日期格式化配置，默认配置'yyyy/MM/dd'\r\n     *\r\n     * 1. 年可以设置为：'yyyy' —— 四位数字表示年：例如：'2016'；\r\n     *\r\n     * 2. 月可以设置为：'MMMM'——月份英文全称(January-December)；\r\n     * 'MMM'——月份英文简称 (Jan-Dec)；\r\n     * 'MM'——两位数字表示月份 (01-12)；\r\n     * 'M'——开头不补零方式表示月份 (1-12).\r\n     *\r\n     * 3. 日可以设置为：\r\n     * dd——两位数字表示日期(01-31);\r\n     * d——开头不补零数字表示日期 (1-31).\r\n     */\r\n    date: string;\r\n    /**\r\n     * 时间格式化配置，默认配置'HH:mm:ss'\r\n     *\r\n     * 1.小时可以设置为：\r\n     *\r\n     * HH —— 24小时制,两位数字表示小时(00-23)\r\n     *\r\n     * H —— 24小时制，开头不补零数字表示小时(0-23)\r\n     *\r\n     * 2.分钟可以设置为：\r\n     *\r\n     * mm —— 两位数字表示分钟值（00-59）\r\n     *\r\n     * m —— 开头不补零数字表示分钟值（0-59）\r\n     *\r\n     * 3.秒可以设置为：\r\n     *\r\n     * ss —— 两位数字表示秒值(00-59)\r\n     *\r\n     * s —— 开头不补零数字表示秒值(0-59)\r\n     *\r\n     * 说明：开头补零是指当前时间是个位数字时，前边补零，始终保持两位数字\r\n     */\r\n    time: string;\r\n}\r\n\r\n/**\r\n * @ignore\r\n * dateRange以及datetimeRange组件适配datepanel的接口类型\r\n */\r\nexport interface TiPicker {\r\n     value?: TiDateValue;\r\n     type?: string;\r\n     picker?: string;\r\n     min?: Date;\r\n     max?: Date;\r\n     nowDateTime?: Date;\r\n     format?: string | TiDatetimeFormat; // 两种类型:date dateRange组件是string类型，datetime datetimeRange组件是DatetimeFormat类型\r\n     select?(): void; // 月份/日期，点击事件回调函数\r\n     selectTimeFn?(val: any): void;\r\n }\r\n\r\n/**\r\n * @ignore\r\n * 配置time组件的接口\r\n */\r\nexport interface TimeOptions {\r\n    value?: string;\r\n    min?: string;\r\n    max?: string;\r\n}\r\n\r\n// lib编译要求@Component\r\n@Component({\r\n    template: ''\r\n})\r\n\r\nexport class TiDateBaseComponent extends TiFormComponent {\r\n    /**\r\n     * @ignore\r\n     * 下拉距离选择框0px\r\n     */\r\n    private static readonly DOMINATOR_SPACE: number = -30;\r\n    /**\r\n     * 日期/日期时间下拉选择框距离浏览器上下边沿的距离为5px，开发者可在项目中整体配置\r\n     */\r\n    public static BROWSER_SPACE: number = 5;\r\n    /**\r\n     * 设置最小值\r\n     */\r\n    @Input() min: Date = TiDateUtil.minDate();\r\n    /**\r\n     * 设置最大值\r\n     */\r\n    @Input() max: Date = TiDateUtil.maxDate();\r\n    /**\r\n     * 设置日期显示格式；详见测试用例\r\n     *\r\n     * date和dateRange组件中类型为string，默认配置为：'yyyy/MM/dd'；\r\n     *\r\n     * datetime和datatimerange组件中类型为TiDatetimeFormat，默认配置：{data: 'yyyy/MM/dd', time: 'HH:mm:ss'}\r\n     *\r\n     */\r\n    @Input() format: string | TiDatetimeFormat;\r\n    /**\r\n     * 由用户自定义现在时间，如果不设置该属性值，则默认为当前系统时间\r\n     */\r\n    @Input() nowDateTime: Date;\r\n    /**\r\n     * 控制时间日期类组件是否展示清除日期图标（默认显示）\r\n     */\r\n    @Input() clearIcon: boolean = true;\r\n    /**\r\n     * 面板对齐方式\r\n     */\r\n    @Input() panelAlign: 'left' | 'right' = 'left';\r\n    /**\r\n     * 配置自定义时间\r\n     */\r\n    @Input() customizeOptions: TiDateCustomizeOptions;\r\n    /**\r\n     * 自定义禁用日期\r\n     */\r\n    @Input() disabledDays: Array<Date>;\r\n    /**\r\n     * 开始值固定不可选\r\n     */\r\n    @Input() isBeginFixed: boolean = false;\r\n    /**\r\n     * 结束值固定不可选\r\n     */\r\n    @Input() isEndFixed: boolean = false;\r\n    /**\r\n     * 此接口只适用于dateRange组件，是否允许结束日期和开始日期为同一天\r\n     */\r\n    @Input() isAllowBeginEqualEnd: boolean = true;\r\n    /**\r\n     * （date组件无该接口）点击时间日期面板上的确认按钮触发的事件\r\n     */\r\n    @Output() readonly okClick: EventEmitter<any> = new EventEmitter();\r\n    /**\r\n     * 点击日期面板上的日期触发的事件\r\n     */\r\n    @Output() readonly dayClick: EventEmitter<any> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     * dominator组件\r\n     */\r\n    @ViewChild(TiDateDominatorComponent, /* TODO: add static flag */ { static: true }) dominatorCom: TiDateDominatorComponent;\r\n    /**\r\n     * @ignore\r\n     * drop下拉组件\r\n     */\r\n    @ViewChild(TiDropComponent, /* TODO: add static flag */ { static: true }) dropCom: TiDropComponent;\r\n    /**\r\n     * @ignore\r\n     *\r\n     * 配合tab快捷键操作的过度Dom\r\n     */\r\n    @ViewChild('input', { static: true }) inputRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     * dateEdit组件\r\n     */\r\n    @ViewChildren(TiDateEditComponent) dateEditComs: QueryList<TiDateEditComponent>;\r\n    /**\r\n     * @ignore\r\n     * 时间编辑框\r\n     */\r\n    @ViewChildren(TiTextComponent) textComs: QueryList<TiTextComponent>;\r\n    /**\r\n     * @ignore\r\n     * button组件\r\n     */\r\n    @ViewChildren(TiButtonComponent) buttonComs: QueryList<TiButtonComponent>;\r\n\r\n    private readonly localeWords: TiLocaleWords = TiLocale.getLocaleWords();\r\n\r\n    // 该基类主要用于实现公共变量接口声明,公共的事件，以及公共方法\r\n    /**\r\n     * @ignore\r\n     * 保存旧日期显示格式\r\n     */\r\n    public oldFormat: string | TiDatetimeFormat;\r\n    /**\r\n     * @ignore\r\n     * 保存旧开始日期\r\n     */\r\n    public oldBeginValue: Date;\r\n    /**\r\n     * @ignore\r\n     * 保存旧结束日期\r\n     */\r\n    public oldEndValue: Date;\r\n    /**\r\n     * @ignore\r\n     * 保存旧model值：date类型或者datevalue类型\r\n     */\r\n    public oldModel: Date | TiDateValue;\r\n    /**\r\n     * @ignore\r\n     * 判断当前value值是不是合法的，不合法则确认按钮灰化\r\n     */\r\n    public inValidValue: boolean;\r\n    /**\r\n     * @ignore\r\n     * 标记点击叉号\r\n     */\r\n    public isClearClick: boolean;\r\n    /**\r\n     * @ignore\r\n     * 标志是日期还是时间日期\r\n     */\r\n    public isDatetime: boolean;\r\n    /**\r\n     * @ignore\r\n     * 标志是时间日期还是时间日期段\r\n     */\r\n    public isRange: boolean;\r\n    /**\r\n     * @ignore\r\n     * 标志是时间选择面板还是日期选择面板\r\n     */\r\n    public selectTime: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 对应每个时间日期组件的最大最小值的配置\r\n     */\r\n    public config: {min: Date, max: Date} = {\r\n        min: TiDateUtil.minDate(),\r\n        max: TiDateUtil.maxDate()\r\n    };\r\n    /**\r\n     * @ignore\r\n     * model默认值\r\n     */\r\n    public defaultValue: TiDateValue = {\r\n        begin: null,\r\n        end: null\r\n    };\r\n    /**\r\n     * @ignore\r\n     * 模板初始化\r\n     */\r\n    public datePanel: TiPicker = {\r\n        value: this.defaultValue\r\n    };\r\n\r\n    /**\r\n     * @ignore\r\n     * date/datetime 面板宽度\r\n     */\r\n    public datePanelWidth: string = '286px';\r\n    /**\r\n     * @ignore\r\n     * daterange/datetimerange 面板宽度\r\n     */\r\n    public daterangePanelWidth: string = '558px';\r\n    /**\r\n     * @ignore\r\n     * 日期显示字符串\r\n     */\r\n    public inputValue: string = '';\r\n    private documentKeydownListener: () => void;\r\n    /**\r\n     * @ignore\r\n     * 模板中使用\r\n     */\r\n    public browserSpace: string = TiDateBaseComponent.BROWSER_SPACE + 'px';\r\n    /**\r\n     * @ignore 面板与dominator的距离\r\n     */\r\n    public dominatorSpace: string = TiDateBaseComponent.DOMINATOR_SPACE + 'px';\r\n    /**\r\n     * @ignore\r\n     * 记录当前面板内部编辑区域焦点位置\r\n     */\r\n    public focusedPosition: string = 'begin';\r\n    /**\r\n     * @ignore\r\n     * 时间编辑框placehoder\r\n     */\r\n    public timeplaceholder: string = 'hh:mm:ss';\r\n    /**\r\n     * @ignore\r\n     * 底部选择时间按钮禁用标志\r\n     */\r\n    public timeEditDisabled: boolean;\r\n    /**\r\n     * @ignore\r\n     * 标志是否存在左侧自定义时间区域\r\n     */\r\n    public hasCustomizeTime: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 可聚焦元素集合\r\n     */\r\n    public focusElementsArr: Array<any> = [];\r\n\r\n    constructor(protected hostRef: ElementRef, protected render: Renderer2, private zone: NgZone,\r\n        @Inject(DOCUMENT) private document) {\r\n        super(hostRef, render);\r\n    }\r\n\r\n    private static getFocusElements(focusComs: any, focusElements: Array<any>): Array<any> {\r\n        for (const focusCom of focusComs.toArray()) {\r\n            focusElements = focusElements.concat(focusCom.getFocusableElems());\r\n        }\r\n\r\n        return focusElements;\r\n    }\r\n\r\n    /**\r\n     * 组件快捷键处理tab键 enter键\r\n     */\r\n    @HostListener('keydown', ['$event']) public onKeydown(event: KeyboardEvent): void {\r\n        switch (event.keyCode) {\r\n            case TiKeymap.KEY_TAB : // TAB键\r\n                this.hidePanel();\r\n                break;\r\n            case TiKeymap.KEY_ENTER : // ENTER键(大键盘)\r\n            case TiKeymap.KEY_NUMPAD_ENTER : // ENTER键(数字小键盘)\r\n                this.responseEnter();\r\n                break;\r\n            default :\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * writeValue区分是不是range组件：\r\n     */\r\n    writeValue(value: any): void {\r\n        super.writeValue(value);\r\n        // 1.daterange和datetimerange组件的处理\r\n        // 新旧值判断处理放在docheck中\r\n        if (this.isRange) {\r\n            // value不是对象时，将value设置为null，输入框中显示空白\r\n            if (!(value instanceof Object) || !this.isValidValue(value)) {\r\n                this.model = null;\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        // 2.date和datetime组件的处理，非法时间日期值统一置为null，显示空\r\n        if (!this.isValidValue(value)) {\r\n            this.model = null;\r\n\r\n            return;\r\n        }\r\n\r\n        // 新旧值相同时不作处理；\r\n        if (TiDateUtil.isDateEqual(value, this.model)) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line:use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 是否存在左侧自定义面板\r\n        this.hasCustomizeTime = !Util.isUndefined(this.customizeOptions) && !Util.isNull(this.customizeOptions);\r\n        // format接口校验:对时间日期进行国际化处理\r\n        this.validateFormat(this.isDatetime);\r\n\r\n        // 最大最小值校验\r\n        this.validateMinAndMax(this.config, this.isDatetime);\r\n\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            // document上的Ecs快捷键功能\r\n            this.documentKeydownListener = this.render.listen(this.document, 'keydown', this.keydownHandlerFn);\r\n        });\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        // 定义变量存储聚焦元素；\r\n        let focusElements: Array<any> = [];\r\n\r\n        // 获取dateedit的聚焦元素\r\n        focusElements = TiDateBaseComponent.getFocusElements(this.dateEditComs, focusElements);\r\n        // 获取时间编辑框聚焦元素\r\n        if (this.textComs.length !== 0) {\r\n            for (const textCom of this.textComs.toArray()) {\r\n                focusElements = focusElements.concat(textCom.nativeElement);\r\n            }\r\n        }\r\n\r\n        if (this.inputRef) {\r\n            focusElements = focusElements.concat(this.inputRef.nativeElement);\r\n        }\r\n\r\n        // 获取确认取消按钮的聚焦元素\r\n        for (const buttonCom of this.buttonComs.toArray()) {\r\n            focusElements = focusElements.concat(buttonCom.nativeElement);\r\n        }\r\n        this.focusElementsArr = focusElements;\r\n        this.setFocusableElems([this.dominatorCom.nativeElement]\r\n            .concat(this.dropCom.nativeElement)\r\n            .concat(focusElements));\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        if (this.documentKeydownListener) {\r\n            this.documentKeydownListener();\r\n        }\r\n    }\r\n\r\n    protected keydownHandlerFn = (event: KeyboardEvent): void => {\r\n        if (!this.dropCom.isShow) {\r\n            return;\r\n        }\r\n        if (event.keyCode === TiKeymap.KEY_ESCAPE) {\r\n            this.hidePanel();\r\n            this.dominatorCom.focus();\r\n        }\r\n        this.tabKeydown(event);\r\n    }\r\n\r\n    /**\r\n     * 实现按tab键时，focus在下拉面板中循环\r\n     */\r\n    private tabKeydown(event: KeyboardEvent): void {\r\n        if(this.focusElementsArr.length === 0 ) {\r\n            return;\r\n        }\r\n        let focusChanged: boolean = false;\r\n        if (event.keyCode === TiKeymap.KEY_TAB) {\r\n            const panelFocusElementsArr = this.focusElementsArr.filter((item: any) => !item.hasAttribute('disabled'));\r\n            if (event.shiftKey) {\r\n                if(event.target === panelFocusElementsArr[0]) {\r\n                    focusChanged = true;\r\n                    panelFocusElementsArr[panelFocusElementsArr.length - 1].focus();\r\n                }\r\n            } else if (event.target === panelFocusElementsArr[panelFocusElementsArr.length - 1]) {\r\n                focusChanged = true;\r\n                panelFocusElementsArr[0].focus();\r\n            }\r\n        }\r\n        if (focusChanged) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n    }\r\n\r\n    // ----------------------------- 公共事件处理 -----------------------------\r\n    /**\r\n     * @ignore\r\n     * 点击面板展开收起函数\r\n     */\r\n    public onShowClick(): void {\r\n        if (this.disabled) { // 非灰化可点击展开面板\r\n            return;\r\n        }\r\n\r\n        if (this.dropCom.isShow || this.isClearClick) {\r\n            this.isClearClick = false;\r\n            this.dropCom.hide();\r\n        } else {\r\n            // 配置时间日期面板接口\r\n            this.setPickerDate();\r\n            this.show();\r\n            this.selectTime = false; // 面板打开初次总展示日期面板\r\n            setTimeout(() => {\r\n                if (this.isBeginFixed && !this.isEndFixed) {\r\n                    this.dateEditComs.last.focus(); // 开始值固定，则第二个编辑区域聚焦\r\n                    this.focusedPosition = 'end';\r\n                } else {\r\n                    this.dateEditComs.first.focus(); // 初始化打开面板，第一个编辑区域聚焦\r\n                    this.focusedPosition = 'begin';\r\n                }\r\n            }, 0);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 左侧自定义时间文本点击事件\r\n     */\r\n    public customizeTimeClickFn(val: TiDateValue): void {\r\n        this.model = val;\r\n        this.dropCom.hide();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击选择时间，根据初始传入值设定下拉选择项\r\n     */\r\n    public selectTimeFn(): void {\r\n        if (this.timeEditDisabled) {\r\n            return;\r\n        }\r\n        this.selectTime = true; // 切换为时间选择面板\r\n        this.textComs.first.nativeElement.focus();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public selectDateFn(): void {\r\n        this.selectTime = false;\r\n        this.dateEditComs.first.nativeElement.focus();\r\n        this.focusedPosition = 'begin';\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public dateEditClick(val: string): void {\r\n        if (this.isBeginFixed || this.isEndFixed) {\r\n            return;\r\n        }\r\n        this.focusedPosition = val;\r\n        this.selectTime = false;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public dateEditFocus(val: string): void {\r\n        this.focusedPosition = val;\r\n        this.selectTime = false;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 时间框聚焦\r\n     */\r\n    public timeFocus(val: string): void {\r\n        this.selectTime = true;\r\n        this.focusedPosition = val === 'begin' ? 'beginTime' : 'endTime';\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public setTimeFn(obj: any, beginTime: TimeOptions, endTime?: TimeOptions): void {\r\n        const timePosition: string = obj.timeOption;\r\n        const beginTimeArr: any = beginTime.value.split(':');\r\n        let endTimeArr: any;\r\n        if (!Util.isUndefined(endTime)) {\r\n            endTimeArr = endTime.value.split(':');\r\n        }\r\n        switch (timePosition) {\r\n            case 'beginHour':\r\n                beginTimeArr[0] = obj.val.label;\r\n                break;\r\n            case 'beginMinute':\r\n                beginTimeArr[1] = obj.val.label;\r\n                break;\r\n            case 'beginSecond':\r\n                beginTimeArr[2] = obj.val.label;\r\n                break;\r\n            case 'endHour':\r\n                endTimeArr[0] = obj.val.label;\r\n                break;\r\n            case 'endMinute':\r\n                endTimeArr[1] = obj.val.label;\r\n                break;\r\n            case 'endSecond':\r\n                endTimeArr[2] = obj.val.label;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        beginTime.value = beginTimeArr.join(':');\r\n        if (!Util.isUndefined(endTime)) {\r\n            endTime.value = endTimeArr.join(':');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 点击删除按钮\r\n     */\r\n    public onIconClearClick(event: MouseEvent): void {\r\n        // 阻止事件冒泡：可以防止点击叉号引起面板的显示或者隐藏，但此处不能阻止事件冒泡，\r\n        // 事件不会冒泡到document上，会出现页面上其他下拉类组件面板不收起情况\r\n        // 添加标志量，在onShowClick函数中处理\r\n        if (this.disabled || !this.clearIcon) {\r\n            return;\r\n        }\r\n        this.isClearClick = true;\r\n        this.model = null;\r\n        this.oldBeginValue = null;\r\n        this.oldEndValue = null;\r\n        this.inputValue = '';\r\n        // 时间日期面板显示则隐藏\r\n        this.hidePanel();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 隐藏drop, 适用于drop中用户点击引起drop隐藏，阻止了整体失焦。\r\n     */\r\n    public hideDrop(): void {\r\n        // 阻止整体失去焦点\r\n        this.dominatorCom.focus();\r\n        this.dropCom.hide();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 隐藏面板\r\n     */\r\n    public hidePanel(): void {\r\n        if (this.dropCom.isShow) {\r\n            this.dropCom.hide();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * enter键的功能：如果面板展开不处理，面板收起则展开，设置datePanel指令的接口值\r\n     */\r\n    public responseEnter(): void {\r\n        if (this.dropCom.isShow) {\r\n            return;\r\n        }\r\n\r\n        // 面板收起前是年或月面板，按enter键重新设置datePanel指令的接口值\r\n        this.setPickerDate();\r\n\r\n        // 时间面板展开\r\n        this.show();\r\n        setTimeout(()=> {\r\n            this.dateEditComs.first.nativeElement.focus();\r\n            this.focusedPosition = 'begin';\r\n        }, 0);\r\n    }\r\n    /**\r\n     * @ignore\r\n     *\r\n     * 设置按钮禁用场景下 过度input的样式（适配tab快捷键场景）\r\n     */\r\n    public setInputStyle(val: boolean): void {\r\n        if(val) {\r\n            this.render.removeStyle(this.inputRef.nativeElement, 'display');\r\n            this.render.setStyle(this.inputRef.nativeElement, 'opacity', '0');\r\n        } else {\r\n            this.render.setStyle(this.inputRef.nativeElement, 'display', 'none');\r\n        }\r\n    }\r\n\r\n    // ----------------------------- 公共方法处理 -----------------------------\r\n    /**\r\n     * @ignore\r\n     * 判断是不是合法的DatetimeFormat: format为对象 {date:'', time: ''}\r\n     */\r\n    public isValidDatetimeFormat(): boolean {\r\n        return (this.format instanceof Object) && Util.isString(this.format['date']) && Util.isString(this.format['time']);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 最大值最小值校验:和date组件不同，此处不需要做最大最小时分秒处理\r\n     */\r\n    public validateMinAndMax(dateCofig: {min: Date, max: Date}, isDatetime: boolean): void {\r\n        const maxChanged: Date = isDatetime ? this.max : TiDateUtil.changeMaxTime(this.max);\r\n        this.max = TiDateUtil.isDate(this.max) ? maxChanged : dateCofig.max;\r\n\r\n        const minChanged: Date = isDatetime ? this.min : TiDateUtil.changeMinTime(this.min);\r\n        this.min = TiDateUtil.isDate(this.min) ? minChanged : dateCofig.min;\r\n\r\n        // 最大最小值矛盾时，设置为默认值\r\n        if (this.max.getTime() < this.min.getTime()) {\r\n            this.max = dateCofig.max;\r\n            this.min = dateCofig.min;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 校验format接口\r\n     */\r\n    public validateFormat(isDatetime: boolean): void {\r\n        if (isDatetime) {\r\n            this.validateDatetimeFormat();\r\n        } else {\r\n            this.validateDateFormat();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 校验format: string类型，\r\n     */\r\n    public validateDateFormat(): void {\r\n        if (Util.isString(this.format)) {\r\n            return;\r\n        }\r\n        // TODO:如果配置时间日期国际化\r\n        this.format = this.localeWords.tiLocaleDate['date'];\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 校验format: 对象类型{date:'', time:''}\r\n     */\r\n    public validateDatetimeFormat(): void {\r\n        // TODO:初始化为ngLocale格式\r\n        // 用户设置format不是一个对象，设置为国际配置的format或默认值\r\n        if (!(this.format instanceof Object)) {\r\n            this.format = {\r\n                date: this.localeWords.tiLocaleDate['date'],\r\n                time: this.localeWords.tiLocaleDate['time']\r\n            };\r\n\r\n            return;\r\n        }\r\n\r\n        // format 为联合类型:此处处理DatetimeFormat类型\r\n        this.format = this.format as TiDatetimeFormat;\r\n        // 日期格式校验\r\n        if (!Util.isString(this.format.date)) {\r\n            this.format.date = this.localeWords.tiLocaleDate['date'];\r\n        }\r\n\r\n        // 日期格式校验\r\n        if (!Util.isString(this.format.time)) {\r\n            this.format.time = this.localeWords.tiLocaleDate['time'];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 判断range类型的model是否变化：比较起始时间和结束时间\r\n     */\r\n    public rangeValueIsEqual(newValue: TiDateValue, oldValue: TiDateValue, isDatetime: boolean): boolean {\r\n        if (newValue === oldValue) {\r\n            return true;\r\n        }\r\n\r\n        if ((newValue instanceof Object) && (oldValue instanceof Object)) {\r\n            if (isDatetime) {\r\n                return (TiDateUtil.isDatetimeEqual(newValue['begin'], oldValue['begin']) &&\r\n                             TiDateUtil.isDatetimeEqual(newValue['end'], oldValue['end']));\r\n            } else {\r\n                return (TiDateUtil.isDateEqual(newValue['begin'], oldValue['begin']) &&\r\n                             TiDateUtil.isDateEqual(newValue['end'], oldValue['end']));\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // ----------------------------- 动态监听处理 -----------------------------\r\n    /**\r\n     * @ignore\r\n     * model值动态变更：支持仅修改begin或end值\r\n     */\r\n    public setModel(isDatetime: boolean): void {\r\n        if (this.rangeValueIsEqual(this.model, this.oldModel as TiDateValue, isDatetime)) {\r\n            return;\r\n        }\r\n\r\n        // model中begin或者end值的变更\r\n        this.formatValue();\r\n\r\n        // 通过按钮改变model值：当面板处于打开状态时需要重新设置面板接口\r\n        if (this.dropCom.isShow) {\r\n            this.setPickerDate();\r\n        }\r\n\r\n        this.oldModel = (this.model === null) ? null : {\r\n            begin: this.model.begin,\r\n            end: this.model.end\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * datetime与datetimeRange组件format动态变更\r\n     */\r\n    public setFormat(): void {\r\n        if (this.format && this.format['date'] === this.oldFormat['date'] &&\r\n            this.format['time'] === this.oldFormat['time']) {\r\n                return;\r\n        }\r\n\r\n        if (!this.isValidDatetimeFormat()) {\r\n            this.format = this.oldFormat;\r\n\r\n            return;\r\n        }\r\n\r\n        this.formatValue();\r\n        this.oldFormat = this.format;\r\n    }\r\n\r\n    private show(): void {\r\n        if (this.renderer.parentNode(this.dropCom.nativeElement) === document.body) {\r\n           this.dropCom.show();\r\n        } else {\r\n            // 使用setTimeout是为了保证datepanel渲染完成后再显示，否则首次打开时定位计算不准确\r\n            setTimeout(() => {\r\n                this.dropCom.show();\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 决定上下位置的函数\r\n     */\r\n    public determinPositionFn: (layout: any) => string = (layout: any) =>  {\r\n        const needHeight: number = layout.targetLayout.height + TiDateBaseComponent.DOMINATOR_SPACE + TiDateBaseComponent.BROWSER_SPACE;\r\n        if (layout.avilableLayout.bottom >= needHeight) { // 下方空间足够，向下展开\r\n            return this.panelAlign === 'left' ? 'bottom-left' : 'bottom-right';\r\n        } else {\r\n            return this.panelAlign === 'left' ? 'top-left' : 'top-right';\r\n        }\r\n    }\r\n\r\n    // ----------------------------- 需要在子类中实现 -----------------------------\r\n    /**\r\n     * @ignore\r\n     * 0.判断是不是合法的model\r\n     */\r\n    protected isValidValue(value: any): boolean {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 1.配置时间日期面板接口\r\n     */\r\n    protected setPickerDate(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 2.根据format格式model值\r\n     */\r\n    protected formatValue(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 3.根据当前值设置确认按钮的状态\r\n     */\r\n    protected setOkBtnState(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 起始面板日期有变化时，要重新设置其time组件对应最大值 datetimeRange组件中实现此方法\r\n     */\r\n    protected setBeginTimeMaxValue(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 起始面板日期有变化时，要重新设置其time组件对应最小值 datetimeRange组件中实现此方法\r\n     */\r\n    protected setBeginTimeMinValue(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 结束日期有变化时，要重新设置其time组件对应最大值 datetimeRange组件中实现此方法\r\n     */\r\n    protected setEndTimeMaxValue(): void {}\r\n\r\n    /**\r\n     * @ignore\r\n     * 结束日期有变化时，要重新设置其time组件对应最小值 datetimeRange组件中实现此方法\r\n     */\r\n    protected setEndTimeMinValue(): void {}\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiDateBaseComponent } from './TiDateBaseComponent';\r\n// 在使用tiny npm包生产环境编辑时，要求基类也注册。\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [],\r\n  exports: [],\r\n  declarations: [\r\n    TiDateBaseComponent\r\n  ]\r\n})\r\nexport class TiDateBaseModule {\r\n}\r\nexport { TiDateBaseComponent, TimeOptions, TiPicker, TiDatetimeFormat, TiDateValue, TiDateCustomizeOptions } from './TiDateBaseComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    Output,\r\n    Renderer2,\r\n    SimpleChanges,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { TiDateUtil, Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiDateValue, TimeOptions } from '../datebase/TiDateBaseModule';\r\nimport { TiDropComponent } from './../drop/TiDropModule';\r\nimport { TiListComponent } from '../list/TiListModule';\r\n\r\n/**\r\n * @ignore\r\n * 面板内部年月日\r\n */\r\nexport interface TiDatePanel {\r\n    year: number;\r\n    month: number;\r\n    day: number;\r\n }\r\n\r\n/**\r\n * @ignore\r\n * 面板头部显示文本接口\r\n */\r\nexport interface TiPickerHeadText {\r\n    year?: string;\r\n    month?: string;\r\n    yearRange?: string;\r\n    endpanelYearRange?: string;\r\n    onlyYear?: string;\r\n}\r\n\r\n/**\r\n * @ignore\r\n * 年月日数据的接口：state状态；value年月日值\r\n */\r\nexport interface TiDateValueAndState {\r\n    state: string; // 面板中每个年月日具体的状态：日期：状态值为上个月日期，当前月日期，下个月日期\r\n    value: number | string; // TODO:类型为string或number:此处处理 this.local.monthArr.indexOf(month.value + '')\r\n    isToday?: boolean;\r\n    isMonth?: boolean;\r\n    isYear?: boolean;\r\n}\r\n\r\n/**\r\n * @ignore\r\n * 最大年最小年范围\r\n */\r\nexport interface TiYearRange {\r\n    min: number;\r\n    max: number;\r\n }\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n   selector: 'ti-date-panel',\r\n   templateUrl: './datepanel.html',\r\n   styleUrls: ['./datepanel.less']\r\n})\r\n\r\nexport class TiDatePanelComponent extends TiBaseComponent {\r\n   @Input() value: TiDateValue;\r\n   @Output() readonly valueChange: EventEmitter<TiDateValue> = new EventEmitter<TiDateValue>();\r\n\r\n   @Input() picker: string = 'day'; // 设置年、月、日面板\r\n   @Output() readonly pickerChange: EventEmitter<string> = new EventEmitter<string>();\r\n\r\n   @Input() nowDateTime: Date;\r\n   @Input() max: Date;\r\n   @Input() min: Date;\r\n   @Input() format: string;\r\n   @Input() disabledDays: Array<Date>;\r\n   @Input() endTimeDisabled: boolean;\r\n   @Input() beginTimeDisabled: boolean;\r\n   /**\r\n    * @ignore\r\n    * 面板内部焦点位置标志量\r\n    */\r\n   @Input() focusedPosition: string;\r\n   /**\r\n    * @ignore\r\n    * 面板呈现选择时间或者选择日期 标志量\r\n    */\r\n   @Input() selectTime: boolean;\r\n   /**\r\n    * @ignore\r\n    * 开始时间\r\n    */\r\n   @Input() beginTime: TimeOptions;\r\n   /**\r\n    * @ignore\r\n    * 结束时间\r\n    */\r\n   @Input() endTime: TimeOptions;\r\n   /**\r\n    * @ignore\r\n    * 判断是单日期（时间）还是日期（时间）段\r\n    */\r\n   @Input() isRange: boolean;\r\n    /**\r\n     * 开始日期是否禁用\r\n     */\r\n   @Input() isBeginFixed: boolean = false;\r\n   /**\r\n    * 结束日期是否禁用\r\n    */\r\n   @Input() isEndFixed: boolean = false;\r\n\r\n   // 日期面板，月份面板点击每个日期、月份的事件回调\r\n   // tslint:disable-next-line:no-output-named-after-standard-event\r\n   @Output() readonly select: EventEmitter<any> = new EventEmitter<any>();\r\n   // 时间面板选择时分秒的事件回调\r\n   @Output() readonly selectTimeFn: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n   @ViewChild('next', { static: true }) nextRef: ElementRef;\r\n   @ViewChild('beginHourContainer', { static: true }) private beginHourContainerRef: ElementRef;\r\n   @ViewChild('beginMinuteContainer', { static: true }) private beginMinuteContainerRef: ElementRef;\r\n   @ViewChild('beginSecondContainer', { static: true }) private beginSecondContainerRef: ElementRef;\r\n   @ViewChild('endHourContainer', { static: true }) private endHourContainerRef: ElementRef;\r\n   @ViewChild('endMinuteContainer', { static: true }) private endMinuteContainerRef: ElementRef;\r\n   @ViewChild('endSecondContainer', { static: true }) private endSecondContainerRef: ElementRef;\r\n   private date: TiDatePanel; // 内部时间值：包括年月日\r\n   public dayArr: Array<Array<TiDateValueAndState>> = [];\r\n   public nextdayArr: Array<Array<TiDateValueAndState>> = [];\r\n   public monthArr: Array<Array<TiDateValueAndState>> = [];\r\n   public endpanelMonthArr: Array<Array<TiDateValueAndState>> = [];\r\n   public yearArr: Array<Array<TiDateValueAndState>> = [];\r\n   public endpanelYearArr: Array<Array<TiDateValueAndState>> = [];\r\n   public pickerValue: TiPickerHeadText = {}; // 面板头部显示文本数据\r\n   public nextPickerValue: TiPickerHeadText = {}; // 面板头部显示文本数据\r\n   public isMaxMonth: boolean;\r\n   public isMinMonth: boolean;\r\n   private isMaxYear: boolean;\r\n   private isMinYear: boolean;\r\n   private isMaxYearRange: boolean;\r\n   private isMinYearRange: boolean;\r\n   private oldValue: TiDateValue = { // 当初始值为null时，做新旧值对比渲染时间面板\r\n       begin: undefined,\r\n       end: undefined\r\n   };\r\n   public hourOptions: Array<any> = this.setOptions(24);\r\n   public minuteOptions: Array<any> = this.setOptions(60);\r\n   public secondOptions: Array<any> = this.setOptions(60);\r\n   public endHourOptions: Array<any> = this.setOptions(24);\r\n   public endMinuteOptions: Array<any> = this.setOptions(60);\r\n   public endSecondOptions: Array<any> = this.setOptions(60);\r\n   public beginHour: any;\r\n   public beginMinute: any;\r\n   public beginSecond: any;\r\n   public endHour: any;\r\n   public endMinute: any;\r\n   public endSecond: any;\r\n   public isChinese: boolean = true;\r\n\r\n    public local: {\r\n        weekArr: Array<string>,\r\n        weekTitleArr: Array<string>,\r\n        monthArr: Array<string>,\r\n        yearText: string\r\n    } = {\r\n            weekArr: [],\r\n            weekTitleArr: [],\r\n            monthArr: [],\r\n            yearText: ''\r\n        };\r\n\r\n   constructor(protected render: Renderer2,\r\n               protected hostRef: ElementRef,\r\n               public drop: TiDropComponent\r\n    ) {\r\n        super(hostRef, render);\r\n   }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        const localeWords: TiLocaleWords = TiLocale.getLocaleWords();\r\n        this.isChinese = localeWords.tiLocaleKey === TiLocale.ZH_CN;\r\n        this.local = {\r\n            weekArr: localeWords.tiDate['weekNamesAbb'],\r\n            weekTitleArr: localeWords.tiDate['weeknamesTitle'],\r\n            monthArr: localeWords.tiDate['monthNamesAbb'],\r\n            yearText: localeWords.tiDate['yearSuffixLabel']\r\n        };\r\n        this.drop.dropSubject.subscribe(() => {\r\n            this.setValue();\r\n        });\r\n        this.renderer.listen(this.nativeElement, 'mousedown', (event: MouseEvent): void => {\r\n            event.preventDefault(); // 防止dominator blur行为\r\n        });\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes['endTimeDisabled'] && !changes['endTimeDisabled'].firstChange) {\r\n            this.endHourOptions = this.setOptions(24, 'end');\r\n            this.endMinuteOptions = this.setOptions(60, 'end');\r\n            this.endSecondOptions = this.setOptions(60, 'end');\r\n        }\r\n        if (changes['beginTimeDisabled'] && !changes['beginTimeDisabled'].firstChange) {\r\n            this.hourOptions = this.setOptions(24);\r\n            this.minuteOptions = this.setOptions(60);\r\n            this.secondOptions = this.setOptions(60);\r\n        }\r\n        // format支持动态变更\r\n        if (changes['picker'] && !changes['picker'].firstChange) {\r\n            if (Util.isUndefined(this.date)) {\r\n                return;\r\n            }\r\n\r\n            // 设置下拉面板的数据\r\n            this.setDatePanel();\r\n        }\r\n        // 最大最小值更新时，需要更新面板来保证最大最小值外的禁用有效\r\n        if ((changes['max'] && !changes['max'].firstChange) || (changes['min'] && !changes['min'].firstChange)) {\r\n            this.setDatePanel();\r\n        }\r\n        // 根据传入值确定时间下拉选择项\r\n        if (changes['selectTime'] && !changes['selectTime'].firstChange) {\r\n            const beginTimeStrArr: Array<any> = this.beginTime.value.split(':');\r\n            this.beginHour = this.hourOptions.find((item: any) => item.label === beginTimeStrArr[0]);\r\n            this.beginMinute = this.minuteOptions.find((item: any) => item.label === beginTimeStrArr[1]);\r\n            this.beginSecond = this.secondOptions.find((item: any) => item.label === beginTimeStrArr[2]);\r\n\r\n            if (this.endTime) {\r\n            const endTimeStrArr: Array<any> = this.endTime.value.split(':');\r\n            this.endHour = this.endHourOptions.find((item: any) => item.label === endTimeStrArr[0]);\r\n            this.endMinute = this.endMinuteOptions.find((item: any) => item.label === endTimeStrArr[1]);\r\n            this.endSecond = this.endSecondOptions.find((item: any) => item.label === endTimeStrArr[2]);\r\n            }\r\n            setTimeout(() => {\r\n                this.timeHandleFn(this.beginHour, this.beginHourContainerRef);\r\n                this.timeHandleFn(this.beginMinute, this.beginMinuteContainerRef);\r\n                this.timeHandleFn(this.beginSecond, this.beginSecondContainerRef);\r\n                if (this.endTime) {\r\n                    this.timeHandleFn(this.endHour, this.endHourContainerRef);\r\n                    this.timeHandleFn(this.endMinute, this.endMinuteContainerRef);\r\n                    this.timeHandleFn(this.endSecond, this.endSecondContainerRef);\r\n                }\r\n            }, 0);\r\n        }\r\n\r\n        if (changes['beginTime'] && !changes['beginTime'].firstChange) {\r\n            const beginTimeArr: Array<any> = changes['beginTime'].currentValue.value.split(':');\r\n            this.beginHour = this.hourOptions.find((item: any) => item.label === beginTimeArr[0]);\r\n            this.beginMinute = this.minuteOptions.find((item: any) => item.label === beginTimeArr[1]);\r\n            this.beginSecond = this.secondOptions.find((item: any) => item.label === beginTimeArr[2]);\r\n            this.timeHandleFn(this.beginHour, this.beginHourContainerRef);\r\n            this.timeHandleFn(this.beginMinute, this.beginMinuteContainerRef);\r\n            this.timeHandleFn(this.beginSecond, this.beginSecondContainerRef);\r\n        }\r\n\r\n        if (changes['endTime'] && !changes['endTime'].firstChange) {\r\n            const endTimeArr: Array<any> = changes['endTime'].currentValue.value.split(':');\r\n            this.endHour = this.endHourOptions.find((item: any) => item.label === endTimeArr[0]);\r\n            this.endMinute = this.endMinuteOptions.find((item: any) => item.label === endTimeArr[1]);\r\n            this.endSecond = this.endSecondOptions.find((item: any) => item.label === endTimeArr[2]);\r\n            this.timeHandleFn(this.endHour, this.endHourContainerRef);\r\n            this.timeHandleFn(this.endMinute, this.endMinuteContainerRef);\r\n            this.timeHandleFn(this.endSecond, this.endSecondContainerRef);\r\n        }\r\n\r\n    }\r\n\r\n    private timeHandleFn(model: any, ele: ElementRef) {\r\n        if (model === undefined) {\r\n            return;\r\n        }\r\n        const index: number = model.label;\r\n        this.render.setProperty(ele.nativeElement.children[0], 'scrollTop', index * 30);\r\n        // TODO 动画效果\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n       super.ngDoCheck();\r\n\r\n       // 只有点击面板打开时，才会有接口值，需要渲染面板，在没有打开时间日期面板时不需要渲染面板数据\r\n       if (Util.isUndefined(this.value) || Util.isUndefined(this.max)) {\r\n           return;\r\n       }\r\n\r\n       if (!TiDateUtil.isDateEqual(this.oldValue['begin'], this.value['begin']) ||\r\n           !TiDateUtil.isDateEqual(this.oldValue['end'], this.value['end'])) {\r\n            this.setValue();\r\n            this.oldValue = {\r\n                begin: this.value.begin,\r\n                end: this.value.end\r\n            };\r\n       }\r\n    }\r\n\r\n    // 处理左侧年后退按钮事件\r\n    onPreYearClick(event: MouseEvent): void {\r\n        // 最小月，最小年，最小年时间段：左按钮灰化\r\n        if (this.isPickerYearMinValue()) {\r\n            return;\r\n        }\r\n\r\n        // 日期和月份面板\r\n        if (this.picker === 'day' || this.picker === 'month' || this.picker === 'onlyYearMonth') {\r\n            const year: number = this.date.year - 1; // 年份减1\r\n            if (year >= this.min.getFullYear()) { // 当年份大于等于最小值\r\n                this.date.year = year;\r\n                if (this.isSmallerThanMinMonth(year, this.date.month)) {\r\n                this.date.month = this.min.getMonth() + 1;\r\n                }\r\n                this.setYearMonthText();\r\n                this.setPreNextState(year, this.date.month);\r\n                this.setDayMonthArr(this.picker);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // 年面板\r\n        if (this.picker === 'year') {\r\n            // 当前年减10\r\n            const year: number = this.date.year - 10; // 年份减10\r\n            const minValueRange: TiYearRange = this.getYearRange(this.min.getFullYear()); // 最小年：年面板的范围\r\n            const currentYearRange: TiYearRange = this.getYearRange(year); // 当前年面板的范围\r\n            // 当年份大于等于最小年面板的最小值是有效的\r\n            if (year >= minValueRange.min) {\r\n                this.date.year = currentYearRange.min; // 默认跳转到年面板的第一个有效年\r\n                // 设置下拉面板头部显示文本\r\n                this.setYearMonthText();\r\n\r\n                // 设置左右键状态\r\n                this.setYearRangePreNextState();\r\n\r\n                // 设置年份面板的值和状态\r\n                this.setYearArr();\r\n\r\n                this.setEndpanelYearArr();\r\n            }\r\n        }\r\n    }\r\n\r\n    // 处理左侧月后退按钮事件\r\n    onPreMonthClick(event: MouseEvent): void {\r\n        // 最小月，最小年，最小年时间段：左按钮灰化\r\n        if (this.isMinMonth) {\r\n            return;\r\n        }\r\n        // 日期面板\r\n        let month: number;\r\n        let year: number;\r\n        if (this.date.month === 1) {\r\n            month = 12;\r\n            year = this.date.year - 1;\r\n        } else {\r\n            month = this.date.month - 1;\r\n            year = this.date.year;\r\n        }\r\n\r\n        if (!this.isSmallerThanMinMonth(year, month)) {\r\n            this.date.month = month;\r\n            this.date.year = year;\r\n            this.setYearMonthText();\r\n            this.setPreNextState(year, month);\r\n            this.setDayArr();\r\n            this.setNextDayArr();\r\n        }\r\n    }\r\n    // 处理右侧月前进按钮事件\r\n    onNextMonthClick(event: MouseEvent): void {\r\n        // 最大月，最大年，最大年时间段\r\n        if (this.isMaxMonth) {\r\n            return;\r\n        }\r\n\r\n        let month: number;\r\n        let year: number;\r\n        if (this.date.month === 12) {\r\n            month = 1;\r\n            year = this.date.year + 1;\r\n        } else {\r\n            month = this.date.month + 1;\r\n            year = this.date.year;\r\n        }\r\n\r\n        if (!this.isBiggerThanMaxMonth(year, month)) {\r\n            this.date.month = month;\r\n            this.date.year = year;\r\n            this.setYearMonthText();\r\n            this.setPreNextState(year, month);\r\n            this.setDayArr();\r\n            this.setNextDayArr();\r\n        }\r\n    }\r\n    // 处理右侧年前进按钮事件\r\n    onNextYearClick(event: MouseEvent): void {\r\n        // 最大月，最大年，最大年时间段\r\n        if (this.isPickerYearMaxValue()) {\r\n            return;\r\n        }\r\n\r\n        // 日期和月份面板\r\n        if (this.picker === 'day' || this.picker === 'month' || this.picker === 'onlyYearMonth') {\r\n            const year: number = this.date.year + 1; // 年份加1\r\n            if (year <= this.max.getFullYear()) { // 判断是否小于等于最大年\r\n                this.date.year = year;\r\n                if (this.isBiggerThanMaxMonth(year, this.date.month)) {\r\n                    this.date.month = this.max.getMonth() + 1;\r\n                }\r\n                this.setYearMonthText();\r\n                this.setPreNextState(year, this.date.month);\r\n                this.setDayMonthArr(this.picker);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // 年面板\r\n        if (this.picker === 'year' || this.picker === 'onlyYear') {\r\n            const year: number = this.date.year + 10; // 年份加10\r\n\r\n            const maxValueRange: TiYearRange = this.getYearRange(this.max.getFullYear());\r\n            const currentYearRange: TiYearRange = this.getYearRange(year);\r\n            // 当年份小于等于最大年面板的最大值是有效的\r\n            if (year <= maxValueRange.max) {\r\n                this.date.year = currentYearRange.min;\r\n                    // 设置下拉面板头部显示文本\r\n                this.setYearMonthText();\r\n\r\n                // 设置左右键状态\r\n                this.setYearRangePreNextState();\r\n\r\n                // 设置年份面板的值和状态\r\n                this.setYearArr();\r\n\r\n                this.setEndpanelYearArr();\r\n            }\r\n        }\r\n    }\r\n\r\n    // 面板头部文本点击事件\r\n    onHeadTextClick(picker: string): void {\r\n        // 点击日期面板头部，跳转到月份面板\r\n        this.picker = picker;\r\n        this.pickerChange.emit(picker);\r\n    }\r\n\r\n    // 日期面板：日期点击事件\r\n    onDayClick(isNext: boolean, day: TiDateValueAndState, event: MouseEvent): void {\r\n            if (day.state === 'disable') {\r\n                return;\r\n            }\r\n            if (day.state === 'preMonth') { // 如果是上个月的日期则跳转到上个月\r\n                this.onPreMonthClick(event);\r\n            } else if (day.state === 'nextMonth') { // 如果是下个月的日期则跳转到下个月\r\n                this.onNextMonthClick(event);\r\n            }\r\n            let dateSelect: Date;\r\n            const newDate: TiDatePanel = JSON.parse(JSON.stringify(this.date));\r\n            if (isNext) {\r\n                newDate.year = this.date.month === 12 ? this.date.year + 1 : this.date.year;\r\n                newDate.month = this.date.month === 12 ? 1 : this.date.month + 1;\r\n                dateSelect = new Date(newDate.year, newDate.month - 1, Number(day.value));\r\n            } else {\r\n                dateSelect = new Date(this.date.year, this.date.month - 1, day.value as number);\r\n            }\r\n            if (this.focusedPosition !== 'begin' && this.isRange) {\r\n                if (this.value.end === null && this.value.begin !== null && TiDateUtil.isBigger(this.value.begin, dateSelect)) {\r\n                    this.value.begin = dateSelect;\r\n                    this.valueChange.emit(this.value);\r\n                    // 事件回调：点击日期执行面板收起操作\r\n                    this.select.emit(day.state);\r\n                    return;\r\n                }\r\n                this.value.end = dateSelect;\r\n                if (this.value.begin !== null && TiDateUtil.isBigger(this.value.begin, this.value.end)) {\r\n                    this.value.begin = null;\r\n                }\r\n            } else {\r\n                this.value.begin = dateSelect;\r\n                if (this.value.end !== null && TiDateUtil.isBigger(this.value.begin, this.value.end)) {\r\n                    this.value.end = null;\r\n                }\r\n            }\r\n            this.valueChange.emit(this.value);\r\n            // 事件回调：点击日期执行面板收起操作\r\n            this.select.emit(day.state);\r\n    }\r\n    // 月份面板：月份点击事件\r\n    onMonthClick(month: TiDateValueAndState, event: MouseEvent, isEndClick?: boolean): void {\r\n        // 月份灰化不可点击\r\n        if (month.state === 'disable') {\r\n            return;\r\n        }\r\n        // 当前月值变更\r\n        this.date.month = this.local.monthArr.indexOf(String(month.value)) + 1;\r\n        // 根据当前月更新面板头部月份显示\r\n        this.pickerValue = this.pickerValue instanceof Object ? this.pickerValue : {};\r\n        this.nextPickerValue = this.nextPickerValue instanceof Object ? this.nextPickerValue : {};\r\n        this.pickerValue['month'] = this.local.monthArr[this.date.month - 1];\r\n        this.nextPickerValue['month'] = this.date.month === 12 ? this.local.monthArr[0] : this.local.monthArr[this.date.month];\r\n        // 无日期面板：点击月份将value值变更。将执行select事件回调\r\n        // 有日期面板：点击跳转到日期面板，根据年月设置左右按钮状态和日期面板值；\r\n        if (this.format.indexOf('d') === -1) { // 只显示年月\r\n            this.date.year = isEndClick ? this.date.year + 1 : this.date.year;\r\n            if (this.focusedPosition === 'begin') {\r\n                this.value.begin = new Date(this.date.year, this.date.month - 1);\r\n            } else {\r\n                this.value.end = new Date(this.date.year, this.date.month - 1);\r\n            }\r\n            this.valueChange.emit(this.value);\r\n            this.select.emit();\r\n        } else {\r\n            this.picker = 'day';\r\n            this.pickerChange.emit(this.picker);\r\n        }\r\n    }\r\n\r\n    // 年范围面板：年点击事件\r\n    onYearClick(year: TiDateValueAndState, event: MouseEvent): void {\r\n        if (year.state !== 'disable') {\r\n            this.date.year = year.value as number;\r\n            this.pickerValue = this.pickerValue instanceof Object ? this.pickerValue : {};\r\n            this.nextPickerValue = this.nextPickerValue instanceof Object ? this.nextPickerValue : {};\r\n            this.pickerValue['year'] = `${this.date.year}${this.local.yearText}`;\r\n            this.nextPickerValue['year'] = this.date.month === 12 ? `${this.date.year + 1}${this.local.yearText}`\r\n            : `${this.date.year}${this.local.yearText}`;\r\n            this.nextPickerValue['onlyYear'] = `${this.date.year + 1}${this.local.yearText}`;\r\n            // 只有年份面板\r\n            if (this.format.indexOf('M') === -1) {\r\n                if (this.focusedPosition === 'begin') {\r\n                    this.value.begin = new Date(this.date.year, 1, 1);\r\n                } else {\r\n                    this.value.end = new Date(this.date.year, 1, 1);\r\n                }\r\n                this.valueChange.emit(this.value);\r\n                this.select.emit();\r\n                return;\r\n            }\r\n            // 年月格式\r\n            if (this.format.indexOf('d') === -1) {\r\n                this.picker = 'onlyYearMonth';\r\n                this.setDayMonthArr(this.picker);\r\n                return;\r\n            }\r\n            this.picker = 'month';\r\n            this.pickerChange.emit(this.picker);\r\n        }\r\n    }\r\n\r\n    public onSelect(val: any, timeOption: string): void {\r\n        const obj: any = {\r\n            timeOption,\r\n            val\r\n        };\r\n        this.selectTimeFn.emit(obj);\r\n        switch (timeOption) {\r\n            case 'beginHour':\r\n                this.timeHandleFn(val, this.beginHourContainerRef);\r\n                break;\r\n            case 'beginMinute':\r\n                this.timeHandleFn(val, this.beginMinuteContainerRef);\r\n                break;\r\n            case 'beginSecond':\r\n                this.timeHandleFn(val, this.beginSecondContainerRef);\r\n                break;\r\n            case 'endHour':\r\n                this.timeHandleFn(val, this.endHourContainerRef);\r\n                break;\r\n            case 'endMinute':\r\n                this.timeHandleFn(val, this.endMinuteContainerRef);\r\n                break;\r\n            case 'endSecond':\r\n                this.timeHandleFn(val, this.endSecondContainerRef);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    // 分年月日三个面板：根据不同面板设置相应的值\r\n    private setDatePanel(): void {\r\n        // 设置下拉面板头部显示文本\r\n        this.setYearMonthText();\r\n\r\n        // 设置年月文本；设置左右键状态；设置下拉面板中日期\r\n        switch (this.picker) {\r\n            case 'day':\r\n                this.setPreNextState(this.date.year, this.date.month);\r\n\r\n                this.setDayArr();\r\n                this.setNextDayArr();\r\n\r\n                break;\r\n            case 'month':\r\n            case 'onlyYearMonth':\r\n                this.setPreNextState(this.date.year, this.date.month);\r\n                this.setMonthArr();\r\n                this.setEndpanelMonthArr();\r\n\r\n                break;\r\n            case 'year':\r\n            case 'onlyYear':\r\n                this.setYearRangePreNextState();\r\n\r\n                this.setYearArr();\r\n                this.setEndpanelYearArr();\r\n\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n   /**\r\n    * @description 设置展示的日期\r\n    */\r\n   private setValue(): void {\r\n       // 1.根据接口值获取合法的当前值\r\n       let date: Date;\r\n       let today: Date;\r\n       if ((this.value instanceof Object) && TiDateUtil.isDate(this.value.begin)) {\r\n           date = this.value.begin;\r\n       } else if ((this.value instanceof Object) && TiDateUtil.isDate(this.value.end)) {\r\n           date = this.value.end;\r\n       } else {\r\n            // 1.1根据nowDateTime接口获取现在时间\r\n            today = (this.nowDateTime && TiDateUtil.isDate(this.nowDateTime)) ? this.nowDateTime : new Date();\r\n            // 1.2根据最大值最小值对获取的现在时间进行进一步判断\r\n            const year: number = today.getFullYear();\r\n            const month: number = today.getMonth() + 1;\r\n            const day: number = today.getDate();\r\n            date = (!this.isBiggerThanMaxDay(year, month, day) && !this.isSmallerThanMinDay(year, month, day))\r\n                ? today : this.min;\r\n       }\r\n\r\n       // 2.将当前时间的年月日存在对象\r\n       this.date = {\r\n           year: date.getFullYear(),\r\n           month: date.getMonth() + 1,\r\n           day: date.getDate()\r\n       };\r\n\r\n       this.setDatePanel();\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否大于最大日期：大于返回true，小于返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isBiggerThanMaxDay(year: number, month: number, day: number): boolean {\r\n       // 1.最大值不是合法的时间对象\r\n       if (!TiDateUtil.isDate(this.max)) {\r\n           return false;\r\n       }\r\n\r\n       // 2.重新生成一个新的最大值的原因：防止传入一个带时分的最大值\r\n       let max: Date = this.max;\r\n       max = new Date(max.getFullYear(), max.getMonth(), max.getDate());\r\n       if (max.getTime() < new Date(year, month - 1, day).getTime()) {\r\n           return true;\r\n       }\r\n\r\n       return false;\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否小于最小日期：小于返回true，大于返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isSmallerThanMinDay(year: number, month: number, day: number): boolean {\r\n       if (!TiDateUtil.isDate(this.min)) {\r\n           return false;\r\n       }\r\n\r\n       // 防止传入一个带时分的最小值\r\n       let min: Date = this.min;\r\n       min = new Date(min.getFullYear(), min.getMonth(), min.getDate());\r\n       if (min.getTime() > new Date(year, month - 1, day).getTime()) {\r\n           return true;\r\n       }\r\n\r\n       return false;\r\n   }\r\n   // 是否为禁用日期\r\n   private isDisabledDay(year: number, month: number, day: number): boolean {\r\n        if (!Util.isArray(this.disabledDays)) {\r\n            return false;\r\n        }\r\n        let isDisabled: boolean = false;\r\n        this.disabledDays.forEach((item: Date) => {\r\n            if (item.getTime() === new Date(year, month - 1, day).getTime()) {\r\n                isDisabled = true;\r\n            }\r\n        });\r\n\r\n        return isDisabled;\r\n   }\r\n\r\n   // 开始日期或者结束日期固定不允许修改时，超出范围的需要禁用\r\n   private isFixedWithDisabled(year: number, month: number, day: number): boolean {\r\n       if (!this.isBeginFixed && !this.isEndFixed || this.value === null) {\r\n           return false;\r\n       }\r\n       // 开始日期有值并且禁用\r\n       if (this.isBeginFixed) {\r\n            if (this.value.begin.getTime() > new Date(year, month - 1, day).getTime()) {\r\n                return true;\r\n            }\r\n       }\r\n       if (this.isEndFixed) {\r\n            if (this.value.end.getTime() < new Date(year, month - 1, day).getTime()) {\r\n                    return true;\r\n            }\r\n       }\r\n\r\n       return false;\r\n   }\r\n\r\n   /**\r\n    * @description 设置下拉面板中年月文本\r\n    */\r\n   private setYearMonthText(): void {\r\n       // 1.大于等于最大年，设置年为最大年，月大于最大月，设置为最大月；\r\n       if (this.date.year >= this.max.getFullYear()) {\r\n           this.date.year = this.max.getFullYear();\r\n           if (this.date.month > (this.max.getMonth() + 1)) {\r\n               this.date.month = this.max.getMonth() + 1;\r\n           }\r\n       }\r\n\r\n       // 2.小于等于最小年，设置年为最小年，月份小于最小月设置为最小月；\r\n       if (this.date.year <= this.min.getFullYear()) {\r\n           this.date.year = this.min.getFullYear();\r\n           if (this.date.month < (this.min.getMonth() + 1)) {\r\n               this.date.month = this.min.getMonth() + 1;\r\n           }\r\n       }\r\n\r\n       // 3.根据年月值，拼成下拉面板中年月文本\r\n       const start: number = this.date.year - this.date.year % 10;\r\n       this.pickerValue = this.pickerValue instanceof Object ? this.pickerValue : {};\r\n       this.nextPickerValue = this.nextPickerValue instanceof Object ? this.nextPickerValue : {};\r\n       this.pickerValue['year'] = `${this.date.year}${this.local.yearText}`;\r\n       this.nextPickerValue['onlyYear'] = `${this.date.year + 1}${this.local.yearText}`;\r\n       this.nextPickerValue['year'] = this.date.month === 12 ? `${this.date.year + 1}${this.local.yearText}`\r\n       : `${this.date.year}${this.local.yearText}`;\r\n       this.pickerValue['month'] = this.local.monthArr[this.date.month - 1];\r\n       this.nextPickerValue['month'] = this.date.month === 12 ? this.local.monthArr[0] : this.local.monthArr[this.date.month];\r\n       this.pickerValue['yearRange'] = `${start} - ${start + 9}`;\r\n       this.pickerValue['endpanelYearRange'] = `${start + 10} - ${start + 19}`;\r\n   }\r\n\r\n   /**\r\n    * @description 设置上月、下月按钮状态：已经是最大、最小月时，将对应的按钮置灰\r\n    * @param year 年份\r\n    * @param month 月份\r\n    */\r\n   private setPreNextState(year: number, month: number): void {\r\n       this.isMaxMonth = this.isEqualToMaxMonth(year, month);\r\n       this.isMinMonth = this.isEqualToMinMonth(year, month);\r\n       this.isMaxYear = year === this.max.getFullYear();\r\n       this.isMinYear = year === this.min.getFullYear();\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的年月是否等于最大月份：等于返回true，不等于返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    */\r\n   private isEqualToMaxMonth(year: number, month: number): boolean {\r\n       // 1.最大值不是合法的时间对象\r\n       if (!TiDateUtil.isDate(this.max)) {\r\n           return false;\r\n       }\r\n\r\n       // 2.重新生成一个新的最大值的原因：防止传入一个带时分的最大值\r\n       let max: Date = this.max;\r\n       max = new Date(max.getFullYear(), max.getMonth(), 1);\r\n       if (max.getTime() === new Date(year, month - 1, 1).getTime()) {\r\n           return true;\r\n       }\r\n\r\n       return false;\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的年月是否等于最小月份：等于返回true，不等于返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    */\r\n   private isEqualToMinMonth(year: number, month: number): boolean {\r\n       if (!TiDateUtil.isDate(this.min)) {\r\n           return false;\r\n       }\r\n\r\n       let min: Date = this.min;\r\n       min = new Date(min.getFullYear(), min.getMonth(), 1);\r\n       if (min.getTime() === new Date(year, month - 1, 1).getTime()) {\r\n           return true;\r\n       }\r\n\r\n       return false;\r\n   }\r\n   /**\r\n    * @description 根据面板设置 dayArr或monthArr\r\n    *\r\n    */\r\n  private setDayMonthArr(picker: string): void {\r\n    if (picker === 'day') {\r\n      this.setDayArr();\r\n      this.setNextDayArr();\r\n    } else if (picker === 'month' || picker === 'onlyYearMonth') {\r\n      this.setMonthArr();\r\n      this.setEndpanelMonthArr();\r\n    }\r\n  }\r\n   /**\r\n    * @description 根据当前年月值，设置下拉面板中显示的日数据\r\n    */\r\n   // tslint:disable-next-line:cyclomatic-complexity\r\n   // eslint-disable-next-line complexity\r\n   private setDayArr(): void {\r\n       // 获取当前年月\r\n       const year: number = parseInt(String(this.date.year), 10);\r\n       const month: number = parseInt(String(this.date.month), 10);\r\n\r\n       // 1：计算这个月1号是下拉面板第一行的第几个\r\n       // 获取到这个月1号是周几 周一到周六：1-6，周天：0；\r\n       const begin: number = new Date(year, month - 1, 1).getDay();\r\n\r\n       // 2：将上个月的日期存入数组dateArr\r\n       const dateArr: Array<TiDateValueAndState> = []; // 存储下拉面板中所有日的值和状态\r\n       const preMonth: number = (month === 1 ? 12 : (month - 1)); // 上个月\r\n       const preMonthDays: number = new Date(year, preMonth, 0).getDate(); // 上个月总天数\r\n       const preMonthStart: number = preMonthDays - begin + 1; // 获取到第一行的起始值\r\n       let preMonthDayState: string = ''; // 上个月日期的状态\r\n       // 本月是最小月时的上月日期置灰\r\n       preMonthDayState = this.isMinMonth ? 'disable' : 'preMonth';\r\n\r\n       for (let i: number = 0; i < begin; i++) {\r\n            dateArr[i] = {\r\n                value: preMonthStart + i,\r\n                state: preMonthDayState\r\n            };\r\n            if (this.isSmallerThanMinDay(year, month - 1, preMonthStart + i) || this.isDisabledDay(year, month - 1, preMonthStart + i)\r\n            || this.isFixedWithDisabled(year, month - 1, preMonthStart + i)) {\r\n                    dateArr[i].state = 'disable';\r\n            }\r\n       }\r\n\r\n       // 3：将本月的日存入数组dateArr\r\n       let dayNum: number = 1;\r\n       const monthDays: number = new Date(year, month, 0).getDate(); // 这个月总天数\r\n       const length: number = begin + monthDays;\r\n       let state: string = '';\r\n\r\n       for (let j: number = begin; j < length; j++) {\r\n           if (this.isBiggerThanMaxDay(year, month, dayNum) ||\r\n           this.isSmallerThanMinDay(year, month, dayNum) ||\r\n           this.isDisabledDay(year, month, dayNum) ||\r\n           this.isFixedWithDisabled(year, month, dayNum)) {\r\n               state = 'disable'; // 日样式置灰\r\n           } else if (this.isEqualToValue('day', year, month, dayNum)) {\r\n               state = 'current'; // 当前选中\r\n           } else if (this.isBetweenInRange(year, month, dayNum)) {\r\n               state = 'select'; // 在选中范围\r\n           } else {\r\n               state = 'default'; // 没有选中\r\n           }\r\n\r\n           dateArr[j] = {\r\n               value: dayNum,\r\n               state,\r\n               isToday: this.isEqualToToday('day', year, month, dayNum)\r\n       };\r\n\r\n           dayNum++;\r\n       }\r\n\r\n       // 4：将下个月的日存入数组dateArr\r\n       dayNum = 1;\r\n       const nextMonthDayState: string = this.isMaxMonth ? 'disable' : 'nextMonth'; // 下个月日期的状态\r\n       for (let k: number = dateArr.length; k < 42; k++) {\r\n            dateArr[k] = {\r\n                value: dayNum,\r\n                state: nextMonthDayState\r\n            };\r\n\r\n            if (this.isBiggerThanMaxDay(year, month + 1, dayNum) || this.isDisabledDay(year, month + 1, dayNum)\r\n                || this.isFixedWithDisabled(year, month + 1, dayNum)) {\r\n                    dateArr[k].state = 'disable';\r\n            }\r\n\r\n            dayNum++;\r\n       }\r\n\r\n       // 5：将dateArr组装成下拉面板中显示日的二维数组dayArr\r\n       for (let p: number = 0; p < dateArr.length / 7; p++) {\r\n           this.dayArr[p] = [];\r\n           for (let q: number = 0; q < 7; q++) {\r\n               this.dayArr[p].push(dateArr[q + p * 7]);\r\n           }\r\n       }\r\n   }\r\n\r\n  /**\r\n    * @description 根据当前年月值，设置下拉面板中显示的日数据\r\n    */\r\n   // tslint:disable-next-line:cyclomatic-complexity\r\n   // eslint-disable-next-line complexity\r\n   private setNextDayArr(): void {\r\n    // 获取当前年月\r\n    const sss: number = this.date.month === 12 ? 1 : this.date.month + 1;\r\n    const yyy: number = this.date.month === 12 ? this.date.year + 1 : this.date.year;\r\n    const year: number = parseInt(String(yyy), 10);\r\n    const month: number = parseInt(String(sss), 10);\r\n\r\n //    const monthNext: number = parseInt(String(this.date.month + 1), 10);\r\n\r\n    // 1：计算这个月1号是下拉面板第一行的第几个\r\n    // 获取到这个月1号是周几 周一到周六：1-6，周天：0；\r\n    const begin: number = new Date(year, month - 1, 1).getDay();\r\n\r\n    // 2：将上个月的日期存入数组dateArr\r\n    const dateArr: Array<TiDateValueAndState> = []; // 存储下拉面板中所有日的值和状态\r\n    const preMonth: number = (month === 1 ? 12 : (month - 1)); // 上个月\r\n    const preMonthDays: number = new Date(year, preMonth, 0).getDate(); // 上个月总天数\r\n    const preMonthStart: number = preMonthDays - begin + 1; // 获取到第一行的起始值\r\n\r\n    for (let i: number = 0; i < begin; i++) {\r\n         dateArr[i] = {\r\n             value: preMonthStart + i,\r\n             state: 'preMonth'\r\n         };\r\n\r\n         if (this.isBiggerThanMaxDay(year, month - 1, preMonthStart + i) ||\r\n            this.isSmallerThanMinDay(year, month - 1, preMonthStart + i) ||\r\n            this.isDisabledDay(year, month - 1, preMonthStart + i) ||\r\n            this.isFixedWithDisabled(year, month - 1, preMonthStart + i)) {\r\n            dateArr[i].state = 'disable';\r\n         }\r\n    }\r\n\r\n    // 3：将本月的日存入数组dateArr\r\n    let dayNum: number = 1;\r\n    const monthDays: number = new Date(year, month, 0).getDate(); // 这个月总天数\r\n    const length: number = begin + monthDays;\r\n    let state: string = '';\r\n\r\n    for (let j: number = begin; j < length; j++) {\r\n        if (this.isBiggerThanMaxDay(year, month, dayNum) ||\r\n        this.isSmallerThanMinDay(year, month, dayNum) ||\r\n        this.isDisabledDay(year, month, dayNum) ||\r\n        this.isFixedWithDisabled(year, month, dayNum)) {\r\n            state = 'disable'; // 日样式置灰\r\n        } else if (this.isEqualToValue('day', year, month, dayNum)) {\r\n            state = 'current'; // 当前选中\r\n        } else if (this.isBetweenInRange(year, month, dayNum)) {\r\n            state = 'select'; // 在选中范围\r\n        } else {\r\n            state = 'default'; // 没有选中\r\n        }\r\n\r\n        dateArr[j] = {\r\n            value: dayNum,\r\n            state,\r\n            isToday: this.isEqualToToday('day', year, month, dayNum)\r\n    };\r\n\r\n        dayNum++;\r\n    }\r\n\r\n    // 4：将下个月的日存入数组dateArr\r\n    dayNum = 1;\r\n    const nextMonthDayState: string = this.isMaxMonth ? 'disable' : 'nextMonth'; // 下个月日期的状态\r\n    for (let k: number = dateArr.length; k < 42; k++) {\r\n         dateArr[k] = {\r\n             value: dayNum,\r\n             state: nextMonthDayState\r\n         };\r\n\r\n         if (\r\n             this.isBiggerThanMaxDay(year, month + 1, dayNum) ||\r\n             this.isDisabledDay(year, month + 1, dayNum) ||\r\n             this.isFixedWithDisabled(year, month + 1, dayNum)) {\r\n                 dateArr[k].state = 'disable';\r\n         }\r\n\r\n         dayNum++;\r\n    }\r\n\r\n    // 5：将dateArr组装成下拉面板中显示日的二维数组dayArr\r\n    for (let p: number = 0; p < dateArr.length / 7; p++) {\r\n        this.nextdayArr[p] = [];\r\n        for (let q: number = 0; q < 7; q++) {\r\n            this.nextdayArr[p].push(dateArr[q + p * 7]);\r\n        }\r\n    }\r\n}\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否begin值小于end的值，end值大于begion值\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isOutInRange(year: number, month: number, day: number): boolean {\r\n        const value: TiDateValue = this.value;\r\n        const curValue: number = new Date(year, month - 1, day).getTime();\r\n\r\n        if (!(value instanceof Object)) {\r\n            return false;\r\n        }\r\n        let end: Date = value.end;\r\n        let endValue: number;\r\n        if (TiDateUtil.isDate(value.end)) {\r\n            // 只取年月日：防止传入带有时分秒的值\r\n            end = new Date(end.getFullYear(), end.getMonth(), end.getDate());\r\n            endValue = end.getTime();\r\n\r\n            return curValue > endValue;\r\n        }\r\n\r\n        return false;\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否等于当前选中的日期：等于返回true，不等于返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isEqualToValue(type?: string, year?: number, month?: number, day?: number): boolean {\r\n        const beginVal: Date = this.value.begin;\r\n        const endVal: Date = this.value.end;\r\n        if (beginVal === null && endVal === null) {\r\n            return false;\r\n        } else {\r\n            let value1: Date;\r\n            let value2: Date;\r\n            let beginV: boolean;\r\n            let endV: boolean;\r\n            if (beginVal !== null) {\r\n                value1 = new Date(beginVal.getFullYear(), beginVal.getMonth(), beginVal.getDate());\r\n                beginV = this.isEqualValue(type, value1, year, month, day);\r\n            }\r\n            if (endVal !== null) {\r\n                value2 = new Date(endVal.getFullYear(), endVal.getMonth(), endVal.getDate());\r\n                endV = this.isEqualValue(type, value2, year, month, day);\r\n            }\r\n\r\n            return beginV || endV;\r\n\r\n        }\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否在当前选中日期的范围内,并且不等于当前选中的值：符合返回true，不符合返回false\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isBetweenInRange(year: number, month: number, day: number): boolean {\r\n       const value: TiDateValue = this.value;\r\n       // value不是对象，begin或者end不是合法日期\r\n       if (!(value instanceof Object) || !TiDateUtil.isDate(value.begin) || !TiDateUtil.isDate(value.end)) {\r\n           return false;\r\n       }\r\n\r\n       let begin: Date = value.begin;\r\n       begin = new Date(begin.getFullYear(), begin.getMonth(), begin.getDate());\r\n       const beginValue: number = begin.getTime();\r\n\r\n       let end: Date = value.end;\r\n       end = new Date(end.getFullYear(), end.getMonth(), end.getDate());\r\n       const endValue: number = end.getTime();\r\n\r\n       const curValue: number = new Date(year, month - 1, day).getTime();\r\n       if (beginValue < curValue && curValue <= endValue) {\r\n           return true;\r\n       }\r\n\r\n       return false;\r\n   }\r\n\r\n   /**\r\n    * @description 判断参数传来的日期是否等于当前日期时间\r\n    * @param year 年份\r\n    * @param month 月份\r\n    * @param day 日\r\n    */\r\n   private isEqualToToday(type?: string, year?: number, month?: number, day?: number): boolean {\r\n        const today: Date = (this.nowDateTime && TiDateUtil.isDate(this.nowDateTime)) ? this.nowDateTime : new Date();\r\n\r\n        return this.isEqualValue(type, today, year, month, day);\r\n   }\r\n\r\n    // 判断日期是当前日期或当前选中日期\r\n    // tslint:disable-next-line:prefer-function-over-method\r\n    private isEqualValue(type?: string, value?: any, year?: number, month?: number, day?: number): boolean {\r\n    let _value: any;\r\n    if (type === 'year') { // 年\r\n        _value = value.getFullYear();\r\n        if (_value === year) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    if (type === 'month') { // 年、月\r\n        _value = new Date(value.getFullYear(), value.getMonth());\r\n        if (_value.getTime() === new Date(year, month - 1).getTime()) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    // 年、月、日\r\n    _value = new Date(value.getFullYear(), value.getMonth(), value.getDate());\r\n    if (_value.getTime() === new Date(year, month - 1, day).getTime()) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n   /**\r\n    * @description 根据当前年份和最大最小值，设置下拉面板中显示的月份状态\r\n    */\r\n   private setMonthArr(): void {\r\n       const year: number = this.date.year;\r\n       const innerMonth: Array<TiDateValueAndState> = [];\r\n       let state: string = '';\r\n       // 设置每个月份对应的值和状态\r\n       for (let month: number = 1; month <= 12; month++) {\r\n           // tslint:disable-next-line:prefer-conditional-expression\r\n           if (this.isSmallerThanMinMonth(year, month) || (this.isBiggerThanMaxMonth(year, month))) {\r\n            state = 'disable'; // 月样式置灰\r\n           } else if (this.isEqualToValue('month', year, month)) {\r\n            state = 'current'; // 当前选中\r\n           } else {\r\n            state = 'default'; // 没有选中\r\n           }\r\n\r\n           innerMonth[month - 1] = {\r\n            value: this.local.monthArr[month - 1],\r\n            state,\r\n            isMonth: this.isEqualToToday('month', year, month)\r\n        };\r\n       }\r\n\r\n       // 将月份数据格式化为二维数组\r\n       this.monthArr = [];\r\n       for (let p: number = 0; p < 3; p++) {\r\n           this.monthArr[p] = [];\r\n           for (let q: number = 0; q < 4; q++) {\r\n               this.monthArr[p].push(innerMonth[q + p * 4]);\r\n           }\r\n       }\r\n   }\r\n\r\n\r\n   /**\r\n    * @description 根据当前年份和最大最小值，设置下拉面板中显示的月份状态\r\n    */\r\n   private setEndpanelMonthArr(): void {\r\n    const year: number = this.date.year + 1;\r\n    const innerMonth: Array<TiDateValueAndState> = [];\r\n    let state: string = '';\r\n    // 设置每个月份对应的值和状态\r\n    for (let month: number = 1; month <= 12; month++) {\r\n        // tslint:disable-next-line:prefer-conditional-expression\r\n        if (this.isSmallerThanMinMonth(year, month) || (this.isBiggerThanMaxMonth(year, month))) {\r\n         state = 'disable'; // 月样式置灰\r\n        } else if (this.isEqualToValue('month', year, month)) {\r\n         state = 'current'; // 当前选中\r\n        } else {\r\n         state = 'default'; // 没有选中\r\n        }\r\n\r\n        innerMonth[month - 1] = {\r\n         value: this.local.monthArr[month - 1],\r\n         state,\r\n         isMonth: this.isEqualToToday('month', year, month)\r\n     };\r\n    }\r\n\r\n    // 将月份数据格式化为二维数组\r\n    this.endpanelMonthArr = [];\r\n    for (let p: number = 0; p < 3; p++) {\r\n        this.endpanelMonthArr[p] = [];\r\n        for (let q: number = 0; q < 4; q++) {\r\n            this.endpanelMonthArr[p].push(innerMonth[q + p * 4]);\r\n        }\r\n    }\r\n}\r\n\r\n    /**\r\n     * @description 判断参数传来的年月是否小于最小月份：小于返回true，大于返回false\r\n     * @param year 年份\r\n     * @param month 月份\r\n     */\r\n    private isSmallerThanMinMonth(year: number, month: number): boolean {\r\n        if (!TiDateUtil.isDate(this.min)) {\r\n            return false;\r\n        }\r\n\r\n        let min: Date = this.min;\r\n        min = new Date(min.getFullYear(), min.getMonth(), 1);\r\n        if (min.getTime() > new Date(year, month - 1, 1).getTime()) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @description 判断参数传来的年月是否大于最大月份：大于返回true，小于返回false\r\n     * @param year 年份\r\n     * @param month 月份\r\n     */\r\n    private isBiggerThanMaxMonth(year: number, month: number): boolean {\r\n        if (!TiDateUtil.isDate(this.max)) {\r\n            return false;\r\n        }\r\n\r\n        let max: Date = this.max;\r\n        max = new Date(max.getFullYear(), max.getMonth(), 1);\r\n        if (max.getTime() < new Date(year, month - 1, 1).getTime()) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @description 设置按钮状态：\r\n     */\r\n    private setYearRangePreNextState(): void {\r\n        const minValueRange: TiYearRange = this.getYearRange(this.min.getFullYear());\r\n        const maxValueRange: TiYearRange = this.getYearRange(this.max.getFullYear());\r\n        this.isMaxYearRange = (this.date.year >= maxValueRange.min && this.date.year <= maxValueRange.max) ? true : false;\r\n        this.isMinYearRange = (this.date.year >= minValueRange.min && this.date.year <= minValueRange.max) ? true : false;\r\n    }\r\n\r\n    // 获取时间面板：最大值和最小值年面板范围\r\n    private getYearRange(year: number): TiYearRange {\r\n        const minDateRange: number =  year - year % 10;\r\n        const maxDateRange: number =  minDateRange + 9;\r\n\r\n        return {\r\n            min: minDateRange,\r\n            max: maxDateRange\r\n        };\r\n    }\r\n\r\n   /**\r\n    * @description 根据当前年份和最大最小值，设置下拉面板中显示的年份状态\r\n    */\r\n   private setYearArr(): void {\r\n       // 1.获取当前年；算出起始年，\r\n       const innerYear: Array<TiDateValueAndState> = []; // 存储年值\r\n       const year: number = this.date.year - this.date.year % 10;\r\n       // 2.数组的第一个为起始年 -1；\r\n       const start: number = year - 1;\r\n       const end: number = year + 9;\r\n       let index: number = 0;\r\n       let state: string = '';\r\n       const preYearRange: string = (start <= this.min.getFullYear()) ? 'disable' : 'preYear';\r\n       innerYear.push({\r\n           state: preYearRange,\r\n           value: start\r\n       });\r\n       // 3.起始年  - 最终年（起始年+9）（for遍历）\r\n       for (let i: number = year; i <= end; i++) {\r\n           index++;\r\n           if (i < this.min.getFullYear() || i > this.max.getFullYear()) {\r\n               state = 'disable';\r\n           } else if (this.isEqualToValue('year', i)) {\r\n                state = 'current'; // 当前选中\r\n           } else {\r\n               state = 'default';\r\n           }\r\n\r\n           innerYear[index] = {\r\n            value: i,\r\n            state,\r\n            isYear: this.isEqualToToday('year', i)\r\n        };\r\n       }\r\n\r\n       // 判断是不是大于最大年：大于最大年状态为灰化\r\n       const nextYearRange: string = (end >= this.max.getFullYear()) ? 'disable' : 'nextYear';\r\n       innerYear.push({\r\n           state: nextYearRange,\r\n           value: end + 1\r\n       });\r\n       // 将月份数据格式化为二维数组\r\n       this.yearArr = [];\r\n       for (let p: number = 0; p < 3; p++) {\r\n           this.yearArr[p] = [];\r\n           for (let q: number = 0; q < 4; q++) {\r\n               this.yearArr[p].push(innerYear[q + p * 4]);\r\n           }\r\n       }\r\n   }\r\n\r\n   /**\r\n    * @description 根据当前年份和最大最小值，设置下拉面板中显示的年份状态\r\n    */\r\n   private setEndpanelYearArr(): void {\r\n    // 1.获取当前年；算出起始年，\r\n    const innerYear: Array<TiDateValueAndState> = []; // 存储年值\r\n    const year: number = this.date.year - this.date.year % 10 + 10;\r\n    // 2.数组的第一个为起始年 -1；\r\n    const start: number = year - 1;\r\n    const end: number = year + 9;\r\n    let index: number = 0;\r\n    let state: string = '';\r\n    const preYearRange: string = (start <= this.min.getFullYear()) ? 'disable' : 'preYear';\r\n    innerYear.push({\r\n        state: preYearRange,\r\n        value: start\r\n    });\r\n    // 3.起始年  - 最终年（起始年+9）（for遍历）\r\n    for (let i: number = year; i <= end; i++) {\r\n        index++;\r\n        if (i < this.min.getFullYear() || i > this.max.getFullYear()) {\r\n            state = 'disable';\r\n        } else if (this.isEqualToValue('year', i)) {\r\n             state = 'current'; // 当前选中\r\n        } else {\r\n            state = 'default';\r\n        }\r\n\r\n        innerYear[index] = {\r\n         value: i,\r\n         state,\r\n         isYear: this.isEqualToToday('year', i)\r\n     };\r\n    }\r\n\r\n    // 判断是不是大于最大年：大于最大年状态为灰化\r\n    const nextYearRange: string = (end >= this.max.getFullYear()) ? 'disable' : 'nextYear';\r\n    innerYear.push({\r\n        state: nextYearRange,\r\n        value: end + 1\r\n    });\r\n    // 将月份数据格式化为二维数组\r\n    this.endpanelYearArr = [];\r\n    for (let p: number = 0; p < 3; p++) {\r\n        this.endpanelYearArr[p] = [];\r\n        for (let q: number = 0; q < 4; q++) {\r\n            this.endpanelYearArr[p].push(innerYear[q + p * 4]);\r\n        }\r\n    }\r\n}\r\n\r\n   // 设置左年后退按钮灰化\r\n    isPickerYearMinValue(): boolean {\r\n        return this.picker === 'year'? this.isMinYearRange : this.isMinYear;\r\n    }\r\n   // 设置右年前进按钮灰化\r\n    isPickerYearMaxValue(): boolean {\r\n        return this.picker === 'year'? this.isMaxYearRange : this.isMaxYear;\r\n   }\r\n\r\n   public trackByFn(index: number, item: any): number {\r\n        return index;\r\n    }\r\n\r\n    private setOptions(num: number, pos?: string): Array<any> {\r\n        const options: Array<any> = [];\r\n        for (let i: number = 0; i < num; i++) {\r\n            options[i] = {\r\n                label : i < 10 ? '0' + i : String(i),\r\n                disabled: pos === 'end' ? this.endTimeDisabled : this.beginTimeDisabled\r\n            };\r\n        }\r\n\r\n        return options;\r\n    }\r\n\r\n    /**\r\n    * @ignore\r\n    * 时间选择框部分鼠标移出时去除hover样式\r\n    */\r\n    public onMouseleave(listCom: TiListComponent) {\r\n        listCom.hoverOption = null;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiDatePanelComponent } from './TiDatePanelComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiListModule } from '../list/TiListModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiIconModule,\r\n    TiListModule,\r\n    TiLocaleModule\r\n  ],\r\n  exports: [TiDatePanelComponent],\r\n  declarations: [TiDatePanelComponent]\r\n})\r\n\r\nexport class TiDatePanelModule {\r\n}\r\nexport { TiDatePanelComponent, TiDatePanel, TiPickerHeadText, TiDateValueAndState, TiYearRange } from './TiDatePanelComponent';\r\n","import {\r\n    Component,\r\n    ContentChild,\r\n    ElementRef,\r\n    NgZone,\r\n    Renderer2,\r\n    SimpleChanges,\r\n    TemplateRef\r\n} from '@angular/core';\r\nimport { TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleFormat } from '../../locale/TiLocaleModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDateBaseComponent, TiDateCustomizeOptions } from '../datebase/TiDateBaseModule';\r\n\r\n/**\r\n * Date日期组件\r\n *\r\n * Date组件提供了一种方便的显示和设置日期的方式\r\n *\r\n * <example-url>../tiny3demo/#/date/date-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-date',\r\n    templateUrl: './date.html',\r\n    styleUrls: ['./date.less'],\r\n    // tslint:disable-next-line:use-host-property-decorator\r\n    host: {\r\n        '[class.ti3-date-input-container]': 'true',\r\n        '(blur)': 'hidePanel()'\r\n    },\r\n    providers: [ TiFormComponent.getValueAccessor(TiDateComponent) ]\r\n})\r\nexport class TiDateComponent extends TiDateBaseComponent {\r\n    /**\r\n     * @ignore\r\n     * 日期显示格式: date组件的format为string类型\r\n     */\r\n    public format: string;\r\n    /**\r\n     * @ignore\r\n     * 标记date/datetime的类型\r\n     */\r\n    public isDatetime: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 用于标记是不是range\r\n     */\r\n    public isRange: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * placeholder提示文本\r\n     */\r\n    public placeholder: string = `${TiLocale.getLocaleWords().tiDate.datePlaceholder}`;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ContentChild('customize', { static: true }) customizeTemplate: TemplateRef<any>;\r\n\r\n\r\n    // tslint:disable-next-line:use-life-cycle-interface\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // format支持动态变更\r\n        if (changes['format'] && !changes['format'].firstChange) {\r\n            // 新的format是非法时，format值保持之前值不变\r\n            if (!Util.isString(changes['format'].currentValue)) {\r\n                this.format = changes['format'].previousValue;\r\n\r\n                return;\r\n            }\r\n            this.formatValue();\r\n            // 配置面板的接口值\r\n            this.setPickerDate();\r\n        }\r\n\r\n        // 验证最大值最小值，为了处理最大值和最小值从合法日期变为undefined 的情景\r\n        if ((changes['max'] && !changes['max'].firstChange) || (changes['min'] && !changes['min'].firstChange)) {\r\n            this.validateMinAndMax(this.config, this.isDatetime);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * model值变化时的回调\r\n     */\r\n    ngOnModelChange(): void {\r\n        if (!TiDateUtil.isDate(this.model)) {\r\n            this.inputValue = '';\r\n\r\n            return;\r\n        }\r\n        this.formatValue();\r\n        this.setPickerDate();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public setInputValue(value: Date): void {\r\n        let isDisabled: boolean = false;\r\n        if (Util.isArray(this.disabledDays) && this.disabledDays.length > 0) {\r\n            this.disabledDays.forEach((item: Date) => {\r\n                if (item.getTime() === value.getTime()) {\r\n                    isDisabled = true;\r\n                }\r\n            });\r\n        }\r\n        if (isDisabled) {\r\n            return;\r\n        }\r\n        if (this.isValidValue(value)) {\r\n            this.model = value;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onKeydownFn(event: KeyboardEvent, val: any, pos: string): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.hideDrop();\r\n        }\r\n     }\r\n\r\n    /**\r\n     * @ignore\r\n     * 配置时间日期面板接口\r\n     */\r\n    public setPickerDate(): void {\r\n        this.datePanel = {\r\n            value : {\r\n                begin: this.model,\r\n                // tslint:disable-next-line:no-null-keyword\r\n                end: null\r\n            },\r\n            picker : 'day',\r\n            min : this.min,\r\n            max : this.max,\r\n            format : this.format,\r\n            nowDateTime : this.nowDateTime,\r\n            select: (): void => {\r\n                // 点击面板：新旧值相同不做处理，不相同，将新值赋给model\r\n                if (!TiDateUtil.isDateEqual(this.model, this.datePanel['value'].begin)) {\r\n                    this.model = this.datePanel['value'].begin;\r\n                }\r\n                this.hideDrop();\r\n            }\r\n        };\r\n\r\n        // 如果只显示年\r\n        if (this.format.indexOf('M') === -1 && this.format !== 'mediumDate') {\r\n            this.datePanel['picker'] = 'year';\r\n        } else if (this.format.indexOf('d') === -1) { // 如果只显示年月\r\n            this.datePanel['picker'] = 'month';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 根据model值和format接口，格式化显示时间日期\r\n     */\r\n    public formatValue(): void {\r\n        this.inputValue = (this.model !== null) ? TiLocaleFormat.formatDate(this.model, this.format) : '';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 判断是不是合法的model\r\n     */\r\n    public isValidValue(value: Date): boolean {\r\n        if (TiDateUtil.isDate(value) && TiDateUtil.isBetweenMaxAndmin(value, this.min, this.max)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiDatePanelModule } from '../datepanel/TiDatePanelModule';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiDateDominatorModule } from '../datedominator/TiDateDominatorModule';\r\nimport { TiDateComponent } from './TiDateComponent';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiDateEditModule } from '../dateedit/TiDateEditModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDropModule,\r\n    TiButtonModule,\r\n    TiDateEditModule,\r\n    TiDatePanelModule,\r\n    TiDateDominatorModule,\r\n    TiLocaleModule\r\n  ],\r\n  exports: [TiDateComponent],\r\n  declarations: [TiDateComponent]\r\n})\r\nexport class TiDateModule {\r\n\r\n}\r\nexport { TiDateComponent } from './TiDateComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    NgZone,\r\n    Renderer2,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDateBaseComponent, TiDateValue } from '../datebase/TiDateBaseModule';\r\nimport { TiLocale, TiLocaleFormat } from '../../locale/TiLocaleModule';\r\n\r\n/**\r\n * DateRange日期范围组件\r\n *\r\n * DateRange组件提供了一种方便的显示和设置日期范围的方式\r\n *\r\n * <example-url>../tiny3demo/#/daterange/daterange-all</example-url>\r\n */\r\n@Component({\r\n   selector: 'ti-date-range',\r\n   templateUrl: './daterange.html',\r\n   styleUrls: ['./daterange.less'],\r\n   // tslint:disable-next-line:use-host-property-decorator\r\n   host: {\r\n    '[class.ti3-date-range-input-container]': 'true',\r\n    '(blur)': 'hidePanel()'\r\n},\r\n   providers: [ TiFormComponent.getValueAccessor(TiDateRangeComponent)]\r\n})\r\n\r\nexport class TiDateRangeComponent extends TiDateBaseComponent {\r\n    /**\r\n     * @ignore\r\n     * 日期显示格式: date组件的format为string类型\r\n     */\r\n    public format: string;\r\n    /**\r\n     * @ignore\r\n     * 标记date/datetime的类型\r\n     */\r\n    public isDatetime: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 用于标记是不是range\r\n     */\r\n    public isRange: boolean = true;\r\n    /**\r\n     * @ignore\r\n     * 保存model值\r\n     */\r\n    public oldModel: TiDateValue = {\r\n        begin: null,\r\n        end: null\r\n    };\r\n    /**\r\n     * @ignore\r\n     * placeholder提示文本\r\n     */\r\n    public placeholder: string = `${TiLocale.getLocaleWords().tiDate.rangeBeginLabel} ─ ${TiLocale.getLocaleWords().tiDate.rangeEndLabel}`;\r\n\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // format支持动态变更\r\n        if (changes['format'] && !changes['format'].firstChange) {\r\n            // 新的format是非法时，format值保持之前值不变\r\n            if (!Util.isString(changes['format'].currentValue)) {\r\n                this.format = changes['format'].previousValue;\r\n\r\n                return;\r\n            }\r\n\r\n            this.formatValue();\r\n        }\r\n\r\n        // 验证最大值最小值，为了处理最大值和最小值从合法日期变为undefined 的情景\r\n        if ((changes['max'] && !changes['max'].firstChange) || (changes['min'] && !changes['min'].firstChange)) {\r\n            this.validateMinAndMax(this.config, this.isDatetime);\r\n        }\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        // 监听value值\r\n        if (!Util.isUndefined(this.model)) {\r\n            if (!this.isValidValue(this.model)) {\r\n                return;\r\n            }\r\n            // 监听model值的变化\r\n            this.setModel(this.isDatetime);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 将value转换成format接口格式的字符串\r\n     */\r\n    public formatValue(): void {\r\n        if (this.model === null || (this.model.begin === null && this.model.end === null)) {\r\n\r\n            this.inputValue = '';\r\n        } else {\r\n            const begin: string = TiLocaleFormat.formatDate(this.model.begin, this.format);\r\n            const end: string = TiLocaleFormat.formatDate(this.model.end, this.format);\r\n            // 注意：中划线用的是制表符中的中划线，与正常的中线区分开2017-2-12 - 2018-3-20\r\n            this.inputValue = `${begin} ─ ${end}`;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    onKeydownFn(event: KeyboardEvent, pos: string): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.dateEditBlur(pos);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    dateEditBlur(pos: string): void {\r\n        // 输入值超出最大最小 认为非法\r\n        const value: any = this.datePanel.value;\r\n        if (TiDateUtil.isDate(value.begin) && TiDateUtil.isDate(value.end)) {\r\n            if (TiDateUtil.isBigger(value.begin, value.end)) {\r\n                if (pos === 'begin') {\r\n                    this.datePanel.value.begin = this.oldBeginValue || this.oldModel && this.oldModel.begin;\r\n                } else {\r\n                    this.datePanel.value.end = this.oldEndValue || this.oldModel && this.oldModel.end;\r\n                }\r\n            }\r\n            this.oldBeginValue = this.datePanel.value.begin;\r\n            this.oldEndValue = this.datePanel.value.end;\r\n        }\r\n        this.setOkBtnState();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 确认按钮\r\n     */\r\n    public onOkClick(): void {\r\n        if (this.inValidValue) {\r\n            return;\r\n        }\r\n\r\n        if (this.datePanel instanceof Object) {\r\n            // 新旧值不同更新model值\r\n            if (!this.rangeValueIsEqual(this.model, this.datePanel['value'], this.isDatetime)) {\r\n                this.model = {\r\n                    begin: this.datePanel['value'].begin,\r\n                    end: this.datePanel['value'].end\r\n                };\r\n            }\r\n        }\r\n\r\n        this.hideDrop();\r\n\r\n        this.okClick.emit(this.model);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 是否为禁用日期\r\n     */\r\n    public isDisabledDays(value: Date): boolean {\r\n        let isDisabled: boolean = false;\r\n        if (Util.isArray(this.disabledDays) && this.disabledDays.length > 0) {\r\n            this.disabledDays.forEach((item: Date) => {\r\n                if (item.getTime() === value.getTime()) {\r\n                    isDisabled = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        return isDisabled;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * model值的合法性判断\r\n     */\r\n    public isValidValue(value: TiDateValue): boolean {\r\n        if (value === null) {\r\n            return true;\r\n        }\r\n\r\n        return this.isValidRange(value) ? true : false;\r\n    }\r\n\r\n    // 判断是不是合法范围\r\n    private isValidRange(value: TiDateValue): boolean {\r\n        if (!(value instanceof Object) || !TiDateUtil.isDate(value.begin) || !TiDateUtil.isDate(value.end)) {\r\n            return false;\r\n        }\r\n\r\n        const startDate: Date = new Date(value.begin.getFullYear(), value.begin.getMonth(), value.begin.getDate());\r\n        const endDate: Date = new Date(value.end.getFullYear(), value.end.getMonth(), value.end.getDate());\r\n\r\n        return startDate.getTime() <= endDate.getTime() && TiDateUtil.isBetweenMaxAndmin(startDate, this.min, this.max)\r\n            && TiDateUtil.isBetweenMaxAndmin(endDate, this.min, this.max);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 设置确认按钮的状态\r\n     */\r\n    public setOkBtnState(): void {\r\n        const date: TiDateValue = this.datePanel.value;\r\n        let endTime: number;\r\n        let beginTime: number;\r\n        if (TiDateUtil.isDate(date.end)) {\r\n            endTime = new Date(date.end.getFullYear(), date.end.getMonth(), date.end.getDate()).getTime();\r\n        }\r\n        if (TiDateUtil.isDate(date.begin)) {\r\n            beginTime = new Date(date.begin.getFullYear(), date.begin.getMonth(), date.begin.getDate()).getTime();\r\n        }\r\n        const isBeginSmallorEqualEnd: boolean = this.isAllowBeginEqualEnd ? endTime < beginTime : endTime <= beginTime;\r\n        this.inValidValue = !(date instanceof Object)\r\n            || !TiDateUtil.isDate(date.begin)\r\n            || !TiDateUtil.isDate(date.end)\r\n            || isBeginSmallorEqualEnd;\r\n\r\n        if (this.buttonComs) {\r\n            this.setAttr(this.buttonComs.last.nativeElement, 'disabled', this.inValidValue);\r\n            this.setInputStyle(this.inValidValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 配置时间日期面板接口\r\n     */\r\n    public setPickerDate(): void {\r\n        // 做深拷贝的原因：不让model和datePanel组件中value双向绑定，\r\n        // 因为下拉面板中日期变化时，不立即更新到输入框中\r\n        let value: TiDateValue;\r\n        if (this.model === null || this.model === undefined) {\r\n             value = {\r\n                begin: null,\r\n                end: null\r\n             };\r\n        } else {\r\n            value = {\r\n                begin: this.model.begin,\r\n                end: this.model.end\r\n            };\r\n        }\r\n\r\n        this.datePanel = {\r\n            value,\r\n            format: this.format,\r\n            max: this.max,\r\n            min: this.min,\r\n            picker: 'day',\r\n            select: (): void => {\r\n                const obj: any = {\r\n                    value: this.datePanel.value[this.focusedPosition],\r\n                    focusedPosition: this.focusedPosition\r\n                };\r\n                this.dayClick.emit(obj);\r\n                // 初始化选择结束之后，如果开始未选择，焦点转移到开始日期编辑框\r\n                if (this.focusedPosition === 'end' && this.datePanel.value.begin === null) {\r\n                    this.focusedPosition = 'begin';\r\n                    this.dateEditComs.first.focus();\r\n                } else {\r\n                    if (!this.isEndFixed) {\r\n                        this.focusedPosition = 'end';\r\n                        this.dateEditComs.last.focus();\r\n                    }\r\n                }\r\n                this.setOkBtnState();\r\n            }\r\n\r\n        };\r\n\r\n        // 如果只显示年\r\n        if (this.format.indexOf('M') === -1 && this.format !== 'mediumDate') {\r\n            this.datePanel['picker'] = 'onlyYear';\r\n\r\n        } else if (this.format.indexOf('d') === -1) {  // 如果只显示年月\r\n            this.datePanel['picker'] = 'onlyYearMonth';\r\n\r\n        }\r\n        this.setOkBtnState();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiDateRangeComponent } from './TiDateRangeComponent';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiDatePanelModule } from '../datepanel/TiDatePanelModule';\r\nimport { TiDateEditModule } from '../dateedit/TiDateEditModule';\r\nimport { TiDateDominatorModule } from '../datedominator/TiDateDominatorModule';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiLocaleModule,\r\n    TiDropModule,\r\n    TiButtonModule,\r\n    TiDatePanelModule,\r\n    TiDateEditModule,\r\n    TiDateDominatorModule\r\n  ],\r\n  exports: [TiDateRangeComponent],\r\n  declarations: [TiDateRangeComponent]\r\n})\r\n\r\nexport class TiDateRangeModule {\r\n}\r\nexport { TiDateRangeComponent } from './TiDateRangeComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    NgZone,\r\n    Renderer2,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiLocale, TiLocaleFormat } from '../../locale/TiLocaleModule';\r\nimport { TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDateBaseComponent, TiDatetimeFormat, TimeOptions } from '../datebase/TiDateBaseModule';\r\n\r\n/**\r\n * Datetime日期时间组件\r\n *\r\n * Datetime组件提供了一种方便的显示和设置日期时间的方式。\r\n *\r\n * <example-url>../tiny3demo/#/datetime/datetime-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-datetime',\r\n    templateUrl: './datetime.html',\r\n    styleUrls: ['./datetime.less'],\r\n    host: {\r\n        '[class.ti3-datetime-input-container]': 'true',\r\n        '(blur)': 'hidePanel()'\r\n    },\r\n    providers: [ TiFormComponent.getValueAccessor(TiDatetimeComponent) ]\r\n})\r\nexport class TiDatetimeComponent extends TiDateBaseComponent {\r\n    /**\r\n     * @ignore\r\n     * 配置time组件的接口\r\n     */\r\n    public beginTime: TimeOptions = {};\r\n    /**\r\n     * @ignore\r\n     * 日期显示格式: Datetime组件的format为DatetimeFormat类型\r\n     */\r\n    public format: TiDatetimeFormat;\r\n    /**\r\n     * @ignore\r\n     * 标记date/datetime的类型\r\n     */\r\n    public isDatetime: boolean = true;\r\n    /**\r\n     * @ignore\r\n     * 用于标记是不是range\r\n     */\r\n    public isRange: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * placeholder提示文本\r\n     */\r\n    public placeholder: string = `${TiLocale.getLocaleWords().tiDate.datetimePlaceholder}`;\r\n    /**\r\n     * @ignore\r\n     * 旧时间值\r\n     */\r\n    public oldValue: any = '';\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.oldFormat = this.format;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // 验证最大值最小值，为了处理最大值和最小值从合法日期变为undefined 的情景\r\n        if ((changes['max'] && !changes['max'].firstChange) || (changes['min'] && !changes['min'].firstChange)) {\r\n            this.validateMinAndMax(this.config, this.isDatetime);\r\n        }\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        // 监听format的变化\r\n        this.setFormat();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * model值变化时的回调\r\n     */\r\n    ngOnModelChange(): void {\r\n        if (!TiDateUtil.isDate(this.model)) {\r\n            this.inputValue = '';\r\n\r\n            return;\r\n        }\r\n        this.formatValue();\r\n        this.setOkBtnState();\r\n        this.setPickerDate();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 确认按钮的点击事件处理\r\n     */\r\n    onOkClick(): void {\r\n        if (this.inValidValue) {\r\n            return;\r\n        }\r\n\r\n        if (!TiDateUtil.isDate(this.datePanel['value']['begin'])) {\r\n            this.dropCom.hide();\r\n\r\n            return;\r\n        }\r\n\r\n        // 获取时间的字符串\r\n        const dateStr: string = TiDateUtil.getDateStr(this.datePanel['value']['begin']);\r\n        // 空格误删\r\n        const newValue: Date = new Date(`${dateStr} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n        // 点击确认按钮对比新旧值：相等不做处理，不相等将新值赋给model\r\n        if (!TiDateUtil.isDatetimeEqual(this.model, newValue)) {\r\n            this.model = newValue;\r\n        }\r\n\r\n        this.hideDrop();\r\n\r\n        this.okClick.emit(this.model);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 设置下拉面板中datePanel组件接口\r\n     */\r\n    private setDatePanel(): void {\r\n        this.datePanel = {\r\n            picker: 'day',\r\n            max: this.max,\r\n            min: this.min,\r\n            format : this.format,\r\n            nowDateTime: this.nowDateTime,\r\n            value : {\r\n                begin: this.model,\r\n                end: null\r\n                },\r\n            select: (): void => {\r\n                // 点击日期面板值，校验时间的最大值最小值\r\n                // 原因：当选择的日期是最小或者最大时，需要校验当前的时间是否合法\r\n                // 设定时间范围\r\n                if (TiDateUtil.isDateEqual(this.datePanel['value']['begin'], this.max)) {\r\n                    this.beginTime['max'] = TiDateUtil.getTimeStr(this.max);\r\n                    this.beginTime['min'] = '00:00:00';\r\n                } else if (TiDateUtil.isDateEqual(this.datePanel['value']['begin'], this.min)) {\r\n                    this.beginTime['max'] = '23:59:59';\r\n                    this.beginTime['min'] = TiDateUtil.getTimeStr(this.min);\r\n                } else {\r\n                    this.beginTime['min'] = '00:00:00';\r\n                    this.beginTime['max'] = '23:59:59';\r\n                }\r\n                this.setBeginTime();\r\n                this.setOkBtnState();\r\n            },\r\n            selectTimeFn: (obj: any): void => {\r\n                this.setTimeFn(obj, this.beginTime);\r\n                this.setOkBtnState();\r\n            }\r\n        };\r\n    }\r\n    private setBeginTime(): void {\r\n        if (this.timeEditDisabled) {\r\n            this.beginTime['value'] = TiDateUtil.getTimeStr(new Date());\r\n        }\r\n        // 1.获取时间的字符串\r\n        const dateStr: string = TiDateUtil.getDateStr(this.datePanel['value']['begin']);\r\n        // 空格误删\r\n        const datetimeStr: Date = new Date(`${dateStr} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n        // 最大值校验\r\n        if (TiDateUtil.isBigger(datetimeStr, this.max)) {\r\n            this.beginTime['value'] = TiDateUtil.getTimeStr(this.max);\r\n        }\r\n        // 最小值校验\r\n        if (TiDateUtil.isSmaller(datetimeStr, this.min)) {\r\n            this.beginTime['value'] = TiDateUtil.getTimeStr(this.min);\r\n        }\r\n        this.oldValue = this.beginTime['value'];\r\n\r\n        this.timeEditDisabled = false;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @param event\r\n     * @param val\r\n     */\r\n    onKeydownFn(event: KeyboardEvent, val: any): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            if (!TiDateUtil.isDate(val)) {\r\n                return;\r\n            }\r\n            this.setBeginTime();\r\n            this.setOkBtnState();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public editBlur(val: any): void {\r\n        if (val !== null) {\r\n            this.setBeginTime();\r\n            this.setOkBtnState();\r\n        }\r\n     }\r\n    // 设置下拉面板中time组件接口\r\n    private setTime(): void {\r\n        // value接口设置\r\n        this.setTimeValue();\r\n\r\n        // maxValue接口设置\r\n        this.setTimeMaxValue();\r\n\r\n        // minValue接口设置\r\n        this.setTimeMinValue();\r\n    }\r\n\r\n    private setTimeValue(): void {\r\n        this.beginTime['value'] = TiDateUtil.isDate(this.model) ?  TiDateUtil.getTimeStr(this.model) : '';\r\n    }\r\n\r\n    private setTimeMaxValue(): void {\r\n        if (!TiDateUtil.isDate(this.model)) {\r\n            return;\r\n        }\r\n\r\n        this.beginTime['max'] = (TiDateUtil.isDateEqual(this.model, this.max)) ?\r\n                                    TiDateUtil.getTimeStr(this.max) : '23:59:59';\r\n    }\r\n\r\n    private setTimeMinValue(): void {\r\n        if (!TiDateUtil.isDate(this.model)) {\r\n            return;\r\n        }\r\n\r\n        this.beginTime['min'] = (TiDateUtil.isDateEqual(this.model, this.min)) ?\r\n                                    TiDateUtil.getTimeStr(this.min) : '00:00:00';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isValidValue(value: Date): boolean {\r\n        if (TiDateUtil.isDate(value) && TiDateUtil.isBetweenMaxAndmin(value, this.min, this.max)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public setPickerDate(): void {\r\n        // 设置下拉面板中datePanel组件接口\r\n        this.setDatePanel();\r\n\r\n        // 设置下拉面板中time组件接口\r\n        this.setTime();\r\n\r\n        this.setOkBtnState();\r\n\r\n        this.timeEditDisabled = TiDateUtil.isDate(this.model) ? false : true;\r\n\r\n        if (this.timeEditDisabled) {\r\n            this.selectTime = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 设置确认按钮的状态\r\n     */\r\n    public setOkBtnState(): void {\r\n        // 输入中文冒号之后，及时转换为英文冒号\r\n        const inputvalue: string = this.beginTime.value;\r\n        if (!Util.isUndefined(inputvalue)) {\r\n            this.beginTime.value = inputvalue.replace('：', ':');\r\n        }\r\n        const date: Date = this.datePanel.value.begin;\r\n        if (!TiDateUtil.isDate(date)) {\r\n            this.inValidValue = true;\r\n        } else {\r\n            const dateTime: Date = new Date(\r\n                `${TiDateUtil.getDateStr(date)} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n            this.inValidValue = !TiDateUtil.isBetweenMaxAndmin(dateTime, this.min, this.max);\r\n        }\r\n        if (this.buttonComs) {\r\n            this.setAttr(this.buttonComs.last.nativeElement, 'disabled', this.inValidValue);\r\n            this.setInputStyle(this.inValidValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 将value转换为format接口格式的字符串\r\n     */\r\n    public formatValue(): void {\r\n        if (this.model === null) {\r\n            this.inputValue = '';\r\n        } else {\r\n            // 空格误删\r\n            const format: string = `${this.format.date} ${TiDateUtil.addAmPm(this.format.time)}`;\r\n            this.inputValue = TiLocaleFormat.formatDateTime(this.model, format);\r\n        }\r\n        this.oldValue = TiDateUtil.getTimeStr(this.model);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 时间框失焦事件\r\n     */\r\n    public timeBlur(): void {\r\n        this.handleTimeValue();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 时间框enter事件\r\n     */\r\n    public timeKeydown(event: KeyboardEvent): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.handleTimeValue();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * time时间框输入内容处理\r\n     */\r\n    public handleTimeValue(): void {\r\n        // 区分中英文冒号\r\n        const reg: RegExp = new RegExp('[\\\\:\\\\：]');\r\n        const dateReg: RegExp = new RegExp('[年\\\\月\\\\日\\\\-\\\\/\\\\.\\\\_]');\r\n        // 输入区间是否存在小数点，非整数\r\n        let isNotInteger: boolean = false;\r\n        this.beginTime = JSON.parse(JSON.stringify(this.beginTime));\r\n\r\n        const timeArr: Array<string> = this.beginTime.value.split(reg);\r\n        timeArr.forEach((item: string, index: number): void => {\r\n            if (item.length === 1) {\r\n                timeArr[index] = '0' + item;\r\n            }\r\n            if (parseInt(item, 10) !== Number(item)) {\r\n                isNotInteger = true;\r\n            }\r\n        });\r\n        const dateStr: string = TiDateUtil.getDateStr(this.datePanel['value']['begin']);\r\n        const dateArr: Array<any> = dateStr.split(dateReg);\r\n        this.beginTime.value = timeArr.join(':');\r\n        const datetime: Date = new Date(`${dateStr} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n        const dateVal: Date = new Date(parseInt(dateArr[0], 10), parseInt(dateArr[1], 10), parseInt(dateArr[2], 10),\r\n        parseInt(timeArr[0], 10), parseInt(timeArr[1], 10), parseInt(timeArr[2], 10));\r\n        if (String(datetime) === 'Invalid Date' || String(dateVal) === 'Invalid Date' || timeArr.length > 3 || isNotInteger) {\r\n            this.beginTime.value = this.oldValue;\r\n            this.setOkBtnState();\r\n\r\n            return;\r\n        }\r\n        this.oldValue = this.beginTime.value;\r\n        this.setOkBtnState();\r\n    }\r\n    /**\r\n     * @description 判读字符串是否是合法的时间\r\n     * @param: time: 校验的时间\r\n     */\r\n    private isValidTime(time: string): boolean {\r\n        if (!Util.isString(time) || time.trim() === '') {\r\n            return false;\r\n        }\r\n        const date: any = new Date(`2018/5/15 ${time}`);\r\n\r\n        return !(String(date) === 'Invalid Date');\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    HostListener,\r\n    Input,\r\n    NgZone,\r\n    Renderer2,\r\n    SimpleChanges,\r\n    ViewChild,\r\n    Inject\r\n} from '@angular/core';\r\nimport { TiKeymap, Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleFormat, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { TiListComponent } from '../list/TiListModule';\r\n/**\r\n * @ignore\r\n */\r\nexport interface TimeField  {\r\n    hour: string;\r\n    minute: string;\r\n    second: string;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport interface TiComputingParams {\r\n    max: number;\r\n    min: number;\r\n    needAddZero: boolean;\r\n}\r\n\r\n/**\r\n * Time时间组件\r\n *\r\n * Time组件提供了一种方便的显示和设置时间的方式。\r\n *\r\n * <example-url>../tiny3demo/#/time/time-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-time',\r\n    templateUrl: './time.html',\r\n    styleUrls: ['./time.less' ],\r\n    providers: [TiFormComponent.getValueAccessor(TiTimeComponent) ],\r\n    host: {\r\n        '[class.ti3-time-container]': 'true',\r\n        '(blur)': 'onBlur()'\r\n    }\r\n})\r\n\r\nexport class TiTimeComponent extends TiFormComponent {\r\n    /**\r\n     * 设置时间显示格式。各个时间段格式规则; 默认值：'HH:mm:ss'\r\n     *\r\n     * 1.小时可以设置为：\r\n     *\r\n     * HH —— 24小时制,两位数字表示小时(00-23)\r\n     *\r\n     * H —— 24小时制，开头不补零数字表示小时(0-23)\r\n     *\r\n     * 2.分钟可以设置为：\r\n     *\r\n     * mm —— 两位数字表示分钟值（00-59）\r\n     *\r\n     * m —— 开头不补零数字表示分钟值（0-59）\r\n     *\r\n     * 3.秒可以设置为：\r\n     *\r\n     * ss —— 两位数字表示秒值(00-59)\r\n     *\r\n     * s —— 开头不补零数字表示秒值(0-59)\r\n     *\r\n     * 说明：开头补零是指当前时间是个位数字时，前边补零，始终保持两位数字\r\n     */\r\n    @Input() format: string;\r\n    /**\r\n     * 设置时间最大值 默认值：'23:59:59'\r\n     */\r\n    @Input() max: string;\r\n    /**\r\n     * 设置时间最小值 默认值：'00:00:00'\r\n     */\r\n    @Input() min: string;\r\n    /**\r\n     * 是否展示清除时间图标（默认显示）\r\n     *\r\n     * 10.1.2新增接口\r\n     */\r\n   @Input() clearIcon: boolean = true;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('dominator', { static: true }) private containerRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild(TiDropComponent, { static: true }) dropCom: TiDropComponent;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('text', { static: true }) textCom: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n   @ViewChild('input', { static: true }) inputEle: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('button', { static: true }) buttonEle: ElementRef;\r\n    private readonly localeWords: TiLocaleWords = TiLocale.getLocaleWords();\r\n    /**\r\n     * @ignore\r\n     * time编辑框内部value值\r\n     */\r\n    public inputValue: string = '';\r\n    /**\r\n     * @ignore\r\n     * dominator最终显示时间值\r\n     */\r\n    public timeValue: String = '';\r\n    /**\r\n     * @ignore\r\n     */\r\n    public dominatorCom: ElementRef;\r\n    /**\r\n     * @ignore\r\n     * 时间下拉面板宽度，根据时间格式宽度各异\r\n     */\r\n    public timePanelWidth: number = 284;\r\n    /**\r\n     * @ignore\r\n     * 底部确认按钮是否禁用\r\n     */\r\n    public buttonDisabled: boolean = true;\r\n    /**\r\n     * @ignore\r\n     * placeholder提示文本\r\n     */\r\n    public placeholder: string;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public hourOptions: Array<any>;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public minuteOptions: Array<any>;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public secondOptions: Array<any>;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public selectedHour: any;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public selectedMinute: any;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public selectedSecond: any;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public hourScroll: number;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public minuteScroll: number;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public secondScroll: number;\r\n    /**\r\n     * @ignore\r\n     * 只展示小时段\r\n     */\r\n    public onlyHour: boolean;\r\n    /**\r\n     * @ignore\r\n     * 只展示时分段\r\n     */\r\n    public onlyHourMinute: boolean;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public oldInputValue: string = '';\r\n    /**\r\n     * @ignore\r\n     * 面板与dominator的距离\r\n     */\r\n    public dominatorSpace: string = '-30px';\r\n    /**\r\n     * @ignore\r\n     * 是否清除\r\n     */\r\n    public isClearClick: boolean;\r\n    private documentKeydownListener: () => void;\r\n\r\n    constructor(\r\n        private zone: NgZone,\r\n        protected hostRef: ElementRef,\r\n        protected renderer2: Renderer2,\r\n        @Inject(DOCUMENT) private document\r\n    ) {\r\n        super(hostRef, renderer2);\r\n    }\r\n\r\n    /**\r\n     * @description: 若时间字符串没有一个冒号时处理成合法的事件字符串（加冒号）\r\n     * @param value 时间字符串\r\n     */\r\n    private static addColon(value: any): string {\r\n        // new Date()时，时间中没有一个冒号得到的是非法时间\r\n        if (value.match(/:/)) {\r\n            return value;\r\n        }\r\n        let ampm: string = value.match(/am|AM|pm|PM/);\r\n        ampm = ampm || '';\r\n\r\n        return `${parseInt(value, 10)}: ${ampm}`;\r\n    }\r\n\r\n    /**\r\n     * @description 判读字符串是否是合法的时间\r\n     * @param: time: 校验的时间\r\n     */\r\n    private static isValidTime(time: string): boolean {\r\n        // value非字符串或者为空字符串时，为非法时间\r\n        if (!Util.isString(time) || time.trim() === '') {\r\n            return false;\r\n        }\r\n\r\n        const date: any = new Date(`2018/5/15 ${TiTimeComponent.addColon(time)}`);\r\n\r\n        // any类型是为了防止编译报错 Date类型不能和string类型比较\r\n        return !(String(date) === 'Invalid Date');\r\n    }\r\n\r\n    /**\r\n     * @description: hh/HH/mm/ss 时间格式时，显示的值处理成2位，不足2位补0\r\n     * @param: num : 各个时间显示框的数值\r\n     * @param: length : 需要处理之后的长度\r\n     */\r\n    private static addZero(num: number, length: number): string {\r\n        const zeroNum: string = `00${num}`;\r\n\r\n        return zeroNum.substr(zeroNum.length - length, length);\r\n    }\r\n    /**\r\n     * @description newVal参数为合法值时返回newVal，否则返回defaultValue参数\r\n     * @param: newVal:新值\r\n     * @param: defaultValue:默认值\r\n     */\r\n    private static verifyTime(newVal: string, defaultValue: string): string {\r\n        return TiTimeComponent.isValidTime(newVal) ? newVal : defaultValue;\r\n    }\r\n    /**\r\n     * @description 比较value1和value2两个时间值大小.value1 < value2时，返回true；否则返回false  ；\r\n     * @param: value1:比较的前一个值\r\n     * @param: value2:比较的后一个值\r\n     */\r\n    private static isSmaller(value1: string, value2: string): boolean {\r\n        return Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value1)}`) < Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value2)}`);\r\n    }\r\n\r\n    /**\r\n     * @description 比较value1和value2两个时间值大小.value1 > value2时，返回true；否则返回false  ；\r\n     * @param: value1:比较的前一个值\r\n     * @param: value2:比较的后一个值\r\n     */\r\n    private static isBigger(value1: string, value2: string): boolean {\r\n        return Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value1)}`) > Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value2)}`);\r\n    }\r\n\r\n    /**\r\n     * @description 比较value1和value2两个时间值大小.value1 <= value2时，返回true；否则返回false  ；\r\n     * @param: value1:比较的前一个值\r\n     * @param: value2:比较的后一个值\r\n     */\r\n    private static isSmallerOrEqual(value1: string, value2: string): boolean {\r\n        return Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value1)}`) <= Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value2)}`);\r\n    }\r\n\r\n    /**\r\n     * @description 比较value1和value2两个时间值大小.value1 >= value2时，返回true；否则返回false  ；\r\n     * @param: value1:比较的前一个值\r\n     * @param: value2:比较的后一个值\r\n     */\r\n    private static isBiggerOrEqual(value1: string, value2: string): boolean {\r\n        return Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value1)}`) >= Date.parse(`2018/5/15 ${TiTimeComponent.addColon(value2)}`);\r\n    }\r\n\r\n    // 组件声明周期钩子--start\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始化变量\r\n        this.initVariable();\r\n        // 最大最小值校验\r\n        this.validateMaxAndMin();\r\n\r\n        this.showTimeWithFormat();\r\n\r\n        this.setTimeOptions();\r\n\r\n        this.placeholder = this.format;\r\n\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            // document上的Ecs快捷键功能\r\n            this.documentKeydownListener = this.renderer2.listen(this.document, 'keydown', this.keydownHandlerFn);\r\n        });\r\n    }\r\n\r\n    private setTimeOptions() {\r\n        this.hourOptions = this.setOptions(24, 'hour');\r\n        this.minuteOptions = this.setOptions(60, 'minute');\r\n        this.secondOptions = this.setOptions(60, 'second');\r\n    }\r\n    // 根据格式format判断面板展示情况\r\n    private showTimeWithFormat(): void {\r\n        // 纯小时\r\n        if (this.format.indexOf('m') === -1) {\r\n            this.onlyHour = true;\r\n        } else if (this.format.indexOf('s') === -1) { // 仅时分\r\n            this.onlyHourMinute = true;\r\n        }\r\n    }\r\n\r\n    private initVariable(): void {\r\n        // 1. 时间格式校验\r\n        this.format = Util.isString(this.format) ? this.format : this.localeWords.tiLocaleDate['time'];\r\n    }\r\n\r\n    private validateMaxAndMin(): void {\r\n        const defaultMaxValue: string = '23:59:59';\r\n        const defaultMinValue: string = '00:00:00';\r\n        // 最大值合法性校验\r\n        this.max = TiTimeComponent.verifyTime(this.max, defaultMaxValue);\r\n        // 最小值合法性校验\r\n        this.min = TiTimeComponent.verifyTime(this.min, defaultMinValue);\r\n        // 最大最小值矛盾时，设置为默认值\r\n        if (TiTimeComponent.isSmaller(this.max, this.min)) {\r\n            this.min = defaultMinValue;\r\n            this.max = defaultMaxValue;\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // 1.0 minValue监控\r\n        if (changes['min'] && !changes['min'].isFirstChange()) {\r\n            // 新minValue值非法时，恢复到之前值\r\n            if (!this.isValidMinValue(changes['min'].currentValue)) {\r\n                this.min = changes['min'].previousValue;\r\n\r\n                return;\r\n            }\r\n            // 对value值进行最小值校验\r\n            setTimeout(()=> {\r\n                if (TiTimeComponent.isValidTime(this.model) && TiTimeComponent.isSmaller(this.model, this.min)) {\r\n                    this.model = this.min;\r\n                    this.formatValue();\r\n                }\r\n                this.setDisableData();\r\n            }, 0);\r\n        }\r\n        // 2.0 maxValue监控\r\n        if (changes['max'] && !changes['max'].isFirstChange()) {\r\n            // 新maxValue值非法时，恢复到之前值\r\n            if (!this.isValidMaxValue(changes['max'].currentValue)) {\r\n                this.max = changes['max'].previousValue;\r\n\r\n                return;\r\n            }\r\n            // 对value值进行最小值校验\r\n            setTimeout(()=> {\r\n                if (TiTimeComponent.isValidTime(this.model) && TiTimeComponent.isBigger(this.model, this.max)) {\r\n                    this.model = this.max;\r\n                    this.formatValue();\r\n                }\r\n                this.setDisableData();\r\n            }, 0);\r\n        }\r\n        // 3.0 format监控\r\n        if (changes['format'] && !changes['format'].isFirstChange()) {\r\n            // 新format值非法时，恢复到之前值\r\n            if (!Util.isString(changes['format'].currentValue)) {\r\n                this.format = changes['format'].previousValue;\r\n\r\n                return;\r\n            }\r\n            this.showTimeWithFormat();\r\n            if (TiTimeComponent.isValidTime(this.model)) {\r\n                this.formatValue();\r\n            }\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        setTimeout(()=> {\r\n            this.dominatorCom = this.containerRef.nativeElement;\r\n            this.setFocusableElems([this.dominatorCom]\r\n            .concat(this.dropCom.nativeElement)\r\n            .concat(this.textCom.nativeElement)\r\n            .concat(this.inputEle.nativeElement)\r\n            .concat(this.buttonEle.nativeElement));\r\n        }, 0);\r\n\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        if (this.documentKeydownListener) {\r\n            this.documentKeydownListener();\r\n        }\r\n    }\r\n    // 组件声明周期钩子--end\r\n\r\n    // 实现ControlValueAccessor接口\r\n    /**\r\n     * @ignore\r\n     */\r\n    writeValue(value: any): void {\r\n        super.writeValue(value);\r\n        if (value === '' || !this.isValidValue(value)) {\r\n            this.model = '';\r\n            this.buttonDisabled = true;\r\n            this.setDisableData();\r\n\r\n            return;\r\n        }\r\n        this.buttonDisabled = false;\r\n        this.model = value;\r\n        this.formatValue();\r\n        this.setDisableData();\r\n    }\r\n    // 实现ControlValueAccessor接口--end\r\n    /**\r\n     * @ignore\r\n     * @description: 组件整体失焦之后处理函数\r\n     */\r\n    public onBlur(): void {\r\n         // 失焦后下拉关闭\r\n        this.hidePanel();\r\n        this.inputValue = this.model;\r\n        this.setDisableData();\r\n        this.setSelectVal();\r\n        this.getScrollData();\r\n    }\r\n    // 面板延迟200ms关闭,用户输入新值之后，直接点击确认按钮关闭面板时，\r\n    // 面板内部选中项先刷新 再关闭 200ms的延迟 用户可以看到这样一个视觉的过程\r\n    // 200ms通过本地用例，跟规范侧共同决定的一个延时数值\r\n    private hidePanel() {\r\n        setTimeout(()=> {\r\n            this.dropCom.hide();\r\n            // 初始化数据，保证有时间值时，初次打开数据定位在顶部\r\n            this.hourScroll = -1;\r\n            this.minuteScroll = -1;\r\n            this.secondScroll = -1;\r\n        }, 200);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击dominator打开面板\r\n     */\r\n    public onShowClick(): void {\r\n        if(this.disabled) {\r\n            return;\r\n        }\r\n        if (this.isClearClick) {\r\n            this.isClearClick = false;\r\n            return;\r\n        }\r\n        this.getScrollData();\r\n        this.dropCom.show();\r\n        this.textCom.nativeElement.focus();\r\n        this.buttonDisabled = !this.model;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击确认按钮关闭面板\r\n     */\r\n    public okClickFn(): void {\r\n        this.timeValue = this.inputValue;\r\n        this.model = this.inputValue;\r\n        // 记录旧值，当输入非法时，返回之前合法值\r\n        this.oldInputValue = this.inputValue;\r\n        this.containerRef.nativeElement.focus();\r\n        this.hidePanel();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 时间面板点击选择事件\r\n     * @param val\r\n     * @param title\r\n     */\r\n    public onSelect(val: any, title: string): void {\r\n        // 禁用状态\r\n        if (val.disabled) {\r\n            return;\r\n        }\r\n        const arr = this.onlyHour ? ['00'] : this.onlyHourMinute ? [\"00\", \"00\"] : [\"00\", \"00\", \"00\"];\r\n        const timeArr = this.inputValue === '' ? arr : this.inputValue.split(':');\r\n        switch (title) {\r\n            case 'hour':\r\n                timeArr[0] = val.label;\r\n                this.hourScroll = val.label * 30;\r\n                break;\r\n            case 'minute':\r\n                timeArr[1] = val.label;\r\n                this.minuteScroll = val.label * 30;\r\n                break;\r\n            case 'second':\r\n                timeArr[2] = val.label;\r\n                this.secondScroll = val.label * 30;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.inputValue = timeArr.join(':');\r\n        this.setSelectVal();\r\n        this.oldInputValue = this.inputValue;\r\n        this.buttonDisabled = false;\r\n        this.setDisableData();\r\n    }\r\n\r\n    private setSelectVal(): void {\r\n        if (!TiTimeComponent.isValidTime(this.inputValue)) {\r\n            this.selectedHour = null;\r\n            this.selectedMinute = null;\r\n            this.selectedSecond = null;\r\n            return;\r\n        }\r\n        if (TiTimeComponent.isSmaller(this.inputValue, this.min)) {\r\n            this.inputValue = this.min;\r\n        }\r\n        if (TiTimeComponent.isBigger(this.inputValue, this.max)) {\r\n            this.inputValue = this.max;\r\n        }\r\n        const newtimeArr = this.inputValue.split(':');\r\n        const hourVal: string =  TiTimeComponent.addZero(Number(newtimeArr[0]), 2);\r\n        const minuteVal: string =  TiTimeComponent.addZero(Number(newtimeArr[1]), 2);\r\n        const secondVal: string =  TiTimeComponent.addZero(Number(newtimeArr[2]), 2);\r\n        this.selectedHour = this.getSelectedVal(this.hourOptions, hourVal);\r\n        this.selectedMinute = this.getSelectedVal(this.minuteOptions, minuteVal);\r\n        this.selectedSecond = this.getSelectedVal(this.secondOptions, secondVal);\r\n        // 失焦之后，个位的数字需补零\r\n        if (this.onlyHour) {\r\n            this.inputValue = hourVal;\r\n        } else if (this.onlyHourMinute) {\r\n            this.inputValue = hourVal + ':' + minuteVal;\r\n        } else {\r\n            this.inputValue = hourVal + ':' + minuteVal + ':' + secondVal;\r\n        }\r\n        this.getScrollData();\r\n    }\r\n\r\n    private keydownHandlerFn = (event: KeyboardEvent): void => {\r\n        if (event.keyCode === TiKeymap.KEY_ESCAPE) {\r\n            this.hidePanel();\r\n        }\r\n    }\r\n    /**\r\n     * 组件快捷键处理tab键 enter键\r\n     */\r\n    @HostListener('keydown', ['$event']) public onKeydown(event: KeyboardEvent): void {\r\n        switch (event.keyCode) {\r\n            case TiKeymap.KEY_ENTER : // ENTER键(大键盘)\r\n            case TiKeymap.KEY_NUMPAD_ENTER : // ENTER键(数字小键盘)\r\n                this.responseEnter();\r\n                break;\r\n            default :\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * enter键的功能：如果面板展开不处理，面板收起则展开，设置datePanel指令的接口值\r\n     */\r\n    public responseEnter(): void {\r\n        if (this.dropCom.isShow) {\r\n            return;\r\n        }\r\n        this.getScrollData();\r\n        // 时间面板展开\r\n        this.dropCom.show();\r\n        this.textCom.nativeElement.focus();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 输入为中文冒号时，自动转换为英文冒号\r\n     * @param val\r\n     */\r\n    public onInputChangeFn(val: any) {\r\n        if(!Util.isEmptyString(val)) {\r\n            let value = val;\r\n            value = value.replace('：', ':');\r\n            this.inputValue = value;\r\n        } else {\r\n            this.buttonDisabled = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 时间框enter事件\r\n     */\r\n    public timeKeydownFn(event: KeyboardEvent, val: string): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.timeBlur(val);\r\n        }\r\n    }\r\n\r\n    public timeBlur(val: string): void {\r\n        if (val === '') {\r\n            this.buttonDisabled = true;\r\n            this.inputValue = '';\r\n            this.oldInputValue = this.inputValue;\r\n            this.getScrollData();\r\n            return;\r\n        }\r\n        // 区分中英文冒号\r\n        const reg: RegExp = new RegExp('[\\\\:\\\\：]');\r\n        let timeArr: Array<any> = val.split(reg);\r\n        const formatArr: Array<any> = this.format.split(':');\r\n        // 用户输入与format不匹配时，按照非法字符处理\r\n        if (timeArr.length !== formatArr.length) {\r\n            this.inputValue = this.oldInputValue;\r\n            return;\r\n        }\r\n        timeArr.forEach((item: any) => {\r\n            if ((item < 0 || item > 59) || isNaN(Number(item) ) || parseInt(item, 10) !== Number(item)) {\r\n                this.inputValue = this.oldInputValue;\r\n                if(Util.isEmptyString(this.inputValue)){\r\n                    this.buttonDisabled = false;\r\n                }\r\n                return;\r\n            }\r\n        });\r\n        this.oldInputValue = this.inputValue;\r\n        this.buttonDisabled = false;\r\n        this.setSelectVal();\r\n        this.getScrollData();\r\n        this.setDisableData();\r\n    }\r\n    // 获取滚动值\r\n    private getScrollData() {\r\n        if (Util.isEmptyString(this.inputValue)) {\r\n            this.hourScroll = 0;\r\n            this.minuteScroll = 0;\r\n            this.secondScroll = 0;\r\n        } else {\r\n            const reg: RegExp = new RegExp('[\\\\:\\\\：]');\r\n            const timeArr: Array<any> = this.inputValue.split(reg);\r\n            this.hourScroll = timeArr[0] * 30;\r\n            this.minuteScroll = timeArr[1] * 30;\r\n            this.secondScroll = timeArr[2] * 30;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 清除\r\n     */\r\n    public onIconClearClick(): void {\r\n        if (this.disabled || !this.clearIcon) {\r\n            return;\r\n        }\r\n        this.inputValue = '';\r\n        this.oldInputValue = '';\r\n        this.timeValue = '';\r\n        this.model = '';\r\n        this.selectedHour = null;\r\n        this.selectedMinute = null;\r\n        this.selectedSecond = null;\r\n        this.buttonDisabled = true;\r\n        this.isClearClick = true;\r\n        this.setDisableData();\r\n    }\r\n\r\n    private getSelectedVal(options: Array<any>, val: any) {\r\n        return options.find((item: any) => {\r\n            if (!item.disabled && item.label === val) {\r\n              return  item;\r\n            } else {\r\n                return null;\r\n            }\r\n        })\r\n    }\r\n    private setOptions(num: number, labelKey?: string): Array<any> {\r\n        const options: Array<any> = [];\r\n        for (let i: number = 0; i < num; i++) {\r\n            options[i] = {\r\n                label: TiTimeComponent.addZero(i, 2),\r\n                disabled: false\r\n            };\r\n        }\r\n\r\n        return options;\r\n    }\r\n\r\n    private setDisableData() {\r\n        if (this.max === '23:59:59' && this.min === '00:00:00') {\r\n            return false;\r\n        }\r\n        const maxArr = this.max.split(':');\r\n        const minArr = this.min.split(':');\r\n        const timeArr = this.inputValue.split(':');\r\n        // 根据最大最小值判定小时禁用项\r\n        this.hourOptions.forEach((item: any)=> {\r\n            item.disabled = Number(item.label) < Number(minArr[0]) || Number(item.label) > Number(maxArr[0]);\r\n        })\r\n        // 最小小时情况,需考虑分钟禁用\r\n        if (Number(timeArr[0]) === Number(minArr[0])) {\r\n            this.minuteOptions.forEach((minuteItem: any) => {\r\n                minuteItem.disabled = Number(minuteItem.label) < Number(minArr[1]);\r\n            })\r\n        }\r\n        // 最大小时情况,需考虑分钟禁用\r\n        if (Number(timeArr[0]) === Number(maxArr[0])) {\r\n            this.minuteOptions.forEach((minuteItem: any) => {\r\n                minuteItem.disabled = Number(minuteItem.label) >  Number(maxArr[1]);\r\n            })\r\n        }\r\n        // 最小时分情况,需考虑秒数禁用\r\n        if (Number(timeArr[0]) === Number(minArr[0]) && Number(timeArr[1]) === Number(minArr[1])) {\r\n            this.secondOptions.forEach((secondItem: any)=> {\r\n                secondItem.disabled  = Number(secondItem.label) < Number(minArr[2]);\r\n            })\r\n        } else if (Number(timeArr[0]) === Number(maxArr[0]) && Number(timeArr[1]) === Number(maxArr[1])) { // 最大时分情况,需考虑秒数禁用\r\n            this.secondOptions.forEach((secondItem: any)=> {\r\n                secondItem.disabled  = Number(secondItem.label) > Number(maxArr[2]);\r\n            })\r\n        } else {\r\n            this.secondOptions.forEach((secondItem: any)=> {\r\n                secondItem.disabled  = false;\r\n            })\r\n        }\r\n\r\n        // 非临界值(最大最小小时)时需复原\r\n        if (Number(timeArr[0]) !== Number(minArr[0]) && Number(timeArr[0]) !== Number(maxArr[0])) {\r\n            this.minuteOptions.forEach((minuteItem: any) => {\r\n                minuteItem.disabled = false;\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n    * @ignore\r\n    * 时间选择框部分鼠标移出时去除hover样式\r\n    */\r\n    public onMouseleave(listCom: TiListComponent) {\r\n        listCom.hoverOption = null;\r\n    }\r\n    // 组件交互方法集合--end\r\n\r\n    // 内部公共方法集合--start\r\n    /**\r\n     * @description:最大值最小值检验\r\n     */\r\n    private validateValue(): void {\r\n        // 最小值校验\r\n        if (TiTimeComponent.isSmaller(this.model, this.min)) {\r\n            this.model = this.min;\r\n        }\r\n        // 最大值校验\r\n        if (TiTimeComponent.isBigger(this.model, this.max)) {\r\n            this.model = this.max;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 时间格式化及时间各个框显示值设置\r\n     */\r\n    private formatValue(): void {\r\n        // 格式化value\r\n        const date: Date = new Date(`2018/5/15 ${TiTimeComponent.addColon(this.model)}`);\r\n        const formatStr: string = TiLocaleFormat.formatTime(date, this.format);\r\n        if (this.model !== formatStr) {\r\n            this.model = formatStr;\r\n        }\r\n        this.timeValue = this.model;\r\n        this.inputValue = this.model;\r\n        this.oldInputValue = this.inputValue;\r\n        const timeArr: Array<any> = this.inputValue.split(':');\r\n        this.selectedHour = this.getSelectedVal(this.hourOptions, TiTimeComponent.addZero(Number(timeArr[0]), 2));\r\n        this.selectedMinute = this.getSelectedVal(this.minuteOptions, TiTimeComponent.addZero(Number(timeArr[1]), 2));\r\n        this.selectedSecond = this.getSelectedVal(this.secondOptions, TiTimeComponent.addZero(Number(timeArr[2]), 2));\r\n    }\r\n    /**\r\n     * @description: 校验动态更新的minValue是否是合法值\r\n     * @param: minValue:动态更新的传入的minValue\r\n     */\r\n    private isValidMinValue(minValue: string): boolean {\r\n        return TiTimeComponent.isValidTime(minValue) && TiTimeComponent.isSmallerOrEqual(minValue, this.max);\r\n    }\r\n\r\n    /**\r\n     * @description: 校验动态更新的maxValue是否是合法值\r\n     * @param: maxValue:动态更新的传入的maxValue\r\n     */\r\n    private isValidMaxValue(maxValue: string): boolean {\r\n        return TiTimeComponent.isValidTime(maxValue) && TiTimeComponent.isBiggerOrEqual(maxValue, this.min);\r\n    }\r\n\r\n    /**\r\n     * @description: 判断动态更新写入组件的value值是否是一个合法值\r\n     * @param: value 动态更新写入组件的value值\r\n     */\r\n    private isValidValue(value: string): boolean {\r\n        return TiTimeComponent.isValidTime(value) &&\r\n                TiTimeComponent.isBiggerOrEqual(value, this.min) &&\r\n                TiTimeComponent.isSmallerOrEqual(value, this.max);\r\n    }\r\n    // 内部公共方法集合--end\r\n}\r\n","import { FormsModule } from '@angular/forms';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTimeComponent } from './TiTimeComponent';\r\nimport { TiDateDominatorModule } from '../datedominator/TiDateDominatorModule';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiListModule } from '../list/TiListModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        TiButtonModule,\r\n        TiDropModule,\r\n        TiListModule,\r\n        TiDateDominatorModule,\r\n        TiLocaleModule,\r\n        TiTextModule\r\n    ],\r\n    exports: [ TiTimeComponent ],\r\n    declarations: [ TiTimeComponent ]\r\n})\r\n\r\nexport class TiTimeModule {\r\n}\r\nexport { TiTimeComponent } from './TiTimeComponent';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\n\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiDatetimeComponent } from './TiDatetimeComponent';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiDatePanelModule } from '../datepanel/TiDatePanelModule';\r\nimport { TiDateEditModule } from '../dateedit/TiDateEditModule';\r\nimport { TiDateDominatorModule } from '../datedominator/TiDateDominatorModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiTimeModule } from '../time/TiTimeModule';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiLocaleModule,\r\n    TiDropModule,\r\n    TiButtonModule,\r\n    TiDatePanelModule,\r\n    TiDateEditModule,\r\n    TiTextModule,\r\n    TiTimeModule,\r\n    TiDateDominatorModule\r\n  ],\r\n  exports: [TiDatetimeComponent],\r\n  declarations: [TiDatetimeComponent]\r\n})\r\n\r\nexport class TiDatetimeModule {\r\n}\r\nexport { TiDatetimeComponent } from './TiDatetimeComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    NgZone,\r\n    Renderer2,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiDateUtil, TiKeymap, Util } from '../../utils/Util';\r\nimport { TiLocaleFormat, TiLocale } from '../../locale/TiLocaleModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDateBaseComponent, TiDateCustomizeOptions, TiDatetimeFormat, TiDateValue, TimeOptions } from '../datebase/TiDateBaseModule';\r\n/**\r\n * DatetimeRange日期时间范围组件\r\n *\r\n * Datetime组件提供了一种方便的显示和设置日期时间范围的方式。\r\n *\r\n * <example-url>../tiny3demo/#/datetimerange/datetimerange-all</example-url>\r\n */\r\n@Component({\r\n   selector: 'ti-datetime-range',\r\n   templateUrl: './datetimerange.html',\r\n   styleUrls: ['./datetimerange.less'],\r\n   host: {\r\n    '[class.ti3-datetime-range-input-container]': 'true',\r\n    '(blur)': 'hidePanel()'\r\n},\r\n   providers: [ TiFormComponent.getValueAccessor(TiDatetimeRangeComponent) ]\r\n})\r\n\r\nexport class TiDatetimeRangeComponent extends TiDateBaseComponent {\r\n\r\n    /**\r\n     * @ignore\r\n     * 保存model值\r\n     */\r\n    public oldModel: TiDateValue = {\r\n        begin: null,\r\n        end: null,\r\n    };\r\n    /**\r\n     * @ignore\r\n     * 对应Time组件的接口属性\r\n     */\r\n    public beginTime: TimeOptions = {};\r\n    /**\r\n     * @ignore\r\n     * 对应Time组件的接口属性\r\n     */\r\n    public endTime: TimeOptions = {};\r\n    /**\r\n     * @ignore\r\n     */\r\n    public beginTimeDisabled: boolean;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public endTimeDisabled: boolean;\r\n    /**\r\n     * @ignore\r\n     * 时间日期的format\r\n     */\r\n    public dominatorFormat: string;\r\n    /**\r\n     * @ignore\r\n     * 日期显示格式: Datetime组件的format为DatetimeFormat类型\r\n     */\r\n    public format: TiDatetimeFormat;\r\n    /**\r\n     * @ignore\r\n     * 标记date/datetime的类型\r\n     */\r\n    public isDatetime: boolean = true;\r\n    /**\r\n     * @ignore\r\n     * 用于标记是不是range\r\n     */\r\n    public isRange: boolean = true;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public oldBegintimeValue: any = '';\r\n    /**\r\n     * @ignore\r\n     */\r\n    public oldEndtimeValue: any = '';\r\n    /**\r\n     * @ignore\r\n     * placeholder提示文本\r\n     */\r\n    public placeholder: string = `${TiLocale.getLocaleWords().tiDate.rangeBeginLabel} ─ ${TiLocale.getLocaleWords().tiDate.rangeEndLabel}`;\r\n\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 将日期与时间的format拼接为一个字符串\r\n        this.dominatorFormat = `${this.format.date} ${this.format.time}`;\r\n        this.oldFormat = this.format;\r\n        // model有值时，需要记录初始时间值\r\n        if (Util.isUndefined(this.model)) {\r\n            return;\r\n        }\r\n        if (this.model !== null) {\r\n            setTimeout((): void => {\r\n                this.oldBegintimeValue = TiDateUtil.getTimeStr(this.model.begin);\r\n                this.oldEndtimeValue = TiDateUtil.getTimeStr(this.model.end);\r\n            }, 0);\r\n        }\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // 验证最大值最小值，为了处理最大值和最小值从合法日期变为undefined 的情景\r\n        if ((changes['max'] && !changes['max'].firstChange) || (changes['min'] && !changes['min'].firstChange)) {\r\n            this.validateMinAndMax(this.config, this.isDatetime);\r\n        }\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        if (!Util.isUndefined(this.model)) {\r\n            // 监听model值的变化\r\n            this.setModel(this.isDatetime);\r\n\r\n            // 监听format变化\r\n            this.setFormat();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 确认按钮事件处理\r\n     */\r\n    public onOkClick(): void {\r\n        if (this.inValidValue) {\r\n            return;\r\n        }\r\n\r\n        const beginDateStr: string = TiDateUtil.getDateStr(this.datePanel['value']['begin']);\r\n        // 中间空格误删\r\n        const beginValue: Date = new Date(`${beginDateStr} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n\r\n        const endDateStr: string = TiDateUtil.getDateStr(this.datePanel['value']['end']);\r\n        // 中间空格误删\r\n        const endValue: Date = new Date(`${endDateStr} ${TiDateUtil.addColon(this.endTime['value'])}`);\r\n\r\n        const newModel: TiDateValue = {\r\n            begin: beginValue,\r\n            end: endValue\r\n        };\r\n\r\n        // 新旧值不同更新model值\r\n        if (!this.rangeValueIsEqual(this.model, newModel, this.isDatetime)) {\r\n            this.model = newModel;\r\n        }\r\n\r\n        this.hideDrop();\r\n\r\n        this.okClick.emit(this.model);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * model值的合法性判断\r\n     */\r\n    public isValidValue(value: TiDateValue): boolean {\r\n        if (value === null) {\r\n            return true;\r\n        }\r\n\r\n        if (TiDateUtil.isDate(value['begin']) && TiDateUtil.isDate(value['end']) &&\r\n            value['begin'].getTime() <= value['end'].getTime() &&\r\n            TiDateUtil.isBetweenMaxAndmin(value['begin'], this.min, this.max) &&\r\n            TiDateUtil.isBetweenMaxAndmin(value['end'], this.min, this.max)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 将value转换成format接口格式的字符串\r\n     */\r\n    public formatValue(): void {\r\n        if (this.model === null || (this.model.begin === null && this.model.end === null)) {\r\n            this.inputValue = '';\r\n        } else {\r\n            // 空格误删\r\n            const format: string = `${this.format.date} ${TiDateUtil.addAmPm(this.format.time)}`;\r\n            const begin: string = TiLocaleFormat.formatDateTime(this.model.begin, format);\r\n            const end: string = TiLocaleFormat.formatDateTime(this.model.end, format);\r\n            // 注意：中划线用的是制表符中的中划线，与正常的中线区分开2017-2-12 - 2018-3-20\r\n            this.inputValue = `${begin} ─ ${end}`;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 配置时间日期面板接口\r\n     */\r\n    public setPickerDate(): void {\r\n        // 设置datepanel指令接口\r\n        this.setDatePanelOptions();\r\n\r\n        // 设置time指令接口\r\n        this.setTimeOptions();\r\n\r\n        // 设置OK按钮状态\r\n        this.setOkBtnState();\r\n        this.beginTimeDisabled = this.model === null ? true : false;\r\n        this.endTimeDisabled = this.model === null ? true : false;\r\n        this.timeEditDisabled = this.beginTimeDisabled && this.endTimeDisabled;\r\n    }\r\n\r\n    // 设置datepanel指令接口\r\n    private setDatePanelOptions(): void {\r\n        let value: TiDateValue;\r\n        if (this.model === null) {\r\n             value = {\r\n                begin: null,\r\n                end: null\r\n             };\r\n        } else {\r\n            value = {\r\n                begin: this.model.begin,\r\n                end: this.model.end\r\n            };\r\n        }\r\n\r\n        this.datePanel = {\r\n            value,\r\n            max: this.max,\r\n            min: this.min,\r\n            format : this.format,\r\n            picker: 'day',\r\n            select: (): void => {\r\n                const obj: any = {\r\n                    value: this.datePanel.value[this.focusedPosition],\r\n                    focusedPosition: this.focusedPosition\r\n                };\r\n                this.dayClick.emit(obj);\r\n                // 选择开始日期\r\n                if (this.focusedPosition === 'begin') {\r\n                    if (this.beginTimeDisabled) {\r\n                        this.beginTime['value'] = TiDateUtil.getTimeStr(new Date());\r\n                    }\r\n                    this.beginTimeDisabled = false;\r\n                    this.timeEditDisabled = false;\r\n                    this.dateEditComs.last.focus();\r\n                    this.focusedPosition = 'end';\r\n                } else {\r\n                    if (this.endTimeDisabled) {\r\n                        this.endTime['value'] = TiDateUtil.getTimeStr(new Date());\r\n                    }\r\n                    this.endTimeDisabled = false;\r\n                    if (this.focusedPosition === 'end' && this.datePanel.value.begin === null) {\r\n                        this.focusedPosition = 'begin';\r\n                        this.dateEditComs.first.focus();\r\n                    }\r\n                }\r\n                this.validTime();\r\n                this.setOkBtnState();\r\n            },\r\n            selectTimeFn: (obj: any): void => {\r\n                this.setTimeFn(obj, this.beginTime, this.endTime);\r\n                this.setOkBtnState();\r\n                // 选择结束时分秒 焦点移动到结束时间框\r\n                if (obj.timeOption.includes('end')) {\r\n                    this.textComs.last.nativeElement.focus();\r\n                } else {\r\n                // 选择开始时分秒 焦点移动到开始时间框\r\n                    this.textComs.first.nativeElement.focus();\r\n                }\r\n            }\r\n         };\r\n    }\r\n\r\n    private validTime(): void {\r\n        const beginDateStr: string = this.datePanel.value.begin ? TiDateUtil.getDateStr(this.datePanel.value.begin) : '';\r\n        const beginDateTime: Date = new Date(` ${beginDateStr} ${this.beginTime.value}`);\r\n        const endDateStr: string = this.datePanel.value.end ? TiDateUtil.getDateStr(this.datePanel.value.end) : '';\r\n        const endDateTime: Date = new Date(` ${endDateStr} ${this.endTime.value}`);\r\n        if (TiDateUtil.isSmaller(beginDateTime, this.min)) {\r\n            this.beginTime.value = TiDateUtil.getTimeStr(this.min);\r\n        }\r\n        if (TiDateUtil.isBigger(beginDateTime, this.max)) {\r\n            this.beginTime.value = TiDateUtil.getTimeStr(this.max);\r\n        }\r\n        if (TiDateUtil.isBigger(endDateTime, this.max)) {\r\n            this.endTime.value = TiDateUtil.getTimeStr(this.max);\r\n        }\r\n        this.oldBegintimeValue = this.beginTime['value'];\r\n        this.oldEndtimeValue = this.endTime['value'];\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     *  时间框失焦事件\r\n     */\r\n    public timeBlur(pos: string, val: string): void {\r\n        let timeVal: string = val;\r\n        // 区分中英文冒号\r\n        const reg: RegExp = new RegExp('[\\\\:\\\\：]');\r\n        this.beginTime = JSON.parse(JSON.stringify(this.beginTime));\r\n        this.endTime = JSON.parse(JSON.stringify(this.endTime));\r\n        // 输入区间是否存在小数点，非整数\r\n        let isNotInteger: boolean = false;\r\n        const timeArr: Array<string> = val.split(reg);\r\n        timeArr.forEach((item: string, index: number): void => {\r\n            if (item.length === 1) {\r\n                timeArr[index] = '0' + item;\r\n            }\r\n            if (parseInt(item, 10) !== Number(item)) {\r\n                isNotInteger = true;\r\n            }\r\n        });\r\n        timeVal = timeArr.join(':');\r\n        const dateStr: string = '2020/10/30';\r\n        if (pos === 'begin') {\r\n            this.beginTime.value = timeVal;\r\n            const beginDateVal: Date = new Date(`${TiDateUtil.getDateStr(this.datePanel.value.begin)} ${this.beginTime.value}`);\r\n            const isSmallerThanMin: boolean = TiDateUtil.isSmaller(beginDateVal, this.min);\r\n            const beginDate: Date = new Date(`${dateStr} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n            const dateVal: Date = new Date(2020, 10, 30, parseInt(timeArr[0], 10), parseInt(timeArr[1], 10), parseInt(timeArr[2], 10));\r\n            if (String(beginDate) === 'Invalid Date' || String(dateVal) === 'Invalid Date' || timeArr.length > 3 || isNotInteger || !this.isBeginSmallerThanEnd() || isSmallerThanMin) {\r\n                this.beginTime.value = this.oldBegintimeValue;\r\n            } else {\r\n                this.oldBegintimeValue = this.beginTime.value;\r\n            }\r\n        } else {\r\n            this.endTime.value = timeVal;\r\n            const endDateVal: Date = new Date(`${TiDateUtil.getDateStr(this.datePanel.value.end)} ${this.endTime.value}`);\r\n            const isBiggerThanMax: boolean = TiDateUtil.isBigger(endDateVal, this.max);\r\n            const endDate: Date = new Date(`${dateStr} ${TiDateUtil.addColon(this.endTime['value'])}`);\r\n            const dateVal: Date = new Date(2020, 10, 30, parseInt(timeArr[0], 10), parseInt(timeArr[1], 10), parseInt(timeArr[2], 10));\r\n            if (String(endDate) === 'Invalid Date' || String(dateVal) === 'Invalid Date' || timeArr.length > 3 || isNotInteger || !this.isBeginSmallerThanEnd() || isBiggerThanMax) {\r\n                this.endTime.value = this.oldEndtimeValue;\r\n            } else {\r\n                this.oldEndtimeValue = this.endTime.value;\r\n            }\r\n        }\r\n        this.setOkBtnState();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 时间框enter事件\r\n     */\r\n    public timeKeydown(pos: string, val: string, event: KeyboardEvent): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.timeBlur(pos, val);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public dateEditBlur(val: any, pos: string): void {\r\n        if (val === null) {\r\n            return;\r\n        }\r\n        if (TiDateUtil.isBetweenMaxAndmin(val, this.min, this.max)) {\r\n            if (pos === 'begin') {\r\n                const inputValue: string = this.dateEditComs.first.nativeElement.firstChild.value;\r\n                if (inputValue === '') {\r\n                    return;\r\n                }\r\n                const beginDateVal: Date = new Date(`${inputValue} ${this.beginTime['value']}`);\r\n                if (TiDateUtil.isDate(this.datePanel.value.end)) {\r\n                    const endDateVal: Date = new Date(`${TiDateUtil.getDateStr(this.datePanel.value.end)} ${this.endTime['value']}`);\r\n                    if (TiDateUtil.isBigger(beginDateVal, endDateVal)) {\r\n                        this.datePanel.value.begin = this.oldBeginValue || this.oldModel && this.oldModel.begin;\r\n                        return;\r\n                    }\r\n                }\r\n                if (this.beginTimeDisabled) {\r\n                    this.beginTime['value'] = TiDateUtil.getTimeStr(new Date());\r\n                }\r\n                this.oldBeginValue = this.datePanel.value.begin;\r\n                this.beginTimeDisabled = false;\r\n            } else {\r\n                if (this.endTimeDisabled) {\r\n                    this.endTime['value'] = TiDateUtil.getTimeStr(new Date());\r\n                }\r\n                const inputValue: string = this.dateEditComs.last.nativeElement.firstChild.value;\r\n                if (inputValue === '') {\r\n                    return;\r\n                }\r\n                const endDateVal: Date = new Date(`${inputValue} ${this.endTime['value']}`);\r\n                if (TiDateUtil.isDate(this.datePanel.value.begin)) {\r\n                    const beginDateVal: Date = new Date(`${TiDateUtil.getDateStr(this.datePanel.value.begin)} ${this.beginTime['value']}`);\r\n                    if (TiDateUtil.isBigger(beginDateVal, endDateVal)) {\r\n                        this.datePanel.value.end = this.oldEndValue || this.oldModel && this.oldModel.end;\r\n                        return;\r\n                    }\r\n                }\r\n                this.oldEndValue = this.datePanel.value.end;\r\n                this.endTimeDisabled = false;\r\n            }\r\n            this.validTime();\r\n            this.setOkBtnState();\r\n            this.timeEditDisabled = this.beginTimeDisabled && this.endTimeDisabled;\r\n        }\r\n\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onKeydownFn(event: KeyboardEvent, val: any, pos: string): void {\r\n        if (event.keyCode === TiKeymap.KEY_ENTER  || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n            this.dateEditBlur(val, pos);\r\n        }\r\n     }\r\n\r\n    // 设置time指令接口\r\n    private setTimeOptions(): void {\r\n        // 设置开始time指令接口\r\n        this.setBeginTimeOptions();\r\n\r\n        // 设置结束time指令接口\r\n        this.setEndTimeOptions();\r\n    }\r\n\r\n    // 设置开始面板time指令接口\r\n    private setBeginTimeOptions(): void {\r\n        // value接口设置\r\n        this.setBeginTimeValue();\r\n\r\n        // max接口设置\r\n        this.setBeginTimeMaxValue();\r\n\r\n        // min接口设置\r\n        this.setBeginTimeMinValue();\r\n    }\r\n\r\n    // time指令的起始面板的value接口设置 点击删除按钮：如果设置nowDateTime并且值为合法时间日期，时间设置为nowDateTime的时间\r\n    private setBeginTimeValue(): void {\r\n        if (this.model === null || this.model['begin'] === null && this.model['end'] === null) {\r\n            this.beginTime['value'] = '';\r\n\r\n            return;\r\n        }\r\n\r\n        this.beginTime['value'] = TiDateUtil.getTimeStr(this.model.begin);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * time指令的起始面板的max接口设置\r\n     */\r\n    public setBeginTimeMaxValue(): void {\r\n        // 起始日期是最大日期时，时间组件最大值是max接口中的时间；其他情况最大值是\"23:59:59\"\r\n        const value: TiDateValue = this.datePanel['value'];\r\n        this.beginTime['max'] = ((value instanceof Object) && TiDateUtil.isDateEqual(this.max, value['begin'])) ?\r\n                                TiDateUtil.getTimeStr(this.max) : '23:59:59';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * time指令的起始面板的min接口设置\r\n     */\r\n    public setBeginTimeMinValue(): void {\r\n        // 起始日期是最小日期时，时间组件最小值是min接口中的时间；其他情况最大值是\"00:00:00\"\r\n        const value: TiDateValue = this.datePanel['value'];\r\n        this.beginTime['min'] = ((value instanceof Object) && TiDateUtil.isDateEqual(this.min, value['begin'])) ?\r\n                                TiDateUtil.getTimeStr(this.min) : '00:00:00';\r\n    }\r\n\r\n    // 设置结束面板time指令接口\r\n    private setEndTimeOptions(): void {\r\n        // value接口设置\r\n        this.setEndTimeValue();\r\n\r\n        // max接口设置\r\n        this.setEndTimeMaxValue();\r\n\r\n        // min接口设置\r\n        this.setEndTimeMinValue();\r\n    }\r\n\r\n    // time指令的结束面板的value接口设置\r\n    private setEndTimeValue(): void {\r\n        if (this.model === null || this.model['begin'] === null && this.model['end'] === null) {\r\n            this.endTime['value'] = '';\r\n\r\n            return;\r\n        }\r\n\r\n        this.endTime['value'] = TiDateUtil.getTimeStr(this.model.end);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * time指令的结束面板的max接口设置\r\n     */\r\n    public setEndTimeMaxValue(): void {\r\n        // 结束日期是最大日期时，时间组件最大值是max接口中的时间; 否则，时间组件最大值是\"23:59:59\"\r\n        const value: TiDateValue = this.datePanel['value'];\r\n        this.endTime['max'] = ((value instanceof Object) && TiDateUtil.isDateEqual(this.max, value['end'])) ?\r\n                                TiDateUtil.getTimeStr(this.max) : '23:59:59';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * time指令的结束面板的min接口设置\r\n     */\r\n    public setEndTimeMinValue(): void {\r\n        // 起始日期是最小日期时，时间组件最小值是min接口中的时间；其他情况最大值是\"00:00:00\"\r\n        const value: TiDateValue = this.datePanel['value'];\r\n        this.endTime['min'] = ((value instanceof Object) && TiDateUtil.isDateEqual(this.min, value['end'])) ?\r\n                                TiDateUtil.getTimeStr(this.min) : '00:00:00';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 设置确认按钮的状态\r\n     */\r\n    public setOkBtnState(): void {\r\n        // 输入中文冒号之后，及时转换为英文冒号\r\n        const inputvalue: string = this.beginTime.value;\r\n        const inputvalue1: string = this.endTime.value;\r\n        this.beginTime.value = inputvalue.replace('：', ':');\r\n        this.endTime.value = inputvalue1.replace('：', ':');\r\n        // 判断下拉面板中时间区间是否合法\r\n        this.inValidValue = !this.isValidRange();\r\n        if (this.buttonComs) {\r\n            this.setAttr(this.buttonComs.last.nativeElement, 'disabled', this.inValidValue);\r\n            this.setInputStyle(this.inValidValue);\r\n        }\r\n    }\r\n\r\n    // 判断下拉面板中时间区间是否合法\r\n    private isValidRange(): boolean {\r\n        const date: TiDateValue = this.datePanel.value;\r\n\r\n        return (date instanceof Object) && (TiDateUtil.isDate(date.begin)) &&\r\n                (TiDateUtil.isDate(date.end)) && this.isBeginSmallerThanEnd();\r\n    }\r\n\r\n    // 判断起始值和结束值都在最小值最大值之间\r\n    private isBeginSmallerThanEnd(): boolean {\r\n        if (!TiDateUtil.isDate(this.datePanel.value.begin) || !TiDateUtil.isDate(this.datePanel.value.end)) {\r\n            return false;\r\n        }\r\n        // 组装起始日期时间 空格误删\r\n        const begin: Date = new Date(\r\n            `${TiDateUtil.getDateStr(this.datePanel.value.begin)} ${TiDateUtil.addColon(this.beginTime['value'])}`);\r\n        const end: Date = new Date(\r\n            `${TiDateUtil.getDateStr(this.datePanel.value.end)} ${TiDateUtil.addColon(this.endTime['value'])}`);\r\n\r\n        return begin.getTime() <= end.getTime();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiDatetimeRangeComponent } from './TiDatetimeRangeComponent';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiDatePanelModule } from '../datepanel/TiDatePanelModule';\r\nimport { TiDateEditModule } from '../dateedit/TiDateEditModule';\r\nimport { TiTimeModule } from '../time/TiTimeModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiDateDominatorModule } from '../datedominator/TiDateDominatorModule';\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiLocaleModule,\r\n    TiDropModule,\r\n    TiButtonModule,\r\n    TiDatePanelModule,\r\n    TiDateEditModule,\r\n    TiTimeModule,\r\n    TiTextModule,\r\n    TiDateDominatorModule\r\n  ],\r\n  exports: [TiDatetimeRangeComponent],\r\n  declarations: [TiDatetimeRangeComponent]\r\n})\r\n\r\nexport class TiDatetimeRangeModule {\r\n}\r\nexport { TiDatetimeRangeComponent } from './TiDatetimeRangeComponent';\r\n","import { Component, ContentChild, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2,\r\n    TemplateRef } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-dominator',\r\n    templateUrl: './dominator.html',\r\n    styleUrls: ['./dominator.less'],\r\n    host: {\r\n        '[class.ti3-select-dominator-container]': 'true',\r\n        '[class.ti3-multiselect-container]': 'multiple'\r\n    },\r\n    providers: [TiFormComponent.getValueAccessor(TiDominatorComponent)]\r\n})\r\nexport class TiDominatorComponent extends TiFormComponent {\r\n\r\n    @Input() labelKey: string; // 呈现的内容（无删除按钮） TODO: 含删除按钮的场景，扩展为Array\r\n    @Input() placeholder: string; // 组件的预留文本\r\n    @Input() buttonStyle: 'dropdown' |'plus' = 'dropdown'; // 按钮样式 三角or加号 'dropdown' 'plus'\r\n    @Input() multiple: boolean = false; // 单选多选\r\n    @Input() selectedTipPosition: TiPositionType = 'auto'; // 选中项文本超出时tip展开方向\r\n    @Input() dropshow: boolean = false; // 在select组件中使用，记录下拉面板展开状态\r\n    /**\r\n     * @ignore\r\n     * tag的最大宽，TpSearchbox使用\r\n     */\r\n    @Input() tagMaxWidth: string;\r\n    /**\r\n     * 设置dominator最多显示几行，默认2行, multiple为true时生效\r\n     */\r\n    @Input() maxLine: number = 2 ;\r\n    /**\r\n     * 设置是否显示已选项的个数，默认不显示，multiple为true时生效\r\n     *\r\n     * 10.1.0新增\r\n     */\r\n    @Input() showSelectedNumber: boolean = false ;\r\n    /**\r\n     * 设置dominator 内容的最大高度，默认是两行的高度，multiple为true时生效，此参数设置后maxLine接口失效\r\n     */\r\n    @Input() maxHeight: string;\r\n    @Input() type: 'tagsinput' | string;\r\n    /**\r\n     * 单选下拉选择框是否开启清除已选项功能\r\n     *\r\n     * 3.0.8新增\r\n     */\r\n    @Input() clearable: boolean = false;\r\n    @Output() readonly delete: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * 当单选下拉选择框开启清除已选项功能时，点击清除按钮时触发\r\n     *\r\n     * 3.0.8新增\r\n     */\r\n    @Output() readonly clear: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) firstTemplate: TemplateRef<any>;\r\n    @ContentChild('item', /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n    @ContentChild('placeholder') placeholderTemplate: TemplateRef<any>;\r\n\r\n    private isMouseIn: boolean = false;\r\n    constructor(render: Renderer2, hostRef: ElementRef, private zone: NgZone) {\r\n        super(hostRef, render);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 每行tag的高度24px, +2 是因为 .ti3-select-dominator-text 元素上下padding\r\n        // tslint:disable-next-line: binary-expression-operand-order\r\n        this.maxHeight = !this.multiple ? '' : this.maxHeight ? this.maxHeight : (this.maxLine * 24 + 2) + 'px';\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        this.setFocusableElems([this.nativeElement]);\r\n        this.zone.runOutsideAngular(() => {\r\n            // 内部mousedown事件冒泡至根节点\r\n            this.renderer.listen(this.nativeElement, 'mousedown', (event: MouseEvent): void => {\r\n                if (this.disabled) {\r\n                    event.preventDefault(); // 不能聚焦，不能click\r\n                }\r\n            });\r\n            if (this.clearable && !this.multiple) {\r\n                this.renderer.listen(this.nativeElement, 'mouseenter', (): void => {\r\n                    if (this.disabled || Util.isEmptyString(this.model)) {\r\n                        return;\r\n                    }\r\n                    this.zone.run(() => {\r\n                        this.isMouseIn = true;\r\n                    });\r\n                });\r\n                this.renderer.listen(this.nativeElement, 'mouseleave', (): void => {\r\n                    if (this.isMouseIn) {\r\n                        this.zone.run(() => {\r\n                            this.isMouseIn = false;\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * 兼容旧版：\r\n     * 3.1.2版select只能内嵌一个模板，无命名。\r\n     * 新版可以内嵌2个模板，示例书写要求都命名。\r\n     * 但需要兼容旧版无命名测试用例。\r\n     */\r\n    ngAfterContentInit(): void {\r\n        super.ngAfterContentInit();\r\n        // 如果item模板为空，那么把第一个出现的无标签（无footer等标签）模板作为item\r\n        if (!this.itemTemplate && this.firstTemplate !== this.placeholderTemplate) {\r\n            this.itemTemplate = this.firstTemplate;\r\n        }\r\n    }\r\n    /**\r\n     * 用户点击叉号，删除一个项目\r\n     * @param item\r\n     * @returns\r\n     */\r\n    public onDelete(item: any): void {\r\n        if (item.disabled === true) {\r\n            return;\r\n        }\r\n        // 删除选中\r\n        const index: number = this.model.indexOf(item);\r\n        if (index !== -1) {\r\n            this.model.splice(index, 1);\r\n        }\r\n        this.delete.emit({\r\n            item: item,\r\n            model: this.model\r\n        });\r\n        // 强行向外通知model改变。\r\n        this.model = this.model.concat();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onClickClear(event: MouseEvent): void {\r\n        event.stopPropagation();\r\n        this.model = null;\r\n        this.clear.emit();\r\n    }\r\n    public showClear(): boolean {\r\n        return this.clearable && !this.multiple && !this.disabled && (this.isMouseIn || this.focused) && this.model;\r\n    }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiPositionType } from '../../utils/Position';\r\n// TODO: 等待规范统一，可能只保留方形tag\r\n// TODO: hover时是否需要高亮，选中是否高亮。增加selectable接口，表示是否可以选中。\r\n// TODO: 禁用时是否显示叉号？规范和tiny2不一致。\r\n// TODO: 禁用时，不发出原生click事件。\r\n/**\r\n * Tag标签组件，支持显示自定义内容，和删除事件通知。\r\n *\r\n * <example-url>../tiny3demo/#/tag/tag-all</example-url>\r\n */\r\n@Component({\r\n      selector: 'ti-tag',\r\n      templateUrl: './tag.html',\r\n      styleUrls: ['./tag-rect.less'],\r\n      host: {\r\n            '[class.ti3-multiselect-box-cell]': 'true',\r\n            '[class.ti3-multiselect-option-disabled]': 'disabled',\r\n            '[style.maxWidth]': 'maxWidth'\r\n      }\r\n      // styleUrls: ['./tag-rect.less', './tag-arrow.less'],\r\n      // host: {\r\n      //       '[class.ti3-tag-container]': 'shape ===\"arrow\"',\r\n      //       '[class.ti3-multiselect-box-cell]': 'shape ===\"rect\"',\r\n      //       '[class.ti3-multiselect-option-disabled]': 'shape ===\"rect\"&&disabled'\r\n      // }\r\n})\r\nexport class TiTagComponent extends TiBaseComponent {\r\n      // @Input() data; // 数据，作为唯一标识\r\n      /**\r\n       * @ignore\r\n       * 样式：有方形和箭头形两种样式，后面可能废弃箭头样式\r\n       */\r\n      // @Input() shape: 'rect'|'arrow'  = 'rect';\r\n      /**\r\n       * 是否禁用\r\n       */\r\n      @Input() disabled: boolean = false;\r\n      /**\r\n       * 选中项文本超出时tip展开方向\r\n       *\r\n       * 9.0.3新增\r\n       */\r\n      @Input() selectedTipPosition: TiPositionType = 'auto';\r\n      /**\r\n       * @ignore\r\n       * 最大宽度，TpSearchbox 使用\r\n       */\r\n      @Input() maxWidth: string;\r\n      /**\r\n       * 删除Tag时的通知事件\r\n       */\r\n      @Output() readonly delete: EventEmitter<any> = new EventEmitter<any>();\r\n      /**\r\n       * @ignore\r\n       * @param $event\r\n       */\r\n      public onClickDelete($event: MouseEvent): void {\r\n            if (this.disabled) {\r\n                  return;\r\n            }\r\n            $event.stopPropagation(); // 阻止冒泡，阻止了Tag整体的onClick事件，也阻止Tag之外接收到Click。\r\n            this.delete.emit();\r\n      }\r\n      /**\r\n       * 删除Tag标签element\r\n       */\r\n      public remove(): void {\r\n            this.renderer.removeChild(this.renderer.parentNode(this.nativeElement), this.nativeElement);\r\n      }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiTagComponent } from './TiTagComponent';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule\r\n  ],\r\n  exports: [TiTagComponent],\r\n  declarations: [TiTagComponent]\r\n})\r\nexport class TiTagModule {\r\n}\r\nexport { TiTagComponent } from './TiTagComponent';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiDominatorComponent } from './TiDominatorComponent';\r\nimport { TiTagModule } from '../tag/TiTagModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiTipModule,\r\n    TiLocaleModule,\r\n    TiTagModule\r\n  ],\r\n  exports: [TiDominatorComponent],\r\n  declarations: [TiDominatorComponent]\r\n})\r\nexport class TiDominatorModule {\r\n}\r\nexport { TiDominatorComponent } from './TiDominatorComponent';\r\n","/*\r\n * @Author: walker\r\n * @Date: 2018-09-06 15:05:42\r\n * @Last Modified by: walker\r\n * @Last Modified time: 2018-09-12 11:03:35\r\n */\r\nimport { Component, ContentChild, EventEmitter, Input, Output, TemplateRef } from '@angular/core';\r\nimport { TiAutocompleteComponent } from '../autocomplete/TiAutocompleteModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * 搜索框组件\r\n *\r\n * <example-url>../tiny3demo/#/searchbox/searchbox-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-searchbox',\r\n    templateUrl: './searchbox.html',\r\n    styleUrls: ['./searchbox.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiSearchboxComponent)],\r\n    host: {\r\n        '[class.ti3-searchbox-container]': 'true',\r\n        '(blur)': 'onBlur()',\r\n        '(focus)': 'onFocus()'\r\n    }\r\n})\r\nexport class TiSearchboxComponent extends TiAutocompleteComponent {\r\n    /**\r\n     * 10.0.4版本新增\r\n     *\r\n     * 是否删除用户搜索内容的首尾空格，不配置时不删除空格\r\n     */\r\n    @Input() trimmed: boolean = false;\r\n    /**\r\n     * search事件，当选中下拉选项/按enter键/点击搜索图标时触发\r\n     *\r\n     * 参数：搜索框文本\r\n     */\r\n    @Output() readonly search: EventEmitter<string> = new EventEmitter<string>();\r\n\r\n    @ContentChild('item', {static: true}) itemTemplate: TemplateRef<any>;\r\n\r\n    /**\r\n     * @ignore\r\n     * input ngModel绑定值\r\n     */\r\n    public inputValue: string;\r\n\r\n    ngOnInit(): void {\r\n        // 默认有清除图标且不可配置\r\n        // 此处先赋值后继承，是由于父类中初始化需要读取clearable的值，设置清除图标\r\n        this.clearable = true;\r\n        super.ngOnInit();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 组件model更改时，更新input绑定值\r\n     */\r\n    writeValue(model: string) {\r\n        super.writeValue(model);\r\n        this.inputValue = model;\r\n    }\r\n\r\n    // 组件交互方法集合--start\r\n\r\n    /**\r\n     * @ignore\r\n     * enter的触发有两种情况：\r\n     * 1.在input框中输入值，然后按下enter，此时正常执行search\r\n     * 2.在suggestion面板展开的情况下，通过hover选中一项，然后按下enter，\r\n     *   此时的search应该在下拉面板的onDroplistChange回调中触发\r\n     */\r\n    public onInputEnter(): void {\r\n        if (!this.isSearchWithHoverOption()) { // 排除第2中情况\r\n            this.onSearch();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 搜索事件触发\r\n     */\r\n    public onSearch(): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        this.search.emit(this.model);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 两种情况下触发\r\n     * 1.在suggestion面板展开的情况下，通过hover选中一项，然后按下enter\r\n     * 2.在suggestion面板展开的情况下，通过鼠标点击选中一项\r\n     */\r\n    onDroplistChange(value: { label: string }): void {\r\n        if (value) {\r\n            this.model = this.inputValue = value[this.labelKey] || value.label;\r\n            this.onSearch();\r\n        }\r\n    }\r\n    // 组件交互方法集合--end\r\n\r\n    private isSearchWithHoverOption(): boolean {\r\n        // suggestion面板展开且存在hover选中项的情况\r\n        return this.dropListComp.isShow && this.dropListComp.listCom.hoverOption;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 输入框中内容改变事件\r\n     */\r\n    public onInputChange(value: string): void {\r\n        if (this.disabled || !this.isFocused) {\r\n            return;\r\n        }\r\n\r\n        const searchValue: string = this.trimValue(value);\r\n        this.model = searchValue;\r\n        this.inputChangeObserve.next(searchValue);\r\n    }\r\n\r\n    /**\r\n     * 控制是否删除搜索内容的首尾空格\r\n     */\r\n    private trimValue(value: string): string {\r\n        let searchValue: string = value;\r\n        if (this.trimmed && searchValue) {\r\n            searchValue = searchValue.trim();\r\n        }\r\n\r\n        return searchValue;\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { TiSearchboxComponent } from './TiSearchboxComponent';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-searchbox-notsearch',\r\n    templateUrl: './searchbox.html',\r\n    styleUrls: ['./searchbox.less', './searchbox-notsearch.less',  '../text/text.less'],\r\n    providers: [ TiFormComponent.getValueAccessor(TiSearchboxNotsearchComponent) ],\r\n    host: {\r\n        '[class.ti3-searchbox-container]': 'true',\r\n        '(blur)': 'onBlur()',\r\n        '(focus)': 'onFocus()'\r\n    }\r\n    })\r\nexport class TiSearchboxNotsearchComponent extends TiSearchboxComponent {\r\n    onInputEnter(): void {\r\n        event.preventDefault(); // 不做搜索等处理\r\n    }\r\n    onSearch(): void {\r\n        event.preventDefault(); // 点击搜索图标时，阻止默认行为\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiSearchboxComponent } from './TiSearchboxComponent';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiOverflowModule } from '../../directives/overflow/TiOverflowModule';\r\nimport { TiDroplistModule } from '../droplist/TiDroplistModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiSearchboxNotsearchComponent } from './TiSearchboxNotsearchComponent';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule'\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiOverflowModule,\r\n    TiDroplistModule,\r\n    TiIconModule,\r\n    TiTextModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiSearchboxComponent, TiSearchboxNotsearchComponent],\r\n  declarations: [TiSearchboxComponent, TiSearchboxNotsearchComponent]\r\n})\r\nexport class TiSearchboxModule {\r\n}\r\nexport { TiSearchboxComponent } from './TiSearchboxComponent';\r\nexport { TiSearchboxNotsearchComponent } from './TiSearchboxNotsearchComponent';\r\n","import { Component, ContentChild, EventEmitter, Input, Output, SimpleChanges, TemplateRef, ViewChild } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiSearchboxNotsearchComponent } from '../searchbox/TiSearchboxModule';\r\nimport { TiKeymap, Util } from '../../utils/Util';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiDroplistComponent } from '../droplist/TiDroplistModule';\r\nimport { TiLocale } from '../../locale/TiLocaleModule';\r\n\r\n/**\r\n * @ignore\r\n * 下拉面板带有可搜索的数组组件，主要用于select，表格列设置。\r\n */\r\n@Component({\r\n    selector: 'ti-dropsearch',\r\n    templateUrl: './dropsearch.html',\r\n    styleUrls: ['./dropsearch.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiDropsearchComponent)]\r\n})\r\nexport class TiDropsearchComponent extends TiDroplistComponent {\r\n\r\n    @Input() searchable: boolean = false;\r\n    @Input() searchKeys: Array<string>; // 要搜索的字段数组, 默认是labelKey或者全部字段\r\n    @Input() selectAll: boolean = false; // 多选模式下是否有全选功能\r\n    /**\r\n     * 面板对齐方式, drop中的panelAlign接口透传出去\r\n     */\r\n    @Input() panelAlign: 'left' | 'right' = 'left';\r\n\r\n    /**\r\n     * @ignore\r\n     * dominator 到drop的距离\r\n     */\r\n    @Input() dominatorSpace: string = TiDropComponent.DOMINATOR_SPACE + 'px';\r\n\r\n    /**\r\n     * @ignore\r\n     * 10.0.2新增\r\n     *\r\n     * 后台搜索，传出搜索框的值\r\n     */\r\n    @Output() readonly beforeSearch: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n    @ViewChild(TiSearchboxNotsearchComponent) searchboxCom: TiSearchboxNotsearchComponent;\r\n    @ViewChild(TiDropComponent) dropCom: TiDropComponent;\r\n    @ContentChild('footer', { static: true }) footerTemplateRef: TemplateRef<any>;\r\n\r\n    public searchWord: string; // 搜索框内单词\r\n    public placeholder: string = TiLocale.getLocaleWords().tiSelect.search;\r\n    /**\r\n     * 搜索结果数组\r\n     */\r\n    public searchResult: Array<any> = new Array<any>();\r\n    private oldSearchable: boolean = null;\r\n    public pagination: any; // 没有指定类型是因为如果引入TiPaginationComponent会因为循环引用导致报错\r\n    public focusableElemsInSearch: Array<any> = [];\r\n    public focusableElemsInPagination: Array<any>  = [];\r\n    /**\r\n     * @ignore select的beforeSearch有没有被监听，该值为true，dropsearch的beforeSearch才是真正意义的被监听\r\n     */\r\n    public hasBeforeSearchObservers: boolean;\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // 外部修改show属性的处理，初始定义在ngOnInit中处理\r\n        if (this.searchable) {\r\n            if (changes['options'] && this.options && !changes['options'].firstChange) {\r\n                this.searchWordChange(this.searchboxCom.model);\r\n            }\r\n        }\r\n\r\n        if (changes['searchable']) {\r\n            this.heightExcludeList = changes['searchable'].currentValue ? TiDroplistComponent.SEARCHBOX_EXCLUDE_HEIGHT : 2;\r\n        }\r\n    }\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.searchResult = this.options;\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        let focusableElemsChange: boolean;\r\n        if (this.searchable !== this.oldSearchable) {\r\n            super.unlistenKendown();\r\n            if (this.searchable) {\r\n                this.focusableElemsInSearch = this.searchboxCom.getFocusableElems();\r\n                focusableElemsChange = true;\r\n                super.listenKeydown(this.searchboxCom.getFocusableElems()[0]);\r\n            } else {\r\n                this.focusableElemsInSearch = [];\r\n                super.listenKeydown(this.dominatorElem);\r\n            }\r\n            this.oldSearchable = this.searchable;\r\n        }\r\n        if (this.pagination && this.pagination.updateFocusableElems) {\r\n            this.focusableElemsInPagination = this.pagination.getFocusableElems();\r\n            focusableElemsChange = true;\r\n        }\r\n\r\n        if (focusableElemsChange) {\r\n            this.setFocusableElems(this.focusableElemsInSearch.concat(this.focusableElemsInPagination));\r\n        }\r\n    }\r\n    /**\r\n     * 覆盖父类show()\r\n     */\r\n    public show(): void {\r\n        if (this.isShow) {\r\n            return;\r\n        }\r\n        // 清空搜索框并处理下拉列表内容\r\n        if (this.searchable) {\r\n            this.searchResult = this.options;\r\n            setTimeout(() => {\r\n                super.show();\r\n                // 焦点转移至搜索框\r\n                this.searchboxCom.focus();\r\n            }, 0);\r\n        } else {\r\n            super.show();\r\n        }\r\n    }\r\n    /**\r\n     * 覆盖父类hide(), 有搜索框时焦点转移\r\n     */\r\n    public hide(): void {\r\n        if (this.isShow) {\r\n            super.hide();\r\n            if (this.searchable) {\r\n                this.dominatorElem.focus();\r\n                this.searchWord = '';\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 仅hide，不带焦点转移。\r\n     */\r\n    public hideWithoutFocus(): void {\r\n        super.hide();\r\n        this.searchWord = '';\r\n    }\r\n\r\n    public searchWordChange(searchWord: string): void {\r\n        this.beforeSearch.emit();\r\n        if (this.hasBeforeSearchObservers) {\r\n            return;\r\n        }\r\n        if (this.options && this.options.length >= 0) {\r\n            // 搜索结果临时值。结果默认值，是原数据\r\n            let searchResult: Array<any> = this.options;\r\n            // 如果搜索词存在\r\n            if (!Util.isEmptyString(searchWord)) {\r\n                // 如果是分组，则找出第二级item集合\r\n                if (this.options[0] && this.listCom.isGroup(this.options[0])) {\r\n                    searchResult = [];\r\n                    this.options.forEach((group: any) => {\r\n                        searchResult = searchResult.concat(group.children);\r\n                    });\r\n                }\r\n                // 在集合中搜索\r\n                searchResult = searchResult.filter((option: any) => {\r\n                    if (!this.searchKeys) {\r\n                        // 没有定义searchKeys时，取labelKey\r\n                        return Util.isString(option[this.labelKey]) && option[this.labelKey].toLowerCase()\r\n                            .indexOf(searchWord.toLowerCase()) >= 0;\r\n                    } else {\r\n                        //  已定义searchKeys，任一条目匹配即可\r\n                        for (const searchKey of this.searchKeys) {\r\n                            if (Util.isString(option[searchKey]) && option[searchKey].toLowerCase()\r\n                                .indexOf(searchWord.toLowerCase()) >= 0) {\r\n                                return true;\r\n                            }\r\n                        }\r\n\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            this.setSearchResult(searchResult);\r\n        }\r\n    }\r\n    /**\r\n     * 搜索后，按需重新定位、设置hoverOption\r\n     */\r\n    public setSearchResult(searchResult: Array<any>): void {\r\n        // list个数不同时，重定位下拉位置\r\n        if (this.searchResult?.length !== searchResult.length) {\r\n            setTimeout(() => {\r\n                this.rePosition(true);\r\n            }, 0);\r\n        }\r\n        this.searchResult = searchResult;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDropsearchComponent } from './TiDropsearchComponent';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiListModule } from '../list/TiListModule';\r\nimport { TiSearchboxModule } from '../searchbox/TiSearchboxModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDropModule,\r\n    TiListModule,\r\n    TiSearchboxModule\r\n  ],\r\n  exports: [TiDropsearchComponent],\r\n  declarations: [TiDropsearchComponent]\r\n})\r\nexport class TiDropsearchModule {\r\n}\r\nexport { TiDropsearchComponent } from './TiDropsearchComponent';\r\n","import {\r\n  Directive,\r\n  ElementRef,\r\n  Input,\r\n  OnChanges,\r\n  Renderer2,\r\n  SimpleChanges\r\n} from '@angular/core';\r\n\r\nimport { Util } from '../../utils/Util';\r\n\r\n/**\r\n * @ignore\r\n * 此指令功能:清空宿主元素的子元素，将传入的string或Node放入(append)\r\n *\r\n * 类似angular.js的ng-bind-html功能\r\n */\r\n@Directive({\r\n  selector: '[tiInclude]'\r\n})\r\nexport class TiIncludeDirective implements OnChanges {\r\n    @Input() tiInclude: string | Node; // 只支持string和Node两种类型\r\n    private element: HTMLElement;\r\n    constructor(private elementRef: ElementRef, private renderer: Renderer2) {\r\n        this.element = this.elementRef.nativeElement;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes['tiInclude'] && !Util.isUndefined(this.tiInclude)) {\r\n            // 清空宿主元素的子节点\r\n            if (this.element.childNodes.length > 0) {\r\n                this.element.innerHTML = '';\r\n            }\r\n            // 如果 tiInclude 为字符串，则当作文本节点处理\r\n            const node: Node = Util.isString(this.tiInclude) ?\r\n                this.renderer.createText(this.tiInclude as string) : this.tiInclude;\r\n            this.renderer.appendChild(this.element, node);\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIncludeDirective } from './TiIncludeDirective';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiIncludeDirective],\r\n  declarations: [TiIncludeDirective]\r\n})\r\nexport class TiIncludeModule {\r\n}\r\nexport { TiIncludeDirective } from './TiIncludeDirective';\r\n","import {\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  Renderer2\r\n} from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiItemComponent } from './TiItemComponent';\r\nimport { TiButtonItemComponent } from './TiButtonItemComponent';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * 本组件实现对多个表单元素的布局，支持单列和多列布局。\r\n * 其中包含了tiFormfield、tiItem、tiItemLabel和tiButtonItem几个组件。\r\n *\r\n * <example-url>../tiny3demo/#/formfield/formfield-all</example-url>\r\n */\r\n@Component({\r\n  selector: 'ti-formfield',\r\n  templateUrl: './formfield.html',\r\n  styleUrls: ['./formfield.less']\r\n})\r\nexport class TiFormfieldComponent extends TiBaseComponent {\r\n    /**\r\n     * 默认两列的间距\r\n     */\r\n    private static readonly COLS_GAP: string = '70px';\r\n    /**\r\n     * 设置表单类型，不设置时默认为带输入控件类表单;当为 text 时，为纯文本描述类表单\r\n     *\r\n     * 带输入控件类表单：各个表单条目的内容区主要为输入框、下拉框、按钮组等输入组件；\r\n     *\r\n     * 纯文本描述类表单：各个表单条目的内容区为纯文本。\r\n     */\r\n    @Input() type: 'default' | 'text' = 'default';\r\n    /**\r\n     * 设置表单的标题\r\n     */\r\n    @Input() title: string;\r\n    /**\r\n     * 统一设置表单条目的 label 所占宽度。例如：\"100px\"\r\n     */\r\n    @Input() labelWidth: string;\r\n    /**\r\n     * 设置表单布局的列数\r\n     */\r\n    @Input() colsNumber: number = 1;\r\n    /**\r\n     * 设置列与列之间的间隔，只有多列（colsNumber >= 2）时该属性配置才生效。\r\n     */\r\n    @Input() colsGap: Array<string> = [];\r\n    /**\r\n     * 统一设置表单条目的垂直对齐方式（上下布局表单不支持该属性）。\r\n     */\r\n    @Input() verticalAlign: 'top' | 'middle' | 'bottom' = 'top';\r\n    /**\r\n     * 统一设置纯文本描述类表单的每个表单条目的行高。\r\n     *\r\n     * 纯文本描述类表单不设置时，行高默认为40px；设置值时，例如：'30px',则的行高为30px。\r\n     *\r\n     * 目前纯文本描述类表单有三种应用场景：表格下展表单，行高值40px（默认）；购买页配置信息汇总，行高30PX；订单详情确认，行高22px。\r\n     */\r\n    @Input() textLineHeight: string;\r\n    /**\r\n     * 设置各列宽度（IE不支持，行合并列合并暂不支持）\r\n     *\r\n     * 设置该接口后，colsGap第一个值表示各列间距\r\n     *\r\n     * 10.1.1 新增\r\n     */\r\n    @Input() colsWidth: Array<string> = [];\r\n\r\n    /**\r\n     * @ignore\r\n     * 纯文本描述类表单的type的值\r\n     */\r\n    public readonly textType: string = 'text';\r\n    /**\r\n     * @ignore\r\n     * ti-formfield中包含的所有ti-item的集合\r\n     */\r\n    public items: Array<TiItemComponent> = [];\r\n    /**\r\n     * @ignore\r\n     * ti-formfield中包含的所有ti-btn-item的集合\r\n     */\r\n    public btnItems: Array<TiButtonItemComponent> = [];\r\n    /**\r\n     * @ignore\r\n     * 根据colsNum对 items 分组后的数据\r\n     */\r\n    public groupedItems: Array<any> = [];\r\n    /**\r\n     * @ignore\r\n     * 表单的列数\r\n     */\r\n    public colsNum: number = 1;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public containterObj: { 'vertical-align': string, 'grid-template-columns'?: string, 'grid-column-gap'?: string };\r\n    /**\r\n     * @ignore\r\n     * 当前formfield下ti-item的总个数\r\n     */\r\n    public itemTotal: number = 0;\r\n    /**\r\n     * @ignore\r\n     * 表单是否为上下布局\r\n     */\r\n    public isVertical: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * button样式\r\n     */\r\n    public buttonStyle: { 'margin-left'?: string; };\r\n    /**\r\n     * @ignore\r\n     * 表单是否使用grid布局\r\n     */\r\n    public useGrid: boolean;\r\n    constructor(\r\n        protected hostRef: ElementRef,\r\n        protected renderer: Renderer2,\r\n        private changeDetector: ChangeDetectorRef\r\n    ) {\r\n        super(hostRef, renderer);\r\n    }\r\n\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.isVertical = this.nativeElement.hasAttribute('vertical');\r\n        this.setColsNumber();\r\n        // 统一设置表单内容的垂直对齐方式;\r\n        // tbody、tr、td的verticalAlign继承于此(table),所以此处可以\r\n        // 统一设置表单内容的垂直对齐方式\r\n        this.setFieldStyle();\r\n    }\r\n\r\n    private setColsNumber(): void {\r\n        if (this.colsNumber) {\r\n            // tslint:disable-next-line:prefer-template\r\n            const colsNumber: number = parseInt(String(this.colsNumber), 10);\r\n            if (!Number.isNaN(colsNumber) && colsNumber >= 1) {\r\n                this.colsNum = colsNumber;\r\n            }\r\n        }\r\n    }\r\n\r\n    private setFieldStyle(): void {\r\n        if (!Util.isEmptyString(this.verticalAlign)) {\r\n            this.containterObj = { 'vertical-align': this.verticalAlign };\r\n        }\r\n\r\n        // 设置width接口时，配置grid，IE下不支持grid布局，存在兼容性问题\r\n        const isSupportGrid: boolean = (typeof window !== 'undefined') && (window as any).CSS && (window as any).CSS.supports && (window as any).CSS.supports('(display: grid)');\r\n        this.useGrid = this.colsWidth && this.colsWidth.length > 0 && isSupportGrid;\r\n\r\n        if (this.useGrid) {\r\n            this.labelWidth = this.labelWidth ? this.labelWidth : '80px'; // 给定宽度，确保content对齐；\r\n            for (let i = 0; i < this.colsWidth.length; i++) {\r\n                // 各列设置百分比且设置列间距时，需要重新计算各列宽度，设置宽度-各列间距总和\r\n                const calcWidth: string = `calc( ${this.colsWidth[i]} - ${parseFloat(this.colsGap[0]) * (this.colsWidth.length - 1) / this.colsWidth.length}px)`;\r\n                this.colsWidth[i] = /%$/.test(this.colsWidth[i]) && this.colsGap[0] ? calcWidth : this.colsWidth[i];\r\n            }\r\n            this.containterObj['grid-template-columns'] = `${this.colsWidth.join(' ')}`;\r\n            this.containterObj['grid-column-gap'] = this.colsGap[0]; // 列间距 grid-column-gap属性只支持一个值，取首项作为列间距\r\n            this.buttonStyle = this.isVertical ? {} : { 'margin-left': `calc(${this.labelWidth} + 20px)` }; // 20px padding\r\n\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 需要在TiItemComponent.ts中调用\r\n     */\r\n    public addCntItem(item: TiItemComponent): void {\r\n        this.items.push(item);\r\n        this.items.sort((a: TiItemComponent, b: TiItemComponent) => {\r\n            return a.itemIndex - b.itemIndex;\r\n        });\r\n        this.groupedItems = this.chunkArray(this.items, this.colsNum);\r\n        // 强制变检一次，消除报错(Expression has changed after it was checked)\r\n        this.changeDetector.detectChanges();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 需要在 TiItemComponent.ts 中调用\r\n     */\r\n    public removeCntItem(item: TiItemComponent): void {\r\n        const itemIndex: number = this.items.indexOf(item);\r\n        if (itemIndex !== -1) {\r\n            this.items.splice(itemIndex, 1);\r\n            this.groupedItems = this.chunkArray(this.items, this.colsNum);\r\n            // 强制变检一次，消除报错(Expression has changed after it was checked)\r\n            // ti-item和ti-formfiled组件都销毁时，视图也已销毁，不需要再强制变检;\r\n            // 因此，强制变检需要在一定的条件下执行，消除服务报错（Attempt to use a destroyed view: detectChanges）\r\n            if (!this.changeDetector['destroyed']) {\r\n                this.changeDetector.detectChanges();\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 需要在 TiButtonItemComponent.ts 中调用\r\n     */\r\n    public addBtnItem(item: TiButtonItemComponent): void {\r\n        this.btnItems.push(item);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 需要在 TiButtonItemComponent.ts 中调用\r\n     */\r\n    public removeBtnItem(item: TiButtonItemComponent): void {\r\n        const itemIndex: number = this.btnItems.indexOf(item);\r\n        if (itemIndex !== -1) {\r\n            this.btnItems.splice(itemIndex, 1);\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line:prefer-function-over-method\r\n    private chunkArray(array: Array<TiItemComponent>, size: number): Array<any> {\r\n        const length: number = array ? array.length : 0;\r\n        if (!length || size < 1) {\r\n            return [];\r\n        }\r\n\r\n        const result: Array<Array<TiItemComponent>> = [];\r\n        // 单列\r\n        if (size === 1) {\r\n            array.forEach((item: TiItemComponent) => {\r\n                result.push([item]);\r\n            });\r\n        // 多列\r\n        } else {\r\n            const rowspanNums: Array<number> = new Array(size); // 记录每一列的行合并的信息\r\n            let onegroup: Array<TiItemComponent> = [];\r\n            let colIndex: number = 0;\r\n            array.forEach((item: TiItemComponent, index: number) => {\r\n                while (rowspanNums[colIndex] > 0) {\r\n                    rowspanNums[colIndex] = rowspanNums[colIndex] - 1;\r\n                    colIndex++;\r\n                    if (colIndex === size) {\r\n                        result.push(onegroup);\r\n                        onegroup = [];\r\n                        colIndex = 0;\r\n                    }\r\n                }\r\n\r\n                onegroup.push(item);\r\n                // 如果该单元是行合并，则影响后续行\r\n                if (item.rowspan > 1) {\r\n                    rowspanNums[colIndex] = item.rowspan - 1;\r\n                }\r\n                // 如果该单元是列合并，则影响当前行\r\n                if (item.colspan > 1) {\r\n                    colIndex += (item.colspan - 1);\r\n                }\r\n\r\n                // 设置列间距\r\n                if (colIndex < size - 1) {\r\n                    // 设置宽度时，为使IE下有良好的呈现，取首项作为各列间距\r\n                    item.gapWidth = this.colsWidth && this.colsWidth.length > 0 && this.colsGap[0] ? this.colsGap[0] : (this.colsGap[colIndex] || TiFormfieldComponent.COLS_GAP);\r\n                }\r\n\r\n                colIndex++;\r\n\r\n                if (colIndex === size || index === array.length - 1) {\r\n                    result.push(onegroup);\r\n                    onegroup = [];\r\n                    colIndex = 0;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 需要在html模板中使用\r\n     */\r\n    public trackByFn(index: number, item: TiItemComponent): number {\r\n        return item.itemIndex;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 每项图标是否占位，设置按钮及content样式\r\n     */\r\n    public getRequire(item: TiItemComponent, index: number): boolean {\r\n        let hasRequire: boolean;\r\n\r\n        for (let i = 0; i < this.groupedItems.length; i++) {\r\n            const groupedItem: TiItemComponent = this.groupedItems[i];\r\n            if (groupedItem[index % this.colsNum] && groupedItem[index % this.colsNum].required) {\r\n                 hasRequire = true;\r\n            }\r\n        }\r\n\r\n        if (index === 0 && hasRequire) {\r\n            this.buttonStyle = { 'margin-left': `calc(${this.labelWidth} + 36px)` }; // 20 padding + 16 图标\r\n        }\r\n\r\n        if (hasRequire) {\r\n            item.contentStyle['width'] = item.hasLabel ? `calc(100% - ${this.labelWidth} - 36px)` : `calc(100% - 16px)`;\r\n        } else {\r\n            // TiItemComponent 初始化时，ti-item-label指令无法获取到label，导致宽度设置不正确，因此在此处设置宽度\r\n            item.contentStyle['width'] = item.hasLabel ? `calc(100% - ${this.labelWidth} - 20px)` : '100%' ;\r\n        }\r\n\r\n        return hasRequire;\r\n    }\r\n}\r\n","import {\r\n    ChangeDetectorRef,\r\n    Component,\r\n    ElementRef,\r\n    Input,\r\n    OnChanges,\r\n    OnDestroy,\r\n    OnInit,\r\n    SimpleChange,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiFormfieldComponent } from './TiFormfieldComponent';\r\nimport { Util } from '../../utils/Util';\r\n\r\n/**\r\n * 本组件嵌在 tiFormfield 中使用，包裹着单个表单条目的所有内容\r\n */\r\n@Component({\r\n    selector: 'ti-item',\r\n    templateUrl: './formfield-item.html'\r\n})\r\nexport class TiItemComponent implements OnInit, OnChanges, OnDestroy {\r\n    /**\r\n     * 设置当前表单条目是否是必填，如果是必填，则前面会显示 *\r\n     */\r\n    @Input() required: boolean = false;\r\n    /**\r\n     * 设置当前表单条目的垂直对齐方式，默认为top（上下布局表单不支持该属性）。\r\n     *\r\n     * 能够覆盖tiFormfield指令上的verticalAlign设置\r\n     */\r\n    @Input() verticalAlign: 'top' | 'middle' | 'bottom';\r\n    /**\r\n     * 设置当前表单条目是否显示\r\n     *\r\n     * tiItem 不支持 ngIf 和 hidden，由该接口来控制单个表单条目的显示与否\r\n     */\r\n    @Input() show: boolean = true;\r\n    /**\r\n     * 行合并，设置当前表单条目可横跨的行数\r\n     */\r\n    @Input() rowspan: number = 1;\r\n    /**\r\n     * 列合并，设置当前表单条目可横跨的列数\r\n     */\r\n    @Input() colspan: number = 1;\r\n    /**\r\n     * 在 ti-formfield 中的展示顺序，数值越大越靠后展示；\r\n     *\r\n     * 要使用该接口时，当前ti-formfield中的所以ti-item都要设置该接口；\r\n     *\r\n     * 不设置时按 ti-item 的解析顺序展示\r\n     *\r\n     * 10.0.1新增\r\n     */\r\n    @Input() index: number;\r\n    /**\r\n     * @ignore\r\n     * tiItem的索引值，用于控制其显示时的位置顺序\r\n     */\r\n    public itemIndex: number;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public verticalAlignObj: { 'vertical-align'?: string };\r\n    /**\r\n     * @ignore\r\n     */\r\n    public itemStyle: { 'grid-area'?: string };\r\n    /**\r\n     * @ignore\r\n     */\r\n    public labelStyle: { 'vertical-align'?: string, width?: string, 'line-height'?: string };\r\n    /**\r\n     * @ignore\r\n     */\r\n    public contentStyle: { 'vertical-align'?: string, 'line-height'?: string, 'width'?: string };\r\n    /**\r\n     * @ignore\r\n     */\r\n    public element: HTMLElement;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public itemLabel: string | Node;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public hasLabel: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public gapWidth: string = '0px';\r\n    constructor(private formfield: TiFormfieldComponent, private elementRef: ElementRef,\r\n                private changeDetector: ChangeDetectorRef) {}\r\n\r\n    // 有两处改变label\r\n    // 1. label接口传入的值\r\n    // 2. 在ti-item-label组件中修改label的值\r\n    /**\r\n     * 设置当前表单条目的label文本，支持简单字符串文本，如果开发者希望基于html定制文本，\r\n     * 建议使用[TiItemLabelComponent]{@link ./TiItemLabelComponent.html}组件\r\n     *\r\n     * 类型：string | Node\r\n     */\r\n    @Input()\r\n    set label(labelParm: string | Node) {\r\n        this.setItemLabel(labelParm);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.formfield.itemTotal++;\r\n        this.decorateItem();\r\n        if (this.show) {\r\n            this.formfield.addCntItem(this);\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        const showObj: SimpleChange = changes['show'];\r\n        if (showObj && !showObj.firstChange) {\r\n            if (showObj.currentValue) {\r\n                this.formfield.addCntItem(this);\r\n            } else {\r\n                this.formfield.removeCntItem(this);\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        // 在外部将ti-iem销毁时，应将此item从items数组中去掉\r\n        this.formfield.removeCntItem(this);\r\n        this.changeDetector.detach();\r\n    }\r\n\r\n    private decorateItem(): void {\r\n        this.itemIndex = Util.isNumber(this.index) ? this.index : this.formfield.itemTotal - 1;\r\n        this.element = this.elementRef.nativeElement;\r\n        this.verticalAlignObj = Util.isUndefined(this.verticalAlign) ?\r\n            {} : { 'vertical-align': this.verticalAlign };\r\n\r\n        // item-label的自定义的样式（垂直对齐方式、宽度）\r\n        this.labelStyle = {\r\n            'vertical-align': this.verticalAlign,\r\n            width: this.formfield.labelWidth\r\n        };\r\n\r\n        // item-content的自定义的样式（垂直对齐方式）\r\n        this.contentStyle = {\r\n            'vertical-align': this.verticalAlign\r\n        };\r\n        // 为纯文本描述类表单时，可设置 item 的行高\r\n        if (this.formfield.type === this.formfield.textType) {\r\n            this.labelStyle['line-height'] = this.formfield.textLineHeight;\r\n            this.contentStyle['line-height'] = this.formfield.textLineHeight;\r\n        }\r\n\r\n        // item 自定义行列合并样式\r\n        if (this.formfield.useGrid) {\r\n            this.itemStyle = { 'grid-area': `span ${this.rowspan} / span ${this.colspan}` };\r\n        }\r\n    }\r\n\r\n    private setItemLabel(label: string | Node): void {\r\n        if (label) {\r\n            this.hasLabel = true;\r\n            this.itemLabel = label;\r\n        } else {\r\n            this.hasLabel = false;\r\n        }\r\n        this.changeDetector.detectChanges();\r\n    }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  Component,\r\n  ElementRef\r\n} from '@angular/core';\r\nimport { TiItemComponent } from './TiItemComponent';\r\n/**\r\n * 本组件嵌在 tiItem 中使用，包裹着单个表单条目中 label显示的dom片段\r\n */\r\n@Component({\r\n  selector: 'ti-item-label',\r\n  templateUrl: './formfield-item-label.html'\r\n})\r\nexport class TiItemLabelComponent implements AfterContentInit {\r\n    constructor(private item: TiItemComponent, private elementRef: ElementRef) {}\r\n\r\n    ngAfterContentInit(): void {\r\n      // ti-item 封装在自定义组件里时，使用ti-item-label，开发环境报错ExpressionChangedAfterItHasBeenCheckedError\r\n      Promise.resolve().then(() => {\r\n        this.item.label = this.elementRef.nativeElement;\r\n      });\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChange,\r\n  SimpleChanges\r\n} from '@angular/core';\r\nimport { TiFormfieldComponent } from './TiFormfieldComponent';\r\n\r\n/**\r\n * 本组件嵌在 tiFormfield 中使用，包裹着表单按钮\r\n */\r\n@Component({\r\n  selector: 'ti-button-item',\r\n  templateUrl: './formfield-btn-item.html'\r\n})\r\nexport class TiButtonItemComponent implements OnInit, OnChanges, OnDestroy {\r\n    /**\r\n     * 每一个ti-item占4个td。第一个td用来显示“*”，第二个td用来显示label，\r\n     * 第三个td用来显示content, 第四个td是item间距。\r\n     */\r\n    private static readonly TD_NUM_PER_ITEM: number = 4;\r\n    /**\r\n     * 设置表单按钮是否显示\r\n     *\r\n     * tiButtonItem 不支持 ngIf 和 hidden，由该接口来控制表单按钮的显示与否\r\n     */\r\n    @Input() show: boolean = true;\r\n    /**\r\n     * 设置表单按钮的垂直对齐方式，默认为top（上下布局表单不支持该属性）。\r\n     *\r\n     * 能够覆盖tiFormfield指令上的verticalAlign设置\r\n     */\r\n    @Input() verticalAlign: 'top' | 'middle' | 'bottom';\r\n    /**\r\n     * @ignore\r\n     */\r\n    public verticalAlignObj: { 'vertical-align'?: string } = {};\r\n    /**\r\n     * @ignore\r\n     */\r\n    public btnContent: Node;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public btnColspan: number;\r\n    constructor(private formfield: TiFormfieldComponent, private elementRef: ElementRef) {}\r\n\r\n    ngOnInit(): void {\r\n        this.btnContent = this.elementRef.nativeElement;\r\n        this.btnColspan = (this.formfield.colsNum - 1) * TiButtonItemComponent.TD_NUM_PER_ITEM + 2;\r\n        if (this.verticalAlign) {\r\n            this.verticalAlignObj['vertical-align'] = this.verticalAlign;\r\n        }\r\n\r\n        if (this.show) {\r\n            this.formfield.addBtnItem(this);\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        const showObj: SimpleChange = changes['show'];\r\n\r\n        if (showObj && !showObj.firstChange) {\r\n            if (showObj.currentValue) {\r\n                this.formfield.addBtnItem(this);\r\n            } else {\r\n                this.formfield.removeBtnItem(this);\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.formfield.removeBtnItem(this);\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIncludeModule } from '../../directives/include/TiIncludeModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiFormfieldComponent } from './TiFormfieldComponent';\r\nimport { TiItemComponent } from './TiItemComponent';\r\nimport { TiItemLabelComponent } from './TiItemLabelComponent';\r\nimport { TiButtonItemComponent } from './TiButtonItemComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiIncludeModule\r\n  ],\r\n  exports: [TiFormfieldComponent,\r\n            TiItemComponent,\r\n            TiItemLabelComponent,\r\n            TiButtonItemComponent],\r\n  declarations: [TiFormfieldComponent,\r\n                 TiItemComponent,\r\n                 TiItemLabelComponent,\r\n                 TiButtonItemComponent]\r\n})\r\nexport class TiFormfieldModule {\r\n}\r\nexport { TiFormfieldComponent } from './TiFormfieldComponent';\r\nexport { TiItemComponent } from './TiItemComponent';\r\nexport { TiItemLabelComponent } from './TiItemLabelComponent';\r\nexport { TiButtonItemComponent } from './TiButtonItemComponent';\r\n","import { AfterViewInit, Component, ElementRef, Input, Renderer2, ViewChild } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n// 文件预览信息接口\r\n// 10.0.2版本新增\r\nexport interface TiFilePreviewInfo {\r\n    /**\r\n     * 文件名称\r\n     */\r\n    name?: string;\r\n\r\n    /**\r\n     * 预览地址\r\n     */\r\n    previewUrl?: string;\r\n\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n\r\n/**\r\n * @ignore\r\n *\r\n * 10.0.2版本新增组件\r\n *\r\n * 该组件主要用于图片放大预览\r\n *\r\n * <example-url>../tiny3demo/#/imagepreview/imagepreview-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-imagepreview',\r\n    templateUrl: './imagepreview.html',\r\n    styleUrls: ['./imagepreview.less']\r\n})\r\nexport class TiImagepreviewComponent extends TiBaseComponent implements AfterViewInit {\r\n\r\n    /**\r\n     * 需要预览的文件列表\r\n     */\r\n    @Input() fileList: Array<TiFilePreviewInfo> = [];\r\n\r\n    /**\r\n     * 是否展示文件名称，默认展示\r\n     */\r\n    @Input() showFileName: boolean = true;\r\n\r\n    /**\r\n     * 默认展示的图片的索引\r\n     */\r\n    @Input() index: number = 0;\r\n\r\n    /**\r\n     * @ignore 内部变量\r\n     */\r\n    @ViewChild('imgTemplate', {static: true}) imgTemplate: ElementRef;\r\n    /**\r\n     * @ignore 内部变量\r\n     */\r\n    @ViewChild('switchBtn', {static: true}) switchBtnTemplate: ElementRef;\r\n\r\n    constructor(public sanitizer: DomSanitizer,protected renderer: Renderer2, private elementRef: ElementRef) {\r\n            super(elementRef, renderer);\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        this.addImgLoadListener();\r\n    }\r\n\r\n    /**\r\n     * @ignore 翻到上一张图片\r\n     */\r\n    public toNext(): void {\r\n        if (this.index === (this.fileList.length - 1)) {\r\n            return;\r\n        }\r\n        this.addImgLoadListener();\r\n        this.index++;\r\n    }\r\n\r\n    /**\r\n     * @ignore 翻到下一张图片\r\n     */\r\n    public toPrevious(): void {\r\n        if (this.index === 0) {\r\n            return;\r\n        }\r\n        this.addImgLoadListener();\r\n        this.index--;\r\n    }\r\n\r\n    // 由于图片高度不确定，需动态设置top值，所以增加load事件。\r\n    private addImgLoadListener(): void {\r\n        this.imgTemplate.nativeElement.onload = (): void => {\r\n            const imgHeight: number = this.imgTemplate.nativeElement.height;\r\n            if (imgHeight !== 0) {\r\n                const top: number = (imgHeight - 48) / 2;\r\n                this.renderer.setStyle(this.switchBtnTemplate.nativeElement, 'top', top + 'px');\r\n            }\r\n            // 防止循环触发load事件\r\n            // tslint:disable-next-line: no-null-keyword\r\n            this.imgTemplate.nativeElement.onload = null;\r\n        };\r\n    }\r\n}\r\n","import {\r\n    AfterContentInit, Component, ElementRef,\r\n    HostListener, Renderer2, ViewChild, ViewEncapsulation, Inject\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { animate, state, style, transition, trigger } from '@angular/animations';\r\nimport { TiKeymap, Util } from '../../utils/Util';\r\nimport { TiRenderer } from '../renderer/TiRenderer';\r\nimport { TiBaseComponent } from '../../components/base/TiBaseModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport const animateStyle: string = '0.3s cubic-bezier(0.40, 0.00, 0.20, 1.00)';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-modal-wrapper',\r\n    templateUrl: './TiModalComponent.html',\r\n    styleUrls: ['./modal.less'],\r\n    encapsulation: ViewEncapsulation.None,\r\n    animations: [ // 由于动画创建需要在元数据中解析，因此动画定义必须在此处定义\r\n        trigger('modalAnimate', [\r\n            state('show', style({\r\n                opacity : 1\r\n            })),\r\n            state('hide, void', style({\r\n                opacity: 0\r\n            })),\r\n            transition('show => hide', animate(animateStyle)),\r\n            transition('hide => show', animate(animateStyle))\r\n        ]),\r\n        trigger('modalPosAnimate', [\r\n            state('show', style({\r\n                transform: 'translate(0, 0px)'\r\n            })),\r\n            state('hide, void', style({\r\n                transform: 'translate(0, -6px)'\r\n            })),\r\n            transition('show => hide', animate(animateStyle)),\r\n            transition('hide => show', animate(animateStyle))\r\n        ])\r\n    ]\r\n})\r\nexport class TiModalComponent extends TiBaseComponent implements AfterContentInit {\r\n    /**\r\n     * 10.1.1新增\r\n     * 规范刷新，弹窗整体的最大高度为660px（按照最小分辨率1280*768计算）\r\n     */\r\n    private static readonly MODAL_MAX_HEIGHT: number = 660;\r\n    // 可通过tab聚焦的元素选择器列表\r\n    private static readonly tababbleSelector: string = `a[href], area[href], input:not([disabled]):not([tabindex=\\'-1\\']),\r\n       button:not([disabled]):not([tabindex=\\'-1\\']),select:not([disabled]):not([tabindex=\\'-1\\']),\r\n       textarea:not([disabled]):not([tabindex=\\'-1\\']),\r\n       iframe, object, embed, *[tabindex]:not([tabindex=\\'-1\\']), *[contenteditable=true]`;\r\n\r\n    @ViewChild('modalContent', { static: true }) private contentRef: ElementRef;\r\n    @ViewChild('modalEle', { static: true }) protected modalEleRef: ElementRef;\r\n\r\n    protected _showState: string; // 组件显示状态，用于控制动画的状态切换\r\n    set showState(value: string) {\r\n        this._showState = value;\r\n    }\r\n    get showState(): string {\r\n        return this._showState;\r\n    }\r\n    public animation: boolean;  // 是否有动画\r\n    public draggable: boolean;  // 是否可拖拽\r\n    public closeOnEsc: boolean; // 是否可通过ESC键关闭弹框\r\n    public modalInstance: any; // 组件实例，可使用该实例调用方法控制组件行为\r\n    public index: number = 0; // 多个弹出框情况下，zindex层级设置辅助\r\n    public closeIcon: boolean; // 是否有头部关闭按钮\r\n    public modalClass: string; // 弹框样式设置\r\n    public headerAlign: 'center' | 'left' | 'right'; // 头部对齐方式\r\n    public dragOptions: any; // 拖拽配置\r\n    private focusableElements: Array<any> = []; // 弹框中可聚焦元素列表\r\n    constructor(ele: ElementRef, private tiRenderer: TiRenderer, protected renderer: Renderer2, @Inject(DOCUMENT) private document) {\r\n        super(ele, renderer);\r\n    }\r\n\r\n    private static preventEvent(event: Event): void {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    }\r\n    // 路由切换后，modal还会存在，因此此处做了事件处理\r\n    @HostListener('window:hashchange') onhashchange(): void {\r\n        this.modalInstance._remove();\r\n    }\r\n    // 缩放时重置弹框位置\r\n    @HostListener('window:resize') onResize(): void {\r\n        this.tiRenderer.setStyles(this.contentRef.nativeElement, {\r\n            left: 0,\r\n            top: 0\r\n        });\r\n    }\r\n    // 键盘事件处理\r\n    @HostListener('document:keydown', ['$event']) onKeydown(event: KeyboardEvent): void {\r\n        switch (event.which) {\r\n            case TiKeymap.KEY_ESCAPE:  // close on ESC\r\n                if (this.closeOnEsc) {\r\n                    this.dismissModal();\r\n                }\r\n                break;\r\n            case TiKeymap.KEY_TAB: // tab键用于处理在弹框内循环获取焦点\r\n                this.onTabChange(event);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    // 弹窗外围出现的滚动条滚动会导致下拉等定位在body上的组件相对于宿主元素定位偏移，\r\n    // 因此触发tiScroll事件做处理，事件包括：\r\n    // 整个页面滚动条滚轮滚动事件, mousewheel处理Chrome和IE下事件，DOMMouseScroll处理firefox下事件\r\n    // 整个页面滚动条鼠标滚动事件\r\n    @HostListener('document:mousewheel') @HostListener('document:DOMMouseScroll') @HostListener('window:scroll') onTiScroll(): void {\r\n        Util.trigger(document, 'tiScroll');\r\n    }\r\n\r\n    ngAfterContentInit(): void {\r\n        this.dragOptions = {// 由于此处需要获取ngContent中的内容,因此在该时机中进行处理\r\n            // 这时弹窗内容DOM还未解析，所以需要使用标签选择器('ti-modal-header')来获取元素\r\n            handle: this.nativeElement.querySelector('ti-modal-header'),\r\n            drag: (opts: {\r\n                position: {\r\n                    left: number\r\n                    top: number\r\n                },\r\n                helper: Element\r\n            }): { left: number, top: number\r\n            } => {\r\n                Util.trigger(document, 'tiScroll');\r\n                // 当前浏览器可视区域的宽高\r\n                const curBrowseWidth: number = document.documentElement.clientWidth;\r\n                const curBrowseheight: number = document.documentElement.clientHeight;\r\n                // 元素原始位置（由于元素本身left和top实时变化，因此取其父元素位置）\r\n                const eleRect: ClientRect | DOMRect = opts.helper.parentElement.getBoundingClientRect();\r\n                // 元素距页面可视区域的可用位置范围\r\n                const minLeft: number = - eleRect.left + document.body.scrollLeft;\r\n                const maxLeft: number = Math.max(curBrowseWidth + minLeft - eleRect.width, minLeft);\r\n                const minTop: number = -eleRect.top + document.body.scrollTop;\r\n                const maxTop: number = Math.max(curBrowseheight + minTop - eleRect.height, minTop);\r\n                const position: { left: number, top: number} = opts.position;\r\n                // 元素left位置根据可用left范围计算\r\n                if (position.left < minLeft) {\r\n                    position.left = minLeft;\r\n                } else if (position.left > maxLeft) {\r\n                    position.left = maxLeft;\r\n                }\r\n                // 元素top位置根据可用top范围计算\r\n                if (position.top < minTop) {\r\n                    position.top = minTop;\r\n                } else if (position.top > maxTop) {\r\n                    position.top = maxTop;\r\n                }\r\n\r\n                return position;\r\n            }\r\n        };\r\n    }\r\n    public dismissModal(): void {\r\n        this.modalInstance.dismiss();\r\n    }\r\n\r\n    public onAnimationDone($event: any): void {\r\n        // 弹框toState有三种状态:'show'/'hide'/null\r\n        // 弹框显示动画结束后,重新将焦点聚焦在弹框元素/弹框中\r\n        if ($event.toState === 'show') {\r\n            this.reStyleModal();\r\n            this.focusInModal();\r\n\r\n            return;\r\n        }\r\n        // 弹框隐藏动画结束后,销毁弹框DOM\r\n        if ($event.toState === 'hide') {\r\n            this.modalInstance._remove();\r\n        }\r\n    }\r\n\r\n    // 弹框打开时，设置弹框元素样式\r\n    private reStyleModal(): void {\r\n        const parentEle: Element = this.nativeElement.querySelector('.ti3-modal-header');\r\n        if (this.draggable !== false) {\r\n            this.renderer.setStyle(parentEle, 'cursor', 'move');\r\n        }\r\n        if (this.headerAlign === 'center' || this.headerAlign === 'right') {\r\n            this.renderer.setStyle(parentEle, 'text-align', this.headerAlign);\r\n        }\r\n\r\n        this.renderer.addClass(this.document.body, 'ti3-modal-open');\r\n        this.setMaxHeight();\r\n    }\r\n    /**\r\n     * 设置弹框高度：\r\n     * 根据UCD3.0规范，modal最大高度不能超过弹框宽度,所以需要获取到modal的宽度值，用其减去modal的header和footer的高度\r\n     * 后设为body的最大高度，当高度超出时，ti-modal-body垂直方向上出现滚动条\r\n     * 10.1.1变更说明：\r\n     * 根据规范变更，弹框高度可以超过弹框宽度，同时弹窗的最大高度是660px。\r\n     */\r\n    private setMaxHeight(): void {\r\n        // 修复SSR问题：ERROR TypeError: modalHeaderEle.getBoundingClientRect is not a function\r\n        const modalHeaderEle: Element = this.nativeElement.querySelector('.ti3-modal-header');\r\n        const modalHeaderHeight: number = modalHeaderEle && (typeof modalHeaderEle.getBoundingClientRect === 'function') ? modalHeaderEle.getBoundingClientRect().height : 0;\r\n        const modalFooterEle: Element = this.nativeElement.querySelector('.ti3-modal-footer');\r\n        const modalFooterHeight: number = modalFooterEle && (typeof modalFooterEle.getBoundingClientRect === 'function') ? modalFooterEle.getBoundingClientRect().height : 0;\r\n        const modalBodyMaxHeight: number = TiModalComponent.MODAL_MAX_HEIGHT - modalHeaderHeight - modalFooterHeight;\r\n        this.renderer.setStyle(this.nativeElement.querySelector('.ti3-modal-body'), 'maxHeight', modalBodyMaxHeight + 'px');\r\n    }\r\n    private focusInModal(): void {\r\n        /**\r\n         * 首先判断新打开的modal是否已存在获取焦点的元素\r\n         * 如果存在，则需要对modal元素再次设置焦点\r\n         * 否则，对modal容器设置焦点\r\n         */\r\n        const activeElement: any = this.document.activeElement;\r\n        const isfocusedInModal: boolean = activeElement && this.nativeElement.contains(activeElement);\r\n        if (isfocusedInModal) {\r\n            /**\r\n             * 对已经设置焦点的元素，再次设置焦点，是为了解决以下两个问题：\r\n             * 1>首次加载时，已经获取焦点的元素，其输入tip提示位置偏移\r\n             * 2>首次加载时，IE浏览器中，已经获取焦点的元素input，光标位置出现偏移\r\n             */\r\n            if (activeElement) {\r\n                activeElement.blur();\r\n                // tiautofocusinmodal属性需要在change校验中使用(ChangeCheck.ts)\r\n                this.renderer.setAttribute(activeElement, 'tiautofocusinmodal', '');\r\n                activeElement.focus();\r\n                this.renderer.removeAttribute(activeElement, 'tiautofocusinmodal');\r\n            }\r\n        } else {\r\n            // 弹窗内未找到已聚焦元素情况下，优先处理 input 和 textarea 原生标签autofocus聚焦\r\n            // (input,textarea.button原生标签的autofocus弹窗打开时无效(chrome是从第二次打开无效)，因此要做此处理)\r\n            let focusEle: any = this.nativeElement.querySelector(`input[autofocus]:not([disabled]):not([tabindex=\\'-1\\']),\r\n                textarea[autofocus]:not([disabled]):not([tabindex=\\'-1\\']), button[autofocus]:not([disabled]):not([tabindex=\\'-1\\'])`);\r\n            // 如果通过上述处理，聚焦元素仍未获取到的情况下，则可聚焦元素为当前弹框\r\n            focusEle = focusEle || this.modalEleRef.nativeElement;\r\n            focusEle.focus();\r\n        }\r\n    }\r\n    // 用于处理tab键行为，确保tab时只可在弹框内循环获取焦点\r\n    private onTabChange(event: KeyboardEvent): void {\r\n        const focusableElementList: Array<Element> = this.getFocusableElesInModal(); // 获取当前弹出框DOM中可以获取焦点的元素列表\r\n        const focusableListLength: number = focusableElementList.length;\r\n        if (focusableListLength === 0) {\r\n            return;\r\n        }\r\n        const target: EventTarget = event.target; // 事件对象元素\r\n        const firstFocusableEle: any = focusableElementList[0]; // 第一个可获取焦点的元素\r\n        const lastFocusableEle: any = focusableElementList[focusableListLength - 1]; // 最后一个可获取焦点的元素\r\n        // 按下tab+shift键时，如果当前已获取焦点元素是弹出框中的第一个可获取焦点元素或弹框本身，则聚焦最后一个元素\r\n        if (event.shiftKey) {\r\n            if (target === firstFocusableEle || target === this.modalEleRef.nativeElement) {\r\n                lastFocusableEle.focus();\r\n                TiModalComponent.preventEvent(event); // 阻止默认事件及继续冒泡，确保此处手动focus生效\r\n            }\r\n\r\n            return;\r\n        }\r\n        // 按下tab键时，如当前已获取焦点元素是弹框中最后一个可获取焦点元素，则聚焦第一个元素\r\n        if (target === lastFocusableEle) {\r\n            firstFocusableEle.focus();\r\n            TiModalComponent.preventEvent(event);\r\n        }\r\n    }\r\n    private getFocusableElesInModal(): Array<Element> {\r\n        if (this.focusableElements.length !== 0) {\r\n            return this.focusableElements;\r\n        }\r\n        const contentEle: Element = this.contentRef.nativeElement;\r\n        if (contentEle) {\r\n            const elements: NodeListOf<Element> = contentEle.querySelectorAll(TiModalComponent.tababbleSelector);\r\n            [].forEach.call(elements, (element: any) => { // 找出页面真实显示的元素，只有显示的元素才可tab聚焦\r\n                if (getComputedStyle(element).display !== 'none' &&\r\n                    element.offsetWidth > 0 && element.offsetHeight > 0) {\r\n                    this.focusableElements.push(element);\r\n                }\r\n            });\r\n        }\r\n\r\n        return this.focusableElements;\r\n    }\r\n}\r\n","import { Component, ViewEncapsulation } from '@angular/core';\r\nimport { TiModalComponent } from './TiModalComponent';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-modal-wrapper-no-animation',\r\n    templateUrl: './TiModalComponentNoAnimation.html',\r\n    styleUrls: ['./modal.less'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class TiModalNoAnimationComponent extends TiModalComponent {\r\n    set showState(value: string) {\r\n        this._showState = value;\r\n        this.onAnimationDone({toState: value});\r\n    }\r\n}\r\n","import { Component, HostListener, Input, Renderer2 } from '@angular/core';\r\nimport { animate, state,  style, transition, trigger } from '@angular/animations';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport const animateStyle: string = '0.3s cubic-bezier(0.40, 0.00, 0.20, 1.00)';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-backdrop',\r\n    template: `<div class='ti3-modal-backdrop'\r\n                [@.disabled]='!animation' [@backdropAnimate] = 'showState'\r\n                (@backdropAnimate.done)='onAnimationDone($event)'></div>`,\r\n    styleUrls: ['./backdrop.less'],\r\n    animations: [\r\n        trigger('backdropAnimate', [\r\n            state('show', style({\r\n                opacity : 0.2\r\n            })),\r\n            state('hide, void', style({\r\n                opacity: 0\r\n            })),\r\n            transition('show => hide', animate(animateStyle)),\r\n            transition('hide => show', animate(animateStyle))\r\n        ])\r\n    ]\r\n})\r\nexport class TiBackdropComponent {\r\n    constructor(protected renderer: Renderer2) {\r\n    }\r\n\r\n    protected _showState: string; // 组件显示状态，用于控制动画的状态切换\r\n\r\n    set showState(value: string) {\r\n        this._showState = value;\r\n    }\r\n\r\n    get showState(): string {\r\n        return this._showState;\r\n    }\r\n    public animation: boolean;\r\n    public index: number = 0; // 多个弹出框情况下，zindex层级设置辅助\r\n    public destroy: () => void;\r\n    // 在微前端，多个子应用之间url路径跳转,等到弹窗隐藏结束后，this.destroy() 已经无效。\r\n    @HostListener('window:hashchange') onhashchange(): void {\r\n        this.destroy();\r\n    }\r\n    onAnimationDone($event: any): void {\r\n        // 弹框隐藏动画结束后,销毁弹框DOM\r\n        if ($event.toState === 'hide') {\r\n            this.destroy();\r\n\r\n            return;\r\n        }\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { TiBackdropComponent } from './TiBackdropComponent';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-backdrop-no-animation',\r\n    template: `<div class='ti3-modal-backdrop' #backdrop></div>`,\r\n    styleUrls: ['./backdrop.less']\r\n})\r\n\r\nexport class TiBackdropNoAnimationComponent extends TiBackdropComponent {\r\n    set showState(value: string) {\r\n        this._showState = value;\r\n        this.onAnimationDone({toState: value});\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\n/**\r\n * 弹框header容器标签，可将弹框头部内容定义在该容器内\r\n */\r\n@Component({\r\n    selector: 'ti-modal-header',\r\n    template: `<span><ng-content></ng-content></span>`,\r\n    host: {\r\n        '[class.ti3-modal-header]': 'true'\r\n    }\r\n})\r\nexport class TiModalHeaderComponent {\r\n}\r\n","import { Component } from '@angular/core';\r\n/**\r\n * 弹框body容器标签，可将弹框body内容定义在该容器内\r\n */\r\n@Component({\r\n    selector: 'ti-modal-body',\r\n    template: `<ng-content></ng-content>`,\r\n    host: {\r\n        '[class.ti3-modal-body]': 'true'\r\n    }\r\n})\r\nexport class TiModalBodyComponent {\r\n}\r\n","import { Component } from '@angular/core';\r\n/**\r\n * 弹框header容器标签，可将弹框底部内容定义在该容器内\r\n */\r\n@Component({\r\n    selector: 'ti-modal-footer',\r\n    template: `<ng-content></ng-content>`,\r\n    host: {\r\n        '[class.ti3-modal-footer]': 'true'\r\n    }\r\n})\r\nexport class TiModalFooterComponent {\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiRendererModule } from '../renderer/TiRendererModule';\r\nimport { CommonModule } from '@angular/common';\r\n// 命名含有Service的Module，都不是对外暴露的Service，是内部使用。外部使用此Service，导入TiDragModule即可\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiRendererModule\r\n  ]\r\n})\r\nexport class TiDragServiceModule {\r\n}\r\n","import { Injectable, Renderer2, RendererFactory2 } from '@angular/core';\r\nimport { TiRenderer } from '../renderer/TiRenderer';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiDragServiceModule } from './TiDragServiceModule';\r\n// Renderer2注入运行时报错。临时改法，只为通过编译：改为RendererFactory2注入\r\n// 服务的设计目标，并不涉及到渲染。\r\n// https://huncode.com/using-renderer2-inside-services-in-angular/\r\n/**\r\n * 拖拽配置项参数设置接口\r\n */\r\nexport interface TiDraggableConfig {\r\n    /**\r\n     * 可拖拽元素，仅用于服务生成方式的配置\r\n     */\r\n     helper?: Element;\r\n     /**\r\n      * 拖拽生效元素，即只有当鼠标按下该元素时才可开始拖拽\r\n      */\r\n     handle?: Element;\r\n     /**\r\n      * 可拖拽坐标轴，可定义为x/y，即只可在x和Y方向拖拽\r\n      */\r\n     axis?: 'x' | 'y' | null;\r\n     /**\r\n      * 是否可拖拽，仅用于服务生成方式的配置\r\n      */\r\n     disabled?: boolean;\r\n     /**\r\n      * 拖拽开始事件\r\n      */\r\n     start?(): void;\r\n     /**\r\n      * 拖拽中事件\r\n      */\r\n     drag?(): void;\r\n     /**\r\n      * 拖拽结束事件\r\n      */\r\n     stop?(): void;\r\n}\r\n/**\r\n * 拖拽服务，适用于可拖拽元素不在html模板中显示声明的情况，除服务方式外，还提供了指令生成方式[TiDraggableDirective]{@link ../directives/TiDraggableDirective.html}，\r\n * 使用该服务时需要引入模块TiDragServiceModule\r\n *\r\n * <example-url>../tiny3demo/#/drag/drag-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiDragServiceModule\r\n  })\r\nexport class TiDragService {\r\n    private renderer: Renderer2;\r\n    constructor(rendererFactory: RendererFactory2, private tiRenderer: TiRenderer) {\r\n        /* tslint:disable:no-null-keyword */\r\n        this.renderer = rendererFactory.createRenderer(null, null);\r\n    }\r\n    /**\r\n     * 创建拖拽对象\r\n     *\r\n     * 函数返回值为\r\n     * {\r\n     * destroy: () => void\r\n     * }\r\n     */\r\n    create(options: TiDraggableConfig): {\r\n        destroy(): void\r\n    } {\r\n        const helper: Element = options.helper; // 可拖拽元素，原生HTML类型\r\n        const handle: Element = options.handle || helper; // 拖拽生效元素,未定义情况下，默认为helper元素\r\n        // 标志位，用于记录是否是拖拽引起的事件触发,在mousedown和mouseup中分别进行了置位\r\n        let mouseStart: boolean = false;\r\n        // 记录初始位置信息\r\n        let originalPagePos: {\r\n            pageX: number,\r\n            pageY: number\r\n        };\r\n        let originalPos: {\r\n            left: number\r\n            top: number\r\n        };\r\n        // 设置给helper元素的位置信息，用于位置设置及事件中参数传递\r\n        let position: {\r\n            left: number\r\n            top: number\r\n        };\r\n        // 非定位元素情况下设置left/top无效，因此需先将其设置为relative定位\r\n        // 修复SSR错误：ERROR ReferenceError: getComputedStyle is not defined\r\n        const pos: string = typeof getComputedStyle !== 'undefined' ? getComputedStyle(helper).position : '';\r\n        if (!/(fixed|absolute|relative)/.test(pos)) {\r\n            this.renderer.setStyle(helper, 'position', 'relative');\r\n        }\r\n        // 拖拽时需要用到的mouse事件句柄记录\r\n        let mouseMoveEvt: Function;\r\n        let mouseUpEvt: Function;\r\n        this.renderer.listen(handle, 'mousedown', (event: MouseEvent) => {\r\n            if (options.disabled) {// 灰化情况下不做处理\r\n                return;\r\n            }\r\n            event.preventDefault(); // 阻止拖拽过程中文本的选中处理等操作\r\n            mouseStart = true;\r\n            // 初始拖拽时鼠标距离页面边距位置（包含滚动条在内）\r\n            originalPagePos = {\r\n                pageX: event.pageX,\r\n                pageY: event.pageY\r\n            };\r\n            // 拖拽元素初始位置,由于获取到的位置为'xxpx',因此此处需要转化为数字\r\n            originalPos = position = {\r\n                left: parseInt(getComputedStyle(helper).left, 10) || 0,\r\n                top: parseInt(getComputedStyle(helper).top, 10) || 0\r\n            };\r\n            // 触发初始拖拽事件\r\n            triggerEvt('start');\r\n            mouseMoveEvt = this.renderer.listen(document, 'mousemove', (evt: MouseEvent) => {\r\n                onMouseMove(evt);\r\n            });\r\n            mouseUpEvt = this.renderer.listen(document, 'mouseup', (evt: MouseEvent) => {\r\n                onMouseUp(evt);\r\n            });\r\n        });\r\n        const onMouseMove: (evt: MouseEvent) => void = (evt: MouseEvent): void => {\r\n            // 防止非拖拽触发的mousemove事件\r\n            if (!mouseStart) {\r\n                return;\r\n            }\r\n            evt.preventDefault(); // 阻止拖拽过程中的选中处理等操作\r\n            const topPos: number = (options.axis === 'x')\r\n                                ? originalPos.top\r\n                                : (evt.pageY - originalPagePos.pageY + originalPos.top - document.body.scrollTop);\r\n            const leftPos: number = (options.axis === 'y')\r\n                                    ? originalPos.left\r\n                                    : (evt.pageX - originalPagePos.pageX + originalPos.left - document.body.scrollLeft);\r\n            position = {\r\n                left: leftPos,\r\n                top: topPos\r\n            };\r\n            // 触发拖拽时间，该事件中处理拖拽过程中的位置纠正\r\n            triggerEvt('drag');\r\n            this.tiRenderer.setStyles(helper, {\r\n                left: `${position.left}px`,\r\n                top: `${position.top}px`\r\n            });\r\n        };\r\n        const onMouseUp: (evt: MouseEvent) => void = (evt: MouseEvent): void => {\r\n            mouseStart = false;\r\n            evt.preventDefault();\r\n            triggerEvt('stop');\r\n            // 拖拽停止后，解绑document上的相关事件\r\n            mouseMoveEvt();\r\n            mouseUpEvt();\r\n        };\r\n        const triggerEvt: (evtType: string) => void = (evtType: string): void => {\r\n            if (options[evtType]) {\r\n                const ret: object = options[evtType]({position, helper});\r\n                if (typeof ret === 'object') {\r\n                    position = {...ret, ...position};\r\n                }\r\n            }\r\n        };\r\n\r\n        return {\r\n            destroy: (): void => {\r\n                if (!Util.isUndefined(mouseMoveEvt)) {\r\n                    mouseMoveEvt();\r\n                }\r\n                if (!Util.isUndefined(mouseUpEvt)) {\r\n                    mouseUpEvt();\r\n                }\r\n            }\r\n        };\r\n    }\r\n}\r\n","import {\r\n    Directive,\r\n    ElementRef,\r\n    Input,\r\n    OnChanges,\r\n    OnDestroy,\r\n    OnInit,\r\n    SimpleChanges\r\n} from '@angular/core';\r\nimport { TiDraggableConfig, TiDragService } from '../../services/drag/TiDragService';\r\n/**\r\n * 拖拽指令，除指令方式外，还提供了服务生成方式[TiDragService]{@link ../injectables/TiDragService.html}\r\n *\r\n * <example-url>../tiny3demo/#/drag/drag-all</example-url>\r\n */\r\n@Directive({\r\n    selector: '[tiDraggable]'\r\n})\r\nexport class TiDraggableDirective implements OnInit, OnChanges, OnDestroy {\r\n    /**\r\n     * 拖拽配置项\r\n     */\r\n    @Input() tiDraggable: TiDraggableConfig;\r\n    /**\r\n     * 拖拽是否灰化，可动态修改\r\n     */\r\n    @Input() tiDragDisabled: boolean = false;\r\n    private dragInstance: {\r\n        destroy(): void\r\n    };\r\n    private options: TiDraggableConfig;\r\n    constructor(private hostEle: ElementRef, private dragService: TiDragService) {}\r\n    ngOnInit(): void {\r\n        this.options = {\r\n            ...this.tiDraggable,\r\n            helper: this.hostEle.nativeElement,\r\n            disabled: this.tiDragDisabled\r\n        };\r\n        this.dragInstance = this.dragService.create(this.options);\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // 通过直接修改options的方式修改disabled状态\r\n        if (changes['tiDragDisabled'] && !changes['tiDragDisabled'].firstChange) {\r\n            this.options.disabled = this.tiDragDisabled;\r\n        }\r\n    }\r\n    ngOnDestroy(): void {\r\n        // 修复SSR错误：TypeError: Cannot read property 'destroy' of undefined\r\n        this.dragInstance && this.dragInstance.destroy();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiDraggableDirective } from './TiDraggableDirective';\r\nimport { TiDragServiceModule } from '../../services/drag/TiDragServiceModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiDragServiceModule\r\n  ],\r\n  exports: [TiDraggableDirective, TiDragServiceModule],\r\n  declarations: [TiDraggableDirective]\r\n})\r\nexport class TiDraggableModule {\r\n}\r\nexport { TiDraggableDirective } from './TiDraggableDirective';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiPopupModule } from '../popup/TiPopupModule';\r\nimport { TiModalComponent } from './TiModalComponent';\r\nimport { TiModalNoAnimationComponent } from './TiModalNoAnimationComponent';\r\nimport { TiBackdropComponent } from './TiBackdropComponent';\r\nimport { TiBackdropNoAnimationComponent } from './TiBackdropNoAnimationComponent';\r\nimport { TiModalHeaderComponent } from './TiModalHeaderComponent';\r\nimport { TiModalBodyComponent } from './TiModalBodyComponent';\r\nimport { TiModalFooterComponent } from './TiModalFooterComponent';\r\nimport { TiRendererModule } from '../renderer/TiRendererModule';\r\nimport { TiDraggableModule } from '../../directives/drag/TiDraggableModule';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n    imports: [CommonModule,\r\n              TiDraggableModule,\r\n              TiIconModule,\r\n              TiPopupModule,\r\n              TiOutlineModule,\r\n              TiRendererModule],\r\n    exports: [TiModalComponent, TiModalNoAnimationComponent,\r\n        TiBackdropNoAnimationComponent, TiModalHeaderComponent,\r\n        TiModalFooterComponent, TiModalBodyComponent],\r\n    declarations: [TiModalComponent, TiModalNoAnimationComponent,\r\n        TiBackdropNoAnimationComponent, TiModalHeaderComponent,\r\n        TiModalFooterComponent, TiModalBodyComponent, TiBackdropComponent],\r\n    entryComponents: [TiModalComponent, TiModalNoAnimationComponent, TiBackdropNoAnimationComponent, TiBackdropComponent]\r\n})\r\nexport class TiModalModule {\r\n}\r\n\r\nexport * from './TiModalInterface';\r\nexport { TiModalHeaderComponent } from './TiModalHeaderComponent';\r\nexport { TiModalFooterComponent } from './TiModalFooterComponent';\r\nexport { TiModalBodyComponent } from './TiModalBodyComponent';\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiImagepreviewComponent } from './TiImagepreviewComponent';\r\nimport { TiModalModule } from '../../services/modal/TiModalModule';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [TiModalModule, CommonModule, TiIconModule, TiOutlineModule],\r\n  exports: [TiImagepreviewComponent],\r\n  declarations: [TiImagepreviewComponent]\r\n})\r\n\r\nexport class TiImagepreviewModule {}\r\nexport { TiImagepreviewComponent, TiFilePreviewInfo } from './TiImagepreviewComponent';\r\n","/* eslint-disable no-eq-null */\r\n/* eslint-disable eqeqeq */\r\nimport { Component, ElementRef, Input, QueryList, Renderer2, ViewChildren } from '@angular/core';\r\nimport { TiKeymap, Util } from '../../utils/Util';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n// 下面注释，可以避免编译lib时正则报错。原理未知，副作用未知。\r\n// @dynamic\r\n/**\r\n * Ip组件\r\n *\r\n * Ip组件提供了一种方便的显示和设置IP地址的功能。\r\n *\r\n * <example-url>../tiny3demo/#/ip/ip-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-ip',\r\n    templateUrl: './ip.html',\r\n    styleUrls: ['./ip.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiIpComponent)],\r\n    host: {\r\n        '[class.ti_input_ip_container_ipv4]': 'version !== 6',\r\n        '[class.ti_input_ip_container_ipv6]': 'version === 6',\r\n        '(paste)': 'pasteHandle($event)',\r\n        '(blur)': 'blurHandle($event)'\r\n    }\r\n})\r\nexport class TiIpComponent extends TiFormComponent {\r\n    // ipv4 配置参数\r\n    private static readonly ipv4Version: number = 4;\r\n    // 采用华为自研的ipv4正则表达式\r\n    private static readonly ipv4Reg: RegExp = /^(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))$/i;\r\n    private static readonly ipv4 = {\r\n        ipvCheckReg: /[\\D]/g,\r\n        label: '...',\r\n        placeReg: /\\s/g,\r\n        separator: '.',\r\n        ipValueArray: new Array(4).fill('')\r\n    };\r\n    // ipv6 配置参数\r\n    private static readonly ipv6Version: number = 6;\r\n    // 采用华为自研的ipv6正则表达式\r\n    private static readonly ipv6Reg: RegExp = /^(((([\\da-f]{1,4}):){7}([\\da-f]{1,4}))|(((([\\da-f]{1,4}):){1,7}:)|((([\\da-f]{1,4}):){6}:([\\da-f]{1,4}))|((([\\da-f]{1,4}):){5}:(([\\da-f]{1,4}):)?([\\da-f]{1,4}))|((([\\da-f]{1,4}):){4}:(([\\da-f]{1,4}):){0,2}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){3}:(([\\da-f]{1,4}):){0,3}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){2}:(([\\da-f]{1,4}):){0,4}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){1}:(([\\da-f]{1,4}):){0,5}([\\da-f]{1,4}))|(::(([\\da-f]{1,4}):){0,6}([\\da-f]{1,4}))|(::([\\da-f]{1,4})?))|(((([\\da-f]{1,4}):){6}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){5}:(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){4}:(([\\da-f]{1,4}):)?(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){3}:(([\\da-f]{1,4}):){0,2}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){2}:(([\\da-f]{1,4}):){0,3}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|(([\\da-f]{1,4})::(([\\da-f]{1,4}):){0,4}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|(::(([\\da-f]{1,4}):){0,5}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))))$/i;\r\n    private static readonly ipv6 = {\r\n        ipvCheckReg: /[^a-f\\d]/ig,\r\n        label: ':::::::',\r\n        placeReg: /\\s/g,\r\n        separator: ':',\r\n        ipValueArray: new Array(8).fill('')\r\n    };\r\n    private static getGlbInfo(ver: number): any {\r\n        return ver === 4 ? TiIpComponent.ipv4 : TiIpComponent.ipv6;\r\n    }\r\n\r\n    /**\r\n     * ip版本号，可以赋值4或6\r\n     */\r\n    @Input() version: number = 4;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChildren('ipInput') ipInputs: QueryList<ElementRef>;\r\n    /**\r\n     * @ignore\r\n     * 存放 ip 组件各个input框值的数组\r\n     */\r\n    public ipsValues: Array<string>;\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer2: Renderer2) {\r\n        super(hostRef, renderer2);\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public pasteHandle = (event: any) => {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        event.preventDefault(); // 阻止默认的input原生的粘贴事件（把粘贴板的值粘贴到input框）\r\n        let pasteValue: string = '';\r\n        if (window['clipboardData'] && window['clipboardData'].getData) { // for IE\r\n            pasteValue = window['clipboardData'].getData('Text');\r\n        } else { // For other browser\r\n            try {\r\n                pasteValue = event.clipboardData.getData('Text');\r\n            } catch (err) { }\r\n        }\r\n        const unmaskpaste: string = this.unmask(this.version, pasteValue);\r\n        if (this.isValidIP(this.version, unmaskpaste)) {\r\n            this.updateValue(unmaskpaste); // 粘贴之后更新值\r\n            this.ipsValues = this.splitToIPArray(this.version, this.model); // 内部的操作手动更新数组\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public blurHandle = (event: any) => {\r\n        const ipValue: string = this.generateIPValue(0);\r\n        if (ipValue === '') {\r\n            this.updateValue(ipValue);\r\n        } else {\r\n            const fixedVaule: string = this.blurFixed(this.version, ipValue);\r\n            this.updateValue(this.mask(this.version, fixedVaule));\r\n        }\r\n    }\r\n    private blurFixed(ver: number, ip: string): string {\r\n        const arr: Array<string> = this.splitToIPArray(ver, ip);\r\n        for (let i: number = 0; i < arr.length; i++) {\r\n            if (arr[i] === '') {\r\n                arr[i] = '0';\r\n            }\r\n        }\r\n\r\n        return this.joinToIPValue(ver, arr);\r\n    }\r\n\r\n    // 组件声明周期钩子--start\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.init();\r\n    }\r\n\r\n    private init(): void {\r\n        // 默认是IPv4\r\n        this.version = parseInt(String(this.version), 10) === TiIpComponent.ipv6Version ?\r\n        TiIpComponent.ipv6Version : TiIpComponent.ipv4Version;\r\n        // 初始化ipValueArray  赋值新的数组\r\n        this.ipsValues = TiIpComponent.getGlbInfo(this.version).ipValueArray.concat();\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        //  处理 聚焦 并使第一段ip获焦(放在这个钩子的原因：在oninit中拿不到 QueryList 返回的结果集)\r\n        const elements = [];\r\n        this.ipInputs.forEach((item) => {\r\n            elements.push(item.nativeElement);\r\n        });\r\n        // 推荐在onInit()时调用setFocusableElems(), 但是ngFor/ngIf中的元素在ngAfterViewInit()才能获取到\r\n        this.setFocusableElems(elements);\r\n    }\r\n    // 组件声明周期钩子--end\r\n\r\n    // 实现ControlValueAccessor接口--start\r\n    /**\r\n     * @ignore\r\n     */\r\n    writeValue(value: any): void {\r\n\r\n        if (value === '') {\r\n            super.writeValue(value);\r\n            // 对空值做特殊处理,为空时清空IP框\r\n            this.ipsValues = TiIpComponent.getGlbInfo(this.version).ipValueArray.concat();\r\n        } else if (value === this.joinToIPValue(this.version, this.ipsValues)) {\r\n            // 和当前IP框的值相同不处理\r\n        } else if (this.isValidIP(this.version, value) || this.isInputting(this.version, value)) {\r\n            super.writeValue(this.mask(this.version, value));\r\n            this.ipsValues = this.splitToIPArray(this.version, this.model);\r\n        } else {\r\n            // 非法不处理 恢复之前值\r\n            super.writeValue(this.joinToIPValue(this.version, this.ipsValues));\r\n        }\r\n    }\r\n    // 实现ControlValueAccessor接口--end\r\n\r\n    // 组件交互方法集合--start\r\n    /**\r\n     * @ignore\r\n     */\r\n    public keydown(e: any, index: number): void {\r\n        const ipInputs = this.ipInputs;\r\n        const keyCode = e.keyCode;\r\n        this.keydownHandle(e, ipInputs['_results'][index], index, this.version);\r\n        // 按下键为左或右键时，不做重新赋值，避免IE浏览器下重新赋值之后光标位置不准确问题\r\n        if (keyCode === TiKeymap.KEY_ARROW_LEFT || keyCode === TiKeymap.KEY_ARROW_RIGHT) {\r\n            return;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public input(e: any, index: number): void {\r\n        // 防止中文输入和非法字符的输入\r\n        this.generateIPValue(index);\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public change(index: number): void {\r\n        const ipValues: string = this.generateIPValue(index);\r\n        this.updateValue(ipValues);\r\n    }\r\n\r\n    // 组件交互方法集合--end\r\n\r\n    // 内部公共方法集合--start\r\n    /**\r\n     * @description  将 ip 数组拼接成ip值\r\n     * @param: ver ip版本\r\n     * @param: arr ip字符串中数字组成的数组\r\n     * @returns\r\n     */\r\n    private joinToIPValue(ver: number, arr: Array<string>): string {\r\n        return arr.join(TiIpComponent.getGlbInfo(ver).separator);\r\n    }\r\n    /**\r\n     * @description 将 ip 值分割成ip数组\r\n     * @param: ver ip版本\r\n     * @param: ip ip字符串\r\n     */\r\n    private splitToIPArray(ver: number, ip: string): Array<string> {\r\n        const res: Array<string> = ip ? ip.split(TiIpComponent.getGlbInfo(ver).separator) : [];\r\n\r\n        return res;\r\n    }\r\n    private isInputting(ver: number, value: string): boolean {\r\n        const arr: Array<string> = this.splitToIPArray(ver, value);\r\n\r\n        return arr.indexOf('') >= 0;\r\n    }\r\n    // 判断当前ip值是否合法\r\n    private isValidIP(ver: number, ip: string): boolean {\r\n        if (ip === null || ip === undefined) {\r\n            return false;\r\n        }\r\n        const rgx = (ver === TiIpComponent.ipv4Version) ? TiIpComponent.ipv4Reg : TiIpComponent.ipv6Reg;\r\n        return rgx.test(ip);\r\n    }\r\n    /**\r\n     * @description IP需要去除前面的0，例如：,“012.12.23.002”经过该函数处理后变为：“12.12.23.2”；IPv6支持缩略格式\r\n     * @param: ver ip版本\r\n     * @param: ip ip字符串\r\n     * @returns\r\n     */\r\n    private mask(ver: number, ip: string): string {\r\n        const ipInfo = TiIpComponent.getGlbInfo(ver);\r\n        const part = ip.split(ipInfo.separator);\r\n        const partLength = part.length;\r\n        if (ver === 4) {\r\n            for (let i: number = 0; i < partLength; i++) {\r\n                if (part[i] !== '') {\r\n                    let partNumber = parseInt(part[i], 10);\r\n                    // parseInt(part[i], 10) /= 1;\r\n                    partNumber /= 1; // 将part[j]转化为整数，目的是消除前面的0\r\n                    part[i] = String(partNumber); // 再转化为字符串\r\n                }\r\n            }\r\n        } else {\r\n            // IPv6支持缩略格式，即任何由全0组成的1个或多个16位段的单个连续的字符串 都可以用一个双冒号“::”，且“::”只出现一次；例如：2001:d02::14:95\r\n            // 用‘0’补齐缩略格式缺少个数\r\n            while (part.length < 8) {\r\n                let index = part.indexOf('');\r\n                part.splice(index, 0, '0')\r\n            }\r\n\r\n            part.forEach((partItem, index) => {\r\n                //  查找是否有1-9和字母，如果没有，替换为0，如果有，去除前面的0\r\n                if (partItem.match(/[1-9a-f]/i)) {\r\n                    part[index] = partItem.replace(/^0{1,3}/i, '')\r\n                } else if (partItem !== '0') {\r\n                    part[index] = '0';\r\n                }\r\n            });\r\n        }\r\n\r\n        return part.join(ipInfo.separator);\r\n    }\r\n    /**\r\n     * @description 去掉空格后的IP地址；例如“  12.12 .23.2  ”进过该函数处理后返回：“12.12.23.2”\r\n     * @param: ver ip版本\r\n     * @param: ip ip字符串\r\n     */\r\n    private unmask(ver: number, ip: string): string {\r\n        const iPInfo = TiIpComponent.getGlbInfo(ver);\r\n\r\n        return ip.replace(iPInfo.placeReg, '');\r\n    }\r\n\r\n    /**\r\n     * @description  获取当前ip段输入的值并进行判断，合法时更新到当前ip段输入框内，并拼接返回整体ip值\r\n     * @param: index 当前输入框的下标\r\n     */\r\n    private generateIPValue(index: number): string {\r\n        const ipInfo = TiIpComponent.getGlbInfo(this.version);\r\n        const cellArray = this.ipInputs;\r\n        let value = cellArray['_results'][index].nativeElement.value;\r\n        if (ipInfo.ipvCheckReg.test(value)) {\r\n            value = value.replace(ipInfo.ipvCheckReg, '');\r\n        }\r\n\r\n        // ipv4下，当前输入框值大于255时，强制转换成255\r\n        if (this.version === TiIpComponent.ipv4Version && value > 255) {\r\n            value = 255;\r\n        }\r\n        for (let i: number = 0; i < this.ipsValues.length; i++) {\r\n            if (i === index) {\r\n                this.ipsValues[i] = value;\r\n                cellArray['_results'][index].nativeElement.value = value;\r\n            }\r\n        }\r\n        let ipValues;\r\n        ipValues = this.ipsValues.join(ipInfo.separator);\r\n        if (ipValues === ipInfo.label) {\r\n            ipValues = '';\r\n        }\r\n        return ipValues;\r\n    }\r\n    // 更新value值 //TODO: Tiny3考虑去除这个函数，用writeValue代替\r\n    private updateValue(newValue: string): void {\r\n        if (newValue === this.model) {\r\n            return;\r\n        }\r\n        // 记录ip的值在value中,方便用户获取\r\n        this.model = newValue;\r\n        this.writeValue(newValue);\r\n    }\r\n    // keydown事件触发时，判断并设置组件光标位置\r\n    private keydownHandle(e: any, thisInput: ElementRef, index: number, ver: number): void {\r\n        const ipInputsLength = this.ipInputs.length;\r\n        const nextCell = index < ipInputsLength - 1 ?\r\n            this.ipInputs['_results'][index + 1] : undefined;\r\n        const prevCell = index > 0 ? this.ipInputs['_results'][index - 1] : undefined;\r\n\r\n        const keyCode = e.keyCode;\r\n        // 键盘码110代表. 190代表 >.---当键盘码为这两种时,跳至下一输入框中,并选中该输入框中的值\r\n        if (keyCode === TiKeymap.KEY_NUMPAD_DECIMAL || keyCode === TiKeymap.KEY_PERIOD) {\r\n            if (!Util.isUndefined(nextCell)) {  // 非最后一个输入框时，跳至下一输入框\r\n                nextCell.nativeElement.focus();\r\n                nextCell.nativeElement.select();\r\n            }\r\n            e.preventDefault(); // 不论是否为最后一个输入框,防止默认事件发生,否则输入框中会出现 ...\r\n            return;\r\n        }\r\n        // 光标后移到下一段ip\r\n        if (this.isMoveToNext(e, thisInput, nextCell, ver)) {\r\n            nextCell.nativeElement.focus();\r\n            this.caret(nextCell, 0); // 设置光标位置\r\n        }\r\n\r\n        // 光标前移到上一段ip\r\n        if (this.isMoveToPrevous(keyCode, thisInput, prevCell)) {\r\n            this.caret(prevCell, prevCell.nativeElement.value.length); // 设置光标位置\r\n            e.preventDefault(); // 防止默认事件发生,否则输入框中的回退光标位置会有问题\r\n        }\r\n\r\n    }\r\n    // 判断当前是否需要将光标移至后一段ip\r\n    private isMoveToNext(e: any, thisInput: ElementRef, nextCell: ElementRef, ver: number): boolean {\r\n        // 如果下一段ip不存在直接返回false\r\n        if (Util.isUndefined(nextCell)) {\r\n            return false;\r\n        }\r\n        // 如果输入为合法数字,输入框中已有3个值,光标位于输入框末尾,并且存在下一输入框, 则跳至下一输入框\r\n        let isFullToNext;\r\n        if (ver !== TiIpComponent.ipv6Version) {\r\n            isFullToNext = this.checkIpv4MoveToNext(thisInput, e);\r\n        } else {\r\n            isFullToNext = this.checkIpv6MoveToNext(thisInput, e);\r\n        }\r\n        // 当为向右键时→,且光标位置在该输入框末尾。则直接跳到下一输入框中\r\n        const keyCode = e.keyCode;\r\n        const isRightToNext = keyCode === TiKeymap.KEY_ARROW_RIGHT\r\n            && this.caret(thisInput)[0] === thisInput.nativeElement.value.length;\r\n        return isFullToNext || isRightToNext;\r\n    }\r\n    // 判断当前是否需要将光标移至前一段ip\r\n    private isMoveToPrevous(keyCode: number, thisInput: ElementRef, prevCell: ElementRef): boolean {\r\n        // 1.当为向左键(37),且光标位置位于输入框起始位置时,则跳至前一输入框中;\r\n        // 2.当为backspace键,且已回删至输入框起始位置 跳至前已输入框中\r\n        // 3.输入框处于选中状态时，按backspace键不跳到前一输入框中\r\n        return !Util.isUndefined(prevCell) &&\r\n            ((keyCode === TiKeymap.KEY_ARROW_LEFT && this.caret(thisInput)[0] === 0)  // 按左键\r\n                || (keyCode === TiKeymap.KEY_BACKSPACE && this.caret(thisInput)[0] === 0) // 按后退键并且删除完\r\n                && (this.caret(thisInput)[0] === this.caret(thisInput)[1])); // 输入框处于选中状态按后退键不跳到前一个输入框\r\n    }\r\n\r\n    // 判断当前段ipv4输入框是否已满3,末端是合法字符，且光标位置在此段ip最后\r\n    private checkIpv4MoveToNext(thisInput: ElementRef, e: any): boolean {\r\n        return (thisInput.nativeElement.value.length === 3) && (this.isNumeric(e)\r\n            && (this.caret(thisInput)[0] === 3));\r\n    }\r\n    // 判断当前段ipv6输入框是否已满4未合法字符，且光标位置在此段ip最后\r\n    private checkIpv6MoveToNext(thisInput: ElementRef, e: any): boolean {\r\n        return (thisInput.nativeElement.value.length === 4) && (this.isHexaDecimal(e)\r\n            && (this.caret(thisInput)[0] === 4));\r\n    }\r\n    // 判断输入是否为ipv4合法字符\r\n    private isNumeric(e: any): boolean {\r\n        if (e.shiftKey || e.ctrlKey) {\r\n            return false;\r\n        }\r\n        const code = e.keyCode;\r\n        return (code >= TiKeymap.KEY_0 && code <= TiKeymap.KEY_9) ||\r\n            (code >= TiKeymap.KEY_NUMPAD_0 && code <= TiKeymap.KEY_NUMPAD_9);\r\n    }\r\n    // 判断输入是否为ipv6合法字符\r\n    private isHexaDecimal(e: any): boolean {\r\n        const keyCode = e.keyCode;\r\n        // ctrl键组合其它情况，输入框中不会输入有效字符，返回\r\n        if (e.ctrlKey) {\r\n            return false;\r\n        }\r\n        // 输入有效字符情况：1）a~f 2）有效数字\r\n        const isValidInput = (keyCode >= TiKeymap.KEY_A && keyCode <= TiKeymap.KEY_F)\r\n            || (keyCode >= TiKeymap.KEY_NUMPAD_0 && keyCode <= TiKeymap.KEY_NUMPAD_9)\r\n            || (keyCode >= TiKeymap.KEY_0 && keyCode <= TiKeymap.KEY_9);\r\n        return isValidInput;\r\n    }\r\n\r\n    /**\r\n     * @description  获取或设置光标位置\r\n     * @param: ele 光标所在dom\r\n     * @param: s 开始位置\r\n     * @param: e 结束位置\r\n     */\r\n    private caret(ele: ElementRef, s?: number, e?: number): any {\r\n        const element = ele.nativeElement;\r\n        const setPosition = function (el, start, end) {\r\n            if (el.setSelectionRange) {\r\n                el.focus();\r\n                el.setSelectionRange(start, end);\r\n            } else if (el.createTextRange) {\r\n                const range = el.createTextRange();\r\n                range.collapse(true);\r\n                range.moveEnd('character', end);\r\n                range.moveStart('character', start);\r\n                range.select();\r\n            }\r\n        };\r\n\r\n        if (s != null && e != null) {// setting range\r\n            return setPosition(element, s, e);\r\n        } else if (s != null) {// setting position\r\n            return setPosition(element, s, s);\r\n        }\r\n\r\n        // getting\r\n        if (element.createTextRange && document['selection']) {\r\n            const r = document['selection'].createRange().duplicate();\r\n\r\n            const end = element.value.lastIndexOf(r.text) + r.text.length;\r\n\r\n            r.moveEnd('character', element.value.length);\r\n            const start = (r.text === '') ? element.value.length : element.value.lastIndexOf(r.text);\r\n\r\n            return [start, end];\r\n        }\r\n\r\n        return [element.selectionStart, element.selectionEnd];\r\n    }\r\n    /**\r\n     * @ignore\r\n     * ngFor遍历的 trackBy函数，防止数据更新导致所有DOM重新渲染\r\n     */\r\n    public trackByFn(index: any, item: any): any {\r\n        return index;\r\n    }\r\n    // 内部公共方法集合--end\r\n}\r\n","import { FormsModule } from '@angular/forms';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIpComponent } from './TiIpComponent';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        TiTextModule\r\n    ],\r\n    exports: [TiIpComponent],\r\n    declarations: [TiIpComponent]\r\n})\r\n\r\nexport class TiIpModule {\r\n}\r\nexport { TiIpComponent } from './TiIpComponent';\r\n","import { Component, ElementRef, Input, Renderer2 } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiValidationConfig } from '../../directives/validation/TiValidationModule';\r\nimport { FormBuilder, FormControl, FormGroup, ValidatorFn } from '@angular/forms';\r\n\r\nexport interface TiIpsectionConfig {\r\n    /**\r\n     * 标志各网段\r\n     */\r\n    section: number;\r\n    /**\r\n     * 网段为select类型时，下拉配置对象\r\n     */\r\n    options?: Array<any>;\r\n    /**\r\n     * 网段为input类型时，设置文本是否加粗\r\n     */\r\n    bold?: boolean;\r\n    /**\r\n     * 网段为input类型时，配置校验提示信息，可参考校验组件示例\r\n     */\r\n    validation?: TiValidationConfig;\r\n    /**\r\n     * 网段为input类型时，配置校验规则，可参考校验组件示例\r\n     */\r\n    validationRules?: Array<ValidatorFn>;\r\n    /**\r\n     * 设置各网段是否灰化\r\n     */\r\n    disabled?: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * Ipsection组件，Ip各网段分开处理，各网段有下拉类和输入类两种类型；\r\n *\r\n * 9.0.4新增\r\n *\r\n * <example-url>../tiny3demo/#/ipsection/ipsection-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-ipsection',\r\n    templateUrl: 'ipsection.html',\r\n    styleUrls: ['./ipsection.less'],\r\n    host: {\r\n        '[class.ti3-ipsection-container]': 'true',\r\n        '(blur)': 'onBlur($event)'\r\n    },\r\n    providers: [TiFormComponent.getValueAccessor(TiIpsectionComponent)]\r\n})\r\n\r\nexport class TiIpsectionComponent extends TiFormComponent {\r\n    /**\r\n     * Ip网段配置数组对象，组件按该配置数组对象顺序渲染数据\r\n     */\r\n    @Input() configs: Array<TiIpsectionConfig>;\r\n    /**\r\n     * @ignore\r\n     * 存放 input 控件实例数组\r\n     */\r\n    private controls: Array<FormControl> = [];\r\n    /**\r\n     * @ignore\r\n     * 格式化输入\r\n     */\r\n    public maskInput: string = '000';\r\n    /**\r\n     * @ignore\r\n     * 存放各网段 ip 值的数组\r\n     */\r\n    public ipValues: Array<string> = [];\r\n    /**\r\n     * input控件 FormGroup 实例，服务可通过该实例动态更改某一FormControl实例相关属性（value，disabled，校验规则等）\r\n     */\r\n    public formGroup: FormGroup;\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer2: Renderer2, private fb: FormBuilder) {\r\n        super(hostRef, renderer2);\r\n        this.formGroup = fb.group({});\r\n    }\r\n\r\n    /**\r\n     * 将ip值分割为数组\r\n     */\r\n    private static splitToIPArray(ipValue: string): Array<string> {\r\n        const ipArray: Array<string> = ipValue ? ipValue.replace(/\\//, '.').split('.') : [];\r\n\r\n        return ipArray;\r\n    }\r\n\r\n    /**\r\n     * 将ip数组拼接为ip值\r\n     */\r\n    private static joinToIPValue(ipArray: Array<string>): string {\r\n        let ipValue: string = ipArray.join('.');\r\n        if (ipArray.length > 4) {\r\n            ipValue = ipValue.replace(/(.*)\\./, '$1/');\r\n        }\r\n\r\n        return ipValue;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 创建表单控件实例\r\n        for (let i: number = 0; i < this.configs.length; i++) {\r\n            if (!this.configs[i].options) {\r\n                this.controls[i] = new FormControl();\r\n                this.formGroup.addControl(`input_${i}`, this.controls[i]);\r\n                // input类型网段值更改时触发事件\r\n                this.controls[i].valueChanges.subscribe((value: any) => {\r\n                    this.updateIpValue(i, value);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        const itemElems: HTMLCollection = this.hostRef.nativeElement.getElementsByClassName('ti3-ipsection');\r\n        const focusElements: Array<any> = [];\r\n\r\n        // 设置可聚焦元素\r\n        for (let i: number = 0; i < this.configs.length; i++) {\r\n            if (itemElems[i].firstChild) {\r\n                focusElements.push(itemElems[i].firstChild);\r\n            } else {\r\n                this.setAttr(itemElems[i], 'disabled', this.configs[i].disabled || this.disabled);\r\n                focusElements.push(itemElems[i]);\r\n            }\r\n        }\r\n        this.setFocusableElems(focusElements);\r\n\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 获取model值，并进行初始化处理\r\n     */\r\n    writeValue(value: any): void {\r\n        super.writeValue(value);\r\n        this.ipValues = TiIpsectionComponent.splitToIPArray(value);\r\n\r\n        this.initIpValue();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 整体失焦触发事件\r\n     */\r\n    onBlur(event: any): void {\r\n        this.formatValue();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * select类型网段值更改时触发事件\r\n     */\r\n    onChange(i: number, value: any): void {\r\n        this.updateIpValue(i, value);\r\n    }\r\n\r\n    /**\r\n     * 初始化ip值\r\n     */\r\n    private initIpValue(): void {\r\n        for (let i: number = 0; i < this.configs.length; i++) {\r\n            if (this.configs[i].options) {\r\n                // 初始显示默认选中项，若value值在options存在，则显示该值，否则显示下拉配置项第一项\r\n                this.configs[i].selected = this.configs[i].options.find(item => item === this.ipValues[i]) ? this.ipValues[i] : this.configs[i].options[0];\r\n                this.updateIpValue(i, this.configs[i].selected);\r\n            } else {\r\n                // 初始设置value，disabled及校验规则\r\n                this.ipValues[i] = this.ipValues[i] ? parseInt(this.ipValues[i], 10).toString() : '';\r\n                this.controls[i].setValue(this.ipValues[i]);\r\n                this.controls[i].setValidators(this.configs[i].validationRules);\r\n                this.configs[i].disabled || this.disabled ? this.controls[i].disable() : this.controls[i].enable();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始及失焦处理输入框值，清除Ip网段前面的0\r\n     */\r\n    private formatValue(): void {\r\n        for (let i: number = 0; i < this.configs.length; i++) {\r\n            if (!this.configs[i].options) {\r\n                this.controls[i].setValue(parseInt(this.controls[i].value, 10).toString());\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 更新model值\r\n     */\r\n    private updateIpValue(index?: number, value?: any): string {\r\n        if (this.ipValues.length <= 0 || this.ipValues[index] === value) {\r\n            return;\r\n        }\r\n\r\n        this.ipValues.splice(index, 1, value);\r\n        const ipValue: string = TiIpsectionComponent.joinToIPValue(this.ipValues);\r\n        this.model = (ipValue === '...' || ipValue === '.../') ?  '' : ipValue;\r\n\r\n        return ipValue;\r\n    }\r\n}\r\n","import { Component, ContentChild, EventEmitter, HostListener, Input, Output, TemplateRef, ViewChild } from '@angular/core';\r\nimport { TiFormComponent, TiWholeComponent } from '../base/TiBaseModule';\r\nimport { TiDominatorComponent } from '../dominator/TiDominatorModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiDropsearchComponent } from '../dropsearch/TiDropsearchModule';\r\nimport { TiKeymap } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n\r\n/**\r\n * Select选择下拉组件\r\n *\r\n * 支持单选/多选，分组，搜索，懒加载。\r\n *\r\n * 单选主要功能为从一个数据集合中选择某一条数据，单选与RadioGroup功能相同，只是视觉呈现不同。\r\n *\r\n * 多选主要功能是从一个数据集合中任意选择多条数据，与checkboxGroup功能相同，只是视觉呈现不同。\r\n *\r\n * <example-url>../tiny3demo/#/select/select-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-select',\r\n    templateUrl: './select.html',\r\n    styleUrls: ['./select.less', './select-small.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiSelectComponent)],\r\n    host: {\r\n        '[class.ti3-select-small]': 'size === \"small\"',\r\n        '(blur)': 'onBlur()'\r\n    }\r\n})\r\nexport class TiSelectComponent extends TiWholeComponent {\r\n    /**\r\n     * @ignore\r\n     * dominator 到drop的距离\r\n     */\r\n    @Input() dominatorSpace: string = TiDropComponent.DOMINATOR_SPACE + 'px';\r\n    /**\r\n     * 是否多选\r\n     */\r\n    @Input() multiple: boolean = false;\r\n    /**\r\n     * 多选时, 选中项显示几行\r\n     *\r\n     * 版本 v9.0.4 添加\r\n     */\r\n    @Input() maxLine: number = 2;\r\n    /**\r\n     * 选中项文本超出时tip展开方向\r\n     *\r\n     * 9.0.3 新增\r\n     */\r\n    @Input() selectedTipPosition: TiPositionType = 'auto';\r\n    /**\r\n     * 预留文本\r\n     */\r\n    @Input() placeholder: string = '';\r\n     // 面板配置\r\n    /**\r\n     * 下拉面板的最大显示宽度，该变量与下拉类组件保持一致\r\n     *\r\n     * 1.\"justified\"(默认): 下拉框的宽度与Select组件的宽度保持一致；\r\n     *\r\n     * 2.\"auto\": 下拉框的宽度根据下拉选项的内容自动撑开；\r\n     *\r\n     * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于Select组件的宽度)。例如：\"200px\"\r\n     */\r\n    @Input() panelWidth: 'justified' | 'auto'| string = 'justified'; // TODO: 确认类型\r\n    /**\r\n     * 下拉面板的最大显示高度，溢出时则出滚动条。\r\n     *\r\n     *  缺省值 : 最大显示8条数据（有无searchbox都显示8条）\r\n     */\r\n    @Input() panelMaxHeight: string;\r\n    /**\r\n     * 无数据时的显示文本\r\n     */\r\n    @Input() noDataText: string = '...';\r\n    // 列表数据配置\r\n    /**\r\n     * 下拉选项的全部数据\r\n     */\r\n    @Input() options: Array<any>;\r\n    /**\r\n     * 要显示的字段\r\n     */\r\n    @Input() labelKey: string = 'label';\r\n    /**\r\n     * 要搜索的字段数组, 默认是[labelKey]\r\n     */\r\n    @Input() searchKeys: Array<string>;\r\n    // 其他配置\r\n    /**\r\n     * 是否显示搜索框\r\n     */\r\n    @Input() searchable: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 大小样式\r\n     */\r\n    @Input() size: 'default' | 'small' = 'default';\r\n    /**\r\n     * 文字超长显示...，hover时tip弹出方向\r\n     */\r\n    @Input() tipPosition: TiPositionType = 'right';\r\n    /**\r\n     * 单选下拉选择框是否开启清除已选项功能\r\n     *\r\n     * 3.0.8新增\r\n     */\r\n    @Input() clearable: boolean = false;\r\n    /**\r\n     * 多选下拉选择框是否开启全选功能\r\n     *\r\n     * 3.1.2新增\r\n     */\r\n    @Input() selectAll: boolean = false;\r\n    /**\r\n     * 设置是否显示已选项的个数，默认不显示，multiple为true时生效\r\n     *\r\n     * 10.1.0新增\r\n     */\r\n    @Input() showSelectedNumber: boolean = false ;\r\n    /**\r\n     * 用户想要打开面板的通知事件，一般用于数据懒加载。使用方式，见懒加载示例\r\n     */\r\n    @Output() readonly beforeOpen: EventEmitter<TiSelectComponent> = new EventEmitter<TiSelectComponent>();\r\n    // 3.0.2增加select接口\r\n    /**\r\n     * 多选选中/取消选中事件，向外通知option数据，需要自行判断option数据是否选中。\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly select: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * 当单选下拉选择框开启清除已选项功能时，点击清除按钮时触发\r\n     *\r\n     * 3.0.8新增\r\n     */\r\n    @Output() readonly clear: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * @ignore\r\n     * 10.0.2新增\r\n     *\r\n     * 后台搜索，传出搜索框的值\r\n     */\r\n    @Output() readonly beforeSearch: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * @ignore\r\n     * 用户写的item模板，firstTemplate是第一个或者唯一的template\r\n     */\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) firstTemplate: TemplateRef<any>;\r\n    @ContentChild('item', /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n    @ContentChild('selected', /* TODO: add static flag */ { static: true }) selectedTemplate: TemplateRef<any>;\r\n    @ContentChild('placeholder', /* TODO: add static flag */ { static: true }) placeholderTemplate: TemplateRef<any>;\r\n    @ContentChild('footer', /* TODO: add static flag */ { static: true }) footerTemplate: TemplateRef<any>;\r\n\r\n    /**\r\n     * @ignore\r\n     * 内部标签donimator组件\r\n     */\r\n    @ViewChild(TiDominatorComponent, /* TODO: add static flag */ { static: true }) dominatorCom: TiDominatorComponent;\r\n    /**\r\n     * @ignore\r\n     * 内部标签Droplist组件\r\n     */\r\n    @ViewChild(TiDropsearchComponent, { static: true }) dropsearchCom: TiDropsearchComponent;\r\n    protected oldSearchable: boolean = null;\r\n    public pagination: any; // 没有指定类型是因为如果引入TiPaginationComponent会因为循环引用导致报错\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        if (this.beforeSearch.observers.length !== 0) {\r\n            this.dropsearchCom.hasBeforeSearchObservers = true;\r\n        }\r\n    }\r\n    /**\r\n     * 兼容旧版：\r\n     * 3.1.2版select只能内嵌一个模板，无命名。\r\n     * 新版可以内嵌四个模板，示例书写要求都命名。\r\n     * 但需要兼容旧版无命名测试用例。\r\n     */\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterContentInit(): void {\r\n        super.ngAfterContentInit();\r\n        // 如果item模板为空，那么把第一个出现的无标签（无footer等标签）模板作为item\r\n        if (!this.itemTemplate && this.firstTemplate) {\r\n            const firstTemplateEle: Element = this.firstTemplate.elementRef.nativeElement;\r\n            if (firstTemplateEle !== (this.selectedTemplate && this.selectedTemplate.elementRef.nativeElement)\r\n                && firstTemplateEle !== (this.placeholderTemplate && this.placeholderTemplate.elementRef.nativeElement)\r\n                && firstTemplateEle !== (this.footerTemplate && this.footerTemplate.elementRef.nativeElement)) {\r\n                    this.itemTemplate = this.firstTemplate;\r\n            }\r\n        }\r\n    }\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterViewChecked(): void {\r\n        // 要支持searchable的动态变更，所以ngAfterViewChecked才能获知搜索框节点。\r\n        if (this.searchable !== this.oldSearchable) {\r\n            this.oldSearchable = this.searchable;\r\n            if (this.searchable) {\r\n                this.setFocusableElems(this.dominatorCom.getFocusableElems()\r\n                    .concat(this.dropsearchCom.getFocusableElems()));\r\n            } else {\r\n                this.setFocusableElems(this.dominatorCom.getFocusableElems());\r\n            }\r\n        }\r\n        if (this.pagination && this.pagination.updateFocusableElems) {\r\n            this.setFocusableElems(this.dominatorCom.getFocusableElems()\r\n                    .concat(this.dropsearchCom.getFocusableElems()));\r\n            this.pagination.updateFocusableElems = false;\r\n        }\r\n        // 上面设置好focusElems后，调用父类逻辑afterViewChecked才去设置autofocs\r\n        super.ngAfterViewChecked();\r\n\r\n    }\r\n\r\n    /**\r\n     * 切换面板开合状态\r\n     */\r\n    public toggle(): void {\r\n        if (!this.dropsearchCom.isShow) { // 面板关闭时\r\n            this.wantOpen();\r\n        } else { // 面板开时\r\n            this.close();\r\n        }\r\n    }\r\n    /**\r\n     * 打开面板\r\n     */\r\n    public open(): void {\r\n        this.dropsearchCom.show();\r\n    }\r\n    /**\r\n     * 闭合面板\r\n     */\r\n    public close(): void {\r\n        this.dropsearchCom.hide();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 处理点击Dominator事件\r\n     */\r\n    public onClickDominator(): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        this.toggle();\r\n    }\r\n    /**\r\n     * @ignore\r\n     * ti-select键盘事件处理：回车/空格情况下，展开面板\r\n     * @param event 按键事件\r\n     * @returns void\r\n     */\r\n    @HostListener('keydown', ['$event']) public onKeydown(event: KeyboardEvent): void {\r\n        if (this.disabled || this.dropsearchCom.isShow) {\r\n            return;\r\n        }\r\n        const enterKeyCodeArr: Array<number> = [TiKeymap.KEY_SPACE, TiKeymap.KEY_ENTER, TiKeymap.KEY_NUMPAD_ENTER];\r\n        if (enterKeyCodeArr.includes(event.keyCode)) {\r\n            this.wantOpen();\r\n            // 如果响应了按键，那么不再冒泡\r\n            event.stopPropagation();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 失焦情况下，仅关闭面板，不做聚焦等处理\r\n     */\r\n    public onBlur(): void {\r\n        this.dropsearchCom.hideWithoutFocus();\r\n    }\r\n    /**\r\n     *  点击或者toggle()，触发想要打开面板\r\n     */\r\n    protected wantOpen(): void {\r\n      if (this.beforeOpen.observers.length === 0) { // 无beforeOpen懒加载，直接打开\r\n            this.open();\r\n      } else { // 有beforeOpen懒加载，发出事件\r\n            this.beforeOpen.emit(this);\r\n      }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 多选带searchbox场景下，dominator中元素删除时，需要聚焦于searchbox\r\n     */\r\n    public onDeleteDominator(): void {\r\n        if (this.dropsearchCom.isShow) {\r\n            this.dropsearchCom.focus();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 触发select事件\r\n     */\r\n    public onSelect(option: any): void {\r\n        this.select.emit(option);\r\n        if (this.multiple) {\r\n            return;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 单选点击清除按钮时触发clear事件, 如果下拉中有搜索,则需要聚焦于searchbox。\r\n     */\r\n    public onClearDominator(): void {\r\n        if (this.multiple || !this.clearable) {\r\n            return;\r\n        }\r\n        this.clear.emit();\r\n        if (this.searchable && this.dropsearchCom.isShow) {\r\n            this.dropsearchCom.focus();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onBeforeSearch(): void {\r\n        this.beforeSearch.emit(this);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 10.0.2新增\r\n     *\r\n     * 获取可搜索场景下，搜索框的内容\r\n     * @returns 搜索框的内容\r\n     */\r\n    public getSearchWord(): string {\r\n        return this.dropsearchCom.searchWord;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 10.0.2新增\r\n     *\r\n     * 设置搜索结果\r\n     * @params 业务搜索后的结果，组件不再进行数据处理\r\n     */\r\n    public setSearchResult(searchResult: Array<any>): void {\r\n        this.dropsearchCom.setSearchResult(searchResult);\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiDropsearchModule } from '../dropsearch/TiDropsearchModule';\r\nimport { TiDominatorModule } from '../dominator/TiDominatorModule';\r\nimport { TiSelectComponent } from './TiSelectComponent';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDominatorModule,\r\n    TiDropModule,\r\n    TiDropsearchModule\r\n  ],\r\n  exports: [TiSelectComponent],\r\n  declarations: [TiSelectComponent]\r\n})\r\nexport class TiSelectModule {\r\n}\r\n\r\nexport { TiSelectComponent } from './TiSelectComponent';\r\n","import {\r\n  Directive,\r\n  ElementRef,\r\n  forwardRef,\r\n  Input,\r\n  Renderer2\r\n} from '@angular/core';\r\nimport { DefaultValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\n/**\r\n * TiMask 格式化数字指令\r\n *\r\n * 该指令主要用于输入框中，限制用户只能输入数字，可以通过设置tiMask属性接口设置其数字的格式：身份证，手机号码等形式输入。\r\n *\r\n * 输入框中呈现的是格式化后的数字，但是通过ngModel取得的值为纯数字的值，如输入框中呈现的值为'123 456 789'，通过ngModel取得的值为'123456789'\r\n *\r\n * <example-url>../tiny3demo/#/maskinput/maskinput-all</example-url>\r\n */\r\n@Directive({\r\n    selector: '[tiMask]',\r\n    providers: [\r\n        {// MASK_INPUT_VALUE_ACCESSOR, 原本是外部变量或者static变量，lib编译不通过\r\n            provide: NG_VALUE_ACCESSOR,\r\n            // tslint:disable-next-line:no-forward-ref\r\n            useExisting: forwardRef(() => TiMaskDirective),\r\n            multi: true\r\n        }\r\n    ],\r\n    host: {\r\n        '(input)': 'handleInput($event.target.value)',\r\n        '(compositionstart)': 'handleCompositionStart()',\r\n        '(compositionend)': 'handleCompositionEnd($event.target.value)',\r\n        '(blur)': 'blur()'\r\n    }\r\n})\r\nexport class TiMaskDirective extends DefaultValueAccessor  {\r\n    private static readonly NUM_SIGN: string = '0';\r\n    /**\r\n     * 设置其数字的格式：身份证，手机号码等形式输入，例如手机号格式：'000 0000 0000'，\r\n     * 其中 '0' 代表数字。\r\n     */\r\n    @Input('tiMask') format: string = '000 0000 0000';\r\n    private element: HTMLInputElement;\r\n    private ctxPos: any;\r\n    private valueCharPosOffset: any;\r\n    private composing: boolean = false; // 是否正在拼写拼音\r\n    private onChangeFn: Function; // 需要在registerOnChange中注册，用于改变模型值时调用\r\n    private modelValue: any;\r\n    constructor(private renderer: Renderer2, private elementRef: ElementRef) {\r\n            // super中第三个参数是DefaultValueAccessor中对文本段落(例如中文)输入的处理的一个标志位,\r\n            // 表示是否为非安卓系统，在PC端此参数为true。后续如果要处理移动端，则可能需要动态根据此参数对\r\n            // 文本段落(例如中文)输入做处理。\r\n            super(renderer, elementRef, true);\r\n            this.element = this.elementRef.nativeElement;\r\n    }\r\n\r\n    // 获取在format范围内的有效字符串\r\n    private static getClearValue(value: any, format: string): void {\r\n        const formatNumLen: number = format.replace(/[^0]/g, '').length;\r\n        let clearValue: any = value.replace(/\\D/g, '');\r\n        clearValue = clearValue.slice(0, formatNumLen);\r\n\r\n        return clearValue;\r\n    }\r\n\r\n    private static formatValue(value: any, format: string): any {\r\n        if (!value) {\r\n            return '';\r\n        }\r\n        const clearValue: any = TiMaskDirective.getClearValue(value, format);\r\n        const clearValueLen: number = clearValue.length; // value长度\r\n        let valueCharPosOffset: number = 0; // value字符位置增量\r\n        let valueCharPos: number; // 循环中的value字符位置\r\n        let newValue: any = '';\r\n        let formatChar: string;\r\n        for (let i: number = 0, len: number = format.length; i < len; i++) {\r\n            valueCharPos = i - valueCharPosOffset;\r\n            if (valueCharPos >= clearValueLen) { // value内容循环完成情况下,不进行处理\r\n                break;\r\n            }\r\n            formatChar = format[i];\r\n            if (formatChar === TiMaskDirective.NUM_SIGN) { // format字符为数字情况下的处理\r\n                newValue += clearValue[valueCharPos];\r\n            } else {\r\n                // format字符非数字情况下的处理,此时value字段中增加format字符\r\n                valueCharPosOffset++;\r\n                newValue += formatChar;\r\n            }\r\n        }\r\n\r\n        return newValue;\r\n    }\r\n\r\n    // model => view\r\n    /**\r\n     * @ignore\r\n     */\r\n    writeValue(value: any): void {\r\n        // 使用ngModel时，初始赋值第一次传入的value为null\r\n        if (value === null) {\r\n            return;\r\n        }\r\n        // format modelValue\r\n        const formatValue: any = TiMaskDirective.formatValue(value, this.format);\r\n        // Write formatted modelValue to view\r\n        super.writeValue(formatValue);\r\n        // 格式化后也需要通知修改模型值\r\n        this.modelValue = this.getAntiFormatValue(formatValue);\r\n        if (this.modelValue !== value) {\r\n            if (Util.isUndefined(this.onChangeFn)) {\r\n                // 在reactive-form中使用，初始化赋值调用writeValue时，\r\n                // 此时registerOnChange还未被调用，onChangeFn还未被赋值，\r\n                // 所以要使用setTimeout等onChangeFn被赋值后再调用\r\n                setTimeout(() => {\r\n                    this.onChangeFn(this.modelValue);\r\n                }, 0);\r\n            } else {\r\n                this.onChangeFn(this.modelValue);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    registerOnChange(fn: (value: any) => void): void { this.onChangeFn = fn; }\r\n\r\n    /**\r\n     * @ignore\r\n     * view => model\r\n     */\r\n    public handleInput(value: any): void {\r\n        if (!this.composing) {\r\n            // 在parser()中对view值进行格式化处理，再重写view的值；\r\n            this.parser(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 中文输入之前(在输入拼音前)\r\n     */\r\n    public handleCompositionStart(): void {\r\n        // 在IE和FF下中文输入法下，输入拼音时不会触发input事件，\r\n        // 但是在Chrome下，输入拼音时会触发input事件，所以针对Chrome要做特殊处理，\r\n        // 使其在输入拼音时不做格式化处理\r\n        if (TiBrowser.isChrome()) {\r\n            this.composing = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 文本段完成输入或取消输入\r\n     */\r\n    public handleCompositionEnd(value: any): void {\r\n        if (TiBrowser.isChrome()) {\r\n            this.composing = false;\r\n            // 在Chrome下compositionend比input执行滞后，\r\n           this.parser(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public blur(): void {\r\n        // 此处的onTouched继承于DefaultValueAccessor\r\n        this.onTouched();\r\n    }\r\n\r\n    private parser(value: any): void {\r\n        const formattedValue: any = TiMaskDirective.formatValue(value, this.format);\r\n        this.setCtxPos(value, this.format);\r\n        const ctxPos: number = this.ctxPos;\r\n\r\n        // 设置viewValue及光标位置\r\n        if (value !== formattedValue) {\r\n            this.renderer.setProperty(this.element, 'value', formattedValue);\r\n            // 设置光标位置：value非法及输入数字后需要变换位置情况下，需要设置光标位置\r\n            if (this.element === document.activeElement) {\r\n                this.element.setSelectionRange(ctxPos, ctxPos);\r\n            }\r\n        }\r\n        const modelValue: any = this.getAntiFormatValue(formattedValue);\r\n        if (modelValue !== this.modelValue) {\r\n            this.onChangeFn(modelValue);\r\n            this.modelValue = modelValue;\r\n        }\r\n    }\r\n\r\n    // 获取反格式化后的value\r\n    private getAntiFormatValue(formattedValue: any): any {\r\n        return formattedValue.replace(/\\D/g, '');\r\n    }\r\n\r\n    private setCtxPos(value: any, format: string): void {\r\n        // 元素有光标情况下，设置元素光标位置\r\n        this.initCtxPos();\r\n\r\n        if (!value) {\r\n            return;\r\n        }\r\n\r\n        // value非空情况下的处理\r\n        this.valueCharPosOffset = 0; // value字符位置增量\r\n        const ctxPos: number = this.ctxPos; // 初始化ctxPos，后续循环中会以此为光标位置作为对比值\r\n        for (let i: number = 0, len: number = format.length; i < len; i++) {\r\n            if (i - this.valueCharPosOffset >= value.length) { // value字符循环完成情况下,不进行后续处理\r\n                break;\r\n            }\r\n            this.setCharPos(i, value, format, ctxPos);\r\n        }\r\n    }\r\n\r\n    private setCharPos(pos: number, value: any, format: string, ctxPos: number): void {\r\n        const valueCharPos: number = pos - this.valueCharPosOffset; // 循环中的value字符位置\r\n        const valueChar: any = value[valueCharPos]; // 当前value字符\r\n        const formatChar: string = format[pos]; // 当前format字符\r\n        if (formatChar === TiMaskDirective.NUM_SIGN) { // format为数字情况下的处理\r\n            this.setPosWithNum(value, valueChar, valueCharPos, ctxPos);\r\n        } else { // format非数字情况处理\r\n            this.setPosWithoutNum(valueChar, valueCharPos, formatChar, ctxPos);\r\n        }\r\n    }\r\n\r\n    private setPosWithNum(value: any, valueChar: any, valueCharPos: number, ctxPos: number): void {\r\n        if (valueChar.match(/\\d/)) { // value字符相匹配情况下,不做处理\r\n            return;\r\n        }\r\n\r\n        // value字符不匹配情况下,光标前移，直到找到下一个数字为止\r\n        let valueCharNew: any;\r\n        for (let j: number = valueCharPos, valueLen: number = value.length; j < valueLen; j++) {\r\n            valueCharNew = value[j];\r\n            if (valueCharNew.match(/\\d/)) { // 找到value字符为数字的情况下，结束循环\r\n                return;\r\n            }\r\n\r\n            // 找到value字符非数字情况下，过滤掉该字符，光标前移，value偏移量后移，下次循环跳过该字符的检索\r\n            if (ctxPos && ctxPos >= j + 1) {\r\n                this.ctxPos--;\r\n            }\r\n            this.valueCharPosOffset--;\r\n        }\r\n    }\r\n\r\n    private setPosWithoutNum(valueChar: any, valueCharPos: number, formatChar: string, ctxPos: number): void {\r\n        // value为数字情况下,value偏移量前移,确保下次循环依然为该value字符\r\n        if (valueChar.match(/\\d/)) {\r\n            this.valueCharPosOffset++;\r\n            if (ctxPos && ctxPos >= valueCharPos + 1) {\r\n                this.ctxPos++;\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // value非数字且不匹配format字符情况下,过滤掉该字符,下次继续循环下个value字符\r\n        if ((valueChar !== formatChar) &&\r\n            (ctxPos && ctxPos >= valueCharPos + 1)) {\r\n            this.ctxPos--;\r\n        }\r\n    }\r\n\r\n    private initCtxPos(): void {\r\n        let ctxPositon: number;\r\n        if (this.element === document.activeElement) {\r\n            ctxPositon = this.element.selectionStart;\r\n        }\r\n        this.ctxPos = ctxPositon;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiMaskDirective } from './TiMaskDirective';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [TiMaskDirective],\r\n  declarations: [TiMaskDirective]\r\n})\r\nexport class TiMaskModule {\r\n}\r\nexport { TiMaskDirective } from './TiMaskDirective';\r\n","/* tslint:disable:no-implicit-dependencies */\r\nimport { NgControl } from '@angular/forms';\r\nimport { ElementRef } from '@angular/core';\r\nimport { TiValidationConfig } from '../TiValidationInterface';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class CheckHandle {\r\n    constructor(protected validationConf: TiValidationConfig, protected commonHandle: any) {\r\n    }\r\n    onStatusChange(ele: ElementRef, formControl: NgControl): void {\r\n    }\r\n    onFocus(ele: ElementRef, formControl: NgControl): void {\r\n    }\r\n    onBlur(ele: ElementRef, formControl: NgControl): void {\r\n    }\r\n    destroy(ele: ElementRef): void {\r\n        this.commonHandle.destroyTip(ele);\r\n    }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\nimport { TiBaseComponent } from '../../components/base/TiBaseModule';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-pending-state',\r\n    templateUrl: './pending-state.html',\r\n    styleUrls: ['./pending-state.less'],\r\n    host: {\r\n        '[class.ti3-validation-pending-container]': 'true'\r\n    }\r\n})\r\nexport class TiPendingStateComponent extends TiBaseComponent {\r\n    // 校验元素\r\n    @Input() validElement: any;\r\n\r\n    ngOnInit(): void {\r\n        this.renderer.addClass(this.validElement, 'ti3-text-input-show-pending');\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.validElement) {\r\n            this.renderer.removeClass(this.validElement, 'ti3-text-input-show-pending');\r\n        }\r\n    }\r\n}\r\n","import { Util } from '../../../utils/Util';\r\nimport { CheckHandle } from './CheckHandle';\r\nimport { NgControl, ValidationErrors } from '@angular/forms';\r\nimport { ComponentRef, ElementRef } from '@angular/core';\r\nimport { TiPendingStateComponent } from '../TiPendingStateComponent';\r\n\r\n/**\r\n * @ignore\r\n *\r\n * 10.1.0新增\r\n */\r\nexport class AsyncCheck extends CheckHandle {\r\n    // 处理异步校验错误提示信息\r\n    public onStatusChange(ele: ElementRef, formControl: NgControl): void {\r\n        // 清除先前校验信息\r\n        this.commonHandle.clearValidMsg(ele);\r\n\r\n        const errors: ValidationErrors = formControl.control.errors;\r\n        if (!errors) {\r\n            return;\r\n        }\r\n\r\n        const ruleKey: string = Object.keys(errors)[0];\r\n        const ruleErrors: any = errors[ruleKey];\r\n        // 添加异步校验错误提示信息\r\n        if (typeof ruleErrors === 'object' && Util.isString(ruleErrors.tiAsyncErrorMessage)) {\r\n            this.commonHandle.addValidMsg(ele, this.validationConf, formControl, true);\r\n        }\r\n    }\r\n\r\n    // 处理异步校验pending状态时的loading图标\r\n    public onAsyncStatusChange(ele: ElementRef, formControl: NgControl): void {\r\n        if (formControl.pending) {\r\n            this.addPendingIcon(ele, formControl);\r\n        } else {\r\n            this.clearPendingIcon(ele);\r\n        }\r\n    }\r\n\r\n    public addPendingIcon(ele: ElementRef, formControl: NgControl): void {\r\n        if (ele.nativeElement.tiPendingStateRef) {\r\n            return;\r\n        }\r\n        const pendingStateRef: ComponentRef<any> = this.getPendingStateRef(ele);\r\n        const pendingDom: Element = pendingStateRef.location.nativeElement;\r\n        if (pendingDom === null || pendingDom.childNodes.length === 0) {\r\n            return;\r\n        }\r\n        this.commonHandle._tiRenderer.insertAfter(pendingDom, ele.nativeElement);\r\n\r\n        ele.nativeElement.tiPendingStateRef = pendingStateRef;\r\n    }\r\n\r\n    public clearPendingIcon(ele: ElementRef): void {\r\n        const pendingStateRef: ComponentRef<any>  = ele.nativeElement.tiPendingStateRef;\r\n        if (pendingStateRef) {\r\n            pendingStateRef.destroy();\r\n            ele.nativeElement.tiPendingStateRef = undefined;\r\n        }\r\n    }\r\n\r\n    private getPendingStateRef(ele: ElementRef): ComponentRef<any> {\r\n        const pendignComponentRef: ComponentRef<any> = this.commonHandle._tiPopupService.createCompoentRef({\r\n            componentType: TiPendingStateComponent,\r\n            context: {\r\n                validElement: ele.nativeElement\r\n            }\r\n        });\r\n\r\n        return pendignComponentRef;\r\n    }\r\n}\r\n","import { Util } from '../../../utils/Util';\r\nimport { AsyncCheck } from './AsyncCheck';\r\nimport { NgControl, ValidationErrors } from '@angular/forms';\r\nimport { ElementRef } from '@angular/core';\r\nimport { TiValidationConfig } from '../TiValidationInterface';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class ChangeCheck extends AsyncCheck {\r\n    public onStatusChange(ele: ElementRef, formControl: NgControl): void {\r\n        super.onStatusChange(ele, formControl);\r\n        this._checkHandle(ele, this.validationConf, formControl);\r\n    }\r\n    public onFocus(ele: ElementRef, formControl: NgControl): void {\r\n        this._checkHandle(ele, this.validationConf, formControl);\r\n    }\r\n    public onBlur(ele: ElementRef, formControl: NgControl): void {\r\n        // 清除先前校验信息,已失焦情况不做校验提示或tip提示,只边框标红,边框标红在样式类中通过ng-invalid处理\r\n        this.commonHandle.destroyTip(ele);\r\n    }\r\n\r\n    // 校验处理函数,该函数覆盖了focus和statusChange状态下的校验处理\r\n    private _checkHandle(ele: ElementRef, validationConf: TiValidationConfig, formControl: NgControl): void {\r\n        this.commonHandle.destroyTip(ele); // 清除先前校验信息\r\n        // 已失焦情况不做校验提示或tip提示,只边框标红,边框标红只在样式类中通过ng-invalid处理,JS中无需处理\r\n        if (!this.commonHandle.isFocused(ele)) {\r\n            return;\r\n        }\r\n\r\n        // 三种情况只做Tip提示：\r\n        // 1.初次focus且初次focus情况下输入值未发生改变时不进行校验\r\n        //   (初次focus值一旦发生变化且出错情况下,就要改变为错误提示)\r\n        // 2.校验正确\r\n        // 3.是弹窗中autofocus的元素\r\n        // （弹窗中autofocus的元素，在弹窗打开动画结束后会先blur再focus,会使其由untouched变成touched,\r\n        // 但需要使其表现与初次focus一致）\r\n        const errors: ValidationErrors = formControl.control.errors;\r\n        if ((formControl.pristine && formControl.untouched) || errors === null ||\r\n            ele.nativeElement.querySelector('[tiautofocusinmodal]')) {\r\n            this._addTip(ele, validationConf, validationConf && validationConf.tip);\r\n\r\n            return;\r\n        }\r\n        // 其它情况下做错误提示\r\n        this._addValidTip(ele, errors, validationConf);\r\n    }\r\n\r\n    // 显示错误提示信息\r\n    private _addValidTip(ele: ElementRef, errors: ValidationErrors, validationConf: TiValidationConfig): void {\r\n        const tipContentDom: any = this.commonHandle.getErrorMsg(errors, validationConf);\r\n        if (tipContentDom === null) {// 无错误信息情况下,不做处理\r\n            return;\r\n        }\r\n        this._addTip(ele, validationConf, tipContentDom);\r\n    }\r\n\r\n    // 显示tip提示\r\n    private _addTip(ele: ElementRef, validationConf: TiValidationConfig, tipContent: string): /* ViewContainerData */void {\r\n        // tip内容无效情况下不做处理\r\n        if (tipContent === '' || Util.isUndefined(tipContent)) {\r\n            return;\r\n        }\r\n        // 添加Tip提示\r\n        this.commonHandle.generateTip(ele, tipContent, validationConf);\r\n    }\r\n}\r\n","import { Util } from '../../../utils/Util';\r\nimport { CheckHandle } from './CheckHandle';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { NgControl } from '@angular/forms';\r\nimport { ElementRef } from '@angular/core';\r\nimport { TiValidationConfig } from '../TiValidationInterface';\r\n/**\r\n * @ignore\r\n */\r\nexport class BlurCheck extends CheckHandle {\r\n    public onStatusChange(ele: ElementRef, formControl: NgControl): void {\r\n        if (this.commonHandle.isFocused(ele)) {// 获取焦点/正在输入情况下,显示/修改tip提示\r\n            this.addTip(ele, this.validationConf, formControl);\r\n\r\n            return;\r\n        }\r\n        // 未输入过且未聚焦的情况下,先清除先前校验信息(存在reset即改变untounced状态情况下清除校验信息)\r\n        if (formControl.untouched) {\r\n            this.commonHandle.clearValidMsg(ele); // 清除先前校验信息\r\n\r\n            return;\r\n        }\r\n        // 失焦情况下,根据校验结果,显示/清除错误提示\r\n        this.commonHandle.clearValidMsg(ele); // 清除先前校验信息\r\n        this.commonHandle.addValidMsg(ele, this.validationConf, formControl);\r\n    }\r\n    public onFocus(ele: ElementRef, formControl: NgControl): void {\r\n        this.commonHandle.clearValidMsg(ele); // 清除先前错误提示信息\r\n        this.addTip(ele, this.validationConf, formControl);\r\n    }\r\n    public onBlur(ele: ElementRef, formControl: NgControl): void {\r\n        this.commonHandle.destroyTip(ele); // 清除先前校验信息\r\n        this.commonHandle.addValidMsg(ele, this.validationConf, formControl);\r\n    }\r\n\r\n    public addTip(ele: ElementRef, validationConf: TiValidationConfig, formControl: NgControl): void {// 该方法子类会复写\r\n        this.commonHandle.destroyTip(ele); // 清除先前tip提示信息\r\n        const tipContent: string = validationConf && validationConf.tip;\r\n        // tip内容无效情况下不做处理\r\n        if (tipContent === '' || Util.isUndefined(tipContent)) {\r\n            return;\r\n        }\r\n        // 添加Tip提示并缓存\r\n        this.commonHandle.generateTip(ele, tipContent, validationConf);\r\n    }\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { FormControl, ValidationErrors } from '@angular/forms';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\n/**\r\n * @ignore\r\n */\r\nexport interface MsgItem {\r\n  msg: string;\r\n  validStatus: any;\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport interface MsgModel {\r\n  level: number;\r\n  msgItems: Array<MsgItem>;\r\n  securityText: string;\r\n  securityStatus: string;\r\n}\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n  selector: 'ti-pwd-msg',\r\n  templateUrl: './TiPwdMsgComponent.html',\r\n  styleUrls: ['./pwdMsg.less']\r\n})\r\nexport class TiPwdMsgComponent implements OnInit {\r\n  @Input() control: FormControl;\r\n  @Input() msgItems: Array<MsgItem>;\r\n  @Input() validator: any;\r\n  @Input() levelFn: Function;\r\n  public msgModel: MsgModel = {\r\n    level: -1,\r\n    msgItems: [],\r\n    securityText: '',\r\n    securityStatus: ''\r\n  };\r\n\r\n  private static _getPwdStrengthLan(key: string): string {\r\n    return (TiLocale.getLocaleWords() as TiLocaleWords).tiValid.passwordStrength[key];\r\n  }\r\n\r\n  // 获取各项规则提示\r\n  private static _getMsgItems(msgObj: any, control: FormControl): Array<any> {\r\n      let validStatus: number|boolean;\r\n      if (control.untouched && control.pristine) { // 初次聚焦,未输入情况下，不校验\r\n          validStatus = -1;\r\n      }\r\n\r\n      const msgInfoArr: Array<any> = [];\r\n      let msgItem: string = '';\r\n      for (const key in msgObj) {\r\n        if (msgObj.hasOwnProperty(key)) {\r\n          msgItem = msgObj[key];\r\n          msgInfoArr.push({\r\n              msg: msgItem,\r\n              validStatus: TiPwdMsgComponent._getValidStatus(validStatus, key, control)\r\n          });\r\n        }\r\n      }\r\n\r\n      return msgInfoArr;\r\n  }\r\n\r\n  private static _getValidStatus(validStatus: number|boolean, key: string, control: FormControl): number|boolean {\r\n    const errors: ValidationErrors | null = control.errors;\r\n    // validStatus已定义情况下，直接返回\r\n    if (!Util.isUndefined(validStatus)) {\r\n      return validStatus;\r\n    }\r\n    // errors中有该条消息，说明校验未通过\r\n    if (errors && !Util.isUndefined(errors[key])) {\r\n      return false;\r\n    }\r\n    // 值为空的情况下，除notEqualPosRev外，其他规则均为错误\r\n    if (control.value === '' && key !== 'notEqualPosRev') {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * 获取密码强度等级\r\n   * @param value 输入值\r\n   * @param validator 校验规则配置\r\n   * @param levelFn 密码等级计算函数\r\n   * @returns  密码强度等级\r\n   */\r\n  private static _getLevel(value: string, validator: any, levelFn: Function): number {\r\n    return levelFn(value, validator);\r\n  }\r\n  ngOnInit(): void {\r\n    const value: string = this.control.value;\r\n    // level计算\r\n    let level: number = -1;\r\n    if (!(value === null || value.length === 0)) { // value值为空情况下,level无效处理\r\n        level = TiPwdMsgComponent._getLevel(value, this.validator, this.levelFn);\r\n    }\r\n\r\n    // 设置呈现时需要使用的字段\r\n    this.msgModel = {\r\n        level,\r\n        msgItems: TiPwdMsgComponent._getMsgItems(this.msgItems, this.control),\r\n        securityText: TiPwdMsgComponent._getPwdStrengthLan('securityText'),\r\n        securityStatus: level === -1 ? '' : TiPwdMsgComponent._getPwdStrengthLan('levelDecArr')[level]\r\n    };\r\n  }\r\n}\r\n","import { Util } from '../../../utils/Util';\r\nimport { TiPasswordValidatorConfig } from '../TiValidationInterface';\r\n/**\r\n * @ignore\r\n */\r\nexport interface TiPwdParams {\r\n    minCharLen: number;\r\n    minCharTypeNum: number;\r\n    charTypeRegObj: any;\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class TiPwdConfig {\r\n    public static pwdTipPostion: string = 'right';\r\n    public static pwdTipMaxWidth: string = '440px';\r\n    // pwd校验规则\r\n    public static pwdCharTypeRegObj: any = {// 默认字串类型集合,特殊规则可在此处进行配置\r\n        // specialCharReg: /[~`!\\?,.:;\\-_'\"\\(\\)\\{\\}\\[\\]\\/<>@#\\$%\\^&\\*\\+\\|\\\\=\\s]/,\r\n        // https://www.bejson.com/zhuanyi/ Json转义工具有错，单引号未转义\r\n        specialCharReg: new RegExp('[~`!\\\\?,.:;\\\\-_\\'\\\"\\\\(\\\\)\\\\{\\\\}\\\\[\\\\]\\\\/<>@#\\\\$%\\\\^&\\\\*\\\\+\\\\|\\\\\\\\=\\\\s]'),\r\n        lowerCharReg: new RegExp('[a-z]+'),\r\n        upperCharReg: new RegExp('[A-Z]+'),\r\n        digitsCharReg: new RegExp('[0-9]+')\r\n    };\r\n    public static pwdValidator: any = {\r\n        rule: 'password',\r\n        params: {\r\n            rangeSize: [6, 32],\r\n            minCharType: [2] // 该校验方法支持两个参数传递,第二个参数为charTypeRegObj,不传递第二个参数情况下,代表使用该配置中的默认值\r\n        },\r\n        message: {\r\n            rangeSize: '', // ''代表使用组件国际化语言中的默认提示文本\r\n            minCharType: '',\r\n            notEqualPosRev: ''\r\n        }\r\n    };\r\n    // /**\r\n    //  * 计算密码熵值,具体的计算密码熵值的算法如下：\r\n    //  * 1、第一个字符为4bits\r\n    //  * 2、2-8个字符，每一个字符为2bits\r\n    //  * 3、9-20个字符之间，每一个字符为1.5bits\r\n    //  * 4、21个字符之后，每一个字符为1bit\r\n    //  * 5、如果密码中同时存在大写字母和特殊字符，则熵值+6\r\n    //  * @param {String} str 密码字串\r\n    //  * @param {Number} minLen 密码最小长度\r\n    //  * @param {Number} minType 密码最小组合种类\r\n    //  * @returns {Number} level 密码等级\r\n    //  */\r\n    public static pwdLevelFn(value: string, validator: TiPasswordValidatorConfig): number {\r\n        const validatorParam: TiPwdParams = getValidatorParam();\r\n        const minCharLen: number = validatorParam.minCharLen;\r\n        const minCharTypeNum: number = validatorParam.minCharTypeNum;\r\n        const charTypeRegObj: any = validatorParam.charTypeRegObj as any;\r\n        // 根据字符个数初步计算熵值\r\n        const len: number = value.length;\r\n        let pwdScore: number = 0;\r\n        if (len >= 21) {\r\n            pwdScore = (len - 21) + 1.5 * 12 + 2 * 7 + 4;\r\n        } else if (len >= 9 && len < 21) {\r\n            pwdScore = (len - 9 + 1) * 1.5 + 2 * 7 + 4;\r\n        } else if (len >= 2 && len < 9) {\r\n            pwdScore = (len - 2 + 1) * 2 + 4;\r\n        } else if (len >= 1 && len < 2) {\r\n            pwdScore = 4;\r\n        }\r\n        // 同时存在大写字母和特殊字符，熵值+6\r\n        if (charTypeRegObj.upperCharReg &&\r\n            charTypeRegObj.upperCharReg.test(value) &&\r\n            charTypeRegObj.specialCharReg.test(value)) {\r\n            pwdScore += 6;\r\n\r\n            // 重置正则表达式的lastIndex属性:只有正则表达式使用了表示全局检索的 \"g\" 标志时，该属性才会起作用，\r\n            // 当前正则匹配到字串后，下次使用同样的正则匹配该字串时，正则检查位置会发生变化\r\n            charTypeRegObj.upperCharReg.lastIndex = 0;\r\n            charTypeRegObj.specialCharReg.lastIndex = 0;\r\n        }\r\n\r\n        // 根据熵值计算等级\r\n        return countLevel(pwdScore);\r\n\r\n        function getValidatorParam(): TiPwdParams {\r\n            const params: any = validator.params;\r\n            // 默认值设定\r\n            let minCharLength: number = 0;\r\n            let minCharTypeNumber: number = 0;\r\n            let charTypeRegObject: any = {// 默认字串类型集合,特殊规则可在此处进行配置\r\n                specialCharReg: /[~`!\\?,.:;\\-_'\"\\(\\)\\{\\}\\[\\]\\/<>@#\\$%\\^&\\*\\+\\|\\\\=\\s]/,\r\n                lowerCharReg: /[a-z]+/,\r\n                upperCharReg: /[A-Z]+/,\r\n                digitsCharReg: /[0-9]+/\r\n            };\r\n\r\n            // 通过rangeSize规则获取最小长度\r\n            const rangeSizeParams: number = params.rangeSize;\r\n            if (!Util.isUndefined(rangeSizeParams)) {\r\n                minCharLength = parseInt(rangeSizeParams[0], 10) || 0;\r\n            }\r\n            // 通过minCharType规则获取最小字符类型及其正则\r\n            const minCharTypeParams: number = params.minCharType;\r\n            if (!Util.isUndefined(minCharTypeParams)) {\r\n                minCharTypeNumber = parseInt(minCharTypeParams[0], 10) || 0;\r\n                charTypeRegObject = minCharTypeParams[1] || charTypeRegObject;\r\n            }\r\n\r\n            // 返回对象值\r\n            return {\r\n                minCharLen: minCharLength,\r\n                minCharTypeNum: minCharTypeNumber,\r\n                charTypeRegObj: charTypeRegObject\r\n            };\r\n        }\r\n\r\n        /**\r\n         * 计算密码等级\r\n         * 低： 0~25.5（ 小于等于25 .5）\r\n         * 中： 25.5~30(大于25 .5 小于等于30)\r\n         * 高： 30~（大于30）\r\n         * @param score 密码分数\r\n         * @returns 密码等级\r\n         */\r\n        function countLevel(score: number): number {\r\n            let level: number = 0;\r\n            if (score > 30) {\r\n                level = 2;\r\n            } else if (score > 25.5 && score <= 30) {\r\n                level = 1;\r\n            } else if (score >= 0 && score <= 25.5) {\r\n                level = 0;\r\n            }\r\n            level = levelHandle(minCharLen, minCharTypeNum, level);\r\n\r\n            return level;\r\n        }\r\n\r\n        // 密码降级处理\r\n        function levelHandle(psdLen: number, psdType: number, level: number): number {\r\n            const type: number = getCharType(value);\r\n            let pwdLevel: number = level;\r\n            if (level > 0) {\r\n                if ((psdLen && len < psdLen) || (psdType && type < psdType)) {\r\n                    pwdLevel = level - 1;\r\n                }\r\n            }\r\n\r\n            return pwdLevel;\r\n        }\r\n\r\n        // 获取当前密码字符种类\r\n        function getCharType(str: string): number {\r\n            let typeNum: number = 0;\r\n            for (const key in charTypeRegObj) {\r\n                if (charTypeRegObj.hasOwnProperty(key)) {\r\n                    const regExp: RegExp = charTypeRegObj[key];\r\n                    if (regExp.test(str)) {\r\n                        typeNum++;\r\n                        regExp.lastIndex = 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return typeNum;\r\n        }\r\n    }\r\n}\r\n","import { TiPwdConfig } from './checkHandle/TiPwdConfig';\r\nimport { TiPositionType } from '../../utils/Position';\r\n// 定义组件默认配置参数\r\n/**\r\n * @ignore\r\n */\r\nexport class TiValidationDefaultConfig extends TiPwdConfig {\r\n    // 默认校验方式\r\n    public static type: 'change'|'blur'|'password' = 'change';\r\n    public static tipPosition: TiPositionType = 'right';\r\n}\r\n","import { Util } from '../../../utils/Util';\r\nimport { TiPwdMsgComponent } from '../TiPwdMsgComponent';\r\nimport { BlurCheck } from './BlurCheck';\r\nimport { CheckHandle } from './CheckHandle';\r\nimport { TiValidationDefaultConfig } from '../TiValidationConfig';\r\nimport { TiPasswordValidatorConfig, TiValidationConfig } from '../TiValidationInterface';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { NgControl } from '@angular/forms';\r\nimport { ElementRef } from '@angular/core';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class PwdCheck extends BlurCheck implements CheckHandle {\r\n    private msgItems: any;\r\n    private validator: TiPasswordValidatorConfig;\r\n    private levelFn: (value: string, validator: TiPasswordValidatorConfig) => void;\r\n    constructor(private config: TiValidationConfig, private common: any) {\r\n        super(config, common);\r\n        const pwdConfig: any = this.config && this.config.passwordConfig;\r\n        // 设置参数，用于规则提示组件数据组装\r\n        this._setValidator(pwdConfig);\r\n        this._setMsgItems();\r\n        this._setLevelFn(pwdConfig);\r\n    }\r\n\r\n    onFocus(ele: ElementRef, formControl: NgControl): void {\r\n        // 由于密码组件需要依赖于其他输入框，因此在focus时需要更新其状态\r\n        formControl.control.updateValueAndValidity();\r\n        super.onFocus(ele, formControl);\r\n    }\r\n\r\n    // 设置validator params和msg\r\n    private _setValidator(pwdConfig: any): void {\r\n        let pwdValidator: any = TiValidationDefaultConfig.pwdValidator;\r\n        if (pwdConfig && pwdConfig.validator) {// validator定义情况下,处理validator\r\n            const pwdValidatorConfig: TiPasswordValidatorConfig = pwdConfig.validator;\r\n            if (Util.isUndefined(pwdValidatorConfig.rule) ||\r\n                pwdValidatorConfig.rule === pwdValidator.rule) { // 依然使用默认规则情况下,只做参数合并\r\n                pwdValidator = {\r\n                    params: {...pwdValidator.params, ...pwdValidatorConfig.params},\r\n                    message: {...pwdValidator.message, ...pwdValidatorConfig.message}\r\n                };\r\n            } else {\r\n                pwdValidator = {\r\n                    params: pwdValidatorConfig.params,\r\n                    message: pwdValidatorConfig.message\r\n                };\r\n            }\r\n        }\r\n        this.validator = pwdValidator;\r\n    }\r\n\r\n    // 设置msgItems,msgItems数据格式为:{ruleKey: msgStr,...}\r\n    // 其中msgStr为格式化后的页面可显示字串\r\n    private _setMsgItems(): void {\r\n        const validatorConfig: TiPasswordValidatorConfig = this.validator;\r\n        const msgConfig: any = validatorConfig.message;\r\n        const paramsConfig: any = validatorConfig.params;\r\n        let msgStr: string;\r\n        const msgItems: any = {};\r\n        // msgConfig中定义的规则提示才会在页面中显示\r\n        for (const key in msgConfig) {\r\n            if (msgConfig.hasOwnProperty(key)) {\r\n                // 规则提示优先从config中读取,如果读取到的是无效字串,则从国际化默认配置中读取\r\n                msgStr = msgConfig[key] || this.common.getMsg(key);\r\n                // 如果对应的规则有参数的情况下,则根据参数做字串格式化\r\n                if (paramsConfig && paramsConfig.hasOwnProperty(key)) {\r\n                    msgStr = Util.formatEntry(msgStr, paramsConfig[key]);\r\n                }\r\n                msgItems[key] = msgStr;\r\n            }\r\n        }\r\n        this.msgItems = msgItems;\r\n    }\r\n\r\n    // 设置levelFn:levelFn支持业务自定义\r\n    private _setLevelFn(pwdConfig: any): void {\r\n        let levelFn: (value: string, validator: TiPasswordValidatorConfig) => void = TiValidationDefaultConfig.pwdLevelFn;\r\n        if (pwdConfig && Util.isFunction(pwdConfig.levelFn)) {\r\n            levelFn = pwdConfig.levelFn;\r\n        }\r\n        this.levelFn = levelFn;\r\n    }\r\n    public addTip(ele: ElementRef, validationConf: TiValidationConfig, formControl: NgControl): void {\r\n        this.commonHandle.destroyTip(ele); // 清除先前提示信息\r\n        const inputsObj: any = {\r\n            msgItems: this.msgItems,\r\n            validator: this.validator,\r\n            control: formControl,\r\n            levelFn: this.levelFn\r\n        };\r\n        // tip默认值设置\r\n        const configAssigned: TiValidationDefaultConfig = {\r\n            tipPosition: TiValidationDefaultConfig.pwdTipPostion,\r\n            tipMaxWidth: TiValidationDefaultConfig.pwdTipMaxWidth,\r\n            ...validationConf};\r\n        this.common.generateTip(ele, TiPwdMsgComponent, configAssigned, inputsObj);\r\n    }\r\n}\r\n","import { Component, Input, ViewEncapsulation } from '@angular/core';\r\nimport { TiBaseComponent } from '../../components/base/TiBaseModule';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-error-msg',\r\n    template: `\r\n        <span class=\"ti3-error-icon-bg\">\r\n            <span class='ti3-error-icon ti3-icon ti3-icon-alert-warn'></span>\r\n        </span>\r\n        <span class=\"ti3-validate-text\" [innerHTML]=\"errorMessage\"></span>\r\n    `,\r\n    styleUrls: ['./errorMsg.less'],\r\n    encapsulation: ViewEncapsulation.None, // 由于样式文件中存在全局样式，因此使用该方式\r\n    host: {\r\n        '[class.ti3-unifyvalid-error-container]': 'isAppendBody',\r\n        '[class.ti3-unifyvalid-tip-error-container]': 'true'\r\n    }\r\n})\r\nexport class TiErrorMsgComponent extends TiBaseComponent {\r\n    @Input() errorMessage: string;\r\n    @Input() isAppendBody: boolean;\r\n}\r\n","import { NgModule } from '@angular/core';\r\n// 命名含有Service的Module，都不是对外暴露的Service，是内部使用。外部使用此Service，导入TiDragModule即可\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n})\r\nexport class CommonServiceModule {\r\n}\r\n","import { ComponentRef, ElementRef, Injectable, Renderer2 } from '@angular/core';\r\nimport { TiLocale, TiLocaleWords } from '../../../locale/TiLocaleModule';\r\nimport { TiRenderer } from '../../../services/renderer/TiRenderer';\r\nimport { TiPopupService } from '../../../services/popup/TiPopupService';\r\nimport { Util } from '../../../utils/Util';\r\nimport { TiTipService } from '../../../services/tip/TiTipService';\r\nimport { TiTipRef } from '../../../services/tip/TiTipInterface';\r\nimport { TiValidationDefaultConfig } from '../TiValidationConfig';\r\nimport { TiValidationConfig } from '../TiValidationInterface';\r\nimport { TiErrorMsgComponent } from '../TiErrorMsgComponent';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { NgControl, ValidationErrors } from '@angular/forms';\r\nimport { CommonServiceModule } from './CommonServiceModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Injectable({\r\n    providedIn: CommonServiceModule\r\n})\r\nexport class CommonService {\r\n    constructor(private _renderer: Renderer2,\r\n                private _tiRenderer: TiRenderer,\r\n                private _tipService: TiTipService,\r\n                private _tiPopupService: TiPopupService<TiErrorMsgComponent>) {\r\n    }\r\n\r\n    // 获取错误信息源字串\r\n    private static _getSourceStr(ruleKey: string, ruleErrors: any, validationConf: TiValidationConfig, isAsync: boolean): string {\r\n        // 优先使用tiValidation中的规则项配置errorMsg\r\n        const errMsgConf: any = validationConf && validationConf.errorMessage;\r\n        if (!Util.isUndefined(errMsgConf) && Util.isString(errMsgConf[ruleKey])) {\r\n            return errMsgConf[ruleKey];\r\n        }\r\n\r\n        if (typeof ruleErrors === 'object') {\r\n            // 获取自定义校验规则中的 tiErrorMsg\r\n            if (!isAsync && Util.isString(ruleErrors.tiErrorMessage)) {\r\n                return ruleErrors.tiErrorMessage;\r\n            }\r\n\r\n            // 获取自定义异步校验规则中的 tiAsyncErrorMessage\r\n            if (isAsync && Util.isString(ruleErrors.tiAsyncErrorMessage)) {\r\n                return ruleErrors.tiAsyncErrorMessage;\r\n            }\r\n        }\r\n\r\n        // 获取到的tiValidation errorMsg无效情况下,使用默认规则提示\r\n        return (TiLocale.getLocaleWords() as TiLocaleWords).tiValid.errorMsg[ruleKey] || '';\r\n    }\r\n\r\n    // 获取错误提示字符串，思路是：\r\n    // 1.先获取错误信息源字串（可能带params标识{0}/{1}等）;\r\n    // 2.将获取的源字串中的参数替换为真实数据\r\n    private static _getErrorStr(errors: ValidationErrors, validationConf: TiValidationConfig, isAsync: boolean): string {\r\n        const ruleKey: string = Object.keys(errors)[0];\r\n        const ruleErrors: any = errors[ruleKey];\r\n        const msgStr: string = CommonService._getSourceStr(ruleKey, ruleErrors, validationConf, isAsync);\r\n        // 获取错误信息参数,无参数情况下,不需做格式匹配直接返回\r\n        // errors格式示例：{required:true,{'maxlength': {'requiredLength': maxLength, 'actualLength': length}}}\r\n        if ((typeof ruleErrors) !== 'object') {\r\n            return msgStr;\r\n        }\r\n        const params: Array<string> = Object.values(ruleErrors); // 此处对错误信息定义有要求：要求错误返回对象与词条中的参数次序与一致\r\n\r\n        return Util.formatEntry(msgStr, params);\r\n    }\r\n    public isFocused(ele: any): boolean {\r\n        return ele.nativeElement.attributes.tiFocused !== undefined;\r\n    }\r\n    // 获取密码校验中校验规则信息\r\n    public getMsg(ruleKey: string, params: any): string {\r\n        const messageStr: string = (TiLocale.getLocaleWords() as TiLocaleWords).tiValid.message[ruleKey];\r\n\r\n        return Util.formatEntry(messageStr, params);\r\n    }\r\n    // 获取错误提示信息DOM文本，此处TiErrorMsgComponent组件处理的不仅是提示信息，还包括错误时的组件边框变红样式加载\r\n    public getErrorMsg(errors: ValidationErrors, validationConf: TiValidationConfig, isAppendBody: boolean = false, isAsync?: boolean): Element {\r\n        const errorMsg: string = CommonService._getErrorStr(errors, validationConf, isAsync);\r\n        if (!errorMsg) {\r\n            return null;\r\n        }\r\n        const errorMsgComponentRef: ComponentRef<any> = this._tiPopupService.createCompoentRef({\r\n            componentType: TiErrorMsgComponent,\r\n            context: {\r\n                errorMessage: errorMsg,\r\n                isAppendBody\r\n            }\r\n        });\r\n\r\n        return errorMsgComponentRef.location.nativeElement;\r\n    }\r\n\r\n    // 调用ti-Tip组件生成Tip提示,该公共方法中同时传递了tip的位置信息等\r\n    public generateTip(ele: ElementRef, tipContent: string, validationConf: TiValidationConfig, context?: any): TiTipRef {\r\n        const tipInstance: TiTipRef = this._tipService.create(ele.nativeElement, {\r\n            position: validationConf.tipPosition || TiValidationDefaultConfig.tipPosition,\r\n            maxWidth: validationConf.tipMaxWidth\r\n        });\r\n        tipInstance.show(tipContent, context);\r\n        ele.nativeElement.tiValidTip = tipInstance;\r\n\r\n        return tipInstance;\r\n    }\r\n    // 销毁Tip提示\r\n    public destroyTip(ele: ElementRef): void {\r\n        const tipEle: TiTipRef = ele.nativeElement.tiValidTip;\r\n        if (!Util.isUndefined(tipEle)) {\r\n            tipEle.hide();\r\n        }\r\n    }\r\n    // 根据errors结果生成可占位的错误提示信息(blurCheck和pwdCheck中使用)\r\n    public addValidMsg(ele: ElementRef, validationConf: TiValidationConfig, formControl: NgControl, isAsync?: boolean): void {\r\n        const errors: ValidationErrors = formControl.control.errors;\r\n        // 校验正确情况下不做处理\r\n        if (errors === null) {\r\n            return;\r\n        }\r\n        const errorDom: Element = this.getErrorMsg(errors, validationConf, true, isAsync);\r\n        if (errorDom === null || errorDom.childNodes.length === 0) {\r\n            return;\r\n        }\r\n        // 添加错误信息\r\n        if (validationConf && validationConf.errorMessageWrapper) {\r\n            this._renderer.appendChild(validationConf.errorMessageWrapper, errorDom);\r\n        } else if (ele.nativeElement.hasAttribute('tiTextarea')) {\r\n            this._tiRenderer.insertAfter(errorDom, this._renderer.parentNode(ele.nativeElement));\r\n        } else {\r\n            this._tiRenderer.insertAfter(errorDom, ele.nativeElement);\r\n        }\r\n        ele.nativeElement.tiErrorMessage = errorDom;\r\n    }\r\n    // 销毁可占位的错误提示信息(blurCheck和pwdCheck中使用)\r\n    public clearValidMsg(ele: ElementRef): void {\r\n        const errMsgDom: any  = ele.nativeElement.tiErrorMessage;\r\n        if (!Util.isUndefined(errMsgDom)) {\r\n            this._renderer.removeChild(errMsgDom.parentNode, errMsgDom);\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonServiceModule } from './CommonServiceModule';\r\n// 命名含有Service的Module，都不是对外暴露的Service，是内部使用。外部使用此Service，导入TiDragModule即可\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonServiceModule\r\n  ]\r\n})\r\nexport class CheckStyleModule {\r\n}\r\n","// 该功能类用于根据校验方式定义校验实体执行函数\r\nimport { Injectable } from '@angular/core';\r\nimport { ChangeCheck } from './ChangeCheck';\r\nimport { BlurCheck } from './BlurCheck';\r\nimport { PwdCheck } from './PwdCheck';\r\nimport { CommonService } from './CommonService';\r\nimport { TiValidationDefaultConfig } from '../TiValidationConfig';\r\nimport { Util } from '../../../utils/Util';\r\nimport { TiValidationConfig, TiValidationType } from '../TiValidationInterface';\r\nimport { CheckStyleModule } from './CheckStyleModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Injectable({\r\n    providedIn: CheckStyleModule\r\n})\r\nexport class CheckStyleService {\r\n    constructor(private commonService: CommonService) {\r\n    }\r\n    public createHandler(type: TiValidationType | '', config: TiValidationConfig): any {\r\n        let resultType: any = type;\r\n        // 设置checkStyle默认值\r\n        if (Util.isUndefined(type)) {\r\n            resultType = TiValidationDefaultConfig.type;\r\n            // 设置passwordConfig情况下，type默认为'password'\r\n            if (!Util.isUndefined(config.passwordConfig)) {\r\n                resultType = 'password';\r\n            }\r\n        }\r\n        // 根据不同的配置，设置校验方式执行函数\r\n        let handle: any;\r\n        switch (resultType) {\r\n            case 'blur':\r\n                handle = new BlurCheck(config, this.commonService);\r\n                break;\r\n            case 'password':\r\n                handle = new PwdCheck(config, this.commonService);\r\n                break;\r\n            default: // 定义为'change'及其他无效方式,均采用change校验方式\r\n                handle = new ChangeCheck(config, this.commonService);\r\n        }\r\n\r\n        return handle;\r\n    }\r\n}\r\n","import { Directive, ElementRef, Input, OnChanges, OnDestroy, OnInit, Renderer2, RendererFactory2, SimpleChanges } from '@angular/core';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { NgControl } from '@angular/forms';\r\nimport { CheckStyleService } from './checkHandle/CheckStyleService';\r\nimport { CommonService } from './checkHandle/CommonService';\r\nimport { TiValidationConfig } from './TiValidationInterface';\r\nimport { Subscription, timer } from 'rxjs';\r\nimport { debounce } from 'rxjs/operators';\r\n\r\n/**\r\n * Tiny校验是基于Angular提供的表单校验进行的封装，在使用Tiny组件前，请先了解[Angular表单校验]{@link https://angular.io/guide/form-validation}\r\n *\r\n * 组件支持的校验规则及方法见 [TiValidators]{@link ../classes/TiValidators.html}\r\n *\r\n * <example-url>../tiny3demo/#/validation/validation-all</example-url>\r\n */\r\n@Directive({\r\n  selector: '[tiValidation]',\r\n  // 声明该组件定义时需要用到的服务\r\n  providers: [CheckStyleService, CommonService],\r\n  host: {\r\n    '(focus)': 'onFocus()',\r\n    '(blur)': 'onBlur()'\r\n  }\r\n})\r\nexport class TiValidationDirective implements OnInit, OnChanges, OnDestroy {\r\n  public static readonly ASYNC_DEBOUNCE_TIME: number = 500; // 这个数值跟tiny2的异步校验一致\r\n  /**\r\n   * 校验配置信息\r\n   */\r\n  @Input() tiValidation: TiValidationConfig;\r\n  /**\r\n   * 错误提示信息显示容器，适用于blur/password类型校验形式下，错误提示信息位置自定义场景\r\n   */\r\n  @Input() errorMessageWrapper: Element;\r\n  private renderer: Renderer2;\r\n  // 当前formControl的statusChanges订阅，在指令销毁时取消\r\n  private formStatusSubscription: Subscription;\r\n  private asyncFormStatusSubscription: Subscription;\r\n  constructor(private formControl: NgControl,\r\n              private checkStyleFactory: CheckStyleService,\r\n              private element: ElementRef,\r\n              rendererFactory: RendererFactory2) {\r\n        /* tslint:disable:no-null-keyword */\r\n        this.renderer = rendererFactory.createRenderer(null, null);\r\n  }\r\n  private _validationHandleFn: any;\r\n  private eleNative: Element = this.element.nativeElement;\r\n  ngOnInit(): void {\r\n    // 初始化handleFn,用于处理tiValidation指令声明但未定义值场景\r\n    this._setHandleFn();\r\n    // 订阅onStatusChange事件,传递校验时机\r\n    this.formStatusSubscription = this.formControl.statusChanges.subscribe(() => {\r\n      this._validationHandleFn.onStatusChange(this.element, this.formControl);\r\n    });\r\n    // 订阅onStatusChange事件来特别处理异步校验pending状态的loading图标\r\n    if (this.formControl.control.asyncValidator) {\r\n      this.asyncFormStatusSubscription =  this.formControl.statusChanges\r\n        .pipe(\r\n          // 由于异步校验有防抖处理(输入停顿后再进行异步校验)，所以需要在异步校验开始时才能出现loading图标\r\n          debounce(() => timer(Number(this.formControl.pending) * TiValidationDirective.ASYNC_DEBOUNCE_TIME))\r\n        )\r\n        .subscribe(() => {\r\n          if (this._validationHandleFn.onAsyncStatusChange) {\r\n            this._validationHandleFn.onAsyncStatusChange(this.element, this.formControl);\r\n          }\r\n        });\r\n    }\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['tiValidation'] && !changes['tiValidation'].firstChange) { // validation动态修改支持,此处根据validation重新创建校验实体方法函数\r\n      this._setHandleFn();\r\n    }\r\n  }\r\n  ngOnDestroy(): void {\r\n    // 宿主元素销毁时，销毁其附属tip\r\n    this._validationHandleFn.destroy(this.element);\r\n    // 取消formControl中statusChanges的订阅\r\n    this.formStatusSubscription.unsubscribe();\r\n    if (this.asyncFormStatusSubscription) {\r\n      this.asyncFormStatusSubscription.unsubscribe();\r\n    }\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  onFocus(): void {\r\n    this._markAsFocus();\r\n    this._validationHandleFn.onFocus(this.element, this.formControl);\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  onBlur(): void {\r\n    this._markAsBlur();\r\n    this._validationHandleFn.onBlur(this.element, this.formControl);\r\n  }\r\n  private _setHandleFn(): void {\r\n    // 将errorMessageWrapper和tiValidation属性合并，方便后续处理\r\n    const validationConfig: TiValidationConfig = {...this.tiValidation, errorMessageWrapper: this.errorMessageWrapper};\r\n    this._validationHandleFn = this.checkStyleFactory.\r\n            createHandler(this.tiValidation && this.tiValidation.type, validationConfig);\r\n\r\n    // 失焦校验时给宿主元素添加tiBlurCheck属性标识\r\n    if (this.tiValidation && this.tiValidation.type === 'blur') {\r\n      this.renderer.setAttribute(this.eleNative, 'tiBlurCheck', '');\r\n    }\r\n  }\r\n\r\n  // 设置focus状态标志,标志包括两部分(如下markAsBlur逻辑类似)：\r\n  // 1.样式类,用于根据focus/blur状态设置CSS中表单边框颜色;\r\n  // 2.标志位,用于根据focus/blur判断是否显示提示信息\r\n  private _markAsFocus(): void {\r\n    this.renderer.setAttribute(this.eleNative, 'tiFocused', 'tiFocused');\r\n  }\r\n  private _markAsBlur(): void {\r\n    this.renderer.removeAttribute(this.eleNative, 'tiFocused');\r\n  }\r\n}\r\n","/* eslint-disable no-eq-null */\r\n/* eslint-disable eqeqeq */\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { AbstractControl, FormGroup, ValidationErrors, ValidatorFn, Validators } from '@angular/forms';\r\nimport { Util } from '../../../utils/Util';\r\nimport { TiPwdConfig } from '../checkHandle/TiPwdConfig';\r\n// 下面注释，可以避免编译lib时正则报错。原理未知，副作用未知。\r\n// @dynamic\r\n/**\r\n * Tiny封装的常用校验规则及校验方法\r\n *\r\n * ### 规则使用\r\n * **提供了两种使用方式：**\r\n *\r\n * 1.静态方法：通过TiValidators.XXX（规则名）在JS中定义\r\n *\r\n * 2.指令方式：对应规则的指令名为tiXXX(规则名首字母大写)，如required规则的指令名为 tiRequired\r\n *\r\n * **支持的校验规则如下：**\r\n *\r\n * | 规则名称    |  配置参数意义/类型   |  规则描述  |\r\n * | --------   | :-----   | :---- |\r\n * | required   | 无       |  为空校验    |\r\n * | maxLength    | 最大字符长度/number      |  字符长度最大值校验    |\r\n * | minLength    | 最小字符长度/number      |   字符长度最小值校验    |\r\n * | rangeSize    | 最小长度限制/number <br/> 最大长度限制/number      |   字符长度大小区间校验    |\r\n * | maxValue    | 最大数值/number      |  数字最大数值校验    |\r\n * | minValue    | 最小数值/number      |   数字最小数值校验    |\r\n * | rangeValue    | 最小数值限制/number <br/> 最大数值限制/number    |   数字大小区间校验    |\r\n * | regExp   | 正则表达式参数/RegExp|string（不包括正则表达式头尾标识符'^(?:'、')$'）       |  正则校验    |\r\n * | email    | 无      |  邮箱校验    |\r\n * | contains    | 包含的内容/(string/number)     |   包含校验    |\r\n * | notContains    | 不包含的内容/(string/number)      |   不包含校验    |\r\n * | equal   | 相等的内容/(string/number)     |  相等校验    |\r\n * | notEqual    | 不相等的内容/(string/number)    |  不相等校验    |\r\n * | notScript    | 无      |   包含script标签校验    |\r\n * | port    |  无     |   端口号校验，范围为0~65535    |\r\n * | date    | 无      |   日期类型校验    |\r\n * | url    |  无     |   url校验    |\r\n * | integer    | 无      |   整数校验    |\r\n * | number    |  无     |   数字校验 |\r\n * | digits    | 无      |   正整数校验    |\r\n * | ipv4    |  无     |   ipv4校验    |\r\n * | ipv6    |  无     |   ipv6校验    |\r\n * | minCharType | 1. 符合要求的字符种类/number;<br/>2. 字符集对象类型（可选）/{string:RegExp}。<br/>默认的字符种类分别为：大写字母、小写字母、数字、特殊字符`~!@#$%^&*()-_=+\\\\\\|[{}];:\\'\\\",<.>/?  和空格 | 符合最小字符种类校验，默认情况为至少包含2种字符类型`。  |\r\n * | notEqualPosRev    |  需要比对的表单formControl对象获取函数/ () => AbstractControl     |   不能和表单对象的正序或倒序相同    |\r\n * | password    | 密码校验各项规则参数/对象形式 |   密码校验   |\r\n *\r\n *\r\n *  **password规则的参数类型**\r\n *\r\n *    {\r\n *        rangeSize?: [number, number],\r\n *        minCharType?: [bumber, {\r\n *            digitsCharReg: RegExp,\r\n *            specialCharReg: RegExp,\r\n *            lowerCharReg: RegExp,\r\n *            upperCharReg: RegExp}],\r\n *        notEqualPosRev: () => AbstractControl\r\n *    }\r\n */\r\nexport class TiValidators {\r\n  /* tslint:disable:max-line-length */\r\n  private static readonly EMAIL_REGEXP: RegExp = /^((([A-Za-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([A-Za-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([A-Za-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([A-Za-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([A-Za-z]|\\d|-|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([A-Za-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([A-Za-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([A-Za-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([A-Za-z]|\\d|-|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([A-Za-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/;\r\n  private static readonly SCRIPT_REGEXP: RegExp = /<+\\/?[Ss][Cc][Rr][Ii][Pp][Tt] *.*>*/;\r\n  private static readonly DIGITS_REGEXP: RegExp = /^\\d+$/;\r\n  private static readonly PORT_RANGE: Array<number> = [0, 65535];\r\n  // URL规则，其中IPv4部分，采用了下面华为自研的ipv4正则表达式\r\n  private static readonly URL_REGEXP: RegExp = /^(https?|s?ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i;\r\n  private static readonly INTEGER_REGEXP: RegExp = /^-?\\d+$/;\r\n  private static readonly NUMBER_REGEXP: RegExp = /^(?:-?\\d+|-?\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$/;\r\n  // 采用华为自研的ipv4正则表达式\r\n  private static readonly IPV4_REGEXP: RegExp = /^(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))$/i;\r\n  // 采用华为自研的ipv6正则表达式\r\n  private static readonly IPV6_REGEXP: RegExp = /^(((([\\da-f]{1,4}):){7}([\\da-f]{1,4}))|(((([\\da-f]{1,4}):){1,7}:)|((([\\da-f]{1,4}):){6}:([\\da-f]{1,4}))|((([\\da-f]{1,4}):){5}:(([\\da-f]{1,4}):)?([\\da-f]{1,4}))|((([\\da-f]{1,4}):){4}:(([\\da-f]{1,4}):){0,2}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){3}:(([\\da-f]{1,4}):){0,3}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){2}:(([\\da-f]{1,4}):){0,4}([\\da-f]{1,4}))|((([\\da-f]{1,4}):){1}:(([\\da-f]{1,4}):){0,5}([\\da-f]{1,4}))|(::(([\\da-f]{1,4}):){0,6}([\\da-f]{1,4}))|(::([\\da-f]{1,4})?))|(((([\\da-f]{1,4}):){6}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){5}:(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){4}:(([\\da-f]{1,4}):)?(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){3}:(([\\da-f]{1,4}):){0,2}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|((([\\da-f]{1,4}):){2}:(([\\da-f]{1,4}):){0,3}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|(([\\da-f]{1,4})::(([\\da-f]{1,4}):){0,4}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))|(::(([\\da-f]{1,4}):){0,5}(((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5]))\\.){3}((1?[1-9]?\\d)|(10\\d)|(2[0-4]\\d)|(25[0-5])))))$/i;\r\n  private static isEmptyInputValue(value: any): boolean {\r\n    // we don't check for string here so it also works with arrays\r\n    // tslint:disable-next-line:no-null-keyword\r\n    return value == null || value.length === 0;\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static required(control: AbstractControl): ValidationErrors|null {\r\n    return Validators.required(control);\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static maxLength(maxLength: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      const length: number = control.value ? control.value.length : 0;\r\n\r\n      return length > maxLength ?\r\n          {maxLength: {requiredLength: maxLength, actualLength: length}} :\r\n          null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static minLength(minLength: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const length: number = control.value ? control.value.length : 0;\r\n\r\n      return length < minLength ?\r\n          {minLength: {requiredLength: minLength, actualLength: length}} :\r\n          null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static rangeSize(minLength: number, maxLength: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const length: number = control.value ? control.value.length : 0;\r\n\r\n      return length > maxLength || length < minLength ?\r\n          {rangeSize: {requiredMinLength: minLength, requiredMaxLength: maxLength, actualLength: length}} :\r\n          null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static maxValue(max: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(max)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const value: number = parseFloat(control.value);\r\n\r\n      // Controls with NaN values after parsing should be treated as not having a\r\n      // maximum, per the HTML forms spec: https://www.w3.org/TR/html5/forms.html#attr-input-max\r\n      return !isNaN(value) && value > max ? {maxValue: {requiredMaxValue: max, actual: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static minValue(min: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(min)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const value: number = parseFloat(control.value);\r\n\r\n      // Controls with NaN values after parsing should be treated as not having a\r\n      // maximum, per the HTML forms spec: https://www.w3.org/TR/html5/forms.html#attr-input-max\r\n      return !isNaN(value) && value < min ? {minValue: {requiredMinValue: min, actual: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static rangeValue(min: number, max: number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(min) || TiValidators.isEmptyInputValue(max)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const value: number = parseFloat(control.value);\r\n\r\n      // Controls with NaN values after parsing should be treated as not having a\r\n      // maximum, per the HTML forms spec: https://www.w3.org/TR/html5/forms.html#attr-input-max\r\n      return !isNaN(value) && (value < min || value > max) ? {rangeValue: {requiredMinValue: min,\r\n          requiredMaxValue: max, actual: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static regExp(pattern: string|RegExp): ValidatorFn {\r\n    if (!pattern) {\r\n      return Validators.nullValidator;\r\n    }\r\n    let regex: RegExp;\r\n    let regexStr: string;\r\n    if (typeof pattern === 'string') {\r\n      regexStr = '';\r\n\r\n      if (pattern.charAt(0) !== '^') {\r\n        regexStr += '^';\r\n      }\r\n\r\n      regexStr += pattern;\r\n\r\n      if (pattern.charAt(pattern.length - 1) !== '$') {\r\n        regexStr += '$';\r\n      }\r\n\r\n      regex = new RegExp(regexStr);\r\n    } else {\r\n      regexStr = pattern.toString();\r\n      regex = pattern;\r\n    }\r\n\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const value: string = control.value;\r\n\r\n      return regex.test(value) ? null : {regExp: {requiredPattern: regexStr, actualValue: value}};\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static email(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.EMAIL_REGEXP.test(control.value) ? null : {email: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static contains(contain: string|number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(contain)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n\r\n      return control.value.indexOf(contain) === -1 ?\r\n        {contains: {requiredContains: contain, actualValue: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static notContains(contain: string|number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(contain)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n\r\n      return control.value.indexOf(contain) !== -1 ?\r\n        {notContains: {requiredNotContains: contain, actualValue: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static equal(equal: string|number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(equal)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n\r\n      return control.value !== equal ?\r\n        {equal: {requiredEqual: equal, actualValue: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static notEqual(equal: string|number): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(equal)) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n\r\n      return control.value === equal ?\r\n        {notEqual: {requiredNotEqual: equal, actualValue: control.value}} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static notScript(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.SCRIPT_REGEXP.test(control.value) ? {notScript: true} : null;\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static port(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.DIGITS_REGEXP.test(control.value) && (control.value >= TiValidators.PORT_RANGE[0]) &&\r\n        (control.value <= TiValidators.PORT_RANGE[1]) ?\r\n        null : {port: {min: TiValidators.PORT_RANGE[0], max: TiValidators.PORT_RANGE[1]}};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static date(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return !/Invalid|NaN/.test(new Date(control.value).toString()) ?\r\n        null : {date: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static url(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.URL_REGEXP.test(control.value) ?\r\n        null : {url: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static integer(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.INTEGER_REGEXP.test(control.value) ?\r\n        null : {integer: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static number(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.NUMBER_REGEXP.test(control.value) ?\r\n        null : {number: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static digits(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.DIGITS_REGEXP.test(control.value) ?\r\n        null : {digits: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static ipv4(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.IPV4_REGEXP.test(control.value) ?\r\n        null : {ipv4: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   */\r\n  public static ipv6(control: AbstractControl): ValidationErrors|null {\r\n    if (TiValidators.isEmptyInputValue(control.value)) {\r\n      return null;  // don't validate empty values to allow optional controls\r\n    }\r\n\r\n    return TiValidators.IPV6_REGEXP.test(control.value) ?\r\n        null : {ipv6: true};\r\n  }\r\n  /**\r\n   * @ignore\r\n   * 密码字符类型最小种类校验\r\n   * 用于密码校验，其规则如下：\r\n   * 口令必须包含且只能包含如下至少两种字符的组合:\r\n   * －至少一个小写字母；\r\n   * －至少一个大写字母；\r\n   * －至少一个数字；\r\n   * －至少一个特殊字符：`~!@#$%^&*()-_=+\\|[{}];:'\",<.>/?和空格\r\n   * @param  num 字符类型最小个数\r\n   * @param  charTypeRegObj 字符类型校验正则表达式，涉及到强度计算，参考defaults中定义\r\n   */\r\n  public static minCharType(num: number, charTypeRegObj?: any): ValidatorFn {\r\n    /**\r\n     * 正则表达式转为字符串并首尾去除“/”符号，为添加g修饰符做准备\r\n     */\r\n    function regExpToString(regExp: RegExp): string {\r\n        if (typeof regExp !== 'object') {\r\n            return '';\r\n        }\r\n        const regExpStr: string = String(regExp);\r\n\r\n        return regExpStr.substring(1, regExpStr.length - 1);\r\n    }\r\n\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || TiValidators.isEmptyInputValue(num) || num === 0) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      // 各类字符校验正则表达式集合,默认使用pwdConfig中的默认配置\r\n      const charRegObj: any = typeof charTypeRegObj === 'object' ? charTypeRegObj :\r\n          TiPwdConfig.pwdCharTypeRegObj;\r\n\r\n      // 校验输入是否符合单条校验字符规则，并记录符合的单条规则个数\r\n      let checkValidNum: number = 0; // 校验通过结果个数\r\n      let checkResult: any; // 校验结果临时变量\r\n      let replacedValue: string = control.value; // 正则替换后的value值\r\n      for (const key in charRegObj) {\r\n        if (charRegObj.hasOwnProperty(key)) {\r\n          const regExp: RegExp = charRegObj[key];\r\n          checkResult = regExp.test(control.value);\r\n          if (checkResult) {\r\n              checkValidNum++;\r\n              // 使用全局替换方式，用于替换字串中所有符合正则规则的字符\r\n              replacedValue = regExp.global\r\n                              ? replacedValue.replace(regExp, '')\r\n                              : replacedValue.replace(new RegExp(regExpToString(regExp), 'g'), '');\r\n          }\r\n        }\r\n      }\r\n\r\n      // 替换后的值非空情况:代表值中存在非法字符\r\n      return replacedValue.length > 0 || checkValidNum < num ?\r\n        {minCharType: true} : null;\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   * 用于密码校验：密码不能和用户名或其倒序相同\r\n   * @param  getControlFn 获取对比的表单元素formControl函数\r\n   */\r\n  public static notEqualPosRev(getControlFn: () => AbstractControl): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      if (TiValidators.isEmptyInputValue(control.value) || Util.isUndefined(getControlFn && getControlFn())) {\r\n        return null;  // don't validate empty values to allow optional controls\r\n      }\r\n      const value: string = control.value;\r\n      const refreValue: string = getControlFn().value;\r\n\r\n      // 使用如下方式会出现卡顿的情况：\r\n      // 对比formControl value修改时，需要同步修改该表单的状态，否则会存在下次focus该元素或表单整体校验时\r\n      // 该元素校验结果依然是上次的结果\r\n      // getControlFn().valueChanges.subscribe(() => {\r\n      //   control.updateValueAndValidity();\r\n      // });\r\n\r\n      return (value.toLowerCase() !== refreValue.split('')\r\n          .reverse()\r\n          .join('')\r\n          .toLowerCase()) &&\r\n          (value.toLowerCase() !== refreValue.toLowerCase()) ?\r\n          null : {notEqualPosRev: true};\r\n    };\r\n  }\r\n  /**\r\n   * @ignore\r\n   * 密码校验规则\r\n   * @param pValue 规则参数:{ruleKey: param}\r\n   */\r\n  public static password(pValue: {\r\n    rangeSize?: [number, number];\r\n    minCharType?: [number, any];\r\n    notEqualPosRev?(): AbstractControl;\r\n  }): ValidatorFn {\r\n    const rangeSizeParamArr: Array<number> = pValue.rangeSize || TiPwdConfig.pwdValidator.params.rangeSize;\r\n    const minCharTypeParamArr: Array<any> = pValue.minCharType || TiPwdConfig.pwdValidator.params.minCharType;\r\n    if (Util.isUndefined(minCharTypeParamArr[1])) {\r\n      minCharTypeParamArr[1] = TiPwdConfig.pwdCharTypeRegObj;\r\n    }\r\n    const validatorComposeArr: Array<any> = [TiValidators.required,\r\n      TiValidators.rangeSize(rangeSizeParamArr[0], rangeSizeParamArr[1]),\r\n      TiValidators.minCharType(minCharTypeParamArr[0], minCharTypeParamArr[1]),\r\n      TiValidators.notEqualPosRev(pValue.notEqualPosRev)];\r\n\r\n      // 由于错误提示为password专有提示,需要自定义password error,而compose方法不能自定义,因此此处未使用compose\r\n    // 此外,各子规则的错误依然需要保留,用于规则提示信息\r\n    return (control: AbstractControl): any => {\r\n      return _mergeErrorsPwd(_executeValidators(control, validatorComposeArr));\r\n    };\r\n    function _executeValidators(control: AbstractControl, validators: Array<ValidatorFn>): Array<any> {\r\n      return validators.map((v: any) => v(control));\r\n    }\r\n    function _mergeErrorsPwd(arrayOfErrors: Array<ValidationErrors>): ValidationErrors|null {\r\n      const res: {[key: string]: any} =\r\n          arrayOfErrors.reduce((resource: ValidationErrors | null, errors: ValidationErrors | null) => {\r\n            return errors != null ? {...resource, ...errors} : resource;\r\n          }, {});\r\n\r\n      return Object.keys(res).length === 0 ? null : {password: true, ...res};\r\n    }\r\n  }\r\n  // 该方法用于整体校验:由于表单未foucs时,即使错误也不会显示红框,\r\n  // 而整体校验时需要将错误的表单边框标红显示,因此需要显示调用整体校验方法\r\n  /**\r\n   * 该方法用于整体校验\r\n   *\r\n   * 参数form：需要校验的表单族\r\n   *\r\n   * 参数updateValueAndValidityConfig：可选，check方法内部使用的校验方法是AbstractControl的updateValueAndValidity方法，此处将方法参数开放给开发者，参数意义具体可参考https://angular.io/api/forms/AbstractControl#updatevalueandvalidity\r\n   *\r\n   * 返回：表单错误信息\r\n   */\r\n  public static check(form: FormGroup, updateValueAndValidityConfig?: { onlySelf?: boolean; emitEvent?: boolean; }): ValidationErrors | null {\r\n    let errors: any = {};\r\n    if (form.errors) {\r\n      errors = {...errors, ...form.errors};\r\n    }\r\n    for (const key in form.controls) {\r\n      if (form.controls.hasOwnProperty(key)) {\r\n        const control: AbstractControl | any = form.controls[key];\r\n        if (control.controls) { // 嵌套的FormArray,FormGroup\r\n          const checkedErrors: any = TiValidators.check(control, updateValueAndValidityConfig);\r\n          if (checkedErrors !== null) {\r\n            errors[key] = checkedErrors;\r\n          }\r\n        } else {\r\n          control.markAsTouched();\r\n          // 由于表单间可能有关联关系（如密码校验的notEqualPosRev，该关联关系需要对单个表单元素再次校验\r\n          control.updateValueAndValidity(updateValueAndValidityConfig);\r\n          // 读取errors信息\r\n          if (control.errors !== null) {\r\n            errors[key] = control.errors;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // 无errors信息时，设置为null，方便业务处理\r\n    if (JSON.stringify(errors) === '{}') {\r\n      errors = null;\r\n    }\r\n\r\n    return errors;\r\n  }\r\n}\r\n","import { Directive, forwardRef, OnChanges, SimpleChanges, Type } from '@angular/core';\r\n/* tslint:disable:no-implicit-dependencies */\r\nimport { AbstractControl, NG_VALIDATORS, ValidationErrors, Validator, ValidatorFn, Validators } from '@angular/forms';\r\nimport { TiValidators } from '../TiValidators';\r\nimport { Util } from '../../../../utils/Util';\r\n// 下面注释，是为了避免lib编译错误。具体原理未知，副作用未知。\r\n// @dynamic\r\n/**\r\n * @ignore\r\n */\r\n@Directive({selector: '[BaseValidator]'})\r\nexport class BaseValidator implements Validator, OnChanges {\r\n  public validatorStr: string;\r\n  public baseValue: string; // 需要传参的校验规则的参数\r\n  public enabled: boolean = true; // 无需传参的校验规则是否开启校验\r\n  private _validator: ValidatorFn = Validators.nullValidator;\r\n  private _onChange?: () => void;\r\n\r\n  /**\r\n   * 获取各directive中的参数配置\r\n   * @param validatorClass 校验实现类\r\n   * @param name 校验指令名：由于该方法在类外部调用，无法使用BaseValidator中的参数，因此需要传入\r\n   */\r\n  public static getDirectiveConfig(validatorClass: Type<any>, name: string): Directive {\r\n    return {\r\n        selector: `[${name}][formControlName],[${name}][formControl],[${name}][ngModel]`,\r\n        providers: [{\r\n            provide: NG_VALIDATORS,\r\n            /* tslint:disable:no-forward-ref */\r\n            useExisting: forwardRef(() => validatorClass),\r\n            multi: true\r\n        }]\r\n    };\r\n  }\r\n  public static getValidatorStr(name: string): any {\r\n    return name.replace(new RegExp('ti'), '')\r\n    .replace(new RegExp('^\\\\S'), (s: string) => {\r\n      return s.toLowerCase();\r\n    });\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['baseValue'] || changes['enabled']) {\r\n      this._createValidator();\r\n      if (this._onChange) {\r\n        this._onChange();\r\n      }\r\n    }\r\n  }\r\n\r\n  validate(c: AbstractControl): ValidationErrors|null {\r\n    return (this.enabled === false || this.enabled as any === 'false') ? null : this._validator(c);\r\n  }\r\n\r\n  registerOnValidatorChange(fn: () => void): void {\r\n    this._onChange = fn;\r\n  }\r\n\r\n  private _createValidator(): void {\r\n    const validatorStr: string = this.validatorStr;\r\n    const validatorParam: string = this.baseValue;\r\n    /* tslint:disable:prefer-conditional-expression */\r\n    if (Util.isArray(validatorParam)) {\r\n      /* tslint:disable:no-null-keyword */\r\n      this._validator = TiValidators[validatorStr].apply(null, validatorParam);\r\n    } else if (!Util.isUndefined(validatorParam)) {\r\n      this._validator = TiValidators[validatorStr](validatorParam);\r\n    } else {\r\n      this._validator = TiValidators[validatorStr];\r\n    }\r\n  }\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(MaxLengthValidatorDirective, MaxLengthValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiMaxLength][formControlName],[tiMaxLength][formControl],[tiMaxLength][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => MaxLengthValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class MaxLengthValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiMaxLength';\r\n  @Input(MaxLengthValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(MaxLengthValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(RangeSizeValidatorDirective, RangeSizeValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiRangeSize][formControlName],[tiRangeSize][formControl],[tiRangeSize][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => RangeSizeValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class RangeSizeValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiRangeSize';\r\n  @Input(RangeSizeValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(RangeSizeValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(RangeValueValidatorDirective, RangeValueValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiRangeValue][formControlName],[tiRangeValue][formControl],[tiRangeValue][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => RangeValueValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class RangeValueValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiRangeValue';\r\n  @Input(RangeValueValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(RangeValueValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(MinLengthValidatorDirective, MinLengthValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiMinLength][formControlName],[tiMinLength][formControl],[tiMinLength][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => MinLengthValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class MinLengthValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiMinLength';\r\n  @Input(MinLengthValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(MinLengthValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(EmailValidatorDirective, EmailValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiEmail][formControlName],[tiEmail][formControl],[tiEmail][ngModel]`,\r\n  providers: [{\r\n    provide: NG_VALIDATORS,\r\n    // tslint:disable-next-line: no-forward-ref\r\n    useExisting: forwardRef(() => EmailValidatorDirective),\r\n    multi: true\r\n  }]\r\n})\r\nexport class EmailValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiEmail';\r\n  @Input(EmailValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(EmailValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(NotScriptValidatorDirective, NotScriptValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiNotScript][formControlName],[tiNotScript][formControl],[tiNotScript][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => NotScriptValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class NotScriptValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiNotScript';\r\n  @Input(NotScriptValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(NotScriptValidatorDirective.NAME);\r\n}\r\n","// tslint:disable-next-line: ordered-imports\r\nimport { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(ContainsValidatorDirective, ContainsValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiContains][formControlName],[tiContains][formControl],[tiContains][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => ContainsValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class ContainsValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiContains';\r\n  @Input(ContainsValidatorDirective.NAME) baseValue: string;\r\n  validatorStr: string = BaseValidator.getValidatorStr(ContainsValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(NotContainsValidatorDirective, NotContainsValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiNotContains][formControlName],[tiNotContains][formControl],[tiNotContains][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => NotContainsValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class NotContainsValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiNotContains';\r\n  @Input(NotContainsValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(NotContainsValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(DateValidatorDirective, DateValidatorDirective.NAME))\r\n@Directive({\r\n    selector: `[tiDate][formControlName],[tiDate][formControl],[tiDate][ngModel]`,\r\n    providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => DateValidatorDirective),\r\n      multi: true\r\n    }]\r\n  })\r\nexport class DateValidatorDirective extends BaseValidator {\r\n    static readonly NAME: string = 'tiDate';\r\n    @Input(DateValidatorDirective.NAME) enabled: boolean;\r\n    validatorStr: string = BaseValidator.getValidatorStr(DateValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(DigitsValidatorDirective, DigitsValidatorDirective.NAME))\r\n@Directive({\r\n    selector: `[tiDigits][formControlName],[tiDigits][formControl],[tiDigits][ngModel]`,\r\n    providers: [{\r\n        provide: NG_VALIDATORS,\r\n        // tslint:disable-next-line: no-forward-ref\r\n        useExisting: forwardRef(() => DigitsValidatorDirective),\r\n        multi: true\r\n    }]\r\n  })\r\nexport class DigitsValidatorDirective extends BaseValidator {\r\n    static readonly NAME: string = 'tiDigits';\r\n    @Input(DigitsValidatorDirective.NAME) enabled: boolean;\r\n    validatorStr: string = BaseValidator.getValidatorStr(DigitsValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(EqualValidatorDirective, EqualValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiEqual][formControlName],[tiEqual][formControl],[tiEqual][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => EqualValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class EqualValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiEqual';\r\n  @Input(EqualValidatorDirective.NAME) baseValue: string;\r\n  validatorStr: string = BaseValidator.getValidatorStr(EqualValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(Ipv4ValidatorDirective, Ipv4ValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiIpv4][formControlName],[tiIpv4][formControl],[tiIpv4][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => Ipv4ValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class Ipv4ValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiIpv4';\r\n  @Input(Ipv4ValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(Ipv4ValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(Ipv6ValidatorDirective, Ipv6ValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiIpv6][formControlName],[tiIpv6][formControl],[tiIpv6][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => Ipv6ValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class Ipv6ValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiIpv6';\r\n  @Input(Ipv6ValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(Ipv6ValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(MaxValueValidatorDirective, MaxValueValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiMaxValue][formControlName],[tiMaxValue][formControl],[tiMaxValue][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => MaxValueValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class MaxValueValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiMaxValue';\r\n  @Input(MaxValueValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(MaxValueValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(IntegerValidatorDirective, IntegerValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiInteger][formControlName],[tiInteger][formControl],[tiInteger][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => IntegerValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class IntegerValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiInteger';\r\n  @Input(IntegerValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(IntegerValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(MinValueValidatorDirective, MinValueValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiMinValue][formControlName],[tiMinValue][formControl],[tiMinValue][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => MinValueValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class MinValueValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiMinValue';\r\n  @Input(MinValueValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(MinValueValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(NotEqualValidatorDirective, NotEqualValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiNotEqual][formControlName],[tiNotEqual][formControl],[tiNotEqual][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => NotEqualValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class NotEqualValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiNotEqual';\r\n  @Input(NotEqualValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(NotEqualValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(NumberValidatorDirective, NumberValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiNumber][formControlName],[tiNumber][formControl],[tiNumber][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => NumberValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class NumberValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiNumber';\r\n  @Input(NumberValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(NumberValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(PasswordValidatorDirective, PasswordValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiPassword][formControlName],[tiPassword][formControl],[tiPassword][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => PasswordValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class PasswordValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiPassword';\r\n  @Input(PasswordValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(PasswordValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(PortValidatorDirective, PortValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiPort][formControlName],[tiPort][formControl],[tiPort][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => PortValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class PortValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiPort';\r\n  @Input(PortValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(PortValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(RegExpValidatorDirective, RegExpValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiRegExp][formControlName],[tiRegExp][formControl],[tiRegExp][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => RegExpValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class RegExpValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiRegExp';\r\n  @Input(RegExpValidatorDirective.NAME) baseValue: any;\r\n  validatorStr: string = BaseValidator.getValidatorStr(RegExpValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(UrlValidatorDirective, UrlValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiUrl][formControlName],[tiUrl][formControl],[tiUrl][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => UrlValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\n// @Directive(BaseValidator.getDirectiveConfig(RequiredValidatorDirective, RequiredValidatorDirective.NAME))\r\nexport class UrlValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiUrl';\r\n  @Input(UrlValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(UrlValidatorDirective.NAME);\r\n}\r\n","import { Directive, Input, forwardRef } from '@angular/core';\r\nimport { BaseValidator } from './BaseValidator';\r\nimport { Validator, AbstractControl, ValidationErrors, NG_VALIDATORS } from '@angular/forms';\r\n// @Directive(BaseValidator.getDirectiveConfig(RequiredValidatorDirective, RequiredValidatorDirective.NAME))\r\n@Directive({\r\n  selector: `[tiRequired][formControlName],[tiRequired][formControl],[tiRequired][ngModel]`,\r\n  providers: [{\r\n      provide: NG_VALIDATORS,\r\n      // tslint:disable-next-line: no-forward-ref\r\n      useExisting: forwardRef(() => RequiredValidatorDirective),\r\n      multi: true\r\n  }]\r\n})\r\nexport class RequiredValidatorDirective extends BaseValidator {\r\n  static readonly NAME: string = 'tiRequired';\r\n  @Input(RequiredValidatorDirective.NAME) enabled: boolean;\r\n  validatorStr: string = BaseValidator.getValidatorStr(RequiredValidatorDirective.NAME);\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\nimport { TiLoadingModule } from '../../components/loading/TiLoadingModule';\r\nimport { TiValidationDirective } from './TiValidationDirective';\r\nimport { TiPwdMsgComponent } from './TiPwdMsgComponent';\r\nimport { TiErrorMsgComponent } from './TiErrorMsgComponent';\r\nimport { TiPendingStateComponent } from './TiPendingStateComponent';\r\nimport { MaxLengthValidatorDirective } from './validators/directives/MaxLengthValidatorDirective';\r\nimport { RangeSizeValidatorDirective } from './validators/directives/RangeSizeValidatorDirective';\r\nimport { RangeValueValidatorDirective } from './validators/directives/RangeValueValidatorDirective';\r\nimport { MinLengthValidatorDirective } from './validators/directives/MinLengthValidatorDirective';\r\nimport { EmailValidatorDirective } from './validators/directives/EmailValidatorDirective';\r\nimport { NotScriptValidatorDirective } from './validators/directives/NotScriptValidatorDirective';\r\nimport { ContainsValidatorDirective } from './validators/directives/ContainsValidatorDirective';\r\nimport { NotContainsValidatorDirective } from './validators/directives/NotContainsValidatorDirective';\r\nimport { DateValidatorDirective } from './validators/directives/DateValidatorDirective';\r\nimport { DigitsValidatorDirective } from './validators/directives/DigitsValidatorDirective';\r\nimport { EqualValidatorDirective } from './validators/directives/EqualValidatorDirective';\r\nimport { Ipv4ValidatorDirective } from './validators/directives/Ipv4ValidatorDirective';\r\nimport { Ipv6ValidatorDirective } from './validators/directives/Ipv6ValidatorDirective';\r\nimport { MaxValueValidatorDirective } from './validators/directives/MaxValueValidatorDirective';\r\nimport { IntegerValidatorDirective } from './validators/directives/IntegerValidatorDirective';\r\nimport { MinValueValidatorDirective } from './validators/directives/MinValueValidatorDirective';\r\nimport { NotEqualValidatorDirective } from './validators/directives/NotEqualValidatorDirective';\r\nimport { NumberValidatorDirective } from './validators/directives/NumberValidatorDirective';\r\nimport { PasswordValidatorDirective } from './validators/directives/PasswordValidatorDirective';\r\nimport { PortValidatorDirective } from './validators/directives/PortValidatorDirective';\r\nimport { RegExpValidatorDirective } from './validators/directives/RegExpValidatorDirective';\r\nimport { UrlValidatorDirective } from './validators/directives/UrlValidatorDirective';\r\nimport { RequiredValidatorDirective } from './validators/directives/RequiredValidatorDirective';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiTipModule } from '../tip/TiTipModule';\r\nimport { BaseValidator } from './validators/directives/BaseValidator';\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiRendererModule,\r\n    TiTipModule, // 引用TiTipModule，可以使用Tip指令和Tip服务\r\n    TiLoadingModule\r\n  ],\r\n  // 下面必须写两遍，因为生产环境不允许编译之前执行函数。\r\n  exports: [\r\n    BaseValidator,\r\n    TiErrorMsgComponent,\r\n    TiPendingStateComponent,\r\n    TiValidationDirective, // 额外加的\r\n    MaxLengthValidatorDirective, RangeSizeValidatorDirective, RangeValueValidatorDirective, MinLengthValidatorDirective,\r\n    EmailValidatorDirective, NotScriptValidatorDirective, ContainsValidatorDirective, NotContainsValidatorDirective,\r\n    DateValidatorDirective, DigitsValidatorDirective, EqualValidatorDirective, Ipv4ValidatorDirective, Ipv6ValidatorDirective,\r\n    MaxValueValidatorDirective, IntegerValidatorDirective,\r\n    MinValueValidatorDirective, NotEqualValidatorDirective, NumberValidatorDirective, PasswordValidatorDirective,\r\n    PortValidatorDirective, RegExpValidatorDirective, UrlValidatorDirective, RequiredValidatorDirective\r\n  ],\r\n  declarations: [\r\n    BaseValidator,\r\n    TiValidationDirective, TiPwdMsgComponent, TiPendingStateComponent, TiErrorMsgComponent, // 额外加的\r\n    MaxLengthValidatorDirective, RangeSizeValidatorDirective, RangeValueValidatorDirective, MinLengthValidatorDirective,\r\n    EmailValidatorDirective, NotScriptValidatorDirective, ContainsValidatorDirective, NotContainsValidatorDirective,\r\n    DateValidatorDirective, DigitsValidatorDirective, EqualValidatorDirective, Ipv4ValidatorDirective, Ipv6ValidatorDirective,\r\n    MaxValueValidatorDirective, IntegerValidatorDirective,\r\n    MinValueValidatorDirective, NotEqualValidatorDirective, NumberValidatorDirective, PasswordValidatorDirective,\r\n    PortValidatorDirective, RegExpValidatorDirective, UrlValidatorDirective, RequiredValidatorDirective\r\n  ],\r\n  entryComponents: [TiPwdMsgComponent, TiErrorMsgComponent, TiPendingStateComponent]\r\n})\r\nexport class TiValidationModule {\r\n}\r\nexport { TiValidationDirective } from './TiValidationDirective';\r\nexport { TiPasswordValidatorConfig, TiValidationConfig, TiValidationType } from './TiValidationInterface';\r\nexport { TiValidators } from './validators/TiValidators';\r\nexport { BaseValidator} from './validators/directives/BaseValidator';\r\nexport { TiErrorMsgComponent } from './TiErrorMsgComponent';\r\nexport { TiPendingStateComponent } from './TiPendingStateComponent';\r\nexport { MaxLengthValidatorDirective } from './validators/directives/MaxLengthValidatorDirective';\r\nexport { RangeSizeValidatorDirective } from './validators/directives/RangeSizeValidatorDirective';\r\nexport { RangeValueValidatorDirective } from './validators/directives/RangeValueValidatorDirective';\r\nexport { MinLengthValidatorDirective } from './validators/directives/MinLengthValidatorDirective';\r\nexport { EmailValidatorDirective } from './validators/directives/EmailValidatorDirective';\r\nexport { NotScriptValidatorDirective } from './validators/directives/NotScriptValidatorDirective';\r\nexport { ContainsValidatorDirective } from './validators/directives/ContainsValidatorDirective';\r\nexport { NotContainsValidatorDirective } from './validators/directives/NotContainsValidatorDirective';\r\nexport { DateValidatorDirective } from './validators/directives/DateValidatorDirective';\r\nexport { DigitsValidatorDirective } from './validators/directives/DigitsValidatorDirective';\r\nexport { EqualValidatorDirective } from './validators/directives/EqualValidatorDirective';\r\nexport { Ipv4ValidatorDirective } from './validators/directives/Ipv4ValidatorDirective';\r\nexport { Ipv6ValidatorDirective } from './validators/directives/Ipv6ValidatorDirective';\r\nexport { MaxValueValidatorDirective } from './validators/directives/MaxValueValidatorDirective';\r\nexport { IntegerValidatorDirective } from './validators/directives/IntegerValidatorDirective';\r\nexport { MinValueValidatorDirective } from './validators/directives/MinValueValidatorDirective';\r\nexport { NotEqualValidatorDirective } from './validators/directives/NotEqualValidatorDirective';\r\nexport { NumberValidatorDirective } from './validators/directives/NumberValidatorDirective';\r\nexport { PasswordValidatorDirective } from './validators/directives/PasswordValidatorDirective';\r\nexport { PortValidatorDirective } from './validators/directives/PortValidatorDirective';\r\nexport { RegExpValidatorDirective } from './validators/directives/RegExpValidatorDirective';\r\nexport { UrlValidatorDirective } from './validators/directives/UrlValidatorDirective';\r\nexport { RequiredValidatorDirective } from './validators/directives/RequiredValidatorDirective';\r\n\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { TiIpsectionComponent } from './TiIpsectionComponent';\r\nimport { TiSelectModule } from '../select/TiSelectModule';\r\nimport { TiMaskModule } from '../../directives/maskinput/TiMaskModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiValidationModule } from '../../directives/validation/TiValidationModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiMaskModule,\r\n    TiSelectModule,\r\n    TiTextModule,\r\n    ReactiveFormsModule,\r\n    TiValidationModule],\r\n  exports: [TiIpsectionComponent],\r\n  declarations: [TiIpsectionComponent]\r\n})\r\n\r\nexport class TiIpsectionModule { }\r\nexport { TiIpsectionComponent, TiIpsectionConfig } from './TiIpsectionComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    NgZone,\r\n    Optional,\r\n    Output,\r\n    Renderer2,\r\n    SimpleChange,\r\n    SimpleChanges,\r\n    ViewEncapsulation,\r\n    Inject\r\n} from '@angular/core';\r\nimport { ActivatedRoute, NavigationEnd, NavigationExtras, Router, UrlTree } from '@angular/router';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { Util } from '../../utils/Util';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\n\r\n/**\r\n * 左侧菜单各项数据接口\r\n *\r\n * 是TiLeftmenuLevel1 和 TiLeftmenuLevel2 组件的 item 接口的数据类型\r\n */\r\nexport interface TiLeftmenuItem {\r\n    /**\r\n     * 设置当前菜单项对应的路由，与 Router.navigate方法的第一个参数一样\r\n     */\r\n    router?: Array<any>;\r\n    // routerExtras?: { relativeTo?: string, queryParams?: Object, fragment?: string };\r\n    /**\r\n     * 设置当前菜单项对应路由的配置信息，与 Router.navigate方法的第二个参数一样\r\n     */\r\n    routerExtras?: NavigationExtras;\r\n    /**\r\n     * 设置一个router路由列表，当该列表中的路由被激活时，其对应的菜单项被激活处于高亮状态。\r\n     * 其使用场景为多个路由对应同一个左侧菜单项。\r\n     *\r\n     * routerList 数组中每一个元素与 Router.navigate方法的第一个参数一样\r\n     */\r\n    routerList?: Array<Array<any>>; // 数组中元素也为数组\r\n    /**\r\n     * 链接地址，点击后路由激活项不变，在新页面打开配置地址。\r\n     *\r\n     * 10.0.1新增\r\n     *\r\n     * v10.0.1 ~ v10.1.3版本存在XSS攻击(url类型)风险和用户点击这个链接并进入一个新的标签，新标签中的页面如果存在恶意代码，就可以将原网站直接导航到一个虚假网站的安全风险。\r\n     *\r\n     * v10.1.4 版本做了安全处理，已不存在上述两种安全问题，建议业务尽快升级版本。\r\n     */\r\n    href?: string;\r\n    /**\r\n     * 设置分界线（只支持一级菜单），在设置该属性菜单项的底部生成一条区块分界线。\r\n     *\r\n     * 10.0.2新增\r\n     */\r\n    showDividingLine?: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * TiLeftmenu组件提供了一种方便灵活实现页面布局左侧菜单的方式，支持两级菜单。\r\n *\r\n * 其内部包含5个组件:\r\n *\r\n * TiLeftmenu : 左侧菜单最外层的指令；\r\n *\r\n * TiLeftmenuGroup: 菜单分组指令；\r\n *\r\n * TileftmenuGroupItem：分组文本内容指令；\r\n *\r\n * TiLeftmenuHead : 菜单头部内容指令；\r\n *\r\n * TiLeftmenuLevel1 ：一级菜单指令；\r\n *\r\n * TiLeftmenuItem ：一级菜单文本内容指令；\r\n *\r\n * TiLeftmenuLevel2 ：二级菜单指令。\r\n *\r\n * <example-url>../tiny3demo/#/leftmenu/leftmenu-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-leftmenu',\r\n    templateUrl: './leftmenu.html',\r\n    styleUrls: ['./leftmenu.less'],\r\n    host: {\r\n        '[class.ti3-leftmenu-container]': 'true',\r\n        '[class.ti3-leftmenu-hide]': 'collapsed'\r\n    },\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class TiLeftmenuComponent extends TiBaseComponent {\r\n    /**\r\n     * 设置激活菜单项。这个值应该是 TiLeftmenuLevel1 和 TiLeftmenuLevel2 组件的 item 接口传入的值的集合中的一个(item)\r\n     *\r\n     * 此接口是双向绑定的，设置时中括号“[]”和圆括号“()”要同时使用\r\n     */\r\n    @Input() active: TiLeftmenuItem;\r\n    /**\r\n     * 激活菜单项改变时向外通知\r\n     */\r\n\r\n    @Output() readonly activeChange: EventEmitter<TiLeftmenuItem> = new EventEmitter();\r\n    /**\r\n     * 控制右侧内容区的刷新\r\n     *\r\n     * 注意：当重复点击当前激活菜单项时，需要刷新右侧内容区，为了实现此功能设置了该接口；\r\n     * 该接口是双向绑定的，当重复点击当前激活菜单项时，reloadState的值会经历 true(上次的值) -> false -> true\r\n     * 的变化过程，开发者给改接口与其右侧区域容器上ngIf接口绑定的是同一个变量，所以ngIf的值也会经历同样的变化，\r\n     * 从而做到右侧内容区的刷新。\r\n     */\r\n    @Input() reloadState: boolean = true;\r\n    /**\r\n     * 右侧内容区是否需要刷新的状态值改变时向外通知\r\n     */\r\n    @Output() readonly reloadStateChange: EventEmitter<boolean> = new EventEmitter();\r\n    // routable接口在3.0.3版本起对外隐藏，10.0.1重新开放\r\n    /**\r\n     * 10.0.1新增\r\n     *\r\n     * 设置是否使用路由来控制菜单对应内容显示/隐藏，默认使用路由。\r\n     */\r\n    @Input() routable: boolean = true;\r\n    /**\r\n     * 是否开启左侧菜单面板可折叠功能，默认开启。\r\n     */\r\n    @Input() toggleable: boolean = true;\r\n    /**\r\n     * 左侧菜单面板是否为收起状态，用于设置面板收起/展开状态，默认展开。\r\n     */\r\n    @Input() collapsed: boolean = false;\r\n    /**\r\n     * 左侧菜单面板收起/展开状态改变时向外通知\r\n     */\r\n    @Output() readonly collapsedChange: EventEmitter<boolean> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     * tiLeftmenu中包含的 TiLeftmenuLevel1Component 实例集合\r\n     */\r\n    public level1Items: Array<TiLeftmenuLevel1Component> = [];\r\n    private navigationSubscription: Subscription;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public readonly resolvedPromise: Promise<any> = Promise.resolve(null);\r\n    /**\r\n     * 标志量，是否为url改变(需要去改变active)\r\n     */\r\n    private isUrlChange: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    private panelContainer: any;\r\n    /**\r\n     * 滚动条的宽度, 在 TiLeftmenuFoot中也有使用\r\n     * @ignore\r\n     */\r\n    public scrollWidth: number;\r\n\r\n    constructor(elementRef: ElementRef, public renderer2: Renderer2,\r\n                @Optional() private router: Router,\r\n                @Optional() private activeRoute: ActivatedRoute,\r\n                private tiRenderer: TiRenderer, private zone: NgZone, @Inject(DOCUMENT) private document) {\r\n        super(elementRef, renderer2);\r\n    }\r\n\r\n    // 判断item的router是否是父路由下默认激活的子路由（即子路由与父路由路径一致）\r\n    private static isDefaultActiveChildRoute(item: TiLeftmenuItem): boolean {\r\n        // 默认激活的子路由的router可设为[]或['']\r\n        return !item.router || item.router.length === 0 || item.router[0] === '';\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始时右侧内容区默认显示，需使外部用户的reloadState值为true。\r\n        // 双向绑定数据时，对初始传入的值立即修改并传出时会报错，\r\n        // 此处参考ngModel源码setValue的处理，使用promise延后执行时序\r\n        this.resolvedPromise.then(() => {\r\n            this.reloadStateChange.emit(true);\r\n        });\r\n        this.scrollWidth = this.getScrollbarSize('Y');\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n\r\n        if (!this.routable) {\r\n            return;\r\n        }\r\n\r\n        // 直接输入url(刷新页面)改变状态时，leftmenu能同步修改激活状态\r\n        const urlActiveItem: TiLeftmenuItem = this.getActiveItemByUrl(this.level1Items);\r\n\r\n        if (urlActiveItem) {\r\n            // 双向绑定数据时，对初始传入的值立即修改并传出时会报错，\r\n            // 此处参考ngModel源码setValue的处理，使用promise延后执行时序\r\n            this.resolvedPromise.then(() => {\r\n                if (urlActiveItem !== this.active) {\r\n                    this.isUrlChange = true;\r\n                    this.active = urlActiveItem;\r\n                    this.activeChange.emit(this.active);\r\n                }\r\n            });\r\n        } else {\r\n            this.link();\r\n        }\r\n\r\n        // 从非leftMenu处跳转改变状态时，leftmenu能同步修改激活状态\r\n        this.navigationSubscription = this.router.events.subscribe((evt: any) => {\r\n            if (evt instanceof NavigationEnd) {\r\n                const newActiveItem: TiLeftmenuItem = this.getActiveItemByUrl(this.level1Items);\r\n                if (newActiveItem && newActiveItem !== this.active) {\r\n                    this.active = newActiveItem;\r\n                    this.activeChange.emit(this.active);\r\n                    this.isUrlChange = true;\r\n                }\r\n            }\r\n        });\r\n\r\n        this.panelContainer = this.nativeElement.querySelector('.ti3-leftmenu-panel-container');\r\n        const headElement: any = this.nativeElement.querySelector('.ti3-leftmenu-head');\r\n        let headCloneElement: any ;\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            this.renderer2.listen(this.panelContainer, 'scroll', (): void => {\r\n                const scrollTop: number = this.panelContainer.scrollTop;\r\n                if (scrollTop > 0) {\r\n                    if (!headCloneElement) {\r\n                        headCloneElement = headElement.cloneNode(true);\r\n                        this.renderer2.addClass(headCloneElement, 'ti3-leftmenu-head-clone');\r\n\r\n                        this.renderer2.setStyle(headCloneElement, 'width', `calc(100% - ${this.scrollWidth}px)`);\r\n                        this.nativeElement.appendChild(headCloneElement);\r\n                    }\r\n                } else if (headCloneElement) {\r\n                    this.nativeElement.removeChild(headCloneElement);\r\n                    headCloneElement = undefined;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        const activeObj: SimpleChange = changes['active'];\r\n        if (activeObj && !activeObj.firstChange) {\r\n            for (const level1Item of this.level1Items) {\r\n                level1Item.setShowChildren();\r\n                level1Item.setActiveState();\r\n            }\r\n\r\n            if (this.routable && !this.isUrlChange) {\r\n                this.link();\r\n            }\r\n\r\n            this.isUrlChange = false;\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.navigationSubscription) {\r\n            this.navigationSubscription.unsubscribe();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 模板中使用\r\n     */\r\n    public toggleClickFn(): void {\r\n        this.collapsed = !this.collapsed;\r\n        this.collapsedChange.emit(this.collapsed);\r\n    }\r\n\r\n    private getActiveItemByUrl(arr: Array<any>): TiLeftmenuItem {\r\n        let resultItem: TiLeftmenuItem;\r\n        for (const component of arr) {\r\n            if (this.isActived(component.item)) {\r\n                resultItem = component.item;\r\n                if (TiLeftmenuComponent.isDefaultActiveChildRoute(component.item)) {\r\n                    continue;\r\n                } else {\r\n                    return resultItem;\r\n                }\r\n            }\r\n\r\n            if (component.children && component.children.length > 0) {\r\n                const result: TiLeftmenuItem = this.getActiveItemByUrl(component.children);\r\n                if (result) {\r\n                    return result;\r\n                }\r\n            }\r\n        }\r\n\r\n        return resultItem;\r\n    }\r\n\r\n    private isActived(item: TiLeftmenuItem): boolean {\r\n        const relativeRoute: NavigationExtras = this.getRelativeRoute(item.routerExtras);\r\n        if (this.isMatchCurrentUrl(item.router, relativeRoute)) {\r\n            return true;\r\n        }\r\n\r\n        if (Util.isArray(item.routerList) && item.routerList.length > 0) {\r\n            for (const router of item.routerList) {\r\n                if (this.isMatchCurrentUrl(router, relativeRoute)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private isMatchCurrentUrl(router: Array<any>, relativeRoute: NavigationExtras): boolean {\r\n        if (!Util.isArray(router)) {\r\n            return false;\r\n        }\r\n\r\n        const itemUrlTree: UrlTree = this.router.createUrlTree(router, relativeRoute);\r\n\r\n        return this.router.isActive(itemUrlTree, false);\r\n    }\r\n\r\n    private link(): void {\r\n        if (this.active) {\r\n            this.navigate(this.active);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public navigate(item: TiLeftmenuItem): void {\r\n        if (TiLeftmenuComponent.isDefaultActiveChildRoute(item)) {\r\n            //  routeConfig 可能为null\r\n            if (!this.activeRoute.routeConfig) {\r\n                return;\r\n            }\r\n            const path: string = this.activeRoute.routeConfig.path;\r\n            const url: string = this.router.routerState.snapshot.url;\r\n            const rootUrl: string = url.split(path)[0];\r\n            // 绝对路径跳转\r\n            this.router.navigate([rootUrl + path], item.routerExtras);\r\n        } else {\r\n            this.router.navigate(item.router, this.getNavigationExtras(item.routerExtras));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 点击当前选中项时，触发内容区重载\r\n     * @param item 当前点击项\r\n     */\r\n    public triggerReload(item: TiLeftmenuItem): void {\r\n        // 使reloadState由false变为true,配合内容区的ngIf做到内容区的重载\r\n        this.reloadStateChange.emit(false);\r\n        setTimeout(() => {\r\n            this.reloadStateChange.emit(true);\r\n            // 如果当前路由就是item.router对应路由，则此导航不作用(路由相同)；\r\n            // 如果当前路由是item.routerList中的路由，则需要跳转到item.router对应路由\r\n            this.navigate(item);\r\n        }, 0);\r\n    }\r\n\r\n    private getNavigationExtras(routerExtras: Object): Object {\r\n        return { relativeTo: this.activeRoute, ...routerExtras};\r\n    }\r\n\r\n    private getRelativeRoute(routerExtras: Object): NavigationExtras {\r\n        if (!routerExtras || !routerExtras['relativeTo']) {\r\n            return { relativeTo: this.activeRoute };\r\n        }\r\n\r\n        return { relativeTo: routerExtras['relativeTo'] };\r\n    }\r\n        /**\r\n     * 得到浏览器滚动条的宽度和高度\r\n     * 代表滚动条的方向，取值为X or Y\r\n     */\r\n    private getScrollbarSize(direction: string): number {\r\n        const outerDiv: any = this.renderer.createElement('div');\r\n        const innerDiv: any = this.renderer.createElement('div');\r\n\r\n        this.renderer.setStyle(innerDiv, 'width', '100%');\r\n        this.renderer.setStyle(innerDiv, 'height', '100%');\r\n\r\n        this.renderer.appendChild(outerDiv, innerDiv);\r\n        this.tiRenderer.setStyles(outerDiv, {\r\n            position: 'absolute',\r\n            top: '-9999px',\r\n            left: '-9999px',\r\n            width: '100px',\r\n            height: '100px',\r\n            overflow: 'hidden'\r\n        });\r\n\r\n        this.renderer.appendChild(this.document.body, outerDiv);\r\n\r\n        const field: string = direction === 'X' ? 'height' : 'width';\r\n        const noScrollSize: number = typeof innerDiv.getBoundingClientRect === 'function' ? innerDiv.getBoundingClientRect()[field] : 0;\r\n        this.renderer.setStyle(outerDiv, 'overflow', 'scroll');\r\n        const withScrollSize: number = typeof innerDiv.getBoundingClientRect === 'function' ? innerDiv.getBoundingClientRect()[field] : 0;\r\n        this.document.body.removeChild(outerDiv);\r\n\r\n        return parseFloat((noScrollSize - withScrollSize).toFixed(1));\r\n\r\n    }\r\n}\r\n","import {\r\n  Component\r\n} from '@angular/core';\r\n/**\r\n * TiLeftmenuHead是菜单头部组件，其包裹的元素会作为leftmenu的菜单头部\r\n */\r\n@Component({\r\n  selector: 'ti-leftmenu-head',\r\n  templateUrl: './leftmenu-head.html',\r\n  host: {\r\n    '[class.ti3-leftmenu-head]': 'true'\r\n  }\r\n})\r\nexport class TiLeftmenuHeadComponent {\r\n}\r\n","import { Component } from \"@angular/core\";\r\n/**\r\n * TiLeftmenuGroupItem 是分组菜单文本内容组件，嵌在 TiLeftmenuGroupComponent组件中使用，其包裹的元素会作为 leftmenu 的分组菜单项内容显示\r\n *\r\n * 3.1.3新增\r\n *\r\n */\r\n@Component({\r\n    selector: 'ti-leftmenu-group-item',\r\n    templateUrl: './leftmenu-group-item.html'\r\n})\r\n\r\nexport class TiLeftmenuGroupItemComponent {}\r\n","import { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';\r\nimport { Component, Input } from '@angular/core';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * TiLeftmenuGroup 是分组菜单组件，嵌在 TiLeftmenu组件中使用。\r\n *\r\n * 3.1.3新增\r\n *\r\n */\r\n@Component({\r\n    selector: 'ti-leftmenu-group',\r\n    templateUrl: './leftmenu-group.html',\r\n    host: {\r\n        '[class.ti3-leftmenu-group-container]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiLeftmenuGroupComponent extends TiBaseComponent{\r\n    /**\r\n     * 设置当前分组菜单项是否展开\r\n     */\r\n    @Input() expanded: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 当前TiLeftmenuGroup下的所有TiLeftmenuLevel1的集合\r\n     */\r\n    public children: Array<TiLeftmenuLevel1Component> = [];\r\n\r\n    /**\r\n     * @ignore\r\n     * 在模板中使用，实现分组的展开与收起\r\n     */\r\n    public clickGroup(): void {\r\n        this.expanded = !this.expanded;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 在模板中使用，当前分组中的子项是否有激活项\r\n     */\r\n    public hasActivedChild(): boolean {\r\n        if (!this.children || this.children.length <= 0) {\r\n            return false;\r\n        }\r\n\r\n        for (const level1 of this.children) {\r\n\r\n            if (level1.isActived || level1.hasActivedChildren()) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef\r\n} from '@angular/core';\r\n/**\r\n * TiLeftmenuItem 是一级菜单文本内容组件，嵌在 TiLeftmenuLevel1Component组件中使用，其包裹的元素会作为 leftmenu 的一级菜单的菜单项内容显示\r\n */\r\n@Component({\r\n  selector: 'ti-leftmenu-item',\r\n  templateUrl: './leftmenu-item.html',\r\n  host: {\r\n    '[class.ti3-leftmenu-level1-label]': 'true'\r\n  }\r\n})\r\nexport class TiLeftmenuItemComponent {\r\n  /**\r\n   * @ignore\r\n   */\r\n  public element: any;\r\n  constructor(elementRef: ElementRef) {\r\n    this.element = elementRef.nativeElement;\r\n  }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ContentChild,\r\n  ElementRef,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Optional,\r\n  Renderer2,\r\n  SecurityContext\r\n} from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\nimport { TiLeftmenuComponent, TiLeftmenuItem } from './TiLeftmenuComponent';\r\nimport { TiLeftmenuGroupComponent } from './TiLeftmenuGroupComponent';\r\nimport { TiLeftmenuLevel2Component } from './TiLeftmenuLevel2Component';\r\nimport { TiLeftmenuItemComponent } from './TiLeftmenuItemComponent';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * TiLeftmenuLevel1Component 是一级菜单组件，嵌在 TiLeftmenu 中使用\r\n *\r\n */\r\n@Component({\r\n  selector: 'ti-leftmenu-level1',\r\n  templateUrl: './leftmenu-level1.html',\r\n  host: {\r\n        '[class.ti3-leftmenu-level1]': 'true',\r\n        '[class.ti3-leftmenu-level1-dividing]': 'item.showDividingLine'\r\n    }\r\n})\r\n\r\nexport class TiLeftmenuLevel1Component extends TiBaseComponent implements AfterViewInit, OnDestroy, OnInit {\r\n    /**\r\n     * 设置当前菜单项的内容信息\r\n     *\r\n     * router(类型：Array<any>): 设置当前项对应的路由，与 Router.navigate方法的第一个参数一样；\r\n     *\r\n     * routerExtras(类型：NavigationExtras): 设置当前项对应路由的配置信息，与 Router.navigate方法的第二个参数一样；\r\n     *\r\n     * routerList(类型：Array<Array<any>>): 设置一个router路由列表，当该列表中的路由被激活时，其对应的菜单项被激活处于高亮状态。\r\n     * 其使用场景为多个路由对应同一个左侧菜单项。\r\n     *\r\n     * href(类型：string)：v10.0.1版本新增，为该菜单配置链接地址，点击后路由激活项不变，在新页面打开配置地址。\r\n     * v10.0.1 ~ v10.1.3版本存在XSS攻击(url类型)风险和用户点击这个链接并进入一个新的标签，新标签中的页面如果存在恶意代码，就可以将原网站直接导航到一个虚假网站的安全风险。\r\n     * v10.1.4 版本做了安全处理，已不存在上述两种安全问题，建议业务尽快升级版本。\r\n     */\r\n    @Input() item: TiLeftmenuItem;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ContentChild(TiLeftmenuItemComponent, /* TODO: add static flag */ { static: true }) leftmenuItem: TiLeftmenuItemComponent;\r\n    /**\r\n     * @ignore\r\n     * 当前 TiLeftmenuLevel1下所有的 TiLeftmenuLevel2 的集合\r\n     */\r\n    public children: Array<TiLeftmenuLevel2Component> = [];\r\n    /**\r\n     * @ignore\r\n     * 模板中使用，二级菜单是否展开\r\n     */\r\n    public showChildren: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 模板中使用，是否是激活状态\r\n     */\r\n    public isActived: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    private leftmenu: TiLeftmenuComponent;\r\n    private element: any;\r\n    constructor(leftmenu: TiLeftmenuComponent, private elementRef: ElementRef, renderer2: Renderer2,\r\n                private changeRef: ChangeDetectorRef, @Optional() private leftmenuGroup: TiLeftmenuGroupComponent,\r\n                private domSanitizer: DomSanitizer) {\r\n            super(elementRef, renderer2);\r\n            this.element = this.elementRef.nativeElement;\r\n            this.leftmenu = leftmenu;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if (this.leftmenuGroup) {\r\n            this.leftmenuGroup.children.push(this);\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n         this.setShowChildren();\r\n         this.setActiveState();\r\n         this.leftmenu.level1Items.push(this);\r\n         this.changeRef.detectChanges();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n       const index: number = this.leftmenu.level1Items.indexOf(this);\r\n       if (this.leftmenuGroup) {\r\n            const groupIndex: number = this.leftmenuGroup.children.indexOf(this);\r\n            if (groupIndex !== -1) {\r\n                this.leftmenuGroup.children.splice(groupIndex, 1);\r\n           }\r\n       }\r\n\r\n       if (index !== -1) {\r\n            this.leftmenu.level1Items.splice(index, 1);\r\n       }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 模板中使用，点击一级菜单项时调用\r\n     */\r\n    public selectFn(): void {\r\n        if (this.item.href) {\r\n            this.openHref(this.item.href);\r\n            this.element.querySelector('.ti3-leftmenu-level1-item')\r\n            .blur();\r\n\r\n            return;\r\n        }\r\n        const oldactive: TiLeftmenuItem = this.leftmenu.active;\r\n\r\n        if (this.hasChildren()) {\r\n            this.showChildren = !this.showChildren;\r\n            this.isActived = !this.showChildren && this.hasActivedChildren();\r\n            if (this.showChildren) {\r\n                for (const level1Items of this.leftmenu.level1Items) {\r\n                    if (level1Items === this) {\r\n                        continue;\r\n                    }\r\n                    if (level1Items.showChildren) {\r\n                        level1Items.showChildren = false;\r\n                        if (level1Items.hasActivedChildren()) {\r\n                            level1Items.isActived = true;\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (this.leftmenu.routable) {\r\n                // 点击当前已经激活的item时，刷新对应路由\r\n                if (this.item === oldactive) {\r\n                    this.leftmenu.triggerReload(this.item);\r\n                } else {\r\n                    // 点击其他项需要进行跳转，来触发路由守卫，实际是否跳转取决于路由守卫返回值。\r\n                    this.leftmenu.navigate(this.item);\r\n                }\r\n            } else {\r\n                if (this.item !== oldactive) {\r\n                    this.leftmenu.active = this.item;\r\n                    this.leftmenu.activeChange.emit(this.item);\r\n                    this.isActived = true;\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 在 TiLeftmenuComponent.ts 中调用了\r\n     */\r\n    public setShowChildren(): void {\r\n        // 初始化时，子菜单中有当前选中状态时，显示子菜单\r\n        this.showChildren = this.hasActivedChildren();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 在模板上使用\r\n     */\r\n    public hasChildren(): boolean {\r\n        return this.children && this.children.length > 0;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 在模板上使用\r\n     */\r\n    public hasActivedChildren(): boolean {\r\n        if (!this.hasChildren()) {\r\n            return false;\r\n        }\r\n\r\n        const result: Array<TiLeftmenuLevel2Component> = this.children.filter((level2: TiLeftmenuLevel2Component) => {\r\n            return level2.item === this.leftmenu.active;\r\n        });\r\n\r\n        return result.length > 0;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 设置当前菜单是否处于激活状态，下边两种情况下将当前菜单设置为激活状态：\r\n     *\r\n     * 有子菜单时，当子菜单有有激活状态项并且子菜单关闭状态情况下；\r\n     *\r\n     * 没有子菜单时，当前菜单就是激活菜单项。\r\n     */\r\n    public setActiveState(): void {\r\n        this.isActived = (this.hasActivedChildren() && !this.showChildren)\r\n            || this.item === this.leftmenu.active;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onStateIconClick(): void {\r\n      Util.trigger(this.leftmenuItem.element, 'click');\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 如果有链接，跳转新页面\r\n     */\r\n    public openHref(href: string): void {\r\n        const newTab: any = window.open(this.domSanitizer.sanitize(SecurityContext.URL, href), '_blank');\r\n        // IE 下有时 newTab 不存在\r\n        if (newTab) {\r\n            newTab.opener = null;\r\n        }\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  Renderer2,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  AfterViewInit,\r\n  NgZone\r\n} from '@angular/core';\r\nimport { TiLeftmenuComponent, TiLeftmenuItem } from './TiLeftmenuComponent';\r\nimport { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * TiLeftmenuLevel2Component 是二级菜单组件，嵌在 TiLeftmenuLevel1 中使用\r\n */\r\n@Component({\r\n  selector: 'ti-leftmenu-level2',\r\n  templateUrl: './leftmenu-level2.html',\r\n  host: {\r\n    '[class.ti3-leftmenu-level2]': 'true',\r\n    '[class.ti3-leftmenu-level2-active]': 'this.item === this.leftmenu.active',\r\n    '[attr.tabindex]': '0',\r\n    '[id]': 'appendId(\"leftmenu_level2\")',\r\n    '(click)': 'selectFn()',\r\n    '(keyup.enter)': 'selectFn()'\r\n  }\r\n})\r\n\r\nexport class TiLeftmenuLevel2Component extends TiBaseComponent implements OnInit, OnDestroy, AfterViewInit {\r\n  /**\r\n   * 设置当前菜单项的内容信息\r\n   *\r\n   * router(类型：Array<any>): 设置当前项对应的路由，与 Router.navigate方法的第一个参数一样；\r\n   *\r\n   * routerExtras(类型：NavigationExtras): 设置当前项对应路由的配置信息，与 Router.navigate方法的第二个参数一样；\r\n   *\r\n   * routerList(类型：Array<Array<any>>): 设置一个router路由列表，当该列表中的路由被激活时，其对应的菜单项被激活处于高亮状态。\r\n   * 其使用场景为多个路由对应同一个左侧菜单项。\r\n   *\r\n   * href(类型：string)：v10.0.1版本新增，为该菜单配置链接地址，点击后路由激活项不变，在新页面打开配置地址。\r\n   * v10.0.1 ~ v10.1.3版本存在XSS攻击(url类型)风险和用户点击这个链接并进入一个新的标签，新标签中的页面如果存在恶意代码，就可以将原网站直接导航到一个虚假网站的安全风险。\r\n   * v10.1.4 版本做了安全处理，已不存在上述两种安全问题，建议业务尽快升级版本。\r\n   */\r\n  @Input() item: TiLeftmenuItem;\r\n  /**\r\n   * @ignore\r\n   */\r\n  public leftmenu: TiLeftmenuComponent;\r\n  public level2Ele: any;\r\n  public renderer: any;\r\n\r\n  constructor(elementRef: ElementRef, renderer2: Renderer2, leftmenu: TiLeftmenuComponent, private level1: TiLeftmenuLevel1Component\r\n    ,private zone: NgZone) {\r\n    super(elementRef, renderer2);\r\n    this.leftmenu = leftmenu;\r\n    this.level2Ele = elementRef;\r\n    this.renderer = renderer2;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.level1.children.push(this);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.renderer.listen(this.level2Ele.nativeElement, 'mousedown', (): void => {\r\n          this.renderer.setStyle(this.level2Ele.nativeElement, 'outline', 'none');\r\n      });\r\n      this.renderer.listen(this.level2Ele.nativeElement, 'blur', (): void => {\r\n          this.renderer.setStyle(this.level2Ele.nativeElement, 'outline', '');\r\n      });\r\n    });\r\n}\r\n  /**\r\n   * @ignore\r\n   * 模板中使用，点击二级菜单项时调用\r\n   */\r\n  public selectFn(): void {\r\n    if (this.item.href) {\r\n      this.level1.openHref(this.item.href);\r\n      this.level2Ele.nativeElement.blur(); // 为了没有outline。\r\n\r\n      return;\r\n    }\r\n\r\n    if (this.leftmenu.routable) {\r\n      // 点击当前已经激活的item时，刷新对应路由\r\n      if (this.leftmenu.active === this.item) {\r\n         this.leftmenu.triggerReload(this.item);\r\n      } else {\r\n        // 点击其他项需要进行跳转，来触发路由守卫，实际是否跳转取决于路由守卫返回值。\r\n        this.leftmenu.navigate(this.item);\r\n      }\r\n    } else {\r\n      if (this.leftmenu.active !== this.item) {\r\n        this.leftmenu.active = this.item;\r\n        this.leftmenu.activeChange.emit(this.item);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n       const index: number = this.level1.children.indexOf(this);\r\n       if (index !== -1) {\r\n            this.level1.children.splice(index, 1);\r\n       }\r\n    }\r\n}\r\n","import { TiLeftmenuComponent } from './TiLeftmenuComponent';\r\nimport { Component, ElementRef, Renderer2 } from '@angular/core';\r\n@Component({\r\n    selector: 'ti-leftmenu-foot',\r\n    templateUrl: './leftmenu-foot.html',\r\n    host: {\r\n        '[class.ti3-leftmenu-foot]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiLeftmenuFootComponent {\r\n    constructor(private renderer2: Renderer2, private elementRef: ElementRef, private tiLeftmenu: TiLeftmenuComponent) {}\r\n\r\n    ngAfterViewInit(): void {\r\n        const templateDom: any = this.renderer2.createElement('div');\r\n        const panelDom: any = this.tiLeftmenu.nativeElement.querySelector('.ti3-leftmenu-panel');\r\n        const hostElement: any = this.elementRef.nativeElement;\r\n        // 修复SSR错误：ERROR ReferenceError: getComputedStyle is not defined\r\n        const spaceRight: string = typeof getComputedStyle === 'function' ? getComputedStyle(hostElement).getPropertyValue('stroke-width') : '0';\r\n\r\n        this.renderer2.setStyle(templateDom, 'height', hostElement.offsetHeight + 'px');\r\n        this.renderer2.appendChild(panelDom, templateDom);\r\n\r\n        this.renderer2.setStyle(hostElement, 'width', `calc(100% - ${this.tiLeftmenu.scrollWidth}px)`);\r\n        this.renderer2.setStyle(hostElement, 'marginRight', `${this.tiLeftmenu.scrollWidth}px`);\r\n        this.renderer2.setStyle(hostElement, 'paddingRight', `calc(${spaceRight} - ${this.tiLeftmenu.scrollWidth}px)`);\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiLeftmenuComponent } from './TiLeftmenuComponent';\r\nimport { TiLeftmenuHeadComponent } from './TiLeftmenuHeadComponent';\r\nimport { TiLeftmenuGroupItemComponent } from './TiLeftmenuGroupItemComponent';\r\nimport { TiLeftmenuGroupComponent } from './TiLeftmenuGroupComponent';\r\nimport { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';\r\nimport { TiLeftmenuItemComponent } from './TiLeftmenuItemComponent';\r\nimport { TiLeftmenuLevel2Component } from './TiLeftmenuLevel2Component';\r\nimport { TiLeftmenuFootComponent } from './TiLeftmenuFootComponent';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiRendererModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiLeftmenuComponent,\r\n            TiLeftmenuHeadComponent,\r\n            TiLeftmenuLevel1Component,\r\n            TiLeftmenuItemComponent,\r\n            TiLeftmenuLevel2Component,\r\n            TiLeftmenuGroupComponent,\r\n            TiLeftmenuGroupItemComponent,\r\n            TiLeftmenuFootComponent],\r\n  declarations: [TiLeftmenuComponent,\r\n                 TiLeftmenuHeadComponent,\r\n                 TiLeftmenuLevel1Component,\r\n                 TiLeftmenuItemComponent,\r\n                 TiLeftmenuLevel2Component,\r\n                 TiLeftmenuGroupComponent,\r\n                 TiLeftmenuGroupItemComponent,\r\n                 TiLeftmenuFootComponent]\r\n})\r\nexport class TiLeftmenuModule {\r\n}\r\nexport * from './TiLeftmenuComponent';\r\nexport { TiLeftmenuComponent, TiLeftmenuItem } from './TiLeftmenuComponent';\r\nexport { TiLeftmenuHeadComponent } from './TiLeftmenuHeadComponent';\r\nexport { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';\r\nexport { TiLeftmenuItemComponent } from './TiLeftmenuItemComponent';\r\nexport { TiLeftmenuLevel2Component } from './TiLeftmenuLevel2Component';\r\nexport { TiLeftmenuGroupComponent } from './TiLeftmenuGroupComponent';\r\nexport { TiLeftmenuGroupItemComponent } from './TiLeftmenuGroupItemComponent';\r\nexport { TiLeftmenuFootComponent } from './TiLeftmenuFootComponent';\r\n","import { NgModule } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: []\r\n})\r\nexport class TiTableFixedHeadServiceModule {\r\n}\r\n","import { Injectable, Renderer2, RendererFactory2 } from '@angular/core';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiTableFixedHeadServiceModule } from './TiTableFixedHeadServiceModule';\r\nimport { ResizableOpts, TiColsResizableDirective } from './TiColsResizableDirective';\r\nimport { TiTableComponent } from './TiTableComponent';\r\n/**\r\n * @ignore\r\n * 提供表头锁定功能\r\n */\r\n@Injectable({\r\n    providedIn: TiTableFixedHeadServiceModule\r\n})\r\nexport class TiTableFixedHeadService {\r\n    private renderer: Renderer2;\r\n    constructor(rendererFactory: RendererFactory2,\r\n                private tiRenderer: TiRenderer) {\r\n        this.renderer = rendererFactory.createRenderer(null, null);\r\n    }\r\n\r\n    public getTheadContainer(hostEle: any): any {\r\n        return this.tiRenderer.findChildrenByClassName(hostEle, 'ti3-table-fixed-head')[0];\r\n    }\r\n\r\n    public getTbodyContainer(theadContainer: any): any {\r\n        const tbodyContainer: any = theadContainer.nextElementSibling;\r\n        if (tbodyContainer && this.tiRenderer.hasClass(tbodyContainer, 'ti3-table-container')) {\r\n            return tbodyContainer;\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    public processOverflowY(theadContainer: any, tbodyContainer: any, tableCom: TiTableComponent): void {\r\n        const headTable: any = theadContainer.children[0];\r\n        const scrollBarWidth: number = this.getScrollBarWidth('Y');\r\n        const isOverflowedY: boolean = this.overflowedResult(tbodyContainer, 'Y');\r\n        const isOverflowedX: boolean = this.overflowedResult(tbodyContainer, 'X');\r\n        // 根据表体的宽度来设置表头的宽度\r\n        if (isOverflowedY && !isOverflowedX) {\r\n            this.renderer.setStyle(headTable, 'width', `calc(100% - ${scrollBarWidth}px)`);\r\n        } else {\r\n            this.renderer.setStyle(headTable, 'width', '100%');\r\n        }\r\n\r\n        const fixheadFiller: any = this.tiRenderer.findChildrenByClassName(theadContainer, 'ti3-table-fixed-head-filler')[0];\r\n        // 1px为经验值，避免计算的误差导致填充块和表头之间有一点空白间隔\r\n        const fillerWidth: number = scrollBarWidth + 1;\r\n        // 根据Y轴是否有滚动条来控制表头右侧的填充块的有无\r\n        if (isOverflowedY) {\r\n            if (tableCom.fixedColumnInfo.thFixedRight) {\r\n                this.renderer.setStyle(tableCom.fixedColumnInfo.thFixedRight, 'right', `${scrollBarWidth}px`);\r\n            }\r\n\r\n            if (fixheadFiller) {\r\n                this.renderer.setStyle(fixheadFiller, 'width', fillerWidth + 'px');\r\n\r\n                return;\r\n            }\r\n\r\n            const headerFiller: any = document.createElement('div');\r\n            this.renderer.addClass(headerFiller, 'ti3-table-fixed-head-filler');\r\n            this.renderer.setStyle(headerFiller, 'width', fillerWidth + 'px');\r\n            theadContainer.appendChild(headerFiller);\r\n        } else if (fixheadFiller) {\r\n            this.renderer.removeChild(theadContainer, fixheadFiller);\r\n            if (tableCom.fixedColumnInfo.thFixedRight) {\r\n                this.renderer.setStyle(tableCom.fixedColumnInfo.thFixedRight, 'right', 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    public removeTbodyContainerBorderBottom(tbodyContainer: any, displayedData: Array<Object>): void {\r\n        const tbody: any = tbodyContainer.children[0].children[1];\r\n        const hasNodataTbody: any = this.tiRenderer.findChildrenByClassName(tbody, 'ti3-table-nodata').length > 0;\r\n        const hasNodataGuideTbody: any = this.tiRenderer.findChildrenByClassName(tbody, 'ti3-table-nodata-guide').length > 0;\r\n        const hasLoadfailTbody: any = this.tiRenderer.findChildrenByClassName(tbody, 'ti3-table-loadfail').length > 0;\r\n        const hasNodataSimpleTbody: any = this.tiRenderer.findChildrenByClassName(tbody,'ti3-table-nodata-simple').length > 0;\r\n        // 判断是否包含表格无数据，有图片是大间距，其他场景全部为单行文字样式，包括以下四种情况；\r\n        // 1、表格无数据：ti-table-nodata（有图片）；\r\n        // 2、查询内容为空，提示用户'购买商品'：ti-table-nodata-guide；\r\n        // 3、加载不成功，提示'重新加载'：ti-table-loadfail。\r\n        // 4. 表格无数据：ti-table-nodata-simple，只有文字提示（无图片）\r\n        const noBorderTerm: any = hasNodataTbody || hasNodataGuideTbody || hasLoadfailTbody || hasNodataSimpleTbody;\r\n\r\n        if (displayedData.length === 0 && noBorderTerm) {\r\n            this.renderer.setStyle(tbodyContainer, 'border-bottom', 'none');\r\n        } else {\r\n            this.renderer.setStyle(tbodyContainer, 'border-bottom', '');\r\n        }\r\n    }\r\n\r\n    // 由于用scrollHeight计算在IE和火狐下偶尔有1px的误差，\r\n    // 所以此处直接获取表格更准确的高度和容器的clientHeight作对比\r\n    public overflowedResult(tbodyContainer: any, direction: string, isNum?: boolean): any {\r\n        let containerSize: number = 0;\r\n        let tbodySize: number = 0;\r\n        const tbodyTable: any = tbodyContainer.children[0];\r\n        if (direction === 'X') {\r\n            containerSize = tbodyContainer.clientWidth;\r\n            // 修复SSR错误：ERROR TypeError: tbodyTable.getBoundingClientRect is not a function\r\n            if (typeof tbodyTable.getBoundingClientRect !== 'function') {\r\n                return;\r\n            }\r\n            tbodySize = this.numRound(tbodyTable.getBoundingClientRect().width, 0);\r\n        } else {\r\n            containerSize = tbodyContainer.clientHeight;\r\n            // 修复SSR错误：ERROR TypeError: tbodyTable.getBoundingClientRect is not a function\r\n            if (typeof tbodyTable.getBoundingClientRect !== 'function') {\r\n                return;\r\n            }\r\n            tbodySize = this.numRound(tbodyTable.getBoundingClientRect().height, 0);\r\n        }\r\n\r\n        // 若isNum为true，返回差值，否则返回布尔值\r\n        return isNum ? (tbodySize - containerSize) : (tbodySize > containerSize);\r\n    }\r\n\r\n    public processYScrollStateChange(colsResizableDire: TiColsResizableDirective): void {\r\n        const options: ResizableOpts = colsResizableDire.resizableOpts;\r\n        // 主要处理 columns 初始异步的场景\r\n        if (!options.ths || options.ths.length === 0) {\r\n            return;\r\n        }\r\n        const tbodyContainer: any = colsResizableDire.tableCom.tbodyContainer;\r\n        const theadContainer: any = colsResizableDire.tableCom.theadContainer;\r\n        const newYScrollState: boolean = this.overflowedResult(tbodyContainer, 'Y');\r\n        if (newYScrollState === options.yScrollState) {\r\n            this.processOverflowY(theadContainer, tbodyContainer, colsResizableDire.tableCom);\r\n\r\n            return;\r\n        }\r\n\r\n        const newXScrollState: boolean = this.overflowedResult(tbodyContainer, 'X');\r\n        let lastColIndex: number = options.ths.length - 1;\r\n        let lastTh: any = options.ths[lastColIndex];\r\n        let lastThWidth: number = options.storedSizes[lastColIndex];\r\n        const scrollBarWidth: number = this.getScrollBarWidth('Y');\r\n        // 纵向滚动条由无到有\r\n        if (newYScrollState) {\r\n            if (newXScrollState && newXScrollState === options.xScrollState) {\r\n                options.storeTableWidthChange += scrollBarWidth;\r\n            } else {\r\n                // 第一次纵向滚动条状态发生变化要减小表格宽度时，去减小非特殊列中宽度最大的一列的宽度\r\n                // 这样处理是为了避免最后一列的宽度变小\r\n                if (colsResizableDire.isfirstYScrollStateChange) {\r\n                    lastTh = this.getMaxWidthTh(colsResizableDire);\r\n                    if (lastTh) {\r\n                        lastColIndex = parseInt(lastTh.getAttribute('ti-visible-index'), 10);\r\n                        lastThWidth = options.storedSizes[lastColIndex];\r\n                    }\r\n                }\r\n                options.storedSizes[lastColIndex] = lastThWidth - scrollBarWidth;\r\n            }\r\n\r\n            // 纵向滚动条由有到无\r\n        } else {\r\n            if (newXScrollState === options.xScrollState) {\r\n                if (newXScrollState) {\r\n                    options.storeTableWidthChange -= scrollBarWidth;\r\n                } else {\r\n                    options.storedSizes[lastColIndex] = lastThWidth + scrollBarWidth;\r\n                }\r\n            } else if (!newXScrollState) {\r\n                options.storedSizes[lastColIndex] = lastThWidth + (scrollBarWidth -\r\n                    options.storeTableWidthChange);\r\n                options.storeTableWidthChange = 0;\r\n            }\r\n        }\r\n        if (lastTh) {\r\n            colsResizableDire.setWidth(lastTh, options.storedSizes[lastColIndex]);\r\n            colsResizableDire.setWidth(options.secondThs[lastColIndex], options.storedSizes[lastColIndex]);\r\n        }\r\n\r\n        this.processOverflowY(theadContainer, tbodyContainer, colsResizableDire.tableCom);\r\n        colsResizableDire.isfirstYScrollStateChange = false;\r\n        options.xScrollState = this.overflowedResult(tbodyContainer, 'X');\r\n        options.yScrollState = this.overflowedResult(tbodyContainer, 'Y');\r\n\r\n        // 纵向滚动条状态改变时可能会引起列宽改变和横向滚动条状态改变，所以要处理列固定\r\n        if (colsResizableDire.tableCom.fixedColumnInfo.hasFixedColumn) {\r\n            colsResizableDire.tableCom.processFixedColumn();\r\n        }\r\n    }\r\n\r\n    private getMaxWidthTh(colsResizableDire: TiColsResizableDirective): any {\r\n        const options: ResizableOpts = colsResizableDire.resizableOpts;\r\n        colsResizableDire.updateStoredSizes();\r\n\r\n        const ths: Array<any> = options.ths.filter((th: any) => {\r\n            // 排除最后一列和不可拖动的列\r\n            return !th.hasAttribute(colsResizableDire.notResizableAttr) && !colsResizableDire.isLastColumn(th);\r\n        });\r\n\r\n        // 按列宽从小到大排序\r\n        const sortedThs: Array<any> = ths.sort((a: any, b: any) => {\r\n            const indexA: number = parseInt(a.getAttribute('ti-visible-index'), 10);\r\n            const indexB: number = parseInt(b.getAttribute('ti-visible-index'), 10);\r\n\r\n            return options.storedSizes[indexA] - options.storedSizes[indexB];\r\n        });\r\n\r\n        // 返回宽度最大的列\r\n        return sortedThs[sortedThs.length - 1];\r\n    }\r\n\r\n    // 处理在列拖动过程中横向滚动条的出现引起纵向滚动条出现时的账本(storeColsWidthChange)的变化\r\n    public handleYOverflowedWithX(resizableOpts: ResizableOpts, tbodyContainer: any): void {\r\n        const newYScrollState: boolean = this.overflowedResult(tbodyContainer, 'Y');\r\n\r\n        if (newYScrollState === resizableOpts.yScrollState) {\r\n            return;\r\n        }\r\n\r\n        const scrollBarWidth: number = this.getScrollBarWidth('Y');\r\n        const newXScrollState: boolean = this.overflowedResult(tbodyContainer, 'X');\r\n        if (newYScrollState) {\r\n            resizableOpts.storeTableWidthChange += scrollBarWidth;\r\n            resizableOpts.isYOverflowedWithX = true;\r\n        }\r\n\r\n        resizableOpts.xScrollState = newXScrollState;\r\n        resizableOpts.yScrollState = newYScrollState;\r\n    }\r\n\r\n    public handleYNotOverflowedWithX(resizableOpts: ResizableOpts, tbodyContainer: any): void {\r\n        const scrollBarWidthX: number = this.getScrollBarWidth('X');\r\n        const scrollBarWidthY: number = this.getScrollBarWidth('Y');\r\n        const overflowedHeight: number = this.overflowedResult(tbodyContainer, 'Y', true);\r\n        const overflowedWidth: number = this.overflowedResult(tbodyContainer, 'X', true);\r\n        // 当列拖动横向滚动条出现导致纵向滚动条出现后，再缩小列宽时，由于无法准确获得横向滚动条消失的时刻去对表格\r\n        // 宽度做补偿，所以当表格列宽到达容器边界附近时，用临时将overflow-x设为hidden的方式使横向滚动条消失。\r\n        if (resizableOpts.isYOverflowedWithX && overflowedHeight > 0 && overflowedHeight <= scrollBarWidthX &&\r\n            overflowedWidth > 0 && overflowedWidth <= scrollBarWidthY) {\r\n            this.renderer.setStyle(tbodyContainer, 'overflow-x', 'hidden');\r\n            // 对账本(storeTableWidthChange)清零\r\n            resizableOpts.storeTableWidthChange = 0;\r\n            resizableOpts.isYOverflowedWithX = false;\r\n\r\n            setTimeout(() => {\r\n                this.renderer.setStyle(tbodyContainer, 'overflow-x', 'auto');\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    // 获取滚动条宽度\r\n    public getScrollBarWidth(direction: string): number {\r\n        const temporaryDiv: any = document.createElement('div');\r\n        this.tiRenderer.setStyles(temporaryDiv, {\r\n            position: 'absolute',\r\n            top: '-9999px',\r\n            left: '-9999px',\r\n            width: '100px',\r\n            height: '100px',\r\n            overflow: 'hidden'\r\n        });\r\n        const nestDiv: any = document.createElement('div');\r\n        this.tiRenderer.setStyles(nestDiv, { width: '100%', height: '100%' });\r\n        temporaryDiv.appendChild(nestDiv);\r\n        document.body.appendChild(temporaryDiv);\r\n        const noScrollWidth: number = nestDiv.getBoundingClientRect().width;\r\n        const noScrollHeight: number = nestDiv.getBoundingClientRect().height;\r\n        this.renderer.setStyle(temporaryDiv, 'overflow', 'scroll');\r\n        const scrollWidth: number = nestDiv.getBoundingClientRect().width;\r\n        const scrollHeight: number = nestDiv.getBoundingClientRect().height;\r\n        this.renderer.removeChild(document.body, temporaryDiv);\r\n        const scrollBarWidthX: number = this.numRound(noScrollHeight - scrollHeight, 1);\r\n        const scrollBarWidthY: number = this.numRound(noScrollWidth - scrollWidth, 1);\r\n\r\n        return direction === 'X' ? scrollBarWidthX : scrollBarWidthY;\r\n    }\r\n\r\n    // 对浮点数四舍五入保留指定小数位数的数字\r\n    public numRound(num: number, decimal: number): number {\r\n        return parseFloat(num.toFixed(decimal));\r\n    }\r\n}\r\n","import {\r\n    AfterViewChecked,\r\n    AfterViewInit,\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    IterableChanges,\r\n    IterableDiffer,\r\n    IterableDiffers,\r\n    NgZone,\r\n    OnDestroy,\r\n    OnInit,\r\n    Output,\r\n    Renderer2,\r\n    ViewEncapsulation\r\n} from '@angular/core';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { Util } from '../../utils/Util';\r\nimport { Subject } from 'rxjs';\r\nimport { TiTableFixedHeadService } from './TiTableFixedHeadService';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * TiTable 组件上 srcData 输入接口中 state 属性值的类型接口\r\n */\r\nexport interface TiTableSrcState {\r\n    /**\r\n     * 传给组件的表格源数据是否已经过搜索处理\r\n     */\r\n    searched: boolean;\r\n    /**\r\n     * 传给组件的表格源数据是否已经过排序处理\r\n     */\r\n    sorted: boolean;\r\n    /**\r\n     * 传给组件的表格源数据是否已经过分页处理\r\n     */\r\n    paginated: boolean;\r\n}\r\n/**\r\n * 表格当前数据的搜索、排序、分页状态值接口\r\n */\r\nexport interface TiTableDataState {\r\n    /**\r\n     * 搜索状态，其包含两个属性：\r\n     *\r\n     * searchWords：类型为Array<string>，搜索字符串集合\r\n     *\r\n     * searchKeys：类型为Array，搜索指定的字段范围\r\n     *\r\n     */\r\n    search: { searchWords: Array<string>, searchKeys?: Array<string> };\r\n    /**\r\n     * 排序状态，其包含两个属性：\r\n     *\r\n     * sortKey：类型为 String，进行排序的数据属性\r\n     *\r\n     * asc：类型为 Boolean，是否为升序\r\n     *\r\n     */\r\n    sort: { sortKey: string, asc: boolean };\r\n    /**\r\n     * 分页状态，其包含两个属性：\r\n     *\r\n     * currentPage：类型Number，表示当前页\r\n     *\r\n     * itemsPerPage：类型为Number，每页显示条数\r\n     *\r\n     */\r\n    pagination: { currentPage: number, itemsPerPage: number};\r\n}\r\n\r\n/**\r\n * 表格行数据类型接口\r\n */\r\nexport interface TiTableRowData {\r\n    /**\r\n     * 控制当前详情行是否展开\r\n     *\r\n     */\r\n    showDetails?: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     *\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * TiTable 组件上 srcData 输入接口的数据类型接口\r\n */\r\nexport interface TiTableSrcData {\r\n    state: TiTableSrcState;\r\n    /**\r\n     * 表格源数据\r\n     *\r\n     */\r\n    data: Array<TiTableRowData>;\r\n}\r\n\r\n/**\r\n * 表格的各列信息\r\n *\r\n */\r\nexport interface TiTableColumns {\r\n    /**\r\n     * 表头列文本内容。当某一列的title为空字符串时，当前列一直在表格中显示，但是不出现在控制列动态\r\n     * 隐藏/显示 设置面板中，例如单选列、多选列、详情展开图标列;\r\n     *\r\n     */\r\n    title?: string;\r\n    /**\r\n     * 设置列宽，支持百分比和px值;\r\n     */\r\n    width?: string;\r\n    /**\r\n     * 此属性只有在表格具有列动态 显示/隐藏 功能时才需要设置，show可以分别设置如下值：\r\n     *\r\n     *  true： 表示该列默认显示，用户可以通过面板操作切换其 显示/隐藏 状态。\r\n     *\r\n     *  false : 表示该列默认隐藏，用户可以通过面板操作切换其 显示/隐藏 状态。\r\n     *\r\n     *  undefined : 表示该列不具备动态 显示/隐藏 功能，固定显示。\r\n     *\r\n     * 注意：设置show属性值时，title为空字符串时，该列固定显示，但不出现在列操作面板中。\r\n     */\r\n    show?: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n\r\n/**\r\n * 表格当前页、每页个数记忆开关\r\n * 10.1.2版本新增\r\n */\r\nexport interface TiPaginationStorageConfig {\r\n    currentPage?: boolean;\r\n    itemsPerPage?: boolean;\r\n}\r\n/**\r\n * 表格记忆各项开关\r\n * 10.0.4 新增\r\n */\r\nexport interface TiTableStorageConfig {\r\n    /**\r\n     * 排序\r\n     */\r\n    sort: boolean;\r\n    /**\r\n     * 分页\r\n     */\r\n    pagination: boolean | TiPaginationStorageConfig;\r\n    /**\r\n     * 列宽\r\n     */\r\n    colsWidth: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * TiTable 表格组件\r\n *\r\n * 支持以表格的形式展示多条数据\r\n *\r\n * 支持前后台分页、搜索、排序、详情展开、列拖动（调整列宽）、控制列动态隐藏/显示、行复选、行单选、\r\n * 表格单元格(th, td)智能tip、树表、列文本对齐方式、表头固定等功能\r\n *\r\n * <example-url>../tiny3demo/#/table/table-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-table',\r\n    templateUrl: './table.html',\r\n    styleUrls: ['./table.less'],\r\n    encapsulation: ViewEncapsulation.None,\r\n    host: {\r\n        '[class.ti3-table]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiTableComponent extends TiBaseComponent implements OnInit, AfterViewChecked, AfterViewInit, OnDestroy {\r\n    private static DEFAULT_SRC_DATA: TiTableSrcData = {\r\n        data: [],\r\n        state: {\r\n            searched: false,\r\n            sorted: false,\r\n            paginated: false\r\n        }\r\n    };\r\n    /**\r\n     * 设置表格源数据及其处理数据状态\r\n     *\r\n     * data: 表格源数据。一般情况下，前台分页时传入表格全部数据，后台分页时传入当前页数据。\r\n     *\r\n     * state: 用来标识传入的表格源数据是否已经经过排序(sorted)、过滤(searched)、分页(paginated)等处理。\r\n     *\r\n     * 应用举例：后台分页场景下，传入的data为当前页数据（即已经进行了分页），因此应将paginated设置为true；\r\n     *          如果传入的数据已经进行了排序（如后台排序场景），则应将sorted设置为true。\r\n     */\r\n    @Input() srcData: TiTableSrcData = TiTableComponent.DEFAULT_SRC_DATA;\r\n    /**\r\n     * 设置表格实时呈现的数据。表格源数据经过排序、搜索、分页处理之后即为displayedData\r\n     *\r\n     * 注意：\r\n     *\r\n     * 1. 产品在开发中，只需在初始化时将其设置为 [ ] 即可，组件内部将自动完成对其赋值和更新;\r\n     *\r\n     * 2. 开发者应该在 tbody>tr 中完成对 displayedData 的遍历和显示（如通过ngFor）。\r\n     */\r\n    @Input() displayedData: Array<TiTableRowData>; // 表格中实时展示的数据集\r\n    /**\r\n     * 表格记忆，既是开关，又是存储id, 所以每一个表格需要设置唯一值。\r\n     * 10.0.4 新增\r\n     */\r\n    @Input() storageId: string;\r\n    /**\r\n     * 表格记忆各项开关配置\r\n     * 10.0.4 新增\r\n     */\r\n    @Input() storageConfig: TiTableStorageConfig = {\r\n        sort: true,\r\n        pagination: true,\r\n        colsWidth: true,\r\n    };\r\n    /**\r\n     * 表格实时呈现的数据改变时向外通知\r\n     */\r\n    @Output() readonly displayedDataChange: EventEmitter<Array<TiTableRowData>> = new EventEmitter();\r\n    /**\r\n     * 设置表格的各列信息。开发者可以使用该接口的值在 thead>tr>th 中完成对表头内容的设置；\r\n     *\r\n     * 控件内部根据columns设置完成必要的逻辑处理。 建议对columns数组中的对象设置如下属性：\r\n     *\r\n     * title: 表头列文本内容。当某一列的title为空字符串时，当前列一直在表格中显示，但是不出现在控制列动态\r\n     *         隐藏/显示 设置面板中，例如单选列、多选列、详情展开图标列;\r\n     *\r\n     * width: 设置列宽，支持百分比和px值;\r\n     *\r\n     * show: 此属性只有在表格具有列动态 显示/隐藏 功能时才需要设置，show可以分别设置如下值：\r\n     *\r\n     *       true： 表示该列默认显示，用户可以通过面板操作切换其 显示/隐藏 状态。\r\n     *\r\n     *       false : 表示该列默认隐藏，用户可以通过面板操作切换其 显示/隐藏 状态。\r\n     *\r\n     *       undefined : 表示该列不具备动态 显示/隐藏 功能，固定显示。\r\n     *\r\n     *       注意：设置show属性值时，title为空字符串时，该列固定显示，但不出现在列操作面板中。\r\n     */\r\n    @Input() columns: Array<TiTableColumns> = [];\r\n    /**\r\n     * 设置表格搜索功能的需被检索的字符串的集合。\r\n     *\r\n     * 此接口需配合searchKeys使用。\r\n     *\r\n     *  1. searchWords长度为1时，在searchKeys指定的字段下搜索searchWords[0]指定的字符串,\r\n     *     在指定字段中的任一字段中搜索到时即满足条件(并集)。如：searchWords: ['b'],\r\n     *     searchKeys: ['firstName', 'lastName']，则在firstName字段包含‘b’，\r\n     *     或在lastName字段包含‘b’时本行数据即满足搜索条件;\r\n     *\r\n     * 2. searchWords长度大于1且searchKeys与searchWords长度相等时，在searchKeys指定的字段下搜索searchWords对应(按顺序)元素指定的字符串,\r\n     *    在指定字段中的所有字段搜索到对应字符串时才满足条件(交集)。如：searchWords: ['b', '18'],\r\n     *    searchKeys: ['firstName', 'age']，则在firstName字段包含‘b’且\r\n     *    在age字段包含‘18’时本行数据才满足搜索条件。\r\n     */\r\n    @Input() searchWords: Array<string> = null;\r\n    /**\r\n     * 为表格搜索功能指定搜索的字段范围。\r\n     *\r\n     * 此接口需配合searchWords使用。\r\n     */\r\n    @Input() searchKeys: Array<string> = null; // 是否使用null\r\n    /**\r\n     * 有详情功能时，设置组件是否开启当前页只显示一行详情的功能。\r\n     *\r\n     * 设置为true，表示表格中当前页只展示一行的详情，不设置或设为false时，可展开多行的详情。\r\n     */\r\n    @Input() closeOtherDetails: boolean = false;\r\n    /**\r\n     * 当表格数据状态变化时向外通知\r\n     *\r\n     * 1.功能描述：\r\n     *\r\n     * 状态变化指的是表格的排序、搜索、分页参数发生了变化，触发变化的原因可能是用户操作，也可能是开发者设置。\r\n     * 该回调为后台分页、后台排序和后台过滤提供了处理时机，例如，用户点击第2页时，由于页码的变化，必定会触发本回调函数，\r\n     * 进而开发者可以在该回调中向后台发请求获取第2页的数据，并赋给表格。\r\n     *\r\n     * 注意事项：初始化时不会触发该回调，只有表格状态动态改变时才会触发该回调，所以需要用户自己在初始时向后端发送请求获取表格初始化数据。\r\n     *\r\n     * 2.函数入参：TiTableComponent 组件实例\r\n     *\r\n     */\r\n    @Output() readonly stateUpdate: EventEmitter<TiTableComponent> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public hostEle: Element;\r\n    private srcDataDiffer: IterableDiffer<object>;\r\n    private data: Array<TiTableRowData>;\r\n    private promise: Promise<any> = Promise.resolve(null);\r\n    /**\r\n     * @ignore 判断是否使用了ti-head-sort组件\r\n     */\r\n    public enableSort: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public paginationSubject: Subject<any> = new Subject<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public viewInitSubject: Subject<any> = new Subject<any>();\r\n     /**\r\n     * @ignore\r\n     */\r\n    public containerScrollXChangeSubject: Subject<any> = new Subject<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public thResizeSubject: Subject<any> = new Subject<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public updateFixedThLeftSubject: Subject<any> = new Subject<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public updateFixedTdLeftSubject: Subject<any> = new Subject<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    public updateColumnsSubject: Subject<Array<TiTableColumns>> = new Subject<Array<TiTableColumns>>();\r\n    /**\r\n     * @ignore\r\n     * 其中包含了sort、search、pagination三个属性，每个属性都描述了当前表格数据的参数状态:\r\n     *\r\n     * sort：object类型，包含了sortKey（类型为string，进行排序的数据属性）、asc（类型为Boolean，是否为升序）属性；\r\n     *\r\n     * search: object类型，包含了searchWords（类型为array<string>，搜索字符串集合）、searchKeys（类型为Array，搜索指定的字段范围）属性；\r\n     *\r\n     * pagination: object类型，包含了currentPage（类型number，表示当前页）、itemsPerPage（类型为Number，每页显示条数）属性。\r\n     */\r\n    public dataState: TiTableDataState = {\r\n        search: { searchWords: null, searchKeys: null },\r\n        sort: { sortKey: '', asc: null },\r\n        pagination: { currentPage: -1, itemsPerPage: -1 }\r\n    };\r\n    /**\r\n     * @ignore 子元素需要访问，所以public\r\n     */\r\n    public localStorageState: { [propName: string]: any };\r\n    /**\r\n     * @ignore 子元素需要访问，所以public\r\n     */\r\n    public sessionStorageState: { [propName: string]: any };\r\n    private isDataStateChange: boolean = false;\r\n    private oldSearchWords: Array<string> = null;\r\n    private oldSearchKeys: Array<string> = null;\r\n    private oldPagination: {currentPage: number, itemsPerPage: number} = { currentPage: -1, itemsPerPage: -1 };\r\n    private oldSort: {sortKey: string, asc: boolean} = {sortKey: '', asc: null};\r\n    /**\r\n     * 触发 stateUpdate 的事件(即引起表格数据状态改变的起因事件)，其有\"search\", \"sort\", \"pagination\"这三个值\r\n     */\r\n    private triggerEvent: 'search' | 'sort' | 'pagination';\r\n    private searchedResult: Array<TiTableRowData> = [];\r\n    private customCompareFn: (a: TiTableRowData, b: TiTableRowData, sortKey?: string) => number;\r\n    /**\r\n     * @ignore\r\n     * 表格是否为表头锁定\r\n     */\r\n    public isFixedHead: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public theadContainer: Element;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public tbodyContainer: Element;\r\n    private oldTbodyHeight: number = 0;\r\n    private unlistenFixedHeadWindowResize: () => void;\r\n    private unlistenFixedColumnWindowResize: () => void;\r\n    private unlistenWindowBeforeunload: () => void;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public processYScrollStateChangeWithColsResizable: () => void;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public fixedColumnInfo: {\r\n        hasFixedColumn?: boolean,\r\n        container?: any,\r\n        thFixedRight?: any,\r\n        containerWidth?: number,\r\n        fixedColumnLeftValues?: Array<number>,\r\n        columnFixedLeftLastIndex?: number\r\n    } = {};\r\n\r\n    constructor(private iterableDiffers: IterableDiffers,\r\n                elementRef: ElementRef,\r\n                private fixedHeadService: TiTableFixedHeadService,\r\n                renderer: Renderer2,\r\n                private zone: NgZone,\r\n                private tiRenderer: TiRenderer) {\r\n            super(elementRef, renderer);\r\n            this.hostEle = elementRef.nativeElement;\r\n    }\r\n\r\n    /**\r\n     * 测试某一字串(testStr)中是否存在子串(key)\r\n     * @param testStr 待检索的字符串或数值\r\n     * @param key 检索的子串\r\n     */\r\n    private static isMatched(testStr: any, keywords: string): boolean {\r\n        return (Util.isString(testStr) || Util.isNumber(testStr)) ?\r\n            (String(testStr)).toLowerCase()\r\n            .indexOf(keywords.toLowerCase()) >= 0 : false;\r\n    }\r\n\r\n    private static searchByOneWord(src: Array<TiTableRowData>, searchWords: Array<string>,\r\n                                   searchKeys: Array<string>): Array<TiTableRowData> {\r\n        const output: Array<TiTableRowData> = [];\r\n        src.forEach((item: TiTableRowData) => {\r\n            if (searchKeys && searchKeys.length > 0) {\r\n                for (const key of searchKeys) {\r\n                    if (TiTableComponent.isMatched(item[key], searchWords[0])) {\r\n                        output.push(item);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                for (const key in item) {\r\n                    if (TiTableComponent.isMatched(item[key], searchWords[0])) {\r\n                        output.push(item);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return output;\r\n    }\r\n\r\n    private static searchByMoreThanOneWord(src: Array<TiTableRowData>, searchWords: Array<string>,\r\n                                           searchKeys: Array<string>): Array<TiTableRowData> {\r\n        const output: Array<TiTableRowData> = [];\r\n        src.forEach((item: TiTableRowData) => {\r\n            let isMatched: boolean = true;\r\n            for (let i: number = 0; i < searchKeys.length; i++) {\r\n                if (!TiTableComponent.isMatched(item[searchKeys[i]], searchWords[i])) {\r\n                    isMatched = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (isMatched) {\r\n                output.push(item);\r\n            }\r\n        });\r\n\r\n        return output;\r\n    }\r\n\r\n    private static getSearchedData(inputData: Array<TiTableRowData>, searchWords: Array<string>,\r\n                                   searchKeys: Array<string>): Array<TiTableRowData> {\r\n        let outData: Array<TiTableRowData> = [];\r\n\r\n        if (searchWords && searchWords.length === 1) {\r\n            outData = TiTableComponent.searchByOneWord(inputData, searchWords, searchKeys);\r\n        } else if (searchWords && searchWords.length > 1 && searchKeys &&\r\n            searchKeys.length === searchWords.length) {\r\n            outData = TiTableComponent.searchByMoreThanOneWord(inputData, searchWords, searchKeys);\r\n        }\r\n\r\n        return outData;\r\n    }\r\n\r\n    private static doCompare(a: any, b: any): number {\r\n        let result: number = 0;\r\n        if (a.type === b.type) {\r\n            if (a.value !== b.value) {\r\n                result = a.value < b.value ? -1 : 1;\r\n            }\r\n        } else {\r\n            result = a.type < b.type ? -1 : 1;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private static getPredicateValue(value: TiTableRowData, predicate: string): any {\r\n        if (!Util.isEmptyString(predicate) && value.hasOwnProperty(predicate)) {\r\n            return value[predicate];\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    private static getPredicateValueObj(value: any, index: number): {value: any, type: string} {\r\n        let resultVal: any = value;\r\n        if (value === null) {\r\n            resultVal = 'null';\r\n        } else if (Util.isString(value)) {\r\n            resultVal = value.toLowerCase();\r\n        } else if (Util.isArray(value)) {\r\n            resultVal = value.toString();\r\n        } else if (typeof value === 'object') {\r\n            resultVal = index;\r\n        } else if (Util.isFunction(value)) {\r\n            const resultValue: any = value();\r\n\r\n            return TiTableComponent.getPredicateValueObj(resultValue, index);\r\n        }\r\n        const type: string = typeof resultVal;\r\n\r\n        return { value: resultVal, type };\r\n    }\r\n\r\n    private static safeCopy(data: Array<any>): Array<any> {\r\n        return data ? [].concat(data) : [];\r\n    }\r\n\r\n    private static isValueEqual(n: any, o: any): boolean {\r\n        if (!(n instanceof Object) || !(o instanceof Object)) {\r\n            return n === o;\r\n        }\r\n\r\n        if (Util.isArray(n) && Util.isArray(o)) {\r\n            if (n.length !== o.length) {\r\n                return false;\r\n            } else {\r\n                for (let i: number = 0; i < o.length; i++) {\r\n                    if (n[i] !== o[i]) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        if (Object.keys(n).length !== Object.keys(o).length) {\r\n            return false;\r\n        } else {\r\n            for (const key in n) {\r\n                if (!o.hasOwnProperty(key) || n[key] !== o[key]) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        if (!this.srcData) {\r\n            this.srcData = TiTableComponent.DEFAULT_SRC_DATA;\r\n        }\r\n        if (!this.srcData.data) {\r\n            this.srcData.data = [];\r\n        }\r\n        this.srcDataDiffer = this.iterableDiffers.find(this.srcData.data)\r\n            .create();\r\n\r\n        if (this.searchWords !== null) {\r\n            this.oldSearchWords = TiTableComponent.safeCopy(this.searchWords);\r\n            this.dataState.search.searchWords = this.searchWords;\r\n        }\r\n\r\n        if (this.searchKeys !== null) {\r\n            this.oldSearchKeys = TiTableComponent.safeCopy(this.searchKeys);\r\n            this.dataState.search.searchKeys = this.searchKeys;\r\n        }\r\n        // 表格记忆\r\n        if (this.storageId) {\r\n            this.initStorageDataState();\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        this.initFixedHead();\r\n        if (this.fixedColumnInfo.hasFixedColumn) {\r\n            this.addFixedColumnBehavior();\r\n        }\r\n        this.viewInitSubject.next();\r\n        if (this.storageId) {\r\n            // 在ngOnDestroy 无法保存，所有使用beforeunload\r\n            // 为什么不用unload? beforeunload 兼容比unload效果好\r\n            // 参考：https://sinaad.github.io/xfe/2016/06/29/beforeunlod-vs-unload/\r\n            // 修复SSR报错：ERROR ReferenceError: window is not defined\r\n            if(typeof window ==='undefined'){\r\n                return;\r\n            }\r\n            this.unlistenWindowBeforeunload = this.renderer.listen(window, 'beforeunload', () => {\r\n                this.updateStorageDataState();\r\n            });\r\n        }\r\n    }\r\n\r\n    // 为了确保表格内嵌组件(比如tiHeadSort,tiPagination等)的数据变化在表格组件中能监听到，排序、搜索、分页\r\n    // 的相关数据监听需要放在表格组件的AfterViewChecked周期中。因为表格组件的AfterViewChecked生命周期晚于\r\n    // 内嵌组件(比如tiHeadSort,tiPagination等)的各个checked生命周期。\r\n    // tslint:disable-next-line:cyclomatic-complexity\r\n    // eslint-disable-next-line complexity\r\n    ngAfterViewChecked(): void {\r\n        // 监听srcData.data的变化\r\n        const dataArr: Array<TiTableRowData>  = this.srcData && this.srcData.data ? this.srcData.data : [];\r\n        const srcDataDiffer: IterableChanges<TiTableRowData> = this.srcDataDiffer.diff(dataArr);\r\n        if (srcDataDiffer) {\r\n            this.updateSafeCopy();\r\n            this.data2displayed();\r\n        }\r\n\r\n        // 监听search相关接口值变化\r\n        if (this.searchWords !== null &&\r\n            !TiTableComponent.isValueEqual(this.searchWords, this.oldSearchWords)) {\r\n            this.oldSearchWords = TiTableComponent.safeCopy(this.searchWords);\r\n            this.isDataStateChange = true;\r\n            this.triggerEvent = 'search';\r\n            this.dataState.search.searchWords = this.searchWords;\r\n            // 搜索时，如果使用分页时，把用于表格内部计算分页的当前页码置为1\r\n            if (this.dataState.pagination.itemsPerPage !== -1 && this.dataState.pagination.currentPage !== 1) {\r\n                this.dataState.pagination.currentPage = 1;\r\n                // 使用Promise是为了解决使用stateUpdate接口做后台分页+后台搜索时，\r\n                // 分页组件ExpressionChangedAfterItHasBeenCheckedError报错问题。\r\n                // 此处不能使用setTimeout来解决，使用setTimeout会导致stateUpdate多次执行。\r\n                this.promise.then(() => {\r\n                        this.paginationSubject.next({ currentPage: 1 });\r\n                });\r\n            }\r\n        }\r\n\r\n        if (this.searchKeys !== null && this.searchWords.length > 0 &&\r\n            !TiTableComponent.isValueEqual(this.searchKeys, this.oldSearchKeys)) {\r\n            this.oldSearchKeys = TiTableComponent.safeCopy(this.searchKeys);\r\n            this.isDataStateChange = true;\r\n            this.triggerEvent = 'search';\r\n            this.dataState.search.searchKeys = this.searchKeys;\r\n            // 搜索时，如果使用分页时，把用于表格内部计算分页的当前页码置为1\r\n            if (this.dataState.pagination.itemsPerPage !== -1 && this.dataState.pagination.currentPage !== 1) {\r\n                this.dataState.pagination.currentPage = 1;\r\n                this.promise.then(() => {\r\n                        this.paginationSubject.next({ currentPage: 1 });\r\n                });\r\n            }\r\n        }\r\n\r\n        if (!TiTableComponent.isValueEqual(this.dataState.sort, this.oldSort)) {\r\n            this.oldSort = {...this.dataState.sort};\r\n            this.isDataStateChange = true;\r\n            this.triggerEvent = 'sort';\r\n        }\r\n\r\n        if (this.dataState.pagination.currentPage !== -1 &&\r\n            this.dataState.pagination.itemsPerPage !== -1 &&\r\n            !TiTableComponent.isValueEqual(this.dataState.pagination, this.oldPagination)) {\r\n            this.oldPagination = {...this.dataState.pagination};\r\n            this.isDataStateChange = true;\r\n            this.triggerEvent = 'pagination';\r\n        }\r\n\r\n        if (this.isDataStateChange) {\r\n            this.updateTable();\r\n            this.isDataStateChange = false;\r\n        }\r\n\r\n        if (this.isFixedHead && this.getTbodyHeight() !== this.oldTbodyHeight) {\r\n            // 有些场景下(例如，两页显示数据条数相同，从其中一页跳到另一页时)获取高度不准确，\r\n            // 所以此处添加setTimeout\r\n            setTimeout(() => {\r\n                if (this.hostEle.hasAttribute('tiColsResizable') && this.processYScrollStateChangeWithColsResizable) {\r\n                    this.processYScrollStateChangeWithColsResizable();\r\n                } else {\r\n                    this.fixedHeadService.processOverflowY(this.theadContainer, this.tbodyContainer, this);\r\n                }\r\n                this.fixedHeadService.removeTbodyContainerBorderBottom(this.tbodyContainer, this.displayedData);\r\n            }, 0);\r\n            this.oldTbodyHeight = this.getTbodyHeight();\r\n        }\r\n\r\n        // 表格容器宽度改变时，列宽和横向滚动条状态都可能发生改变，这时需要处理表格列固定\r\n        if (this.fixedColumnInfo.hasFixedColumn) {\r\n            const containerWidth: number = this.fixedColumnInfo.container.clientWidth;\r\n            if (containerWidth !== this.fixedColumnInfo.containerWidth) {\r\n                this.fixedColumnInfo.containerWidth = containerWidth;\r\n                this.processFixedColumn();\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.isFixedHead && this.unlistenFixedHeadWindowResize) {\r\n            this.unlistenFixedHeadWindowResize();\r\n        }\r\n\r\n        if (this.unlistenFixedColumnWindowResize) {\r\n            this.unlistenFixedColumnWindowResize();\r\n        }\r\n\r\n        if(this.storageId) {\r\n            // 路由跳转时，页面没有刷新，beforeunload监听不生效，所以要更新一次记忆数据。\r\n            this.updateStorageDataState();\r\n            // 修复SSR错误：TypeError: this.unlistenWindowBeforeunload is not a function\r\n            (typeof this.unlistenWindowBeforeunload === 'function') && this.unlistenWindowBeforeunload();\r\n        }\r\n    }\r\n    // 初始化表格记忆\r\n    private initStorageDataState(): void {\r\n\r\n        // 修复SSR报错：ERROR ReferenceError: window is not defined\r\n        if (typeof window === 'undefined') {\r\n            return;\r\n        }\r\n        // 缓存在sessionStorage中的数据\r\n        let sessionStorageState = window.sessionStorage.getItem(this.storageId);\r\n        // 缓存在localStorage 中的数据\r\n        let localStorageState = window.localStorage.getItem(this.storageId);\r\n\r\n        // 版本发布后，用户第一次访问时，sessionStorageState、localStorageState是null\r\n        this.sessionStorageState = sessionStorageState ? JSON.parse(sessionStorageState) : {};\r\n        this.localStorageState = localStorageState ? JSON.parse(localStorageState) : {};\r\n\r\n    }\r\n    // 更新本地存储中的\r\n    private updateStorageDataState() {\r\n\r\n        const localStorageState = { ...this.localStorageState };\r\n        const sessionStorageState = { ...this.sessionStorageState };\r\n\r\n        // 排序\r\n        if (this.storageConfig.sort && this.dataState.sort.sortKey) {\r\n            sessionStorageState['sort'] = this.dataState.sort;\r\n        }\r\n\r\n        // 表格分页\r\n        // tslint:disable-next-line: max-line-length\r\n        if ((this.storageConfig.pagination === true || (this.storageConfig.pagination && this.storageConfig.pagination['itemsPerPage'] === true)) &&\r\n            this.dataState.pagination.itemsPerPage !== -1) {\r\n            // 每页条数\r\n            localStorageState['itemsPerPage'] = this.dataState.pagination.itemsPerPage;\r\n        }\r\n        // 表格分页\r\n        // tslint:disable-next-line: max-line-length\r\n        if ((this.storageConfig.pagination === true || (this.storageConfig.pagination && this.storageConfig.pagination['currentPage'] === true)) &&\r\n            this.dataState.pagination.currentPage !== -1) {\r\n            // 当前页\r\n            sessionStorageState['currentPage'] = this.dataState.pagination.currentPage;\r\n        }\r\n\r\n        if(this.dataState.search.searchKeys){\r\n            localStorageState['searchKeys'] = this.dataState.search.searchKeys\r\n        }\r\n        if(this.dataState.search.searchWords) {\r\n            localStorageState['searchWords'] = this.dataState.search.searchWords;\r\n        }\r\n\r\n        if (Object.keys(sessionStorageState).length > 0) {\r\n            // 修复：SSR报错：ReferenceError: window is not defined\r\n            (typeof window !== 'undefined') && window.sessionStorage.setItem(\r\n                this.storageId,\r\n                JSON.stringify(sessionStorageState)\r\n            );\r\n        }\r\n        if (Object.keys(localStorageState).length > 0) {\r\n            (typeof window !== 'undefined') && window.localStorage.setItem(\r\n                this.storageId,\r\n                JSON.stringify(localStorageState)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public updatePagination(currentPage: number, itemsPerPage: number): void {\r\n        if (this.oldPagination.currentPage === -1 &&\r\n            this.oldPagination.itemsPerPage === -1) {\r\n            this.oldPagination = {\r\n                currentPage,\r\n                itemsPerPage\r\n            };\r\n        }\r\n        this.dataState.pagination.currentPage = currentPage;\r\n        this.dataState.pagination.itemsPerPage = itemsPerPage;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 排序状态更新及处理\r\n     *\r\n     * @param sortKey - 进行排序的数据属性（如对数据的name属性值进行排序，则传入\"name\"）\r\n     * @param reverse - 是否为降序，true表示降序，false表示升序，null表示无序\r\n     * @param isDefaultSort - 是否为默认排序\r\n     */\r\n    public updateSort(sortKey: string, reverse: boolean, isDefaultSort: boolean,\r\n                      compareFn: (a: TiTableRowData, b: TiTableRowData, sortKey?: string) => number): void {\r\n        if (isDefaultSort) {\r\n            this.oldSort = {\r\n                sortKey,\r\n                asc: !reverse\r\n            };\r\n        }\r\n        this.dataState.sort.sortKey = sortKey;\r\n        this.dataState.sort.asc = Util.isNull(reverse) ? reverse : !reverse;\r\n        this.customCompareFn = compareFn;\r\n    }\r\n    /**\r\n     * 获取表格当前的数据状态(sort、search、pagination)\r\n     * @return TiTableDataState\r\n     */\r\n    public getDataState(): TiTableDataState {\r\n        return this.dataState;\r\n    }\r\n\r\n    /**\r\n     * 获取当前触发 stateUpdate 的事件(即引起表格数据状态改变的起因事件)\r\n     * @return 有\"search\", \"sort\", \"pagination\"这三个值\r\n     */\r\n    public getTriggerEvent(): string {\r\n       return this.triggerEvent;\r\n    }\r\n\r\n    /**\r\n     * 如果使用到了表格组件搜索功能，可通过此方法获取到搜索的数据结果。\r\n     * @return 搜索到的数据集合\r\n     *\r\n     * 3.0.9新增\r\n     */\r\n    public getSearchedResult(): Array<TiTableRowData> {\r\n        return this.searchedResult;\r\n     }\r\n\r\n    private updateTable(): void {\r\n        if (this.isFrontPagination() || this.isFrontSort() || this.isFrontSearch()) {\r\n            this.data2displayed();\r\n        }\r\n        // 延时的目的是防止stateUpdate 回调中同步修改数据时报错。\r\n        this.promise.then(() => {\r\n            this.stateUpdate.emit(this);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 根据数据状态(search,sort,pagination)处理数据\r\n     */\r\n    private dataProcessor(data: Array<any>): Array<any> {\r\n        let output = data;\r\n        // 如果存在过滤条件且开发者传递的源数据尚未进行过滤处理，则进行前台过滤处理\r\n        if (this.isFrontSearch()) {\r\n            output = TiTableComponent.getSearchedData(output, this.searchWords, this.searchKeys);\r\n            this.searchedResult = [].concat(output);\r\n            const totalNumber: number = output.length;\r\n            // 如果存在分页且开发者传递的源数据尚未进行分页处理，即进行前台分页,\r\n            if (this.isFrontPagination()) {\r\n                this.promise.then(() => {\r\n                    this.paginationSubject.next({ totalNumber });\r\n                });\r\n            }\r\n        }\r\n        // 如果存在排序且开发者传递的源数据尚未进行排序处理，则进行前台排序处理（字典排序）\r\n        if (this.isFrontSort()) {\r\n            output = this.getSortedData(output, this.dataState.sort.sortKey, this.dataState.sort.asc);\r\n        }\r\n\r\n        // 存在分页且开发者传递的源数据尚未进行分页处理，则进行前台分页\r\n        if (this.isFrontPagination()) {\r\n            const pagination: { currentPage: number, itemsPerPage: number } = this.dataState.pagination;\r\n            const start: number = (pagination.currentPage - 1) * pagination.itemsPerPage;\r\n            output = output.slice(start, start + parseInt(pagination.itemsPerPage.toString(), 10));\r\n        }\r\n\r\n        return output;\r\n    }\r\n    /**\r\n     * data => displayedData，处理分3步：\r\n     * 1. 复制data数据\r\n     * 2. 根据 分页、过滤、排序 处理数据\r\n     * 3. 通过displayedDataChange 事件更新到displayedData\r\n     */\r\n    private data2displayed() {\r\n        // 复制源数据\r\n        let output: Array<any> = TiTableComponent.safeCopy(this.data);\r\n\r\n        // 处理数据\r\n        output = this.dataProcessor(output);\r\n\r\n        // 更新到displayedData\r\n        this.promise.then(() => {\r\n            // 同步修改内部数据\r\n            this.displayedData = output;\r\n            this.displayedDataChange.emit(output);\r\n        });\r\n    }\r\n    private isFrontSearch(): boolean {\r\n        const srcState: TiTableSrcState = this.getSrcState();\r\n        return (this.searchWords && this.searchWords.length > 0) && (!srcState || !srcState.searched);\r\n    }\r\n    private isFrontSort(): boolean {\r\n        const srcState: TiTableSrcState = this.getSrcState();\r\n        return this.enableSort && (!srcState || !srcState.sorted);\r\n    }\r\n    private isFrontPagination(): boolean {\r\n        const srcState: TiTableSrcState = this.getSrcState();\r\n        const pagination: { currentPage: number, itemsPerPage: number } = this.dataState.pagination;\r\n        return (pagination.currentPage !== -1 && pagination.itemsPerPage !== -1 && (!srcState || !srcState.paginated));\r\n    }\r\n\r\n    private getSortedData(data: Array<TiTableRowData>, predicate: string, asc: boolean): Array<TiTableRowData> {\r\n        let resultArr: Array<TiTableRowData> = [];\r\n        if (!Util.isArray(data)) {\r\n            return resultArr;\r\n        }\r\n\r\n        // 无序状态\r\n        if (!predicate || asc === null) {\r\n            return data;\r\n        }\r\n\r\n        const compareArr: Array<{value: TiTableRowData, index: number, predicateValueObj: {value: any, type: string}}> =\r\n            data.map((value: TiTableRowData, index: number) => {\r\n            const predicateValue: any = TiTableComponent.getPredicateValue(value, predicate);\r\n\r\n            return {\r\n                value,\r\n                index,\r\n                predicateValueObj: TiTableComponent.getPredicateValueObj(predicateValue, index)\r\n            };\r\n        });\r\n        compareArr.sort(this.compareTo);\r\n        resultArr = compareArr.map((item: {value: TiTableRowData, index: number, predicateValueObj: {value: any, type: string}}) => {\r\n            return item.value;\r\n        });\r\n        if (!asc) {\r\n            resultArr.reverse();\r\n        }\r\n\r\n        return resultArr;\r\n    }\r\n\r\n    private compareTo = (v1: {value: TiTableRowData, index: number, predicateValueObj: {value: any, type: string}},\r\n                         v2: {value: TiTableRowData, index: number, predicateValueObj: {value: any, type: string}}): number => {\r\n        let result: number = 0;\r\n        if (Util.isFunction(this.customCompareFn)) {\r\n            result = this.customCompareFn(v1.value, v2.value, this.dataState.sort.sortKey);\r\n        } else {\r\n            result = TiTableComponent.doCompare(v1.predicateValueObj, v2.predicateValueObj);\r\n            if (result === 0) {\r\n                result = v1.index - v2.index;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private updateSafeCopy(): void {\r\n        this.data = TiTableComponent.safeCopy(this.srcData &&  this.srcData.data ?\r\n            this.srcData.data : []);\r\n    }\r\n\r\n    private getSrcState(): TiTableSrcState {\r\n        return this.srcData && this.srcData.state ? this.srcData.state : undefined;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public closeOtherDetailsFn(currentRow: TiTableRowData): void {\r\n        this.displayedData.forEach((row: TiTableRowData) => {\r\n            if (row !== currentRow && row['showDetails']) {\r\n                this.promise.then(() => {\r\n                    row['showDetails'] = false;\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    private initFixedHead(): void {\r\n        this.theadContainer = this.fixedHeadService.getTheadContainer(this.hostEle);\r\n        if (!this.theadContainer) {\r\n            return;\r\n        }\r\n        this.tbodyContainer = this.fixedHeadService.getTbodyContainer(this.theadContainer);\r\n        this.isFixedHead = !Util.isUndefined(this.theadContainer) && !Util.isUndefined(this.tbodyContainer);\r\n\r\n        if (this.isFixedHead) {\r\n            this.renderer.listen(this.tbodyContainer, 'scroll', () => {\r\n                const scrollLeft: number = this.tbodyContainer.scrollLeft;\r\n                this.renderer.setStyle(this.theadContainer.children[0], 'marginLeft', -scrollLeft + 'px');\r\n                Util.trigger(document, 'tiScroll');\r\n            });\r\n\r\n            this.unlistenFixedHeadWindowResize = this.renderer.listen('window', 'resize', () => {\r\n                this.fixedHeadService.processOverflowY(this.theadContainer, this.tbodyContainer, this);\r\n            });\r\n        }\r\n    }\r\n\r\n    private getTbodyHeight(): number {\r\n        // 修复SSR报错：ERROR TypeError: this.tbodyContainer.children[0].getBoundingClientRect is not a function\r\n        if(typeof this.tbodyContainer.children[0].getBoundingClientRect !== 'function'){\r\n            return 0;\r\n        }\r\n        return this.fixedHeadService.numRound(this.tbodyContainer.children[0].getBoundingClientRect().height, 0);\r\n    }\r\n\r\n    private addFixedColumnBehavior(): void {\r\n        const container: any = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-table-container')[0];\r\n        if (!container) {\r\n            return;\r\n        }\r\n        this.zone.runOutsideAngular(() => {\r\n            this.renderer.listen(container, 'scroll', () => {\r\n                const scrollLeft: number = container.scrollLeft;\r\n                const isRightColumnFloat: boolean = scrollLeft + container.clientWidth < container.scrollWidth;\r\n                this.containerScrollXChangeSubject.next({\r\n                    scrollLeft,\r\n                    isRightColumnFloat\r\n                });\r\n            });\r\n\r\n            this.unlistenFixedColumnWindowResize = this.renderer.listen('window', 'resize', () => {\r\n                const containerWidth: number = this.fixedColumnInfo.container.clientWidth;\r\n                if (containerWidth !== this.fixedColumnInfo.containerWidth) {\r\n                    this.fixedColumnInfo.containerWidth = containerWidth;\r\n                    this.processFixedColumn();\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public processFixedColumn(): void {\r\n        const scrollLeft: number = this.fixedColumnInfo.container.scrollLeft;\r\n        const isRightColumnFloat: boolean = scrollLeft + this.fixedColumnInfo.container.clientWidth < this.fixedColumnInfo.container.scrollWidth;\r\n        this.containerScrollXChangeSubject.next({\r\n            scrollLeft,\r\n            isRightColumnFloat\r\n        });\r\n        this.updateFixedThLeftSubject.next();\r\n        this.updateFixedTdLeftSubject.next();\r\n    }\r\n}\r\n","import {\r\n    Component, ElementRef, Renderer2, SimpleChanges\r\n} from '@angular/core';\r\nimport { TiDropsearchComponent } from '../dropsearch/TiDropsearchModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiBrowser } from '../../utils/Util';\r\n\r\n/**\r\n * @ignore\r\n * TiHeadFilterDrop 表头过滤漏斗组件的下拉框选择组件\r\n */\r\n@Component({\r\n    selector: 'ti-head-filter-drop',\r\n    templateUrl: './head-filter-drop.html',\r\n    styleUrls:['./head-filter-drop.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiHeadFilterDropComponent)]\r\n})\r\nexport class TiHeadFilterDropComponent extends TiDropsearchComponent {\r\n    public static readonly DOMINATOR_SPACE: number = 6;\r\n    public dominatorSpace: string = TiHeadFilterDropComponent.DOMINATOR_SPACE + 'px';\r\n    // 选中项\r\n    public selected: Array<any>;\r\n    protected heightExcludeContent: number = 10; // 上下边框为2，上下padding为8\r\n    protected buttonHeight: number = 45; // 确定、取消按钮高度\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n\r\n        // 重新设置headfilterdrop的heightExcludeList\r\n        if (changes['searchable']) {\r\n            if (changes['searchable'].currentValue) {\r\n                this.heightExcludeList = this.multiple ? this.heightExcludeContent + this.buttonHeight + TiDropsearchComponent.SEARCHBOX_EXCLUDE_HEIGHT\r\n                    : this.heightExcludeContent + TiDropsearchComponent.SEARCHBOX_EXCLUDE_HEIGHT;\r\n            } else {\r\n                this.heightExcludeList = this.multiple ? this.heightExcludeContent + this.buttonHeight : this.heightExcludeContent;\r\n            }\r\n        }\r\n    }\r\n\r\n    writeValue(model: any): void {\r\n        super.writeValue(model);\r\n        // 初始化selected选中项\r\n        if (this.multiple) {\r\n            this.selected = [...model ? model : []];\r\n        } else {\r\n            this.selected = model ? model : '';\r\n        }\r\n    }\r\n\r\n    onSelect(option: any): void {\r\n        // 多选时不处理onSelect事件（在点击确定按钮时触发）\r\n        if (this.multiple) {\r\n            return;\r\n        }\r\n        super.onSelect(option);\r\n        this.model = option;\r\n    }\r\n\r\n    public hide(): void {\r\n        // 处理问题：IE 下有搜索框时，在下拉中选择完收起后漏斗图标由于聚焦而有了虚线框\r\n        if (TiBrowser.isIE() && this.searchable) {\r\n            this.render.setStyle(this.dominatorElem, 'outlineStyle', 'none');\r\n            super.hide();\r\n        } else {\r\n            super.hide();\r\n        }\r\n\r\n        // 还原selected选中项\r\n        if (this.multiple) {\r\n            this.selected = [...this.model ? this.model : []];\r\n        }\r\n    }\r\n\r\n    hideWithoutFocus(): void {\r\n        super.hideWithoutFocus();\r\n        // 还原selected选中项\r\n        if (this.multiple) {\r\n            this.selected = [...this.model ? this.model : []];\r\n        }\r\n    }\r\n\r\n    // 按钮面板鼠标按下事件（解决因点击按钮面板导致整个下拉面板隐藏的问题）\r\n    btnContainerMousedown(event: any): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    // 确定按钮\r\n    okClick(): void {\r\n        // 选中值发生改变时对model值做处理\r\n        if (JSON.stringify(this.selected) !== JSON.stringify(this.model ? this.model : [])) {\r\n            this.model = [...this.selected];\r\n        }\r\n        // 触发onSelect事件\r\n        this.select.emit(this.model);\r\n        this.hide();\r\n    }\r\n\r\n    // 取消按钮\r\n    cancelClick(): void {\r\n        // 还原selected选中项\r\n        this.selected = [...this.model ? this.model : []];\r\n        this.hide();\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    Input,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { TiSelectComponent } from '../select/TiSelectModule';\r\nimport { TiHeadFilterDropComponent } from './TiHeadFilterDropComponent';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiBrowser } from '../../utils/Util';\r\n\r\n// 下面注释，可以避免编译lib时正则报错。原理未知，副作用未知。\r\n// @dynamic\r\n/**\r\n * TiHeadFilter 表头过滤(漏斗)组件， 嵌在表头的 th 中使用。\r\n *\r\n * ti-head-filter 用来显示过滤操作漏斗图标，点击其可打开下拉框，选中下拉框中的选项时，\r\n * 可在提供的 select 事件中做对应的表格数据过滤处理。\r\n *\r\n * ### 接口说明\r\n * **Inputs：**\r\n *\r\n * |     名称    |  类型   | 默认值   | 功能描述  |\r\n * | --------   | :-----   | :---- | :---- |\r\n * | options   | array  | [] | 所有过滤项 |\r\n * | ngModel   | object  | false | 可设置和获取 headfilter下拉选中值 |\r\n * | labelKey   |  string  | 'label' | 下拉面板中要显示的字段, 10.0.2版本新增 |\r\n * | panelMaxHeight   |  string  | 最大显示8条数据 | 下下拉面板的最大显示高度，溢出时则出滚动条。 |\r\n * | id   | string  | undefined | HTML属性id，自动化测试要求必须给id赋值 |\r\n * | select   | function  | 无 | 下拉面板选中事件，向外通知选中数据 |\r\n * | multiple   |  boolean  | false | 下拉面板是否为多选 |\r\n * | selectAll   |  boolean  | false | 下拉面板是否显示全选框 |\r\n * | panelAlign   |  string  | 'left' | 下拉面板展开对齐方式，9.0.4版本新增 |\r\n * | searchable   |  boolean  | false | 是否开启搜索功能，10.0.2版本新增 |\r\n * | panelWidth   |  'auto' 或 string  | 'auto' | 设置下拉面板的宽度，\"auto\"表示下拉框的宽度根据下拉选项的内容自动撑开，也可设置固定的下拉框宽度(不小于过滤图标的宽度)，例如：\"200px\", 10.0.2版本新增 |\r\n * | noDataText   |  string  | '...' | 无数据时的显示文本。10.0.3版本新增 |\r\n *\r\n * <p><span style=\"color: red\">以下说明不可用，不做参考。</span>该组件只有以上5个Input接口和1个Output接口\r\n * 可用，其余方法、Input、输出等(继承于TiSelectComponent,是供select的内部使用的)都不可用</p>\r\n */\r\n@Component({\r\n    selector: 'ti-head-filter',\r\n    templateUrl: './head-filter.html',\r\n    styleUrls:['./head-filter.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiHeadFilterComponent)],\r\n    host: {\r\n        '[class.ti3-head-filter-container]': 'true',\r\n        '(blur)': 'onBlur()'\r\n    }\r\n})\r\nexport class TiHeadFilterComponent extends TiSelectComponent {\r\n    /**\r\n     * 面板对齐方式\r\n     *\r\n     * 9.0.4新增\r\n     */\r\n    @Input() panelAlign: 'left' | 'right' = 'left';\r\n    // 由于headfilter与select中的panelWidth的默认值和类型不一样，所以这里重定义panelWidth接口\r\n    /**\r\n     * 下拉面板的最大显示宽度，该变量与下拉类组件保持一致\r\n     *\r\n     * 1.\"auto\": 下拉框的宽度根据下拉选项的内容自动撑开；\r\n     *\r\n     * 2.表示宽度的字符串: 设置固定的下拉框宽度(不小于Select组件的宽度)。例如：\"200px\"\r\n     *\r\n     * 10.0.2版本新增，默认为'auto'，10.1.2起<b>搜索场景下</b>默认值修改为“180px”，\r\n     */\r\n    // 置为undefined是为了覆盖父类的panelWidth值\r\n    @Input() panelWidth: 'auto'| string = undefined;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('filterIcon', { static: true }) filterIconEleRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild(TiHeadFilterDropComponent, { static: true }) dropsearchCom: TiHeadFilterDropComponent;\r\n\r\n    ngAfterViewChecked(): void {\r\n        // 这里不能调用父类方法，因为Select父类对dominator处理，空指针报错。\r\n        // TODO: 看是否能够不继承select\r\n        if (this.searchable !== this.oldSearchable) {\r\n            this.oldSearchable = this.searchable;\r\n            if (this.searchable) {\r\n                this.setFocusableElems([this.filterIconEleRef.nativeElement]\r\n                    .concat(this.dropsearchCom.getFocusableElems()));\r\n            } else {\r\n                this.setFocusableElems([this.filterIconEleRef.nativeElement]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 失焦情况下，仅关闭面板，不做聚焦等处理\r\n     */\r\n    public onBlur(): void {\r\n        super.onBlur();\r\n        if (TiBrowser.isIE() && this.searchable) {\r\n            if (getComputedStyle(this.filterIconEleRef.nativeElement).outlineStyle === 'none') {\r\n                this.renderer.setStyle(this.filterIconEleRef.nativeElement, 'outlineStyle', '');\r\n            }\r\n        }\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  DoCheck,\r\n  ElementRef,\r\n  Input,\r\n  OnInit\r\n} from '@angular/core';\r\nimport { TiTableComponent } from './TiTableComponent';\r\n/**\r\n * TiHeadSort 表头排序(上下箭头)组件\r\n *\r\n * 嵌在表头的th中使用，点击该组件时表格数据按该列的排序规则进行升序/降序排序\r\n *\r\n * 组件有默认的排序规则，也可支持自定义排序规则\r\n */\r\n@Component({\r\n  selector: 'ti-head-sort',\r\n  templateUrl: './head-sort.html',\r\n  host: {\r\n      '[class.ti3-sort-container]': 'true',\r\n      '[class.ti3-sort-ascent]': 'sortKey === table.dataState.sort.sortKey && clickNum % 3 === 1',\r\n      '[class.ti3-sort-descent]': 'sortKey === table.dataState.sort.sortKey && clickNum % 3 === 2',\r\n      '(click)': 'onClick()'\r\n  }\r\n})\r\n\r\nexport class TiHeadSortComponent implements OnInit, DoCheck {\r\n    /**\r\n     * 指定当前列进行排序的数据属性\r\n     *\r\n     * 例如：根据表格数据中的\"firstName\"属性值进行排序，则需将该接口的值设置为\"firstName\"\r\n     */\r\n    @Input() sortKey: string;\r\n    /**\r\n     * 指定初始时在对应 sortKey下是否为升序排序。默认值为null, 表示无序(不升序也不降序)\r\n     */\r\n    @Input() asc: boolean = null;\r\n    /**\r\n     * 指定排序对比规则，其参数有三个，依次为：\r\n     *\r\n     * a: 第一个对比值\r\n     *\r\n     * b: 第二个对比值\r\n     *\r\n     * sortKey: 当前数据排序依据的属性\r\n     */\r\n    @Input() compareFn: (a: any, b: any, sortKey?: string) => number; // 自定义的排序规则\r\n    /**\r\n     * @ignore\r\n     */\r\n    public clickNum: number = 0;\r\n    private hostElement: HTMLElement;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public table: TiTableComponent;\r\n    constructor(private elementRef: ElementRef, table: TiTableComponent) {\r\n        this.hostElement = this.elementRef.nativeElement;\r\n        this.table = table;\r\n    }\r\n    ngOnInit(): void {\r\n        // 更新TiTableComponent的enableSort，表示启用了排序。\r\n        this.table.enableSort = true;\r\n        // 修复SSR报错：ERROR TypeError: Cannot read property 'sort' of undefined\r\n        // 表格记忆\r\n        if (this.table.storageId && this.table.storageConfig && this.table.storageConfig.sort && this.table.sessionStorageState && this.table.sessionStorageState.sort) {\r\n            if (this.sortKey === this.table.sessionStorageState.sort.sortKey) {\r\n                this.asc = this.table.sessionStorageState.sort.asc;\r\n            } else {\r\n                this.asc = null;\r\n            }\r\n        }\r\n        if (this.asc !== null) {\r\n            this.clickNum = this.asc ? 0 : 1;\r\n            // 如果有默认排序，即排序的初始化，将排序初始化的各个值赋给 tiTable 的 tableState 对应的 sort 属性\r\n            this.sort(true);\r\n        }\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        if (this.table.dataState.sort.sortKey !== this.sortKey) {\r\n            this.clickNum = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onClick(): void {\r\n        if (!this.sortKey) {\r\n            return;\r\n        }\r\n        this.sort(false);\r\n    }\r\n\r\n    private sort(isDefaultSort: boolean): void {\r\n        this.clickNum++;\r\n        // this.clickNum整除3余2表示降序，余1表示升序，余0表示无序\r\n        const isDesc: boolean = this.clickNum % 3 === 2 ? true : this.clickNum % 3 === 1 ? false : null;\r\n        this.table.updateSort(this.sortKey, isDesc, isDefaultSort, this.compareFn);\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  DoCheck,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnInit,\r\n  Output,\r\n  Renderer2,\r\n} from '@angular/core';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\nimport { TiTableComponent, TiTableRowData } from './TiTableComponent';\r\n/**\r\n * TiDetailsIcon 详情展开图标组件\r\n *\r\n * ti-details-icon 用来显示详情展开图标，其嵌在详情展开列的 td 标签中；\r\n * 点击该图标，对应详情行在展开/收起两个状态之间切换。\r\n */\r\n@Component({\r\n  selector: 'ti-details-icon',\r\n  templateUrl: './details-icon.html',\r\n  host: {\r\n      '(click)': 'onClick()'\r\n  }\r\n})\r\n\r\nexport class TiDetailsIconComponent implements OnInit, DoCheck {\r\n    /**\r\n     * @ignore\r\n     * 表格详情中，非详情行标记样式类\r\n     */\r\n    public static TABLE_ClASS_DETAIL_BASE: string = 'ti3-table-detail-icon-tr';\r\n    /**\r\n     * 当前行数据\r\n     */\r\n    @Input() row: TiTableRowData;\r\n    /**\r\n     * 当前行索引值，即 ngFor的对应的index\r\n     */\r\n    @Input() index: number;\r\n    /**\r\n     * 点击详情展开图标时触发此接口函数，其中showDetails属性控制其是否展开；\r\n     *\r\n     * 一旦使用此接口，就由开发者决定其是否要展开或收起。\r\n     */\r\n    @Output() readonly beforeToggle: EventEmitter<TiTableRowData> = new EventEmitter();\r\n    private oldShowDetails: boolean = false;\r\n    private element: any;\r\n    constructor(private table: TiTableComponent, private elementRef: ElementRef,\r\n                private renderer: Renderer2) {\r\n        this.element = this.elementRef.nativeElement;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.row = Util.isUndefined(this.row) ? {} : this.row;\r\n        this.row.showDetails = Util.isUndefined(this.row.showDetails) ? false : this.row.showDetails;\r\n        // 给当前行添加样式类标记\r\n        const parentTr: any = this.renderer.parentNode(this.renderer.parentNode(this.element));\r\n        this.renderer.addClass(parentTr, TiDetailsIconComponent.TABLE_ClASS_DETAIL_BASE);\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        // 如果需要关闭其它行的详情(即只能展开一行的详情)时，需要监听showDetails\r\n        if (this.table.closeOtherDetails && this.row.showDetails !== this.oldShowDetails) {\r\n            this.oldShowDetails = this.row.showDetails;\r\n            if (this.row.showDetails) {\r\n                // 当打开当前行的详情时，关闭其他行的详情\r\n                this.table.closeOtherDetailsFn(this.row);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onClick(): void {\r\n        if (this.beforeToggle.observers.length > 0) {\r\n            this.beforeToggle.emit(this.row);\r\n        } else {\r\n            this.row.showDetails = !this.row.showDetails;\r\n        }\r\n\r\n        // 为了解决 codeclub #1720\r\n        // 在chrome浏览器下，滚动条滚到底部后，这时页面内容高度变小，滚动条保留在底部(正常的现象),\r\n        // 之后页面内容高度再变大时，滚动条依然保留在底部。\r\n        // 这导致了当页面滚动条拖动到底部后，将表格的pagesize由大变小(如20条修改为10条)，再去点击某一行详情展开时，\r\n        // 视觉上详情行是向上展开的，其原因是滚动条一直停留在底部；这时，只要稍微手动触发滚动条滚动，详情正常展开\r\n        // 注意：此问题只修复了在body上出滚动条的表格的详情展开问题。\r\n        if (TiBrowser.isChrome()) {\r\n            const scrollTop: number = Math.ceil(document.documentElement.scrollTop);\r\n            // 窗口可视区域高度\r\n            const height: number = document.documentElement.clientHeight;\r\n            const scrollHeight: number = document.body.scrollHeight;\r\n            if (scrollTop > 0 && scrollTop + height >= scrollHeight) {\r\n                document.body.scrollTop = scrollTop - 0.5;\r\n                document.body.scrollTop = scrollTop + 0.5;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import {\r\n  Directive,\r\n  DoCheck,\r\n  Input,\r\n  Renderer2,\r\n  TemplateRef,\r\n  ViewContainerRef\r\n} from '@angular/core';\r\nimport { TiTableComponent, TiTableRowData } from './TiTableComponent';\r\nimport { TiDetailsIconComponent } from './TiDetailsIconComponent';\r\n/**\r\n * TiDetailsTr 详情行结构指令\r\n *\r\n * 使用时需要在其前面加 * 语法糖，传入当前行数据；\r\n * 其内部根据row.showDetails的值来控制详情行是否显示，功能类似于ngIf。\r\n */\r\n@Directive ({\r\n    selector: '[tiDetailsTr]'\r\n})\r\nexport class TiDetailsTrDirective implements DoCheck {\r\n    /**\r\n     * 当前行数据\r\n     */\r\n    @Input('tiDetailsTr') row: TiTableRowData;\r\n    private oldShowDetails: boolean;\r\n    constructor(private templateRef: TemplateRef<any>,\r\n                private viewContainerRef: ViewContainerRef,\r\n                private renderer: Renderer2, private table: TiTableComponent) {\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        if (this.row.showDetails !== this.oldShowDetails) {\r\n            this.updateView();\r\n            this.oldShowDetails = this.row.showDetails;\r\n        }\r\n\r\n    }\r\n    private updateView(): void {\r\n        if (this.row.showDetails) {\r\n            // 上下文参数是否需要传递\r\n            this.viewContainerRef.createEmbeddedView(this.templateRef);\r\n            // 结构指令的宿主元素是一个 comment(注释) 的Node节点，\r\n            // 生成节点元素插入DOM中的位置跟angularCompilerOptions.enableIvy 配置有关，true时在宿主元素之前，false时在宿主元素之后，\r\n            // 而 ng9开始angularCompilerOptions.enableIvy 默认为true,但一些项目为兼容性，强制设置为了false，所以要做一下兼容处理\r\n            let detailTr: HTMLElement;\r\n            const nativeElement = this.templateRef.elementRef.nativeElement;\r\n            if (nativeElement.previousSibling && nativeElement.previousSibling.classList &&\r\n                nativeElement.previousSibling.classList.contains(TiDetailsIconComponent.TABLE_ClASS_DETAIL_BASE)) {\r\n                detailTr = nativeElement.nextSibling;\r\n            } else {\r\n                detailTr = nativeElement.previousSibling;\r\n            }\r\n\r\n            this.renderer.addClass(detailTr, 'ti3-details-tr');\r\n        } else {\r\n            this.viewContainerRef.clear();\r\n            //  TODO: 方案是否可优化\r\n            // 表头锁定时，展开时可在table的AfterViewChecked中获取到表格变化后的高度，\r\n            // 但是收起时，在table的AfterViewChecked中获取不到表格变化后的高度，不能及时处理滚动条的变化\r\n            // 所以此处使用setTimeout使其延时触发table的AfterViewChecked，使其能够处理由高度变化引起的滚动条状态的改变\r\n            // 注：使用ngIf指令也是如此效果\r\n            if (this.table.isFixedHead) {\r\n                setTimeout(() => {}, 0);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import {\r\n    AfterViewInit,\r\n    Directive,\r\n    ElementRef,\r\n    OnDestroy,\r\n    Renderer2\r\n} from '@angular/core';\r\nimport { TiTableComponent } from './TiTableComponent';\r\n/**\r\n * TiColspan 表格跨列数colspan 计算，\r\n *\r\n * 根据表头第一行tr中th的数目，同步colspan数。\r\n *\r\n * 主要配合表格详情展开功能使用，用于表格详情展示行的的列合并。\r\n *\r\n */\r\n@Directive({\r\n    selector: 'td[tiColspan]'\r\n})\r\nexport class TiColspanDirective implements AfterViewInit, OnDestroy {\r\n    //\r\n    private firstTrObserver: MutationObserver;\r\n    constructor(private table: TiTableComponent, private renderer: Renderer2, private elementRef: ElementRef) {\r\n    }\r\n    ngAfterViewInit(): void {\r\n        // 获取thead中第一行tr\r\n        const tableFirstTr = (this.table.nativeElement as HTMLElement).querySelector('table>thead>tr');\r\n        if (!tableFirstTr) {\r\n            return;\r\n        }\r\n        // 初始化设置一次colspan\r\n        this.renderer.setAttribute(this.elementRef.nativeElement, 'colspan', String(tableFirstTr.children.length));\r\n        // 修复SSR报错：ERROR ReferenceError: MutationObserver is not defined\r\n        if(typeof MutationObserver === 'undefined'){\r\n            return;\r\n        }\r\n        this.firstTrObserver = new MutationObserver((mutationsList) => {\r\n            for (let mutation of mutationsList) {\r\n                if (mutation.type === 'childList') {\r\n                    this.renderer.setAttribute(this.elementRef.nativeElement, 'colspan', String(tableFirstTr.children.length));\r\n                }\r\n            }\r\n        });\r\n        // 只需要处理tr中th的增删，所以只配置 childList为true,\r\n        this.firstTrObserver.observe(tableFirstTr, { childList: true, });\r\n    }\r\n    ngOnDestroy(): void {\r\n        if (this.firstTrObserver) {\r\n            this.firstTrObserver.disconnect();\r\n        }\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    IterableChanges,\r\n    IterableDiffer,\r\n    IterableDiffers,\r\n    NgZone,\r\n    Renderer2\r\n} from '@angular/core';\r\nimport { TiDropsearchComponent } from '../dropsearch/TiDropsearchModule';\r\nimport { TiTableColumns, TiTableComponent } from './TiTableComponent';\r\n\r\n/**\r\n * @ignore\r\n * TiColsToggleDrop 控制列动态隐藏/显示的下拉组件\r\n *\r\n */\r\n@Component({\r\n    selector: 'ti-cols-toggle-drop',\r\n    templateUrl: './cols-toggle-drop.html',\r\n    host: {\r\n        '[class.ti3-cols-toggle-drop-container]': 'true'\r\n    }\r\n})\r\nexport class TiColsToggleDropComponent extends TiDropsearchComponent {\r\n    public static readonly DOMINATOR_SPACE: number = 4;\r\n    public static readonly DEFAULT_LIST_MAX_HEIGHT: number = 30 * 8 + 8;\r\n    public static readonly LIST_WITH_SEARCHBOX_MAX_HEIGHT: number = 30 * 7;\r\n    public static readonly SEARCHBOX_AREA_HEIGHT: number = 28 + 6 + 4; // 搜索框所占区域高度\r\n    public static readonly DROP_VERTICAL_PADDING: number = 4 + 4;\r\n    public dominatorSpace: string = TiColsToggleDropComponent.DOMINATOR_SPACE + 'px';\r\n    public columns: Array<TiTableColumns> = [];\r\n    public selectedColumns: Array<TiTableColumns>; // TODO: 可以不定义此变量，用this.model来代替\r\n    public readonly listLabelKey: string = 'title';\r\n    private columnsDiffer: IterableDiffer<TiTableColumns>;\r\n    private optionsChangeInner: boolean = false;\r\n    constructor(private iterableDiffers: IterableDiffers, elementRef: ElementRef,\r\n                renderer2: Renderer2, zone: NgZone, private table: TiTableComponent) {\r\n            super(renderer2, elementRef, zone);\r\n    }\r\n\r\n    private static trackByFn(index: number, item: any): string {\r\n        // 表格记忆show属性也需要跟踪\r\n        return item.title + item.show;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.multiple = true; // 设置为多选。\r\n        this.heightExcludeList = this.searchable ? TiColsToggleDropComponent.DROP_VERTICAL_PADDING +\r\n            TiColsToggleDropComponent.SEARCHBOX_AREA_HEIGHT : TiColsToggleDropComponent.DROP_VERTICAL_PADDING;\r\n        this.defaultListMaxHeight = this.searchable ? TiColsToggleDropComponent.LIST_WITH_SEARCHBOX_MAX_HEIGHT :\r\n            TiColsToggleDropComponent.DEFAULT_LIST_MAX_HEIGHT;\r\n        this.searchKeys = ['title'];\r\n        this.columnsDiffer = this.iterableDiffers.find(this.options)\r\n            .create(TiColsToggleDropComponent.trackByFn);\r\n    }\r\n\r\n    ngDoCheck(): void { // 动态监听columns的变化(主要是引用不变，内容变化colums.push等)，是否需要,noempty 有影响(数据引用变了才会进pipe)\r\n        super.ngDoCheck();\r\n        const columnsDiffer: IterableChanges<TiTableColumns> = this.columnsDiffer.diff(this.options);\r\n        if (columnsDiffer) {\r\n            if (this.optionsChangeInner) {\r\n                this.optionsChangeInner = false;\r\n            } else {\r\n                this.selectedColumns = this.options.filter((column: { show?: boolean }) => {\r\n                    return column.show === true || column.show === undefined;\r\n                });\r\n                this.columns = this.options.concat(); // 强制变化，不然colums.push的列不能出现在列表中，与自定义的noempty有关\r\n            }\r\n\r\n            // columns变化需要处理列固定\r\n            if(this.table.fixedColumnInfo.hasFixedColumn) {\r\n                // 需要延迟处理，columns变化时，组件渲染还未完成。\r\n                // 但如果在ngAfterViewChecked处理，太频繁，影响性能。\r\n                setTimeout((): void => {\r\n                    // 处理左侧列固定\r\n                    this.table.updateFixedThLeftSubject.next();\r\n                    this.table.updateFixedTdLeftSubject.next();\r\n                    // 处理右侧列固定\r\n                    const scrollLeft: number = this.table.fixedColumnInfo.container.scrollLeft;\r\n                    const isRightColumnFloat: boolean =\r\n                        scrollLeft + this.table.fixedColumnInfo.container.clientWidth < this.table.fixedColumnInfo.container.scrollWidth;\r\n                    this.table.containerScrollXChangeSubject.next({\r\n                        scrollLeft,\r\n                        isRightColumnFloat\r\n                    });\r\n                }, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    public onSelect(option: any): void {\r\n        if (option === this.listCom.optionSelectAll) {\r\n            this.options.forEach((item: any) => {\r\n                if (!this.isDisabledFn(item)) {\r\n                    item.show = this.selectedColumns.includes(item);\r\n                }\r\n            });\r\n        } else {\r\n            option.show = this.selectedColumns.includes(option);\r\n        }\r\n        this.optionsChangeInner = true;\r\n        // 需要在父类select.emit之前，更改option内容\r\n        super.onSelect(option);\r\n        // TODO: 没有处理，用户主动改变绑定变量selectedColumns。应该在docheck里监听selectedColumns（this.model）\r\n    }\r\n\r\n    public isDisabledFn = (item: {disabled?: boolean, show?: boolean}): boolean => {\r\n        return item.disabled === true || (item.show === undefined && item !== this.listCom.optionSelectAll);\r\n    }\r\n\r\n    // 鼠标点击到搜索框外围的空白，会失焦导致面板关闭\r\n    // 此处做特殊处理,当点击空白时通过阻止默认事件的方式处理\r\n    public onMousedownSearchBoxOuter(event: MouseEvent): void {\r\n        if ((event.target as any).tagName === 'INPUT') {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n    }\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  Renderer2,\r\n  SimpleChanges,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport { TiTableComponent } from './TiTableComponent';\r\nimport { TiColsToggleDropComponent } from './TiColsToggleDropComponent';\r\nimport { TiSelectComponent } from '../select/TiSelectModule';\r\nimport { TiLocale } from '../../locale/TiLocaleModule';\r\nimport { TiPositionType } from '../../utils/Position';\r\n// 下面注释，可以避免编译lib时正则报错。原理未知，副作用未知。\r\n// @dynamic\r\n/**\r\n * TiColsToggle 控制列动态隐藏/显示的组件\r\n *\r\n * ti-cols-toggle 用来显示列操作按钮，点击该按钮可在打开的下拉中设置各列的隐藏/显示；\r\n * 在 ti-table 标签内，开发者可灵活设置其位置。\r\n *\r\n * TiTable 上的 columns 接口传入值各项(列)的 show 和 title 属性值影响着各列的隐藏/显示状\r\n * 态,具体可参考 TiTableComponen t组件的 columns 输入接口说明。\r\n *\r\n * 开发者必须给需要动态显示/隐藏的列(th，td)使用 ngIf, 利用 ngIf 和 tiTable 上的 columns\r\n * 接口值中每列的show的值来控制当前列的显示或隐藏。\r\n *\r\n * ### 接口说明\r\n * **Inputs：**\r\n *\r\n * |     名称    |  类型   | 默认值   | 功能描述  |\r\n * | --------   | :-----   | :---- | :---- |\r\n * |  disabled   | boolean  | false | 设置列操作按钮是否禁用 |\r\n * | searchable   | boolean  | false | 是否显示搜索框 |\r\n * | selectAll   | boolean  | false | 是否开启全选功能。3.1.2新增 |\r\n * | panelWidth   |  string  | 'justified' | 下拉面板的宽度，可选值为'justified'(默认), 'auto'或自定义宽度，但宽度不能小于select面板的宽度 |\r\n * | noDataText   |  string  | '...' | 无数据时的显示文本。10.0.3版本新增 |\r\n * | select   | EventEmitter<TiTableColumns>  | 无 | 选中/取消选中事件，向外通知当前项数据，需要自行判断当前项是否选中。Tiny3.1.2 版本新增 |\r\n * | focus   | HTML事件  | 无 | 聚焦事件 |\r\n * | blur   | HTML事件  | 无 | 失焦事件 |\r\n *\r\n * <p><span style=\"color: red\">以下说明不可用，不做参考。</span>该组件只有以上disabled、searchable、panelWidth、selectAll 这四个Input接口\r\n * 和foucs、blur、select 这三个事件接口可用，其余方法、Input、输出等(继承于TiSelectComponent,是供select的内部使用的)都不可用</p>\r\n */\r\n@Component({\r\n  selector: 'ti-cols-toggle',\r\n  templateUrl: './cols-toggle.html',\r\n  host: {\r\n      '[class.ti3-cols-toggle-container]': 'true',\r\n      '(blur)': 'onBlur()'\r\n  }\r\n})\r\nexport class TiColsToggleComponent extends TiSelectComponent {\r\n    private static readonly DEFAULT_PANEL_WIDTH: number = 250;\r\n    private static readonly MAX_PANEL_WIDTH: number = 300;\r\n    private static readonly MIN_PANEL_WIDTH: number = 200;\r\n    /**\r\n     * @ignore\r\n     * 10.0.3版本之前服务使用tiTip指令自行实现提示\r\n     *\r\n     * 此处做兼容性处理，添加该接口判断服务是否使用指令实现\r\n     *\r\n     * 10.0.3新增\r\n     */\r\n    @Input() tiTip: string;\r\n    /**\r\n     * 设置tip提示内容，默认文本'自定义列表项'（国际化）\r\n     *\r\n     * 10.0.3新增\r\n     */\r\n    @Input() tipContent: string = TiLocale.getLocaleWords().tiTable.colsToggleTip;\r\n    /**\r\n     * 设置tip提示方向\r\n     *\r\n     * 10.0.3新增\r\n     */\r\n    @Input() tipPosition: TiPositionType = 'top';\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('toggleMenu', { static: true }) toggleMenuEleRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild(TiColsToggleDropComponent, { static: true }) dropsearchCom: TiColsToggleDropComponent;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public table: TiTableComponent;\r\n    // 标记是否需要更新聚焦元素\r\n    private shouldUpdateFocusableElems: boolean = false;\r\n    constructor(table: TiTableComponent, elementRef: ElementRef,\r\n                renderer2: Renderer2) {\r\n            super(elementRef, renderer2);\r\n            this.table = table;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        // 兼容使用tiTip指令实现的tip提示\r\n        this.tipContent = this.tiTip ? '' : this.tipContent;\r\n        this.tipPosition = this.tiTip ? undefined : this.tipPosition ;\r\n        this.setDropPanelWidth();\r\n        super.ngOnInit();\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        this.updateFocusableElems();\r\n        // TODO：严格来说，不应该继承自Select，Select中有对dominator的处理。看有没有更好实现方式。\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        // 这里不能调用父类方法，因为Select父类对dominator处理，空指针报错。\r\n        // TODO: 看是否能够不继承select\r\n\r\n        if (this.shouldUpdateFocusableElems) {\r\n            this.shouldUpdateFocusableElems = false;\r\n            this.updateFocusableElems();\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes['searchable'] && !changes['searchable'].firstChange) {\r\n            // searchable 参数变更后，dropSearch 组件中会重新获取搜索输入框元素，this.dropsearchCom.getFocusableElems() 方法获取的搜索框元素失效。\r\n            // 由于dropSearch在ngAfterViewChecked中变更聚焦元素，时机比ngOnChanges晚，但比组件的ngAfterViewChecked早，\r\n            // 所以用shouldUpdateFocusableElems变量标记是否需要更新聚焦元素，之后在ngAfterViewChecked中处理\r\n            this.shouldUpdateFocusableElems = true;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 在失焦时，通知更新了表格的列数据，用于表格记忆上传列显示数据\r\n     */\r\n    public onBlur(): void {\r\n        super.onBlur();\r\n        // 表格记忆通知列切换变化\r\n        if(this.table.storageId){\r\n            this.table.updateColumnsSubject.next();\r\n        }\r\n    }\r\n    // 更新可聚焦元素\r\n    private updateFocusableElems(): void {\r\n        if (this.searchable) {\r\n            // 推荐在onInit()时调用setFocusableElems(), 但是ngFor/ngIf中的元素在ngAfterViewInit()才能获取到\r\n            this.setFocusableElems([this.toggleMenuEleRef.nativeElement].concat(this.dropsearchCom.getFocusableElems()));\r\n        } else {\r\n            this.setFocusableElems([this.toggleMenuEleRef.nativeElement]);\r\n        }\r\n    }\r\n\r\n     private setDropPanelWidth(): void {  // TODO:\r\n        const panelWidthNum: number = parseInt(this.panelWidth, 10);\r\n        //  if (!Util.isNumber()) {\r\n        //      this.panelWidth = TiColsToggleComponent.DEFAULT_PANEL_WIDTH + 'px';\r\n        //      return;\r\n        //  }\r\n\r\n        if (panelWidthNum > TiColsToggleComponent.MAX_PANEL_WIDTH) {\r\n            this.panelWidth = `${TiColsToggleComponent.MAX_PANEL_WIDTH}px`;\r\n\r\n            return;\r\n        }\r\n\r\n        if (panelWidthNum < TiColsToggleComponent.MIN_PANEL_WIDTH) {\r\n            this.panelWidth = `${TiColsToggleComponent.MIN_PANEL_WIDTH}px`;\r\n        }\r\n    }\r\n}\r\n","import {\r\n  Directive,\r\n  DoCheck,\r\n  ElementRef,\r\n  IterableChanges,\r\n  IterableDiffer,\r\n  IterableDiffers,\r\n  NgZone,\r\n  OnDestroy,\r\n  OnInit,\r\n  Renderer2,\r\n  Inject\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { TiTableColumns, TiTableComponent } from './TiTableComponent';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { Util } from '../../utils/Util';\r\n\r\nimport { TiTableFixedHeadService } from './TiTableFixedHeadService';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport interface ResizableOpts {\r\n    table: any;\r\n    ths: Array<any>;\r\n    wrap: any; // 包裹表格的父容器，拖动表格超过父容器时出滚动条\r\n    mouseXPosition: number; // 光标位置，列拖动时使用\r\n    target: any; // 拖动的当前列\r\n    storedSizes: Array<number>; // 用来实时保存各列宽度\r\n    storedSortEleSizes: Array<number>; // 用来保存各列sort元素的宽度,\r\n    storeTableWidthChange: number;\r\n    secondTable?: any;\r\n    secondThs?: Array<any>;\r\n    xScrollState?: boolean;\r\n    yScrollState?: boolean;\r\n    isYOverflowedWithX?: boolean; // 表头锁定时,列拖动过程中横向滚动条的出现导致纵向滚动条出现的标志位\r\n}\r\n/**\r\n * TiColsResizable 表格列拖动指令\r\n *\r\n * 支持拖动表格列来调整各列宽度。\r\n *\r\n * 在ti-table标签上加了tiColsResizable属性，则表格自动具有列拖动功能；\r\n * 同时还需要对table元素包裹父容器div，并对父容器设置 ti3-resize-wrapper样式类。\r\n */\r\n@Directive ({\r\n    selector: 'ti-table[tiColsResizable]'\r\n})\r\nexport class TiColsResizableDirective implements OnInit, DoCheck, OnDestroy {\r\n    /**\r\n     * @ignore\r\n     */\r\n    public static readonly UNSELECTABLE_CLASS: string =  'ti3-unselectable';\r\n    /**\r\n     * @ignore\r\n     * 移到表头能够显示拖动线的感应范围\r\n     */\r\n    public static readonly COL_BORDER_RANGE: number = 10;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public readonly notResizableAttr: string = 'not-resizable';\r\n    /**\r\n     * @ignore\r\n     */\r\n    public resizableOpts: ResizableOpts = {\r\n        table: null,\r\n        ths: null,\r\n        wrap: null,\r\n        mouseXPosition: 0,\r\n        target: null,\r\n        storedSizes: [],\r\n        storedSortEleSizes: [],\r\n        storeTableWidthChange: 0,\r\n        isYOverflowedWithX: false\r\n    }; // 初始化列拖动属性的配置项\r\n    private hostEle: Element;\r\n    private documentMouseMoveListener: () => void;\r\n    private documentMouseUpListener: () => void;\r\n    private windowResizeListener: () => void;\r\n    private isDragStart: boolean = false;\r\n    private columsDiffer: IterableDiffer<Object>;\r\n    private subscription: Subscription;\r\n    private isColumnsInit: boolean = true;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isfirstYScrollStateChange: boolean = true;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public tableCom: TiTableComponent;\r\n    constructor(tableCom: TiTableComponent, private renderer: Renderer2,\r\n                private elementRef: ElementRef, private zone: NgZone, private tiRenderer: TiRenderer,\r\n                private iterableDiffers: IterableDiffers,\r\n                private fixedHeadService: TiTableFixedHeadService,\r\n                @Inject(DOCUMENT) private document) {\r\n        this.hostEle = this.elementRef.nativeElement;\r\n        this.tableCom = tableCom;\r\n    }\r\n\r\n    private static getThs(table: Element): Array<Element> {\r\n        return Array.from(table.children[0].children[0].children);\r\n    }\r\n\r\n    private static getWidth(element: any): number {\r\n        return parseFloat(element.getBoundingClientRect().width\r\n            .toFixed(1));\r\n    }\r\n\r\n    private static trackByFn(index: number, item: {show?: boolean}): boolean {\r\n        return item.show;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.subscription = this.tableCom.viewInitSubject.subscribe(() => {\r\n            this.processColsResizable();\r\n            this.isColumnsInit = false; // 主要处理 columns 初始为空，异步的场景\r\n            // 表格记忆\r\n            // 版本更新后用户第一次访问，localStorageState['colsWidth']不存在\r\n            // 修复SSR错误：ERROR TypeError: Cannot read property 'colsWidth' of undefined \r\n            if (this.tableCom.storageId && this.tableCom.storageConfig && this.tableCom.storageConfig.colsWidth\r\n                && this.tableCom.localStorageState && this.tableCom.localStorageState['colsWidth']) {\r\n                this.initStorageColsWidth();\r\n            }\r\n        });\r\n\r\n        this.columsDiffer = this.iterableDiffers.find(this.tableCom.columns)\r\n            .create(TiColsResizableDirective.trackByFn);\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        const columsDiffer: IterableChanges<TiTableColumns> = this.columsDiffer.diff(this.tableCom.columns);\r\n        if (columsDiffer) {\r\n            if (this.isColumnsInit) {\r\n                this.isColumnsInit = false;\r\n\r\n                return;\r\n            }\r\n            this.zone.runOutsideAngular(() => {\r\n                setTimeout(() => {\r\n                    this.setDefaultWidth();\r\n             }, 0);\r\n            });\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.subscription.unsubscribe();\r\n        if (this.documentMouseMoveListener) {\r\n            this.documentMouseMoveListener();\r\n        }\r\n        if (this.documentMouseUpListener) {\r\n            this.documentMouseUpListener();\r\n        }\r\n        if (this.windowResizeListener) {\r\n            this.windowResizeListener();\r\n        }\r\n    }\r\n\r\n    private processColsResizable(): void {\r\n        this.setTableWidthChange();\r\n        const table: any = this.resizableOpts.table = this.getTable();\r\n        const thead: any = table.children[0];\r\n        if (this.tableCom.isFixedHead) {\r\n            this.resizableOpts.secondTable = this.getSecondTable();\r\n            this.resizableOpts.xScrollState = this.overflowedX();\r\n            this.resizableOpts.yScrollState = this.overflowedY();\r\n            this.resizableOpts.ths = TiColsResizableDirective.getThs(table);\r\n            this.resizableOpts.secondThs = TiColsResizableDirective.getThs(this.resizableOpts.secondTable);\r\n            this.tableCom.processYScrollStateChangeWithColsResizable = (): void => {\r\n                this.fixedHeadService.processYScrollStateChange(this);\r\n            };\r\n        }\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            this.renderer.listen(thead, 'mousemove', (event: MouseEvent) => {\r\n                const currentTh: any = event.target;\r\n\r\n                if (currentTh['nodeName'] !== 'TH') {\r\n                    return;\r\n                }\r\n\r\n                // 获取当前th距页面文档的left值\r\n                const left: number = currentTh['getBoundingClientRect']().left + this.document.documentElement.scrollLeft;\r\n                const thWidth: number = currentTh['getBoundingClientRect']().width;\r\n                // 判断光标是否落在th的右边缘\r\n                const isOnColBorder: boolean = Math.abs(event.pageX - Math.round(left + thWidth)) <=\r\n                    TiColsResizableDirective.COL_BORDER_RANGE;\r\n\r\n                if (isOnColBorder) {\r\n                    if (event.target['hasAttribute'](this.notResizableAttr) ||\r\n                        this.isLastColumn(currentTh)) {\r\n                        return;\r\n                    }\r\n                    this.createDividingLine(currentTh);\r\n                } else {\r\n                    this.removeDividingLine();\r\n                }\r\n            });\r\n            this.renderer.listen(thead, 'mouseleave', () => {\r\n                this.removeDividingLine();\r\n            });\r\n            this.renderer.listen(thead, 'mousedown', (event: MouseEvent) => {\r\n                const currentTh: any = event.target;\r\n                if (this.tiRenderer.hasClass(currentTh, 'col-resize-active')) {\r\n                    this.isDragStart = true;\r\n                    // 鼠标点击的当前列\r\n                    this.resizableOpts.target = currentTh;\r\n                    // 更新光标位置\r\n                    this.resizableOpts.mouseXPosition = event.pageX;\r\n                    // 在拖动前获取当前表格最新的列信息、宽度，很关键，使得设置宽度与样式实际宽度一直\r\n                    this.updateTableInfo();\r\n                    // 给页面设置不可选样式，避免拖动时页面或表格内部出现被选中的蓝色区域\r\n                    this.toggleTextSelection(true);\r\n                }\r\n\r\n                if (this.tableCom.isFixedHead) {\r\n                    this.resizableOpts.xScrollState = this.overflowedX();\r\n                    this.resizableOpts.yScrollState = this.overflowedY();\r\n                }\r\n            });\r\n\r\n            const tableContainer: any = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];\r\n            if (!this.tiRenderer.hasClass(tableContainer, 'ti3-table-container')) {\r\n                this.renderer.listen(tableContainer, 'scroll', () => {\r\n                    Util.trigger(this.document, 'tiScroll');\r\n                });\r\n            }\r\n\r\n            this.documentMouseMoveListener = this.renderer.listen(this.document, 'mousemove', (event: MouseEvent) => {\r\n                // 列拖动的动作应该是先mousedown，然后mousemove，因此先判断是否已经触发了mousedown\r\n                if (!this.isDragStart || this.resizableOpts.mouseXPosition === 0 || !this.resizableOpts.target) {\r\n                    return;\r\n                }\r\n\r\n                this.mouseMove(event);\r\n            });\r\n            this.documentMouseUpListener = this.renderer.listen(this.document, 'mouseup', (event: MouseEvent) => {\r\n                if (!this.isDragStart) {\r\n                    return;\r\n                }\r\n\r\n                this.toggleTextSelection(false); // 恢复页面可选样式\r\n                this.stopResize(); // 保存最新宽度到浏览器中\r\n                this.isDragStart = false;\r\n            });\r\n\r\n            // 修复SSR报错：ERROR ReferenceError: window is not defined\r\n            if(typeof window === 'undefined'){\r\n                return;\r\n            }\r\n            this.windowResizeListener = this.renderer.listen(window, 'resize', () => {\r\n                this.setTableWidthChange();\r\n            });\r\n        });\r\n    }\r\n\r\n    private mouseMove(event: MouseEvent): void {\r\n        const options: ResizableOpts = this.resizableOpts;\r\n        const lastColIndex: number = options.ths.length - 1;\r\n        const curColIndex: number = parseInt(options.target.getAttribute('ti-visible-index'), 10);\r\n        const colWidth: number = options.storedSizes[curColIndex];\r\n        const leftEdge: number = parseFloat((event.pageX - options.mouseXPosition).toFixed(1));\r\n        const minWidth: number = this.getColMinWidth(options.target);\r\n\r\n        // 当拖拽方向为列宽度减小的方向且列宽已达到文本区最小宽度时阻止拖动\r\n        if ((leftEdge >= 0) || (colWidth + leftEdge > Math.ceil(minWidth))) {\r\n            // 更新拖动列宽度\r\n            options.storedSizes[curColIndex] += leftEdge;\r\n            this.setWidth(options.target, options.storedSizes[curColIndex]);\r\n\r\n            // 对最后一列的列宽的整体处理方案：\r\n            // 如果更新拖动列宽度后的表格的总宽度小于表格初始宽度，则将宽度差补偿到最后一列;\r\n            // 如果更新拖动列宽度后的表格的总宽度大于表格初始宽度，且之前最后一列列宽有补偿时，\r\n            // 将最后一列的补偿先抵消掉，然后有超出时再出滚动条\r\n\r\n            // s: storeTableWidthChange(此次拖动前各列拖动值的累计和)\r\n            // b: 此次拖动前给末列的补偿值\r\n            // l: leftEdge(此次拖动的距离)\r\n            //   s      l        s + l       b       此次拖动后对末列宽的设置\r\n            //  -5     -1       -6 < 0      +5          +1(-leftEdge)\r\n            //  -5     +3       -2 < 0      +5          -3(-leftEdge)\r\n            //  +5     -8       -3 < 0       0          +3(-(storeColsWidthChange+leftEdge))\r\n            //  -5     +8        3 > 0      +5          -5(+storeColsWidthChange)\r\n            //  +5     +3        8 > 0       0          +0(不做处理)\r\n            //  +5     -3        2 > 0       0          +0(不做处理)\r\n            if (leftEdge + options.storeTableWidthChange < 0) {\r\n                if (options.storeTableWidthChange < 0) {\r\n                    options.storedSizes[lastColIndex] -= leftEdge;\r\n                } else {\r\n                    options.storedSizes[lastColIndex] -= (leftEdge + options.storeTableWidthChange);\r\n                }\r\n            } else {\r\n                if (options.storeTableWidthChange < 0) {\r\n                    options.storedSizes[lastColIndex] += options.storeTableWidthChange;\r\n                }\r\n            }\r\n\r\n            this.setWidth(options.ths[lastColIndex], options.storedSizes[lastColIndex]);\r\n\r\n            // 更新各列拖动相对值的累计和\r\n            options.storeTableWidthChange += leftEdge;\r\n\r\n            // 表头锁定\r\n            if (this.tableCom.isFixedHead) {\r\n\r\n                // 更新第二个表格（bodyTable）中的当前列和最后一列的宽度\r\n                this.setWidth(options.secondThs[curColIndex], options.storedSizes[curColIndex]);\r\n                this.setWidth(options.secondThs[options.secondThs.length - 1], options.storedSizes[lastColIndex]);\r\n\r\n                this.fixedHeadService.handleYNotOverflowedWithX(this.resizableOpts, this.tableCom.tbodyContainer);\r\n\r\n                // 当横向滚动条出现导致纵向滚动条出现时对账本做处理\r\n                this.fixedHeadService.handleYOverflowedWithX(this.resizableOpts, this.tableCom.tbodyContainer);\r\n\r\n                // 纵向滚动条状态变化时对固定的表头右边填充块的处理\r\n                this.fixedHeadService.processOverflowY(this.tableCom.theadContainer, this.tableCom.tbodyContainer, this.tableCom);\r\n            }\r\n\r\n            if (this.tableCom.fixedColumnInfo.hasFixedColumn) {\r\n                this.tableCom.thResizeSubject.next({\r\n                    th: options.target,\r\n                    leftEdge,\r\n                    resizableOpts: this.resizableOpts\r\n                });\r\n                const container: any = this.tableCom.fixedColumnInfo.container;\r\n                if (container) {\r\n                    const scrollLeft: number = container.scrollLeft;\r\n                    const isRightColumnFloat: boolean = scrollLeft + container.clientWidth < container.scrollWidth;\r\n                    this.tableCom.containerScrollXChangeSubject.next({\r\n                        scrollLeft,\r\n                        isRightColumnFloat\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // 更新光标位置\r\n        options.mouseXPosition = event.pageX;\r\n    }\r\n\r\n    private getColMinWidth(thElement: any): number {\r\n        // 此处的值是'...'所占宽度，文本区的宽度最小为省略号所占宽度；当容器宽度小于此值时，文本会完全显示，但超出部分会直接被截断。\r\n        // Chrome 和 IE下省略号'...'所占宽度大概为10px;\r\n        // Firefox 下不会出现只有'...'的情况，最小为：一个字符 + '...',其所占宽度大概为28px(中文字符下)；\r\n        // 此处为保证三个浏览器都表现正常，取值29(28 + 1, 1为矫正偏差值)。\r\n        let minWidth: number = 29;\r\n\r\n        minWidth += parseFloat(window.getComputedStyle(thElement).paddingLeft) +\r\n            parseFloat(window.getComputedStyle(thElement).paddingRight);\r\n        const sortEle: any = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-sort-container')[0];\r\n        const iconsEle: any = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-cell-icons-container')[0];\r\n        const headFilterEle: any = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-head-filter-container')[0];\r\n\r\n        if (sortEle) {\r\n            const sortWidth: number = parseFloat(sortEle.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            minWidth += sortWidth;\r\n        }\r\n\r\n        if (iconsEle) {\r\n            const filterWidth: number = parseFloat(iconsEle.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            minWidth += filterWidth;\r\n        }\r\n\r\n        if (headFilterEle) {\r\n            const headFilterWidth: number = parseFloat(headFilterEle.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            minWidth += headFilterWidth;\r\n        }\r\n\r\n        return minWidth;\r\n    }\r\n\r\n    private setTableWidthChange(): void {\r\n        const tableContainer: any = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];\r\n        // 表格容器自身宽度（不包括Y方向滚动条的宽度）\r\n        const clientWidth: number = tableContainer ? tableContainer['clientWidth'] : 0;\r\n        // 表格容器实际内容区域宽度\r\n        const scrollWidth: number = tableContainer ? tableContainer['scrollWidth'] : 0;\r\n\r\n        // resizableOpts.storeColsWidthChange为各列拖动相对值的累计和\r\n        // 将表格内容溢出部分的宽度赋给各列拖动相对值的累计和\r\n        this.resizableOpts.storeTableWidthChange = scrollWidth - clientWidth;\r\n    }\r\n\r\n    private stopResize(): void {\r\n        this.updateStoredSizes();\r\n        this.resizableOpts.mouseXPosition = 0;\r\n        this.resizableOpts.target = null;\r\n        if (this.tableCom.isFixedHead) {\r\n            this.resizableOpts.xScrollState = this.overflowedX();\r\n            this.resizableOpts.yScrollState = this.overflowedY();\r\n        }\r\n    }\r\n\r\n    private getTable(): any {\r\n        // 用户给table元素加父容器，通过父容器设置overflow属性\r\n        const tableContainerClassName: string = this.tableCom.isFixedHead ? 'ti3-table-fixed-head' : 'ti3-resize-wrapper';\r\n        const tableContainer: any = this.tiRenderer.findChildrenByClassName(this.hostEle, tableContainerClassName)[0];\r\n        const table: any = tableContainer.children[0].nodeName === 'TABLE' ? tableContainer.children[0] : null;\r\n\r\n        return table;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public isLastColumn(th: any): boolean {\r\n        const parentElement: any = th.parentElement;\r\n        if (!parentElement) {\r\n            return true;\r\n        }\r\n        const ths: any = th.parentElement.children;\r\n        const index: number = Array.from(ths)\r\n            .indexOf(th);\r\n\r\n        return index === ths.length - 1;\r\n    }\r\n\r\n    // 当光标移到感应区时，出现拖动分割线\r\n    private createDividingLine(th: any): void {\r\n        this.renderer.addClass(th, 'col-resize-active');\r\n\r\n        const index: number = Array.from(th.parentElement.children)\r\n            .indexOf(th);\r\n        const bodyTable: any = this.tableCom.isFixedHead ? this.resizableOpts.secondTable : this.resizableOpts.table;\r\n        // 防止不存在tbody的场景报错\r\n        if(!bodyTable.children[1]){\r\n            return;\r\n        }\r\n        const trs: Array<any> = Array.from(bodyTable.children[1].children)\r\n            .filter((tr: any) => {\r\n                return this.needDividingLine(tr);\r\n        });\r\n        trs.forEach((tr: any) => {\r\n            // 分组场景index 大于tr.children.length\r\n            if (!tr.children[index]) {\r\n                return;\r\n            }\r\n            this.renderer.addClass(tr.children[index], 'col-resize-active');\r\n        });\r\n    }\r\n\r\n    // 当光标离开感应区时，拖动分割线消失\r\n    private removeDividingLine(): void {\r\n        const bodyTable: any = this.tableCom.isFixedHead ? this.resizableOpts.secondTable : this.resizableOpts.table;\r\n        const ths: Array<any> = Array.from(this.resizableOpts.table.children[0].children[0].children);\r\n\r\n        ths.forEach((th: Element) => {\r\n            this.renderer.removeClass(th, 'col-resize-active');\r\n        });\r\n\r\n        // 防止不存在tbody的场景报错\r\n        if(!bodyTable.children[1]) {\r\n            return;\r\n        }\r\n        const trs: Array<any> = Array.from(bodyTable.children[1].children);\r\n        trs.forEach((tr: Element) => {\r\n            if (!this.needDividingLine(tr)) {\r\n                return;\r\n            }\r\n            Array.from(tr.children)\r\n                .forEach((td: any) => {\r\n                    this.renderer.removeClass(td, 'col-resize-active');\r\n            });\r\n        });\r\n    }\r\n\r\n    private updateTableInfo(): void {\r\n        this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);\r\n        this.updateStoredSizes(); // 保存最新宽度\r\n        this.setComputedWidth(); // 设置最新宽度\r\n    }\r\n\r\n    private initStorageColsWidth():void {\r\n\r\n        this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);\r\n        this.resizableOpts.storedSizes = this.tableCom.localStorageState['colsWidth'];\r\n        this.setComputedWidth();\r\n        // 各列宽度设置后，可能出现滚动条，所以要计算一次 storeTableWidthChange的值\r\n        this.setTableWidthChange();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 将当前表格各列的宽度更新到到resizableOpts.storedSizes中\r\n     */\r\n    public updateStoredSizes = (): void => {\r\n        this.resizableOpts.storedSizes = [];\r\n        this.resizableOpts.ths.forEach((th: any, index: number) => {\r\n            this.tiRenderer.setAttributes(th, {'ti-visible-index': index});\r\n            this.resizableOpts.storedSizes[index] = TiColsResizableDirective.getWidth(th);\r\n        });\r\n        // 更新表格记忆\r\n        if(this.tableCom.storageId&&this.tableCom.storageConfig.colsWidth){\r\n            this.tableCom.localStorageState['colsWidth']= this.resizableOpts.storedSizes;\r\n        }\r\n    }\r\n\r\n    private setComputedWidth(): void {\r\n        if (this.resizableOpts.table && this.resizableOpts.ths && this.resizableOpts.ths.length) {\r\n            this.resizableOpts.ths.forEach((th: any, index: number) => {\r\n                this.setWidth(th, this.resizableOpts.storedSizes[index]);\r\n                // 表头锁定\r\n                if (this.tableCom.isFixedHead) {\r\n                    this.resizableOpts.secondThs = TiColsResizableDirective.getThs(this.resizableOpts.secondTable);\r\n                    this.setWidth(this.resizableOpts.secondThs[index], this.resizableOpts.storedSizes[index]);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public setWidth = (element: any, width: number): void => {\r\n        this.renderer.setStyle(element, 'width', width + 'px');\r\n    }\r\n\r\n    // 将表格宽度设置为默认宽度\r\n    private setDefaultWidth(): void {\r\n        const ths: Array<any> = this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);\r\n        // 列隐藏或显示后，将各列宽设置为初始用户设置的列宽\r\n        ths.forEach((th: any) => {\r\n            const width: string = th.getAttribute('width') ? th.getAttribute('width') : '';\r\n            // 注意：设置列宽的方式有多种，此处统一默认以width属性设置的宽为准\r\n            this.renderer.setStyle(th, 'width', width);\r\n        });\r\n\r\n        // 表头锁定\r\n        if (this.tableCom.isFixedHead) {\r\n            const secondTable: any = this.getSecondTable();\r\n            const secondThs: Array<any> = TiColsResizableDirective.getThs(secondTable);\r\n            this.resizableOpts.secondThs = secondThs;\r\n            this.resizableOpts.xScrollState = this.overflowedX();\r\n            this.resizableOpts.yScrollState = this.overflowedY();\r\n\r\n            secondThs.forEach((th: any) => {\r\n                const width: string = th.getAttribute('width') ? th.getAttribute('width') : '';\r\n                // 注意：设置列宽的方式有多种，此处统一默认以width属性设置的宽为准\r\n                this.renderer.setStyle(th, 'width', width);\r\n            });\r\n            this.fixedHeadService.processYScrollStateChange(this);\r\n        }\r\n        this.setTableWidthChange();\r\n    }\r\n\r\n    // 当列拖动进行时去掉文字可选样式(user-select: none)\r\n    private toggleTextSelection(toggle: boolean): void {\r\n        const body: any = this.document.body;\r\n        if (toggle) {\r\n            this.renderer.addClass(body, 'ti3-unselectable');\r\n            this.renderer.setAttribute(body, 'unselectable', 'on');\r\n        } else {\r\n            this.renderer.removeClass(body, 'ti3-unselectable');\r\n            body.removeAttribute('unselectable');\r\n        }\r\n    }\r\n\r\n    private needDividingLine(tr: any): boolean {\r\n        if (!tr) {\r\n            return false;\r\n        }\r\n        const classes: Array<string> = ['ti3-details-tr', 'ti3-table-nodata', 'ti3-table-loadfail',\r\n            'ti3-table-nodata-guide', 'ti3-table-nodata-simple'];\r\n        for (const className of classes) {\r\n            if (this.tiRenderer.hasClass(tr, className)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    // 供表头锁定使用\r\n    private getSecondTable(): Element {\r\n        const secondTableContainer: any = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];\r\n\r\n        return secondTableContainer ? secondTableContainer.children[0] : null;\r\n    }\r\n\r\n    private overflowedX(isNum?: boolean): any {\r\n        return this.fixedHeadService.overflowedResult(this.tableCom.tbodyContainer, 'X', isNum);\r\n    }\r\n\r\n    private overflowedY(isNum?: boolean): any {\r\n        return this.fixedHeadService.overflowedResult(this.tableCom.tbodyContainer, 'Y', isNum);\r\n    }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  OnInit,\r\n  Renderer2,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiPositionType } from '../../utils/Position';\r\n\r\n/**\r\n * TiCellText 表格单元格中放置文本的容器组件\r\n *\r\n * 提供文本溢出时出省略号...,且hover时出tip的功能。\r\n *\r\n * 配合TiCellText组件使用可使表格单元格中内容显示不下时，文本出省略号...,\r\n * 而文本后的放在TiCellIcons图标始终可以显示出来\r\n *\r\n */\r\n@Component({\r\n  selector: 'ti-cell-text',\r\n  templateUrl: './cell-text.html',\r\n  host: {\r\n      '[class.ti3-cell-text-container]': 'true'\r\n  }\r\n})\r\nexport class TiCellTextComponent implements AfterViewInit {\r\n    /**\r\n     * 设置文本超长显示时Tip内容项\r\n     */\r\n    @Input() tipContent: string;\r\n    /**\r\n     * 设置文本超长显示时Tip位置\r\n     */\r\n    @Input() tipPosition: TiPositionType;\r\n    @ViewChild('text', { static: true }) private cellTextEle: ElementRef;\r\n    constructor(private renderer: Renderer2, private elementRef: ElementRef,\r\n                private tiRenderer: TiRenderer) {}\r\n\r\n    ngAfterViewInit(): void {\r\n        setTimeout(() => {\r\n            this.setMaxWidth();\r\n        }, 0);\r\n    }\r\n\r\n    private setMaxWidth(): void {\r\n        let otherWidth: number = 0;\r\n        const parent: Element = this.renderer.parentNode(this.elementRef.nativeElement);\r\n        const iconsContainer: Element = this.tiRenderer.findChildrenByClassName(parent, 'ti3-cell-icons-container')[0];\r\n        const sortContainer: Element = this.tiRenderer.findChildrenByClassName(parent, 'ti3-sort-container')[0];\r\n        const headFilterContainer: Element = this.tiRenderer.findChildrenByClassName(parent, 'ti3-head-filter-container')[0];\r\n        const renameContainer: Element = this.tiRenderer.findChildrenByTagName(parent, 'TP-RENAME')[0];\r\n\r\n        // 修复SSR报错：ERROR TypeError: sortContainer.getBoundingClientRect is not a function\r\n        if(typeof parent.getBoundingClientRect !== 'function'){\r\n            return;\r\n        }\r\n        // 修复SSR报错：ERROR TypeError: Cannot read property 'getBoundingClientRect' of undefined\r\n        if (iconsContainer) {\r\n            const iconsContainerWidth: number = parseFloat(iconsContainer.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            otherWidth += iconsContainerWidth;\r\n        }\r\n\r\n        if (sortContainer) {\r\n            const sortContainerWidth: number = parseFloat(sortContainer.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            otherWidth += sortContainerWidth;\r\n        }\r\n\r\n        if (headFilterContainer) {\r\n            const headFilterContainerWidth: number = parseFloat(headFilterContainer.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            otherWidth += headFilterContainerWidth;\r\n        }\r\n\r\n        if (renameContainer) {\r\n            const renameContainerWidth: number = parseFloat(renameContainer.getBoundingClientRect().width\r\n                .toFixed(1));\r\n            otherWidth += renameContainerWidth;\r\n        }\r\n\r\n        this.renderer.setStyle(this.cellTextEle.nativeElement, 'max-width', `calc(100% - ${otherWidth}px)`);\r\n    }\r\n}\r\n","import {\r\n  Component\r\n} from '@angular/core';\r\n\r\n/**\r\n * TiCellIcons 表格单元格中放置图标的容器组件\r\n *\r\n * 配合TiCellText组件使用可使表格单元格中内容显示不下时，文本出省略号...,\r\n * 而文本后的放在TiCellIcons图标始终可以显示出来\r\n *\r\n */\r\n@Component({\r\n  selector: 'ti-cell-icons',\r\n  templateUrl: './cell-icons.html',\r\n  host: {\r\n      '[class.ti3-cell-icons-container]': 'true'\r\n  }\r\n})\r\nexport class TiCellIconsComponent {\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\n/**\r\n * @ignore\r\n * TiColumnsPipe 过滤掉columns中的title为空的数据项\r\n *\r\n */\r\n@Pipe({ name: 'tiColumns' })\r\nexport class TiColumnsPipe implements PipeTransform {\r\n    transform(value: Array<any>): Array<any> {\r\n        return value.filter((item: any) => !Util.isEmptyString(item.title));\r\n    }\r\n}\r\n","import {\r\n    AfterViewChecked,\r\n    Directive,\r\n    ElementRef,\r\n    NgZone,\r\n    OnInit,\r\n    OnDestroy,\r\n    Renderer2,\r\n    Input\r\n} from '@angular/core';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiTableComponent } from './TiTableComponent';\r\nimport { TiBrowser } from '../../utils/Util';\r\nimport { Subscription } from 'rxjs';\r\n/**\r\n * tiColumnFixed 表格列固定(IE和Edge浏览器不支持)\r\n *\r\n * 适用场景：对于列数很多的表格，可以固定前后列，横向滚动查看其它数据。\r\n *\r\n * 规范：左侧支持最多3列固定(3列不包含单选/复选框所在列)，右侧支持最多1列固定。横向滚动条贯穿左右，与表格最左和最右对齐。\r\n * 表格下展场景不需要支持列固定。\r\n *\r\n * 9.0.4新增\r\n */\r\n@Directive({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: 'th[tiColumnFixed], td[tiColumnFixed]',\r\n    host: {\r\n        '[class.ti3-table-column-fixed-right]': \"!notSupportBrowser && type === 'right'\",\r\n        '[class.ti3-table-column-fixed-left]': \"!notSupportBrowser && type === 'left'\"\r\n    }\r\n})\r\nexport class TiColumnFixedDirective implements OnInit, AfterViewChecked, OnDestroy {\r\n    /**\r\n     * tiColumnFixed 开启列固定功能；接口传入 left 为在左侧固定,左侧可连续多列固定，且必须从第一列开始固定；\r\n     * 接口传入 right 为在右侧固定，右侧只能固定一列，且必须是最后一列; 接口传入其他值不会开启固定功能。\r\n     */\r\n    @Input('tiColumnFixed') type: 'right' | 'left';\r\n    private tagName: 'TH' | 'TD';\r\n    private tdLeft: number;\r\n    private element: any;\r\n    private columnFixedLeftLast: boolean = false;\r\n    private floatingFixedColumn: boolean = false;\r\n    private firstAfterViewChecked: boolean = true;\r\n    private containerScrollXChangeSubscription: Subscription;\r\n    private thResizeSubscription: Subscription;\r\n    private updateFixedThLeftSubscription: Subscription;\r\n    private updateFixedTdLeftSubscription: Subscription;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public notSupportBrowser: boolean;\r\n    constructor(private renderer: Renderer2, elementRef: ElementRef, private tiRenderer: TiRenderer,\r\n                private tableCom: TiTableComponent, private zone: NgZone) {\r\n        this.element = elementRef.nativeElement;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        // IE 不支持粘性定位position: sticky，使用其他定位方式有闪动，目前无法解决； EDGE 固定列边框不显示， 表头固定时拖动横向滚动条表头横向平移不及时\r\n        this.notSupportBrowser = TiBrowser.isIE() || TiBrowser.isEdge();\r\n        if (this.notSupportBrowser || !this.type) {\r\n            return;\r\n        }\r\n\r\n        if (!this.tableCom.fixedColumnInfo.container) {\r\n            const container: any = this.tiRenderer.findChildrenByClassName(this.tableCom.hostEle, 'ti3-table-container')[0];\r\n            if (!container) {\r\n                return;\r\n            }\r\n            this.tableCom.fixedColumnInfo.container = container;\r\n        }\r\n\r\n        this.tableCom.fixedColumnInfo.hasFixedColumn = true;\r\n\r\n        this.tagName = this.element.tagName;\r\n\r\n        if (this.type === 'right' && this.tagName === 'TH') {\r\n            // 表头固定需要此参数\r\n            this.tableCom.fixedColumnInfo.thFixedRight = this.element;\r\n        }\r\n\r\n        this.addBehavior();\r\n    }\r\n\r\n\r\n    ngAfterViewChecked(): void {\r\n        if (this.notSupportBrowser || !this.type || !this.firstAfterViewChecked) {\r\n            return;\r\n        }\r\n\r\n        this.firstAfterViewChecked = false;\r\n        this.init();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.containerScrollXChangeSubscription) {\r\n            this.containerScrollXChangeSubscription.unsubscribe()\r\n        }\r\n        if (this.thResizeSubscription) {\r\n            this.thResizeSubscription.unsubscribe()\r\n        }\r\n        if (this.updateFixedThLeftSubscription) {\r\n            this.updateFixedThLeftSubscription.unsubscribe()\r\n        }\r\n        if (this.updateFixedTdLeftSubscription) {\r\n            this.updateFixedTdLeftSubscription.unsubscribe()\r\n        }\r\n    }\r\n\r\n    private init() : void {\r\n        if (this.type === 'left') {\r\n            if (this.tagName === 'TH') {\r\n                this.processTh();\r\n            } else {\r\n                this.processTd();\r\n            }\r\n        }\r\n\r\n\r\n        if (this.tagName === 'TH') {\r\n            this.zone.runOutsideAngular(() => {\r\n                // 表头初始时容器的滚动状态还未初始完成\r\n                setTimeout(() => {\r\n                    const scrollLeft: number = this.tableCom.fixedColumnInfo.container.scrollLeft;\r\n                    const isRightColumnFloat: boolean = scrollLeft + this.tableCom.fixedColumnInfo.container.clientWidth < this.tableCom.fixedColumnInfo.container.scrollWidth;\r\n                    this.tableCom.containerScrollXChangeSubject.next({\r\n                        scrollLeft,\r\n                        isRightColumnFloat\r\n                    });\r\n                }, 0);\r\n            });\r\n        } else {\r\n            const scrollLeft: number = this.tableCom.fixedColumnInfo.container.scrollLeft;\r\n            const isRightColumnFloat: boolean = scrollLeft + this.tableCom.fixedColumnInfo.container.clientWidth < this.tableCom.fixedColumnInfo.container.scrollWidth;\r\n            this.tableCom.containerScrollXChangeSubject.next({\r\n                scrollLeft,\r\n                isRightColumnFloat\r\n            });\r\n        }\r\n    }\r\n\r\n    private addBehavior(): void {\r\n        // 处理左右固定的最后一列是否有阴影(看起来有浮动效果)\r\n        this.containerScrollXChangeSubscription = this.tableCom.containerScrollXChangeSubject.subscribe((scrollInfo: any) => {\r\n\r\n            if (this.type === 'right' && scrollInfo.isRightColumnFloat !== this.floatingFixedColumn) {\r\n                this.processLastFixedColumn(this.element, scrollInfo.isRightColumnFloat);\r\n            }\r\n            if (this.type === 'left' && this.columnFixedLeftLast && (scrollInfo.scrollLeft > 0) !== this.floatingFixedColumn) {\r\n                this.processLastFixedColumn(this.element, scrollInfo.scrollLeft > 0);\r\n            }\r\n        });\r\n\r\n        // 处理左侧固定的列的left值(左侧可多列固定)\r\n        if (this.type === 'left' && this.tagName === 'TH') {\r\n            this.thResizeSubscription = this.tableCom.thResizeSubject.subscribe((thResizeInfo: any) => {\r\n                const th: any = thResizeInfo.th;\r\n                if (th !== this.element) {\r\n                    return;\r\n                }\r\n\r\n                const nextSibling: any = th.nextElementSibling;\r\n                if (nextSibling && this.tiRenderer.hasClass(nextSibling, 'ti3-table-column-fixed-left')) {\r\n                    const siblings: any = th.parentElement.children;\r\n                    const index: number = Array.from(siblings)\r\n                        .indexOf(th);\r\n                    const changeColumnsIndex: Array<number> = [];\r\n                    for (let i: number = index + 1; i < siblings.length; i++) {\r\n                        if (!siblings[i] || !this.tiRenderer.hasClass(siblings[i], 'ti3-table-column-fixed-left')) {\r\n                            break;\r\n                        }\r\n                        changeColumnsIndex.push(i);\r\n                        this.tableCom.fixedColumnInfo.fixedColumnLeftValues[i] += thResizeInfo.leftEdge;\r\n                        this.renderer.setStyle(siblings[i], 'left', `${this.tableCom.fixedColumnInfo.fixedColumnLeftValues[i]}px`);\r\n                    }\r\n                    const bodyTable: any = this.tableCom.isFixedHead ? thResizeInfo.resizableOpts.secondTable : thResizeInfo.resizableOpts.table;\r\n                    const trs: Array<any> = Array.from(bodyTable.children[1].children)\r\n                        .filter((tr: any) => {\r\n                            return this.needFixedColumnTr(tr);\r\n                        });\r\n                    trs.forEach((tr: any) => {\r\n                        changeColumnsIndex.forEach((columnIndex: number) => {\r\n                            this.renderer.setStyle(tr.children[columnIndex], 'left', `${this.tableCom.fixedColumnInfo.fixedColumnLeftValues[columnIndex]}px`);\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n\r\n            this.updateFixedThLeftSubscription = this.tableCom.updateFixedThLeftSubject.subscribe(() => {\r\n                this.processTh();\r\n            });\r\n        }\r\n\r\n        if (this.type === 'left' && this.tagName === 'TD') {\r\n            this.updateFixedTdLeftSubscription = this.tableCom.updateFixedTdLeftSubject.subscribe(() => {\r\n                this.processTd();\r\n            });\r\n        }\r\n    }\r\n\r\n    private processTd(): void {\r\n        const siblings: any = this.element.parentElement.children;\r\n        const index: number = Array.from(siblings)\r\n            .indexOf(this.element);\r\n        // 进行判空处理，因为有可能是td元素先出现。\r\n        // TODO: 考虑下processTd和processTd是否可以使用相同的处理方式。\r\n        if (this.tableCom.fixedColumnInfo.fixedColumnLeftValues && this.tableCom.fixedColumnInfo.fixedColumnLeftValues.length &&\r\n            this.tableCom.fixedColumnInfo.fixedColumnLeftValues[index] !== this.tdLeft) {\r\n            this.tdLeft = this.tableCom.fixedColumnInfo.fixedColumnLeftValues[index];\r\n            this.renderer.setStyle(this.element, 'left', `${this.tdLeft}px`);\r\n        }\r\n\r\n        if (index === this.tableCom.fixedColumnInfo.columnFixedLeftLastIndex) {\r\n            this.columnFixedLeftLast = true;\r\n        }\r\n    }\r\n\r\n    private processTh(): void {\r\n        const siblings: any = this.element.parentElement.children;\r\n        let left: number = 0;\r\n        this.tableCom.fixedColumnInfo.fixedColumnLeftValues = [];\r\n\r\n        // tslint:disable-next-line:prefer-for-of\r\n        for (let i: number = 0; i < siblings.length; i++) {\r\n            const current: any = siblings[i];\r\n            if (this.tableCom.fixedColumnInfo.fixedColumnLeftValues[i] !== left) {\r\n                this.tableCom.fixedColumnInfo.fixedColumnLeftValues[i] = left;\r\n                this.renderer.setStyle(current, 'left', `${left}px`);\r\n            }\r\n            // offsetWidth 包括边框\r\n            left += current.offsetWidth;\r\n            const nextSibling: any = siblings[i + 1];\r\n            if (nextSibling && !this.tiRenderer.hasClass(nextSibling, 'ti3-table-column-fixed-left')) {\r\n                this.columnFixedLeftLast = true;\r\n                this.tableCom.fixedColumnInfo.columnFixedLeftLastIndex = i;\r\n                break;\r\n            } else {\r\n                this.columnFixedLeftLast = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private processLastFixedColumn(ele: any, add: boolean): void {\r\n        if (add) {\r\n            this.floatingFixedColumn = true;\r\n            this.renderer.addClass(ele, 'ti3-table-floating-fixed-column');\r\n        } else {\r\n            this.floatingFixedColumn = false;\r\n            this.renderer.removeClass(ele, 'ti3-table-floating-fixed-column');\r\n        }\r\n    }\r\n\r\n    private needFixedColumnTr(tr: any): boolean {\r\n        if (!tr) {\r\n            return false;\r\n        }\r\n        const classes: Array<string> = ['ti3-details-tr', 'ti3-table-nodata', 'ti3-table-loadfail',\r\n            'ti3-table-nodata-guide', 'ti3-table-nodata-simple'];\r\n        for (const className of classes) {\r\n            if (this.tiRenderer.hasClass(tr, className)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n","import {\r\n    AfterViewInit,\r\n    Directive,\r\n    ElementRef,\r\n    Renderer2\r\n} from '@angular/core';\r\n/**\r\n * 10.1.2版本新增\r\n * 根据规范：“单/复选框”关联表格使用时，为了提升选中效率，点击热区为“单/复选框”按钮所在单元格，点击即可选中。\r\n */\r\n@Directive({\r\n    selector: 'td[checkbox-column], th[checkbox-column], td[radio-column]'\r\n})\r\nexport class TiColClickDirective implements AfterViewInit {\r\n\r\n    constructor(private renderer: Renderer2, private elementRef: ElementRef) {\r\n\r\n    }\r\n    ngAfterViewInit(): void {\r\n        this.renderer.listen(this.elementRef.nativeElement, 'click', (event: MouseEvent): void => {\r\n            const inputEle: any = this.elementRef.nativeElement.querySelector('input');\r\n            const checkboxLabelEle: any = this.elementRef.nativeElement.querySelector('.ti3-checkbox');\r\n            const radioLabelEle: any = this.elementRef.nativeElement.querySelector('.ti3-radio');\r\n            // 点击单/复选空白区域时，触发input点击事件\r\n            // 表格和单/复选联用时，checkboxLabelEle和radioLabelEle不会同时出现，所以需要分别进行判断\r\n            // inputEle和checkboxLabelEle/radioLabelEle是兄弟元素\r\n            // event.target !== inputEle阻止在firefox下因为inputEle.click()产生的冒泡循环\r\n            if (event.target !== inputEle &&\r\n                ((checkboxLabelEle && !(event.target === checkboxLabelEle  || checkboxLabelEle.contains(event.target))) ||\r\n                (radioLabelEle && !(event.target === radioLabelEle || radioLabelEle.contains(event.target))))) {\r\n                inputEle.click();\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiListModule } from '../list/TiListModule';\r\nimport { TiSearchboxModule } from '../searchbox/TiSearchboxModule';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiOverflowModule } from '../../directives/overflow/TiOverflowModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiTableFixedHeadServiceModule } from './TiTableFixedHeadServiceModule';\r\nimport { TiTableComponent } from './TiTableComponent';\r\nimport { TiHeadFilterComponent } from './TiHeadFilterComponent';\r\nimport { TiHeadFilterDropComponent } from './TiHeadFilterDropComponent';\r\nimport { TiHeadSortComponent } from './TiHeadSortComponent';\r\nimport { TiDetailsIconComponent } from './TiDetailsIconComponent';\r\nimport { TiDetailsTrDirective } from './TiDetailsTrDirective';\r\nimport { TiColspanDirective } from './TiColspanDirective';\r\nimport { TiColsToggleComponent } from './TiColsToggleComponent';\r\nimport { TiColsToggleDropComponent } from './TiColsToggleDropComponent';\r\nimport { TiColsResizableDirective } from './TiColsResizableDirective';\r\nimport { TiCellTextComponent } from './TiCellTextComponent';\r\nimport { TiCellIconsComponent } from './TiCellIconsComponent';\r\nimport { TiColumnsPipe } from './TiColumnsPipe';\r\nimport { TiColumnFixedDirective } from './TiColumnFixedDirective';\r\nimport { TiColClickDirective } from './TiColClickDirective';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiButtonModule,\r\n    TiIconModule,\r\n    TiListModule,\r\n    TiSearchboxModule,\r\n    TiDropModule,\r\n    TiOverflowModule,\r\n    TiTableFixedHeadServiceModule,\r\n    TiLocaleModule,\r\n    TiRendererModule,\r\n    TiTipModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [\r\n    TiTableComponent,\r\n    TiHeadFilterComponent,\r\n    TiHeadSortComponent,\r\n    TiDetailsIconComponent,\r\n    TiDetailsTrDirective,\r\n    TiColspanDirective,\r\n    TiColsToggleComponent,\r\n    TiColsResizableDirective,\r\n    TiCellTextComponent,\r\n    TiCellIconsComponent,\r\n    TiColumnFixedDirective,\r\n    TiColClickDirective ],\r\n  declarations: [\r\n    TiTableComponent,\r\n    TiHeadFilterComponent,\r\n    TiHeadFilterDropComponent,\r\n    TiHeadSortComponent,\r\n    TiDetailsIconComponent,\r\n    TiDetailsTrDirective,\r\n    TiColspanDirective,\r\n    TiColsToggleComponent,\r\n    TiColsToggleDropComponent,\r\n    TiColsResizableDirective,\r\n    TiCellTextComponent,\r\n    TiCellIconsComponent,\r\n    TiColumnsPipe,\r\n    TiColumnFixedDirective,\r\n    TiColClickDirective]\r\n})\r\nexport class TiTableModule {\r\n}\r\nexport { TiTableComponent, TiTableSrcState, TiTableDataState, TiTableRowData, TiTableSrcData, TiTableColumns, TiTableStorageConfig, TiPaginationStorageConfig } from './TiTableComponent';\r\nexport { TiHeadFilterComponent } from './TiHeadFilterComponent';\r\nexport { TiHeadSortComponent } from './TiHeadSortComponent';\r\nexport { TiDetailsIconComponent } from './TiDetailsIconComponent';\r\nexport { TiDetailsTrDirective } from './TiDetailsTrDirective';\r\nexport { TiColspanDirective } from './TiColspanDirective';\r\nexport { TiColsToggleComponent } from './TiColsToggleComponent';\r\nexport { TiColsResizableDirective } from './TiColsResizableDirective';\r\nexport { TiCellTextComponent } from './TiCellTextComponent';\r\nexport { TiCellIconsComponent } from './TiCellIconsComponent';\r\nexport { TiColumnFixedDirective } from './TiColumnFixedDirective';\r\nexport { TiColClickDirective } from './TiColClickDirective';\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  Optional,\r\n  Output,\r\n  Renderer2,\r\n  SimpleChange,\r\n  SimpleChanges,\r\n  TemplateRef,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiLocale, TiLocaleFormat, TiLocaleWords } from '../../locale/TiLocaleModule'; // 获取词条\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiTableComponent } from '../table/TiTableModule';\r\nimport { TiSelectComponent } from '../select/TiSelectModule';\r\nimport { Subscription } from 'rxjs';\r\n\r\n/**\r\n * 实现每页显示条数的相关配置的数据类型\r\n */\r\nexport interface TiPageSizeConfig {\r\n  /**\r\n   * 组件每页显示条数选项列表：下拉列表\r\n   */\r\n  options?: Array<number>;\r\n  /**\r\n   * 当前每页显示条数配置，注意: 该值应该属于options数组中的一个元素\r\n   */\r\n  size?: number;\r\n  /**\r\n   * 设置每页显示条数选项元素(页面上是一个select组件)的宽度\r\n   */\r\n  width?: string;\r\n  /**\r\n   * 设置是否在页面上隐藏每页显示条数选项元素。\r\n   */\r\n  hide?: boolean;\r\n}\r\n\r\n/**\r\n * 当分页更新时触发事件通知出去的参数\r\n *\r\n * 更新场景包括：1.当前页码改变，2.每页显示条数改变，3.总条数改变。\r\n */\r\nexport interface TiPaginationEvent {\r\n  currentPage: number;\r\n  size: number;\r\n  totalNumber: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n * 页码的数据类型\r\n */\r\nexport interface TiPageItem {\r\n  id: string;\r\n  label: any;\r\n}\r\n\r\n/**\r\n * Pagination分页组件\r\n *\r\n * 分页组件一般情况下与表格组件配合使用，实现对表格数据的分页显示。\r\n *\r\n * <example-url>../tiny3demo/#/pagination/pagination-all</example-url>\r\n */\r\n@Component({\r\n  selector: 'ti-pagination',\r\n  templateUrl: './pagination.html',\r\n  styleUrls: ['./pagination.less', '../text/text.less'], // 引用text的less文件\r\n  host: {\r\n    '[class.ti3-page-container]': 'true',\r\n    '[class.ti3-pag-container-disable]': 'this.disabled',\r\n    '[attr.unselectable]': '\"on\"'\r\n  }\r\n})\r\n\r\nexport class TiPaginationComponent extends TiFormComponent {\r\n    private static readonly MIN_PAGE: number = 1;\r\n    /**\r\n     * 设置组件的类型：三种类型default(默认)、simple、mini\r\n     */\r\n    @Input() type: 'default' | 'simple' | 'mini' = 'default';\r\n    /**\r\n     * 设置当前数据总条数\r\n     */\r\n    @Input() totalNumber: number;\r\n    /**\r\n     * 组件内部改变总条数时会触发该事件，向外通知当前总条数。\r\n     */\r\n    @Output() readonly totalNumberChange: EventEmitter<number> = new EventEmitter<number>();\r\n    /**\r\n     * 设置当前页码\r\n     */\r\n    @Input() currentPage: number = 1;\r\n    /**\r\n     * 组件内部改变当前页码时会触发该事件，向外通知当前页码数。\r\n     */\r\n    @Output() readonly currentPageChange: EventEmitter<number> = new EventEmitter<number>();\r\n    /**\r\n     * 实现每页显示条数的相关配置，包括如下属性\r\n     *\r\n     * options:组件每页显示条数选项列表，默认配置：[10, 20, 50]\r\n     *\r\n     * size:每页显示条数配置，注意: 该值应该属于options数组中的一个元素，默认：10\r\n     *\r\n     * width:设置每页显示条数选项元素(页面上是一个select组件)的宽度，默认：'50px'\r\n     *\r\n     * hide:设置是否在页面上隐藏每页显示条数选项元素，默认：false\r\n     */\r\n    @Input() pageSize: TiPageSizeConfig;\r\n    /**\r\n     * 设置是否总条数的显示与隐藏\r\n     */\r\n    @Input() showTotalNumber: boolean = true;\r\n    /**\r\n     * 设置是否显示页码跳转按钮（默认不显示)\r\n     */\r\n    @Input() showGotoLink: boolean = false;\r\n    /**\r\n     * 组件是否开启自动隐藏功能。开启后，当总条数totalNumber小于每页显示条数选项列表中的最小值时，隐藏分页\r\n     */\r\n    @Input() autoHide: boolean = false;\r\n    /**\r\n     * 组件是否禁用状态\r\n     */\r\n    @Input() disabled: boolean = false;\r\n    /**\r\n     * 设置最后一页的显示与隐藏（一般数据量比较大的场景隐藏最后一页）：默认显示\r\n     */\r\n    @Input() showLastPage: boolean = true;\r\n    /**\r\n     * 当操作选择框改变每页显示条数时会触发该事件，向外通知当前页码、每页显示条数和总条数。\r\n     */\r\n    @Output() readonly pageNumChange: EventEmitter<TiPaginationEvent> = new EventEmitter<TiPaginationEvent>();\r\n    /**\r\n     * 当操作选择框改变每页显示条数或操作页码改变当前页码时会触发该事件，向外通知当前页码、每页显示条数和总条数。\r\n     */\r\n    @Output() readonly pageUpdate: EventEmitter<TiPaginationEvent> = new EventEmitter<TiPaginationEvent>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('mini', { static: true }) mini: TemplateRef<any> = undefined;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('input') inputRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     * 非mini类型：select下拉组件\r\n     */\r\n    public itemsPerPage: any;\r\n    /**\r\n     * @ignore\r\n     * mini类型：select下拉组件\r\n     */\r\n    public itemsMini: any;\r\n    /**\r\n     * @ignore\r\n     * 用户输入即将跳转的页码\r\n     */\r\n    public gotoPage: { page?: any } = {};\r\n    /**\r\n     * @ignore\r\n     * 页码列表\r\n     */\r\n    public pages: Array<{ key: any, active: boolean }>;\r\n    private hidePage: boolean = false;\r\n    private totalPageNum: number;\r\n    private oldCurrentPage: number;\r\n    private oldTotalNumber: number;\r\n    private oldSelected: number;\r\n    private oldSize: number;\r\n    private subscription: Subscription;\r\n    private updateFocusableElems: boolean;\r\n    private defaultPageSize: TiPageSizeConfig = {\r\n      options: [10, 20, 50], // 下拉选项列表\r\n      size: 10, // 默认每页显示10条\r\n      width: '60px', // select宽度\r\n      hide: false // 设置是否在页面上隐藏每页显示条数选项：下拉列表\r\n    };\r\n    constructor(protected render: Renderer2,\r\n                protected hostRef: ElementRef,\r\n                @Optional() private table: TiTableComponent,\r\n                @Optional() private select: TiSelectComponent) {\r\n      super(hostRef, render);\r\n    }\r\n\r\n    /**\r\n     * @description 创建每一个页码对应的数据\r\n     * @params key 页码显示，为数字或者是\"···\"\r\n     * @params isActive 是否为当前激活页\r\n     */\r\n    private static makePage(key: any, isActive: boolean): { key: any, active: boolean } {\r\n      return {\r\n        key,\r\n        active: isActive\r\n      };\r\n    }\r\n\r\n    ngOnInit(): void {\r\n      super.ngOnInit();\r\n      // 组件对外各个接口的初始化处理\r\n      this.initData();\r\n      this.renderPage();\r\n\r\n      if (this.isWithTable()) {\r\n            this.subscription = this.table.paginationSubject.subscribe((value: { totalNumber?: number, currentPage?: number }) => {\r\n                if (!Util.isUndefined(value.totalNumber) && value.totalNumber !== this.totalNumber) {\r\n                    this.totalNumber = value.totalNumber;\r\n                    this.verifyCurrentPage(this.itemsPerPage.selected, true);\r\n                    this.totalNumberChange.emit(this.totalNumber);\r\n                }\r\n\r\n                if (!Util.isUndefined(value.currentPage) && value.currentPage !== this.currentPage) {\r\n                    this.currentPage = value.currentPage;\r\n                    this.currentPageChange.emit(this.currentPage);\r\n                }\r\n            });\r\n            // 表格记忆\r\n            this.updateFromStorage();\r\n        }\r\n\r\n        // select下拉面板（dropsearch）中使用分页\r\n        if (this.select) {\r\n            this.select.pagination = this;\r\n            this.select.dropsearchCom.pagination = this;\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n      const currentPageObj: SimpleChange = changes['currentPage'];\r\n      const totalNumberObj: SimpleChange = changes['totalNumber'];\r\n      if ((currentPageObj && !currentPageObj.firstChange) || (totalNumberObj && !totalNumberObj.firstChange)) {\r\n        this.verifyCurrentPage(this.itemsPerPage.selected, true);\r\n      }\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n      // 监听开发者设置的pageSize.size的改变\r\n      if (!Util.isUndefined(this.pageSize) && this.pageSize.size !== this.oldSize) {\r\n        const index: number = this.itemsPerPage.options.indexOf(this.pageSize.size);\r\n        if (index !== -1) {\r\n          this.itemsPerPage.selected = this.itemsPerPage.options[index];\r\n          this.verifyCurrentPage(this.itemsPerPage.selected, true);\r\n          this.oldSize = this.pageSize.size;\r\n        }\r\n      }\r\n\r\n      if (this.oldTotalNumber !== this.totalNumber || this.itemsPerPage.selected !== this.oldSelected ||\r\n        this.oldCurrentPage !== this.currentPage) {\r\n        this.renderPage();\r\n        this.oldTotalNumber = this.totalNumber;\r\n        this.oldSelected = this.itemsPerPage.selected;\r\n        this.oldCurrentPage = this.currentPage;\r\n        this.updateFocusableElems = true; // select使用过这个变量后，会重置为false\r\n      }\r\n    }\r\n    ngAfterViewChecked(): void {\r\n      // select中使用的分页为default类型且不带左边select，所以此处限定type === 'default'\r\n      if (this.type === 'default' && this.updateFocusableElems) {\r\n        // 修复SSR报错：ERROR TypeError: this.nativeElement.querySelectorAll(...) is not a function or its return value is not iterable\r\n        // this.setFocusableElems([...(this.nativeElement as HTMLElement).querySelectorAll('a')]);\r\n        this.setFocusableElems(Array.prototype.slice.call(this.nativeElement.querySelectorAll('a')));\r\n      }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n      if (this.subscription) {\r\n        this.subscription.unsubscribe();\r\n      }\r\n    }\r\n\r\n    // 数据初始化\r\n    private initData(): void {\r\n      // 总条数数字国际化处理，拼接成 ---> 总条数: 条数\r\n      this.setTotalNumberFormat();\r\n\r\n      // 初始化获取itemsPerPage：select组件所需的属性\r\n      this.itemsPerPage = this.getFormatedSize();\r\n\r\n      this.verifyCurrentPage(this.itemsPerPage.selected, true);\r\n\r\n      this.oldCurrentPage = this.currentPage;\r\n      this.oldTotalNumber = this.totalNumber;\r\n      this.oldSize = this.itemsPerPage.selected;\r\n      this.oldSelected = this.itemsPerPage.selected;\r\n    }\r\n\r\n    // 是否有表格当前页记忆\r\n    private isStorageCurrentPage(): boolean {\r\n      // tslint:disable-next-line: max-line-length\r\n      return this.table.storageId && (this.table.storageConfig.pagination === true || (this.table.storageConfig.pagination && this.table.storageConfig.pagination['currentPage'] === true));\r\n    }\r\n\r\n    // 是否有表格每页个数记忆\r\n    private isStorageItemsPerPage(): boolean {\r\n      // tslint:disable-next-line: max-line-length\r\n      return this.table.storageId && (this.table.storageConfig.pagination === true || (this.table.storageConfig.pagination && this.table.storageConfig.pagination['itemsPerPage'] === true));\r\n    }\r\n    // 处理表格记忆\r\n    private updateFromStorage(): void {\r\n        // 修复SSR报错：ERROR TypeError: Cannot read property 'currentPage' of undefined\r\n        // 当前页\r\n        if (this.isStorageCurrentPage()) {\r\n            const currentPage: number = this.table.sessionStorageState && this.table.sessionStorageState.currentPage;\r\n            if (currentPage > 0) {\r\n                Promise.resolve(currentPage).then(() => {\r\n                    this.currentPage = currentPage;\r\n                    this.currentPageChange.emit(currentPage);\r\n                });\r\n            }\r\n        }\r\n        // 修复SSR错误：ERROR TypeError: Cannot read property 'itemsPerPage' of undefined\r\n        // 每页条数\r\n        if (this.isStorageItemsPerPage()) {\r\n          const itemsPerPage: number = this.table.localStorageState && this.table.localStorageState.itemsPerPage;\r\n          if (itemsPerPage > 0) {\r\n              Promise.resolve(itemsPerPage).then(() => {\r\n                  this.pageSize.size = itemsPerPage;\r\n                  const pagination: TiPaginationEvent = {\r\n                      currentPage: this.currentPage,\r\n                      size: itemsPerPage,\r\n                      totalNumber: this.totalNumber\r\n                  };\r\n                  this.pageNumChange.emit(pagination);\r\n              });\r\n          }\r\n\r\n    }\r\n  }\r\n\r\n    /**\r\n     * 根据接口配置来渲染页面\r\n     */\r\n    private renderPage(): void {\r\n      if (this.type === 'mini') {\r\n        this.configMini();\r\n      } else {\r\n        // goto页码与当前页码保持一致\r\n        this.gotoPage = {\r\n          page: this.currentPage\r\n        };\r\n\r\n        // 页码列表\r\n        this.pages = this.getPages();\r\n      }\r\n\r\n      // 用户开启自动隐藏功能且无需显示分页(若总条数 =< 最小的每页显示条数)时，则不需要显示分页时，隐藏分页\r\n      // 初始化totalNumber undefined\r\n      this.hidePage = this.autoHide &&\r\n                        (Util.isUndefined(this.totalNumber) || Math.min.apply(null, this.itemsPerPage.options) >= this.totalNumber);\r\n      if (this.hidePage) {\r\n        this.render.setStyle(this.hostRef.nativeElement, 'display', 'none');\r\n      } else {\r\n        this.render.setStyle(this.hostRef.nativeElement, 'display', 'inline-block');\r\n      }\r\n\r\n      // 若分页与ti-table配合使用，则当分页更新时，触发ti-table的updatePagination\r\n      // 进而触发表格更新回调\r\n      if (this.isWithTable()) {\r\n        this.table.updatePagination(this.currentPage, this.itemsPerPage.selected);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 对总页数进行数字国际化处理\r\n     */\r\n    public setTotalNumberFormat(): string {\r\n      // 数字国际化格式：整数位保留最小位数.小数位保留最小位数-小数位最大保留位置\r\n      const formatTotalNumber: string = Util.isUndefined(this.totalNumber) ? '0' : TiLocaleFormat.formatNumber(this.totalNumber, '1.0-0');\r\n\r\n      return (TiLocale.getLocaleWords() as TiLocaleWords).tiPagination['totalLabel'] + formatTotalNumber;\r\n    }\r\n\r\n    private getFormatedSize(): any {\r\n      const sizeConfig: TiPageSizeConfig = { ...this.defaultPageSize, ...this.pageSize };\r\n      let index: number = sizeConfig.options.indexOf(sizeConfig.size);\r\n      if (index === -1) {\r\n        index = 0;\r\n        this.syncPageSize(sizeConfig.options[index]);\r\n      }\r\n\r\n      return {\r\n        selected: sizeConfig.options[index], // select选中项\r\n        options: sizeConfig.options, // 每页显示条数选项\r\n        hide: sizeConfig.hide, // 是否显示\r\n        style: {\r\n          width: sizeConfig.width // 宽度设置\r\n        }\r\n      };\r\n    }\r\n\r\n    /**\r\n     * 同步变化开发者的pageSize数据\r\n     */\r\n    private syncPageSize(pageSizeNum: number): void {\r\n      if (this.pageSize instanceof Object) {\r\n        this.pageSize.size = pageSizeNum;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 当前页码是否为最小页码\r\n     */\r\n    public noPrevious(): boolean {\r\n      return this.currentPage === TiPaginationComponent.MIN_PAGE;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 当前页码是否为最大页码\r\n     */\r\n    public noNext(): boolean {\r\n      return this.currentPage === this.totalPageNum;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 当前页码是否为'···' 不可被聚焦\r\n     */\r\n    public isEllipse(page: any): boolean {\r\n      return page.key === '···';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 操作pageSize选择框,每页显示条数改变时触发\r\n     */\r\n    public onSizeChange(pageSizeNum: number): void {\r\n      this.syncPageSize(pageSizeNum);\r\n      this.verifyCurrentPage(pageSizeNum, false);\r\n      const pagination: TiPaginationEvent = {\r\n        currentPage: this.currentPage,\r\n        size: pageSizeNum,\r\n        totalNumber: this.totalNumber\r\n      };\r\n      this.pageNumChange.emit(pagination);\r\n      this.pageUpdate.emit(pagination);\r\n    }\r\n\r\n    // 通过操作选择某一页\r\n    private selectPage(page: any, evt?: Event): void {\r\n      // tiny2中此处阻止a标签浏览器默认事件\r\n      if (!Util.isUndefined(evt)) {\r\n        evt.preventDefault();\r\n      }\r\n\r\n      if (this.disabled) {\r\n        return;\r\n      }\r\n\r\n      const selectedPage: number = parseInt(page, 10);\r\n      if (selectedPage !== this.currentPage) {\r\n        this.currentPage = selectedPage;\r\n        this.currentPageChange.emit(this.currentPage);\r\n        this.pageUpdate.emit({\r\n          currentPage: this.currentPage,\r\n          size: this.itemsPerPage.selected,\r\n          totalNumber: this.totalNumber\r\n        });\r\n      }\r\n    }\r\n\r\n    /**\r\n     * 计算总页数\r\n     */\r\n    private calculateTotalPages(pageSizeNum: number): number {\r\n      const totalPages: number = Math.ceil(this.totalNumber / pageSizeNum);\r\n\r\n      return Math.max(totalPages || 0, 1); // 当totalPages是undefined时，取0\r\n    }\r\n\r\n    /**\r\n     * 组装mini类型时模板需要的数据\r\n     */\r\n    private configMini(): void {\r\n      const options: Array<TiPageItem> = [];\r\n      for (let i: number = 1; i <= this.totalPageNum; i++) {\r\n        options.push({\r\n          id: `${i}`,\r\n          label: `${i}/${this.totalPageNum}`\r\n        });\r\n      }\r\n      this.itemsMini = {\r\n        options,\r\n        selected: options[this.currentPage - 1],\r\n        change: (option: TiPageItem): void => { // 选项改变时，修改选中页\r\n          this.selectPage(option.id);\r\n        }\r\n      };\r\n    }\r\n\r\n    /**\r\n     * @description 根据每页显示条数及数据总条数获取页码列表\r\n     */\r\n    private getPages(): Array<{key: any, active: boolean}> {\r\n      const startAndEndPage: Array<number> = this.getInterval(); // 获得显示的起始和结束页\r\n      const startPagNum: number = startAndEndPage[0];\r\n      const endPagNum: number = startAndEndPage[1];\r\n      const pages: Array<{key: any, active: boolean}> = [];\r\n      const restPageNum: number = this.totalPageNum - this.currentPage; // 剩余页数\r\n\r\n      // 只有1页的情况\r\n      if (this.totalPageNum === 1) {\r\n          pages.push(TiPaginationComponent.makePage(1, true));\r\n\r\n          return pages;\r\n      }\r\n\r\n      // 当总页数大于8，并且中间连续按钮的起始位置没有和第1页相连时，创建第1页按钮和省略号\r\n      if (startPagNum > 2 && this.totalPageNum > 8) {\r\n          pages.push(TiPaginationComponent.makePage(1, this.currentPage === 1));\r\n          pages.push(TiPaginationComponent.makePage('···', false));\r\n      }\r\n\r\n      // 创建中间页按钮\r\n      for (let i: number = startPagNum; i <= endPagNum; i++) {\r\n          pages.push(TiPaginationComponent.makePage(i, this.currentPage === i));\r\n      }\r\n\r\n      // 当总页数大于8，并且中间连续按钮的结束位置没有和最后一页按钮相连时，创建省略号\r\n      // 当总页数大于8，并且最后一页隐藏且不是后四页时，创建省略号\r\n      if (this.totalPageNum > 8 && (this.showLastPage && endPagNum < (this.totalPageNum - 1) ||\r\n                                    !this.showLastPage && restPageNum > 3)) {\r\n          pages.push(TiPaginationComponent.makePage('···', false));\r\n      }\r\n\r\n      // 最后一页隐藏：如果中间连续按钮的结束位置为总页数的前一页且当前页是后四页时，创建最后一页\r\n      // 最后一页不隐藏：如果中间连续按钮的结束位置，不是最后一页按钮时，创建最后一页按钮\r\n      if ((!this.showLastPage && endPagNum === this.totalPageNum - 1 && restPageNum <= 3) ||\r\n           (this.showLastPage && endPagNum < this.totalPageNum)) {\r\n        pages.push(TiPaginationComponent.makePage(this.totalPageNum, this.currentPage === this.totalPageNum));\r\n      }\r\n\r\n      return pages;\r\n    }\r\n\r\n     /**\r\n      * @description 根据当前页码和要显示的数目，计算分页链接的起始页\r\n      */\r\n    private getInterval(): Array<number> {\r\n      let start: number;\r\n      let end: number;\r\n      // 1.根据Agile规范：页数小于等于8，起、始按钮值分别设为1和最大页数：1 - 总数\r\n      if (this.totalPageNum <= 8) {\r\n          start = 1;\r\n          end = this.totalPageNum;\r\n\r\n          return [start, end];\r\n      }\r\n\r\n      // 2.总页数大于8，当前项为前三页：1 - 5 / 1 - 6\r\n      if (this.currentPage <= 3) {\r\n          start = 1;\r\n          end = 5;\r\n          if (!this.showLastPage) {\r\n            end = 6;\r\n          }\r\n\r\n          return [start, end];\r\n      }\r\n\r\n      // 3.总页数大于8，当前项是后4页：总数-4 - 总数\r\n      if (this.currentPage > this.totalPageNum - 3) {\r\n          start = this.totalPageNum - 4;\r\n          end = this.totalPageNum;\r\n\r\n          return [start, end];\r\n      }\r\n\r\n      // 4.总页数大于8，当前项不在前三页，后三页：显示中间4个按钮\r\n      start = this.currentPage - 1;\r\n      end = this.currentPage + 2;\r\n\r\n      // 一般数据量比较大的场景隐藏最后一页时，显示中间5个按钮\r\n      if(!this.showLastPage) {\r\n        end = this.currentPage + 3;\r\n      }\r\n\r\n      return [start, end];\r\n    }\r\n\r\n    /**\r\n     * 设置合法的新页码\r\n     */\r\n    private verifyCurrentPage(pageSizeNum: number, triggerPageUpdate: boolean): void {\r\n      this.totalPageNum = this.calculateTotalPages(pageSizeNum);\r\n      if (this.currentPage > this.totalPageNum || this.currentPage < TiPaginationComponent.MIN_PAGE) {\r\n        this.currentPage = this.currentPage > this.totalPageNum ? this.totalPageNum : TiPaginationComponent.MIN_PAGE;\r\n        if (triggerPageUpdate) {\r\n          this.pageUpdate.emit({\r\n            currentPage: this.currentPage,\r\n            size: pageSizeNum,\r\n            totalNumber: this.totalNumber\r\n          });\r\n          Promise.resolve(undefined)\r\n            .then(() => {\r\n              this.currentPageChange.emit(this.currentPage);\r\n          });\r\n        } else {\r\n          this.currentPageChange.emit(this.currentPage);\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 输入跳转页码enter快捷键处理\r\n     */\r\n    public enterPageHandler(e: KeyboardEvent): void {\r\n      this.gotoPageHandler(e);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 根据要跳转的页码，同步修改当前页码\r\n     */\r\n    public gotoPageHandler(event: KeyboardEvent): void {\r\n      // 当输入值为不合法时处理\r\n      if (this.gotoPage.page < TiPaginationComponent.MIN_PAGE || this.gotoPage.page > this.totalPageNum) {\r\n        this.gotoPage.page = this.currentPage;\r\n\r\n        return;\r\n      }\r\n\r\n      if (this.gotoPage.page !== this.currentPage) {\r\n        this.currentPage = this.gotoPage.page;\r\n        this.currentPageChange.emit(this.currentPage);\r\n        this.pageUpdate.emit({\r\n          currentPage: this.currentPage,\r\n          size: this.itemsPerPage.selected,\r\n          totalNumber: this.totalNumber\r\n        });\r\n      }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 上一页按钮的点击事件\r\n     */\r\n    public onPrevClick(event: Event): any {\r\n      return !this.noPrevious() && this.selectPage(this.currentPage - 1, event);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 页码点击事件\r\n     */\r\n    public onPageClick(page: any, event: Event): any {\r\n      return !this.isEllipse(page) && this.selectPage(page.key, event);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 下一页按钮的点击事件\r\n     */\r\n    public onNextClick(event: Event): any {\r\n      return !this.noNext() && this.selectPage(this.currentPage + 1, event);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * input输入框modelchange事件\r\n     */\r\n    public ngModelChange(value: any): void {\r\n      if (value === '') {\r\n        this.gotoPage.page = '';\r\n\r\n        return;\r\n      }\r\n\r\n      const newPage: number = parseInt(value, 10);\r\n      if (isNaN(newPage)) {\r\n        this.render.setProperty(this.inputRef.nativeElement, 'value', this.gotoPage.page);\r\n\r\n        return;\r\n      }\r\n\r\n      this.gotoPage.page = newPage;\r\n      this.render.setProperty(this.inputRef.nativeElement, 'value', this.gotoPage.page);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public trackByFn(index: number, item: any): number {\r\n      return item.key;\r\n    }\r\n\r\n    private isWithTable(): boolean {\r\n      return this.table && this.render.parentNode(this.nativeElement).tagName === 'TI-TABLE';\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiPaginationComponent } from './TiPaginationComponent';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiSelectModule } from '../select/TiSelectModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiIconModule,\r\n    TiSelectModule,\r\n    TiTextModule,\r\n    TiLocaleModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiPaginationComponent],\r\n  declarations: [TiPaginationComponent]\r\n})\r\n\r\nexport class TiPaginationModule {\r\n}\r\n\r\nexport * from './TiPaginationComponent';\r\nexport { TiPaginationComponent, TiPageSizeConfig, TiPaginationEvent } from './TiPaginationComponent';\r\n","import { Component, Input, SimpleChanges } from '@angular/core';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * 进度条组件\r\n *\r\n * <example-url>../tiny3demo/#/progressbar/progressbar-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-progressbar',\r\n    templateUrl: './progressbar.html',\r\n    styleUrls: ['./progressbar.less'],\r\n    host: {\r\n        '[class.ti3-progress]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiProgressbarComponent extends TiBaseComponent {\r\n    /**\r\n     *  设置当前值，当前值/最大值即为进度值\r\n     */\r\n    @Input() value: number = 0;\r\n    /**\r\n     *  设置最大值，当前值/最大值即为进度值\r\n     */\r\n    @Input() max: number = 100;\r\n    /**\r\n     *  设置进度条在不同当前值下对应的样式，包括动画效果\r\n     */\r\n    @Input() progressClass: string = '';\r\n    /**\r\n     *  设置进度条是否开启动画效果\r\n     */\r\n    @Input() animation: boolean = true;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public percent: number; // 当前进度值\r\n    // 设置合法的数值\r\n    private static verifyNum(newVal: any, defaultValue: any): number {\r\n        return isNaN(parseFloat(newVal)) ? defaultValue : newVal;\r\n    }\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.max = TiProgressbarComponent.verifyNum(this.max, this.max);\r\n        this.value = TiProgressbarComponent.verifyNum(this.value, this.value);\r\n        this.calcPercentage();\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        // 当前值更新，重新计算进度\r\n        this.setChanges(changes, 'value');\r\n        // 当最大值更新，重新计算进度\r\n        this.setChanges(changes, 'max');\r\n    }\r\n\r\n    /**\r\n     * @description 处理用户输入的改变\r\n     * @param: changes 改变的对象\r\n     * @param: changeKey 那个属性改变\r\n     */\r\n    private setChanges(changes: SimpleChanges, changeKey: string): void {\r\n        if (changes[changeKey] && !changes[changeKey].isFirstChange()) {\r\n            const oldVal: any = changes[changeKey].previousValue;\r\n            const newVal: any = changes[changeKey].currentValue;\r\n            const _newValue: number = TiProgressbarComponent.verifyNum(newVal, oldVal);\r\n            this[changeKey] = _newValue;\r\n            this.calcPercentage();\r\n        }\r\n    }\r\n\r\n    // 计算当前进度百分比\r\n    private calcPercentage(): void {\r\n        // 如果开发者设置数据不合理，则进度置0\r\n        if (this.max === 0) {\r\n            this.percent = 0;\r\n\r\n            return;\r\n        }\r\n        this.percent = Number((this.value * 100 / this.max).toFixed(2));\r\n        if (this.percent > 100) {\r\n            this.percent = 100;\r\n        }\r\n        if (this.percent < 0) {\r\n            this.percent = 0;\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiProgressbarComponent } from './TiProgressbarComponent';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule\r\n    ],\r\n    exports: [TiProgressbarComponent],\r\n    declarations: [TiProgressbarComponent]\r\n})\r\n\r\nexport class TiProgressbarModule {\r\n}\r\nexport { TiProgressbarComponent } from './TiProgressbarComponent';\r\n","import { AfterViewInit, Component, ElementRef, Input, OnChanges, SimpleChanges, ViewChild } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-progresspie',\r\n    template: '<canvas #canvas></canvas>'\r\n})\r\n\r\nexport class TiProgresspieComponent implements OnChanges, AfterViewInit {\r\n    private defaultConfig: any = {\r\n        value: 0,\r\n        maxValue: 100,\r\n        color: '#3dcca6',\r\n        lineWidth: 2\r\n    };\r\n    @Input() value: number = this.defaultConfig.value;\r\n    @Input() maxValue: number = this.defaultConfig.maxValue;\r\n    private percent: number; // 计算后的百分比\r\n    @ViewChild('canvas', { static: true }) private canvasEle: ElementRef; // canvas元素对应的ElementRef\r\n    private canvasElement: any; // canvas元素对应的nativeElement\r\n    nativeElement: Element; // 元素本身\r\n    constructor(private hostEle: ElementRef) {\r\n        this.nativeElement = this.hostEle.nativeElement;\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // value和maxValue的动态修改均需要重绘进度呈现\r\n        if ((changes.value && !changes.value.isFirstChange()) ||\r\n            (changes.maxValue && !changes.maxValue.isFirstChange())) {\r\n            this.draw();\r\n        }\r\n    }\r\n    ngAfterViewInit(): void { // 初始化走一次圆饼的绘制，在此处处理是因为canvas对象此处是通过ref方式获取canvas的最早时机\r\n        this.canvasElement = this.canvasEle.nativeElement;\r\n        // 修复SSR错误：ERROR ReferenceError: getComputedStyle is not defined\r\n        if(typeof getComputedStyle === 'undefined'){\r\n            return;\r\n        }\r\n        this.canvasElement.width = parseFloat(getComputedStyle(this.nativeElement).width);\r\n        this.canvasElement.height = parseFloat(getComputedStyle(this.nativeElement).height);\r\n        this.draw();\r\n    }\r\n    private draw(): void {\r\n        this.calcPercent();\r\n        this.drawProgressPie();\r\n    }\r\n    // 计算百分比，外部需要保证maxVlue和value均为数字类型\r\n    private calcPercent(): void {\r\n        // 计算percent值\r\n        if (this.maxValue === 0) {\r\n            this.percent = 0;\r\n\r\n            return;\r\n        }\r\n\r\n        let percent: number = this.value / this.maxValue;\r\n        if (isNaN(percent)) {\r\n            this.percent = 0;\r\n\r\n            return;\r\n        }\r\n\r\n        if (percent > 1) {\r\n            percent = 1;\r\n        }\r\n\r\n        if (percent < 0) {\r\n            percent = 0;\r\n        }\r\n        this.percent = percent;\r\n    }\r\n\r\n    private drawProgressPie(): void {\r\n        const canvas: any = this.canvasElement;\r\n        const ctx: any = canvas.getContext('2d');\r\n\r\n        // 清除先前画布内容\r\n        const width: number = canvas.width;\r\n        const height: number = canvas.height;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        // 圆半径及起始点计算\r\n        const d: number = Math.min(width, height);\r\n        const cx: number = width / 2;\r\n        const cy: number = height / 2;\r\n        const lineWidth: number = this.defaultConfig.lineWidth;\r\n        const r: number = d / 2 - lineWidth;\r\n        const startPoint: number = -Math.PI / 2;\r\n        // 笔触样式设置\r\n        const color: string = this.defaultConfig.color;\r\n        ctx.fillStyle = color;\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = lineWidth;\r\n        // 画外圆\r\n        ctx.beginPath();\r\n        ctx.arc(cx, cy, r, startPoint, startPoint + Math.PI * 2);\r\n        ctx.stroke();\r\n\r\n        // 画扇形\r\n        const endPoint: number = startPoint + Math.PI * this.percent * 2;\r\n        ctx.beginPath();\r\n        ctx.moveTo(cx, cy); // 移动至圆心\r\n        ctx.arc(cx, cy, r, startPoint, endPoint); // 从外边上的点画曲线\r\n        ctx.lineTo(cx, cy); // 从圆心画直线到计算好的圆外上的点\r\n        ctx.fill();\r\n        if (this.percent === 0) { // 为0的情况下，绘制圆心值边缘竖线\r\n            ctx.stroke();\r\n        }\r\n        ctx.closePath();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TiProgresspieComponent } from './TiProgresspieComponent';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n    exports: [TiProgresspieComponent],\r\n    declarations: [TiProgresspieComponent]\r\n})\r\n\r\nexport class TiProgresspieModule {\r\n}\r\nexport { TiProgresspieComponent } from './TiProgresspieComponent';\r\n","import { Component, ViewEncapsulation } from '@angular/core';\r\nimport { TiRadioBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * radio单选框组件\r\n *\r\n * radio组件完全基于原生input实现，但是需要在input中添加TinyUI提供的tiRadio属性\r\n *\r\n * <example-url>../tiny3demo/#/radio/radio-all</example-url>\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiRadio]', // 指定组件名称\r\n    templateUrl: './radio.html', // 指定组件模板\r\n    styleUrls: ['./radio.less'], // 样式路径\r\n    encapsulation: ViewEncapsulation.None // 设置组件的试图包装选项：三个值Emulated(默认值)，Native，None\r\n})\r\nexport class TiRadioComponent extends TiRadioBaseComponent {\r\n    /**\r\n     *  @ignore\r\n     */\r\n    protected canChange(): boolean {\r\n        return !this.nativeElement.checked;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiRadioComponent } from './TiRadioComponent';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiRadioComponent],\r\n  declarations: [TiRadioComponent]\r\n})\r\nexport class TiRadioModule {\r\n}\r\nexport { TiRadioComponent } from './TiRadioComponent';\r\n","import { Directive, ElementRef, Renderer2 } from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\n/**\r\n * tiScrollָ�����ڴ���document�ϵ�tiScroll�¼���\r\n *\r\n * 10.0.2����\r\n */\r\n@Directive({\r\n    selector: '[tiScroll]'\r\n})\r\n\r\nexport class TiScrollDirective {\r\n    private hostEle: Element;\r\n    constructor(private hostEleRef: ElementRef, private renderer2: Renderer2) {\r\n        this.hostEle = this.hostEleRef.nativeElement;\r\n        this.renderer2.listen(this.hostEle, 'scroll', () => {\r\n            Util.trigger(document, 'tiScroll');\r\n        });\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { TiScrollDirective } from './TiScrollDirective';\r\n\r\n@NgModule({\r\n    imports: [],\r\n    exports: [TiScrollDirective],\r\n    declarations: [TiScrollDirective]\r\n})\r\n\r\nexport class TiScrollModule {\r\n}\r\n\r\nexport { TiScrollDirective } from './TiScrollDirective';\r\n","import {\r\n    ChangeDetectorRef,\r\n    Component,\r\n    ContentChild,\r\n    ElementRef,\r\n    EventEmitter,\r\n    HostListener,\r\n    Input,\r\n    IterableChanges,\r\n    IterableDiffer,\r\n    IterableDiffers,\r\n    Output,\r\n    Renderer2,\r\n    SecurityContext,\r\n    SimpleChanges,\r\n    TemplateRef,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport interface TiDragConfig {\r\n    helper: any;\r\n    position: {\r\n        left: number,\r\n        top: number\r\n    };\r\n}\r\n\r\n/**\r\n * Slider滑块组件\r\n *\r\n * 滑块组件，通过操作组件选择指示范围\r\n *\r\n * <example-url>../tiny3demo/#/slider/slider-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-slider',\r\n    templateUrl: './slider.html',\r\n    styleUrls: ['./slider.less'],\r\n    host: {\r\n        '[class.ti3-slider-container]': 'true',\r\n        '[class.ti3-slider-disable]': 'disabled',\r\n        '(mousedown)': 'hostMousedownEvent($event)'\r\n    },\r\n    providers: [TiFormComponent.getValueAccessor(TiSliderComponent)]\r\n})\r\n\r\nexport class TiSliderComponent extends TiFormComponent {\r\n    /**\r\n     * 最小范围值\r\n     */\r\n    @Input() min: number = 0;\r\n    /**\r\n     * 最大范围值\r\n     */\r\n    @Input() max: number = 10;\r\n\r\n    /**\r\n     * 滑动步长，滑块每次跳变的步长（若要实现只在刻度上跳变的效果，step需严格和刻度间距一致）\r\n     */\r\n    @Input() step: number = 1;\r\n    /**\r\n     * 设置刻度\r\n     * 1.不同类型的使用：\r\n     *\r\n     * 1.1 Array情况下：数组中各元素依次对应各刻度显示值；\r\n     *\r\n     * 1.2 Function情况下：返回值为刻度显示值，根据返回值设置各step对应的刻度显示值，\r\n     * 函数的参数依次为：value(step对应的值),max(最大值),min(最小值)。\r\n     *\r\n     * 2.不同形式的刻度显示值对应各自的显示方式：\r\n     *\r\n     * 2.1 空字符串 --- 只打点不显示label；\r\n     *\r\n     * 2.2 undefined/null ---不打点不显示label；\r\n     *\r\n     * 2.3 其它情况 --- 打点且显示值为配置值。\r\n     */\r\n    @Input() scales: Array<any> | Function;\r\n    /**\r\n     * 设置滑块的tip显示方式：取值\"always\"，\"auto\"（默认值）\r\n     *\r\n     * always：tip一直显示\r\n     *\r\n     * auto：鼠标移到滑块上出tip\r\n     */\r\n    @Input() tipMode: 'auto' | 'always' = 'auto';\r\n    /**\r\n     * tip提示内容格式函数：返回值是string类型，为tip中显示的文本。\r\n     *\r\n     * 返回值在 v10.1.3 及之前的版本存在XSS攻击(html类型)风险, v10.1.4 版本做了安全处理，已不存在XSS攻击风险。\r\n     */\r\n    @Input() tipFormatterFn: (value: any) => string;\r\n    /**\r\n     * 跟scales接口搭配使用，依次设置scales中两个相邻刻度每之间长度占总长的比例，\r\n     * 数组所有项总和为1，数组长度比scales长度小1。\r\n     */\r\n    @Input() ratios: Array<number>;\r\n    /**\r\n     * 滑块停止后值发生改变时触发的事件\r\n     *\r\n     * 3.1.0新增\r\n     */\r\n    @Output() readonly changeStop: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * @ignore\r\n     * 获取到用户自定义的刻度\r\n     */\r\n    @ContentChild(TemplateRef, { static: true }) public labelTemplate: TemplateRef<any>;\r\n    /**\r\n     * @ignore\r\n     * 存放用户传入的刻度值\r\n     */\r\n    public ticks: Array<any>;\r\n    /**\r\n     * @ignore\r\n     * 对于双滑块，左滑块是否处于变化状态\r\n     */\r\n    public isMinPointerActive: boolean;\r\n    /**\r\n     * @ignore\r\n     * 拖动配置参数\r\n     */\r\n    public dragOptions: any;\r\n    private ticksArr: Array<any>; // 存放合法的刻度值\r\n    private isDouble: boolean = false; // 判断是否是双滑块，默认是单滑块 false\r\n    private isTipAutoShow: boolean = true; // 判断tip提示是否是自动显示（鼠标操作才显示）,默认true\r\n    private decimalDigit: number; // ratios中最大的小数位数\r\n    private scalesDiffer: IterableDiffer<any>; // scales 变化检查\r\n    private dragStartModel: any;\r\n    private pointerMaxEleWidth: number; // 滑块的宽度\r\n\r\n    // 获取模板上DOM变量\r\n    @ViewChild('trackEle', { static: true }) private trackRef: ElementRef;\r\n    @ViewChild('selection', { static: true }) private selectionRef: ElementRef;\r\n    @ViewChild('pointerMin', { static: true }) private pointerMinRef: ElementRef;\r\n    @ViewChild('pointerMax', { static: true }) private pointerMaxRef: ElementRef;\r\n    @ViewChild('tipMin', { static: true }) private tipMinRef: ElementRef;\r\n    @ViewChild('tipMax', { static: true }) private tipMaxRef: ElementRef;\r\n    // 定义DOM变量\r\n    private trackELe: any;\r\n    private selectionEle: any;\r\n    private pointerMinEle: any;\r\n    private pointerMaxEle: any;\r\n    private tipMinEle: any;\r\n    private tipMaxEle: any;\r\n    private isVisibleInit: boolean; // 标识初始化时组件是否可见\r\n\r\n    /**\r\n     * @description: 将value值处理成数组\r\n     * @param: value 需要切割的数组\r\n     */\r\n    private static splitValueToArray(value: string): { valueMin: number, valueMax: number } {\r\n        const arr: Array<string> = (`${value}`).split(';'); // value为number时强转为字符串\r\n\r\n        return {\r\n            valueMin: parseFloat(arr[0]),\r\n            valueMax: arr[1] && parseFloat(arr[1])\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description: value值是否超限制\r\n     * @param: value: 判断的value值\r\n     * @param: minValue: 最大值\r\n     * @param: maxValue: 最小值\r\n     */\r\n    private static isLimitExceed(value: number, minValue: number, maxValue: number): boolean {\r\n        return value < minValue || value > maxValue;\r\n    }\r\n\r\n    /**\r\n     * @description: 当this.scales为函数情况下，转换为ticks数组\r\n     * @param: scaleFormat 被转换的函数\r\n     * @param: minValue 刻度限制的最大值\r\n     * @param: maxValue 刻度限制的最小值\r\n     * @param: step 刻度步长\r\n     */\r\n    private static translateScales(scaleFormat: Function, minValue: number, maxValue: number, step: number): Array<any> {\r\n        const valueLen: number = (maxValue - minValue) / step;\r\n        const tickArray: Array<any> = [];\r\n        for (let i: number = 0; i <= valueLen; i++) {\r\n            const stepNValue: number = step * i + minValue;\r\n            const formatRet: any = scaleFormat(stepNValue, minValue, maxValue);\r\n            if (Util.isUndefined(formatRet) || Util.isNull(formatRet)) {\r\n                // 为undefined或null情况下，不打点不显示label\r\n                /* tslint:disable:no-null-keyword */\r\n                tickArray.push(null);\r\n            } else {\r\n                // 包含为\"\"（打点不显示label）和非\"\"情况（打点且显示label）\r\n                tickArray.push(formatRet);\r\n            }\r\n        }\r\n\r\n        return tickArray;\r\n    }\r\n\r\n    /**\r\n     * @description: 在范围内限制value数值\r\n     * @param: value 校验的value值\r\n     * @param: min 最小值\r\n     * @param: max 最大值\r\n     * @return: 有效value值\r\n     */\r\n    private static limitValue(value: number, min: number, max: number): number {\r\n        // fossid整改，采用一种不撞车写法，可读性差一点。\r\n        // 小于min取min，大于max取max，其他不变。\r\n        const res: number = value < min ? min :\r\n            value > max ? max : value;\r\n\r\n        return res;\r\n    }\r\n\r\n    /**\r\n     * @description: 将样式数值转化为calc形式的css样式（设置为百分比形式，确保缩放的支持）\r\n     * @param: percent calc百分比\r\n     * @param: subValue calc减去值\r\n     */\r\n    private static parseToCalcStyle(percent: number, subValue?: number): string {\r\n        if (Number.isNaN(subValue) || Util.isUndefined(subValue)) {\r\n            return `calc(${percent * 100}%)`;\r\n        }\r\n\r\n        return `calc(${percent * 100}% - ${subValue}px)`; // calc中运算符合2边一定要空格\r\n    }\r\n\r\n    constructor(\r\n        private tiRenderer: TiRenderer,\r\n        private iterableDiffers: IterableDiffers,\r\n        protected hostRef: ElementRef,\r\n        protected renderer2: Renderer2,\r\n        private changeDetectorRef: ChangeDetectorRef,\r\n        private domSanitizer: DomSanitizer\r\n    ) {\r\n        super(hostRef, renderer2);\r\n    }\r\n\r\n    @HostListener('window:resize') onResize(): void {\r\n        this.updateValuePosition(this.model);\r\n    }\r\n\r\n    // 组件声明周期钩子--start\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.initDom();\r\n        this.initVars();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public initDom(): void {\r\n        this.trackELe = this.trackRef.nativeElement;\r\n        this.selectionEle = this.selectionRef.nativeElement;\r\n        this.pointerMinEle = this.pointerMinRef.nativeElement;\r\n        this.pointerMaxEle = this.pointerMaxRef.nativeElement;\r\n        this.tipMinEle = this.tipMinRef.nativeElement;\r\n        this.tipMaxEle = this.tipMaxRef.nativeElement;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public initVars(): void {\r\n        this.step = Number.isNaN(parseFloat(`${this.step}`)) ? 1 : parseFloat(`${this.step}`);\r\n        this.setMinMax();\r\n        // ratios中最大的小数位数\r\n        this.decimalDigit = this.getDecimalDigit();\r\n\r\n        // 处理用戶未设置scales或者scales為function情況\r\n        if (!this.scales || !Array.isArray(this.scales)) {\r\n            this.setScales();\r\n        }\r\n\r\n        this.setTipConfig();\r\n        // 给tip添加事件（tipMode是 'auto'的场景）\r\n        this.addTipEvent();\r\n\r\n        this.dragOptions = {\r\n            axis: 'x',\r\n            start: this.dragStartHandle,\r\n            drag: this.dragHandle,\r\n            stop: this.dragStopHandle\r\n        };\r\n    }\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes['scales'] && !changes['scales'].firstChange && !Array.isArray(this.scales)) {\r\n            this.setScales();\r\n            this.updateValuePosition(this.model);\r\n        }\r\n\r\n        // 监听最大值最小值变化\r\n        if ((changes['min'] && !changes['min'].firstChange) || (changes['max'] && !changes['max'].firstChange)) {\r\n            this.setMinMax();\r\n        }\r\n    }\r\n    ngAfterViewInit(): void {\r\n        this.pointerMaxEleWidth = this.pointerMaxEle.offsetWidth;\r\n        this.isVisibleInit = this.pointerMaxEleWidth !== 0;\r\n        this.changeDetectorRef.detectChanges();\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        // 监听滑块的宽度：处理组件从隐藏到显示定位问题\r\n        if (!this.isVisibleInit) {\r\n            const pointerMaxWidth: number = this.pointerMaxEle.offsetWidth;\r\n            if (pointerMaxWidth !== 0) {\r\n                this.isVisibleInit = true;\r\n                this.pointerMaxEleWidth = pointerMaxWidth;\r\n                this.updateValuePosition(this.model);\r\n                this.changeDetectorRef.detectChanges();\r\n            }\r\n        }\r\n    }\r\n    ngDoCheck(): void {\r\n        if (!Array.isArray(this.scales)) {\r\n            return;\r\n        }\r\n        if (!this.scalesDiffer) {\r\n            this.scalesDiffer = this.iterableDiffers.find(this.scales)\r\n                                .create();\r\n        }\r\n\r\n        const scalesDiffer: IterableChanges<any> = this.scalesDiffer.diff(this.scales);\r\n        if (scalesDiffer) {\r\n            this.setScales();\r\n            // 初始化的updateValuePosition在writeValue中执行（writeValue迟于docheck执行）\r\n            if (!Util.isUndefined(this.model)) {\r\n                this.updateValuePosition(this.model);\r\n            }\r\n        }\r\n    }\r\n    // 组件声明周期钩子--end\r\n\r\n    // 实现ControlValueAccessor接口\r\n    /**\r\n     * @ignore\r\n     */\r\n    writeValue(value: any): void {\r\n        // TODO: 接口设计重新调整\r\n        // ngModel => value: string | number; // 滑块对应的value值 exp： 单滑块: 15 OR '15' 双滑块 '15;34';\r\n        super.writeValue(value);\r\n        if (!Util.isNull(value) && !Util.isUndefined(value)) {\r\n            // 1.判断是否是双滑块\r\n            this.isDouble = !Util.isUndefined(TiSliderComponent.splitValueToArray(value).valueMax); // 根据value形式确定单滑块/双滑块\r\n            if (Util.isUndefined(this.onModelChange)) {\r\n                // 在reactive-form中使用，初始化赋值调用writeValue时，\r\n                // 此时registerOnChange还未被调用，onChangeFn还未被赋值，\r\n                // 所以要使用promise(异步)等onChangeFn被赋值后再调用\r\n                Promise.resolve(undefined)\r\n                .then(() => {\r\n                    this.writeValueHandle(value);\r\n                });\r\n            } else {\r\n                this.writeValueHandle(value);\r\n            }\r\n        }\r\n    }\r\n    private writeValueHandle(value: any): void {\r\n        if (this.isDouble) {\r\n            this.show(this.pointerMinEle);\r\n        } else {\r\n            this.hide(this.pointerMinEle);\r\n        }\r\n        // 赋值操作 && 更新位置\r\n        this.updateValuePosition(value);\r\n    }\r\n    // 实现ControlValueAccessor接口--end\r\n\r\n    // 组件交互方法集合--start\r\n    /**\r\n     * @ignore\r\n     * Tiny3中不存在下面的问题，用click和mousedown事件都可以（统一使用mousedown事件）\r\n     * 使用mousedown替代click，用于防止拖拽过程中触发click事件导致的滑块滑动\r\n     * 问题场景：min滑块拖动与max滑块重合后，鼠标继续向右移动，此时鼠标抬起，触发click事件，导致max发生移动\r\n     */\r\n    public hostMousedownEvent = (event: MouseEvent): void => {\r\n        // 灰化状态或点击pointer时不做处理\r\n        if (this.disabled || this.tiRenderer.hasClass(event.target, 'ti3-slider-pointer')\r\n            || this.tiRenderer.hasClass(event.target, 'ti3-slider-tip')) {\r\n            return;\r\n        }\r\n        this.stepSliderFromClick(event);\r\n    }\r\n\r\n    /**\r\n     * @description: 添加tip的事件监听\r\n     */\r\n    private addTipEvent(): void {\r\n        if (this.isTipAutoShow) {\r\n            this.renderer2.listen(this.pointerMaxEle, 'mouseover', this.tipMouseoverHandle);\r\n            this.renderer2.listen(this.pointerMinEle, 'mouseover', this.tipMouseoverHandle);\r\n            this.renderer2.listen(this.pointerMaxEle, 'mouseleave', this.tipMouseleaveHandle);\r\n            this.renderer2.listen(this.pointerMinEle, 'mouseleave', this.tipMouseleaveHandle);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 滑块元素的mouseover事件处理函数\r\n     */\r\n    private tipMouseoverHandle = (event: any): void => {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        this.show(event.target.querySelector('.ti3-slider-tip'));\r\n    }\r\n\r\n    /**\r\n     * @description: 滑块元素的mouseleave事件处理函数\r\n     */\r\n    private tipMouseleaveHandle = (event: any): void => {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        this.hide(event.target.querySelector('.ti3-slider-tip'));\r\n    }\r\n\r\n    /**\r\n     * @description: 宿主元素的mousedown事件处理函数\r\n     */\r\n    private stepSliderFromClick = (event: MouseEvent): void => {\r\n        const firstTickX: number = this.trackELe.getBoundingClientRect().left + this.pointerMaxEleWidth / 2;\r\n        const oldModel: any = this.model;\r\n        let pointerX: number = event.clientX - firstTickX;\r\n        pointerX = TiSliderComponent.limitValue(pointerX, 0, this.getBarWidth());\r\n        let value: number = this.positionToValue(pointerX); // 获取value绝对比例值，用于确定滑块移动位置\r\n        // 确定滑动哪个滑块\r\n        let pointer: any = this.pointerMaxEle;\r\n        if (this.isDouble) {\r\n            const valueMin: number = TiSliderComponent.splitValueToArray(this.model).valueMin;\r\n            const valueMax: number = TiSliderComponent.splitValueToArray(this.model).valueMax;\r\n            // 以value中间值为界，在最小值及中间值之间=》左滑块移动；否则=》右滑块移动\r\n            const midValue: number = (valueMax + valueMin) / 2;\r\n            if ((value >= this.min) && (value < midValue)) {\r\n                pointer = this.pointerMinEle;\r\n                this.isMinPointerActive = true;\r\n            } else {\r\n                this.isMinPointerActive = false;\r\n            }\r\n        }\r\n        value = this.getStepValue(value);\r\n        this.setValue(value); // 向外部通知value值\r\n        this.valueToPosition(value, pointer); // 跳至value对应的坐标位置（与step对应）\r\n        if (this.model !== oldModel) {\r\n            this.changeStop.emit(this.model);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description 拖拽开始执行的事件\r\n     * @param: ui 拖拽助手 {helper：表示被拖拽的助手（helper）, position: 助手（helper）的当前 CSS 位置}\r\n     */\r\n    private dragStartHandle = (ui: TiDragConfig): void => {\r\n        this.dragStartModel = this.model;\r\n        if (this.isDouble) {\r\n            this.isMinPointerActive = !this.tiRenderer.hasClass(ui.helper, 'ti3-slider-pointer-max');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description 根据拖拽位置更新value值并改变位置呈现\r\n     * @param: ui 拖拽助手 {helper：表示被拖拽的助手（helper）, position: 助手（helper）的当前 CSS 位置}\r\n     */\r\n    private dragHandle = (ui: TiDragConfig): void => {\r\n        // 设置value值\r\n        const value: number = this.dragCommonHandle(ui);\r\n        this.setValue(value); // 向外部通知value值\r\n        // 设置tip提示\r\n        if (this.isTipAutoShow) { // 拖拽过程中显示tip提示\r\n            this.show(ui.helper.querySelector('.ti3-slider-tip'));\r\n        }\r\n        this.setTip(ui.helper.querySelector('.ti3-slider-tip'), value); // 设置tip提示值及位置\r\n    }\r\n\r\n    /**\r\n     * @description: 鼠标弹起之后：根据拖拽位置跳至step对应的值并设置slider\r\n     * @param: ui 拖拽助手 {helper：表示被拖拽的助手（helper）, position: 助手（helper）的当前 CSS 位置}\r\n     */\r\n    private dragStopHandle = (ui: TiDragConfig): void => {\r\n        // 设置value值\r\n        const value: number = this.dragCommonHandle(ui);\r\n\r\n        if (this.isTipAutoShow) { // 拖拽停止隐藏tip提示\r\n            this.hide(ui.helper.querySelector('.ti3-slider-tip'));\r\n        }\r\n        this.valueToPosition(value, ui.helper); // 跳至value对应的坐标位置\r\n        if (this.model !== this.dragStartModel) {\r\n            this.changeStop.emit(this.model);\r\n        }\r\n    }\r\n\r\n    // 组件交互方法集合--end\r\n\r\n    // 内部公共方法集合--start\r\n    /**\r\n     * @description: 拖拽公共处理\r\n     * @param: ui 拖拽助手 {helper：表示被拖拽的助手（helper）, position: 助手（helper）的当前 CSS 位置}\r\n     */\r\n    private dragCommonHandle(ui: TiDragConfig): number {\r\n        const pointerX: number = this.limitDragPosition(ui); // 限制指针在合理的位置范围内\r\n        const value: number = this.positionToStepValue(pointerX); // 获取当前位置对应的value值\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * @description: 限制滑块移动位置并设置对应的选择区域宽度\r\n     * @param: pointerX 鼠标点击位置（x方向）\r\n     */\r\n    private limitDragPosition(ui: TiDragConfig): number {\r\n        let pointerX: number = ui.position.left; // 当前滑块中心距离tick第一个坐标位置\r\n        const barWidth: number = this.getBarWidth();\r\n        let pointerWidthHalf: number = this.pointerMaxEleWidth / 2;\r\n        let pointerMinLeft: number;\r\n        let pointerMaxLeft: number;\r\n        if (this.isDouble) {\r\n            if (!this.isMinPointerActive) { // max对应滑块情况的处理\r\n                pointerMinLeft = parseFloat(getComputedStyle(this.pointerMinEle).left);\r\n                pointerX = TiSliderComponent.limitValue(pointerX, pointerMinLeft, barWidth); // 限制滑块在最小和右边界之间\r\n                pointerMaxLeft = pointerX;\r\n            } else {\r\n                pointerMaxLeft = parseFloat(getComputedStyle(this.pointerMaxEle).left);\r\n                pointerX = TiSliderComponent.limitValue(pointerX, 0, pointerMaxLeft); // 限制滑块在左边界和最大之间\r\n                pointerMinLeft = pointerX;\r\n            }\r\n            const styles: {width: string; left: string} = {\r\n                width: `${pointerMaxLeft - pointerMinLeft}px`,\r\n                left: `${pointerMinLeft + pointerWidthHalf}px`\r\n            };\r\n            this.tiRenderer.setStyles(this.selectionEle, styles);\r\n        } else {\r\n            pointerX = TiSliderComponent.limitValue(pointerX, 0, barWidth);\r\n            this.renderer2.setStyle(this.selectionEle, 'width', `${pointerX + pointerWidthHalf}px`);\r\n        }\r\n\r\n        ui.position.left = pointerX; // 限制滑块的位置显示\r\n\r\n        return pointerX;\r\n    }\r\n\r\n    /**\r\n     * @description: 根据滑块位置获取value值(和step对应) (拖拽公共函数中用)\r\n     * @param: pointerX 鼠标点击位置（x方向）\r\n     */\r\n    private positionToStepValue(pointerX: number): number {\r\n        const value: number = this.positionToValue(pointerX); // 获取指针对应的value绝对比例值(和step无关)\r\n\r\n        return this.getStepValue(value); // 转化value为与step对应的值;\r\n    }\r\n\r\n    /**\r\n     * @description: 获取位置对应的value值\r\n     * @param: pointerX 鼠标点击位置（x方向）\r\n     */\r\n    private positionToValue(pointerX: number): number {\r\n        const barWidth: number = this.getBarWidth();\r\n        const percent: number = pointerX / barWidth;\r\n        if (!Util.isUndefined(this.ratios)) {\r\n            return this.unequalPositionToValue(pointerX, barWidth, percent);\r\n        }\r\n\r\n        return this.min + percent * (this.max - this.min);\r\n    }\r\n\r\n    /**\r\n     * @description: 设置组件的model值，用于向外通知\r\n     * @param: value 当前指针的值\r\n     */\r\n    private setValue(value: number): void {\r\n        if (this.isDouble) {\r\n            const valueMin: number = TiSliderComponent.splitValueToArray(this.model).valueMin;\r\n            const valueMax: number = TiSliderComponent.splitValueToArray(this.model).valueMax;\r\n            if (!this.isMinPointerActive && value !== valueMax) {\r\n                this.model = `${valueMin};${value}`;\r\n            } else if (this.isMinPointerActive && value !== valueMin) {\r\n                this.model = `${value};${valueMax}`;\r\n            }\r\n        } else {\r\n            if (value !== this.model) {\r\n                this.model = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 获取对应的step值(根据step修正value值)\r\n     * @param: value 当前点击的绝对值\r\n     */\r\n    private getStepValue(value: number): number {\r\n        const min: number = this.min;\r\n        const step: number = this.step;\r\n        let stepValue: number;\r\n        const stepN: number = Math.round((value - min) / step); // value值变化几个步长\r\n        if (step.toString()\r\n                .indexOf('.') !== -1) {\r\n            const n: number = step.toString()\r\n                          .split('.').length;\r\n            stepValue = parseFloat((min + stepN * step).toFixed(n));\r\n        } else {\r\n            stepValue = min + stepN * step;\r\n        }\r\n\r\n        return TiSliderComponent.limitValue(stepValue, min, this.max);\r\n    }\r\n\r\n    /**\r\n     * @description: 在不等分条件下获取位置对应的value值\r\n     * @param: pointerX 鼠标点击位置（x方向）\r\n     * @param: barWidth 指针宽度\r\n     * @param: percent pointerX占滑动轴百分比\r\n     */\r\n    private unequalPositionToValue(pointerX: number, barWidth: number, percent: number): number {\r\n        let limitWidth: number = 0; // 每一段的宽度\r\n        let selectLength: number = 0; // 已被选中区域段的宽度\r\n        let ratiosWidth: number = 0; // 已被选中区域段长度和占总长的比例\r\n        const c: number = this.decimalDigit;\r\n        const ticksLen: number = this.ticksArr.length;\r\n        for (let i: number = 0; i < ticksLen - 1; i++) {\r\n            limitWidth = barWidth * this.ratios[i];\r\n            if (i === 0) {\r\n                selectLength = 0;\r\n                ratiosWidth = 0;\r\n            } else {\r\n                ratiosWidth = Number((ratiosWidth + this.ratios[i - 1]).toFixed(c));\r\n                selectLength = barWidth * ratiosWidth;\r\n            }\r\n            const pointerWidth: number = pointerX - selectLength;\r\n            if (percent <= Number((ratiosWidth + this.ratios[i]).toFixed(c))\r\n                && percent >= ratiosWidth) {\r\n                return this.ticksArr[i] + (pointerWidth / limitWidth) * (this.ticksArr[i + 1] - this.ticksArr[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 当前组件写入新值 || min || max || scales发生变化 时更新value对应的位置\r\n     * @param: newValue 需要处理的value的值\r\n     */\r\n    private updateValuePosition(newValue: string): void {\r\n        let valueTmp: string;\r\n        if (this.isDouble) {\r\n            valueTmp = this.restrictDoubleValue(newValue);\r\n            const valueMax: number = TiSliderComponent.splitValueToArray(valueTmp).valueMax;\r\n            const valueMin: number = TiSliderComponent.splitValueToArray(valueTmp).valueMin;\r\n            // 当设置value均为最大值情况下，设置最小滑块层级，确保滑块可被拖动\r\n            // 最小值的情况左右滑块zIndex相等，但是右滑块DOM在左滑块之后，因此根据zIndex规则，右滑块可以覆盖左滑块\r\n            if ((valueMin === valueMax) && (valueMin === this.max)) {\r\n                this.isMinPointerActive = true;\r\n            }\r\n            // 设置滑块的位置\r\n            this.valueToPosition(valueMin, this.pointerMinEle);\r\n            this.valueToPosition(valueMax, this.pointerMaxEle);\r\n        } else {\r\n            valueTmp = this.restrictSingleValue(newValue);\r\n            this.valueToPosition(valueTmp, this.pointerMaxEle);\r\n        }\r\n\r\n        if (newValue !== valueTmp) {\r\n            this.model = valueTmp;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 限定双滑块value的值\r\n     * @param: value 需要处理的value的值\r\n     */\r\n    private restrictDoubleValue(value: string): string {\r\n        const valueMin: number = TiSliderComponent.splitValueToArray(value).valueMin; // 双滑块的小值\r\n        const valueMax: number = TiSliderComponent.splitValueToArray(value).valueMax; // 双滑块的大值\r\n        // 非法情况：非数字，超过限制，value大小顺序不正确情况\r\n        const isInvalidValueMin: boolean = isNaN(valueMin) ||\r\n            TiSliderComponent.isLimitExceed(valueMin, this.min, this.max) || valueMin > valueMax;\r\n        // 非法情况：非数字，超过限制，value大小顺序不正确情况\r\n        const isInvalidValueMax: boolean = isNaN(valueMax) ||\r\n            TiSliderComponent.isLimitExceed(valueMax, this.min, this.max) || valueMin > valueMax;\r\n\r\n        return `${isInvalidValueMin ? this.min : valueMin};${isInvalidValueMax ? this.max : valueMax}`;\r\n    }\r\n\r\n    /**\r\n     * @description: 限定单滑块value的值\r\n     * @param: value 需要处理的value的值\r\n     */\r\n    private restrictSingleValue(value: any): any {\r\n        if (isNaN(parseFloat(value)) || value < this.min) {\r\n            // value不是数字或者小于最小值point定位到最小值\r\n            return this.min;\r\n        }\r\n        if (value > this.max) {\r\n            // value大于最大值point定位到最大值\r\n            return this.max;\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * @description: 处理tip\r\n     */\r\n    private setTipConfig(): void {\r\n        const defaultTipShow: 'auto' | 'always' = 'auto';\r\n        const defaultTipFormatter: (value: any) => string = (value: any): any => {\r\n            return value;\r\n        };\r\n\r\n        this.tipMode = Util.isUndefined(this.tipMode) ? defaultTipShow : this.tipMode;\r\n        this.tipFormatterFn = Util.isUndefined(this.tipFormatterFn) ? defaultTipFormatter : this.tipFormatterFn;\r\n        this.isTipAutoShow = (this.tipMode !== 'always');\r\n        if (this.isTipAutoShow) {\r\n            this.hide(this.tipMaxEle);\r\n            this.hide(this.tipMinEle);\r\n        } else {\r\n            this.show(this.tipMaxEle);\r\n            this.show(this.tipMinEle);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 处理限制\r\n     */\r\n    private setMinMax(): void {\r\n        const defaultMin: number = 0;\r\n        const defaultMax: number = 10;\r\n        const min: number = parseFloat(`${this.min}`);\r\n        const max: number = parseFloat(`${this.max}`);\r\n        this.min = (isNaN(min) || min >= max) ? defaultMin : min;\r\n        this.max = (isNaN(max) || min >= max) ? defaultMax : max;\r\n    }\r\n\r\n    /**\r\n     * @description: 处理刻度\r\n     */\r\n    private setScales(): void {\r\n        const step: number = this.step;\r\n        const min: number = this.min;\r\n        const max: number = this.max;\r\n        let ticks: Array<any> = [];\r\n        if (typeof this.scales === 'function') {\r\n            this.ticks = TiSliderComponent.translateScales(this.scales, min, max, step);\r\n        } else if (Array.isArray(this.scales)) {\r\n            // 为Array情况下，直接使用数值\r\n            this.ticks = this.scales.concat();\r\n        } else {\r\n            // 未传scale(包含非法)的情况下，只显示最小和最大值\r\n            const ticksLen: number = (max - min) / step;\r\n            ticks.push(min);\r\n            for (let i: number = 0; i < ticksLen - 1; i++) {\r\n                // 除最小最大值外，其余只打点不显示label\r\n                ticks.push('');\r\n            }\r\n            ticks.push(max);\r\n            this.ticks = ticks;\r\n        }\r\n        if (!Util.isUndefined(this.ratios)) {\r\n            let ratiosSum: number = 0; // 将ratios中每一项与之前的求和\r\n            const sumArray: Array<number> = []; //  由ratiosSum组成的数组\r\n            const ratiosLen: number = this.ratios.length;\r\n            for (let i: number = 0; i < ratiosLen; i++) {\r\n                ratiosSum = Number((ratiosSum + Number(this.ratios[i])).toFixed(this.decimalDigit));\r\n                sumArray.push(ratiosSum);\r\n            }\r\n            ticks = this.getTicks(sumArray, this.decimalDigit);\r\n            this.ticks = ticks;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: 非均匀情况下确定打点的位置\r\n     * @param: arr 由ratiosSum组成的数组\r\n     * @param: num ratios中最大的小数位数\r\n     */\r\n    private getTicks(arr: Array<number>, num: number): Array<any> {\r\n        const minScale: number = Number(Math.pow(0.1, num)\r\n                                    .toFixed(num)); //  判断是否打点的基数\r\n        let k: number = 1;\r\n        let p: number = 0;\r\n        const ticks: Array<number> = [this.ticks[0]];\r\n        const length: number = parseInt(`${1 / minScale}`, 10);\r\n        for (let i: number = 0; i < length; i++) {\r\n            p = Number((p + minScale).toFixed(num));\r\n            if (arr.indexOf(p) === -1) {\r\n                // 判断每次相加基数后是否在数组中，不在不打点不显示label\r\n                // tslint:disable-next-line:no-null-keyword\r\n                ticks.push(null);\r\n            } else {\r\n                // 否则打点显示label\r\n                ticks.push(this.ticks[k]);\r\n                k++;\r\n            }\r\n        }\r\n\r\n        return ticks;\r\n    }\r\n\r\n    /**\r\n     * @description: 显示隐藏的元素\r\n     * @param: ele: 要显示的DOM对象\r\n     */\r\n    private show(ele: any): void {\r\n         // 注：此处未使用ng-show方式控制滑块显示是因为有延迟，造成后续方法获取pointer宽度为0，显示错乱\r\n        this.renderer2.setStyle(ele, 'display', 'block');\r\n    }\r\n\r\n    /**\r\n     * @description: 隐藏显示的元素\r\n     * @param: ele: 要隐藏的DOM对象\r\n     */\r\n    private hide(ele: any): void {\r\n         // 注：此处未使用ng-show方式控制滑块显示是因为有延迟，造成后续方法获取pointer宽度为0，显示错乱\r\n        this.renderer2.setStyle(ele, 'display', 'none');\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description: 获取ticks的最大显示宽度，一行显示不下情况下，换行显示\r\n     * @param: index 刻度下标\r\n     */\r\n    public calcTickMaxWidth(index: number): string {\r\n        const ticksLen: number = this.ticks.length;\r\n        const spacePercent: number = 1 / (ticksLen - 1); // 两个刻度点间隔宽度百分百（小数）\r\n        if (index === 0 || index === (ticksLen - 1)) {\r\n            // 第一个和最后一个刻度\r\n            return TiSliderComponent.parseToCalcStyle(spacePercent, this.pointerMaxEleWidth / 2);\r\n        }\r\n\r\n        return TiSliderComponent.parseToCalcStyle(spacePercent);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description: 获取 ticks 的left位置\r\n     * @param: index 刻度下标\r\n     */\r\n    public calcTickLeftPosition(index: number): string {\r\n        return `${index / (this.ticks.length - 1) * 100}%`;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description: 确定滑动轴打点是否为选中点，根据函数返回值设置选中样式 (是否是selection区域的点)\r\n     * @param: index 刻度下标\r\n     */\r\n    public isSelectTick(index: number): boolean {\r\n        const ticksLen: number = this.ticks.length;\r\n        // 双滑块情况下,位于最大最小值之间为选中状态\r\n        if (this.isDouble) {\r\n            const value: Array<string> = this.model.split(';');\r\n            const isLargeThanValMin: boolean = index / ticksLen >= (parseFloat(value[0]) - this.min) / (this.max - this.min);\r\n            const isSmallThanValMax: boolean = index / ticksLen <= (parseFloat(value[1]) - this.min) / (this.max - this.min);\r\n\r\n            return isLargeThanValMin && isSmallThanValMax;\r\n        }\r\n\r\n        // 单滑块情况下,小于选中值为选中状态\r\n        return index / ticksLen <= (parseFloat(this.model) - this.min);\r\n    }\r\n\r\n    /**\r\n     * @description:  获取滑动轴的宽度(涉及到屏幕缩放，所以需要实时获取)\r\n     */\r\n    private getBarWidth(): number {\r\n        return this.trackELe.getBoundingClientRect().width - this.pointerMaxEleWidth;\r\n    }\r\n\r\n    /**\r\n     * @description: 获取ratios中最大的小数位数\r\n     */\r\n    private getDecimalDigit(): number {\r\n        const decimalArr: Array<number> = [];\r\n        if (Array.isArray(this.ratios)) {\r\n            this.ratios.forEach((item: number) => {\r\n                const decimal: string = item.toString()\r\n                .split('.')[1];\r\n                if (decimal) {\r\n                    decimalArr.push(decimal.length);\r\n                }\r\n            });\r\n        }\r\n\r\n        return Math.max.apply(null, decimalArr);\r\n    }\r\n\r\n    /**\r\n     * @description: 获取当前value所在的区域以及当前value对应的长度占总长的百分比(小数)\r\n     * @param: value 指针对应的value值\r\n     * @param: paragraph 当前打点的段数\r\n     */\r\n    private getValuePercent(value: number, paragraph: number): number {\r\n        let ratiosSum: number = 0; // 当前打点的段数下ratios的总和\r\n        for (let i: number = 0; i < paragraph; i++) {\r\n            ratiosSum = Number((ratiosSum + this.ratios[i]).toFixed(this.decimalDigit));\r\n        }\r\n\r\n        return ratiosSum + (value - this.ticksArr[paragraph]) / (this.ticksArr[paragraph + 1]\r\n            - this.ticksArr[paragraph]) * this.ratios[paragraph];\r\n    }\r\n\r\n    /**\r\n     * @description: 设置pointerDOM位置\r\n     * @param: value 指针对应的value值\r\n     * @param: pointer 被设置的DOM对象\r\n     */\r\n    private setPointerPos(value: number, pointer: any): void {\r\n        let valuePercent: number;\r\n        if (!Util.isUndefined(this.ratios)) {\r\n            if (Util.isUndefined(this.ticks)) {\r\n                return;\r\n            }\r\n            this.ticksArr = [];\r\n            this.ticks.forEach((tick: string) => {\r\n                if (!Util.isNull(tick)) {\r\n                    this.ticksArr.push(tick);\r\n                }\r\n            });\r\n            const ticksArrLen: number = this.ticksArr.length;\r\n            for (let i: number = 0; i < ticksArrLen - 1; i++) {\r\n                if (value >= this.ticksArr[i] && value <= this.ticksArr[i + 1]) {\r\n                    valuePercent = this.getValuePercent(value, i);\r\n                }\r\n            }\r\n        } else {\r\n            valuePercent = (value - this.min) / (this.max - this.min);\r\n        }\r\n        // 计算value对应的百分比位置,并以tick中心点居中显示\r\n        const pointerLeft: string = TiSliderComponent.parseToCalcStyle(valuePercent);\r\n        this.renderer2.setStyle(pointer, 'left', pointerLeft);\r\n    }\r\n\r\n    /**\r\n     * @description: 改变某一指针value值对应的指示位置\r\n     * @param: value 指针对应的value值\r\n     * @param: pointer 被设置的DOM对象\r\n     */\r\n    private valueToPosition(value: any, pointer: any): void {\r\n        this.setPointerPos(value, pointer); // 设置pointer位置\r\n        let styles: object; // 滑动轴有效区域背景 样式对象\r\n        // 修复SSR报错：ERROR { Error: Uncaught (in promise): TypeError: this.pointerMaxEle.getBoundingClientRect is not a function\r\n        if(typeof this.pointerMaxEle.getBoundingClientRect !=='function'){\r\n            return;\r\n        }\r\n        // 设置滑动轴有效区域背景\r\n        const pointerMaxLeft: number = this.pointerMaxEle.getBoundingClientRect().left;\r\n        const pointerMinLeft: number = this.pointerMinEle.getBoundingClientRect().left;\r\n        const barWidth: number = this.getBarWidth();\r\n        const barLeft: number =this.trackELe.getBoundingClientRect().left;\r\n        const pointerWidthHalf: number = this.pointerMaxEleWidth / 2;\r\n        if (this.isDouble) {\r\n            styles = {\r\n                width: `${(pointerMaxLeft - pointerMinLeft) * 100 / barWidth}%`,\r\n                left:  `${((pointerMinLeft - barLeft + pointerWidthHalf) * 100 / barWidth)}%`\r\n            };\r\n        } else {\r\n            styles = {\r\n                width: `${((pointerMaxLeft - barLeft + pointerWidthHalf) * 100 / barWidth)}%`,\r\n                left: 0\r\n            };\r\n        }\r\n        this.tiRenderer.setStyles(this.selectionEle, styles);\r\n        this.setTip(pointer.querySelector('.ti3-slider-tip'), value);\r\n    }\r\n\r\n    /**\r\n     * @description:设置Tip提示内容及位置\r\n     * @param: curTipEle 要设置tip的元素\r\n     * @param: value 设置tip内容对应的value值\r\n     */\r\n    private setTip(curTipEle: any, value: number): void {\r\n        // 设置tip内容\r\n        const tipContent: string = this.tipFormatterFn(value);\r\n        curTipEle.innerHTML = this.domSanitizer.sanitize(SecurityContext.HTML, tipContent);\r\n\r\n        // 设置当前tip位置\r\n        const tipDisplay: string = getComputedStyle(curTipEle).display;\r\n        this.show(curTipEle); // 先把tip显示出来 才能获取宽度\r\n        const tipContentWidth: number = curTipEle.getBoundingClientRect().width;\r\n        const styles: { left: string, display: string } = {\r\n            left: `${-(tipContentWidth - this.pointerMaxEleWidth) / 2 - 1}px`, // 定位受border的影响，需要减去border的宽度 1px\r\n            display: tipDisplay // 设置回原来的display\r\n        };\r\n        this.tiRenderer.setStyles(curTipEle, styles);\r\n        // tip重合情况处理  (双滑块并且tip是一直显示出来那种场景)\r\n        if (this.isDouble && !this.isTipAutoShow) {\r\n            /**\r\n             * @description: 渲染当前的tip样式 （移除一个class并且添加一个class）\r\n             * @param: tipEle 当前tipDOM\r\n             * @param: removeClass 要移除的class名字\r\n             * @param: addClass 要添加的class名字\r\n             */\r\n            const renderTipStyle: (tipEle: any, removeClass: string, addClass: string) => void =\r\n                (tipEle: any, removeClass: string, addClass: string): void => {\r\n                this.renderer2.removeClass(tipEle, removeClass);\r\n                this.renderer2.addClass(tipEle, addClass);\r\n            };\r\n            // 重置tip样式，防止之前样式设置造成的影响  ti3-slider-tip-top\r\n            renderTipStyle(this.tipMaxEle, 'ti3-slider-tip-bottom', 'ti3-slider-tip-top');\r\n            renderTipStyle(this.tipMinEle, 'ti3-slider-tip-bottom', 'ti3-slider-tip-top');\r\n            this.show(this.tipMaxEle);\r\n            this.show(this.tipMinEle);\r\n\r\n            // 最大最小值重合情况下，只显示当前tip\r\n            const selectionWidth: number = this.selectionEle.getBoundingClientRect().width;\r\n            if (selectionWidth === 0) {\r\n                if (this.tiRenderer.hasClass(curTipEle, 'ti3-slider-tip-max')) {\r\n                    // 当前tip是最大值的 隐藏最小值tip\r\n                    this.hide(this.tipMinEle);\r\n                } else {\r\n                    // 当前tip是最小值的 隐藏最大值tip\r\n                    this.hide(this.tipMaxEle);\r\n                }\r\n\r\n                return;\r\n            }\r\n            // tip重合情况下，当前tip向下显示\r\n            const tipMaxWidth: number = this.tipMaxEle.getBoundingClientRect().width;\r\n            const tipMinWidth: number = this.tipMinEle.getBoundingClientRect().width;\r\n            if ((tipMaxWidth + tipMinWidth) / 2 >= selectionWidth) {\r\n                renderTipStyle(curTipEle, 'ti3-slider-tip-top', 'ti3-slider-tip-bottom');\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiDraggableModule } from '../../directives/drag/TiDraggableModule';\r\nimport { TiSliderComponent } from './TiSliderComponent';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        TiDraggableModule,\r\n        TiIconModule,\r\n        TiRendererModule\r\n    ],\r\n    exports: [TiSliderComponent],\r\n    declarations: [TiSliderComponent]\r\n})\r\n\r\nexport class TiSliderModule {\r\n}\r\nexport { TiSliderComponent } from './TiSliderComponent';\r\n","import { DefaultValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport { Directive, ElementRef, forwardRef, Input, Renderer2, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiLocaleFormat } from '../../locale/TiLocaleModule';\r\nimport { Util } from '../../utils/Util';\r\n/**\r\n * TiNumber 数字输入框指令\r\n *\r\n * 该指令主要作用于输入框上，限制只能输入数字。用户可以通过设置 数字保留精度、是否国际化 来设置数字显示格式\r\n *\r\n * 输入框处于焦点状态时，输入框中数字标准化显示。失去焦点时，根据用户配置是否支持国际化进行格式化显示\r\n *\r\n * 目前JS可以解析的范围是[-2^53, 2^53]，即16位数字。当超过16位整数时，此时数字范围已经超过JS解析方位，不能精确表示。\r\n *\r\n * <example-url>../tiny3demo/#/inputnumber/inputnumber-all</example-url>\r\n */\r\n@Directive ({\r\n    // 指令元数据\r\n    selector: '[tiNumber]',\r\n    providers: [\r\n        {\r\n            provide: NG_VALUE_ACCESSOR,\r\n            // tslint:disable-next-line:no-forward-ref\r\n            useExisting: forwardRef(() => TiInputNumberDirective),\r\n            multi: true\r\n        }\r\n    ],\r\n    host: {\r\n        '(input)': 'handleInput($event.target.value)',\r\n        '(focus)': 'focusFn();',\r\n        '(blur)': 'blurFn()'\r\n    }\r\n})\r\n// The default ControlValueAccessor for writing a value and listening to changes on input elements.\r\n// The accessor is used by the FormControlDirective, FormControlName, and NgModel directives.\r\nexport class TiInputNumberDirective extends DefaultValueAccessor {\r\n    /**\r\n     * 设置数据是否支持国际化显示，默认支持国际化\r\n     */\r\n    @Input() localeable: boolean = true;\r\n    /**\r\n     * 设置数字精度。使用n+'小数保留位数'形式表示，例如：'n4',代表保留4位小数。\r\n     *\r\n     * 不设置时，自10.0.1版本起小数点后默认最少保留0位，最多保留3位；10.0.0及之前版本默认保留3位。\r\n     */\r\n    @Input() format: string;\r\n    private numberFormat: string = '1.0-3';\r\n    private oldInputValue: string = ''; // 没有千位分隔符的input中的值\r\n    private onChangeFn: (_: any) => void;\r\n    private element: HTMLInputElement;\r\n    private oldModel: number;\r\n    constructor(private renderer: Renderer2, private elementRef: ElementRef, @Inject(DOCUMENT) private document) {\r\n        super(renderer, elementRef, true);\r\n        this.element = this.elementRef.nativeElement;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if (!TiLocaleFormat.isInvalidFormat(this.format)) {\r\n            const precision: number = parseInt(this.format.slice(1), 10);\r\n            // tslint:disable-next-line:prefer-template\r\n            this.numberFormat = '1.' + precision + '-' + precision;\r\n        }\r\n    }\r\n\r\n    // 检测当前值是否合法 如果合法 返回true；否则返回false.\r\n    private isValidInput(value: string): boolean {\r\n        const decimalSep: string = this.localeable ? TiLocaleFormat.getNumberSymbol('Decimal') : '.'; // 当前局点小数点的形式\r\n        let regex: any; // regex是正则表达式，不明其类型，所以\r\n        if (decimalSep === ',') {\r\n            regex = /^\\-{0,1}\\d{0,},{0,1}\\d{0,}$/;\r\n        } else if (decimalSep === '.') {\r\n            regex = /^\\-{0,1}\\d{0,}\\.{0,1}\\d{0,}$/;\r\n        }\r\n\r\n        return regex.test(value);\r\n    }\r\n    /**\r\n     * 功能描述：当该值合法，直接返回. 如果不合法，则返回之前保存的有效值。\r\n     * @memberOf TiInputNumberDirective\r\n     */\r\n    private getCorrectValue(value: string): string {\r\n        if (!this.isValidInput(value)) {\r\n            return this.oldInputValue;\r\n        }\r\n\r\n        return value;\r\n    }\r\n    // 根据精度和是否支持国际化，格式化数字\r\n    private  formatValue(value: number): string {\r\n        if (Number.isNaN(value)) {\r\n            return;\r\n        }\r\n        // https://angular.cn/api/common/DecimalPipe\r\n        // digitsInfo: {minIntegerDigits}.{minFractionDigits}-{maxFractionDigits}\r\n        // minIntegerDigits: 小数点前最小位数 默认为1\r\n        // minFractionDigits: 小数点后最小位数 默认0\r\n        // maxFractionDigits: 小数点后最大位数 默认3\r\n        // tslint:disable-next-line:prefer-template\r\n        const localeValue: string = TiLocaleFormat.formatNumber(value, this.numberFormat);\r\n        if (this.localeable) {\r\n            return this.document.activeElement === this.element ? TiLocaleFormat.deleteGroupSep(localeValue) : localeValue;\r\n        } else { // 不支持国际化时，也可利用TiLocaleFormat.formatNumber精度处理能力\r\n            return TiLocaleFormat.parseNumber(localeValue).toString();\r\n        }\r\n    }\r\n    // 将国际化数字转换为标准化数字\r\n    private parseValue(value: string): number {\r\n        return this.localeable ? TiLocaleFormat.parseNumber(value) : parseFloat(value);\r\n    }\r\n    // 将国际化数字的千位分隔符去掉(输入框聚焦状态需要)\r\n    private deleteGroupSepValue(formatValue: string): string {\r\n        return this.localeable ? TiLocaleFormat.deleteGroupSep(formatValue) : formatValue;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 实现继承来自父类的方法\r\n     * Sets the \"value\" property on the input element.\r\n     * model->view\r\n     */\r\n     writeValue(value: any): void {\r\n        // writeValue()方法会执行两遍。第一遍为null, 第二遍为用户配置的数据。\r\n        if (value === null) {\r\n            return;\r\n        }\r\n\r\n        // 由于10.0.0及之前版本中开发者只能给ngModel传入空字符串时才能清空值，但是该组件ngModel应该是传入number类型，所以要清空时应该设置undefined。\r\n        // 10.0.1版本开始进行纠正，为了兼容旧版本，设置空字符串时也能清空。\r\n        if (value === undefined || value === '') {\r\n            super.writeValue('');\r\n            this.oldInputValue = '';\r\n            this.oldModel = undefined;\r\n            return;\r\n        }\r\n\r\n        let normalValue: number;\r\n        if (Number.isNaN(parseFloat(value))) {\r\n            if (this.oldModel === undefined) {\r\n                super.writeValue('');\r\n                this.oldInputValue = '';\r\n            } else {\r\n                const formatValue: string = this.formatValue(this.oldModel);\r\n                super.writeValue(formatValue);\r\n                this.oldInputValue = this.deleteGroupSepValue(formatValue);\r\n            }\r\n            normalValue = this.oldModel;\r\n        } else {\r\n            const formatValue: string = this.formatValue(value);\r\n            super.writeValue(formatValue);\r\n            this.oldInputValue = this.deleteGroupSepValue(formatValue);\r\n            normalValue = this.parseValue(formatValue);\r\n        }\r\n\r\n        if (normalValue !== value) {\r\n            if (Util.isUndefined(this.onChangeFn)) {\r\n                // 在reactive-form中使用，初始化赋值调用writeValue时，\r\n                // 此时registerOnChange还未被调用，onChangeFn还未被赋值，\r\n                // 所以要使用setTimeout等onChangeFn被赋值后再调用\r\n                setTimeout(() => {\r\n                    this.changeModel(normalValue);\r\n                }, 0);\r\n            } else {\r\n                this.changeModel(normalValue);\r\n            }\r\n        } else {\r\n            this.oldModel = normalValue;\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * Registers a function called when the control value changes\r\n     * @param fn The callback function\r\n     * 注册当控件接收到change事件之后，调用的函数fn\r\n     * viewValue和model value值的同步\r\n     */\r\n    registerOnChange(fn: (value: any) => void): void {\r\n        this.onChangeFn = fn;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * view -> model\r\n     * 非法字符不能输入。如果是合法则更新，如果是非法，则设置为oldInputValue...\r\n     */\r\n    public handleInput(value: string): void {\r\n        // IE9 cut delete backspace下支持这三种方式引起的改变。\r\n        // text组件针对这三种方式做了兼容性处理，并且触发input事件\r\n        // 所以 inputnumber无需再做兼容性处理\r\n        this.parser(value);\r\n    }\r\n\r\n    private parser(value: string): void {\r\n        const validationValue: string = this.getCorrectValue(value);\r\n        if (!this.isValidInput(value)) {\r\n            let cursorPos: number = this.element.selectionStart;\r\n            const diff: number = value.length - validationValue.length;\r\n            cursorPos = cursorPos - diff;\r\n            this.renderer.setProperty(this.element, 'value', this.oldInputValue); // Sets the \"value\" property on the input element.\r\n            this.element.setSelectionRange(cursorPos, cursorPos);\r\n        } else {\r\n            this.oldInputValue = validationValue;\r\n            const parseValue: number = this.parseValue(validationValue);\r\n            this.changeModel(Number.isNaN(parseValue) ? undefined :parseValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 得到焦点数据标准化处理\r\n     * @memberOf TiInputNumberDirective\r\n     * renderer.setProperty: Implement this callback to set the value of a property of an element in the DOM.\r\n     */\r\n    public focusFn(): void {\r\n        if (this.element.value === '') {\r\n            return;\r\n        }\r\n        // 为了得到各个浏览器下正确的光标位置，所以添加延时处理\r\n        if (this.localeable) {\r\n            setTimeout(() => {\r\n                const start: number = this.element.selectionStart;\r\n                const end: number = this.element.selectionEnd;\r\n                if (end - start === this.element.value.length) {\r\n                    this.renderer.setProperty(this.element, 'value', TiLocaleFormat.deleteGroupSep(this.element.value));\r\n                    this.element.setSelectionRange(0, this.element.value.length);\r\n                } else {\r\n                    const groupSep: string = TiLocaleFormat.getNumberSymbol('Group');\r\n                    const old: string = this.element.value;\r\n                    const sub: string = old.substr(0, start);\r\n                    const groupSepNum: number = sub.split(groupSep).length - 1;\r\n\r\n                    this.renderer.setProperty(this.element, 'value', TiLocaleFormat.deleteGroupSep(this.element.value));\r\n                    this.element.setSelectionRange(start - groupSepNum, start - groupSepNum);\r\n                }\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 失去焦点数字国际化处理\r\n     * @memberOf TiInputNumberDirective\r\n     */\r\n    public blurFn(): void {\r\n        const value: number = this.parseValue(this.element.value);\r\n        if (Number.isNaN(value)) {\r\n            this.renderer.setProperty(this.element, 'value', '');\r\n            this.oldInputValue = '';\r\n            return;\r\n        }\r\n        const formatValue: string = this.formatValue(value);\r\n        this.renderer.setProperty(this.element, 'value', formatValue);\r\n        this.oldInputValue = this.deleteGroupSepValue(formatValue);\r\n        const normalValue: number = this.parseValue(formatValue);\r\n        if (value !== normalValue) {\r\n            this.changeModel(normalValue);\r\n        }\r\n    }\r\n\r\n    private changeModel(model: number): void {\r\n        if (model !== this.oldModel) {\r\n            this.onChangeFn(model);\r\n            this.oldModel = model;\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiInputNumberDirective } from './TiInputNumberDirective';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  exports: [TiInputNumberDirective],\r\n  declarations: [TiInputNumberDirective]\r\n})\r\nexport class TiInputNumberModule {\r\n}\r\nexport { TiInputNumberDirective } from './TiInputNumberDirective';\r\n","import { Component, ElementRef, EventEmitter,\r\n     Input, Output, Renderer2, SimpleChanges, ViewChild } from '@angular/core';\r\nimport { TiLocaleFormat } from '../../locale/TiLocaleModule';\r\nimport { TiKeymap, Util } from '../../utils/Util';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n/**\r\n * 数字微调组件\r\n *\r\n * <example-url>../tiny3demo/#/spinner/spinner-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-spinner',\r\n    templateUrl: './spinner.html',\r\n    styleUrls: ['./spinner.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiSpinnerComponent)]\r\n})\r\nexport class TiSpinnerComponent extends TiFormComponent {\r\n    /**\r\n     * @ignore\r\n     */\r\n    public method: any = {\r\n        METHOD_ADD : 'add',\r\n        METHOD_SUB : 'sub'\r\n    };\r\n    /**\r\n     * 数字小数位数格式，使用n+'小数保留位数'形式表示，例如：'n4'或'N4',代表保留4位小数。\r\n     *\r\n     * 自10.0.1版本起不设置时，小数点后默认最少保留0位，最多保留3位；10.0.0及之前版本默认保留3位。\r\n     */\r\n    @Input() format: string;\r\n    /**\r\n     * 最大值，JS中能表示的整数范围是53位的，如果超过了这个范围的整数，进行一些运算时会出现错误，因此最大值为2^53\r\n     */\r\n    @Input() max: number = Math.pow(2, 53);\r\n    /**\r\n     * 最小值，JS中能表示的整数范围是53位的，如果超过了这个范围的整数，进行一些运算时会出现错误，因此最小值为-2^53\r\n     */\r\n    @Input() min: number = -Math.pow(2, 53);\r\n    /**\r\n     * 微调器的步长\r\n     */\r\n    @Input() step: number = 1;\r\n    /**\r\n     * 占位提示信息\r\n     */\r\n    @Input() placeholder: string = '';\r\n    /**\r\n     * @ignore\r\n     *\r\n     * 从10.0.1版本开始该接口不再开放。如果不想要组件根据最大最小值进行强制转换，那么不要设置最大最小值即可。\r\n     *\r\n     * 失去焦点是否支持根据最大最小值进行强制转换（默认值为true, 支持强转; 当用户配置为false时，不支持强制转换）\r\n     */\r\n    @Input() correctable: boolean = true;\r\n    /**\r\n     * 是否开启国际化。默认值为true,开启国际化功能; 当用户配置为false时，不支持国际化)\r\n     */\r\n    @Input() localeable: boolean = true;\r\n    /**\r\n     * 输入文本的最大长度， 默认值为20.\r\n     */\r\n    @Input() maxlength: number = 20;\r\n    /**\r\n     * @ignore\r\n     * 当数据发生改变时，触发change事件\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly stepChange: EventEmitter<string> = new EventEmitter<string>();\r\n    @ViewChild('input', { static: true }) private inputEle: ElementRef;\r\n\r\n    private numberFormat: string = '1.0-3'; // 整数位保留最小位数.小数位保留最小位数-小数位最大保留位置\r\n    /**\r\n     * @ignore\r\n     */\r\n    public inputValue: number;\r\n    constructor(protected hostRef: ElementRef, protected renderer2: Renderer2) {\r\n        super(hostRef, renderer2);\r\n    }\r\n    // 组件声明周期钩子--start ↓\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.setFocusableElems([this.inputEle.nativeElement]);\r\n        this.init();\r\n    }\r\n\r\n    private init(): void {\r\n        if (!TiLocaleFormat.isInvalidFormat(this.format)) {\r\n            const precision: number = parseInt(this.format.slice(1), 10);\r\n            // tslint:disable-next-line:prefer-template\r\n            this.numberFormat = '1.' + precision + '-' + precision;\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        this.setChanges(changes, 'max');\r\n        this.setChanges(changes, 'min');\r\n    }\r\n    // 输入属性发生改变\r\n    private setChanges(changes: SimpleChanges, key: string): void {\r\n        if (changes[key] && !changes[key].isFirstChange()) {\r\n            this[key] = parseFloat(changes[key].currentValue);\r\n            if (Number.isNaN(this[key]) || this.min > this.max) {\r\n                this[key] = parseFloat(changes[key].previousValue);\r\n            }\r\n            if (this.correctable && this.model !== undefined) {\r\n                const model: number = this.getModelByMinMax(this.inputValue);\r\n                if (model !== this.model) {\r\n                    // error: Expression has changed after it was checked.\r\n                    setTimeout(() => {\r\n                        this.inputValue = model;\r\n                        this.model = model;\r\n                    }, 0);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // 组件声明周期钩子--end\r\n    // 实现ControlValueAccessor接口\r\n    /**\r\n     * @ignore\r\n     * model --> view\r\n     */\r\n    writeValue(value: any): void {\r\n        if (value === null) {\r\n            return;\r\n        }\r\n\r\n        super.writeValue(value);\r\n\r\n        if (!Util.isUndefined(value)) {\r\n            if (Number.isNaN(parseFloat(value))) {\r\n                this.model = this.inputValue;\r\n                return;\r\n            }\r\n\r\n            if (this.correctable) {\r\n                const val: any = this.getModelByMinMax(value);\r\n                this.model = val;\r\n                this.inputValue = val;\r\n                return;\r\n            }\r\n        }\r\n        this.inputValue = value;\r\n    }\r\n    // 实现ControlValueAccessor接口--end\r\n    /**\r\n     * @ignore\r\n     */\r\n    public blurFn(): void {\r\n        let correctValue: number = this.inputValue;\r\n        if (this.correctable && this.inputValue !== undefined) {\r\n            correctValue = this.getModelByMinMax(this.inputValue);\r\n        }\r\n        const parseFormatValue: number = correctValue === undefined ? correctValue : parseFloat(this.formatValue(correctValue));\r\n        if (parseFormatValue !== this.model) {\r\n            this.model = parseFormatValue;\r\n        }\r\n        this.inputValue = this.model;\r\n        this.onModelTouched(); // 校验 初次聚焦 后续聚焦失焦\r\n    }\r\n    /**\r\n     * @ignore\r\n     * description: Event emitter for producting the `ngModelChange` event after the view model updates.\r\n     * ngModelChange 是ngModel指令的@Output.\r\n     * 它在viewToModelUpdate函数中触发\r\n     *\r\n     */\r\n    public inputChange(value: number): void {\r\n        if (value !== undefined && (value < this.min || value > this.max)) {\r\n            return;\r\n        }\r\n        const parseFormatValue: number = value === undefined ? value : parseFloat(this.formatValue(value));\r\n        if (parseFormatValue !== this.model) {\r\n            this.model = parseFormatValue;\r\n        }\r\n    }\r\n    /**\r\n     * 键盘上下键操作\r\n     * @ignore\r\n     */\r\n    public keydownFn(event: any): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        if (event.keyCode === TiKeymap.KEY_ARROW_UP) {\r\n            this.stepNumber(this.method.METHOD_ADD);\r\n        } else if (event.keyCode === TiKeymap.KEY_ARROW_DOWN) {\r\n            this.stepNumber(this.method.METHOD_SUB);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public stepNumberMousedown(e: any, method: string): void {\r\n        if (e.button === TiKeymap.MOUSE_MIDDLE_BUTTON || e.button === TiKeymap.MOUSE_RIGHT_BUTTON || this.disabled) {\r\n            return;\r\n        }\r\n        // 如果是鼠标按下向下btn，输入框需要做获得光标的处理\r\n        this.inputEle.nativeElement.focus();\r\n        e.preventDefault(); // 目的是防止input失去焦点\r\n        this.stepNumber(method);\r\n    }\r\n\r\n    private stepNumber(method: string): void {\r\n        if ((this.inputValue >= this.max && method === this.method.METHOD_ADD) ||\r\n            (this.inputValue <= this.min && method === this.method.METHOD_SUB)) {\r\n            return;\r\n        }\r\n        this.stepChange.emit(method);\r\n        // 当输入框中的值为空时，点击+,-，显示最小值。\r\n        if (this.inputValue === undefined) {\r\n            this.model = this.min;\r\n            this.inputValue = this.model;\r\n\r\n            return;\r\n        }\r\n        if (method === this.method.METHOD_ADD) {\r\n            if (this.inputValue > this.max - this.step) {\r\n                this.model = this.max;\r\n                this.inputValue = this.model;\r\n\r\n                return;\r\n            }\r\n            if (this.inputValue < this.min) {\r\n                this.model = this.min;\r\n                this.inputValue = this.model;\r\n\r\n                return;\r\n            }\r\n        } else if (method === this.method.METHOD_SUB) {\r\n            if (this.inputValue < this.min + this.step) {\r\n                this.model = this.min;\r\n                this.inputValue = this.model;\r\n\r\n                return;\r\n            }\r\n            if (this.inputValue > this.max) {\r\n                this.model = this.max;\r\n                this.inputValue = this.model;\r\n\r\n                return;\r\n            }\r\n        }\r\n        this.model = this.accOperate(this.inputValue, this.step, method);\r\n        this.inputValue = this.model;\r\n    }\r\n    // 组件交互方法集合--end\r\n\r\n     // 根据最大最小值得到model值\r\n     private getModelByMinMax(curValue: number): number  {\r\n        if (curValue < this.min) {\r\n            return this.min;\r\n        }\r\n\r\n        if (curValue > this.max) {\r\n            return this.max;\r\n        }\r\n\r\n        return curValue;\r\n    }\r\n\r\n    private formatValue(value: number): string {\r\n        if (value === undefined) {\r\n            return;\r\n        }\r\n        // https://angular.cn/api/common/DecimalPipe\r\n        // digitsInfo: {minIntegerDigits}.{minFractionDigits}-{maxFractionDigits}\r\n        // minIntegerDigits: 小数点前最小位数 默认为1\r\n        // minFractionDigits: 小数点后最小位数 默认0\r\n        // maxFractionDigits: 小数点后最大位数 默认3\r\n        // tslint:disable-next-line:prefer-template\r\n        const localeValue: string = TiLocaleFormat.formatNumber(value, this.numberFormat);\r\n\r\n        return TiLocaleFormat.parseNumber(localeValue).toString();\r\n    }\r\n\r\n    // 根据步长、+/-进行数值计算\r\n    private accOperate(value: number, step: number, method: string): number {\r\n        let r1: number;\r\n        let r2: number;\r\n        let c: number;\r\n        let m: number;\r\n        let _value: number;\r\n        let _step: number;\r\n        // 计算 val 小数点后数字的位数\r\n        const getLength: (value: string | number) => number = (val: string): number => {\r\n            return (String(val)).split('.')[1] ? (String(val)).split('.')[1].length : 0;\r\n        };\r\n        // 去除 val 中的 ‘.’\r\n        const replacePeriod: (value: string | number) => number = (val: string): number => {\r\n            return Number((String(val)).replace('.', ''));\r\n        };\r\n        r1 = getLength(value);\r\n        r2 = getLength(step);\r\n        c = Math.abs(r1 - r2);\r\n        m = Math.pow(10, Math.max(r1, r2));\r\n\r\n        if (c > 0) {\r\n            const cm: number = Math.pow(10, c);\r\n            if (r1 > r2) {\r\n                _value = replacePeriod(value);\r\n                _step = replacePeriod(step) * cm;\r\n            } else {\r\n                _value = replacePeriod(value) * cm;\r\n                _step = replacePeriod(step);\r\n            }\r\n        } else {\r\n            _value = replacePeriod(value);\r\n            _step = replacePeriod(step);\r\n        }\r\n\r\n        if (method === this.method.METHOD_ADD) {\r\n            return (_value + _step) / m;\r\n        }\r\n\r\n        if (method === this.method.METHOD_SUB) {\r\n            return (_value - _step) / m;\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n    // 内部公共方法集合--end\r\n}\r\n","import { TiInputNumberModule } from '../../directives/inputnumber/TiInputNumberModule';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiSpinnerComponent } from './TiSpinnerComponent';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        TiIconModule,\r\n        TiTextModule,\r\n        TiInputNumberModule\r\n    ],\r\n    exports: [TiSpinnerComponent],\r\n    declarations: [TiSpinnerComponent]\r\n})\r\n\r\nexport class TiSpinnerModule {\r\n}\r\nexport { TiSpinnerComponent } from './TiSpinnerComponent';\r\n","import {\r\n    Component,\r\n    ElementRef,\r\n    EventEmitter,\r\n    Input,\r\n    IterableDiffers,\r\n    NgZone,\r\n    Output,\r\n    QueryList,\r\n    Renderer2,\r\n    ViewChild,\r\n    ViewChildren\r\n} from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n\r\n/**\r\n * steps步骤组件\r\n *\r\n * 点击可跳转和不可跳转两种方式（默认点击不跳转）\r\n *\r\n * <example-url>../tiny3demo/#/steps/steps-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-steps',\r\n    templateUrl: './steps.html',\r\n    styleUrls: ['./steps.less']\r\n})\r\n\r\nexport class TiStepsComponent extends TiBaseComponent {\r\n    /**\r\n     * 设置步骤组件的每一步内容。\r\n     * 数组的每个元素都是一个对象，对应每个步骤的一项。这个对象有2个可选属性：\r\n     *\r\n     * 1.steps[i].label（类型：String; 设置每个步骤对应的文本）。（非必选）\r\n     *\r\n     * 2.steps[i].disabled（类型：Boolean; 控制步骤是否灰化, 当clickable为true时才生效）。（非必选）\r\n     *\r\n     * 3.可扩展其他属性\r\n     */\r\n    @Input() steps: Array<any>;\r\n    /**\r\n     * 是否支持点击跳转功能，默认不支持\r\n     */\r\n    @Input() clickable: boolean = false;\r\n    /**\r\n     * 每个步骤的文本最大宽度\r\n     */\r\n    @Input() maxWidth: string;\r\n    /**\r\n     * 用户可指定要显示的属性值，默认显示label属性\r\n     */\r\n    @Input() labelKey: string = 'label';\r\n    /**\r\n     * 指定当前步骤\r\n     */\r\n    @Input() activeStep: any;\r\n    /**\r\n     * 宽度是否自动撑满父容器。\r\n     *\r\n     * 不设置时默认各步骤间线宽60px，步骤确定后整体宽度固定；设置为true时，整体宽度会自适应撑满父容器，适用于在弹窗中使用的场景。\r\n     */\r\n    @Input() adaptive: boolean = false;\r\n    /**\r\n     * 当前步骤改变时的事件\r\n     */\r\n    @Output() readonly activeStepChange: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * 点击后用户可根据条件判断是否跳转:见测试用例\r\n     */\r\n    @Output() readonly beforeStep: EventEmitter<any> = new EventEmitter<any>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('stepRef') stepsRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChildren('line') lineRef: QueryList<ElementRef>;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChildren('explain') explainRef: QueryList<ElementRef>;\r\n    private labelChange: boolean; // 标志文本长度是否变化，从而重新计算线长\r\n    private stepsDiffer: any;\r\n    private isInitLabelChange: boolean = true;\r\n    private explainTotalWidth: number = 0;\r\n    private windowResizeListener: () => void;\r\n    constructor(protected elementRef: ElementRef,\r\n                protected renderer2: Renderer2,\r\n                private iterableDiffers: IterableDiffers,\r\n                private zone: NgZone) {\r\n                super(elementRef, renderer2);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        if (!this.adaptive) {\r\n            return;\r\n        }\r\n        // this.trackByLabelFn监听对象：可以深度监听\r\n        this.stepsDiffer = this.iterableDiffers.find(this.steps)\r\n                                               .create(this.trackByLabelFn);\r\n        // 修复错误：ERROR ReferenceError: window is not defined\r\n        if (typeof window === 'undefined') {\r\n            return;\r\n        }\r\n        this.zone.runOutsideAngular(() => {\r\n            this.windowResizeListener = this.renderer2.listen(window, 'resize', this.setLineWidth);\r\n        });\r\n    }\r\n\r\n    ngDoCheck(): void {\r\n        if (this.adaptive) {\r\n            // 处理增删步骤\r\n            const stepsDiffer: any = this.stepsDiffer.diff(this.steps);\r\n            if (stepsDiffer) {\r\n                this.labelChange = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        // 需要判断当label变化时才计算线长\r\n        if (this.adaptive && this.labelChange) {\r\n            this.labelChange = false;\r\n            this.setLineWidth();\r\n            // 初始时在前几次的 ngAfterViewChecked 中计算文本宽度，生产环境清缓存场景下计算有点不准确(时机有点早)，但在初始时的后几次ngAfterViewChecked中计算的文本宽度是准确的。\r\n            // TODO: 是否有更合适的时机计算(已验证使用MutationObserver也解决不了，在ngAfterViewChecked中加setTimeout(0)也解决不了)\r\n            if (this.isInitLabelChange) {\r\n                setTimeout(() => {\r\n                    const explainTotalWidth: number = this.getExplainTotalWidth();\r\n                    if (explainTotalWidth !== this.explainTotalWidth) {\r\n                        this.setLineWidth(explainTotalWidth);\r\n                    }\r\n                }, 50); // 50ms是经验值\r\n                this.isInitLabelChange = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.windowResizeListener) {\r\n            this.windowResizeListener();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 每步的点击事件处理\r\n     */\r\n    public onClick(step: any): void {\r\n        // 不支持点击跳转和当前项灰化时，不处理\r\n        if (!this.clickable || step.disabled || this.activeStep === step) {\r\n            return;\r\n        }\r\n\r\n        // 未定义beforeStep事件，直接跳转，定义beforeStep事件将当前点击项索引传出\r\n        if (this.beforeStep.observers.length === 0) {\r\n            this.activeStep = step;\r\n            this.activeStepChange.emit(this.activeStep);\r\n        } else {\r\n            this.beforeStep.emit(step);\r\n        }\r\n    }\r\n\r\n    // 设置每个步骤之间的横线的宽度\r\n    public setLineWidth = (width?: number): void => {\r\n        this.explainTotalWidth = Util.isUndefined(width) ? this.getExplainTotalWidth() : width;\r\n        this.lineRef.forEach((stepLine: ElementRef) => {\r\n            this.renderer2.setStyle(stepLine.nativeElement, 'width',\r\n                `calc((100% - ${this.explainTotalWidth}px) / ${this.steps.length - 1})`);\r\n        });\r\n    }\r\n\r\n    private getExplainTotalWidth(): number {\r\n        let explainTotalWidth: number = 0;\r\n        if (!Util.isUndefined(this.explainRef)) {\r\n            this.explainRef.forEach((step: ElementRef) => {\r\n                // 计算每步选择框和文字的总长度\r\n                explainTotalWidth += step.nativeElement.offsetWidth;\r\n            });\r\n        }\r\n\r\n        return explainTotalWidth;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * Diff监听steps中label值的改变\r\n     */\r\n    public trackByLabelFn(index: number, item: any): string {\r\n        return item.label;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * ngFor 使用\r\n     */\r\n    public trackByIndexFn(index: number): number {\r\n        return index;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 判断当前项的状态\r\n     */\r\n    public getStepState(index: number): string {\r\n        const activedIndex: number = this.steps.indexOf(this.activeStep);\r\n        if (index < activedIndex) {\r\n            return 'complete';\r\n        } else if (index === activedIndex) {\r\n            return 'active';\r\n        } else {\r\n            return 'uncomplete';\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiStepsComponent } from './TiStepsComponent';\r\nimport { TiOverflowModule } from '../../directives/overflow/TiOverflowModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    TiOverflowModule,\r\n    TiIconModule,\r\n    CommonModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiStepsComponent],\r\n  declarations: [TiStepsComponent]\r\n})\r\n\r\nexport class TiStepsModule {\r\n}\r\nexport { TiStepsComponent } from './TiStepsComponent';\r\n","import { Component, ElementRef, EventEmitter, Output, ViewChild } from '@angular/core';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\n/**\r\n * Switch开关组件\r\n *\r\n * 用于实现页面中的开关操作。\r\n *\r\n * <example-url>../tiny3demo/#/switch/switch-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-switch',\r\n    templateUrl: './switch.html',\r\n    styleUrls: ['./switch.less'],\r\n    host: {\r\n        '[class.ti3-switch-container]': 'true'\r\n    },\r\n    providers: [ TiFormComponent.getValueAccessor(TiSwitchComponent) ],\r\n})\r\nexport class TiSwitchComponent extends TiFormComponent {\r\n    /**\r\n     * 组件开关状态即将切换之前发出事件:。组件状态不改变，后续全权交给组件调用者处理。\r\n     */\r\n    @Output() readonly beforeChange: EventEmitter<TiSwitchComponent> = new EventEmitter<TiSwitchComponent>();\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('a', { static: true }) aRef: ElementRef;\r\n\r\n    private initialized: boolean = false;\r\n    private hasAnimation: boolean = false;\r\n\r\n    ngOnInit(): void {\r\n        // 基类中做了设置宿主id的操作\r\n        super.ngOnInit();\r\n        this.setFocusableElems([this.aRef.nativeElement]);\r\n    }\r\n\r\n    ngOnModelChange(value: boolean): void {\r\n        super.ngOnModelChange(value);\r\n        if (value === null) { // 以 ngModel 的形式传入值时, writeValue首次传入null\r\n            return;\r\n        }\r\n\r\n        if (this.initialized && !this.hasAnimation) { // 保证初始时没有动画\r\n            this.renderer.addClass(this.aRef.nativeElement, 'ti3-switch-animation');\r\n            this.hasAnimation = true;\r\n        }\r\n        this.initialized = true;\r\n    }\r\n\r\n    /**\r\n     * 切换开关状态\r\n     */\r\n    private toggle(): void {\r\n\r\n        if (this.beforeChange.observers.length === 0) {// 用户未定义beforeChange\r\n            this.model = !this.model;\r\n        } else {\r\n            this.beforeChange.emit(this);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击事件\r\n     */\r\n    public onClick(): void {\r\n        if (!this.disabled) {\r\n            this.toggle();\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiSwitchComponent } from './TiSwitchComponent';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule\r\n    ],\r\n    exports: [ TiSwitchComponent ],\r\n    declarations: [ TiSwitchComponent ]\r\n})\r\n\r\nexport class TiSwitchModule {\r\n}\r\nexport { TiSwitchComponent } from './TiSwitchComponent';\r\n","import {\r\n    AfterViewChecked,\r\n    AfterViewInit,\r\n    Component,\r\n    ElementRef,\r\n    Input,\r\n    NgZone,\r\n    OnInit,\r\n    OnDestroy,\r\n    Renderer2,\r\n    ViewChild,\r\n    Inject\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiTabComponent } from './TiTabComponent';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\nimport { TiDroplistComponent } from '../droplist/TiDroplistModule';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiPositionType } from '../../utils/Position';\r\n/**\r\n * TiTabs组件属于布局组件，通过该组件产品可以实现不同视图的切换功能。\r\n *\r\n * 其内部包含2个组件 TiTab 和 TiTabHeader\r\n *\r\n * <example-url>../tiny3demo/#/tab/tab-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-tabs',\r\n    templateUrl: './tabs.html',\r\n    styleUrls: ['./tabs.less'],\r\n    host: {\r\n        '[class.ti3-tabs-container]': 'true' // 给host添加类ti-tabs-container替代之前的组件模板内部的最外层div\r\n    }\r\n})\r\nexport class TiTabsComponent extends TiBaseComponent implements AfterViewInit, AfterViewChecked, OnInit, OnDestroy {\r\n    /**\r\n     * 1.\"justified\"(默认): 下拉框的宽度与输入框的宽度保持一致；\r\n     *\r\n     * 2.\"auto\": 下拉框的宽度根据下拉项的内容自动撑开；\r\n     *\r\n     * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于输入框的宽度)。例如：\"200px\"。\r\n     *\r\n     * 10.0.1新增\r\n     */\r\n    @Input() panelWidth: string = '100px';\r\n    /**\r\n     * 面板对齐方式\r\n     *\r\n     * 10.0.1新增\r\n     *\r\n     */\r\n    @Input() panelAlign: 'left' | 'right' = 'right';\r\n    /**\r\n     * 面板最大高度\r\n     *\r\n     * 10.0.1新增\r\n     *\r\n     */\r\n    @Input() panelMaxHeight: string;\r\n    /**\r\n     * 指定下拉项超长文本提示方向\r\n     *\r\n     * 10.0.1新增\r\n     *\r\n     */\r\n    @Input() tipPosition: TiPositionType = 'left';\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('slider', { static: true }) slider: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('tabContentContainer', { static: true }) tabContentContainer: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('more', { static: true }) moreRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('moreIcon', { static: true }) moreIconRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('tabsList', { static: true }) tabsListRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('tabsHeader', { static: true }) tabsHeaderRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('tabsContainer', { static: true }) tabsContainerRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('droplist', { static: true }) dropListComp: TiDroplistComponent;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public labelKey: string = 'header';\r\n    /**\r\n     * @ignore\r\n     * 下拉项\r\n     */\r\n    public options: Array<any> = [];\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onlistenClick: () => void;\r\n    /**\r\n     * @ignore\r\n     */\r\n    public windowResizeListener: () => void;\r\n    /**\r\n     * @ignore\r\n     * TiTabs中包裹的所有的 TiTabComponent 集合\r\n     */\r\n    public tabs: Array<TiTabComponent> = [];\r\n    /**\r\n     * @ignore\r\n     */\r\n    public selectedTab: TiTabComponent; // 当前选中的tab\r\n    private isNotVisibleInit: boolean = false; // 标志初始时是否可见\r\n    /**\r\n     * @ignore\r\n     * TiTabComponent.ts中使用\r\n     */\r\n    public destroyed: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * 是否显示滑动条slider（一级页签显示，二级/暗色页签不显示）\r\n     * TiTabHeaderComponent.ts中使用\r\n     */\r\n    public hasSlider: boolean = false;\r\n    /**\r\n     * @ignore\r\n     * TiTabHeaderComponent.ts中使用\r\n     */\r\n    public headerWidthChange: boolean = false;\r\n    private resolvedPromise: Promise<any> = Promise.resolve(null);\r\n    /**\r\n     * @ignore\r\n     * 下拉选项变更时触发\r\n     */\r\n    public onDroplistChange($event: any): void {\r\n        this.tabs.forEach((item: any) => {\r\n            if (item.id === this.selectedTab.id) {\r\n                this.setActiveValue(item, true);\r\n                this.activeTab(item, true);\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 点击下拉按钮打开下拉面板\r\n     */\r\n    public showMorePanel(event: MouseEvent): void {\r\n        this.dropListComp.show();\r\n        event.stopPropagation();\r\n    }\r\n    constructor(private elementRef: ElementRef, private renderer2: Renderer2,\r\n        public tiRenderer: TiRenderer, private zone: NgZone, @Inject(DOCUMENT) private document) {\r\n        super(elementRef, renderer2);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始化是否显示滑动条slider（一级页签显示，二级/暗色页签不显示）\r\n        this.hasSlider = !this.nativeElement.hasAttribute('level2') && !this.nativeElement.hasAttribute('dark');\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterContentInit();\r\n        if (this.hasSlider) {\r\n            // 如果祖先元素中display为none，获取到的组件的宽度为0,元素不可见\r\n            this.isNotVisibleInit = this.nativeElement.clientWidth === 0;\r\n        }\r\n        this.zone.runOutsideAngular(() => {\r\n            // 点击documnet优惠信息窗口关闭\r\n            this.onlistenClick = this.renderer2.listen(this.document, 'click', () => this.dropListComp.hide());\r\n            if (typeof window === 'undefined') {\r\n                return;\r\n            }\r\n            this.windowResizeListener = this.renderer2.listen(window, 'resize',\r\n                () => {\r\n                    this.setMoreStyle();\r\n                    this.setTabStyle(true);\r\n                });\r\n        });\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        // 初始祖先元素中display为none，之后第一次由none变成可见时，需要重置silder\r\n        if (this.isNotVisibleInit && this.nativeElement.clientWidth !== 0) {\r\n            this.setTabStyle(false);\r\n            this.isNotVisibleInit = false;\r\n\r\n            return;\r\n        }\r\n        // 此处执行晚于TiTabHeaderComponent的ngAfterViewChecked\r\n        if (this.headerWidthChange) {\r\n            this.setTabStyle(false);\r\n            this.headerWidthChange = false;\r\n            this.setMoreStyle();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.destroyed = true;\r\n        if (this.windowResizeListener) {\r\n            this.windowResizeListener();\r\n        }\r\n        if (this.onlistenClick) {\r\n            this.onlistenClick();\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    public setMoreStyle(): void {\r\n        if (this.isOverflow()) {\r\n            this.renderer2.setStyle(this.moreRef.nativeElement, 'display', 'block');\r\n        } else {\r\n            this.renderer2.setStyle(this.moreRef.nativeElement, 'display', 'none');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * TiTabComponent.ts 中调用\r\n     */\r\n    public addTab(tab: TiTabComponent): void {\r\n        if (tab.active) {\r\n            this.tabs.forEach((item: TiTabComponent) => {\r\n                if (item.active) {\r\n                    this.setActiveValue(item, false);\r\n                }\r\n            });\r\n        }\r\n        this.tabs.push(tab);\r\n        const tabElements: Array<any> = Array.from(this.tabContentContainer.nativeElement.children);\r\n        this.tabs.sort((a: TiTabComponent, b: TiTabComponent): number => {\r\n            return tabElements.indexOf(a.nativeElement) - tabElements.indexOf(b.nativeElement);\r\n        });\r\n        if (!tab.active && this.selectedTab\r\n            && tabElements.indexOf(tab.nativeElement) < tabElements.indexOf(this.selectedTab.nativeElement)) {\r\n            setTimeout(() => {\r\n                this.setTabStyle(true);\r\n            }, 0);\r\n        }\r\n        this.options = this.tabs;\r\n        setTimeout(() => {\r\n            this.setMoreStyle();\r\n        }, 0);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * TiTabComponent.ts 中调用\r\n     */\r\n    public removeTab(tab: TiTabComponent): void {\r\n        const index: number = this.tabs.indexOf(tab);\r\n        const length: number = this.tabs.length;\r\n        this.tabs.splice(index, 1);\r\n\r\n        setTimeout(() => {\r\n            this.setMoreStyle();\r\n        }, 0);\r\n\r\n        // 删除当前激活状态的tab\r\n        if (tab.active && length > 1) {\r\n            const newActiveIndex: number = this.getNewActiveIndex(index, length);\r\n            if (newActiveIndex !== -1) {\r\n                this.setActiveValue(this.tabs[newActiveIndex], true);\r\n                this.activeTab(this.tabs[newActiveIndex], true);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // 删除的是非激活状态的tab,那么就在删除后的tabs数组中查找剩下的哪一个tab是激活状态，再设置激活状态；\r\n        if (!tab.active) {\r\n            setTimeout(() => {\r\n                this.setTabStyle(true);\r\n            }, 0);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * TiTabComponent.ts 中调用\r\n     */\r\n    public activeTab(selectedTab: TiTabComponent, enableAnimate: boolean): void {\r\n        this.deActiveOthers(selectedTab);\r\n\r\n        selectedTab.loaded = true;\r\n\r\n        this.selectedTab = selectedTab;\r\n\r\n        // 只有不是灰化状态时，才触发切换动效\r\n        if (!selectedTab.disabled) {\r\n            // 添加定时器，处理ngFor未渲染完毕，获取到得silder的位置不准确\r\n            setTimeout(() => {\r\n                // 初始化激活时没有动效\r\n                this.setTabStyle(enableAnimate);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    private deActiveOthers(selectTab: TiTabComponent): void {\r\n        this.tabs.forEach((tab: TiTabComponent) => {\r\n            if (tab.active && tab !== selectTab) {\r\n                this.setActiveValue(tab, false);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public click(tab: TiTabComponent): void {\r\n        if (!tab.disabled && !tab.active) {\r\n            this.setActiveValue(tab, true);\r\n            this.activeTab(tab, true);\r\n        }\r\n    }\r\n\r\n    // 删除当前激活状态的tab后，需要激活下一个active tab\r\n    private getNewActiveIndex(index: number, length: number): number {\r\n        // 如果删除的当前激活状态的tab是最后一个，\r\n        // 那么下一个激活的tab就是从右到左第一个不是禁用的tab\r\n        if (index === length - 1) {\r\n            for (let i: number = index - 1; i >= 0; i--) {\r\n                if (!this.tabs[i].disabled) {\r\n                    return i;\r\n                }\r\n            }\r\n            // 如果删除的当前激活状态的tab不是最后一个，\r\n            // 那么下一个激活的tab就是从左到右第一个不是禁用的tab\r\n        } else {\r\n            for (let i: number = index; i < this.tabs.length; i++) {\r\n                if (!this.tabs[i].disabled) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    // 设置页签样式\r\n    private setTabStyle(enableAnimate: boolean): void {\r\n        const targetTab: any = this.selectedTab && this.selectedTab.headNode.parentNode.parentNode;\r\n        // 容错处理：没有获取到DOM时直接return；\r\n        if (Util.isUndefined(targetTab) || !targetTab.classList.contains('ti3-tab-li')) {\r\n            return;\r\n        }\r\n        // 获取该页签的偏移量\r\n        const tagetLeft: number = targetTab.offsetLeft;\r\n        // 需要显示滑动条时设置滑动条的样式及动效\r\n        if (this.hasSlider) {\r\n            // 修复SSR错误：ERROR TypeError: targetTab.getBoundingClientRect is not a function\r\n            const targetWidth: number = typeof(targetTab.getBoundingClientRect) === 'function' ? parseFloat(targetTab.getBoundingClientRect().width\r\n                .toFixed(2)) : 0;\r\n            const transitionSet: string = enableAnimate ? 'left 0.1s ease-in-out' : 'none';\r\n            this.tiRenderer.setStyles(this.slider.nativeElement, {\r\n                transition: transitionSet,\r\n                width: `${targetWidth}px`,\r\n                left: `${tagetLeft}px`\r\n            });\r\n        }\r\n        this.setTabScroll(targetTab, tagetLeft);\r\n    }\r\n    // 设置页签超长滑动动效\r\n    private setTabScroll(target: any, distance: number): void {\r\n        const moreWidth: number = this.moreRef && this.moreRef.nativeElement.offsetWidth;\r\n        const tabsHeaderWidth: number = this.tabsHeaderRef && this.tabsHeaderRef.nativeElement.offsetWidth;\r\n        const listWidth: number = this.tabsListRef && this.tabsListRef.nativeElement.offsetWidth;\r\n        // 修复SSR错误：ERROR TypeError: this.tabsContainerRef.nativeElement.getBoundingClientRect is not a function\r\n        if(typeof this.tabsContainerRef.nativeElement.getBoundingClientRect !== 'function'){\r\n            return;\r\n        }\r\n        const tabsContainerClientRect: any = this.tabsContainerRef && this.tabsContainerRef.nativeElement.getBoundingClientRect();\r\n        const targetClientRect: any = target.getBoundingClientRect();\r\n        // 1、条件1和2：激活项能在当前屏范围内完全显示时\r\n        // 2、尾部页签紧贴右侧时（页签动态删减，导致尾部页签没有紧贴右侧 #15412）\r\n        // 同时满足，tabs无需滑动\r\n        if (targetClientRect.x >= tabsContainerClientRect.x\r\n            && targetClientRect.x <= tabsContainerClientRect.x + tabsContainerClientRect.width - moreWidth - targetClientRect.width\r\n            && tabsHeaderWidth <= listWidth + moreWidth) {\r\n            return;\r\n        }\r\n\r\n        let marginLeftDistance: number = distance;\r\n        const maxDistance: number = this.tabsListRef.nativeElement.scrollWidth - tabsContainerClientRect.width + moreWidth;\r\n        if (maxDistance > 0) {\r\n            if (distance >= maxDistance) {\r\n                marginLeftDistance = maxDistance;\r\n            }\r\n        } else {\r\n            marginLeftDistance = 0;\r\n        }\r\n        this.renderer2.setStyle(this.tabsHeaderRef.nativeElement, 'transition', 'margin-left 0.1s ease-in-out');\r\n        this.renderer2.setStyle(this.tabsHeaderRef.nativeElement, 'margin-left', - marginLeftDistance + 'px');\r\n    }\r\n\r\n    private setActiveValue(tab: TiTabComponent, value: boolean): void {\r\n        // 双向数据绑定时，初始传入的值不合法立即修改并传出时会报错。\r\n        // 此处参考ngModel源码setValue的处理，使用promise延后执行时序\r\n        this.resolvedPromise.then(() => {\r\n            tab.active = value;\r\n            tab.activeChange.emit(value);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public trackByFn(index: number, item: any): Node {\r\n        return item.headNode;\r\n    }\r\n    // 空间不足时，出现下拉面板\r\n    private isOverflow(): boolean {\r\n        const headerWidth: number = this.tabsContainerRef.nativeElement.offsetWidth;\r\n        const listWidth: number = this.tabsListRef.nativeElement.scrollWidth;\r\n        const moreWidth: number = this.moreRef.nativeElement.offsetWidth;\r\n\r\n        return headerWidth - moreWidth < listWidth;\r\n    }\r\n\r\n}\r\n","import {\r\n    Component,\r\n    ContentChild,\r\n    ElementRef,\r\n    EventEmitter,\r\n    HostBinding,\r\n    Input,\r\n    OnChanges,\r\n    OnDestroy,\r\n    OnInit,\r\n    Output,\r\n    Renderer2,\r\n    SimpleChange,\r\n    SimpleChanges,\r\n    TemplateRef } from '@angular/core';\r\nimport { TiTabsComponent } from './TiTabsComponent';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\n/**\r\n * TiTabComponent 是单个页签组件，包含了页签标题头指令TiTabHeader 和 该页签对应的内容部分\r\n *\r\n */\r\n@Component({\r\n    selector: 'ti-tab',\r\n    templateUrl: './tab.html',\r\n    styleUrls: ['./tab.less'],\r\n    host: {\r\n        '[class.ti3-tab-pane]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiTabComponent extends TiBaseComponent implements OnInit, OnDestroy, OnChanges {\r\n    /**\r\n     * 设置当前页签标题头显示的文本\r\n     */\r\n    @Input() header: string;\r\n    /**\r\n     * 设置当前页签是否禁用置灰\r\n     */\r\n    @Input() disabled: boolean;\r\n    /**\r\n     * 设置当前页签是否处于激活状态。\r\n     *\r\n     * 此接口是双向绑定的，设置时中括号“[]”和圆括号“()”要同时使用\r\n     */\r\n    @Input() @HostBinding('class.ti3-tab-active') active: boolean;\r\n    /**\r\n     * 当前页签的激活状态发生改变时向外进行事件通知,传递的参数为 boolean 类型，表示当前页签是否是激活状态\r\n     */\r\n    @Output() readonly activeChange: EventEmitter<any> = new EventEmitter();\r\n    /**\r\n     * @ignore\r\n     * 获取到用户自定义的模板\r\n     */\r\n    @ContentChild('tiTabContent', /* TODO: add static flag */ { static: true }) public contentTemplate: TemplateRef<any>;\r\n    /**\r\n     * @ignore\r\n     * 当前页签标题头显示的node节点\r\n     */\r\n    public headNode: any;\r\n    /**\r\n     * @ignore\r\n     * 记录此页签的内容区是否已经加载过\r\n     */\r\n    public loaded: boolean = false;\r\n\r\n    constructor(private elementRef: ElementRef, private renderer2: Renderer2,\r\n                public tabset: TiTabsComponent) {\r\n            super(elementRef, renderer2);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.createHeadNode();\r\n        this.tabset.addTab(this);\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        super.ngOnChanges(changes);\r\n        const activeObj: SimpleChange = changes['active'];\r\n        if (activeObj && activeObj.currentValue && this.tabset.selectedTab !== this && !this.disabled) {\r\n            this.tabset.activeTab(this, !activeObj.firstChange);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        super.ngOnDestroy();\r\n        // 父容器TiTabs的OnDestroy执行晚于TiTab的OnDestroy，所以此处需要setTimeout来延时\r\n        setTimeout(() => {\r\n            if (this.tabset.destroyed) {\r\n                return;\r\n            }\r\n            this.tabset.removeTab(this);\r\n            // 如果没有tab，那么下划线隐藏\r\n            if (this.tabset.tabs.length === 0) {\r\n                this.tabset.tiRenderer.setStyles(this.tabset.slider.nativeElement, {\r\n                    width: 0,\r\n                    left: 0\r\n                });\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    private createHeadNode(): void {\r\n        if (Util.isString(this.header)) {\r\n            this.headNode = this.renderer2.createText(this.header);\r\n        }\r\n    }\r\n}\r\n","import {\r\n    AfterContentInit,\r\n    AfterViewChecked,\r\n    Component,\r\n    ElementRef } from '@angular/core';\r\nimport { TiTabComponent } from './TiTabComponent';\r\nimport { Util } from '../../utils/Util';\r\n/**\r\n * TiTabHeaderComponent 是单个页签的标题头组件，其包裹的元素会作为当前页签的标题头\r\n *\r\n */\r\n@Component({\r\n    selector: 'ti-tab-header',\r\n    templateUrl: './tab-head.html',\r\n    host: {\r\n        '[class.ti3-tab-head-no-outline]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiTabHeaderComponent implements AfterContentInit, AfterViewChecked {\r\n    private oldHeaderWidth: number;\r\n    constructor(private tab: TiTabComponent, private elementRef: ElementRef) {}\r\n\r\n    ngAfterContentInit(): void {\r\n        // 由于此处的AfterContentInit会比TiTabComponent组件的OnInit\r\n        // 执行得晚，所以ti-tab-header中的内容会覆盖header接口传入的字符串值\r\n        this.tab.headNode = this.elementRef.nativeElement;\r\n        if (!this.tab.header) {\r\n            // 处理自定义dom没有header接口时对应下拉面板展示\r\n            this.tab.header =  this.elementRef.nativeElement.innerText;\r\n        }\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        if (!this.tab.tabset.hasSlider) {\r\n            return;\r\n        }\r\n        if (Util.isUndefined(this.oldHeaderWidth)) {\r\n            this.oldHeaderWidth = this.elementRef.nativeElement.offsetWidth;\r\n\r\n            return;\r\n        }\r\n        const headerWidth: number = this.elementRef.nativeElement.offsetWidth;\r\n        if (headerWidth !== this.oldHeaderWidth) {\r\n            this.tab.tabset.headerWidthChange = true;\r\n            this.oldHeaderWidth = headerWidth;\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiTabsComponent } from './TiTabsComponent';\r\nimport { TiTabComponent } from './TiTabComponent';\r\nimport { TiTabHeaderComponent } from './TiTabHeaderComponent';\r\nimport { TiIncludeModule } from '../../directives/include/TiIncludeModule';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiDroplistModule } from '../droplist/TiDroplistModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDroplistModule,\r\n    TiIconModule,\r\n    TiIncludeModule,\r\n    TiRendererModule\r\n  ],\r\n  exports: [TiTabsComponent, TiTabComponent, TiTabHeaderComponent],\r\n  declarations: [TiTabsComponent, TiTabComponent, TiTabHeaderComponent]\r\n})\r\nexport class TiTabModule {\r\n}\r\nexport { TiTabComponent } from './TiTabComponent';\r\nexport { TiTabsComponent } from './TiTabsComponent';\r\nexport { TiTabHeaderComponent } from './TiTabHeaderComponent';","import {\r\n      Component,\r\n      ContentChild,\r\n      ElementRef,\r\n      Input,\r\n      TemplateRef,\r\n      ViewChild\r\n} from '@angular/core';\r\nimport { TiDominatorComponent } from '../dominator/TiDominatorModule';\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiDropsearchComponent } from '../dropsearch/TiDropsearchModule';\r\nimport { TiKeymap } from '../../utils/Util';\r\n/**\r\n * TagsInput标签输入组件\r\n *\r\n * TagsInput组件主要实现了一个可以输入标签、可以联想选择标签的功能组件。\r\n *\r\n * <example-url>../tiny3demo/#/tagsinput/tagsinput-all</example-url>\r\n */\r\n@Component({\r\n      selector: 'ti-tags-input',\r\n      templateUrl: './tagsinput.html',\r\n      styleUrls: ['./tagsinput.less'],\r\n      providers: [TiFormComponent.getValueAccessor(TiTagsInputComponent)]\r\n})\r\n\r\nexport class TiTagsInputComponent extends TiFormComponent {\r\n      /**\r\n       * 设置联想词条列表的数据\r\n       */\r\n      @Input() suggestions: Array<any> = [];\r\n      /**\r\n       * 设置输入框提示,在设置提示内容，并且无选中项时显示\r\n       */\r\n      @Input() placeholder: string = '';\r\n      /**\r\n       * 设置下拉面板的宽度,默认与dominator对齐 'justified' | 'auto'| string\r\n       */\r\n      @Input() panelWidth: string = 'justified';\r\n      /**\r\n       * 支持指定属性作为显示文本\r\n       */\r\n      @Input() labelKey: string = 'label';\r\n\r\n      /**\r\n       * @ignore\r\n       * 内部的input标签\r\n       */\r\n      @ViewChild('input', { static: true }) public inputRef: ElementRef;\r\n      /**\r\n       * @ignore\r\n       * 用户写的item模板\r\n       */\r\n      @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n      /**\r\n       * @ignore\r\n       * 内部标签donimator组件\r\n       */\r\n      @ViewChild(TiDominatorComponent, { static: true }) dominatorCom: TiDominatorComponent;\r\n      /**\r\n       * @ignore\r\n       * 内部标签selectDrop组件\r\n       */\r\n      @ViewChild(TiDropsearchComponent, { static: true }) selectDrop: TiDropsearchComponent;\r\n      /**\r\n       * @ignore\r\n       * input输入框的值\r\n       */\r\n      public inputValue: string = ''; // 输入框内容\r\n\r\n      ngAfterViewInit(): void {\r\n            super.ngAfterViewInit();\r\n            // 推荐在onInit()时调用setFocusableElems(), 但是ngFor/ngIf中的元素在ngAfterViewInit()才能获取到\r\n            this.setFocusableElems([this.dominatorCom.nativeElement, this.inputRef.nativeElement]);\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 处理select事件\r\n       */\r\n      onSelect(event: any): void {\r\n            this.model.push(event);\r\n            this.model = this.model.concat();\r\n            this.selectDrop.searchResult = this.getSuggestions(this.suggestions, this.model);\r\n\r\n            // 清空输入框\r\n            this.inputValue = '';\r\n            // 选中项由一行变为两行时，需要重定位\r\n            setTimeout(() => {\r\n                  this.selectDrop.rePosition();\r\n            }, 0);\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 处理点击Dominator事件\r\n       */\r\n      onClickDominator(): void {\r\n            if (this.disabled) {\r\n                  return;\r\n            }\r\n\r\n            this.inputRef.nativeElement.focus();\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 点击选中项的叉号:从选中项中移除当前选中项\r\n       */\r\n      onDelete(event: { item: any; model: any }): void {\r\n            this.inputRef.nativeElement.focus();\r\n            // 选中项由两行变为一行时，需要重定位\r\n            setTimeout(() => {\r\n                  this.selectDrop.rePosition();\r\n              }, 0);\r\n            this.selectDrop.searchResult = this.getSuggestions(this.suggestions, event.model);\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 输入框失焦时，面板隐藏，根据文本框内容处理是否添加到选中项\r\n       */\r\n      onInputBlur(): void {\r\n            this.selectDrop.hide();\r\n            const value: string = this.inputValue;\r\n\r\n            // 清空输入框\r\n            this.inputValue = '';\r\n\r\n            // 输入框为空时或者当前输入框内容对应的标签已经在选中列表中了\r\n            if (value.trim() === '' || this.findFirstIndex(this.model, 'label', value) !== -1) {\r\n                  return;\r\n            }\r\n            // 将输入框内容添加到选中标签中\r\n            this.addTagToSelected(value);\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 处理input框聚焦事件\r\n       */\r\n      onInputFocus(event: FocusEvent): void {\r\n            this.selectDrop.searchResult = this.getSuggestions(this.suggestions, this.model);\r\n            // 视图绘制早于变量更新，变量更新后下拉定位不正确， 需要延时处理\r\n            setTimeout(() => {\r\n                  this.showSelectDrop();\r\n            }, 0);\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 处理input输入框keyup快捷键功能\r\n       */\r\n      onInputKeyup(event: KeyboardEvent): void {\r\n            if (event.keyCode === TiKeymap.KEY_ENTER || event.keyCode === TiKeymap.KEY_NUMPAD_ENTER) {\r\n                  this.responseEnter(event);\r\n            }\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 处理input输入框keydown快捷键功能\r\n       * 回删键只能在keydown中处理：因为回删时，在keydown时输入框为当前值，keyup时为删除后的值\r\n       * 比如输入一个字符，回删，获取的应该是回删前的一个字符，而不是没有删除后的\r\n       */\r\n      onInputKeydown(event: KeyboardEvent): void {\r\n            if (event.keyCode === TiKeymap.KEY_BACKSPACE) {\r\n                  this.responseBackspace(event);\r\n            }\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 输入框内容变化时的处理\r\n       * @param inputValue\r\n       */\r\n      onInputChange(inputValue: string): void {\r\n            // 过滤出匹配项\r\n            this.selectDrop.searchWordChange(inputValue);\r\n            // 从匹配项中移除已选中项\r\n            this.selectDrop.searchResult = this.getSuggestions(this.selectDrop.searchResult, this.model);\r\n            // 当没有匹配项时面板隐藏\r\n            if (this.selectDrop.searchResult.length === 0) {\r\n                  this.selectDrop.hide();\r\n            }\r\n      }\r\n\r\n      /**\r\n       * 处理input输入框enter键功能\r\n       * @param event\r\n       */\r\n      private responseEnter(event: KeyboardEvent): void {\r\n            this.selectDrop.hide();\r\n            // 获取输入框的值\r\n            const value: string = this.inputValue;\r\n            // 清空input框的内容\r\n            this.inputValue = '';\r\n\r\n            // 输入框为空时或者当前输入框内容对应的标签已经在选中列表中了\r\n            if (value.trim() === '' || this.findFirstIndex(this.model, 'label', value) !== -1) {\r\n                  this.showSelectDrop();\r\n\r\n                  return;\r\n            }\r\n\r\n            // 将输入框内容添加到选中标签中\r\n            this.addTagToSelected(value);\r\n            // 将选中项与下拉选项对比，从下拉选项中提出选中项\r\n            this.selectDrop.searchResult = this.getSuggestions(this.suggestions, this.model);\r\n            this.showSelectDrop();\r\n      }\r\n\r\n      /**\r\n       * 处理input输入框回删键功能\r\n       * @param event\r\n       */\r\n      private responseBackspace(event: KeyboardEvent): void {\r\n            this.selectDrop.hide();\r\n            // 面板关闭时\r\n            if (!this.selectDrop.isShow) {\r\n                  this.showSelectDrop();\r\n                  // 选中项由两行变为一行时，需要重定位\r\n                  setTimeout(() => {\r\n                        this.selectDrop.rePosition();\r\n                  }, 0);\r\n            }\r\n            const value: string = this.inputRef.nativeElement.value;\r\n            // 输入框值不为空字符串时\r\n            if (value !== '') {\r\n                  return;\r\n            }\r\n\r\n            // 获取当前选中项的长度\r\n            const modelLength: number = this.model.length;\r\n\r\n            // 当前已经没有选中项时，不做处理\r\n            if (modelLength === 0) {\r\n                  return;\r\n            }\r\n\r\n            const lastSelected: any = this.model[modelLength - 1];\r\n            const index: number = this.suggestions.indexOf(lastSelected);\r\n            // 从选中项中删除\r\n            this.model.pop();\r\n            this.model = this.model.concat();\r\n\r\n            // 将要从选中项删除的最后一项是下拉选项中的一项时，将其添加到现有的下拉选项中;\r\n            // 如果是用户自己创建的，则不放入下拉项中\r\n            if (index !== -1) {\r\n                  this.selectDrop.searchResult = this.getSuggestions(this.suggestions, this.model);\r\n            }\r\n      }\r\n\r\n      /**\r\n       * 根据数组中属性找是否有匹配项\r\n       * @param arr 需要匹配的数组\r\n       * @param key 需要查找的属性\r\n       * @param value 属性值\r\n       * @returns\r\n       */\r\n      private findFirstIndex(arr: any, key: string, value: string): number {\r\n            if (!(arr instanceof Array)) {\r\n                  return -1;\r\n            }\r\n\r\n            for (let i: number = 0; i < arr.length; i++) {\r\n                  if (arr[i][key] === value) {\r\n                        return i;\r\n                  }\r\n            }\r\n\r\n            return -1;\r\n      }\r\n\r\n      /**\r\n       * 将输入框内容添加到选中标签中\r\n       * @param inputValue 输入框的内容\r\n       */\r\n      private addTagToSelected(inputValue: string): void {\r\n            const index: number = this.findFirstIndex(this.suggestions, 'label', inputValue);\r\n            const newTag: any = index === -1 ? { id: inputValue, label: inputValue } : this.suggestions[index];\r\n            this.model.push(newTag);\r\n            this.model = this.model.concat();\r\n      }\r\n\r\n      /**\r\n       * 从suggestions中删除选中项\r\n       */\r\n      private getSuggestions(suggestions: any, selected: any): Array<any> {\r\n            const newSuggestions: any = !(suggestions instanceof Array) ? [] : suggestions.concat(); // 使用数组的concat方法，实现深拷贝\r\n\r\n            let index: number;\r\n            for (const select of selected) {\r\n                  index = newSuggestions.indexOf(select);\r\n\r\n                  if (index !== -1) { // 选中项如果在下拉列表中存在，则删除\r\n                        newSuggestions.splice(index, 1);\r\n                  }\r\n            }\r\n\r\n            return newSuggestions;\r\n      }\r\n\r\n      /**\r\n       * @ignore\r\n       * 展开面板时设置下拉选中项和hoverOption\r\n       */\r\n      public showSelectDrop(): void {\r\n            // 设置selectDrop的选中项\r\n            this.selectDrop.listCom.model = undefined;\r\n\r\n            // 显示下拉面板\r\n            if (this.selectDrop.searchResult.length > 0) {\r\n                  this.selectDrop.show();\r\n            }\r\n\r\n            // 不设置待选中项\r\n            this.selectDrop.listCom.hoverOption = undefined;\r\n      }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiTagsInputComponent } from './TiTagsInputComponent';\r\nimport { TiDropsearchModule } from '../dropsearch/TiDropsearchModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiDominatorModule } from '../dominator/TiDominatorModule';\r\n/**\r\n *\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    TiDominatorModule,\r\n    TiDropsearchModule,\r\n    TiTextModule\r\n  ],\r\n  exports: [TiTagsInputComponent],\r\n  declarations: [TiTagsInputComponent]\r\n})\r\nexport class TiTagsInputModule {\r\n}\r\nexport { TiTagsInputComponent } from './TiTagsInputComponent';\r\n","import {\r\n    AfterViewChecked,\r\n    AfterViewInit,\r\n    Component,\r\n    DoCheck,\r\n    ElementRef,\r\n    Input,\r\n    NgZone,\r\n    OnDestroy,\r\n    OnInit,\r\n    Optional,\r\n    Renderer2,\r\n    ViewChild,\r\n    ViewEncapsulation,\r\n    Inject\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\nimport { TiAutofocusComponent } from '../base/TiBaseModule';\r\nimport { NgControl } from '@angular/forms';\r\n\r\n/**\r\n * Textarea文本框组件\r\n *\r\n * 文本框组件基于原生textarea标签进行扩展，原生textarea加tiTextarea属性指令即为textarea组件。\r\n *\r\n * <example-url>../tiny3demo/#/textarea/textarea-all</example-url>\r\n */\r\n@Component({\r\n    // tslint:disable-next-line:component-selector\r\n    selector: '[tiTextarea]', // 指定组件名称\r\n    templateUrl: './textarea.html', // 指定组件模板\r\n    styleUrls: ['./textarea.less'], // 样式路径\r\n    host: {\r\n        '(focus)': 'onFocus()'\r\n    },\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\n\r\nexport class TiTextareaComponent extends TiAutofocusComponent implements OnInit, AfterViewChecked, AfterViewInit, DoCheck, OnDestroy {\r\n    /**\r\n     * 用来调整文本框大小，该属性提供了四个属性值:\r\n     *\r\n     * none(不可调整组件大小):\r\n     *\r\n     * vertical(仅可调整垂直方向的大小，即调整组件的高度)\r\n     *\r\n     * horizontal(仅可调节水平方向的大小，即调整组件的宽度)\r\n     *\r\n     * both(水平和垂直方向均可调节，宽高都可调节)\r\n     */\r\n    @Input() resize: 'none' | 'vertical' | 'horizontal' | 'both' = 'both';\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('resize') private resizeIconRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('maxlength') private eleCharacterRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('charactersCount') private charactersCountRef: ElementRef;\r\n    /**\r\n     * @ignore\r\n     * 是否设置maxlength属性\r\n     */\r\n    public hasMaxlength: boolean;\r\n    /**\r\n     * @ignore\r\n     * 用户设置的最大值\r\n     */\r\n    public maxLength: number;\r\n    /**\r\n     * @ignore\r\n     * 当前输入内容的长度\r\n     */\r\n    public countLength: number;\r\n    // 用作拖动文本框大小\r\n    private options: any = {\r\n        $target: undefined,\r\n        storeWidth: 0,\r\n        storeHeight: 0,\r\n        mouseXPosition: 0,\r\n        mouseYPosition: 0\r\n    };\r\n    // 默认最大最小宽高\r\n    private defaultStyle: any = {\r\n        minWidth: 60,\r\n        minHeight: 64,\r\n        maxWidth: 1280,\r\n        maxHeight: 9999\r\n    };\r\n    private element: HTMLTextAreaElement; // 宿主元素\r\n    private attrs: NamedNodeMap; // 宿主元素的属性\r\n    private container: HTMLDivElement; // 创建div标签\r\n    private textAreaMinWidth: number; // 最小宽度\r\n    private textAreaMinHeight: number; // 最小高度\r\n    private textAreaMaxWidth: number; // 最大宽度\r\n    private textAreaMaxHeight: number; // 最大高度\r\n    private isVisibleInit: boolean; // 标志初始时是否可见\r\n    private isFirstFocus: boolean = true; // 是否为第一次聚焦\r\n    private documentMouseMoveListener: () => void;\r\n    private documentMouseUpListener: () => void;\r\n\r\n    constructor(elementRef: ElementRef,\r\n                renderer: Renderer2,\r\n                private zone: NgZone,\r\n                @Optional() private formControl: NgControl,\r\n                @Inject(DOCUMENT) private document) {\r\n        super(elementRef, renderer);\r\n        this.element = elementRef.nativeElement; // 获取宿主元素\r\n        this.attrs = this.element.attributes; // 可以根据属性名获取各个属性\r\n        this.container = this.renderer.createElement('div'); // 创建div标签\r\n        this.renderer.addClass(this.container, 'ti3-textarea-container');\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 初始化maxlength属性\r\n        this.hasMaxlength = Util.isUndefined(this.attrs['maxlength']) ? false : true;\r\n        // 原生不设置maxlength属性时该值为-1;\r\n        this.maxLength = this.hasMaxlength ? this.element.maxLength : -1;\r\n        // 文本框的值发生变化时触发\r\n        // 使用ngModel初始赋值时，触发valueChanges。\r\n        // 使用formControl初始赋值时，不会触发valueChanges。\r\n        if (this.formControl) {\r\n            this.formControl.valueChanges.subscribe((value: any) => {\r\n                this.setCountLength();\r\n            });\r\n        }\r\n\r\n        // 使用formControl初始赋值时，初始化不会触发valueChanges，所以此处额外执行一次。\r\n        // 使用ngModel初始赋值时，此处通过this.element.value拿到的值为空字符串，无法正确显示当前输入内容的长度\r\n        this.setCountLength();\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        // 如果祖先元素中display为none，获取到的组件的宽度为0,元素不可见\r\n        this.isVisibleInit = this.element.offsetWidth !== 0;\r\n        if (this.isVisibleInit) {\r\n            // 设置container的样式\r\n            this.setContainerSize();\r\n            // 初始化创建dom\r\n            this.initFn();\r\n        }\r\n\r\n        // 将宿主元素的样式类移到container上\r\n        this.setContainerClass();\r\n\r\n        // maxLength接口添加样式\r\n        this.setMaxLengthFn();\r\n\r\n        // 处理resize功能\r\n        this.resizeFn();\r\n        // 上面执行完初始化dom后，调用父类的ngAfterViewInit去设置autofocus\r\n        super.ngAfterViewInit();\r\n    }\r\n\r\n    ngAfterViewChecked(): void {\r\n        // 初始祖先元素中display为none，之后第一次由none变成可见时，需要重置silder\r\n        if (!this.isVisibleInit && this.element.offsetWidth !== 0) {\r\n            this.setContainerSize();\r\n            // 初始化创建dom\r\n            this.initFn();\r\n            this.isVisibleInit = true;\r\n        }\r\n\r\n        // 处理灰化功能\r\n        if (this.element.disabled) {\r\n            this.renderer.addClass(this.container, 'ti3-textarea-container-disable');\r\n        } else {\r\n            this.renderer.removeClass(this.container, 'ti3-textarea-container-disable');\r\n        }\r\n        // 修复SSR报错：ERROR ReferenceError: getComputedStyle is not defined\r\n        if(typeof getComputedStyle === 'undefined'){\r\n            return;\r\n        }\r\n        // 处理通过设置display的方式隐藏组件：内部生成的dom也需要隐藏\r\n        if (getComputedStyle(this.element).display === 'none') {\r\n            this.renderer.setStyle(this.container, 'display', 'none');\r\n        } else {\r\n            this.renderer.setStyle(this.container, 'display', 'block');\r\n        }\r\n    }\r\n    // maxlength通过接口传值需触发重新判断，因为init函数中执行较早且只执行一次。\r\n    ngDoCheck(): void {\r\n        this.hasMaxlength = Util.isUndefined(this.attrs['maxlength']) ? false : true;\r\n        this.maxLength = this.hasMaxlength ? this.element.maxLength : -1;\r\n    }\r\n\r\n    // 销毁组件时需要将内部生成dom也移除\r\n    ngOnDestroy(): void {\r\n        this.renderer.removeChild(this.renderer.parentNode(this.container), this.container);\r\n        if (this.documentMouseMoveListener) {\r\n            this.documentMouseMoveListener();\r\n        }\r\n        if (this.documentMouseUpListener) {\r\n            this.documentMouseUpListener();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public onFocus(): void {\r\n        // IE和火狐浏览器在首次autofoucus聚焦时会将光标移到文字起始位置，用户体验不好\r\n        // 需要手动设置光标位置到行尾\r\n        if (this.isFirstFocus && this.element.autofocus &&\r\n            (TiBrowser.isFirefox() || TiBrowser.isIE())) {\r\n            this.element.setSelectionRange(this.element.value.length,\r\n                this.element.value.length);\r\n        }\r\n        this.isFirstFocus = false;\r\n    }\r\n\r\n    private setContainerSize(): void {\r\n        // 修正SSR错误：ERROR ReferenceError: getComputedStyle is not defined\r\n        if (typeof getComputedStyle === 'undefined') {\r\n            return;\r\n        }\r\n        const containerHeight: string = getComputedStyle(this.element).height;\r\n        const containerWidth: string = getComputedStyle(this.element).width;\r\n         // 若服务在textarea上面设置margin外边距,会导致textarea所占的页面空间大于外框的宽高,所以要将textarea上设置的margin转移到外边框\r\n        const containerMargin: string = this.element.style.margin;\r\n\r\n        // 取掉宿主元素的margin属性:\r\n        this.element.style.margin = '';\r\n\r\n        // 设置this.container的width、height、margin\r\n        this.renderer.setStyle(this.container, 'height', containerHeight);\r\n        this.renderer.setStyle(this.container, 'width', containerWidth);\r\n        this.renderer.setStyle(this.container, 'margin', containerMargin);\r\n    }\r\n\r\n    private setContainerClass(): void {\r\n      // 获取未经过angular解析后的属性需要在onint中处理：若服务在textarea添加class，则把其加到父容器上\r\n      const cNames: string = this.element.className;\r\n      if (cNames) {\r\n        const cNameArr: Array<string> = this.element.className.split(' '); // 存在多个class\r\n        for (const cName of cNameArr) {\r\n            // 跟校验有关的样式是以\"ng-\"开头，如果转移到外部容器上会影响校验样式\r\n            if (!/^ng-/.test(cName)) {\r\n                this.renderer.removeClass(this.element, cName);\r\n                this.renderer.addClass(this.container, cName);\r\n            }\r\n        }\r\n      }\r\n    }\r\n\r\n    // 初始化创建dom\r\n    private initFn(): void {\r\n        const pNode: any = this.renderer.parentNode(this.element); // 找到宿主元素父元素\r\n        const nextNode: any = this.renderer.nextSibling(this.element); // 找到宿主元素的兄弟元素\r\n\r\n        // 将宿主元素包裹在this.container里边：\r\n        this.renderer.removeChild(pNode, this.element); // 从父元素中移除宿主元素\r\n        this.renderer.appendChild(this.container, this.element); // 将宿主元素放入创建的div标签中\r\n        this.renderer.insertBefore(pNode, this.container, nextNode);\r\n\r\n        if (this.resize !== 'none') {\r\n            this.moveNode(this.resizeIconRef.nativeElement);\r\n        }\r\n\r\n        if (this.hasMaxlength) {\r\n            this.moveNode(this.eleCharacterRef.nativeElement);\r\n        }\r\n\r\n    }\r\n\r\n    private moveNode(node: Element): void {\r\n        this.renderer.removeChild(this.element, node);\r\n        this.renderer.appendChild(this.container, node);\r\n    }\r\n\r\n    // maxLength接口\r\n    private setMaxLengthFn(): void {\r\n            // 添加字数限制与当前输入字数显示功能\r\n            if (this.attrs['maxlength'] && !isNaN(this.maxLength)) {\r\n                // 有maxlength限制时给外框div加上标志类 ti3-textarea-container-counter\r\n                this.renderer.addClass(this.container, 'ti3-textarea-container-counter');\r\n            } else {\r\n                this.renderer.removeClass(this.container, 'ti3-textarea-container-counter');\r\n            }\r\n    }\r\n\r\n    // resize接口\r\n    private resizeFn(): void {\r\n        if (this.resize === 'none') {\r\n            return;\r\n        }\r\n\r\n        this.textAreaMinWidth = this.getSizeNumber('minWidth');\r\n        this.textAreaMinHeight = this.getSizeNumber('minHeight');\r\n        this.textAreaMaxWidth = this.getSizeNumber('maxWidth');\r\n        this.textAreaMaxHeight = this.getSizeNumber('maxHeight');\r\n\r\n        // 清除textarea上的样式\r\n        this.renderer.setStyle(this.element, 'minWidth', '');\r\n        this.renderer.setStyle(this.element, 'minHeight', '');\r\n        this.renderer.setStyle(this.element, 'maxWidth', '');\r\n        this.renderer.setStyle(this.element, 'maxHeight', '');\r\n\r\n        this.zone.runOutsideAngular(() => { // 避免不停触发变化检测\r\n            // resizeIconRef模板的mousedown事件\r\n            this.renderer.listen(this.resizeIconRef.nativeElement, 'mousedown', ($event: MouseEvent) => {\r\n                this.renderer.addClass(this.element, 'ti3-textarea-resize-border'); // 拖拽时边框颜色为聚焦时\r\n                this.options.$target = $event.target;\r\n                this.options.mouseXPosition = $event.pageX;\r\n                this.options.mouseYPosition = $event.pageY;\r\n                // 在拖动前获取当前文本框最新的高度、宽度\r\n                this.updateTextAreaSize();\r\n                // 给页面设置不可选样式，避免拖动时页面出现被选中的蓝色区域\r\n                this.toggleTextSelection(true);\r\n            });\r\n\r\n            // resizeIconRef模板的mouseup事件\r\n            this.renderer.listen(this.resizeIconRef.nativeElement, 'mouseup', ($event: MouseEvent) => {\r\n                this.renderer.removeClass(this.element, 'ti3-textarea-resize-border');\r\n            });\r\n\r\n            this.documentMouseMoveListener = this.renderer.listen(this.document, 'mousemove', this.mouseMoveHandlerFn);\r\n            this.documentMouseUpListener = this.renderer.listen(this.document, 'mouseup', this.mouseUpHandlerFn);\r\n        });\r\n    }\r\n\r\n    private setCountLength(): void {\r\n        if (this.hasMaxlength) {\r\n            this.countLength = this.element.value.length;\r\n            // safari浏览器回车键是按两个字计算\r\n            if (TiBrowser.isSafari()) {\r\n                this.countLength = this.countLength + this.element.value.split('\\n').length - 1;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 拖动函数\r\n    private mouseMove(event: MouseEvent): void {\r\n       // 阻止调整文本框大小时文本框聚焦\r\n       event.preventDefault();\r\n       const width: number = this.options.storeWidth;\r\n       const height: number = this.options.storeHeight;\r\n       const horizonWidth: number = event.pageX - this.options.mouseXPosition;\r\n       const verticalHeight: number = event.pageY - this.options.mouseYPosition;\r\n\r\n       if (this.resize !== 'vertical' && (width + horizonWidth) >= this.textAreaMinWidth\r\n           && (width + horizonWidth) < this.textAreaMaxWidth) {\r\n           // 更新textarea宽度\r\n           this.options.storeWidth += horizonWidth;\r\n           // 调整width\r\n           this.renderer.setStyle(this.container, 'width', `${this.options.storeWidth}px`);\r\n       }\r\n\r\n       if (this.resize !== 'horizontal' && (height + verticalHeight) >= this.textAreaMinHeight\r\n           && (height + verticalHeight) < this.textAreaMaxHeight) {\r\n           // 更新textarea高度\r\n           this.options.storeHeight += verticalHeight;\r\n           this.renderer.setStyle(this.container, 'height', `${this.options.storeHeight}px`);\r\n       }\r\n\r\n       // 更新光标位置\r\n       this.options.mouseXPosition = event.pageX;\r\n       this.options.mouseYPosition = event.pageY;\r\n    }\r\n\r\n    private stopResize(): void {\r\n        this.options.mouseXPosition = 0;\r\n        this.options.mouseYPosition = 0;\r\n        this.updateTextAreaSize();\r\n        this.options.$target = null;\r\n    }\r\n\r\n    // 获取min-width、min-height等的样式值\r\n    private  getSizeNumber(value: string): number {\r\n        const val: string = this.element.style[value]; // 可实现获取样式\r\n\r\n        if (val !== 'none' && val !== '') {\r\n            return parseFloat(val.replace(/px/, ''));\r\n        }\r\n\r\n        return  this.defaultStyle[value];\r\n    }\r\n\r\n    // 在拖动前获取当前文本框最新的高度、宽度\r\n    private updateTextAreaSize(): void {\r\n        this.options.storeWidth = this.container.clientWidth;\r\n        this.options.storeHeight = this.container.clientHeight;\r\n    }\r\n\r\n    // 给页面设置不可选样式，避免拖动时页面出现被选中的蓝色区域\r\n    private toggleTextSelection(toggle: boolean): void {\r\n        const body: any = this.document.getElementsByTagName('body');\r\n        if (toggle) {\r\n            this.renderer.addClass(body[0], 'ti3-unselectable');\r\n            this.renderer.setAttribute(body[0], 'unselectable', 'on');\r\n        } else {\r\n            this.renderer.removeClass(body[0], 'ti3-unselectable');\r\n            this.renderer.removeAttribute(body[0], 'unselectable');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 绑定在document上的mouseMove事件\r\n     */\r\n    public mouseMoveHandlerFn = ($event: MouseEvent): void => {\r\n        if (this.element.disabled) {\r\n            return;\r\n        }\r\n\r\n        // 拖动的动作应该是先mousedown，然后mousemove，因此先判断是否已经触发了mousedown\r\n        if (this.options.mouseXPosition === 0 && this.options.mouseYPosition === 0 || !this.options.$target) {\r\n            return;\r\n        }\r\n        this.mouseMove($event);\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 绑定在document上的mouseUp事件\r\n     */\r\n    public mouseUpHandlerFn = (): void => {\r\n        if (this.element.disabled) {\r\n            return;\r\n        }\r\n\r\n        // 解决问题：当拖动鼠标时，鼠标不在小三角上时，鼠标放开不会移除样式\r\n        // 为确保鼠标弹起时, textarea的边框样式恢复默认:\r\n        if (this.isResizing()) {\r\n            this.renderer.removeClass(this.element, 'ti3-textarea-resize-border');\r\n        }\r\n        try {\r\n            this.stopResize();\r\n            this.toggleTextSelection(false);\r\n        } catch (e) {}\r\n    }\r\n\r\n    private isResizing(): boolean {\r\n        return this.element.className.indexOf('ti3-textarea-resize-border') > -1;\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { TiLocaleFormat } from '../../locale/TiLocaleFormat';\r\n\r\n/**\r\n * @ignore\r\n * TiFormatNumPipe 对textarea字数统计的数字进行国际化处理\r\n *\r\n */\r\n@Pipe({ name: 'tiFormatNum' })\r\nexport class TiFormatNumPipe implements PipeTransform {\r\n    private numberFormat: string = '1.0-0'; // 整数位保留最小位数.小数位保留最小位数-小数位最大保留位置\r\n    transform(value: number): string {\r\n        return TiLocaleFormat.formatNumber(value, this.numberFormat);\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTextareaComponent } from './TiTextareaComponent';\r\nimport { TiFormatNumPipe } from './TiFormatNumPipe';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n  ],\r\n  exports: [TiTextareaComponent],\r\n  declarations: [TiTextareaComponent, TiFormatNumPipe]\r\n})\r\nexport class TiTextareaModule {\r\n\r\n}\r\nexport { TiTextareaComponent } from './TiTextareaComponent';\r\n","import { Util } from '../../utils/Util';\r\nimport { TiTreeNode, TiTreeDragNode } from './TiTreeComponent';\r\n/**\r\n *\r\n * 用于封装给树组件 [TiTreeComponent]{@link ../components/TiTreeComponent.html}\r\n * 提供公共方法，包括增、删、改、查、选中、取消选中、遍历、筛选、获取选中项等操作\r\n */\r\nexport class TiTreeUtil {\r\n    private static selectedData: Array<TiTreeNode> = [];\r\n    private static pnode: Array<TiTreeNode> = [];\r\n    /**\r\n     * 根据某node节点查找其父节点\r\n     * @param  data 所有节点数据\r\n     * @param node 已知node节点\r\n     */\r\n    public static getParentNode(data: Array<TiTreeNode>, node: TiTreeNode): TiTreeNode {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n\r\n        for (const item of data) {\r\n            if (!TiTreeUtil.isLeaf(item)) {\r\n                if (item.children.indexOf(node) !== -1) {\r\n                    return item;\r\n                } else {\r\n                    const result: TiTreeNode = TiTreeUtil.getParentNode(item.children, node);\r\n                    if (result) {\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 遍历整个树\r\n     * @param data 所有节点数据\r\n     * @param traverseFn 对各个节点执行的操作\r\n     */\r\n    public static traverse(data: Array<TiTreeNode>, traverseFn: Function): void {\r\n        if (!Util.isFunction(traverseFn) || !Array.isArray(data)) {\r\n            return;\r\n        }\r\n\r\n        for (const item of data) {\r\n            traverseFn(item);\r\n            if (!TiTreeUtil.isLeaf(item)) {\r\n                TiTreeUtil.traverse(item.children, traverseFn);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 多选树，更新各节点的选中状态。\r\n     * 适用场景：手动添加或删除若干节点，当前节点的兄弟节点和父节点的选中状态不一致。\r\n     * 10.0.1 新增\r\n     * @param data  所有节点数据\r\n     */\r\n    public static updateChecked(data: Array<TiTreeNode>): void {\r\n        TiTreeUtil.check(data);\r\n    }\r\n\r\n    /**\r\n     * 检查但前数据的多选状态\r\n     * @param data 当前节点集合\r\n     * @param allData 全部数据集合\r\n     */\r\n    private static check(data: Array<TiTreeNode>, allData?: Array<TiTreeNode>): void {\r\n        let resultData: Array<TiTreeNode>;\r\n        // 如果不传allData，data 是所有数据，此函数递归调用，data之后不是全部数据\r\n        resultData = !allData ? data : allData;\r\n        for (const item of data) {\r\n            if (!TiTreeUtil.isLeaf(item)) {\r\n                if (TiTreeUtil.isLeafsParentNode(item)) {\r\n                    // 根据子叶子节点计算当前节点的复选状态\r\n                    const computedChecked: boolean | string = TiTreeUtil.computeChecked(item);\r\n                    if (computedChecked !== item.checked) {\r\n                        item.checked = computedChecked;\r\n                        if (computedChecked === true) {\r\n                            TiTreeUtil.selectParents(item, resultData, true);\r\n                        } else {\r\n                            TiTreeUtil.deSelectParents(item, resultData);\r\n                        }\r\n                    }\r\n                } else {\r\n                    TiTreeUtil.check(item.children, resultData);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 当前节点是否是叶子节点的父节点，\r\n     * 因为更新节点的选中状态时，根据叶子节点的选中状态计算出父节点的选中状态，再更新父节点的选中状态。\r\n     * @param node 当前节点\r\n     */\r\n    private static isLeafsParentNode(node: TiTreeNode): boolean {\r\n        if (!Array.isArray(node.children)) {\r\n            return false;\r\n        } else {\r\n            for (const child of node.children) {\r\n                if (Array.isArray(child.children)) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            return true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据子节点的多选状态，计算出当前节点的多选状态\r\n     * @param node 当前节点\r\n     */\r\n    private static computeChecked(node: TiTreeNode): boolean | string {\r\n        const childrens: Array<TiTreeNode> = node.children;\r\n        let selectedNum: number = 0;\r\n        let unSelectedNum: number = 0;\r\n        for (const child of childrens) {\r\n            if (child.checked === true) {\r\n                selectedNum++;\r\n            } else if (!child.checked) { // false和undefined 两种\r\n                unSelectedNum++;\r\n            }\r\n        }\r\n        if (selectedNum === childrens.length) {\r\n            return true;\r\n        } else if (unSelectedNum === childrens.length) {\r\n            return false;\r\n        } else {\r\n            return 'indeterminate';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加节点\r\n     * @param data 所有节点数据\r\n     * @param node  需要添加的节点：一个或多个节点\r\n     * @param index  添加的位置: -1表示从尾部追加\r\n     * @param pNode 指定要添加的节点的父节点，如果没有指定的话默认添加到根节点\r\n     */\r\n    public static addNode(data: Array<TiTreeNode>, node: Array<TiTreeNode>, index: any, pNode?: TiTreeNode): void {\r\n        const k: number = parseInt(index, 10);\r\n        if (isNaN(k) || !Array.isArray(data)) {\r\n            return;\r\n        }\r\n\r\n        const nodes: Array<TiTreeNode> = Array.isArray(node) ? node : [node];\r\n        // 当没有指定父节点时，默认将节点添加到根节点\r\n        if (!pNode) {\r\n            const resuleIndex: any = index === -1 ? data.length : index;\r\n            for (let i: number = 0; i < nodes.length; i++) {\r\n                data.splice(resuleIndex + i, 0, nodes[i]);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // 如果父节点是叶子节点时，给叶子节点添加children数组\r\n        if (TiTreeUtil.isLeaf(pNode)) {\r\n            pNode.children = [];\r\n        }\r\n\r\n        // 根据Index值，将node插入指定位置\r\n        if (index === -1) {\r\n            pNode.children = pNode.children.concat(nodes); // 返回值为新数组\r\n        } else {\r\n            for (let j: number = 0; j < nodes.length; j++) {\r\n                pNode.children.splice(index + j, 0, nodes[j]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除一个节点\r\n     * @param  data 所有节点数据\r\n     * @param  node  节点\r\n     */\r\n    public static removeNode(data: Array<TiTreeNode>, node: TiTreeNode): void {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n\r\n        // 找到不匹配搜索内容的叶子节点并删除。为了避免要删除的元素在数组中的索引改变，从后向前循环\r\n        for (let i: number = data.length - 1; i >= 0; i--) {\r\n            if (data[i] === node) {\r\n                TiTreeUtil.deleteArr(data, i);\r\n\r\n                return;\r\n            }\r\n\r\n            if (!TiTreeUtil.isLeaf(data[i])) {\r\n                TiTreeUtil.removeNode(data[i].children, node);\r\n            }\r\n        }\r\n    }\r\n    // 3.0.3 selectNode/unSelectNode第三个参数：是否单选, 改为是否多选。已确认无人使用。\r\n    // TODO：这两个函数的重复代码，可以合并\r\n    /**\r\n     * 选中某个节点\r\n     * @param  data 所有节点数据\r\n     * @param  node  节点\r\n     * @param  multiple 是否多选模式\r\n     */\r\n    public static selectNode(data: Array<TiTreeNode>, node: TiTreeNode, multiple: boolean): void {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n        if (!multiple) { // 单选模式\r\n            TiTreeUtil.traverse(data, (travNode: TiTreeNode): void => {\r\n                travNode.checked = false; // 清空所有的选中项\r\n            });\r\n            node.checked = true; // 将当前项置为选中\r\n        } else { // 多选\r\n            TiTreeUtil.selectAllChildren(node); // 先置当前节点选中，如果当前节点是非叶子节点 递归让其子节点全部选中\r\n            TiTreeUtil.selectParents(node, data, true); // 设置父节点选中情况\r\n        }\r\n    }\r\n    // TODO:Tiny4 deselect改为unselect\r\n    /**\r\n     * 取消选中某个节点\r\n     * @param data 所有节点数据\r\n     * @param node  节点\r\n     * @param multiple 是否多选模式\r\n     */\r\n    public static deSelectNode(data: Array<TiTreeNode>, node: TiTreeNode, multiple: boolean): void {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n        if (!multiple) {\r\n            TiTreeUtil.traverse(data, (travNode: TiTreeNode): void => {\r\n                travNode.checked = false; // 清空所有的选中项\r\n            });\r\n        } else {\r\n            TiTreeUtil.deSelectAllChildren(node);\r\n            TiTreeUtil.deSelectParents(node, data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 展开id所有父节点\r\n     * @param  data 所有节点数据\r\n     * @param  node  节点\r\n     */\r\n    public static expandNode(data: Array<TiTreeNode>, node: TiTreeNode): boolean {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n\r\n        let num: number = 0;\r\n        let result: boolean = false;\r\n        for (const item of data) {\r\n            if (item === node) {\r\n                num++;\r\n            } else if (!TiTreeUtil.isLeaf(item)) {\r\n                result = TiTreeUtil.expandNode(item.children, node);\r\n                if (result) {\r\n                    item.expanded = true;\r\n                    num++;\r\n                }\r\n            }\r\n        }\r\n\r\n        return (num > 0);\r\n    }\r\n\r\n    /**\r\n     * 根据用户传入的方法筛选节点的数据\r\n     * @param data 所有节点数据\r\n     * @param  matchFn 用户传入匹配节点的方法\r\n     * @returns 是否找到\r\n     */\r\n    public static search(data: Array<TiTreeNode>, matchFn: (node: TiTreeNode) => boolean): boolean {\r\n        if (!Util.isFunction(matchFn) || !Array.isArray(data)) {\r\n            return false;\r\n        }\r\n\r\n        let findNum: number = 0;\r\n        let isFind: boolean = false;\r\n        // 找到不匹配搜索内容的叶子节点并删除。为了避免要删除的元素在数组中的索引改变，从后向前循环\r\n        for (let i: number = data.length - 1; i >= 0; i--) {\r\n            if (!matchFn(data[i]) && !TiTreeUtil.isLeaf(data[i])) { // 未匹配到且为父节点\r\n                isFind = TiTreeUtil.search(data[i].children, matchFn);\r\n                if (isFind) {\r\n                    findNum++;\r\n                } else {\r\n                    TiTreeUtil.deleteArr(data, i);\r\n                }\r\n            } else if (matchFn(data[i])) { // 匹配到\r\n                findNum++;\r\n            } else { // 未匹配到且为叶子节点\r\n                TiTreeUtil.deleteArr(data, i);\r\n            }\r\n        }\r\n\r\n        return (findNum > 0);\r\n    }\r\n\r\n    /**\r\n     * 获取选中项\r\n     * @param data 所有节点数据\r\n     * @param  onlySelectLeaf 选中项中是否只包含叶子节点\r\n     * @param  multiple 是否多选模式\r\n     */\r\n    public static getSelectedData(data: Array<TiTreeNode>, onlySelectLeaf: boolean, multiple: boolean): Array<TiTreeNode> {\r\n        // 每次遍历之前需要清空当前选中项列表\r\n        TiTreeUtil.selectedData = [];\r\n        TiTreeUtil.querySelectedNode(data, onlySelectLeaf, multiple);\r\n\r\n        return TiTreeUtil.selectedData;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 根据整棵树的节点数据，查询所有选中项，并更新selectedData\r\n     * @param data 全部节点数据\r\n     * @param onlySelectLeaf 全部节点数据\r\n     */\r\n    public static querySelectedNode(data: Array<TiTreeNode>, onlySelectLeaf: boolean, multiple: boolean): void {\r\n        let tempNode: any;\r\n        for (let i: number = 0; i < data.length; i++) {\r\n            tempNode = data[i];\r\n\r\n            if (TiTreeUtil.checkedParentNode(tempNode)) { // 父节点半选或选中\r\n                TiTreeUtil.pnode.push(tempNode);\r\n                TiTreeUtil.querySelectedNode(tempNode.children, onlySelectLeaf, multiple);\r\n\r\n                // 单选情况下仅查找到第一个选中的叶子节点即可\r\n                if (!multiple) {\r\n                    break;\r\n                }\r\n            } else if (TiTreeUtil.checkedLeafNode(tempNode)) { // 叶子节点选中\r\n                TiTreeUtil.selectedData.push(tempNode);\r\n\r\n                if (!onlySelectLeaf) {\r\n                    tempNode.parent = TiTreeUtil.pnode.concat();\r\n                    // 单选情况下仅查找到第一个选中的叶子节点即可\r\n                    if (!multiple) {\r\n                        TiTreeUtil.pnode.splice(0, TiTreeUtil.pnode.length);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // 遍历到最后一项时将父节点从pnode中移除\r\n            if (i === data.length - 1) {\r\n                TiTreeUtil.pnode.pop();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 判断节点node是否是一个处于选中或半选状态的父节点\r\n     * @param node 节点数据\r\n     */\r\n    public static checkedParentNode(node: TiTreeNode): boolean {\r\n        return (node.checked === true || node.checked === 'indeterminate') && !TiTreeUtil.isLeaf(node);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 判断节点node是否是一个处于选中状态的叶子节点\r\n     * @param node 节点数据\r\n     */\r\n    public static checkedLeafNode(node: TiTreeNode): boolean {\r\n        return (node.checked === true) && (TiTreeUtil.isLeaf(node));\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 判断是否为叶子节点\r\n     */\r\n    public static isLeaf(item: TiTreeNode): boolean {\r\n        return !(Util.isArray(item.children));\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 从数组arr中删除下标为index的节点\r\n     */\r\n    public static deleteArr(arr: Array<TiTreeNode>, index: number): void {\r\n        arr.splice(index, 1);\r\n    }\r\n    // TODO: checked传入false时，与deSelectParents有什么区别？可以合并么？\r\n    /**\r\n     * @ignore\r\n     * 当子节点选中时，设置祖先元素的选中状态\r\n     * @param item 子节点的数据\r\n     * @param allData 全部节点数据\r\n     * @param checked 取值为：true/false/'indeterminate'\r\n     */\r\n    public static selectParents(item: TiTreeNode, allData: Array<TiTreeNode>, checked: boolean | string): void {\r\n        const pNode: TiTreeNode = TiTreeUtil.getParentNode(allData, item);\r\n        if (Util.isUndefined(pNode)) {\r\n            return;\r\n        }\r\n\r\n        // 当子元素为半选时，祖先元素一律设置为半选状态\r\n        if (checked === 'indeterminate') {\r\n            pNode.checked = 'indeterminate';\r\n            TiTreeUtil.selectParents(pNode, allData, 'indeterminate');\r\n\r\n            return;\r\n        }\r\n\r\n        const childrens: Array<TiTreeNode> = pNode.children;\r\n        let selectedNum: number = 0;\r\n        for (const child of childrens) {\r\n            if (child.checked === true) {\r\n                selectedNum++;\r\n            }\r\n        }\r\n\r\n        if (selectedNum === childrens.length) {\r\n            pNode.checked = true;\r\n            TiTreeUtil.selectParents(pNode, allData, true);\r\n        } else {\r\n            pNode.checked = 'indeterminate';\r\n            TiTreeUtil.selectParents(pNode, allData, 'indeterminate');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 根据父节点选择子节点\r\n     */\r\n    public static selectAllChildren(item: TiTreeNode): void {\r\n        // 如果子节点是禁用状态不做处理；\r\n        if (item.disabled !== true) {\r\n            item.checked = true;\r\n        }\r\n\r\n        if (!TiTreeUtil.isLeaf(item)) {\r\n            item.children.forEach((child: TiTreeNode) => {\r\n                TiTreeUtil.selectAllChildren(child);\r\n            });\r\n        }\r\n    }\r\n\r\n    // TODO:Tiny4 deselect改为unselect\r\n    /**\r\n     * @ignore\r\n     * 多选状态下，父节点取消选中，置子节点都为取消选中状态\r\n     * @param item 子节点的数据\r\n     */\r\n    public static deSelectAllChildren(item: TiTreeNode): void {\r\n        if (item.disabled !== true) {\r\n            item.checked = false;\r\n        }\r\n        if (Util.isArray(item.children) && item.children.length > 0) {\r\n            item.children.forEach((child: TiTreeNode) => {\r\n                TiTreeUtil.deSelectAllChildren(child);\r\n            });\r\n        }\r\n    }\r\n\r\n    // TODO:Tiny4 deselect改为unselect\r\n    /**\r\n     * @ignore\r\n     * 当前节点取消选中时，设置祖先元素的选中状态\r\n     * @param item 当前节点的数据\r\n     * @param allData 全部的节点数据\r\n     */\r\n    public static deSelectParents(item: TiTreeNode, allData: Array<TiTreeNode>): void {\r\n        const pNode: TiTreeNode = TiTreeUtil.getParentNode(allData, item);\r\n        if (Util.isUndefined(pNode)) {\r\n            return;\r\n        }\r\n\r\n        const childrens: Array<TiTreeNode> = pNode.children;\r\n        let selectedNum: number = 0;\r\n        for (const child of childrens) {\r\n            if (child.checked === true || child.checked === 'indeterminate') {\r\n                selectedNum++;\r\n            }\r\n        }\r\n\r\n        if (selectedNum === 0) {\r\n            pNode.checked = false;\r\n            TiTreeUtil.deSelectParents(pNode, allData);\r\n        } else {\r\n            pNode.checked = 'indeterminate';\r\n            TiTreeUtil.selectParents(pNode, allData, 'indeterminate');\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * drop event\r\n     * @param event 拖拽数据\r\n     * @param data 所用节点数据\r\n     * @param multiple 多选\r\n     */\r\n    public static dropApply(event: TiTreeDragNode, data: Array<TiTreeNode>, multiple?: boolean) {\r\n        if (!Array.isArray(data)) {\r\n            return;\r\n        }\r\n        const dragNode: TiTreeNode = event.dragNode; // 拖拽节点\r\n        const dragParentNode: TiTreeNode = TiTreeUtil.getParentNode(data, dragNode); // 拖拽节点的父节点\r\n        const dropNode: TiTreeNode = event.targetNode; // 拖放节点\r\n        const dropParentNode: TiTreeNode = TiTreeUtil.getParentNode(data, dropNode); // 拖放节点的父节点\r\n        const dropPosition: number = event.dropPosition; // 拖拽位置\r\n        TiTreeUtil.removeNode(data, dragNode);\r\n        // 拖拽父节点无子节点时，删除children属性，此处是为解决当children为空时，展开收起图标还会存在的问题\r\n        if (dragParentNode?.children.length < 1) {\r\n            delete dragParentNode.children;\r\n        }\r\n        if (dropPosition === 0) {\r\n            TiTreeUtil.addNode(data, [dragNode], -1, dropNode);\r\n        } else {\r\n            let index: number;\r\n            if (!dropParentNode) { // 拖放节点为顶级级节点时\r\n                index = data.indexOf(dropNode);\r\n                if (dropPosition === -1) {\r\n                    data.splice(index, 0, dragNode);\r\n                } else {\r\n                    data.splice(index + 1, 0, dragNode);\r\n                }\r\n            } else {\r\n                index = dropParentNode.children.indexOf(dropNode);\r\n                if (dropPosition === -1) {\r\n                    TiTreeUtil.addNode(data, [dragNode], index , dropParentNode);\r\n                } else {\r\n                    TiTreeUtil.addNode(data, [dragNode], index + 1 , dropParentNode);\r\n                }\r\n            }\r\n        }\r\n        // 多选\r\n        if (multiple) {\r\n             TiTreeUtil.updateChecked(data);\r\n        }\r\n    }\r\n}\r\n","import { Component, ContentChild, ElementRef, EventEmitter, Input, IterableChanges, IterableDiffer,\r\n    IterableDiffers, Output, Renderer2, TemplateRef, ViewChildren, QueryList, ChangeDetectorRef} from '@angular/core';\r\nimport { Util, TiKeymap } from '../../utils/Util';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiTreeUtil } from './TiTreeUtil';\r\nimport { TiLocale  } from '../../locale/TiLocaleModule';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\n// TODO: 采用TiCheckgroup重构后，不需要那么多TreeUtil方法，不需要选中节点/取消选中节点方法。\r\n/**\r\n * 树组件中每个节点的配置\r\n */\r\nexport interface TiTreeNode {\r\n    /**\r\n     * 节点展示内容\r\n     */\r\n    label?: string;\r\n    /**\r\n     * 控制节点是否展开\r\n     */\r\n    expanded?: boolean;\r\n    /**\r\n     * 节点选中状态（多选场景）：选中，未选中，半选 true | false | 'indeterminate'\r\n     */\r\n    checked?: boolean | string;\r\n    /**\r\n     * 节点展开时的字体图标：节点图标的样式类名称\r\n     *\r\n     * 10.1.2版本之后可通过自定义模板添加图标及样式\r\n     */\r\n    expandIcon?: string;\r\n    /**\r\n     * 节点收起时的字体图标：节点图标的样式类名称\r\n     *\r\n     * 10.1.2版本之后可通过自定义模板添加图标及样式\r\n     */\r\n    collapseIcon?: string;\r\n    /**\r\n     * 控制多选的节点checkbox是否灰化\r\n     */\r\n    disabled?: boolean;\r\n    /**\r\n     * 子节点字段，一旦设置children: []，则认为该节点非叶子节点\r\n     */\r\n    children?: Array<TiTreeNode>;\r\n    /**\r\n     * 10.1.2 新增\r\n     * 异步加载状态，loading正在加载，error加载失败，success加载成功\r\n     */\r\n    loadStatus?: 'loading' | 'error' | 'success';\r\n    /**\r\n     * 10.1.4 新增\r\n     * 支持悬浮编辑功能\r\n     */\r\n    editable?: boolean;\r\n    /**\r\n     * 10.1.4 新增\r\n     * 支持悬浮增加功能\r\n     */\r\n    addable?: boolean;\r\n    /**\r\n     * 10.1.4 新增\r\n     * 支持悬浮删除功能\r\n     */\r\n    deleteable?: boolean;\r\n    /**\r\n     * 允许有多余的属性字段\r\n     */\r\n    [propName: string]: any;\r\n}\r\n/**\r\n * 10.1.4 新增\r\n * drag info\r\n */\r\nexport interface TiTreeDragNode {\r\n    /**\r\n     * 事件对象\r\n     */\r\n    event?: DragEvent,\r\n    /**\r\n     * 目标节点\r\n     */\r\n    targetNode?: TiTreeNode,\r\n    /**\r\n     * 被拖拽的节点\r\n     */\r\n    dragNode?: TiTreeNode,\r\n    /**\r\n     * 放置位置，-1代表当前节点前，0代表当前节点里面，1代表当前节点后\r\n     */\r\n    dropPosition?: number\r\n }\r\n/**\r\n * Tree树组件\r\n *\r\n * 分类：支持单选、多选两种类型\r\n *\r\n * 公共方法：树组件提供 [TiTreeUtil]{@link ../classes/TiTreeUtil.html} 公共方法，包括增、删、改、查、选中、取消选中、遍历、筛选、获取选中项等操作\r\n *\r\n * <example-url>../tiny3demo/#/tree/tree-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-tree',\r\n    templateUrl: './tree.html',\r\n    styleUrls: ['./tree.less'],\r\n})\r\nexport class TiTreeComponent extends TiBaseComponent {\r\n    /**\r\n     * Tree组件使用的数据\r\n     */\r\n    @Input() data: Array<TiTreeNode>;\r\n    /**\r\n     * 设置多选树时，父节点是否可被点击选中，默认父节点子节点都显示复选框，都可被选中，设置false时，只有子节点前边显示复选框。\r\n     */\r\n    @Input() parentCheckable: boolean = true;\r\n    /**\r\n     * 设置是否为多选。\r\n     */\r\n    @Input() multiple: boolean = false;\r\n    /**\r\n     * 当为多选时该接口才生效。\r\n     *\r\n     * 默认为 false, 当设置为 true 时：\r\n     *\r\n     * 1.点击文本，复选框状态不会改变，只会触发select事件；\r\n     *\r\n     * 2.点击复选框只会触发change事件；\r\n     *\r\n     * 3.复选框disabled时，点击文本会触发select事件。\r\n     *\r\n     * Tiny3.1.1-alpha新增。\r\n     */\r\n    @Input() changedByCheckbox: boolean = false;\r\n    /**\r\n     * 10.1.2 新增\r\n     * 搜索传入的值,对匹配的文本高亮显示\r\n     */\r\n    @Input() highlightWords: string;\r\n    /**\r\n     * 10.1.4 新增\r\n     * 支持拖放\r\n     */\r\n    @Input() nodeDraggable: boolean = false;\r\n    /**\r\n     * 树节点展开前的事件回调，一般用于异步数据获取\r\n     */\r\n    @Output() readonly beforeExpand: EventEmitter<TiTreeComponent> = new EventEmitter<TiTreeComponent>();\r\n    /**\r\n     * 当用户点击某一节点时触发的事件\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly select: EventEmitter<TiTreeNode> = new EventEmitter<TiTreeNode>();\r\n    /**\r\n     * 当前选中项发生变化时，触发change事件\r\n     */\r\n    // tslint:disable-next-line:no-output-named-after-standard-event\r\n    @Output() readonly change: EventEmitter<TiTreeNode> = new EventEmitter<TiTreeNode>();\r\n    /**\r\n     * 10.1.4 新增\r\n     * drop event\r\n     */\r\n    @Output() readonly nodeDrop: EventEmitter<TiTreeDragNode> = new EventEmitter<TiTreeDragNode>();\r\n    /**\r\n     * 10.1.4 新增\r\n     * 悬浮增加节点按钮回调\r\n     */\r\n    @Output() readonly nodeAdded: EventEmitter<TiTreeNode> = new EventEmitter<TiTreeNode>();\r\n    /**\r\n     * 10.1.4 新增\r\n     * 悬浮编辑节点按钮回调\r\n     */\r\n    @Output() readonly nodeEdited: EventEmitter<TiTreeNode> = new EventEmitter<TiTreeNode>();\r\n    /**\r\n     * 10.1.4 新增\r\n     * 悬浮删除节点按钮回调\r\n     */\r\n    @Output() readonly nodeDeleted: EventEmitter<TiTreeNode> = new EventEmitter<TiTreeNode>();\r\n    /**\r\n     * 用于异步场景：当前点击需要展开的父节点\r\n     */\r\n    private beforeExpandNode: TiTreeNode;\r\n    /**\r\n     * 监听data改变\r\n     */\r\n    private dataDiffer: IterableDiffer<any>;\r\n    /**\r\n     * @ignore\r\n     * 获取到用户自定义的模板\r\n     */\r\n    @ContentChild(TemplateRef, /* TODO: add static flag */ { static: true }) itemTemplate: TemplateRef<any>;\r\n    /**\r\n     * @ignore\r\n     * 获取文本区域dom集合\r\n     */\r\n    @ViewChildren('nodeList') elems: QueryList<ElementRef>;\r\n    /**\r\n     * @ignore\r\n     * 模板中使用，高亮的选中项\r\n     */\r\n    public actived: TiTreeNode;\r\n    /**\r\n     * @ignore\r\n     * 词条\r\n     */\r\n    public treeLan = TiLocale.getLocaleWords().tiTree;\r\n    /**\r\n     * 被拖拽节点\r\n     */\r\n    private dragNode: TiTreeNode;\r\n    /**\r\n     * 拖拽position\r\n     */\r\n    private dropPosition: number;\r\n    /**\r\n     * 拖放经过的节点\r\n     */\r\n    private overNode: TiTreeNode;\r\n    constructor(protected elementRef: ElementRef,\r\n                protected renderer2: Renderer2,\r\n                protected iterableDiffers: IterableDiffers,\r\n                private tiRenderer: TiRenderer,\r\n                private cdRef: ChangeDetectorRef) {\r\n                super(elementRef, renderer2);\r\n    }\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.dataDiffer = this.iterableDiffers.find(this.data)\r\n                .create();\r\n        // 内部使用的数据，用于记录用户的操作改变\r\n        // TODO: 仅在初始化时挡非法数据，是不够的。建议去除。但因为要兼容已发出的版本，所以不去除。\r\n        this.data = !Util.isArray(this.data) ? [] : this.data;\r\n        // 初始化默认选中项高亮\r\n        this.actived = this.initActived(this.data);\r\n    }\r\n    ngDoCheck(): void {\r\n        super.ngDoCheck();\r\n        const dataChanges: IterableChanges<TiTreeNode> = this.dataDiffer.diff(this.data);\r\n        if (dataChanges) {\r\n            // 重新初始化默认选中项高亮\r\n            this.actived = this.initActived(this.data);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @description 判断是否显示复选框\r\n     * @param node 节点数据\r\n     */\r\n    public showCheckboxFn(node: TiTreeNode): boolean {\r\n        if (this.multiple !== true) {\r\n            return false;\r\n        }\r\n\r\n        if (this.parentCheckable === true) {\r\n            return true;\r\n        }\r\n\r\n        return TiTreeUtil.isLeaf(node);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 点击父节点图标执行的逻辑\r\n     * @param  node 当前节点数据\r\n     */\r\n    public onClickPnodeIcon(node: TiTreeNode, event: MouseEvent): void {\r\n        if (node.disabled) {\r\n            return;\r\n        }\r\n        // 阻止事件冒泡：点击父节点图标无高亮样式\r\n        event.stopPropagation();\r\n        this.beforeExpandNode = node;\r\n        // 1.当前节点是展开状态\r\n        if (node.expanded) {\r\n            node.expanded = false;\r\n        } else if (this.beforeExpand.observers.length === 0) {  // 2.如果未定义beforeExpand事件(非异步)，点击时让节点展开\r\n            node.expanded = true;\r\n        } else { // 3.异步获取数据：将组件实例通知出去\r\n            this.beforeExpand.emit(this);\r\n        }\r\n    }\r\n\r\n    // 获取异步点击的节点\r\n    public getBeforeExpandNode(): TiTreeNode {\r\n        return this.beforeExpandNode;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 根据item的isExpanded属性获取item图标\r\n     * @param node 当前节点数据\r\n     */\r\n    public getItemIcon(node: TiTreeNode): string {\r\n        if (TiTreeUtil.isLeaf(node)) {\r\n            return `${node.expandIcon} ti3-tree-node-icon`;\r\n        }\r\n\r\n        return `${(node.expanded) ? node.expandIcon : node.collapseIcon} ti3-tree-node-icon`;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @description 点击复选框触发select、change事件\r\n     * 需要注意：click事件中拿到的是操作前的选中状态，而change事件中拿到的是操作后的选中状态\r\n     * @param node 当前节点数据\r\n     */\r\n    public onInputChange(node: TiTreeNode, event: Event): void {\r\n        if (node.disabled === true) {\r\n            return;\r\n        }\r\n        // 点击当前项高亮\r\n        this.actived = node;\r\n        this.setSeletedState(node, this.data, node.checked);\r\n        if (!this.changedByCheckbox) {\r\n            this.select.emit(node);\r\n        }\r\n        this.change.emit(node);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 点击文本区域\r\n     * @param node 当前节点数据\r\n     * @param event 鼠标事件\r\n     * @returns void\r\n     */\r\n    public onItemWrapperClick(node: TiTreeNode): void {\r\n        if (node.disabled === true || node.editing) {\r\n            return;\r\n        }\r\n        // 悬浮功能: 点击生成节点时，显示操作按钮\r\n        if (!node.editing) {\r\n            node.isHover = true;\r\n        }\r\n        // 点击当前项高亮\r\n        this.actived = node;\r\n        // 1.处理多选情况\r\n        if (this.multiple === true) {\r\n            if (this.changedByCheckbox) {\r\n                this.select.emit(node);\r\n\r\n                return;\r\n            }\r\n\r\n            // 1.1 处理父节点不支持多选\r\n            if (!this.showCheckboxFn(node)) {\r\n                return;\r\n            }\r\n\r\n            // 1.2 处理父节点支持多选\r\n            node.checked = !node.checked;\r\n            // 处理当前节点选中状态变化后，对父子节点的影响\r\n            this.setSeletedState(node, this.data, node.checked);\r\n            this.select.emit(node);\r\n            this.change.emit(node);\r\n\r\n            return;\r\n        }\r\n\r\n        // 2.处理单选场景\r\n        // 2.1(单选且已选中)或者(单选且非叶子节点)的情况下，点击只会触发select事件,因为当前选中项不会发生变化\r\n        if (node.checked === true || !TiTreeUtil.isLeaf(node)) {\r\n            // 触发select事件\r\n            this.select.emit(node);\r\n\r\n            return;\r\n        }\r\n\r\n        // 2.2单选叶子节点未选中\r\n        this.deSelectAllNode(this.data);\r\n        node.checked = true;\r\n        TiTreeUtil.selectParents(node, this.data, 'indeterminate'); // 设置祖先节点的选中状态\r\n\r\n        // 触发select和change事件\r\n        this.select.emit(node);\r\n\r\n        this.change.emit(node);\r\n    }\r\n\r\n\r\n    // 处理当前节点选中状态变化后，对父子节点的影响\r\n    private setSeletedState = (node: TiTreeNode, allData: Array<TiTreeNode>, checked: boolean | string): void => {\r\n        if (checked === true) {\r\n            TiTreeUtil.selectAllChildren(node);\r\n            TiTreeUtil.selectParents(node, allData, true);\r\n        } else {\r\n            TiTreeUtil.deSelectAllChildren(node);\r\n            TiTreeUtil.deSelectParents(node, allData);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 单选时，取消所有节点的选中状态\r\n     * @param  allData 所有节点数据\r\n     */\r\n    private deSelectAllNode = (allData: Array<TiTreeNode>): void => {\r\n        allData.forEach((node: TiTreeNode) => {\r\n            TiTreeUtil.deSelectAllChildren(node);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public trackByFn(index: number, node: any): any {\r\n        return index;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 判断是否为叶子节点\r\n     */\r\n    public isLeaf(node: TiTreeNode): boolean {\r\n        return !(Util.isArray(node.children));\r\n    }\r\n\r\n    // 初始化选中项高亮\r\n    private initActived = (data: Array<TiTreeNode>): any => {\r\n        let result: TiTreeNode;\r\n        for (const node of data) {\r\n            if (node.checked === true) {\r\n                return node;\r\n            }\r\n\r\n            if (!TiTreeUtil.isLeaf(node)) {\r\n                result = this.initActived(node.children);\r\n            }\r\n\r\n            if (!Util.isUndefined(result)) {\r\n                return result;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @param node 节点数据\r\n     */\r\n    public onBlur(node: TiTreeNode) {\r\n        if (node.focused) {\r\n            node.focused = false; // 失焦后节点删除获焦标志类\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @param node 节点数据\r\n     */\r\n    public onFocus(node: TiTreeNode) {\r\n        if (!node.focused && !node.disabled) {\r\n            node.focused = true; // 设置获焦标志类\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     * @param event 键盘事件\r\n     * @param node 当前节点数据\r\n     */\r\n    public onKeydown(event: KeyboardEvent, node: TiTreeNode): void {\r\n        /**\r\n         * 快捷键交互定义\r\n         * 1,tab键切换焦点至树组件的文本区域，复选框无需提供焦点，文本样式为文本悬浮态\r\n         * 2,树组件内部焦点切换支持上下左右键：\r\n         *    -上下键：按上下键可以在并列的节点移动，如无并列节点无法移动。\r\n         *    -左右键：展开收起节点及跨层级移动焦点。当焦点再子节点时，按左键可收起改节点，焦点移动至父节点；\r\n         *     当焦点在父节点上时，按右键可将焦点移动到启子节点上,如节点未展开则同时展开该子节点\r\n         * 3,Enter键或Space键：当焦点在节点名称上时，按下键则选中或取消该节点，选中后节点变为选中态\r\n         */\r\n        // 阻止默认和冒泡\r\n        if(\r\n            [TiKeymap.KEY_ENTER, TiKeymap.KEY_NUMPAD_ENTER, TiKeymap.KEY_SPACE, TiKeymap.KEY_ARROW_UP, TiKeymap.KEY_ARROW_DOWN,\r\n            TiKeymap.KEY_ARROW_LEFT, TiKeymap.KEY_ARROW_RIGHT].indexOf(event.keyCode) > -1\r\n        ) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        switch (event.keyCode) {\r\n            case TiKeymap.KEY_ENTER: // ENTER键\r\n            case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)\r\n            case TiKeymap.KEY_SPACE:\r\n                this.onItemWrapperClick(node);\r\n                break;\r\n            case TiKeymap.KEY_ARROW_UP: // 向上箭头，同级\r\n                this.setKeyDownUp(node, 'up');\r\n                break;\r\n            case TiKeymap.KEY_ARROW_DOWN: // 向下箭头，同级\r\n\r\n                this.setKeyDownUp(node, 'down');\r\n                break;\r\n            case TiKeymap.KEY_ARROW_LEFT: // 向左箭头，跨节点层级\r\n                this.setKeyleft(node);\r\n                break;\r\n            case TiKeymap.KEY_ARROW_RIGHT: // 向右箭头，跨节点层级\r\n                this.setKeyright(node);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    // 上下键\r\n    private setKeyDownUp(node: TiTreeNode, type: string) {\r\n        let parArr: Array<TiTreeNode>;\r\n        const pareNode: TiTreeNode = TiTreeUtil.getParentNode(this.data, node); // 获取父节点\r\n        if (pareNode) {\r\n            parArr = pareNode.children;\r\n        } else {\r\n            parArr = this.data;\r\n        }\r\n        const curIndex: number = parArr.findIndex((item: TiTreeNode) => item === node); // 获取当前节点在其父节点集合的index\r\n        this.setFocusNode(node, parArr, curIndex, type);\r\n    }\r\n    // 左键\r\n    private setKeyleft(node: TiTreeNode) {\r\n        // 当正在编辑时，关闭其父节点时，节点恢复文本状态\r\n        if (node.editing && node.label !== '') {\r\n            delete node.editing;\r\n        }\r\n        const pareNode: TiTreeNode = TiTreeUtil.getParentNode(this.data, node);\r\n        if (!pareNode) { // 当前节点时一级节点时 return\r\n            return;\r\n        }\r\n        pareNode.expanded = false;\r\n        if (pareNode.disabled) {\r\n            this.setKeyleft(pareNode);\r\n            return;\r\n        }\r\n        pareNode.focused = true;\r\n        this.setFocusElem(node);\r\n    }\r\n    // 右键\r\n    private setKeyright(node: TiTreeNode) {\r\n        if (TiTreeUtil.isLeaf(node)) {\r\n            return;\r\n        }\r\n        const childNodeArr: Array<TiTreeNode> = node.children;\r\n        const childnoDisabledArr:  Array<TiTreeNode> = childNodeArr.filter((childNode: TiTreeNode) => !childNode.disabled); // 获取子节点未禁用的节点集合\r\n        if (childnoDisabledArr.length < 1) {\r\n            return;\r\n        }\r\n        const childFirstNode: TiTreeNode = childnoDisabledArr[0]; // 未禁用的节点集合的first获取焦点\r\n        childFirstNode.focused = true;\r\n        if (!node.expanded) {\r\n            node.expanded = true;\r\n        }\r\n        this.setFocusElem(node);\r\n    }\r\n    // 上下键焦点处理\r\n    private setFocusNode(node: TiTreeNode, parList: Array<TiTreeNode>, curIndex: number, type: string) {\r\n        let targetNode: TiTreeNode;\r\n        let targetIndex: number;\r\n        let _curIndex = curIndex;\r\n        if (type === 'up') { // 同级获取上一个节点\r\n            targetIndex = _curIndex - 1;\r\n            if (targetIndex < 0) {\r\n                targetIndex = parList.length - 1;\r\n            }\r\n            targetNode = parList[targetIndex];\r\n        } else { // 同级获取下一个节点\r\n            targetIndex = _curIndex + 1;\r\n            if (targetIndex > (parList.length - 1)) {\r\n                targetIndex = 0;\r\n            }\r\n            targetNode = parList[targetIndex];\r\n        }\r\n        // 上下移动时，first或last节点禁用时,return\r\n        if ((targetNode === parList[0] || targetNode === parList[parList.length - 1]) && targetNode.disabled) {\r\n            return;\r\n        }\r\n        // 当中间节点有禁用时，移动到禁用的节点上一个或下一个节点\r\n        if (targetNode.disabled) {\r\n            _curIndex = targetIndex;\r\n            this.setFocusNode(node, parList, _curIndex, type);\r\n            return;\r\n        }\r\n        targetNode.focused = true;\r\n        this.setFocusElem(node);\r\n    }\r\n\r\n    // 目标元素获取焦点\r\n    private setFocusElem(node: TiTreeNode){\r\n        if (node.focused) {\r\n            node.focused = false;\r\n        }\r\n        // 当按键操作会改变文本元素是否添加class`ti3-tree-text-focus`, 加延时是为了class变更后，获取正确的含有class的文本区域元素\r\n        // 类ti3-tree-text-focus作为获焦元素的标志\r\n        setTimeout(()=> {\r\n            // 找到含有类ti3-tree-text-focus的文本元素\r\n            const focusNode = this.elems.toArray().find((elem) => this.tiRenderer.hasClass(elem.nativeElement, 'ti3-tree-text-focus'));\r\n            if (focusNode) {\r\n                focusNode.nativeElement.focus();\r\n            }\r\n        }, 0)\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param startEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 拖拽开始时在被拖拽元素上触发此事件\r\n     */\r\n    public onDragstart(event: DragEvent, node: TiTreeNode) {\r\n        event.stopPropagation();\r\n        this.dragNode = node; // 保存被拖拽的节点\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param enterEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 拖拽鼠标进入元素时在该元素上触发\r\n     */\r\n    public onDragenter(event: DragEvent, node: TiTreeNode) {\r\n\r\n        event.preventDefault();\r\n        this.overNode = null;\r\n\r\n        // 拖拽节点和目标节点是同一节点,retuen\r\n        if (node === this.dragNode) {\r\n            return;\r\n        }\r\n\r\n        // 保存移动到的节点\r\n        this.overNode = node;\r\n\r\n        // 拖拽的节点拖拽到其子节点时，关闭其节点\r\n        if (this.dragNode === TiTreeUtil.getParentNode(this.data, node)) {\r\n            this.dragNode.expanded = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param overEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 拖拽时鼠标在目标元素上移动时触发\r\n     */\r\n    public onDragover(event: DragEvent, node: TiTreeNode) {\r\n        event.preventDefault();\r\n        event.dataTransfer.effectAllowed = \"move\";\r\n        if (node === this.overNode) {\r\n            this.clearDragClass(event); // 清除节点之前的样式\r\n            this.dropPosition = this.calcDropPosition(event); // 获取移动到节点的位置\r\n            // 拖拽经过节点,放置内部位置时，且该节点未展开时，展开其节点\r\n            if (this.dropPosition === 0 && !node.expanded) {\r\n                node.expanded = true;\r\n            }\r\n            // 设置拖动过程中的状态样式\r\n            this.renderer2.addClass(event.currentTarget, this.setDragOverClass(node));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param leaveEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 拖拽时鼠标在离开目标元素时触发\r\n     */\r\n    public onDragleave(event: DragEvent, node: TiTreeNode) {\r\n        event.preventDefault();\r\n        this.clearDragClass(event);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param dropEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 鼠标在拖放目标上释放时,在拖放目标上触发\r\n     */\r\n    public onDrop(event: DragEvent, node: TiTreeNode) {\r\n        event.preventDefault();\r\n        this.dragNode.focused = false;\r\n        this.clearDragClass(event);\r\n        // 异步加载节点时禁止放置到节点内部\r\n        if (this.dropPosition === 0 && node.loadStatus === 'loading') {\r\n            return;\r\n        }\r\n        // 拖拽节点和目标节点是同一节点,retuen\r\n        if (node === this.dragNode) {\r\n            return;\r\n        }\r\n        const params: TiTreeDragNode = {\r\n            event: event,\r\n            targetNode: node,\r\n            dragNode: this.dragNode,\r\n            dropPosition: this.dropPosition\r\n        }\r\n        TiTreeUtil.dropApply(params, this.data, this.multiple);\r\n        this.nodeDrop.emit(params);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param endEvent 鼠标事件\r\n     * @param node 当前节点数据\r\n     * @description 鼠标在拖放目标上释放时,在拖拽元素上触发\r\n     */\r\n    public onDragend(event: DragEvent, node: TiTreeNode) {\r\n        event.preventDefault();\r\n        this.dragNode = null;\r\n        this.overNode = null;\r\n    }\r\n\r\n    // 计算拖拽节点的放置方式0（作为目标节点的子节点），-1（放置在目标节点的前面）,1（放置在目标节点的后面）\r\n    private calcDropPosition(event: DragEvent): number {\r\n        const clientY: number  = event.clientY;\r\n        const { top, height } = (event.target as HTMLElement).getBoundingClientRect();\r\n        const gapHeight: number = height / 3;\r\n        if (clientY > top + height - gapHeight) {\r\n            return 1;\r\n        }\r\n        if (clientY < top + gapHeight) {\r\n            return -1\r\n        }\r\n        return 0;\r\n\r\n    }\r\n\r\n    // 清除拖拽样式\r\n    private clearDragClass(event: DragEvent): void {\r\n        // 拖拽过程中的三种状态\r\n        const dragClasses: Array<string> = ['ti3-tree-drag-over-inner', 'ti3-tree-drag-over-top', 'ti3-tree-drag-over-bottom'];\r\n        dragClasses.forEach((item: string) => {\r\n            this.renderer2.removeClass(event.currentTarget, item);\r\n        })\r\n    }\r\n\r\n    // 根据拖动的位置获取相应的样式\r\n    private setDragOverClass(node: TiTreeNode): string {\r\n        if (node !== this.overNode) {\r\n            return\r\n        }\r\n        if (this.dropPosition === 0) {\r\n          return \"ti3-tree-drag-over-inner\";\r\n        } else if (this.dropPosition === -1) {\r\n          return \"ti3-tree-drag-over-top\";\r\n        } else if (this.dropPosition === 1) {\r\n          return \"ti3-tree-drag-over-bottom\";\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param node 节点\r\n     * @param type hover标志\r\n     */\r\n    public onMousenode(node: TiTreeNode, type: string): void {\r\n        // 鼠标进入节点且不是编辑状态时，显示操作按钮\r\n        if (type === 'enter' && !node.editing) {\r\n            node.isHover = true;\r\n        } else {\r\n            delete node.isHover;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param node 节点\r\n     */\r\n   public onBlurEdit(node: TiTreeNode): void {\r\n       if (node.label !== '') {\r\n           delete node.editing;\r\n       }\r\n   }\r\n\r\n   /**\r\n     * @ignore\r\n     * @param deleteEvent 删除事件\r\n     * @param node 节点\r\n     */\r\n    public deleteNode(event: Event, node: TiTreeNode): void {\r\n        // 阻止事件冒泡 防止触发选中\r\n        event.stopPropagation();\r\n        const parentNode: TiTreeNode = TiTreeUtil.getParentNode(this.data, node);\r\n        TiTreeUtil.removeNode(this.data, node);\r\n        // 节点的父节点无子节点时， 删除children属性，解决依旧会显示展开图标问题\r\n        if (parentNode && parentNode.children.length < 1) {\r\n            delete parentNode.children;\r\n        }\r\n        // 更新多选状态\r\n        if (this.multiple) {\r\n            TiTreeUtil.updateChecked(this.data);\r\n        }\r\n        this.nodeDeleted.emit(node);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param editEvent 编辑事件\r\n     * @param node 节点\r\n     */\r\n    public editNode(event: Event, node: TiTreeNode): void {\r\n        // 阻止事件冒泡 防止触发选中\r\n        event.stopPropagation();\r\n        node.editing = true;\r\n        delete node.isHover;\r\n        this.nodeEdited.emit(node);\r\n        // autofocus视图变化时 会报错 视图变化时 强制变检一次，消除报错(Expression has changed after it was checked)\r\n        this.cdRef.detectChanges();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * @param addEvent 增加事件\r\n     * @param node 节点\r\n     */\r\n    public addNode(event: Event, node: TiTreeNode): void {\r\n        // 阻止事件冒泡 防止触发选中\r\n        event.stopPropagation();\r\n        const newNode: TiTreeNode = {\r\n            label: this.treeLan.newNode,\r\n            editing: true,\r\n        }\r\n        node.expanded = true;\r\n        this.nodeAdded.emit(newNode);\r\n        TiTreeUtil.addNode(this.data, [newNode], 0, node);\r\n        // 更新多选状态\r\n        if (this.multiple) {\r\n            TiTreeUtil.updateChecked(this.data);\r\n        }\r\n        // autofocus视图变化时 会报错 强制变检一次，消除报错(Expression has changed after it was checked)\r\n        this.cdRef.detectChanges();\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core'\r\n/**\r\n * @ignore\r\n * TiHighlightPipe 替换搜索的值并高亮显示\r\n */\r\n@Pipe({\r\n    name: 'tiHighlight',\r\n    pure: true\r\n})\r\n\r\nexport class TiHighlightPipe implements PipeTransform {\r\n    transform(value: string, keyword: string){\r\n        if (!keyword) {\r\n            return value;\r\n        }\r\n        const Reg = new RegExp(keyword, 'ig');\r\n        const result = value.replace(Reg, word => {\r\n            return `<span class=\"ti3-font-highlight\">${word}</span>`;\r\n        });\r\n        return result;\r\n    }\r\n}","import { Directive, ElementRef } from '@angular/core';\r\n\r\n/**\r\n * @ignore\r\n * 指令功能: 悬浮操作按钮场景，提供input框内容选中功能\r\n */\r\n@Directive({\r\n    selector: '[tiAutoSelect]'\r\n})\r\n\r\nexport class TiAutoSelectDirective {\r\n    constructor(private elementRef: ElementRef) {}\r\n    ngOnInit(): void {\r\n        setTimeout(() => {\r\n          this.elementRef.nativeElement.select();\r\n        }, 0);\r\n      }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiTreeComponent } from './TiTreeComponent';\r\nimport { TiCheckboxModule } from '../checkbox/TiCheckboxModule';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiLoadingModule } from '../loading/TiLoadingModule'\r\nimport { TiHighlightPipe } from './TiHighlightPipe';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\nimport { TiTextModule } from '../text/TiTextModule';\r\nimport { TiValidationModule } from '../../directives/validation/TiValidationModule';\r\nimport { TiAutoSelectDirective } from './TiAutoSelectDirective'\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiCheckboxModule,\r\n    TiIconModule,\r\n    FormsModule,\r\n    TiLoadingModule,\r\n    TiRendererModule,\r\n    TiTextModule,\r\n    TiValidationModule\r\n  ],\r\n  exports: [TiTreeComponent],\r\n  declarations: [TiTreeComponent, TiHighlightPipe, TiAutoSelectDirective]\r\n})\r\nexport class TiTreeModule {\r\n\r\n}\r\n\r\nexport * from './TiTreeComponent';\r\nexport { TiTreeComponent, TiTreeNode, TiTreeDragNode } from './TiTreeComponent';\r\nexport { TiTreeUtil } from './TiTreeUtil';\r\n","import { Component, ElementRef, Input, SimpleChanges, ViewChild } from '@angular/core';\r\n\r\nimport { TiFormComponent } from '../base/TiBaseModule';\r\nimport { TiTreeNode, TiTreeUtil } from '../tree/TiTreeModule';\r\nimport { TiDominatorComponent } from '../dominator/TiDominatorModule';\r\nimport { TiDropComponent } from '../drop/TiDropModule';\r\nimport { TiSearchboxNotsearchComponent } from '../searchbox/TiSearchboxModule';\r\nimport { TiLocale } from '../../locale/TiLocaleModule';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiSelectComponent } from '../select/TiSelectModule';\r\nimport { TiDropsearchComponent } from '../dropsearch/TiDropsearchModule';\r\n/**\r\n * Treeselect树选择下拉组件\r\n *\r\n * 支持单选/多选，全选，搜索，懒加载。\r\n *\r\n * 单选主要功能为从Tree组件数据中选择某一条数据，单选与Tree功能相同，只是视觉呈现不同。\r\n *\r\n * 多选主要功能是从Tree组件数据中任意选择多条数据，多选与Tree功能相同，只是视觉呈现不同。\r\n *\r\n * 该组件继承自TiSelectComponent，其中\r\n *\r\n * 输入属性：clearable、labelKey、searchKeys、tipPosition、panelMaxHeight和valueKey暂不支持；\r\n *\r\n * 输出属性：clear不支持（单选和多选都采用标签方式展示，所以不支持单选情况下的clear事件）\r\n *\r\n * <example-url>../tiny3demo/#/treeselect/treeselect-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-treeselect',\r\n    templateUrl: 'treeselect.html',\r\n    styleUrls: ['./treeselect.less'],\r\n    providers: [TiFormComponent.getValueAccessor(TiTreeselectComponent)],\r\n    host: {\r\n        '(blur)': 'onBlur()'\r\n    }\r\n})\r\n\r\nexport class TiTreeselectComponent extends TiSelectComponent {\r\n\r\n    // 搜索框的高度\r\n    private static readonly SEARCHBOX_HEIGHT: number = 30;\r\n\r\n    /**\r\n     * 下拉面板的高度，默认展示8条\r\n     */\r\n    @Input() dropMaxHeight: number = (30 + 1) * 8;\r\n\r\n    /**\r\n     * @ignore 搜索结果\r\n     */\r\n    public oldOptions: Array<any>;\r\n\r\n    /**\r\n     * @ignore 内部标签\r\n     */\r\n    @ViewChild(TiDropComponent, { static: true }) dropCom: TiDropComponent;\r\n    /**\r\n     * @ignore 内部标签\r\n     */\r\n    @ViewChild(TiDominatorComponent, { static: true }) dominatorCom: TiDominatorComponent;\r\n    /**\r\n     * @ignore 内部标签\r\n     */\r\n    @ViewChild('searchboxCom') searchboxCom: TiSearchboxNotsearchComponent;\r\n    /**\r\n     * @ignore 内部标签\r\n     */\r\n    @ViewChild('datatemplate') dataTemplate: ElementRef;\r\n\r\n    /**\r\n     * @ignore 全选框的半选中状态\r\n     */\r\n    public indeterminate: boolean = false;\r\n\r\n    /**\r\n     * @ignore 全选中\r\n     */\r\n    public isAllSelected: boolean = false;\r\n\r\n    /**\r\n     * @ignore 搜索提示文本\r\n     */\r\n    public searchPlaceholder: string = TiLocale.getLocaleWords().tiSelect.search;\r\n\r\n    /**\r\n     * @ignore 搜索内容\r\n     */\r\n    public searchText: string = '';\r\n\r\n    /**\r\n     * @ignore 是否处于搜索状态\r\n     */\r\n    private isInSearch: boolean = false;\r\n\r\n    // 主干深拷贝，叶子浅拷贝\r\n    // 因为搜索结果里，叶子节点的勾选效果，需要保留在原始数据。\r\n    private static leafShallowClone(arr: any): Array<TiTreeNode> {\r\n        if (typeof (arr) !== 'object' || arr === null || (arr.label !== undefined && arr.children === undefined)) {\r\n            return arr;\r\n        }\r\n\r\n        const clone: any = Array.isArray(arr) ? arr.slice() : { ...arr };\r\n        const keys: Array<string> = Object.keys(clone);\r\n        for (const key of keys) {\r\n            clone[key] = TiTreeselectComponent.leafShallowClone(clone[key]);\r\n        }\r\n\r\n        return clone;\r\n    }\r\n\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 强制装换，方便调用super.xxx\r\n        this.dropsearchCom = this.dropCom as unknown as TiDropsearchComponent;\r\n\r\n        // 记录传入的数据，浅拷贝\r\n        this.oldOptions = this.options;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        // 解决延迟或者动态设置options，树组件未渲染的问题\r\n        if(changes['options'] && !changes['options'].firstChange) {\r\n            // 重新记录传入的数据\r\n            this.oldOptions = changes['options'].currentValue;\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterViewChecked(): void {\r\n        if (this.searchable !== this.oldSearchable) {\r\n            this.oldSearchable = this.searchable;\r\n            if (this.searchable) {\r\n                this.setFocusableElems(this.dominatorCom.getFocusableElems()\r\n                    .concat(this.searchboxCom.getFocusableElems())\r\n                    .concat(this.dropCom.nativeElement));\r\n            } else {\r\n                this.setFocusableElems(this.dominatorCom.getFocusableElems()\r\n                    .concat(this.dropCom.nativeElement));\r\n            }\r\n        }\r\n        // 调用父类逻辑afterViewChecked才去设置autofocs\r\n        super.ngAfterViewChecked();\r\n    }\r\n\r\n    /**\r\n     * @ignore drop高度被压缩时，重新设置下拉面板的高度\r\n     */\r\n    private restyleDropMaxHeight(): void {\r\n        let dropCurMaxHeight: number = parseInt(this.dropCom.nativeElement.style.maxHeight, 10);\r\n\r\n        let dropMaxHeightAdapted: number = this.dropMaxHeight;\r\n        if (!isNaN(dropCurMaxHeight)) {\r\n            // 减去搜索框高度和间距的和\r\n            if (this.searchable) {\r\n                dropCurMaxHeight -= TiTreeselectComponent.SEARCHBOX_HEIGHT;\r\n            }\r\n            if (dropCurMaxHeight < this.dropMaxHeight) {\r\n                dropMaxHeightAdapted = dropCurMaxHeight;\r\n            }\r\n        }\r\n\r\n        this.renderer.setStyle(this.dataTemplate.nativeElement, 'max-height', dropMaxHeightAdapted + 'px');\r\n    }\r\n\r\n    ngOnModelChange(): void {\r\n        if (this.multiple) {\r\n            // 多选时，重新设置下拉面板定位\r\n            this.setPosition();\r\n            if (this.selectAll) {\r\n                // 允许全选时，设置全选框状态\r\n                this.setAllSelectCheckboxState();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 设置下拉面板定位\r\n     */\r\n    setPosition(optionsChange?: boolean): void {\r\n        setTimeout(() => {\r\n            if (optionsChange) {\r\n                this.dropCom.resetPosition();\r\n            } else {\r\n                this.dropCom.setPosition();\r\n            }\r\n            this.restyleDropMaxHeight();\r\n        }, 0);\r\n    }\r\n\r\n    /**\r\n     * @ignore 关闭下拉面板并转移焦点\r\n     */\r\n    public close(): void {\r\n        this.dropCom.hide();\r\n        // 焦点转移至dominator\r\n        if (this.searchable) {\r\n            this.dominatorCom.focus();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 仅仅关闭下拉面板\r\n     */\r\n    private closeWithoutFocus(): void {\r\n        this.dropCom.hide();\r\n    }\r\n\r\n    /**\r\n     * @ignore 打开下拉面板\r\n     */\r\n    public open(): void {\r\n        // 初始化最大高度\r\n        this.renderer.setStyle(this.dataTemplate.nativeElement, 'max-height', this.dropMaxHeight + 'px');\r\n        this.dropCom.show();\r\n        this.restyleDropMaxHeight();\r\n        // 焦点转移至搜索框\r\n        if (this.searchable) {\r\n            this.searchboxCom.focus();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 尝试打开下拉面板\r\n     */\r\n    public wantOpen(): void {\r\n        super.wantOpen();\r\n    }\r\n\r\n    /**\r\n     * @ignore 点击ti-dominator触发的事件\r\n     * 点击下拉面板，展开或者关闭面板\r\n     */\r\n    public onClickDominator(): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        if (!this.dropCom.isShow) {\r\n            // 清空搜索内容\r\n            this.searchText = '';\r\n            this.searchTextChange(this.searchText);\r\n            this.wantOpen();\r\n        } else {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 删除ti-dominator选中项时触发的事件\r\n     * 需要取消树节点的选中\r\n     */\r\n    public onDeleteDominatorTag(item: any): void {\r\n        const deletedItem: TiTreeNode = item.item;\r\n        // 1.取消选中当前节点、设置子节点及祖先节点的选中情况。从model中删除时，item.item.checked还是为true，要设置为false\r\n        this.setSelectState(deletedItem, !deletedItem.checked);\r\n\r\n        // 2.设置为非全选\r\n        this.isAllSelected = false;\r\n        // 3.设置全选框状态\r\n        if (this.multiple && this.selectAll) {\r\n            item.model.length === 0 ? this.indeterminate = false : this.indeterminate = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore ti-searchbox-notsearch搜索框内容变化时触发的事件\r\n     */\r\n    public searchTextChange(searchText: string): void {\r\n        if (Util.isEmptyString(searchText)) {\r\n            this.options = this.oldOptions;\r\n            this.isInSearch = false;\r\n        } else {\r\n            // this.oldOptions 叶子浅拷贝\r\n            const searchResult: Array<TiTreeNode> = TiTreeselectComponent.leafShallowClone(this.oldOptions);\r\n            TiTreeUtil.search(searchResult, (cnode: TiTreeNode): boolean => {\r\n                return (cnode.label.indexOf(this.searchText) >= 0);\r\n            });\r\n            // 展开整个树\r\n            TiTreeUtil.traverse(searchResult, (node: TiTreeNode): void => {\r\n                node.expanded = true;\r\n            });\r\n            this.options = searchResult;\r\n            this.isInSearch = true;\r\n        }\r\n        if (this.multiple && this.selectAll) {\r\n            this.setAllSelectCheckboxState();\r\n        }\r\n\r\n        // 重新设置面板定位\r\n        this.setPosition(true);\r\n    }\r\n\r\n    /**\r\n     * @ignore 从model中获取option所在的索引\r\n     */\r\n    private getItemIndexFromModel(option: TiTreeNode): number {\r\n        let index: number = -1;\r\n        index = this.model.findIndex((item: any) => {\r\n            // 判断item和option的引用是否相同即可\r\n            return (item  === option);\r\n        });\r\n\r\n        return index;\r\n    }\r\n\r\n    /**\r\n     * @ignore 获取需要放到model中的节点，根据规范，如果子节点全部选中了，需要在model中放入父节点或者祖先节点。找到第一个checked为true的节点即可\r\n     * node: 树组件select事件中的参数\r\n     */\r\n    private getRealSelectedNode(node: TiTreeNode): TiTreeNode {\r\n        // tslint:disable-next-line: no-null-keyword\r\n        let selectedNode: TiTreeNode = null;\r\n        const parentNode: TiTreeNode = TiTreeUtil.getParentNode(this.oldOptions, node);\r\n        (parentNode && parentNode.checked === true) ? selectedNode =  this.getRealSelectedNode(parentNode) : selectedNode =  node;\r\n\r\n        return selectedNode;\r\n    }\r\n\r\n    /**\r\n     * @ignore 获取需要从model移除的节点，根据规范，如果某个子节点取消选中了，那么可能是它的父节点或祖先节点或所有子节点从model中被移除\r\n     * node：树组件select事件的参数\r\n     */\r\n    private getRealUnselectedNode(node: TiTreeNode): TiTreeNode {\r\n        // tslint:disable-next-line: no-null-keyword\r\n        let unselectedNode: TiTreeNode = null;\r\n        let parentNode: TiTreeNode = TiTreeUtil.getParentNode(this.oldOptions, node);\r\n\r\n        if (this.getItemIndexFromModel(node) !== -1) {\r\n            // 需要从model中移除的节点是node本身\r\n            unselectedNode = node;\r\n        } else {\r\n            // 需要从model中移除的节点是node父节点或祖先节点\r\n            // 当节点处于半选状态时,点击节点的复选框,节点状态为选中,否则为非选中,所以要先判断parentNode是否存在\r\n            while (parentNode && this.getItemIndexFromModel(parentNode) === -1) {\r\n                parentNode = TiTreeUtil.getParentNode(this.oldOptions, parentNode);\r\n            }\r\n            // parentNode可能为undefined\r\n            unselectedNode = parentNode;\r\n        }\r\n\r\n        return unselectedNode;\r\n    }\r\n\r\n    /**\r\n     * @ignore 取消选中时，获取被选中的子节点，根据规范，父节点或祖先节点被选中之后，如果取消了某个子节点的选中，那么需要把它的所有选中的子节点加入model中\r\n     * unselectedNode：需要从model中移除的节点\r\n     */\r\n    // tslint:disable-next-line: prefer-function-over-method\r\n    private getSelectedChildren(unselectedNode: TiTreeNode): Array<TiTreeNode> {\r\n        let selectedChildren: Array<TiTreeNode> = [];\r\n        if (unselectedNode.children) {\r\n            unselectedNode.children.forEach((child: TiTreeNode) => {\r\n                if (child.checked === true) {\r\n                    selectedChildren.push(child);\r\n                } else {\r\n                    selectedChildren = selectedChildren.concat(this.getSelectedChildren(child));\r\n                }\r\n            });\r\n        }\r\n\r\n        return selectedChildren;\r\n    }\r\n\r\n    /**\r\n     * @ignore 根据checked的值，设置option节点及其子节点和祖先节点的选中状态\r\n     * option: 选中的节点；checked：option.checked属性，true/false\r\n     */\r\n    private setSelectState(option: TiTreeNode, checked: boolean): void {\r\n        // 对oldOptions进行操作，将搜索时的结果映射回来\r\n        TiTreeUtil.traverse(this.oldOptions, (node: TiTreeNode) => {\r\n            if (node === option) {\r\n                node.checked = checked;\r\n                if (checked === true) {\r\n                    TiTreeUtil.selectAllChildren(node);\r\n                    TiTreeUtil.selectParents(node, this.oldOptions, true);\r\n                } else {\r\n                    TiTreeUtil.deSelectAllChildren(node);\r\n                    TiTreeUtil.deSelectParents(node, this.oldOptions);\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * @ignore 选中某个节点后，更新this.model\r\n     * option: 选中的节点\r\n     */\r\n    private setModelWhenSelected(option: TiTreeNode): void {\r\n        // 1.获取option最后一个被选中的祖先节点\r\n        const selectedNode: TiTreeNode = this.getRealSelectedNode(option);\r\n        // 2.从model中删除selectNode的所有子节点，一直到叶子节点\r\n        TiTreeUtil.traverse([selectedNode], (node: TiTreeNode) => {\r\n            let deleteIndex: number = this.getItemIndexFromModel(node);\r\n            while (deleteIndex !== -1) {\r\n                this.model.splice(deleteIndex, 1);\r\n                deleteIndex = this.getItemIndexFromModel(node);\r\n            }\r\n        });\r\n        // 3.将selectedNode加入到this.model中\r\n        if (this.getItemIndexFromModel(selectedNode) === -1) {\r\n            this.model.push(selectedNode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 取消选中某个节点后，更新this.model\r\n     * option: 被取消选中的节点\r\n     */\r\n    private setModelWhenUnselected(option: TiTreeNode): void {\r\n        // 1.获取需要从model中删除的节点\r\n        const unselectedNode: TiTreeNode = this.getRealUnselectedNode(option);\r\n\r\n        // 2.更新model\r\n        if (unselectedNode) {\r\n            // 2.1unselectedNode为option或option的祖先节点\r\n            const deleteIndex: number = this.getItemIndexFromModel(unselectedNode);\r\n            this.model.splice(deleteIndex, 1);\r\n            // 将option所有选中的子节点存放到this.model中\r\n            if (unselectedNode !== option) {\r\n                const selectedChildren: Array<TiTreeNode> = this.getSelectedChildren(unselectedNode);\r\n                this.model = this.model.concat(selectedChildren);\r\n            }\r\n        } else {\r\n            // 2.2unselectedNode为undefined，这种情况下，只需从model中删除option所有选中的子节点\r\n            TiTreeUtil.traverse([option], (node: TiTreeNode) => {\r\n                const deleteIndex: number = this.getItemIndexFromModel(node);\r\n                if (deleteIndex !== -1) {\r\n                    this.model.splice(deleteIndex, 1);\r\n                }\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * @ignore 处于搜索状态下，更新model\r\n     */\r\n    private setModelWhenSearch(data: Array<TiTreeNode>, checked: boolean): void {\r\n        // 或者所有处于checked状态的叶子节点\r\n        let selectedLeafNodes: Array<TiTreeNode> = [];\r\n        selectedLeafNodes = this.getLeafNodes(data, checked);\r\n        // 根据每个叶子节点更新model\r\n        for (const leafNode of selectedLeafNodes) {\r\n            // 设置oldOptions各节点状态\r\n            this.setSelectState(leafNode, checked);\r\n            checked ? this.setModelWhenSelected(leafNode) : this.setModelWhenUnselected(leafNode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 获取data里面选中或者未选中的全部叶子节点\r\n     * data：搜索范围，checked：true/false\r\n     */\r\n    // tslint:disable-next-line: prefer-function-over-method\r\n    private getLeafNodes(data: Array<TiTreeNode>, checked: boolean): Array<TiTreeNode> {\r\n        const leafNodes: Array<TiTreeNode> = [];\r\n        TiTreeUtil.traverse(data, (node: TiTreeNode) => {\r\n            if (TiTreeUtil.isLeaf(node) && node.checked === checked) {\r\n                leafNodes.push(node);\r\n            }\r\n        });\r\n\r\n        return leafNodes;\r\n    }\r\n\r\n    /**\r\n     * @ignore 设置全选checkbox的状态\r\n     */\r\n    private setAllSelectCheckboxState(): void {\r\n\r\n        // 1.假设节点都被选中或都没被选中\r\n        let isAllSelected: boolean = true;\r\n        let isAllUnSelected: boolean = true;\r\n\r\n        // 2.判断是否所有节点都被选中或都没被选中，disabled状态下的节点不用统计\r\n        TiTreeUtil.traverse(this.options, (node: TiTreeNode) => {\r\n            // 2.1 有节点没被选中\r\n            if (!node.disabled && node.checked !== true) {\r\n                isAllSelected = false;\r\n            }\r\n            // 2.2 有节点被选中或半选中\r\n            if (!node.disabled && (node.checked === true || node.checked === 'indeterminate')) {\r\n                isAllUnSelected = false;\r\n            }\r\n        });\r\n\r\n        // 3.设置checkbox状态\r\n        this.isAllSelected = isAllSelected;\r\n        this.indeterminate = !isAllSelected && !isAllUnSelected;\r\n    }\r\n\r\n    /**\r\n     * @ignore ti-tree的select事件\r\n     */\r\n    public onTreeSelect(option: any): void {\r\n\r\n        // 节点被禁用，不做操作，直接返回\r\n        if (option.disabled === true) {\r\n            return;\r\n        }\r\n\r\n        // 1.触发select事件\r\n        this.select.emit(option);\r\n        if (!this.multiple) {\r\n            // 2.1单选，直接替换model\r\n            TiTreeUtil.traverse(this.oldOptions, (node: TiTreeNode) => {\r\n                if (node === option) {\r\n                    node.checked = true;\r\n                    this.model = [option];\r\n                } else {\r\n                    node.checked = false;\r\n                }\r\n            });\r\n            // 关闭下拉面板\r\n            this.close();\r\n        } else {\r\n            // 2.2多选\r\n            if (!this.isInSearch) {\r\n                // 2.2.1非搜索状态\r\n                // 设置oldOptions各节点状态\r\n                this.setSelectState(option, option.checked);\r\n                if (option.checked === true) {\r\n                    this.setModelWhenSelected(option);\r\n                } else {\r\n                    this.setModelWhenUnselected(option);\r\n                }\r\n            } else {\r\n                // 2.2.2搜索状态\r\n                this.setModelWhenSearch([option], option.checked);\r\n            }\r\n\r\n            // 2.3手动触发ngModelChange事件，splice和push无法触发\r\n            this.model = this.model.concat();\r\n            // 2.4设置全选状态\r\n            if (this.selectAll) {\r\n                this.setAllSelectCheckboxState();\r\n            }\r\n        }\r\n\r\n        // 3.重新设置ti-dominator高度\r\n        this.setPosition();\r\n\r\n    }\r\n\r\n    /**\r\n     * @ignore 全选复选框的按钮事件\r\n     */\r\n    public onSelectAllChange(isAllSelected: any): void {\r\n        // 1.将当前tree节点全部选中 或 不选中\r\n        TiTreeUtil.traverse(this.options, (node: TiTreeNode) => {\r\n            if (!node.disabled) {\r\n                node.checked = isAllSelected;\r\n            }\r\n        });\r\n\r\n        // 2.设置model\r\n        if (!this.isInSearch) {\r\n            // 2.1 未处于搜索状态下，使用concat进行单层深拷贝\r\n            (!this.isAllSelected) ? this.model = this.options.concat() : this.model = [];\r\n        } else {\r\n            // 2.2  处于搜索状态下\r\n            this.setModelWhenSearch(this.options, isAllSelected);\r\n            // 手动触发ngModelChange事件\r\n            this.model = this.model.concat();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore 全选复选框的点击事件\r\n     */\r\n    public onClickSelectAll(event: any): void {\r\n        // 点击时，this.isAllSelected为false，所以要取反\r\n        this.onSelectAllChange(!this.isAllSelected);\r\n        event.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 失焦情况下，仅关闭面板，不做聚焦等处理\r\n     */\r\n    public onBlur(): void {\r\n        this.closeWithoutFocus();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 鼠标点击到空白，原本会失焦，此处通过阻止默认事件的方式进行了处理\r\n     */\r\n    public onMouseDownDropOuter(event: any): void {\r\n        event.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * #datatemplate内部滚动条会引起外部滚动条事件触发，引起弹框内的树下拉组件无法使用鼠标拖动滚动条，因此此处阻止事件冒泡\r\n     */\r\n    public onMouseWheel(event: any): void {\r\n        event.stopPropagation();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { TiTreeselectComponent } from './TiTreeselectComponent';\r\nimport { TiDominatorModule } from '../dominator/TiDominatorModule';\r\nimport { TiDropsearchModule } from '../dropsearch/TiDropsearchModule';\r\nimport { TiDropModule } from '../drop/TiDropModule';\r\nimport { TiTreeModule } from '../tree/TiTreeModule';\r\nimport { TiSearchboxModule } from '../searchbox/TiSearchboxModule';\r\nimport { TiCheckboxModule } from '../checkbox/TiCheckboxModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    TiDominatorModule, TiDropsearchModule, TiDropModule, TiTreeModule, TiSearchboxModule, TiCheckboxModule,\r\n    FormsModule,\r\n    CommonModule\r\n  ],\r\n  exports: [TiTreeselectComponent],\r\n  declarations: [TiTreeselectComponent]\r\n})\r\n\r\nexport class TiTreeselectModule {}\r\n\r\nexport { TiTreeselectComponent } from './TiTreeselectComponent';\r\n","import { TiFileItem } from './TiFileInterface';\r\nimport { Util } from '../../utils/Util';\r\n\r\n// 上传文件服务，提供上传过程中的通用方法\r\n/**\r\n * @ignore\r\n */\r\nexport class TiUploadUtil {\r\n    // 已支持SSR\r\n    public static readonly isHTML5: boolean = (typeof window !== 'undefined') && ((window as any).File && (window as any).FormData);\r\n    /**\r\n     * 上传多个文件\r\n     * 上传一个或多个文件item对象\r\n     * 无\r\n     */\r\n    public static uploadItems(items: Array<TiFileItem>): void {\r\n        // 异常处理 1.入参不合法,2.正在上传的文件不允许重复上传\r\n        for (let i: number = items.length - 1; i >= 0; i--) {\r\n            if (!TiUploadUtil.isValidFileItem(items[i]) || items[i].isUploading) {\r\n                items.splice(i, 1);\r\n            }\r\n        }\r\n        TiUploadUtil.onBeforeSend(items); // 文件上传前处理\r\n        for (let j: number = items.length - 1; j >= 0; j--) {\r\n            if (items[j].isCancel) { // 已取消上传的文件不再上传(此处主要是对beforeSend中取消上传的文件进行处理)\r\n                items.splice(j, 1);\r\n            }\r\n        }\r\n        if (items.length > 0) {\r\n            TiUploadUtil.isHTML5 ? TiUploadUtil.uploadXhr(items) : TiUploadUtil.uploadForm(items);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 取消队列中多个正在上传中的文件(只在上传时可取消)\r\n     * 文件item对象数组\r\n     * 无\r\n     */\r\n    public static cancelItems(items: Array<TiFileItem>): void {\r\n        for (let i: number = items.length - 1; i >= 0; i--) {\r\n            if (!TiUploadUtil.isValidFileItem(items[i])) { // 异常处理:入参不合法情况下，不做处理\r\n                items.splice(i, 1);\r\n            } else {\r\n                items[i].isCancel = true;\r\n            }\r\n        }\r\n        if (items[0].isUploading) { // 正在上传过程中，取消上传，上传事件中，会处理响应赋值及事件触发\r\n            TiUploadUtil.isHTML5 ? items[0]._xhr.abort() : items[0]._form.abort();\r\n        } else { // 未在上传过程中情况下，依然触发cancel和complete事件\r\n            const response: string = undefined;\r\n            const status: number = 0;\r\n            TiUploadUtil.onCancel(items, response, status);\r\n            TiUploadUtil.onComplete(items, response, status);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除队列中单个或多个上传文件\r\n     * 文件item对象数组\r\n     */\r\n    public static removeItems(items: Array<TiFileItem>): void {\r\n        const itemsArr: Array<TiFileItem> = {...items};\r\n        for (let i: number = items.length - 1; i >= 0; i--) {\r\n            if (!TiUploadUtil.isValidFileItem(items[i])) {\r\n                items.splice(i, 1);\r\n            }\r\n        }\r\n        // 阻止文件上传进程\r\n        if (items[0].isUploading) {\r\n            TiUploadUtil.cancelItems(items);\r\n        }\r\n        // 删除队列中的文件对象及文件对象相关引用\r\n        for (let j: number = items.length - 1; j >= 0; j--) {\r\n            items[j].uploader.queue.splice(TiUploadUtil.getItemIndex(items[j]), 1);\r\n            itemsArr[j].destroy();\r\n        }\r\n        // 触发外部定义的删除事件\r\n        TiUploadUtil.onRemove(itemsArr);\r\n    }\r\n\r\n    /**\r\n     * 触发onBeforeRemoveItems事件\r\n     * 文件item对象数组\r\n     */\r\n    public static onBeforeRemove(items: Array<TiFileItem>): void {\r\n        TiUploadUtil.handleEvent('BeforeRemove', items);\r\n    }\r\n\r\n    /**\r\n     * 获取文件对象 index值，获取该值用于后续判断item有效性\r\n     * 上传文件item对象\r\n     */\r\n    private static getItemIndex(item: TiFileItem): number {\r\n        if (item && item.uploader) {\r\n            return item.uploader.queue.findIndex((itemInQueue: TiFileItem) => {\r\n                return itemInQueue.index === item.index;\r\n            });\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    /**\r\n     * 判断文件是否为有效文件\r\n     * 上传文件item对象\r\n     */\r\n    private static isValidFileItem(item: TiFileItem): boolean {\r\n        return (TiUploadUtil.getItemIndex(item) !== -1);\r\n    }\r\n    // 生成上传数据\r\n    private static generateUploadData(items: Array<TiFileItem>): any {\r\n        // 上传数据组装\r\n        const uploadDataObj: any = new FormData();\r\n        if (items[0].formDataFirst) { // formData先于文件信息情况下，先添加formData\r\n            addFormData();\r\n            addFile();\r\n        } else { // formData后于文件信息情况下，后添加formData\r\n            addFile();\r\n            addFormData();\r\n        }\r\n        function addFile(): void {\r\n            items.forEach((item: TiFileItem) => {\r\n                uploadDataObj.append(item.alias, item._file, item.file.name); // 添加上传文件\r\n            });\r\n        }\r\n        function addFormData(): any {\r\n            // 添加单个文件的formData对象,加入到上传对象中\r\n            for (const key in items[0].formData) {\r\n                if (items[0].formData.hasOwnProperty(key)) {\r\n                    uploadDataObj.append(key, items[0].formData[key]);\r\n                }\r\n            }\r\n        }\r\n\r\n        return uploadDataObj;\r\n    }\r\n    private static setXhr(xhr: any, items: Array<TiFileItem>): void {\r\n        // 文件上传信息配置（使用XHR，支持跨域请求）\r\n        xhr.upload.onprogress = (event: any): void => { // 文件进度获取事件\r\n            const lengthComputable: boolean = event.lengthComputable;\r\n            const loaded: number = event.loaded;\r\n            const total: number = event.total;\r\n            const progress: number = Math.round(lengthComputable ? loaded * 100 / total : 0); // 读取当前进度信息\r\n            TiUploadUtil.onProgress(items, progress);\r\n        };\r\n\r\n        xhr.onload = (): void => { // 上传完成事件\r\n            const response: string = xhr.response;\r\n            const status: number = xhr.status;\r\n            if (TiUploadUtil.isSuccessCode(status)) {\r\n                TiUploadUtil.onSuccess(items, response, status);\r\n            } else {\r\n                TiUploadUtil.onError(items, response, status);\r\n            }\r\n            TiUploadUtil.onComplete(items, response, status);\r\n        };\r\n\r\n        xhr.onerror = (): void => { // 上传失败事件\r\n            const response: string = xhr.response;\r\n            const status: number = xhr.status;\r\n            TiUploadUtil.onError(items, response, status);\r\n            TiUploadUtil.onComplete(items, response, status);\r\n        };\r\n\r\n        xhr.onabort = (): void => { // 取消回调\r\n            const response: string = xhr.response;\r\n            const status: number = xhr.status;\r\n            TiUploadUtil.onCancel(items, response, status);\r\n            TiUploadUtil.onComplete(items, response, status);\r\n        };\r\n\r\n        // 设置单个item的_xhr,该对象用于操作单个item的上传取消等处理\r\n        items.forEach((item: TiFileItem) => {\r\n            item._xhr = xhr;\r\n        });\r\n    }\r\n    private static setheaders(xhr: any, items: Array<TiFileItem>): void {\r\n        // 设置请求头\r\n        for (const key in items[0].headers) {\r\n            if (items[0].headers.hasOwnProperty(key)) {\r\n                xhr.setRequestHeader(key, items[0].headers[key]);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * xhr方式上传文件\r\n     * 上传一个或多个文件item对象，上传单个文件的情况下\r\n     */\r\n    private static uploadXhr(items: Array<TiFileItem>): void {\r\n        const uploadDataObj: any = TiUploadUtil.generateUploadData(items); // 组装上传对象\r\n        // 生成并设置xhr\r\n        const xhr: any = new XMLHttpRequest();\r\n        TiUploadUtil.setXhr(xhr, items);\r\n\r\n        // 开始上传\r\n        xhr.open(items[0].method, items[0].url, true);\r\n        TiUploadUtil.setheaders(xhr, items);\r\n        xhr.send(uploadDataObj);\r\n\r\n        // 设置对象的上传状态\r\n        items.forEach((item: TiFileItem) => {\r\n            item.isUploading = true;\r\n        });\r\n    }\r\n    private static uploadForm(items: Array<TiFileItem>): void {\r\n        const form: any = document.createElement('form');\r\n        form.style.display = 'none';\r\n        for (const item of items) {\r\n            // 清除原有form表单\r\n            if (item._form) {\r\n                item._form.parentNode.replaceChild(items[0]._input, items[0]._form); // 清除先前对应的form表单对象，确保上传文件表单元素外层不被form包裹\r\n            }\r\n            item._form = form; // 保存当前form\r\n        }\r\n        items[0]._input.parentNode.insertBefore(form, items[0]._input); // form插入inputSubmit之前，使其在页面显示\r\n\r\n        if (items[0].formDataFirst) { // formData先于文件信息情况下，先添加formData\r\n            addFormData();\r\n            addFile();\r\n        } else { // formData后于文件信息情况下，后添加formData\r\n            addFile();\r\n            addFormData();\r\n        }\r\n\r\n        // 文件信息组装\r\n        function addFile(): void {\r\n            for (const item of items) {\r\n                const inputSubmit: Element = item._input;\r\n                inputSubmit.setAttribute('name', item.alias);\r\n                form.appendChild(inputSubmit); // 在form中添加上传文件元素\r\n            }\r\n        }\r\n\r\n        // formData信息组装\r\n        function addFormData(): void {// 添加formData元素\r\n            for (const key in items[0].formData) {\r\n                if (items[0].formData.hasOwnProperty(key)) {\r\n                    const formDataDomItem: any = document.createElement('input');\r\n                    formDataDomItem.setAttribute('type', 'hidden');\r\n                    formDataDomItem.setAttribute('name', key);\r\n                    formDataDomItem.value = items[0].formData[key];\r\n                    form.appendChild(formDataDomItem);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 生成iframe元素，并将form表单和iframe元素结合\r\n        const iframe: any = document.createElement('iframe');\r\n        const name: string = Util.getUniqueId('tiFileIframe'); // 确保iframe唯一性，保证各文件上传最终能独立返回到相应的iframe\r\n        iframe.setAttribute('name', name);\r\n        form.setAttribute('action', items[0].url);\r\n        form.setAttribute('method', items[0].method);\r\n        form.setAttribute('target', name);\r\n        form.setAttribute('enctype', 'multipart/form-data');\r\n        form.appendChild(iframe);\r\n\r\n        // 表单提交\r\n        form.submit();\r\n        // 设置对象的上传状态\r\n        items.forEach((item: TiFileItem) => {\r\n            item.isUploading = true;\r\n        });\r\n\r\n        // 设置假进度\r\n        let newProgress: number = 0;\r\n        const progressInterval: any = setInterval(() => {\r\n            if (newProgress !== 98) {\r\n                newProgress += 2;\r\n                this.onProgress(items, newProgress);\r\n            }\r\n        }, 10);\r\n\r\n        // 表单完成事件\r\n        const loadEvent: () => void =\r\n            (): void => {\r\n            let response: string = '';\r\n            let status: number = 200;\r\n\r\n            clearInterval(progressInterval);\r\n            this.onProgress(items, 100);\r\n            try {\r\n                response = iframe.contentDocument.body.innerHTML; // 后台正常返回情况获取返回结果\r\n                this.onSuccess(items, response, status);\r\n            } catch (e) {\r\n                response = e;\r\n                status = 520; // 为方便使用者处理，失败情况下，统一返回520状态码 未知错误\r\n                this.onError(items, response, status);\r\n            }\r\n\r\n            this.onComplete(items, response, status);\r\n        };\r\n        iframe.addEventListener('load', loadEvent);\r\n\r\n        // 表单取消方法定义\r\n        form.abort = (): void => {\r\n            clearInterval(progressInterval);\r\n            iframe.removeEventListener('load', loadEvent); // 去除load事件\r\n            // 表单元素还原\r\n            for (const node of form.childNodes) {\r\n                if ((node as any).tagName !== 'IFRAME') {\r\n                    if (form.parentNode.lastChild === form) {\r\n                        form.parentNode.appendChild(node);\r\n                    } else {\r\n                        form.parentNode.insertBefore(node, form.nextSibling);\r\n                    }\r\n                }\r\n            }\r\n            form.remove();\r\n            items.forEach((item: TiFileItem) => {\r\n                /* tslint:disable:no-null-keyword */\r\n                item._form = null;\r\n            });\r\n\r\n            const status: number = 0;\r\n            const response: string = undefined;\r\n            this.onCancel(items, response, status);\r\n            this.onComplete(items, response, status);\r\n        };\r\n    }\r\n\r\n    private static isSuccessCode(status: number): boolean {\r\n        // 和ajax请求一致，304 代表客户端已经执行了GET，但文件未变化\r\n        return status >= 200 && status < 300 || status === 304;\r\n    }\r\n\r\n    /**\r\n     * 上传前处理\r\n     * 上传一个或多个文件item对象\r\n     */\r\n    private static onBeforeSend(items: Array<TiFileItem>): void {\r\n        // 设置当前上传文件的状态信息\r\n        for (const item of items) {\r\n            item.isReady = true;\r\n            item.isUploading = false;\r\n            item.isUploaded = false;\r\n            item.isSuccess = false;\r\n            item.isError = false;\r\n            item.isCancel = false;\r\n            item.progress = 0;\r\n        }\r\n        TiUploadUtil.handleEvent('BeforeSend', items);\r\n    }\r\n\r\n    private static handleEvent(type: string, items: Array<TiFileItem>, params: Array<any> = []): void {\r\n        const onEventTypeItems: any = items[0].uploader.config && items[0].uploader.config[`on${type}Items`];\r\n        if (onEventTypeItems && (typeof onEventTypeItems === 'function')) {\r\n            // eslint-disable-next-line no-useless-call\r\n            onEventTypeItems.apply(null, [items, ...params]);\r\n        }\r\n    }\r\n\r\n    private static onProgress(items: Array<TiFileItem>, progress: number): void {\r\n        TiUploadUtil.handleEvent('Progress', items, [progress]);\r\n        for (const item of items) {\r\n            item.progress = progress; // 设置单个文件的进度信息\r\n        }\r\n    }\r\n\r\n    private static onSuccess(items: Array<TiFileItem>, response: string, status: number): void {\r\n        // 设置当前上传文件的状态信息\r\n        for (const item of items) {\r\n            item.isReady = false;\r\n            item.isUploading = false;\r\n            item.isUploaded = true;\r\n            item.isSuccess = true;\r\n            item.isError = false;\r\n            item.isCancel = false;\r\n            item.progress = 100;\r\n        }\r\n        TiUploadUtil.handleEvent('Success', items, [response, status]);\r\n    }\r\n\r\n    private static onError(items: Array<TiFileItem>, response: string, status: number): void {\r\n        // 设置当前上传文件的状态信息\r\n        for (const item of items) {\r\n            // 设置当前上传文件的状态信息\r\n            item.isReady = false;\r\n            item.isUploading = false;\r\n            item.isUploaded = true;\r\n            item.isSuccess = false;\r\n            item.isError = true;\r\n            item.isCancel = false;\r\n            item.progress = 0;\r\n        }\r\n        TiUploadUtil.handleEvent('Error', items, [response, status]);\r\n    }\r\n\r\n    private static onComplete(items: Array<TiFileItem>, response: string, status: number): void {\r\n        // 置位状态\r\n        items.forEach((item: TiFileItem) => {\r\n            item.isUploading = false;\r\n        });\r\n        // 上传下一个文件，对于同一序列的上传文件来说，其isReady状态均已被标识，因此此处可以通过该方法进行筛选\r\n        const readyItemsArr: Array<TiFileItem> = items[0].uploader.getReadyItems();\r\n        if (readyItemsArr && (readyItemsArr.length !== 0)) {\r\n            this.uploadItems([readyItemsArr[0]]);\r\n        } else {\r\n            // 本次上传序列中，所有文件上传完成后回调，因为文件上传是串行上传：\r\n            // 在一个文件上传完成后才执行下一个文件的上传操作，所以此处可以确保同一序列最终的上传完成\r\n            TiUploadUtil.handleEvent('CompleteAll', items, [response, status]);\r\n        }\r\n        TiUploadUtil.handleEvent('Complete', items, [response, status]);\r\n    }\r\n\r\n    private static onCancel(items: Array<TiFileItem>, response: string, status: number): void {\r\n        for (const item of items) {\r\n            item.isReady = false;\r\n            item.isUploading = false;\r\n            item.isUploaded = false;\r\n            item.isSuccess = false;\r\n            item.isError = false;\r\n            item.isCancel = true;\r\n            item.progress = 0;\r\n        }\r\n        TiUploadUtil.handleEvent('Cancel', items, [response, status]);\r\n    }\r\n\r\n    private static onRemove(items: Array<TiFileItem>): void {\r\n        TiUploadUtil.handleEvent('Remove', items);\r\n    }\r\n}\r\n","import { Directive, ElementRef, Input, Renderer2 } from '@angular/core';\r\nimport { TiFileItem, TiUploadRef } from '../../services/upload/TiFileInterface';\r\nimport { TiUploadUtil } from '../../services/upload/TiUploadUtil';\r\n\r\n/**\r\n * 该指令适用于自定义上传场景，指令定义在input type='file'元素上，传入的是文件上传实例\r\n * 文件上传实例的生成，请参考[TiUploadService.create]{@link ../injectables/TiUploadService.html#create}\r\n *\r\n * 除自定义使用方式外，Tiny还提供了两种已进行设计的上传组件供业务使用，具体见[TiUploadComponent]{@link ../components/TiUploadComponent.html}\r\n *\r\n * <example-url>../tiny3demo/#/upload/upload-all</example-url>\r\n */\r\n@Directive({\r\n  selector: '[tiFileSelect]'\r\n})\r\nexport class TiFileSelectDirective {\r\n    /**\r\n     * 文件上传实例\r\n     */\r\n    @Input() tiFileSelect: TiUploadRef;\r\n    private nativeElement: any;\r\n    private fileChangeEvent: any;\r\n    constructor(private hostElementRef: ElementRef, private renderer: Renderer2) {\r\n        this.nativeElement = this.hostElementRef.nativeElement;\r\n        this.fileChangeEvent = this.renderer.listen(this.nativeElement, 'change', () => {\r\n            if (!this.tiFileSelect) { // 配置的上传文件实例不存在情况下，不做后续处理\r\n                return;\r\n            }\r\n            this.onFileChange(this.nativeElement); // 点选文件后的处理\r\n        });\r\n    }\r\n    /**\r\n     * @ignore\r\n     * 选择文件后，根据浏览器差异进行处理\r\n     */\r\n    onFileChange(fileSel: any): void {\r\n        const uploadInst: any = this.tiFileSelect;\r\n        const files: any = TiUploadUtil.isHTML5 ? fileSel.files : fileSel; // 获取文件信息\r\n        const addedItems: Array<TiFileItem> = uploadInst._addToQueue(files); // 文件选择队列\r\n        if (TiUploadUtil.isHTML5) { // H5情况下，重置表单元素值，确保可重复选择文件\r\n            this.nativeElement.value = '';\r\n        } else { // 非H5情况下，确保文件下次可继续选择,分两种情况：1.已选文件有效情况下，,重新替换表单元素，确保文件点选元素不会随表单上传消失；\r\n            // 2.文件未加入到队列（文件校验失败情况）情况下，重置点选表单，确保文件可重复选择（校验失败可能是文件队列长度不符，所以为确保用户体验，执行该操作）\r\n            const isRemoveInput: boolean = (addedItems.length === 0); // 根据文件是否有效情况确定是否移除input\r\n            this.replaceFileInput(fileSel, isRemoveInput);\r\n        }\r\n\r\n        // 自动上传情况下，进行文件上传\r\n        if (uploadInst.config.autoUpload !== false && (addedItems.length !== 0)) {\r\n            uploadInst.uploadItems(addedItems);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 替换单个文件选择按钮，确保后续文件选择可继续点选\r\n     * 当前文件选择框\r\n     * 文件选择实例对象\r\n     */\r\n    replaceFileInput(fileSel: any, isRemoveInput: boolean): void {\r\n        // 清除当前文件输入框选择事件\r\n        this.fileChangeEvent();\r\n\r\n        // 新增input,并处理当前input\r\n        const fileSelNew: any = fileSel.cloneNode(); // 文件元素克隆时,不会复用原有已选文件信息\r\n        if (isRemoveInput) { // 文件选择无效情况下移除input，确保下次可正常选择\r\n            fileSel.parentNode.appendChild(fileSelNew);\r\n            fileSel.remove();\r\n        } else {\r\n            fileSel.style.display = 'none'; // 隐藏已选文件，确保点选框页面呈现的唯一性\r\n            fileSel.parentNode.insertBefore(fileSelNew, fileSel.nextSibling); // 点选文件已放入文件队列中,替换新的文件选择按钮，确保下次点选生效\r\n        }\r\n\r\n        // 增加当前input事件\r\n        this.fileChangeEvent = this.renderer.listen(fileSelNew, 'change', () => {\r\n            this.onFileChange(fileSelNew);\r\n        });\r\n    }\r\n}\r\n","import { TiUploadUtil } from './TiUploadUtil';\r\nimport { TiFileInfo, TiFileItem, TiUploadConfig, TiUploadRef } from './TiFileInterface';\r\nimport { Util } from '../../utils/Util';\r\n\r\n// 单个文件对象服务封装，包括文件基本信息统一、文件状态信息、文件基本方法封装\r\n/**\r\n * @ignore\r\n */\r\nexport class TiFileItemUtil {\r\n    /**\r\n     * 创建文件对象，该返回值用作后续文件的上传和文件操作，可作为文件回调参数传递\r\n     * fileObject 文件信息对象\r\n     * fileOrInpt 原始文件对象 H5下为file对象，非H5下为fileInput\r\n     * config 文件上传配置信息\r\n     * uploader 上传文件对应的文件实例\r\n     * return 文件对象\r\n     */\r\n    public static createFileItem(tifileObject: TiFileInfo, fileOrInput: Element | File,\r\n                                 config: TiUploadConfig, uploader: TiUploadRef): TiFileItem {\r\n        /* tslint:disable:no-invalid-this */\r\n        /* tslint:disable:no-null-keyword */\r\n        function upload(): void {\r\n            TiUploadUtil.uploadItems([this]);\r\n        }\r\n        function cancel(): void {\r\n            TiUploadUtil.cancelItems([this]);\r\n        }\r\n\r\n        function remove(isRemove?: boolean): void {\r\n            if (isRemove) {\r\n                // 触发外部定义的删除前的事件\r\n                TiUploadUtil.onBeforeRemove([this]);\r\n\r\n                return;\r\n            }\r\n\r\n            TiUploadUtil.removeItems([this]);\r\n        }\r\n\r\n        function destroy(): void {\r\n            if (this._input) { // 删除页面残留dom\r\n                this._input.remove();\r\n            }\r\n            if (this._form) {\r\n                this._form.remove();\r\n            }\r\n            this._input = null; // 清除引用\r\n            this._form = null;\r\n        }\r\n\r\n        // 上传文件对象赋值\r\n        let _file: any = null;\r\n        let _input: any = null;\r\n        if (!(fileOrInput instanceof Element)) {\r\n            _file = fileOrInput;\r\n        } else {\r\n            _input = fileOrInput;\r\n        }\r\n\r\n        return {\r\n            url: config.url || '/', // 后台地址\r\n            file: tifileObject,\r\n            alias: config.alias || 'tiFile', // 文件name\r\n            _file,\r\n            _input,\r\n            formData: config.formData || {},\r\n            formDataFirst: config.formDataFirst || false,\r\n            headers: config.headers || {},\r\n            method: config.method || 'post',\r\n            batchSend: config.batchSend || false,\r\n            uploader, // 上传实例对象\r\n\r\n            upload,\r\n            cancel,\r\n            remove,\r\n            destroy,\r\n\r\n            isReady: false,\r\n            isUploading: false,\r\n            isUploaded: false,\r\n            isCancel: false,\r\n            isSuccess: false,\r\n            isError: false,\r\n            progress: 0,\r\n\r\n            isHover: false,\r\n            isOverflow: false,\r\n            _xhr: {},\r\n            index: 0,\r\n            _form: undefined\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 创建文件对象，统一H5和非H5情况下的文件信息\r\n     * file {FileList|FileInput} 原始文件对象 H5为file对象形式，非H5为fileinput对象\r\n     * return 类文件对象\r\n     */\r\n    public static createFileObject(fileThis: any): TiFileInfo {\r\n        if (TiUploadUtil.isHTML5) {\r\n            const fileName: string = fileThis.name;\r\n\r\n            return {\r\n                lastModifiedDate: fileThis.lastModifiedDate,\r\n                size: fileThis.size, // 读取的文件真实大小值,单位为B\r\n                sizeWithUnit: TiFileItemUtil.formatSize(fileThis.size), // 做单位转换后的文件大小，方便界面详情显示显示\r\n                name: fileThis.name,\r\n                type: fileName.slice(fileName.lastIndexOf('.') + 1)\r\n                        .toLowerCase(), // 确保浏览器形式的一致性\r\n                _file: fileThis, // 文件对象，只在H5方式下有效\r\n                _input: null // 文件input对象，只在IE9 form表单提交方式下有效\r\n            };\r\n        }\r\n        const path: string = fileThis.value;\r\n        // 非H5情况下,浏览器不打开ActiveX,获取不到文件大小,该种情况下文件大小为null\r\n        const fileSize: number = Util.isUndefined(fileThis.size) ? null : fileThis.size;\r\n\r\n        return {\r\n            lastModifiedDate: null, // 非H5情况下,获取不到该值\r\n            size: fileSize,\r\n            sizeWithUnit: isNaN(fileSize) ? '' : this.formatSize(fileSize / 1024), // 做单位转换后的文件大小，方便界面详情显示显示\r\n            name: path.slice(path.lastIndexOf('/') + path.lastIndexOf('\\\\') + 2),\r\n            type: path.slice(path.lastIndexOf('.') + 1)\r\n                    .toLowerCase(),\r\n            _file: null, // 文件对象，只在H5方式下有效\r\n            _input: fileThis // 文件input对象，只在IE9 form表单提交方式下有效\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 将文件大小显示标准化：根据文件大小做不同单位的显示，文件大小保留两位小数\r\n     * 文件大小\r\n     * 带单位文件大小\r\n     */\r\n    private static formatSize(size: number): string {\r\n        let sizeWithUnit: string;\r\n        const kbSize: number = size / 1024;\r\n        /* tslint:disable:prefer-conditional-expression */\r\n        if (kbSize < 1) {\r\n            sizeWithUnit = size.toFixed(2) + 'B';\r\n        } else if (kbSize < 1024) {\r\n            sizeWithUnit = kbSize.toFixed(2) + 'KB';\r\n        } else if (kbSize < 1024 * 1024) {\r\n            sizeWithUnit = (kbSize / 1024).toFixed(2) + 'MB';\r\n        } else {\r\n            sizeWithUnit = (kbSize / 1024 / 1024).toFixed(2) + 'GB';\r\n        }\r\n\r\n        return sizeWithUnit;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n/**\r\n * @ignore\r\n * 此TiUploadServiceModule不对用户暴露，用户仅需import TiUploadModule，则间接引入了TiUploadServiceModule\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ]\r\n})\r\nexport class TiUploadServiceModule {\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiFileItemUtil } from './TiFileItemUtil';\r\nimport { TiUploadUtil } from './TiUploadUtil';\r\nimport { TiUploadServiceModule } from './TiUploadServiceModule';\r\nimport { TiFileInfo, TiFileItem, TiFilter, TiUploadConfig, TiUploadRef } from './TiFileInterface';\r\n\r\n// 文件上传服务封装，一个实例对应一个上传文件队列\r\n// @dynamic\r\n/**\r\n * 文件上传服务，通过该服务生成上传文件实例对象，一个实例对应一个上传文件队列\r\n *\r\n * 该服务适用于自定义文件上传实例方式，使用该服务时需要引入模块TiUploadServiceModule，与[tiFileSelect]{@link ../directives/TiFileSelectDirective.html}配合使用\r\n *\r\n * 除自定义使用方式外，Tiny还提供了两种已设计的上传样式供业务使用，具体见[TiUploadComponent]{@link ../components/TiUploadComponent.html}\r\n *\r\n * <example-url>../tiny3demo/#/upload/upload-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiUploadServiceModule\r\n})\r\nexport class TiUploadService {\r\n    // 文件校验规则定义\r\n    private static readonly filterRules: any = {\r\n        maxSize: (fileObj: TiFileInfo, params: Array<any>): boolean => {\r\n            const size: number = fileObj.size;\r\n            if (!Util.isNumber(size)) { // 文件大小获取不到情况下，忽略该条校验规则\r\n                return true;\r\n            }\r\n\r\n            return !(size > params[0]);\r\n        },\r\n        minSize: (fileObj: TiFileInfo, params: Array<any>): boolean => {\r\n            const size: number = fileObj.size;\r\n            if (!Util.isNumber(size)) { // 文件大小获取不到情况下，忽略该条校验规则\r\n                return true;\r\n            }\r\n\r\n            return !(size < params[0]);\r\n        },\r\n        type: (fileObj: TiFileInfo, params: Array<any>): boolean => {\r\n            // param参数需使用文件扩展名分开，为了确保各浏览器的一致性，文件类型使用扩展名判断，如果产品需要在选择时限制，请在input上设置accept属性\r\n            let isValidType: boolean = false;\r\n            params[0].split(',')\r\n                .forEach((type: string) => {\r\n                if (fileObj.name.match(new RegExp(`.(${type.replace(/\\./g, '\\\\.')})$`, 'i')) !== null) {\r\n                    isValidType = true;\r\n                }\r\n            });\r\n\r\n            return isValidType;\r\n        },\r\n        maxCount: (fileObj: TiFileInfo, params: Array<any>, fileQueue: Array<TiFileItem>): boolean  => {\r\n            return !(fileQueue.length >= params[0]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 对单选进行过滤条件重置，单选去除maxCount条件，函数返回过滤后的生效规则\r\n     */\r\n    private static initFilter(rules: Array<TiFilter>, isSingleFile: boolean): Array<TiFilter> {\r\n        if (isSingleFile) { // 单文件情况下去除maxCount设置\r\n            return rules.filter((rule: TiFilter) => {\r\n                return rule.name !== 'maxCount';\r\n            });\r\n        }\r\n\r\n        // 多文件情况下 filter不做处理\r\n        return rules || [];\r\n    }\r\n    /**\r\n     * 根据用户配置的maxCount过滤条件，判断文件是否为单文件上传\r\n     * 用户配置的过滤条件\r\n     * 是否为单文件上传\r\n     */\r\n    private static isSingleFileFn(filters: Array<TiFilter>): boolean {\r\n        if (!filters || !filters.length) { // 不设置filter情况下，为多文件上传\r\n            return false;\r\n        }\r\n        const maxCountIndex: number = filters.findIndex((item: TiFilter): boolean => {\r\n            return item.name === 'maxCount';\r\n        });\r\n        // 存在maxCount规则，并且其参数不为1的情况下，为多文件上传\r\n        if (maxCountIndex === -1 || (filters[maxCountIndex].params && filters[maxCountIndex].params[0] !== 1)) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 批量上传文件\r\n     *   {Array} 上传文件items数组\r\n     * 返回 无\r\n     */\r\n    private static uploadItems(items: Array<TiFileItem>): void {\r\n        if (!items.length) {\r\n            return;\r\n        }\r\n        // 设置上传文件标志位,文件逐个上传情况下,会根据该标志位决定下个上传文件\r\n        items.forEach((item: TiFileItem) => {\r\n            item.isReady = true;\r\n        });\r\n\r\n        // 开始上传文件\r\n        if (items[0].batchSend) {\r\n            TiUploadUtil.uploadItems(items);\r\n        } else { // 上传单个文件，在upload方法中会依据isReady的设置进行其他文件的串行上传\r\n            TiUploadUtil.uploadItems([items[0]]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 批量取消上传文件\r\n     * 返回 无\r\n     */\r\n    private static cancelItems(items: Array<TiFileItem>): void {\r\n        if (!items.length) {\r\n            return;\r\n        }\r\n        if (items[0].batchSend) { // 一个链接上传情况下，一次取消多个items，仅触发一次事件\r\n            TiUploadUtil.cancelItems(items);\r\n        } else { // 逐个链接上传情况下，一次仅取消一个items，触发多次事件\r\n            items.forEach((item: TiFileItem) => {\r\n                item.cancel();\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 批量删除文件,只涉及上传队列的文件删除，具体的后台删除还需要产品向后台发送文件删除请求实现\r\n     *   {Array} 上传文件items数组\r\n     * 返回 无\r\n     */\r\n    private static removeItems(items: Array<TiFileItem>): void {\r\n        if (!items.length) {\r\n            return;\r\n        }\r\n        if (items[0].batchSend) { // 一个链接上传情况下，一次删除多个items，仅触发一次事件\r\n            TiUploadUtil.removeItems(items);\r\n        } else { // 逐个链接上传情况下，一次仅删除一个items，触发多次事件\r\n            items.forEach((item: TiFileItem) => {\r\n                item.remove();\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 单个文件的有效性校验\r\n     * 返回 {Array} 由不符合的规则name组成的数组\r\n     */\r\n    private static getInvalidRules(tifileObject: TiFileInfo, filtersRules: Array<TiFilter>, fileQueue: Array<TiFileItem>): Array<string> {\r\n        // 无效判断\r\n        const filterLen: number = filtersRules.length;\r\n        if (filterLen === 0) {\r\n            return [];\r\n        }\r\n\r\n        // 逐条规则校验，并返回结果数组\r\n        const invalidRetArr: Array<string> = []; // 校验返回结果数组，该数组中返回的是不符合的校验规则name\r\n        for (let i: number = 0; i < filterLen; i++) {\r\n            const filterConfig: TiFilter = filtersRules[i]; // 单条校验规则配置\r\n\r\n            // 根据配置寻找规则函数（规则分为默认规则 和 自定义规则）\r\n            const filterName: string = filterConfig.name; // 配置规则名称\r\n            let ruleFn: (fileObj: TiFileInfo, params: Array<any>, fileQueue: Array<TiFileItem>) => boolean; // 规则函数\r\n            if (typeof filterConfig.fn === 'function') {\r\n                ruleFn = filterConfig.fn;\r\n            } else if (TiUploadService.filterRules[filterName]) { // 未定义fn的情况下，从默认规则中找\r\n                ruleFn = TiUploadService.filterRules[filterName];\r\n            }\r\n\r\n            // 调用规则函数，判断文件有效性\r\n            if ((typeof ruleFn === 'function') &&\r\n                !ruleFn(tifileObject, filterConfig.params, fileQueue)) {\r\n                invalidRetArr.push(filterName);\r\n            }\r\n        }\r\n\r\n        return invalidRetArr;\r\n    }\r\n    /**\r\n     * 获取未上传文件队列\r\n     */\r\n    private static getNotUploadedItems(fileQueue: Array<TiFileItem>): Array<TiFileItem> {\r\n        return fileQueue.filter((item: TiFileItem): boolean => {\r\n            return !item.isUploaded;\r\n        });\r\n    }\r\n    /**\r\n     * 获取待上传文件，该方法用于文件批量上传时获取上传文件队列\r\n     * 返回 {Array} 返回待上传文件，且文件队列返回值是根据文件点选次序排列\r\n     */\r\n    private static getReadyItems(fileQueue: Array<TiFileItem>): Array<TiFileItem> {\r\n        return fileQueue.filter((item: TiFileItem): boolean => {\r\n            return item.isReady && !item.isUploading;\r\n        })\r\n        .sort((item1: TiFileItem, item2: TiFileItem): number  => {\r\n            return item1.index - item2.index;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 获取上传失败文件，该方法用于文件批量上传时获取上传失败文件队列\r\n     * 返回 {Array} 返回上传失败文件，且文件队列返回值是根据文件点选次序排列\r\n     */\r\n    private static getErrorItems(fileQueue: Array<TiFileItem>): Array<TiFileItem> {\r\n        return fileQueue.filter((item: TiFileItem): boolean => {\r\n            return item.isError;\r\n        })\r\n        .sort((item1: TiFileItem, item2: TiFileItem): number => {\r\n            return item1.index - item2.index;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 重新上传列表中所有先前上传错误文件\r\n     * 返回 无\r\n     */\r\n    private static reloadAllError(fileQueue: Array<TiFileItem>): void {\r\n        TiUploadService.uploadItems(TiUploadService.getErrorItems(fileQueue));\r\n    }\r\n\r\n    /**\r\n     * 重新上传列表中所有文件\r\n     * 返回 无\r\n     */\r\n    private static reloadAll(fileQueue: Array<TiFileItem>): void {\r\n        TiUploadService.uploadItems(fileQueue);\r\n    }\r\n\r\n    /**\r\n     * 上传列表中所有未上传过的文件\r\n     * 返回 无\r\n     */\r\n    private static uploadAll(fileQueue: Array<TiFileItem>): void {\r\n        const items: Array<TiFileItem> = this.getNotUploadedItems(fileQueue)\r\n            .filter((item: TiFileItem): boolean => {\r\n            return !item.isUploading;\r\n        });\r\n        TiUploadService.uploadItems(items);\r\n    }\r\n\r\n    /**\r\n     * 判断是否有未上传的\r\n     * 返回 boolean\r\n     */\r\n    private static isUploadedAll(fileQueue: Array<TiFileItem>): boolean {\r\n        const items: Array<TiFileItem>  = this.getNotUploadedItems(fileQueue)\r\n            .filter((item: TiFileItem): boolean => {\r\n            return !item.isUploading;\r\n        });\r\n\r\n        return items.length === 0;\r\n    }\r\n\r\n    /**\r\n     * 删除所有队列中的文件\r\n     */\r\n    private static removeAll(fileQueue: Array<TiFileItem>): void {\r\n        while (fileQueue.length !== 0) {\r\n            fileQueue[0].remove();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 取消所有队列中的文件(未上传和待上传文件)\r\n     */\r\n    private static cancelAll(fileQueue: Array<TiFileItem>): void {\r\n        const items: Array<TiFileItem>  = this.getNotUploadedItems(fileQueue);\r\n        TiUploadService.cancelItems(items);\r\n    }\r\n\r\n    /**\r\n     * 创建文件上传实例\r\n     */\r\n    create(config: TiUploadConfig): TiUploadRef {\r\n        const isSingleFile: boolean = TiUploadService.isSingleFileFn(config.filters); // 文件是否为单文件设置\r\n        const filters: Array<TiFilter> = TiUploadService.initFilter(config.filters, isSingleFile); // 文件校验过滤规则\r\n\r\n        let uploader: TiUploadRef;\r\n        const fileQueue: Array<TiFileItem> = []; // 文件队列列表，一个实例对应一个文件列表\r\n        let fileIndex: number = 0; // 文件次序定义，用作文件索引\r\n        /**\r\n         * 将选择的文件进行有效验证后加入到队列中,外部调用该方法时,认为该队列中的文件和当前uploader的配置项一致\r\n         *   files {FileList|FileInput} 文件对象\r\n         * 返回 {Array} 已添加文件数组\r\n         */\r\n        const addToQueue: (files: FileList | Element) => Array<TiFileItem> =\r\n            (files: FileList | Element): Array<TiFileItem> => {\r\n            // 循环列表添加文件\r\n            const addedItems: Array<TiFileItem> = []; // 用于记录本次选择文件列表\r\n            if (files && !Util.isUndefined((files as FileList).length)) { // H5方式\r\n                for (let i: number = 0; i < (files as FileList).length; i++) {\r\n                    addItem(files[i], addedItems);\r\n                }\r\n            } else {\r\n                addItem(files, addedItems);\r\n            }\r\n\r\n            return addedItems;\r\n        };\r\n        const addItem: (fileOrInput: any, addedItems: Array<any>) => void =\r\n            (fileOrInput: any, addedItems: Array<any>): void => {\r\n            // 文件对象，该对象包含文件的基本信息，统一了浏览器的差异性，会在文件过滤失败回调中作为参数传递给外部\r\n            const tifileObject: TiFileInfo = TiFileItemUtil.createFileObject(fileOrInput);\r\n\r\n            // 校验单个文件的有效性，并根据校验结果进行文件操作\r\n            const invalidArr: Array<string> = TiUploadService.getInvalidRules(tifileObject, filters, fileQueue); // 校验结果数组，数组中定义校验错误规则的name\r\n            let isValid: boolean = !invalidArr.length; // 校验结果返回数组为空时有效\r\n\r\n            // 单文件情况下，需要覆盖原有有效文件\r\n            if (isSingleFile) {\r\n                if (fileQueue[0]) {\r\n                    fileQueue[0].remove(); // 删除先前队列中的文件\r\n                }\r\n                if (invalidArr.length === 0) {\r\n                    isValid = true; // 置位校验结果值\r\n                }\r\n            }\r\n            if (isValid) { // 校验成功情况下，将文件加入到上传队列中，并触发\r\n                // 上传文件对象,该对象中包含文件及状态信息等,在回调中传递\r\n                const fileItem: TiFileItem = TiFileItemUtil.createFileItem(tifileObject, fileOrInput,\r\n                    config, uploader);\r\n                addedItems.push(fileItem);\r\n                fileQueue.push(fileItem);\r\n                fileItem.index = ++fileIndex; // 文件序列数增加，确保整个文件队列中该值唯一\r\n                if (typeof config.onAddItemSuccess === 'function') {\r\n                    config.onAddItemSuccess(fileItem);\r\n                }\r\n            } else if (typeof config.onAddItemFailed === 'function') {\r\n                config.onAddItemFailed(tifileObject, invalidArr);\r\n            }\r\n        };\r\n        uploader = {\r\n            queue: fileQueue, // 上传文件队列,可读属性\r\n            isSingleFile, // 文件是否有单文件选择限制\r\n            config, // 是否自动上传文件\r\n            _addToQueue: addToQueue, // 文件添加方法\r\n            getNotUploadedItems(): Array<TiFileItem> {\r\n                return TiUploadService.getNotUploadedItems(fileQueue);\r\n            }, // 未上传完成文件获取\r\n            getReadyItems(): Array<TiFileItem> {\r\n                return TiUploadService.getReadyItems(fileQueue);\r\n            }, // 已提交上传，但还未上传文件获取\r\n            uploadAll(): void {\r\n                TiUploadService.uploadAll(fileQueue);\r\n            }, // 上传队列中所有还未执行过上传的文件\r\n            isUploadedAll(): boolean {\r\n                return TiUploadService.isUploadedAll(fileQueue);\r\n            }, // 上传队列中是否有未上传过的\r\n            removeAll(): void {\r\n                TiUploadService.removeAll(fileQueue);\r\n            }, // 删除队列中所有文件\r\n            cancelAll(): void {\r\n                TiUploadService.cancelAll(fileQueue);\r\n            }, // 取消队列中所有上传文件\r\n            reloadAll(): void {\r\n                TiUploadService.reloadAll(fileQueue);\r\n            }, // 重新上传队列中所有文件\r\n            reloadAllError(): void {\r\n                TiUploadService.reloadAllError(fileQueue);\r\n            }, // 重新上传队列中所有上传错误文件\r\n            uploadItems: TiUploadService.uploadItems, // 上传队列中某几项文件\r\n            removeItems: TiUploadService.removeItems, // 删除队列中某几项文件\r\n            cancelItems: TiUploadService.cancelItems // 取消队列中某几项文件\r\n        };\r\n\r\n        return uploader;\r\n    }\r\n}\r\n","import { Component, ElementRef, EventEmitter, Input, OnInit, Output, Renderer2 } from '@angular/core';\r\nimport { TiFileInfo, TiFileItem, TiFilter, TiUploadConfig, TiUploadRef } from '../../services/upload/TiFileInterface';\r\nimport { TiBaseComponent } from '../base/TiBaseModule';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\n\r\n/**\r\n * 10.0.2版本抽取\r\n *\r\n * upload基类，继承于TiBaseComponent组件\r\n */\r\n@Component({\r\n    selector: 'ti-uploadbase',\r\n    template: ''\r\n})\r\nexport class TiUploadbaseComponent extends TiBaseComponent implements OnInit {\r\n\r\n    /**\r\n     * 文件上传地址配置\r\n     */\r\n    @Input() url: string;\r\n    /**\r\n     * 上传方式，可选值为：get/post(其他方式IE9不支持，因此暂不开放)\r\n     */\r\n    @Input() method: 'get'|'post' = 'post';\r\n    /**\r\n     * 文件有效性判断条件数组\r\n     */\r\n    @Input() filters: Array<TiFilter>;\r\n    /**\r\n     * 向后台发送请求时对应的文件对象name属性，该name属性是后台读取文件的入口值\r\n     */\r\n    @Input() alias: string = 'tiFile';\r\n    /**\r\n     * 上传文件附带信息，数据类型为对象形式\r\n     */\r\n    @Input() formData: object;\r\n    /**\r\n     * 上传对象信息中，formData是否先于file对象，适用于后台传输时，formData数据先于file对象的场景\r\n     */\r\n    @Input() formDataFirst: boolean = false;\r\n    /**\r\n     * 文件选中后是否自动上传\r\n     */\r\n    @Input() autoUpload: boolean = true;\r\n    /**\r\n     * 文件上传是否 是否一次请求传输多个文件，默认情况下一次请求上传一个文件\r\n     */\r\n    @Input() batchSend: boolean = false;\r\n    /**\r\n     * 上传文件请求头配置，自定义为对象形式\r\n     */\r\n    @Input() headers: object;\r\n    /**\r\n     * 文件类型过滤配置，适用于IE10+浏览器，能做到文件弹窗中不出现非法类型的文件，主要适用于两种场景：\r\n     *\r\n     * 1.过滤规则中带类型过滤，但是想要去掉文件选择框中文件过滤的场景（设置accept为空字符串即可）：此种场景应用于浏览器设置accept后导致文件窗打开很慢的情况\r\n     *\r\n     * 2.不需要定义文件类型过滤条件，但是通过accept能精确的确保文件类型的场景\r\n     */\r\n    @Input() accept: string;\r\n\r\n    /**\r\n     * 是否禁用\r\n     */\r\n    @Input() disabled: boolean = false;\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    title: string = TiBrowser.isChrome() ? ' ' : ''; // 禁用文件上传默认tip提示,Chrome下设置title为\"\"时会显示默认提示，所以Chrome下需要设置为\" \";而IE下设置为\" \"会显示文本为空的tip\r\n\r\n    /**\r\n     * 文件添加失败回调，可使用该回调定义上传错误提示\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * file: [TiFileInfo]{@link ../interfaces/TiFileInfo.html}, // 上传文件信息\r\n     *\r\n     * validResults: Array&lt;string&gt;  // 校验不合法的规则name数组\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly addItemFailed: EventEmitter<{file: TiFileInfo, validResults: Array<string>}> =\r\n        new EventEmitter<{file: TiFileInfo, validResults: Array<string>}>();\r\n    /**\r\n     * 文件添加成功回调\r\n     *\r\n     * 参数：文件对象\r\n     */\r\n    @Output() readonly addItemSuccess: EventEmitter<TiFileItem> = new EventEmitter<TiFileItem>();\r\n    // 以下回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n    /**\r\n     * 上传文件前回调，可在该回调中动态设置formData\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为数组形式，代表上传的文件对象\r\n     */\r\n    @Output() readonly beforeSendItems: EventEmitter<Array<TiFileItem>> = new EventEmitter<Array<TiFileItem>>();\r\n    /**\r\n     * 上传文件进度改变回调\r\n     *\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * fileItems: Array<[TiFileItem]{@link ../interfaces/TiFileItem.html}>, // 上传文件对象数组\r\n     *\r\n     * progress: number  // 进度信息\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly progressItems: EventEmitter<{fileItems: Array<TiFileItem>, progress: number}> =\r\n        new EventEmitter<{fileItems: Array<TiFileItem>, progress: number}>();\r\n    /**\r\n     * 文件上传完成回调，成功/失败都会触发\r\n     *\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * fileItems: Array<[TiFileItem]{@link ../interfaces/TiFileItem.html}>, // 上传文件对象数组\r\n     *\r\n     * response: string  // 文件上传响应信息\r\n     *\r\n     * status: number 文件上传响应状态码\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly completeItems: EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}> =\r\n        new EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}>();\r\n    /**\r\n     * 文件上传成功回调\r\n     *\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * fileItems: Array<[TiFileItem]{@link ../interfaces/TiFileItem.html}>, // 上传文件对象数组\r\n     *\r\n     * response: string  // 文件上传响应信息\r\n     *\r\n     * status: number 文件上传响应状态码\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly successItems: EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}> =\r\n        new EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}>();\r\n    /**\r\n     * 文件上传失败回调\r\n     *\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * fileItems: Array<[TiFileItem]{@link ../interfaces/TiFileItem.html}>, // 上传文件对象数组\r\n     *\r\n     * response: string  // 文件上传响应信息\r\n     *\r\n     * status: number 文件上传响应状态码\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly errorItems: EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}> =\r\n        new EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}>();\r\n    /**\r\n     * 文件上传取消回调\r\n     *\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为对象形式，结构如下：\r\n     *\r\n     * {\r\n     *\r\n     * fileItems: Array<[TiFileItem]{@link ../interfaces/TiFileItem.html}>, // 上传文件对象数组\r\n     *\r\n     * response: string  // 文件上传响应信息\r\n     *\r\n     * status: number 文件上传响应状态码\r\n     *\r\n     * }\r\n     */\r\n    @Output() readonly cancelItems: EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}> =\r\n        new EventEmitter<{fileItems: Array<TiFileItem>, response: string, status: number}>();\r\n    /**\r\n     * 上传删除回调\r\n     * 该回调对单个或多个文件在同一url同时上传有效，可使用其进行文件上传过程中的业务处理\r\n     *\r\n     * 参数为数组形式，代表在操作的文件对象\r\n     */\r\n    @Output() readonly removeItems: EventEmitter<Array<TiFileItem>> = new EventEmitter<Array<TiFileItem>>();\r\n    /**\r\n     * 所有文件上传完成回调\r\n     *\r\n     * 参数为数组形式，代表在操作的文件对象\r\n     */\r\n    @Output() readonly completeAllItems: EventEmitter<Array<TiFileItem>> = new EventEmitter<Array<TiFileItem>>();\r\n    /**\r\n     * 上传文件删除前的回调\r\n     *\r\n     * 参数为数组形式，代表在操作的文件对象\r\n     */\r\n    @Output() readonly beforeRemoveItems: EventEmitter<Array<TiFileItem>> = new EventEmitter<Array<TiFileItem>>();\r\n\r\n    /**\r\n     * 上传实例的配置信息\r\n     */\r\n    public uploadConfig: TiUploadConfig;\r\n\r\n    /**\r\n     * @ignore 生成的上传文件实例\r\n     */\r\n    public uploadInst: TiUploadRef;\r\n\r\n    /**\r\n     * @ignore 词条\r\n     */\r\n    // tslint:disable-next-line:typedef\r\n    public uploadLan = (TiLocale.getLocaleWords() as TiLocaleWords).tiUpload;\r\n\r\n    constructor(protected hostRef: ElementRef, protected renderer: Renderer2) {\r\n        super(hostRef, renderer);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.uploadConfig = {\r\n            url: this.url, // 文件上传地址配置\r\n            method: this.method, // 上传方式，可选值为：get、post(其他方式IE9不支持)\r\n            filters: this.filters, // 文件有效性判断条件数组\r\n            alias: this.alias, // 向后台发送请求时对应的文件对象name属性，该name属性是后台读取文件的入口值，默认值为 'tiFile'\r\n            formData: this.formData, // 上传文件附带信息\r\n            autoUpload: this.autoUpload, // 是否自动上传，默认为true\r\n            batchSend: this.batchSend || false, // 是否一次性上传多个文件\r\n            formDataFirst: this.formDataFirst || false, // formData是否先于file对象\r\n            headers: this.headers, // 上传文件请求头配置\r\n            onAddItemFailed: (file: TiFileInfo, validResults: Array<string>): void => {\r\n                this.addItemFailed.emit({file, validResults});\r\n            },\r\n            onAddItemSuccess: (fileItem: TiFileItem): void => {\r\n                this.addItemSuccess.emit(fileItem);\r\n            },\r\n            onBeforeSendItems: (fileItems: Array<TiFileItem>): void => {\r\n                this.beforeSendItems.emit(fileItems);\r\n            },\r\n            onProgressItems: (fileItems: Array<TiFileItem>, progress: number): void => {\r\n                this.progressItems.emit({fileItems, progress});\r\n            },\r\n            onCompleteItems: (fileItems: Array<TiFileItem>, response: string, status: number): void => {\r\n                this.completeItems.emit({fileItems, response, status});\r\n            },\r\n            onSuccessItems: (fileItems: Array<TiFileItem>, response: string, status: number): void => {\r\n                this.successItems.emit({fileItems, response, status});\r\n            },\r\n            onErrorItems: (fileItems: Array<TiFileItem>, response: string, status: number): void => {\r\n                this.errorItems.emit({fileItems, response, status});\r\n            },\r\n            onCancelItems: (fileItems: Array<TiFileItem>, response: string, status: number): void  => {\r\n                this.cancelItems.emit({fileItems, response, status});\r\n            },\r\n            onRemoveItems: (fileItems: Array<TiFileItem>): void => {\r\n                this.removeItems.emit(fileItems);\r\n            },\r\n            onBeforeRemoveItems: (fileItems: Array<TiFileItem>): void => {\r\n                this.beforeRemoveItems.emit(fileItems);\r\n            },\r\n            onCompleteAllItems: (fileItems: Array<TiFileItem>): void => {\r\n                this.completeAllItems.emit(fileItems);\r\n            }\r\n        };\r\n        // 根据配置的文件类型过滤属性设置H5下的文件过滤属性,如果accept未定义,则按照type过滤条件进行设置；\r\n        // 如果accept已定义，则按照accept定义设置：此种场景应用于浏览器设置accept后导致文件窗打开很慢的情况\r\n        if (Util.isUndefined(this.accept) && this.filters && this.filters.length) {\r\n            this.filters.forEach((filter: TiFilter) => {\r\n                if (filter.name === 'type') {\r\n                    this.accept = filter.params[0];\r\n                }\r\n\r\n                return;\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 手动上传，可以通过组件调用\r\n     */\r\n    public upload(): void {\r\n        this.uploadInst.uploadAll();\r\n    }\r\n\r\n}\r\n","import { Component, ElementRef, Input, Renderer2, ViewChild } from '@angular/core';\r\nimport { TiFileItem } from '../../services/upload/TiFileInterface';\r\nimport { TiUploadService } from '../../services/upload/TiUploadService';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiOverflowService } from '../../services/overflow/TiOverflowService';\r\nimport { TiUploadbaseComponent } from './TiUploadbaseComponent';\r\n\r\n/**\r\n * 该组件用于实现已设计好的交互完整的文件上传组件，包含两种样式：\r\n *\r\n * 1.带输入框的样式(type为inputField)\r\n *\r\n * 2.按钮样式(type为button)\r\n *\r\n * 如果以上两种样式不满足业务场景，可使用自定义方式实现，具体实现请参考[tiFileSelect]{@link ../directives/TiFileSelectDirective.html}\r\n *\r\n * <example-url>../tiny3demo/#/upload/upload-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-upload:not([type]), ti-upload[type=\"inputField\"], ti-upload[type=\"button\"]',\r\n    templateUrl: './upload.html',\r\n    styleUrls: ['./upload.less']\r\n})\r\n\r\nexport class TiUploadComponent extends TiUploadbaseComponent {\r\n    constructor(private uploaderService: TiUploadService, hostEle: ElementRef, renderer: Renderer2,\r\n                private tiOverflow: TiOverflowService) {\r\n        super(hostEle, renderer);\r\n    }\r\n    /**\r\n     * 上传样式类型\r\n     */\r\n    @Input() type: 'inputField'|'button' = 'inputField';\r\n    /**\r\n     * 按钮的配置\r\n     *\r\n     * type为button形式时,为文件选择按钮文字；\r\n     *\r\n     * type为inputField时,为上传按钮文字\r\n     */\r\n    @Input() buttonText: string; // 按钮的配置,type为button形式时,为文件选择按钮文字；type为inputField时,为上传按钮文字\r\n\r\n    // inputField形式文件上传的相关配置\r\n    /**\r\n     * 选择输入框宽度设置，只适用于inputField类型，数据类型同css width属性设置\r\n     */\r\n    @Input() inputFieldWidth: string;\r\n    /**\r\n     * 是否显示提交按钮，只适用于inputField类型\r\n     *\r\n     * 默认值与autoUpload值相关，当autoUpload为true时，不显示；反之则显示\r\n     */\r\n    @Input() showSubmitButton: boolean;\r\n    /**\r\n     * 输入提示，只适用于inputField类型\r\n     */\r\n    @Input() placeholder: string;\r\n    /**\r\n     * 是否自动聚焦，只适用于inputField类型\r\n     */\r\n    @Input() autofocus: boolean = false;\r\n    /**\r\n     * @ignore\r\n     */\r\n    @ViewChild('fileInput') fileInput: any;\r\n    /**\r\n     * @ignore 多文件上传的状态提示信息\r\n     */\r\n    stateInfo: string;\r\n    /**\r\n     * @ignore 是否定义beforeRemoveItems事件\r\n     */\r\n    isRemove: boolean;\r\n    /**\r\n     * @ignore 点击上传按钮触发事件\r\n     */\r\n    onSelectClick(): void {\r\n        this.fileInput.nativeElement.click();\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 创建uploader实例\r\n        const autoUpload: boolean = Util.isUndefined(this.autoUpload) ? true : this.autoUpload;\r\n        this.uploadConfig.autoUpload = autoUpload;\r\n        this.uploadInst = this.uploaderService.create(this.uploadConfig);\r\n        this.placeholder = this.setPlaceholder();\r\n        // 设置submit按钮的显示状态\r\n        this.showSubmitButton = Util.isUndefined(this.showSubmitButton) ?\r\n            !autoUpload : this.showSubmitButton;\r\n        // 是否定义beforeRemoveItems事件\r\n        this.isRemove = this.beforeRemoveItems.observers.length !== 0;\r\n    }\r\n    // tslint:disable-next-line:use-life-cycle-interface\r\n    ngAfterViewInit(): void {\r\n        super.ngAfterViewInit();\r\n        // 处理autofocus\r\n        if (this.autofocus === true) {\r\n            this.focus();\r\n        }\r\n    }\r\n    // 提供focus/blur方法，供外部调用\r\n    /**\r\n     * 聚焦方法，只适用于inputField类型\r\n     */\r\n    focus(): void {\r\n        this.fileInput.nativeElement.nextElementSibling.focus();\r\n    }\r\n    /**\r\n     * 失焦方法，只适用于inputField类型\r\n     */\r\n    blur(): void {\r\n        this.fileInput.nativeElement.nextElementSibling.blur();\r\n    }\r\n    // 通过item元素的移入移出事件控制元素的hover状态，该hover状态会决定item中部分按钮的显示状态\r\n    /**\r\n     * @ignore\r\n     */\r\n    onItemMouseenter(item: TiFileItem, event: any): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        item.isHover = true;\r\n        // 文件名超长溢出时，显示名称\r\n        const fileNameEle: Element = event.target.querySelector('.ti3-aui-file-name');\r\n        item.isOverflow = this.tiOverflow.isOverflow(fileNameEle);\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    onItemMouseleave(item: TiFileItem): void {\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        item.isHover = false;\r\n    }\r\n    // 获取上传文件状态，同时根据状态设置状态详细信息\r\n    /**\r\n     * @ignore\r\n     */\r\n    getUploadState(): string {\r\n        let uploadingLen: number = 0;\r\n        let uploadErrLen: number = 0;\r\n        let uploadSuccLen: number = 0;\r\n        this.uploadInst.queue.forEach((item: TiFileItem) => {\r\n            if (item.isUploading) {\r\n                uploadingLen++;\r\n            } else if (item.isError) {\r\n                uploadErrLen++;\r\n            } else if (item.isSuccess) {\r\n                uploadSuccLen++;\r\n            }\r\n        });\r\n        const fileQueueLen: number = this.uploadInst.queue.length;\r\n        if (uploadSuccLen === fileQueueLen) {\r\n            this.stateInfo = this.uploadLan.successInfo;\r\n\r\n            return 'success';\r\n        }\r\n        if (uploadErrLen !== 0) {\r\n            this.stateInfo = Util.formatEntry(this.uploadLan.errorMultiInfo, [uploadErrLen]);\r\n\r\n            return 'error';\r\n        }\r\n        if (uploadingLen !== 0) {\r\n            this.stateInfo = Util.formatEntry(this.uploadLan.uploadingMutiInfo, [`${uploadingLen}/${fileQueueLen}`]);\r\n\r\n            return 'uploading';\r\n        }\r\n        this.stateInfo = Util.formatEntry(this.uploadLan.addSuccessMutiInfo, [fileQueueLen]);\r\n\r\n        return 'addSuccess';\r\n    }\r\n    /**\r\n     * 初始设置输入框内提示文本\r\n     * 四种场景：自动单文件上传，自动多文件上传，手动单文件上传，手动多文件上传\r\n     */\r\n    private setPlaceholder(): string {\r\n        if (this.placeholder) {\r\n            return this.placeholder;\r\n        }\r\n\r\n        if (this.autoUpload) {\r\n            if (this.uploadInst.isSingleFile) {\r\n                return this.uploadLan.autoUploadFilePlaceholder;\r\n            }\r\n\r\n            return this.uploadLan.autoUploadFilesPlaceholder;\r\n        }\r\n\r\n        if (this.uploadInst.isSingleFile) {\r\n            return this.uploadLan.notAutoUploadFilePlaceholder;\r\n        }\r\n\r\n        return this.uploadLan.notAutoUploadFilesPlaceholder;\r\n    }\r\n}\r\n","import { Directive, ElementRef, Input, Renderer2 } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@Directive({\r\n    selector: '[tiDisabled]'\r\n})\r\n\r\nexport class TiDisabledDirective {\r\n    constructor(private hostEle: ElementRef, private renderer: Renderer2) {\r\n    }\r\n    @Input()\r\n    set tiDisabled(value: boolean) {\r\n        if (value) {\r\n            this.renderer.setAttribute(this.hostEle.nativeElement, 'disabled', 'disabled');\r\n        } else {\r\n            this.renderer.removeAttribute(this.hostEle.nativeElement, 'disabled');\r\n        }\r\n    }\r\n}\r\n","import { ComponentRef, Injectable, TemplateRef } from '@angular/core';\r\nimport { TiPopUpRef, TiPopupService } from '../popup/TiPopupService';\r\nimport { TiBackdropComponent } from './TiBackdropComponent';\r\nimport { TiBackdropNoAnimationComponent } from './TiBackdropNoAnimationComponent';\r\nimport { TiModalComponent } from './TiModalComponent';\r\nimport { TiModalNoAnimationComponent } from './TiModalNoAnimationComponent';\r\nimport { TiBrowser, Util } from '../../utils/Util';\r\nimport { TiModalModule } from './TiModalModule';\r\nimport { TiModalConfig, TiModalRef } from './TiModalInterface';\r\n\r\n\r\n/**\r\n * 弹框组件提供服务方式供业务使用，使用该服务时需要引入模块TiModalModule，开发者通过调用TiModalService.open方法生成弹出框\r\n *\r\n * <p><span style=\"color: red\">使用此组件时需要开发者在项目模块(建议在根模块)\r\n * 中引入BrowserAnimationsModule。</span>这是因为此组件中使用了Angular动画，需要引入BrowserAnimationsModule，\r\n * 但是 BrowserAnimationsModule 不能在懒加载模块被重复引入，所以需要开发者来引入BrowserAnimationsModule，保证其引入一次。</p>\r\n *\r\n * <example-url>../tiny3demo/#/modal/modal-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiModalModule\r\n})\r\nexport class TiModalService {\r\n    /**\r\n     * 页面中存在的所有弹框实例，用于处理业务中无法明确当前有多少有效弹窗场景\r\n     */\r\n    public openedModals: Array<TiModalRef> = []; // 所有当前处于打开状态弹框缓存数组\r\n    /* tslint:disable:no-null-keyword */\r\n    private backdropComponentRef: ComponentRef<TiBackdropComponent> = null; // 单个页面中多个弹框出现时,只允许存在一个遮罩层,因此使用该标志位用来缓存遮罩实例\r\n    private defaultConfig: TiModalConfig = {\r\n        backdrop: true,\r\n        draggable: true,\r\n        animation: true,\r\n        closeOnEsc: true,\r\n        closeIcon: true\r\n    };\r\n    constructor(private popService: TiPopupService<any>) {\r\n    }\r\n\r\n    /**\r\n     * 生成弹框方法\r\n     *\r\n     * @param content 弹框内容，支持TemplateRef及组件形式，内容由ti-modal-header、ti-modal-body及ti-modal-footer组件构成弹框内容整体。\r\n     *                不支持字符串形式，如果误传入字符串形式，不仅会有报错，还会存在XSS攻击风险，不过XSS攻击风险已在10.1.4版本已处理。\r\n     * @param [config] 弹框配置信息\r\n     * @returns 弹框实例信息，使用该实例信息可调用弹框的close等方法；弹框内容为component类型时，也可通过该实例信息的content属性获取弹框内容数据\r\n     */\r\n    public open(content: TemplateRef<any> | any, config?: TiModalConfig): TiModalRef {\r\n        let modalInstance: TiModalRef; // 弹框最终返回的实例对象\r\n        let modalComponentRef: ComponentRef<TiModalComponent>; // 弹框组件实例,使用该实例获取弹框DOM元素及做属性赋值操作\r\n        const modalConfig: TiModalConfig = {...this.defaultConfig, ...config}; // 弹框配置合并\r\n        let modal: { modalComponentRef: ComponentRef<TiModalComponent>, hide(): void}; // generateModal方法返回值\r\n\r\n        // 通过id唯一标识防止重复打开相同弹框,id重复情况下返回先前实例\r\n        if (modalConfig && !Util.isUndefined(modalConfig.id)) {\r\n            const index: number = this.openedModals.findIndex((item: TiModalRef) => {\r\n                return item._id === modalConfig.id;\r\n            });\r\n            if (index !== -1) {\r\n                return this.openedModals[index];\r\n            }\r\n        }\r\n        // 根据beforeClose返回处理弹窗的销毁：业务在beforeClose中调用弹框销毁\r\n        const destroy: (reason: boolean) => void =\r\n            (reason: boolean): void => {\r\n            if (typeof modalConfig.beforeClose === 'function') {\r\n                modalConfig.beforeClose(modalInstance, reason);\r\n            } else {\r\n                destroyModal(reason);\r\n            }\r\n        };\r\n        // 销毁弹框：通过调用组件的动画状态方式实现动画处理\r\n        const destroyModal: (reason?: boolean) => void =\r\n            (reason?: boolean): void => {\r\n            if (reason) {\r\n                if (typeof modalConfig.close === 'function') {\r\n                    modalConfig.close(modalInstance);\r\n                }\r\n            } else {\r\n                if (typeof modalConfig.dismiss === 'function') {\r\n                    modalConfig.dismiss(modalInstance);\r\n                }\r\n            }\r\n            modalComponentRef.instance.showState = 'hide';\r\n        };\r\n        // 销毁弹框实体：弹框动画执行完成后调用该方法\r\n        const removeModalEle: () => void =\r\n            (): void => {\r\n            // 销毁弹框实体DOM\r\n            modal.hide();\r\n            // 移除缓存实例\r\n            const index: number = this.openedModals.indexOf(modalInstance);\r\n            this.openedModals.splice(index, 1);\r\n            modalInstance = null;\r\n\r\n            // 销毁backdrop\r\n            destroyBackdrop();\r\n        };\r\n        const destroyBackdrop: () => void =\r\n        (): void => {\r\n            // backdrop定义为false时，不进行处理\r\n            // backdropComponentRef 已经销毁\r\n            if (!modalConfig.backdrop || !this.backdropComponentRef) {\r\n                return;\r\n            }\r\n            // 修改backdrop zIndex，确保有多个弹窗情况下，最外层弹窗不被遮挡\r\n            this.backdropComponentRef.instance.index = this.openedModals.length - 1 ;\r\n            // 当前还有其它弹框情况下,不用销毁弹框\r\n            if (this.openedModals.length !== 0) {\r\n                return;\r\n            }\r\n            this.backdropComponentRef.instance.showState = 'hide';\r\n        };\r\n        // 将当前要打开的modal放到openedModals列表中\r\n        modalInstance = {\r\n            _id: modalConfig && modalConfig.id,\r\n            close(): void {\r\n                destroy(true);\r\n            },\r\n            dismiss(): void {\r\n                destroy(false);\r\n            },\r\n            destroy(reason: boolean): void {\r\n                destroyModal(reason);\r\n            },\r\n            _remove: removeModalEle,\r\n            content: null\r\n        };\r\n        modal = this.generateModal(content, modalConfig, modalInstance);\r\n        // 生成弹框window,并返回对应的组件实例\r\n        modalComponentRef = modal.modalComponentRef;\r\n        // 生成模态背景backdrop\r\n        this.backdropComponentRef = this.generateBackdrop(modalConfig);\r\n\r\n        return modalInstance;\r\n    }\r\n    private generateModal(content: any, config: TiModalConfig, modalInstance: TiModalRef): {\r\n        modalComponentRef: ComponentRef<TiModalComponent>, hide(): void} {\r\n        const {context, ...modalConfig}: TiModalConfig = config;\r\n        // tiModalComponent生成需要使用到的上下文\r\n        const modalContext: any = {\r\n            modalInstance,\r\n            index: this.openedModals.length,\r\n            ...modalConfig\r\n        };\r\n        // 内容部分需要使用到的上下文\r\n        const contentContext: any = {\r\n            close: modalInstance.close,\r\n            dismiss: modalInstance.dismiss,\r\n            ...context\r\n        };\r\n        let modalComponent: any;\r\n        modalComponent = (TiBrowser.isIE() && (TiBrowser.version() === 9))\r\n                        ? this.popService.create(TiModalNoAnimationComponent)\r\n                        : this.popService.create(TiModalComponent);\r\n        const modalComponentRef: any = modalComponent.show({\r\n            content,\r\n            context: modalContext,\r\n            contentContext,\r\n            container: 'body'\r\n        });\r\n        // 控制元素动画呈现，元素呈现后修改动画状态才会有动画效果，因此在此处处理\r\n        modalComponentRef.instance.showState = 'show';\r\n        modalInstance.content = modalComponentRef.tiContentRef.componentRef;\r\n        this.openedModals.push(modalInstance);\r\n\r\n        return { modalComponentRef, hide: modalComponent.hide };\r\n    }\r\n    private generateBackdrop(config: TiModalConfig): ComponentRef<TiBackdropComponent> {\r\n        // 配置中不需要backdrop,不生成\r\n        if (!config.backdrop) {\r\n            return this.backdropComponentRef;\r\n        }\r\n\r\n        if (this.backdropComponentRef) {\r\n            // backdrop已存在的情况下,修改其zIndex,并确保不生成backdrop\r\n            if (this.backdropComponentRef.instance.showState === 'show') {\r\n                this.backdropComponentRef.instance.index = this.openedModals.length - 1;\r\n\r\n                return this.backdropComponentRef;\r\n            // 如果backdrop正在销毁(动画执行期间)时再新生成一个backdrop，这时应该将旧的backdrop立即销毁\r\n            } else {\r\n                this.backdropComponentRef.destroy();\r\n            }\r\n        }\r\n        const backdropComponent: TiPopUpRef = (TiBrowser.isIE() && (TiBrowser.version() === 9))\r\n                            ? this.popService.create(TiBackdropNoAnimationComponent)\r\n                            : this.popService.create(TiBackdropComponent);\r\n        const backdropRef: ComponentRef<TiBackdropComponent> = backdropComponent.show({\r\n            context: {\r\n                animation: config.animation,\r\n                destroy: (): void => {\r\n                    backdropComponent.hide();\r\n                    this.backdropComponentRef = null;\r\n                }\r\n            },\r\n            container: 'body'\r\n        });\r\n        // 控制元素动画呈现，元素呈现后修改动画状态才会有动画效果，因此在此处处理\r\n        backdropRef.instance.showState = 'show';\r\n\r\n        return backdropRef;\r\n    }\r\n}\r\n","import { Component, ContentChild, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewChild } from '@angular/core';\r\nimport { TiFileInfo, TiFileItem, TiFilter } from '../../services/upload/TiFileInterface';\r\nimport { TiUploadService } from '../../services/upload/TiUploadService';\r\nimport { TiModalService } from '../../services/modal/TiModalService';\r\nimport { TiFilePreviewInfo, TiImagepreviewComponent } from '../imagepreview/TiImagepreviewComponent';\r\nimport { TiUploadbaseComponent } from './TiUploadbaseComponent';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n/**\r\n * 10.0.2版本新增\r\n *\r\n * 该组件基于TiUploadService和已设计好的交互规范，实现上传图片功能（但不限于上传图片），包含两种样式：\r\n *\r\n * 1.带上传结果展示的样式(type为block)\r\n *\r\n * 2.不展示上传结果的样式(type为drag)\r\n *\r\n * 负责人：谭莉\r\n * <example-url>../tiny3demo/#/uploadimage/uploadimage-all</example-url>\r\n */\r\n@Component({\r\n    selector: 'ti-upload[type=\"block\"], ti-upload[type=\"drag\"]',\r\n    templateUrl: './uploadimage.html',\r\n    styleUrls: ['./uploadimage.less']\r\n})\r\n\r\nexport class TiUploadimageComponent extends TiUploadbaseComponent {\r\n\r\n    /**\r\n     * 能够上传文件的最大数量，默认不限制\r\n     */\r\n    @Input() maxCount: number = undefined;\r\n\r\n    /**\r\n     * 设置上传成功后可以删除，默认可删除\r\n     */\r\n    @Input() deletable: boolean = true;\r\n\r\n    /**\r\n     * 上传按钮的样式，默认为block\r\n     */\r\n    @Input() type: 'block' | 'drag' = 'block';\r\n\r\n    /**\r\n     * @ignore\r\n     * 上传结果展示，目前只有一种，picture-card；\r\n     * 当type设置为drag时无效\r\n     */\r\n    listType: string = 'picture-card';\r\n\r\n    /**\r\n     * 文件上传达上限的回调\r\n     * 参数是当前的文件预览信息列表\r\n     */\r\n    @Output() readonly uploadLimit: EventEmitter<Array<TiFilePreviewInfo>> =  new EventEmitter<Array<TiFilePreviewInfo>>();\r\n\r\n    /**\r\n     * @ignore 内部变量\r\n     */\r\n    @ViewChild('uploadBtn', {static: false}) uploadBtn: ElementRef;\r\n    /**\r\n     * @ignore\r\n     * 上传组件对应的input元素\r\n     */\r\n    @ViewChild('uploadInput', {static: false}) uploadInputEle: ElementRef;\r\n    /**\r\n     * 用户自定义上传的样式\r\n     */\r\n    @ContentChild('uploadContainer', {static: true}) uploadContainerTemplate: ElementRef;\r\n\r\n    /**\r\n     * 上传按钮的宽度，用于自定义样式，默认为100px，在type为drag下设置才生效\r\n     */\r\n    @Input() uploadBtnWidth: string = '100px';\r\n\r\n    /**\r\n     * 上传按钮的高度，用于自定义样式，默认为100px，在type为drag下设置才生效\r\n     */\r\n    @Input() uploadBtnHeight: string = '100px';\r\n\r\n    /**\r\n     * @ignore 需要展示的文件列表\r\n     */\r\n    fileList: Array<TiFilePreviewInfo> =  [];\r\n\r\n    constructor(private uploaderService: TiUploadService, hostEle: ElementRef, renderer: Renderer2,\r\n                private tiModal: TiModalService, public sanitizer: DomSanitizer, private zone: NgZone) {\r\n        super(hostEle, renderer);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        // 设置上传实例配置\r\n        this.setUploadConfig();\r\n        // 创建uploader实例\r\n        this.uploadInst = this.uploaderService.create(this.uploadConfig);\r\n        if (this.type === 'drag') {\r\n            this.listType = '';\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterViewChecked(): void {\r\n        super.ngAfterViewChecked();\r\n        // 拖拽添加/上传时，设置上传按钮的高度和宽度\r\n        if (this.uploadBtn && this.type === 'drag') {\r\n            this.renderer.setStyle(this.uploadBtn.nativeElement, 'width', this.uploadBtnWidth);\r\n            this.renderer.setStyle(this.uploadBtn.nativeElement, 'height', this.uploadBtnHeight);\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line: use-life-cycle-interface\r\n    ngAfterContentChecked(): void {\r\n        super.ngAfterContentChecked();\r\n    }\r\n\r\n    /**\r\n     * 重新设置上传实例配置\r\n     */\r\n    private setUploadConfig(): void {\r\n        this.setFilters();\r\n        this.uploadConfig.onAddItemFailed = (file: TiFileInfo, validResults: Array<string>): void => {\r\n            // 文件上传达上限，触发回调\r\n            if (validResults.includes('maxCount')) {\r\n                this.uploadLimit.emit(this.fileList);\r\n            }\r\n            this.addItemFailed.emit({file, validResults});\r\n        };\r\n        this.uploadConfig.onAddItemSuccess = (fileItem: TiFileItem): void => {\r\n            this.addPreviewList(fileItem);\r\n            this.addItemSuccess.emit(fileItem);\r\n        };\r\n        this.uploadConfig.onSuccessItems = (fileItems: Array<TiFileItem>, response: string, status: number): void => {\r\n            this.setPreviewInfo(fileItems[0]);\r\n            this.successItems.emit({fileItems, response, status});\r\n        };\r\n        this.uploadConfig.onRemoveItems = (fileItems: Array<TiFileItem>): void => {\r\n            this.removePreviewList(fileItems[0]);\r\n            this.removeItems.emit(fileItems);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 设置过滤条件\r\n     */\r\n    private setFilters(): void {\r\n        let uploadFilters: Array<TiFilter> = this.filters || [];\r\n        if ((typeof this.maxCount === 'number') && this.maxCount > 0) {\r\n            uploadFilters = uploadFilters.concat({\r\n                name: 'maxCount',\r\n                params: [this.maxCount]\r\n            });\r\n        }\r\n        this.uploadConfig.filters = uploadFilters;\r\n    }\r\n\r\n    /**\r\n     * 添加文件成功后，增加一个预览对象\r\n     */\r\n    private addPreviewList(fileItem: TiFileItem): void {\r\n        const imgInfoItem: TiFilePreviewInfo = {\r\n            imgFileItem: fileItem,\r\n            name: fileItem._file.name,\r\n            previewUrl: '',\r\n            isImage: false\r\n          };\r\n        this.fileList.push(imgInfoItem);\r\n    }\r\n\r\n    /**\r\n     * 删除时，将文件信息从预览列表中移除\r\n     */\r\n    private removePreviewList(fileItem: TiFileItem): void {\r\n        // 获取需要删除的数据的索引\r\n        const deleteIndex: number = this.fileList.findIndex((item: TiFilePreviewInfo): boolean => {\r\n            return (fileItem._file === item.imgFileItem._file);\r\n        });\r\n        this.fileList.splice(deleteIndex, 1);\r\n    }\r\n\r\n    /**\r\n     * 上传成功后，更新预览地址\r\n     */\r\n    private setPreviewInfo(fileItem: TiFileItem): void {\r\n        // 生成预览url\r\n        const url: string = window.URL.createObjectURL(fileItem._file);\r\n        const isImagePromise: Promise<boolean> = this.isImage(fileItem._file.name, url);\r\n        isImagePromise.then((result: boolean) => {\r\n            this.fileList.forEach((item: TiFilePreviewInfo): void => {\r\n                if (item.imgFileItem._file === fileItem._file) {\r\n                    item.previewUrl = url;\r\n                    item.isImage = result;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore 在弹框中预览上传的图片\r\n     * 参数i: 表示被点击图片的索引\r\n     */\r\n    public preview(i: number): void {\r\n        const previewList: Array<TiFilePreviewInfo> = [];\r\n        let firstIndex: number = i;\r\n        this.fileList.forEach((item: TiFilePreviewInfo, index: number): void => {\r\n            if (item.imgFileItem.isSuccess && item.isImage) {\r\n                // 上传成功并且是图片\r\n                previewList.push(item);\r\n            } else {\r\n                // 非图片或上传失败，并且在被点击的文件之前，第一个预览的索引需要-1\r\n                if (i >= index) {\r\n                    firstIndex -= 1;\r\n                }\r\n            }\r\n        });\r\n        this.tiModal.open(TiImagepreviewComponent, {\r\n            id: 'imagePreviewModal',\r\n            modalClass: 'ti3-image-preview-modal',\r\n            context: {\r\n                index: firstIndex, // 当前文件索引\r\n                fileList: previewList // 预览列表\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 判断是否是图片类型\r\n     * 参数fileName: 文件名称\r\n     * 参数previewUrl: 预览地址\r\n     */\r\n    // tslint:disable-next-line: prefer-function-over-method\r\n    private isImage(fileName: string, previewUrl: string): Promise<boolean> {\r\n        const tempArray: Array<string> = fileName.split('.');\r\n        const extension: string = tempArray[tempArray.length - 1].toLocaleLowerCase();\r\n        const supportTypes: Array<string> = ['jpg', 'png', 'jpeg', 'svg', 'gif', 'bmp'];\r\n\r\n        return new Promise(resolve => {\r\n            if (!supportTypes.includes(extension)) {\r\n                resolve(false);\r\n\r\n                return;\r\n            }\r\n            this.zone.runOutsideAngular(() => {\r\n                // 测试图片能否加载成功，能加载成功，则认为可预览；否则，认为不可预览\r\n                const img: any = document.createElement('img');\r\n                img.src = previewUrl;\r\n                img.onerror = (event: any): void => {\r\n                    resolve(false);\r\n                };\r\n                img.onload = (event: any): void => {\r\n                    resolve(true);\r\n                };\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @ignore 禁用上传时，阻止默认事件、停止冒泡\r\n     */\r\n    selectFile(event: any): void {\r\n        if (this.disabled) {\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n\r\n            return;\r\n        }\r\n        // 焦点转移\r\n        this.uploadBtn.nativeElement.focus();\r\n    }\r\n\r\n    public onKeydown(): void {\r\n        this.uploadInputEle.nativeElement.focus();\r\n    }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiFileSelectDirective } from './TiFileSelectDirective';\r\nimport { TiUploadComponent } from './TiUploadComponent';\r\nimport { TiDisabledDirective } from './TiDisabledDirective';\r\nimport { TiTipModule } from '../../directives/tip/TiTipModule';\r\nimport { TiProgresspieModule } from '../progresspie/TiProgresspieModule';\r\nimport { TiUploadServiceModule } from '../../services/upload/TiUploadServiceModule';\r\nimport { TiIconModule } from '../icon/TiIconModule';\r\nimport { TiOverflowModule } from '../../directives/overflow/TiOverflowModule';\r\nimport { TiValidationModule } from '../../directives/validation/TiValidationModule';\r\nimport { TiProgressbarModule } from '../progressbar/TiProgressbarModule';\r\nimport { TiUploadbaseComponent } from './TiUploadbaseComponent';\r\nimport { TiUploadimageComponent } from './TiUploadimageComponent';\r\nimport { TiModalModule } from '../../services/modal/TiModalModule';\r\nimport { TiImagepreviewModule } from '../imagepreview/TiImagepreviewModule';\r\nimport { TiButtonModule } from '../button/TiButtonModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiIconModule,\r\n    TiTipModule,\r\n    TiProgresspieModule,\r\n    TiUploadServiceModule,\r\n    TiOverflowModule,\r\n    TiValidationModule,\r\n    TiProgressbarModule,\r\n    TiModalModule,\r\n    TiImagepreviewModule,\r\n    TiButtonModule,\r\n    TiOutlineModule\r\n  ],\r\n  exports: [TiFileSelectDirective, TiUploadComponent, TiDisabledDirective, TiUploadbaseComponent, TiUploadimageComponent],\r\n  declarations: [TiFileSelectDirective, TiUploadComponent, TiDisabledDirective, TiUploadbaseComponent, TiUploadimageComponent]\r\n})\r\nexport class TiUploadModule {\r\n}\r\nexport { TiUploadComponent } from './TiUploadComponent';\r\nexport { TiFileSelectDirective } from './TiFileSelectDirective';\r\nexport { TiDisabledDirective } from './TiDisabledDirective';\r\nexport { TiUploadbaseComponent } from './TiUploadbaseComponent';\r\nexport { TiUploadimageComponent } from './TiUploadimageComponent';\r\n","import { Component, Input, OnInit, TemplateRef } from '@angular/core';\r\nimport { TiBaseComponent } from '../../components/base/TiBaseModule';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-intromodal',\r\n    templateUrl: './intromodal.html',\r\n    styleUrls: ['./intro.less'],\r\n    host: {\r\n        '[class.ti3-intromodal-wrapper]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiIntromodalComponent extends TiBaseComponent implements OnInit {\r\n    @Input() title: string;\r\n    @Input() content: string | TemplateRef<any>;\r\n    @Input() image: string;\r\n    @Input() totalNumber: number;\r\n    @Input() currentNumber: number;\r\n    @Input() finishButtonText: string;\r\n    @Input() close: (flag?: boolean) => void;\r\n    @Input() wantStep: (num: number) => void;\r\n\r\n    public totalArray: Array<number>; // 通过totalNumber生成的数组\r\n    public isStringContent: boolean; // content是否为string\r\n    public templateContent: TemplateRef<any>; // 用户传入的templateRef类型content\r\n\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.totalArray = new Array(this.totalNumber + 1);\r\n        this.isStringContent = typeof this.content === 'string';\r\n        this.templateContent =  this.content instanceof TemplateRef ? this.content : undefined;\r\n    }\r\n\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { TiIntromodalComponent } from './TiIntromodalComponent';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-intromodal',\r\n    templateUrl: './introtip.html',\r\n    styleUrls: ['./intro.less'],\r\n    host: {\r\n        '[class.ti3-intromodal-wrapper]': 'true'\r\n    }\r\n})\r\n\r\nexport class TiIntrotipComponent extends TiIntromodalComponent { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { TiButtonModule } from '../../components/button/TiButtonModule';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\nimport { TiModalModule } from '../modal/TiModalModule';\r\nimport { TiTipServiceModule } from '../tip/TiTipServiceModule';\r\nimport { TiLocaleModule } from '../../locale/TiLocaleModule';\r\nimport { TiOutlineModule } from '../../directives/outline/TiOutlineModule';\r\n\r\nimport { TiIntromodalComponent } from './TiIntromodalComponent';\r\nimport { TiIntrotipComponent } from './TiIntrotipComponent';\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiButtonModule,\r\n    TiIconModule,\r\n    TiLocaleModule,\r\n    TiModalModule,\r\n    TiTipServiceModule,\r\n    TiOutlineModule\r\n  ],\r\n  declarations: [TiIntrotipComponent, TiIntromodalComponent],\r\n  entryComponents: [TiIntrotipComponent, TiIntromodalComponent]\r\n})\r\nexport class TiIntroServiceModule { }\r\nexport { TiIntroConfig, TiIntroRef, TiIntroStep, TiIntroShape } from './TiIntroInterface';\r\n","import { Injectable, Renderer2, RendererFactory2, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\n\r\nimport { TiIntroServiceModule } from './TiIntroModule';\r\nimport { TiModalRef } from '../modal/TiModalModule';\r\nimport { TiModalService } from '../modal/TiModalService';\r\nimport { TiTipService } from '../tip/TiTipService';\r\nimport { TiTipRef } from '../tip/TiTipInterface';\r\nimport { TiLog, TiKeymap, Util } from '../../utils/Util';\r\nimport { Position } from '../../utils/Position';\r\n\r\nimport { TiIntromodalComponent } from './TiIntromodalComponent';\r\nimport { TiIntrotipComponent } from './TiIntrotipComponent';\r\nimport { TiIntroConfig, TiIntroRef, TiIntroShape, TiIntroStep } from './TiIntroInterface';\r\n\r\n/**\r\n * 新手引导组件，适用于服务中内容（入口）新增和变动等指引提醒\r\n *\r\n * <p><span style=\"color: red\">使用此组件时需要开发者在项目模块(建议在根模块)中引入BrowserAnimationsModule。</span>\r\n * 这是因为此组件中使用了 TiModalService，TiModalService需要BrowserAnimationsModule\r\n * （具体原因可以查看 [TiModalService]{@link ../injectables/TiModalService.html}），\r\n * 但是 BrowserAnimationsModule 不能在懒加载模块被重复引入，所以需要开发者来引入BrowserAnimationsModule，保证其引入一次。</p>\r\n *\r\n * <example-url>../tiny3demo/#/intro/intro-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiIntroServiceModule\r\n})\r\n\r\nexport class TiIntroService {\r\n    private render: Renderer2;\r\n    private unListenWindowResize: () => void;\r\n    private unListenWindowHashchange: () => void;\r\n    private closeMultiTipEleClickListener: () => void;\r\n    private unListenDocumentKeydown: () => void;\r\n    // 可聚焦元素\r\n    private focusableElementsString: string = `a[href], area[href], input:not([disabled]):not([tabindex=\\'-1\\']),\r\n    button:not([disabled]):not([tabindex=\\'-1\\']),select:not([disabled]):not([tabindex=\\'-1\\']),\r\n    textarea:not([disabled]):not([tabindex=\\'-1\\']),\r\n    iframe, object, embed, *[tabindex]:not([tabindex=\\'-1\\']), *[contenteditable=true]`;\r\n    constructor(\r\n        private tipService: TiTipService,\r\n        private modalService: TiModalService,\r\n        rendererFactory: RendererFactory2,\r\n        @Inject(DOCUMENT) private document) {\r\n        /* tslint:disable:no-null-keyword */\r\n        this.render = rendererFactory.createRenderer(null, null);\r\n    }\r\n\r\n    /**\r\n     * intro的公共配置，不是默认配置，不能修改\r\n     */\r\n    private commonConfig: any = {\r\n        trigger: 'manual',\r\n        theme: 'white',\r\n        maxWidth: '400px'\r\n    };\r\n\r\n    private destroyBackdrop(): void {\r\n        const canvas: any = this.document.body.querySelector('#ti3-intro-backdrop');\r\n\r\n        if (canvas) {\r\n            // canvas.remove() IE报错；canvas.removeNode() Chrome报错；可以使用removeChild方法\r\n            canvas.parentNode.removeChild(canvas);\r\n        }\r\n    }\r\n\r\n    private static clearCircle(x: number, y: number, radius: number, stepClear: number, ctx: any): void {\r\n        const calcWidth: number = radius - stepClear;\r\n        const calcHeight: number = Math.sqrt(radius * radius - calcWidth * calcWidth);\r\n\r\n        const posX: number = x - calcWidth;\r\n        const posY: number = y - calcHeight;\r\n\r\n        const widthX: number = calcWidth * 2;\r\n        const heightY: number = calcHeight * 2;\r\n\r\n        if (stepClear < radius) {\r\n            ctx.clearRect(posX, posY, widthX, heightY);\r\n            const newStepClear: number = stepClear + 1;\r\n            TiIntroService.clearCircle(x, y, radius, newStepClear, ctx);\r\n        }\r\n    }\r\n\r\n    private static scrollToViewport(element: any): void {\r\n        // 修复SSR错误：ERROR TypeError: element.getBoundingClientRect is not a function\r\n        if (typeof element.getBoundingClientRect !== 'function') {\r\n            return;\r\n        }\r\n        const layout: any = element.getBoundingClientRect();\r\n\r\n        const scrollTop: number = document.body.scrollTop || document.documentElement.scrollTop;\r\n        // 修复SSR报错：ERROR ReferenceError: window is not defined\r\n        if (typeof window === 'undefined') {\r\n            return;\r\n        }\r\n        if (layout.top < 0) {\r\n            // 上边界溢出屏幕\r\n            window.scrollTo(0, layout.top + scrollTop - 20);\r\n        } else if (layout.bottom > document.documentElement.clientHeight) {\r\n            // 下边界溢出屏幕\r\n            window.scrollTo(0, scrollTop + layout.bottom + 20 - document.documentElement.clientHeight);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 创建intro实例\r\n     */\r\n    public create(config: TiIntroConfig): TiIntroRef {\r\n        let introRef: TiIntroRef; // create方法创建并返回的intro实例\r\n        const steps: Array<TiIntroStep> = config.steps;\r\n        let introModalRef: TiModalRef; // modal实例，用于隐藏弹窗\r\n        let introTipRef: TiTipRef; // 是生成的tip，有show & hide\r\n        let introMultiTipRefs: Array<TiTipRef> = []; // 多个tip场景下生成的tip实例数组\r\n        let curStep: number = 0; // 在整个create方法中，标识当前步数\r\n        const lastStep: number = steps[steps.length - 1 ].step; // 最后一TiIntroStep的step属性值，即总步数\r\n        // 关闭多个tip的操作元素\r\n        const closeMultiTipEle: Element = steps.filter((item: TiIntroStep) => item.isAction).length > 0 ?\r\n            steps.filter((item: TiIntroStep) => item.isAction)[0].element : undefined;\r\n        // 先隐藏closeMultiTipEle，并注册事件\r\n        if (closeMultiTipEle) {\r\n            this.render.setStyle(closeMultiTipEle, 'display', 'none');\r\n        }\r\n        this.unListenDocumentKeydown = this.render.listen(document, 'keydown', (event: KeyboardEvent): void => {\r\n            switch (event.which) {\r\n                case TiKeymap.KEY_TAB: // tab键用于处理在提示框内循环获取焦点\r\n                    this.clickTab(event);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n\r\n        /**\r\n         * @param flag boolean true:完成intro引导；false：未完成intro引导，但是退出\r\n         */\r\n        const close: (flag: boolean) => void = (flag: boolean): void => {\r\n            if (introMultiTipRefs.length > 0) {\r\n                introMultiTipRefs.forEach((item: TiTipRef) => {\r\n                    this.hidePreStep(item);\r\n                });\r\n                introMultiTipRefs = [];\r\n                this.render.setStyle(closeMultiTipEle, 'display', 'none');\r\n            } else {\r\n                this.hidePreStep(introTipRef);\r\n            }\r\n\r\n            this.destroyBackdrop();\r\n\r\n            if (flag && typeof config.onFinish === 'function') {\r\n                config.onFinish();\r\n            } else if (!flag && typeof config.onExit === 'function') {\r\n                config.onExit();\r\n            }\r\n            if (this.unListenWindowResize) {\r\n                this.unListenWindowResize();\r\n                this.unListenWindowResize = undefined;\r\n            }\r\n            if (this.unListenWindowHashchange) {\r\n                this.unListenWindowHashchange();\r\n                this.unListenWindowHashchange = undefined;\r\n            }\r\n            if (this.closeMultiTipEleClickListener) {\r\n                this.closeMultiTipEleClickListener();\r\n            }\r\n            if (this.unListenDocumentKeydown) {\r\n                this.unListenDocumentKeydown();\r\n                this.unListenDocumentKeydown = undefined;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * 无效步数条件：\r\n         * 1.不是有效数字\r\n         * 2.等于currentNumber，等于0除外\r\n         * 3.小于0 或 大于 totalNumber\r\n         * 使用curStep 和 lastStep，没有提为private方法\r\n         */\r\n        const isInvalidStepNum: (number: number) => boolean = (num: number): boolean => {\r\n            return isNaN(num) || (curStep === num && num !== 0) || num < 0 || num > lastStep;\r\n        };\r\n        /**\r\n         * 即将进入某一步的引导\r\n         *\r\n         * 需要在进入前做一些合法性判断，清除上一步信息等\r\n         */\r\n        const wantStep: (number: number) => void = (num: number): void => {\r\n            if (isInvalidStepNum(num)) {\r\n                TiLog.error('stepNumber is not valid');\r\n\r\n                return;\r\n            }\r\n            this.hidePreStep(introTipRef);\r\n            curStep = num;\r\n            if (typeof config.beforeStep === 'function') {\r\n                config.beforeStep(introRef, num);\r\n            } else {\r\n                // tslint:disable-next-line: no-use-before-declare\r\n                goStep(num);\r\n            }\r\n            // 延时为了保证遮罩dom已经绘制完毕。\r\n            setTimeout((): void => {\r\n                // 在引导的时候，把焦点调整为遮罩层。为后续把焦点圈在提示框内做准备。\r\n                const backdropEle: HTMLElement = document.querySelector('#ti3-intro-backdrop');\r\n                if (backdropEle) {\r\n                    backdropEle.focus();\r\n                }\r\n            }, 100);\r\n        };\r\n\r\n        // 开始某一步的引导\r\n        const goStep: (number: number) => void = (num: number): void => {\r\n            const currentSteps: Array<TiIntroStep> =  steps.filter((item: TiIntroStep) => item.step === num);\r\n            // curIntroStep curIntroStep\r\n            let currentStep: TiIntroStep;\r\n            if (currentSteps.length === 1) {\r\n                currentStep = currentSteps[0];\r\n            }\r\n            // 先关闭之前的canvas\r\n            this.destroyBackdrop();\r\n            /**\r\n             * 具体的引导步骤分为3种\r\n             * 1.总览页： 一个正常弹窗，用modal实现 intromodal\r\n             * 2.分布页：带按钮的tip，用tipService实现\r\n             * 3.提示： 没有按钮的普通tip，用tipService实现\r\n             */\r\n            // 第一种情况，弹窗\r\n            if (currentStep && !currentStep.element) {\r\n                introModalRef = this.modalService.open(TiIntromodalComponent, {\r\n                    id: 'ti3-intro-modal',\r\n                    context: {\r\n                        title: currentStep.title,\r\n                        content: currentStep.content,\r\n                        totalNumber: lastStep,\r\n                        currentNumber: curStep,\r\n                        finishButtonText: config.finishButtonText,\r\n                        id: config.id + '_' + num,\r\n                        close: (): void => {\r\n                            introModalRef.close();\r\n                        },\r\n                        wantStep\r\n                    },\r\n                    draggable: false\r\n                });\r\n\r\n                return;\r\n            }\r\n            // 如果有弹窗的话，关闭弹窗\r\n            if (introModalRef) {\r\n                introModalRef._remove();\r\n                introModalRef = undefined;\r\n            }\r\n            // 重新绘制canvas\r\n            this.drawBackdrop();\r\n\r\n            // 第二种情况，带按钮的tip\r\n            if (currentStep && currentStep.title) {\r\n\r\n                TiIntroService.scrollToViewport(currentStep.element);\r\n                introTipRef = this.tipService.create(currentStep.element, {\r\n                    ...this.commonConfig,\r\n                    position: currentStep.position,\r\n                    registerVisibilityChangeEvent: false\r\n                });\r\n                introTipRef.show(TiIntrotipComponent, {\r\n                    title: currentStep.title,\r\n                    content: currentStep.content,\r\n                    totalNumber: lastStep,\r\n                    currentNumber: curStep,\r\n                    finishButtonText: config.finishButtonText,\r\n                    id: config.id + '_' + num,\r\n                    close,\r\n                    wantStep\r\n                });\r\n\r\n                this.highlight(currentStep.element, currentStep.shape);\r\n            }\r\n\r\n            // 第三种情况，普通tip，并且是多个，有一个是关闭按钮。和第二种情况是if else 的关系，重新列为一个if分支是为了让三种情况称为并列的if\r\n            if (currentSteps && currentSteps.length > 1) {\r\n                currentSteps.forEach((item: TiIntroStep): void => {\r\n                    if (item.isAction) {\r\n                        this.render.setStyle(item.element, 'display', 'block');\r\n                        this.closeMultiTipEleClickListener = this.render.listen(item.element, 'click', () => {\r\n                            close(true);\r\n                        });\r\n                    } else {\r\n                        TiIntroService.scrollToViewport(item.element);\r\n                        const introtipRef: TiTipRef = this.tipService.create(item.element, {\r\n                            ...this.commonConfig,\r\n                            position: item.position,\r\n                            registerVisibilityChangeEvent: false\r\n                        });\r\n                        introtipRef.show(item.content);\r\n                        introMultiTipRefs.push(introtipRef);\r\n\r\n                        this.highlight(item.element, item.shape);\r\n                    }\r\n                });\r\n            }\r\n            // 修复SSR报错：ERROR ReferenceError: window is not defined\r\n            if (!this.unListenWindowResize && typeof window !== 'undefined') {\r\n                this.unListenWindowResize = this.render.listen(window, 'resize', () => {\r\n                    this.hidePreStep(introTipRef);\r\n                    this.destroyBackdrop();\r\n                    goStep(curStep);\r\n                });\r\n            }\r\n            if (!this.unListenWindowHashchange && typeof window !== 'undefined') {\r\n                this.unListenWindowHashchange = this.render.listen(window, 'hashchange', () => {\r\n                    close(false);\r\n                });\r\n            }\r\n        };\r\n\r\n        // 对外暴露的intro实例\r\n        introRef = {\r\n            start(): void {\r\n                wantStep(0);\r\n            },\r\n            end(): void {\r\n                close(true);\r\n            },\r\n            step: (number: number): void => {\r\n                wantStep(number);\r\n            },\r\n            proceed(): void {\r\n                goStep(curStep);\r\n            }\r\n\r\n        };\r\n\r\n        return introRef;\r\n    }\r\n\r\n    public clickTab(event: KeyboardEvent): void {\r\n        const introModal: HTMLElement = document.querySelector('.ti3-intromodal-wrapper');\r\n        const focusableElements: NodeList = introModal?.querySelectorAll(this.focusableElementsString);\r\n\r\n        Util.focusInDialogOnTabchange(event, focusableElements);\r\n    }\r\n\r\n    private hidePreStep(introTipRef: TiTipRef): void {\r\n        if (introTipRef) {\r\n            introTipRef.hide();\r\n        }\r\n    }\r\n\r\n    private drawBackdrop(): void {\r\n        // 修复SSR报错：\r\n\r\n        /* ERROR Error: NotYetImplemented\r\n        at HTMLCanvasElement.Wo4J.exports.nyi (D:\\ngworkspace\\tiny3-0119-2\\ngversion\\ng11-ssr\\dist\\tiny3demo\\server\\main.js:140019:9)\r\n        at TiIntroService.drawBackdrop (D:\\ngworkspace\\tiny3-0119-2\\ngversion\\ng11-ssr\\dist\\tiny3demo\\server\\main.js:12914:28) */\r\n        if (typeof document === 'undefined') {\r\n            return;\r\n        }\r\n        const canvas: any = this.render.createElement('canvas');\r\n        this.render.setStyle(canvas, 'z-index', 5000); // 最大的可取值为5000，5001会遮盖tip\r\n        this.render.setStyle(canvas, 'position', 'absolute');\r\n        this.render.setStyle(canvas, 'top', 0);\r\n        this.render.setStyle(canvas, 'left', 0);\r\n        this.render.setStyle(canvas, 'outline', 'none');\r\n        this.render.setAttribute(canvas, 'tabindex', '0'); // 非表单元素想要使用focus()函数聚焦，需要设置tabindex属性。\r\n        canvas.id = 'ti3-intro-backdrop';\r\n        const ctx: any = canvas.getContext('2d');\r\n        // _drawBackDrop(canvas, ctx) {\r\n        // 获取整个页面宽高，用于计算canvas宽高\r\n        // 获取整个页面的宽高,包括滚动条部分及body margin等\r\n        let browserWidth: number = this.document.documentElement.scrollWidth;\r\n        let browserHeight: number = this.document.documentElement.scrollHeight;\r\n        // 获取整个页面可视区域宽高，页面不出滚动条情况下，该值原则上应该是与上述browser宽高相等的\r\n        // 但是由于浏览器的计算差异，可能存在不相等的情况\r\n        const clientWidth: number = this.document.documentElement.clientWidth;\r\n        const clientHeight: number = this.document.documentElement.clientHeight;\r\n\r\n        // 由于在IE下该宽高计算不精确，可能会导致页面本身无滚动条的情况下，\r\n        // 当使用该值设置canvas宽度后，出现滚动条，因此需要对宽高进行特殊处理\r\n        // 根据多次试验经验，发现当实际页面实际宽度为小数时，clientWidth取值为去掉小数点后的值，\r\n        // scrollWidth则会自动+1，导致使用scrollWidth设置会出现滚动条，\r\n        // 因此，通过两者之差小于1的方式判断该情况下，取小值设置canvas宽度即可解决该问题\r\n        if (browserWidth - clientWidth <= 1) {\r\n            browserWidth = clientWidth;\r\n        }\r\n        // 纵向情况下处理同上\r\n        if (browserHeight - clientHeight <= 1) {\r\n            browserHeight = clientHeight;\r\n        }\r\n\r\n        canvas.width = browserWidth;\r\n        canvas.height = browserHeight;\r\n        ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n        ctx.fillRect(0, 0, browserWidth, browserHeight);\r\n\r\n        this.render.appendChild(this.document.body, canvas);\r\n    }\r\n    private highlight(element: any, shape: TiIntroShape): void {\r\n        const layout: any = Position.getHostEleLayout(element, element);\r\n        const canvas: any = this.document.body.querySelector('#ti3-intro-backdrop');\r\n        // 修复SSR报错：ERROR TypeError: Cannot read property 'getContext' of undefined\r\n        if (!canvas) {\r\n            return;\r\n        }\r\n        const ctx: any = canvas.getContext('2d');\r\n        const highlightLayout: any = {...layout};\r\n        if (layout.isFixed) {\r\n            // 如果被高亮的元素是fixed定位，以元素相对于视口的位置为高亮区域的定位\r\n            this.render.setStyle(canvas, 'position', 'fixed');\r\n            highlightLayout.top = element.getBoundingClientRect().top;\r\n            highlightLayout.left = element.getBoundingClientRect().left;\r\n        }\r\n        if (shape === 'circle') {\r\n            const radius: number = (highlightLayout.width < highlightLayout.height ? highlightLayout.width : highlightLayout.height) / 2;\r\n            const x: number = highlightLayout.left + highlightLayout.width / 2;\r\n            const y: number = highlightLayout.top + highlightLayout.height / 2;\r\n            TiIntroService.clearCircle(x, y, radius, 1, ctx);\r\n        } else {\r\n            ctx.clearRect(highlightLayout.left, highlightLayout.top, highlightLayout.width, highlightLayout.height);\r\n        }\r\n    }\r\n\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { TiLocale, TiLocaleWords } from '../../locale/TiLocaleModule';\r\nimport { Util } from '../../utils/Util';\r\nimport { TiMessageButtonConfig } from './TiMessageInterface';\r\n\r\n/**\r\n * messge类型设置\r\n */\r\nexport type TiMessageType = 'prompt' | 'warn' | 'error' | 'confirm';\r\n/**\r\n * @ignore\r\n * message模板组件定义\r\n */\r\n@Component({\r\n    selector: 'ti-message',\r\n    templateUrl: './TiMessageComponent.html',\r\n    styleUrls: ['./message.less']\r\n})\r\nexport class TiMessageComponent implements OnInit {\r\n    // 常量配置\r\n    private CONST_CONFIG: any = {\r\n        validType: ['confirm', 'error', 'warn', 'prompt'],\r\n        defaultType: 'confirm'\r\n    };\r\n    @Input() id: string;\r\n    @Input() title: string;\r\n    @Input() type: TiMessageType;\r\n    @Input() content: any;\r\n    @Input() context: any;\r\n    @Input() okButton: TiMessageButtonConfig;\r\n    @Input() cancelButton: TiMessageButtonConfig;\r\n    @Input() close: () => void;\r\n    @Input() dismiss: () => void;\r\n    public contentConfig: any; // 内容区域属性配置\r\n    private readonly localeWords: TiLocaleWords = TiLocale.getLocaleWords();\r\n\r\n    /**\r\n     * 设置按钮属性（除primary和autofocus外）\r\n     * @param options 外部配置属性\r\n     * @param defaults 按钮text和click属性\r\n     * @returns 合并后的属性\r\n     */\r\n    private static setBtn(options: TiMessageButtonConfig, defaults: {\r\n        text?: string,\r\n        click(): void;\r\n    }): TiMessageButtonConfig {\r\n        const defaultOpts: TiMessageButtonConfig = {\r\n            show: true,\r\n            disabled: false,\r\n            ...defaults\r\n        };\r\n        if (typeof options === 'object') {\r\n            return {...defaultOpts, ...options};\r\n        }\r\n\r\n        return defaultOpts;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.setType();\r\n        this.setTitle();\r\n        this.setBtns();\r\n        this.setContent();\r\n    }\r\n    private setType(): void {\r\n        const validType: Array<TiMessageType>  = this.CONST_CONFIG.validType;\r\n        const defaultType: TiMessageType = this.CONST_CONFIG.defaultType;\r\n        if (validType.indexOf(this.type) === -1) {\r\n            this.type = defaultType;\r\n        }\r\n    }\r\n    private setTitle(): void {\r\n        if (typeof this.title === 'string') {\r\n            return;\r\n        }\r\n        // 不同类型的message有默认title\r\n        this.title = this.localeWords.tiMessage[this.type];\r\n    }\r\n    /**\r\n     * 设置按钮属性：\r\n     * 对按钮的设置支持Object类型\r\n     * 为Object类型时，覆盖和扩展默认设置\r\n     */\r\n    private setBtns(): void {\r\n        this.okButton = TiMessageComponent.setBtn(this.okButton, {\r\n            text: this.localeWords.tiMessage.ok,\r\n            click: (): void => {\r\n                this.close();\r\n            }\r\n        });\r\n        this.cancelButton = TiMessageComponent.setBtn(this.cancelButton, {\r\n            text: this.localeWords.tiMessage.cancel,\r\n            click: (): void => {\r\n                this.dismiss();\r\n            }\r\n        });\r\n\r\n        this.setBtnUniqueState('autofocus');\r\n        this.setBtnUniqueState('primary');\r\n    }\r\n    /**\r\n     * 设置按钮属性，确保默认状态只在一个按钮生效\r\n     * @param prop 按钮属性\r\n     */\r\n    private setBtnUniqueState(prop: string): void {\r\n        if (Util.isUndefined(this.okButton[prop]) && Util.isUndefined(this.cancelButton[prop])) {\r\n            this.okButton[prop] = true;\r\n        }\r\n    }\r\n    private setContent(): void {\r\n        this.contentConfig = {\r\n            content: this.content,\r\n            context: this.context\r\n        };\r\n    }\r\n    public setId(suffix: string): string {\r\n        if (Util.isUndefined(this.id)) {\r\n            return '';\r\n        }\r\n\r\n        return `${this.id}${suffix}`;\r\n    }\r\n}\r\n","import { Component } from '@angular/core';\r\n/**\r\n * @ignore\r\n */\r\n@Component({\r\n    selector: 'ti-content-wrapper',\r\n    template: '<ng-content></ng-content>'\r\n})\r\nexport class TiContentWrapperComponent {\r\n}\r\n","import { Directive,  ElementRef, Input, OnDestroy, OnInit, TemplateRef } from '@angular/core';\r\nimport { TiPopupService } from '../popup/TiPopupService';\r\nimport { TiContentWrapperComponent } from './TiContentWrapperComponent';\r\n/**\r\n * @ignore\r\n * 生成并且compile内容为宿主元素的子元素\r\n */\r\n@Directive({\r\n    selector: '[tiTransclude]'\r\n})\r\nexport class TiTranscludeDirective implements OnInit, OnDestroy {\r\n    @Input() tiTransclude: {\r\n        content: string | TemplateRef<any>,\r\n        context?: any\r\n    };\r\n    private wrapperRef: any;\r\n    constructor(private eleRef: ElementRef,\r\n                private popService: TiPopupService<any>) {\r\n    }\r\n    ngOnInit(): void {\r\n        this.wrapperRef = this.popService.create(TiContentWrapperComponent);\r\n        this.wrapperRef.show({\r\n            content: this.tiTransclude.content,\r\n            contentContext: this.tiTransclude.context,\r\n            container: this.eleRef\r\n        });\r\n    }\r\n    ngOnDestroy(): void {\r\n        this.wrapperRef.hide();\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiMessageComponent } from './TiMessageComponent';\r\nimport { TiContentWrapperComponent } from './TiContentWrapperComponent';\r\nimport { TiTranscludeDirective } from './TiTranscludeDirective';\r\nimport { TiModalModule } from '../modal/TiModalModule';\r\nimport { TiButtonModule } from '../../components/button/TiButtonModule';\r\nimport { TiIconModule } from '../../components/icon/TiIconModule';\r\n\r\n@NgModule({\r\nimports: [CommonModule, TiModalModule, TiButtonModule, TiIconModule],\r\n    declarations: [TiMessageComponent, TiTranscludeDirective, TiContentWrapperComponent],\r\n    entryComponents: [TiMessageComponent, TiContentWrapperComponent]\r\n})\r\nexport class TiMessageModule {\r\n}\r\nexport { TiMessageButtonConfig, TiMessageConfig } from './TiMessageInterface';\r\nexport { TiMessageType } from './TiMessageComponent';\r\n","/**\r\n * 该类对外暴露，以服务的方式提供方法生成message组件\r\n * open({\r\n *  id:message id,string类型,用于生成唯一的按钮可测试id，并且防止弹框多次打开（同modal组件）\r\n *  type:message类型，支持'prompt' | 'warn' | 'error' | 'confirm'，默认为confirm\r\n *  title:头部title,string类型，可支持string形式的DOM片段\r\n *  content:内容区域DOM,支持类型为：TemplateRef<any> | Function | string\r\n *  context:内容区域上下文，类型为Object\r\n *  okButton:{\r\n *    text：string，按钮文本显示\r\n *    click: Function，点击回调\r\n *    primary: boolean,默认为true,程序中保证了两个按钮中只有一个可为true\r\n *    autofocus: boolean,默认为true,程序中保证了两个按钮中只有一个可为true\r\n *    show: boolean，标识按钮是否显示,默认为true\r\n * }\r\n *  cancleBtn:{\r\n *    text：string，按钮文本显示\r\n *    click: Function，点击回调\r\n *    primary: boolean,默认为false,程序中保证了两个按钮中只有一个可为true\r\n *    autofocus: boolean,默认为false,程序中保证了两个按钮中只有一个可为true\r\n *    show: boolean，标识按钮是否显示,默认为true\r\n * }\r\n * })\r\n */\r\nimport { Injectable } from '@angular/core';\r\nimport { TiModalRef } from '../modal/TiModalModule';\r\nimport { TiModalService } from '../modal/TiModalService';\r\nimport { TiMessageComponent } from './TiMessageComponent';\r\nimport { TiMessageModule } from './TiMessageModule';\r\nimport { TiMessageConfig } from './TiMessageInterface';\r\n\r\n/**\r\n * 消息框组件，使用服务方式生成，使用该服务时需要引入模块TiMessageModule，通过调用TiMessageService.open(config)方法生成弹出框\r\n *\r\n * <p><span style=\"color: red\">使用此组件时需要开发者在项目模块(建议在根模块)\r\n * 中引入BrowserAnimationsModule。</span>这是因为此组件中使用了Angular动画，需要引入BrowserAnimationsModule，\r\n * 但是 BrowserAnimationsModule 不能在懒加载模块被重复引入，所以需要开发者来引入BrowserAnimationsModule，保证其引入一次。</p>\r\n *\r\n * <example-url>../tiny3demo/#/message/message-all</example-url>\r\n */\r\n@Injectable({\r\n    providedIn: TiMessageModule\r\n})\r\nexport class TiMessageService {\r\n    constructor(private tiModal: TiModalService) {\r\n    }\r\n    /**\r\n     * 生成消息弹框方法\r\n     * [config] 弹框配置信息\r\n     * 返回 弹框实例信息，使用该实例信息可调用弹框的close等方法；内容为component类型时，也可通过content属性获取内容结果数据\r\n     */\r\n    public open(config?: TiMessageConfig): TiModalRef {\r\n        const {type, title, content, context, okButton, cancelButton,  ...modalConfig}: TiMessageConfig = config;\r\n\r\n        return this.tiModal.open(TiMessageComponent, {\r\n            context: {\r\n                id: config.id,\r\n                type,\r\n                title,\r\n                content,\r\n                context,\r\n                okButton,\r\n                cancelButton\r\n            },\r\n            modalClass: 'ti3-msg-default-width',\r\n            ...modalConfig\r\n        });\r\n    }\r\n}\r\n","import { Component, ElementRef, HostListener, Input, OnDestroy, OnInit, Renderer2 } from '@angular/core';\r\nimport { TiRenderer } from '../../services/renderer/TiRenderer';\r\n\r\n/**\r\n * @ignore\r\n *\r\n * 10.0.3版本增加，暂时不对外开放\r\n *\r\n * 该指令可以实现图片放大镜功能，添加tiZoom后会创建放大区域选择器元素（div）和放大结果呈现元素（div）\r\n *\r\n * 通过设置放大结果的background-image、background-size和background-position来达到放大效果\r\n *\r\n * 10.1.0版本从指令调整为组件形式\r\n *\r\n * <example-url>../tiny3demo/#/zoom/zoom-all</example-url>\r\n */\r\n@Component({\r\n    // 非img元素，tiZoom指令无效\r\n    selector: 'img[tiZoom]',\r\n    template: '',\r\n    styleUrls: ['./zoom.less']\r\n})\r\nexport class TiZoomComponent implements OnInit, OnDestroy {\r\n\r\n    // 放大结果的边框宽度\r\n    private static readonly ZOOM_VIEWER_BORDER_WIDTH: number = 1;\r\n\r\n    // 选择遮罩的宽高，默认150px\r\n    @Input() zoomSelectorLength: number = 150;\r\n\r\n    // 放大展示的宽高，默认300px\r\n    @Input() zoomViewerLength: number = 300;\r\n\r\n    // 比例\r\n    private ratio: number;\r\n\r\n    // 宿主元素\r\n    private hostEle: any;\r\n\r\n    // 宿主元素的父元素\r\n    private parentEle: any;\r\n\r\n    // 宿主元素的图片路径\r\n    private imgSrc: string = '';\r\n\r\n    // 放大区域选择器\r\n    private zoomSelectorEle: any;\r\n\r\n    // 放大结果展示区域\r\n    private zoomViewerEle: any;\r\n\r\n    // 选择遮罩监听事件\r\n    private selectorMouseMoveHandler: () => void;\r\n    private selectorMouseLeaveHandler: () => void;\r\n\r\n    constructor(hostRef: ElementRef, private renderer: Renderer2, private tiRenderer: TiRenderer) {\r\n        this.hostEle = hostRef.nativeElement;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        // 设置父元素\r\n        this.setParentEle();\r\n        // 设置放大比例\r\n        this.ratio = this.zoomViewerLength / this.zoomSelectorLength;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 图片加载成功事件处理\r\n     */\r\n    @HostListener('load', ['$event']) public onHostLoad(event: any): void {\r\n        this.imgSrc = event.target.src;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 鼠标进入宿主元素，创建放大效果相关元素\r\n     */\r\n    @HostListener('mouseenter', ['$event']) public onHostMouseEnter(event: any): void {\r\n        this.createZoomSelector();\r\n        this.createZoomViewer();\r\n        this.reStyleResults(event);\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     * 鼠标离开宿主元素，移除放大效果相关元素\r\n     */\r\n    @HostListener('mouseleave', ['$event']) public onHostMouseLeave(event: any): void {\r\n        // 当鼠标离开宿主元素并且不是进入选择遮罩时，移除选择遮罩和放大结果\r\n        if (event.relatedTarget !== this.zoomSelectorEle) {\r\n            this.removeZoomEle();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置父元素\r\n     */\r\n    private setParentEle(): void {\r\n        const parentEle: any = this.hostEle.parentElement;\r\n        if (parentEle !== null && parentEle.clientWidth !== 0 && parentEle.clientHeight !== 0) {\r\n            if (this.hostEle.offsetParent !== parentEle) {\r\n                // 父元素必须能够定位\r\n                this.renderer.setStyle(parentEle, 'position', 'relative');\r\n            }\r\n            this.parentEle = parentEle;\r\n        } else {\r\n            this.parentEle = document.body;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 创建选择遮罩，初始化样式，增加事件监听\r\n     */\r\n    private createZoomSelector(): void {\r\n        this.zoomSelectorEle = this.renderer.createElement('div');\r\n\r\n        // 添加样式，tinyplus3的productpreview需要根据分辨率修改元素尺寸\r\n        this.renderer.addClass(this.zoomSelectorEle, 'ti3-img-zoom-selector');\r\n        this.tiRenderer.setStyles(this.zoomSelectorEle, {\r\n            width: this.zoomSelectorLength + 'px',\r\n            height: this.zoomSelectorLength + 'px'\r\n        });\r\n\r\n        // 鼠标在选择遮罩上移动时的事件\r\n        this.selectorMouseMoveHandler = this.renderer.listen(this.zoomSelectorEle, 'mousemove', (event: any): void => {\r\n            this.reStyleResults(event);\r\n        });\r\n        // 鼠标离开选择遮罩的事件，销毁遮罩元素和放大结果呈现元素\r\n        this.selectorMouseLeaveHandler = this.renderer.listen(this.zoomSelectorEle, 'mouseleave', (event: MouseEvent) => {\r\n            this.renderer.removeChild(this.parentEle, this.zoomSelectorEle);\r\n            this.renderer.removeChild(document.body, this.zoomViewerEle);\r\n            this.zoomSelectorEle = undefined;\r\n            this.zoomViewerEle = undefined;\r\n        });\r\n\r\n        this.renderer.appendChild(this.parentEle, this.zoomSelectorEle);\r\n    }\r\n\r\n    /**\r\n     * 创建放大结果呈现元素，初始化样式\r\n     */\r\n    private createZoomViewer(): void {\r\n        this.zoomViewerEle = this.renderer.createElement('div');\r\n        const hostEleRect: DOMRect = this.hostEle.getBoundingClientRect();\r\n        const parentEleRect: DOMRect = this.parentEle.getBoundingClientRect();\r\n\r\n        // 放大结果元素相对于父元素进行定位\r\n        // left = 父元素宽度 - 边框宽度 + 滚动距离\r\n        let left: number = this.parentEle.offsetWidth - TiZoomComponent.ZOOM_VIEWER_BORDER_WIDTH + parentEleRect.left + window.pageXOffset;\r\n        // top = 父元素到视口距离 + 滚动距离\r\n        let top: number = parentEleRect.top + window.pageYOffset;\r\n        // 当父元素为body时，调整为相对于宿主元素定位\r\n        if (this.parentEle === document.body) {\r\n            left = this.hostEle.offsetWidth - TiZoomComponent.ZOOM_VIEWER_BORDER_WIDTH + hostEleRect.left + window.pageXOffset;\r\n            top = hostEleRect.top + window.pageYOffset;\r\n        }\r\n\r\n        // 添加样式，tinyplus3的productpreview需要根据分辨率修改元素尺寸\r\n        this.renderer.addClass(this.zoomViewerEle, 'ti3-img-zoom-viewer');\r\n        this.tiRenderer.setStyles(this.zoomViewerEle, {\r\n            left: left + 'px',\r\n            top: top + 'px',\r\n            width: `${this.zoomViewerLength}px`,\r\n            height: `${this.zoomViewerLength}px`,\r\n            background: `url(${this.imgSrc})`,\r\n            'background-size': `${this.hostEle.width * this.ratio}px ${this.hostEle.height * this.ratio}px`\r\n        });\r\n\r\n        this.renderer.appendChild(document.body, this.zoomViewerEle);\r\n    }\r\n\r\n    // 计算鼠标相对宿主元素的位置\r\n    private getCursorPos(mouseEvent: MouseEvent): any {\r\n        const hostEleRect: DOMRect = this.hostEle.getBoundingClientRect();\r\n        // 考虑滚动情况\r\n        const left: number = mouseEvent.pageX - hostEleRect.left - window.pageXOffset;\r\n        const top: number = mouseEvent.pageY - hostEleRect.top - window.pageYOffset;\r\n\r\n        return { x: left, y: top };\r\n    }\r\n\r\n    /**\r\n     * 计算选择遮罩偏移和放大区域\r\n     */\r\n    private reStyleResults(mouseEvent: MouseEvent): void {\r\n        // 1. 获取计算鼠标相对于宿主元素左上角的位置\r\n        const cursorPos: any = this.getCursorPos(mouseEvent);\r\n        // 获取遮罩宽度\r\n        const zoomSelectorWidth: number = this.zoomSelectorEle.offsetWidth;\r\n\r\n        // 2. 计算放大结果的位置\r\n        let viewerPosX: number = cursorPos.x - (zoomSelectorWidth / 2);\r\n        let viewerPosY: number = cursorPos.y - (zoomSelectorWidth / 2);\r\n\r\n        // 3. 调整\r\n        // 3.1 选择遮罩移出宿主元素的右侧\r\n        if (viewerPosX > this.hostEle.offsetWidth - zoomSelectorWidth) {\r\n            viewerPosX = this.hostEle.offsetWidth - zoomSelectorWidth;\r\n        }\r\n        // 3.2 选择遮罩移出宿主元素的左侧\r\n        if (viewerPosX < 0) {\r\n            viewerPosX = 0;\r\n        }\r\n        // 3.3 选择遮罩移出宿主元素的下方\r\n        if (viewerPosY > this.hostEle.offsetHeight - zoomSelectorWidth) {\r\n            viewerPosY = this.hostEle.offsetHeight - zoomSelectorWidth;\r\n        }\r\n        // 3.4 选择遮罩移出宿主元素的上方\r\n        if (viewerPosY < 0) {\r\n            viewerPosY = 0;\r\n        }\r\n\r\n        // 4. 设置选择区域偏移，选择区域偏移=放大结果位置 + 宿主元素的偏移\r\n        this.tiRenderer.setStyles(this.zoomSelectorEle, {\r\n            left: `${viewerPosX + this.hostEle.offsetLeft}px`,\r\n            top: `${viewerPosY + this.hostEle.offsetTop}px`\r\n        });\r\n\r\n        // 5. 设置放大结果\r\n        this.renderer.setStyle(this.zoomViewerEle, 'background-position',\r\n            `-${viewerPosX * this.ratio}px -${viewerPosY * this.ratio}px`);\r\n\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.removeZoomEle();\r\n    }\r\n\r\n    /**\r\n     * 移除选择遮罩和放大结果元素、解绑相关事件\r\n     */\r\n    private removeZoomEle(): void {\r\n        if (this.zoomSelectorEle !== undefined) {\r\n            this.renderer.removeChild(this.parentEle, this.zoomSelectorEle);\r\n            this.zoomSelectorEle = undefined;\r\n        }\r\n        if (this.zoomViewerEle !== undefined) {\r\n            this.renderer.removeChild(document.body, this.zoomViewerEle);\r\n            this.zoomViewerEle = undefined;\r\n        }\r\n        if (this.selectorMouseMoveHandler) {\r\n            this.selectorMouseMoveHandler();\r\n        }\r\n        if (this.selectorMouseLeaveHandler) {\r\n            this.selectorMouseLeaveHandler();\r\n        }\r\n    }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TiZoomComponent } from './TiZoomComponent';\r\nimport { TiRendererModule } from '../../services/renderer/TiRendererModule';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    TiRendererModule\r\n  ],\r\n  exports: [TiZoomComponent],\r\n  declarations: [TiZoomComponent]\r\n})\r\nexport class TiZoomModule {\r\n}\r\nexport { TiZoomComponent } from './TiZoomComponent';\r\n"]}