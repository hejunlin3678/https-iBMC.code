import { Component, Input } from '@angular/core';
/* tslint:disable:no-implicit-dependencies */
import { FormControl } from '@angular/forms';
import { Util } from '../../utils/Util';
import { TiLocale } from '../../locale/TiLocaleModule';
/**
 * @ignore
 */
export class TiPwdMsgComponent {
    constructor() {
        this.msgModel = {
            level: -1,
            msgItems: [],
            securityText: '',
            securityStatus: ''
        };
    }
    static _getPwdStrengthLan(key) {
        return TiLocale.getLocaleWords().tiValid.passwordStrength[key];
    }
    // 获取各项规则提示
    static _getMsgItems(msgObj, control) {
        let validStatus;
        if (control.untouched && control.pristine) { // 初次聚焦,未输入情况下，不校验
            validStatus = -1;
        }
        const msgInfoArr = [];
        let msgItem = '';
        for (const key in msgObj) {
            if (msgObj.hasOwnProperty(key)) {
                msgItem = msgObj[key];
                msgInfoArr.push({
                    msg: msgItem,
                    validStatus: TiPwdMsgComponent._getValidStatus(validStatus, key, control)
                });
            }
        }
        return msgInfoArr;
    }
    static _getValidStatus(validStatus, key, control) {
        const errors = control.errors;
        // validStatus已定义情况下，直接返回
        if (!Util.isUndefined(validStatus)) {
            return validStatus;
        }
        // errors中有该条消息，说明校验未通过
        if (errors && !Util.isUndefined(errors[key])) {
            return false;
        }
        // 值为空的情况下，除notEqualPosRev外，其他规则均为错误
        if (control.value === '' && key !== 'notEqualPosRev') {
            return false;
        }
        return true;
    }
    /**
     * 获取密码强度等级
     * @param value 输入值
     * @param validator 校验规则配置
     * @param levelFn 密码等级计算函数
     * @returns  密码强度等级
     */
    static _getLevel(value, validator, levelFn) {
        return levelFn(value, validator);
    }
    ngOnInit() {
        const value = this.control.value;
        // level计算
        let level = -1;
        if (!(value === null || value.length === 0)) { // value值为空情况下,level无效处理
            level = TiPwdMsgComponent._getLevel(value, this.validator, this.levelFn);
        }
        // 设置呈现时需要使用的字段
        this.msgModel = {
            level,
            msgItems: TiPwdMsgComponent._getMsgItems(this.msgItems, this.control),
            securityText: TiPwdMsgComponent._getPwdStrengthLan('securityText'),
            securityStatus: level === -1 ? '' : TiPwdMsgComponent._getPwdStrengthLan('levelDecArr')[level]
        };
    }
}
TiPwdMsgComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-pwd-msg',
                template: "<div class=\"ti3-valid-pwd-tip-container\">\r\n    <div *ngFor = \"let item of msgModel.msgItems;\" class=\"ti3-valid-pwd-tip-item\">\r\n        <span class=\"ti3-valid-pwd-tip-status-null\" *ngIf = \"item.validStatus === -1\"></span>\r\n        <span class=\"ti3-valid-pwd-tip ti3-valid-pwd-tip-success\" *ngIf = \"item.validStatus === true\">\r\n            <ti-icon name=\"alert-success\"></ti-icon>\r\n        </span>\r\n        <span class=\"ti3-valid-pwd-tip ti3-valid-pwd-tip-error\" *ngIf = \"item.validStatus === false\">\r\n            <ti-icon name=\"x-thin\"></ti-icon>\r\n        </span>\r\n        <span class=\"ti3-valid-pwd-tip-msg\">{{item.msg}}</span>\r\n    </div>\r\n    <div class=\"ti3-valid-pwd-level\">\r\n        <span class=\"ti3-valid-pwd-tip-security-text\">{{msgModel.securityText}}</span>\r\n        <div class=\"ti3-valid-pwd-level-bars\" [ngClass]=\"{'ti3-valid-pwd-level-weak': msgModel.level === 0, 'ti3-valid-pwd-level-medium': msgModel.level === 1, 'ti3-valid-pwd-level-strong': msgModel.level === 2}\">\r\n            <span class=\"ti3-valid-pwd-level-bar\" [ngClass]=\"{'active': msgModel.level >= 0}\"></span>\r\n            <span class=\"ti3-valid-pwd-level-bar\" [ngClass]=\"{'active': msgModel.level >= 1}\"></span>\r\n            <span class=\"ti3-valid-pwd-level-bar\" [ngClass]=\"{'active': msgModel.level >= 2}\"></span>\r\n        </div>\r\n            <span class=\"ti3-valid-pwd-tip-security-status\">{{msgModel.securityStatus}}</span>\r\n    </div>\r\n</div>\r\n",
                styles: ["::ng-deep :root{--ti-valid-pwd-circle-size:6px;--ti-valid-pwd-level-bar-height:2px;--ti-valid-pwd-level-bar-item-width:60px;--ti-valid-pwd-level-bar-space:var(--ti-common-space-3x);--ti-valid-pwd-space:var(--ti-common-space-2x);--ti-valid-pwd-status-icon-size:16px;--ti-valid-pwd-status-null-boder-width:1px;--ti-valid-pwd-status-null-color:var(--ti-common-color-line-normal);--ti-valid-pwd-status-null-size:calc(var(--ti-valid-pwd-status-icon-size) - var(--ti-valid-pwd-status-null-boder-width)*2);--ti-valid-pwd-tip-line-height:18px}.ti3-valid-pwd-tip-container{font-size:var(--ti-common-font-size-base);line-height:var(--ti-valid-pwd-tip-line-height)}.ti3-valid-pwd-tip-item{margin-bottom:var(--ti-common-space-3x);*zoom:1}.ti3-valid-pwd-tip-item:after{clear:both;content:\"\";display:table}.ti3-valid-pwd-tip-item:before{content:\"\";display:table}.ti3-valid-pwd-tip-status-null{-ms-box-sizing:content-box;border:var(--ti-valid-pwd-status-null-boder-width) solid hsla(0,0%,100%,.1);border-radius:var(--ti-valid-pwd-status-null-size);box-sizing:content-box;float:left;height:var(--ti-valid-pwd-status-null-size);margin-right:var(--ti-valid-pwd-space);position:relative;top:calc((var(--ti-valid-pwd-tip-line-height) - var(--ti-valid-pwd-status-icon-size))/2);width:var(--ti-valid-pwd-status-null-size)}.ti3-valid-pwd-tip-status-null:after{-ms-box-sizing:border-box;background-color:var(--ti-common-color-icon-darkbg-normal);border-radius:50%;box-sizing:border-box;content:\"\";height:var(--ti-valid-pwd-circle-size);left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:var(--ti-valid-pwd-circle-size)}.ti3-valid-pwd-tip-success{background-color:var(--ti-common-color-success);border-radius:50%;color:var(--ti-common-color-text-gray);float:left;font-size:var(--ti-valid-pwd-status-icon-size);height:var(--ti-valid-pwd-status-icon-size);margin-right:var(--ti-valid-pwd-space);margin-top:calc((var(--ti-valid-pwd-tip-line-height) - var(--ti-valid-pwd-status-icon-size))/2);text-align:center;width:var(--ti-valid-pwd-status-icon-size)}.ti3-valid-pwd-tip-success ti-icon{font-size:12px;line-height:var(--ti-valid-pwd-status-icon-size);vertical-align:top}.ti3-valid-pwd-tip-error{background-color:var(--ti-common-color-error);border-radius:50%;color:var(--ti-common-color-text-gray);float:left;font-size:var(--ti-valid-pwd-status-icon-size);height:var(--ti-valid-pwd-status-icon-size);margin-right:var(--ti-valid-pwd-space);margin-top:calc((var(--ti-valid-pwd-tip-line-height) - var(--ti-valid-pwd-status-icon-size))/2);text-align:center;width:var(--ti-valid-pwd-status-icon-size)}.ti3-valid-pwd-tip-error ti-icon{font-size:12px;line-height:var(--ti-valid-pwd-status-icon-size);vertical-align:top}.ti3-valid-pwd-tip-msg{float:left;width:calc(100% - var(--ti-valid-pwd-status-icon-size) - var(--ti-valid-pwd-space))}.ti3-valid-pwd-level-bars,.ti3-valid-pwd-tip-security-text{float:left;margin-right:var(--ti-common-space-3x)}.ti3-valid-pwd-level-bars{margin-top:calc(var(--ti-valid-pwd-tip-line-height)/2)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-strong .active{background:var(--ti-valid-pwd-level-bar-color-strong-active)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-strong .active:after,.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-strong .active:first-child:before{background-color:var(--ti-valid-pwd-level-bar-color-strong-active)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-medium .active{background:var(--ti-valid-pwd-level-bar-color-medium-active)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-medium .active:after,.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-medium .active:first-child:before{background-color:var(--ti-valid-pwd-level-bar-color-medium-active)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-weak .active{background:var(--ti-valid-pwd-level-bar-color-weak-active)}.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-weak .active:after,.ti3-valid-pwd-level-bars.ti3-valid-pwd-level-weak .active:first-child:before{background-color:var(--ti-valid-pwd-level-bar-color-weak-active)}.ti3-valid-pwd-level-bar{background:var(--ti-valid-pwd-level-bar-color);float:left;height:var(--ti-valid-pwd-level-bar-height);position:relative;width:calc(var(--ti-valid-pwd-level-bar-item-width) + var(--ti-valid-pwd-circle-size))}.ti3-valid-pwd-level-bar:first-child{width:calc(var(--ti-valid-pwd-level-bar-item-width) + var(--ti-valid-pwd-circle-size)*2)}.ti3-valid-pwd-level-bar:first-child:before{left:0}.ti3-valid-pwd-level-bar:after,.ti3-valid-pwd-level-bar:first-child:before{-ms-box-sizing:border-box;background-color:#8a8e99;border-radius:50%;box-sizing:border-box;content:\"\";height:var(--ti-valid-pwd-circle-size);position:absolute;top:calc((var(--ti-valid-pwd-level-bar-height) - var(--ti-valid-pwd-circle-size))/2);width:var(--ti-valid-pwd-circle-size)}.ti3-valid-pwd-level-bar:after{right:0}.ti3-valid-pwd-level{color:var(--ti-tip-text-color);margin-left:calc(var(--ti-valid-pwd-status-icon-size) + var(--ti-valid-pwd-space));margin-top:var(--ti-common-space-4x);*zoom:1}.ti3-valid-pwd-level:after{clear:both;content:\"\";display:table}.ti3-valid-pwd-level:before{content:\"\";display:table}.ti3-valid-pwd-tip-security-status{float:left;height:20px}.ti3-valid-pwd-level-circle{-ms-box-sizing:border-box;background-color:#8a8e99;border-radius:50%;box-sizing:border-box;content:\"\";height:var(--ti-valid-pwd-circle-size);position:absolute;top:calc((var(--ti-valid-pwd-level-bar-height) - var(--ti-valid-pwd-circle-size))/2);width:var(--ti-valid-pwd-circle-size)}"]
            },] }
];
TiPwdMsgComponent.propDecorators = {
    control: [{ type: Input }],
    msgItems: [{ type: Input }],
    validator: [{ type: Input }],
    levelFn: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlQd2RNc2dDb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueTMvZGlyZWN0aXZlcy92YWxpZGF0aW9uL1RpUHdkTXNnQ29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELDZDQUE2QztBQUM3QyxPQUFPLEVBQUUsV0FBVyxFQUFvQixNQUFNLGdCQUFnQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN4QyxPQUFPLEVBQUUsUUFBUSxFQUFpQixNQUFNLDZCQUE2QixDQUFDO0FBaUJ0RTs7R0FFRztBQU1ILE1BQU0sT0FBTyxpQkFBaUI7SUFMOUI7UUFVUyxhQUFRLEdBQWE7WUFDMUIsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUNULFFBQVEsRUFBRSxFQUFFO1lBQ1osWUFBWSxFQUFFLEVBQUU7WUFDaEIsY0FBYyxFQUFFLEVBQUU7U0FDbkIsQ0FBQztJQXdFSixDQUFDO0lBdEVTLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxHQUFXO1FBQzNDLE9BQVEsUUFBUSxDQUFDLGNBQWMsRUFBb0IsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDcEYsQ0FBQztJQUVELFdBQVc7SUFDSCxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQVcsRUFBRSxPQUFvQjtRQUN6RCxJQUFJLFdBQTJCLENBQUM7UUFDaEMsSUFBSSxPQUFPLENBQUMsU0FBUyxJQUFJLE9BQU8sQ0FBQyxRQUFRLEVBQUUsRUFBRSxrQkFBa0I7WUFDM0QsV0FBVyxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQ3BCO1FBRUQsTUFBTSxVQUFVLEdBQWUsRUFBRSxDQUFDO1FBQ2xDLElBQUksT0FBTyxHQUFXLEVBQUUsQ0FBQztRQUN6QixLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sRUFBRTtZQUN4QixJQUFJLE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQzlCLE9BQU8sR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3RCLFVBQVUsQ0FBQyxJQUFJLENBQUM7b0JBQ1osR0FBRyxFQUFFLE9BQU87b0JBQ1osV0FBVyxFQUFFLGlCQUFpQixDQUFDLGVBQWUsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQztpQkFDNUUsQ0FBQyxDQUFDO2FBQ0o7U0FDRjtRQUVELE9BQU8sVUFBVSxDQUFDO0lBQ3RCLENBQUM7SUFFTyxNQUFNLENBQUMsZUFBZSxDQUFDLFdBQTJCLEVBQUUsR0FBVyxFQUFFLE9BQW9CO1FBQzNGLE1BQU0sTUFBTSxHQUE0QixPQUFPLENBQUMsTUFBTSxDQUFDO1FBQ3ZELHlCQUF5QjtRQUN6QixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUNsQyxPQUFPLFdBQVcsQ0FBQztTQUNwQjtRQUNELHVCQUF1QjtRQUN2QixJQUFJLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDNUMsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUNELG9DQUFvQztRQUNwQyxJQUFJLE9BQU8sQ0FBQyxLQUFLLEtBQUssRUFBRSxJQUFJLEdBQUcsS0FBSyxnQkFBZ0IsRUFBRTtZQUNwRCxPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0ssTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFhLEVBQUUsU0FBYyxFQUFFLE9BQWlCO1FBQ3ZFLE9BQU8sT0FBTyxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBQ0QsUUFBUTtRQUNOLE1BQU0sS0FBSyxHQUFXLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO1FBQ3pDLFVBQVU7UUFDVixJQUFJLEtBQUssR0FBVyxDQUFDLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsQ0FBQyxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSx3QkFBd0I7WUFDbkUsS0FBSyxHQUFHLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDNUU7UUFFRCxlQUFlO1FBQ2YsSUFBSSxDQUFDLFFBQVEsR0FBRztZQUNaLEtBQUs7WUFDTCxRQUFRLEVBQUUsaUJBQWlCLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNyRSxZQUFZLEVBQUUsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDO1lBQ2xFLGNBQWMsRUFBRSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBSyxDQUFDO1NBQ2pHLENBQUM7SUFDSixDQUFDOzs7WUF0RkYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxZQUFZO2dCQUN0QixvL0NBQXVDOzthQUV4Qzs7O3NCQUVFLEtBQUs7dUJBQ0wsS0FBSzt3QkFDTCxLQUFLO3NCQUNMLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuLyogdHNsaW50OmRpc2FibGU6bm8taW1wbGljaXQtZGVwZW5kZW5jaWVzICovXHJcbmltcG9ydCB7IEZvcm1Db250cm9sLCBWYWxpZGF0aW9uRXJyb3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBVdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCB7IFRpTG9jYWxlLCBUaUxvY2FsZVdvcmRzIH0gZnJvbSAnLi4vLi4vbG9jYWxlL1RpTG9jYWxlTW9kdWxlJztcclxuLyoqXHJcbiAqIEBpZ25vcmVcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTXNnSXRlbSB7XHJcbiAgbXNnOiBzdHJpbmc7XHJcbiAgdmFsaWRTdGF0dXM6IGFueTtcclxufVxyXG4vKipcclxuICogQGlnbm9yZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNc2dNb2RlbCB7XHJcbiAgbGV2ZWw6IG51bWJlcjtcclxuICBtc2dJdGVtczogQXJyYXk8TXNnSXRlbT47XHJcbiAgc2VjdXJpdHlUZXh0OiBzdHJpbmc7XHJcbiAgc2VjdXJpdHlTdGF0dXM6IHN0cmluZztcclxufVxyXG4vKipcclxuICogQGlnbm9yZVxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICd0aS1wd2QtbXNnJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vVGlQd2RNc2dDb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcHdkTXNnLmxlc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGlQd2RNc2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBJbnB1dCgpIGNvbnRyb2w6IEZvcm1Db250cm9sO1xyXG4gIEBJbnB1dCgpIG1zZ0l0ZW1zOiBBcnJheTxNc2dJdGVtPjtcclxuICBASW5wdXQoKSB2YWxpZGF0b3I6IGFueTtcclxuICBASW5wdXQoKSBsZXZlbEZuOiBGdW5jdGlvbjtcclxuICBwdWJsaWMgbXNnTW9kZWw6IE1zZ01vZGVsID0ge1xyXG4gICAgbGV2ZWw6IC0xLFxyXG4gICAgbXNnSXRlbXM6IFtdLFxyXG4gICAgc2VjdXJpdHlUZXh0OiAnJyxcclxuICAgIHNlY3VyaXR5U3RhdHVzOiAnJ1xyXG4gIH07XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIF9nZXRQd2RTdHJlbmd0aExhbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gKFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkgYXMgVGlMb2NhbGVXb3JkcykudGlWYWxpZC5wYXNzd29yZFN0cmVuZ3RoW2tleV07XHJcbiAgfVxyXG5cclxuICAvLyDojrflj5blkITpobnop4TliJnmj5DnpLpcclxuICBwcml2YXRlIHN0YXRpYyBfZ2V0TXNnSXRlbXMobXNnT2JqOiBhbnksIGNvbnRyb2w6IEZvcm1Db250cm9sKTogQXJyYXk8YW55PiB7XHJcbiAgICAgIGxldCB2YWxpZFN0YXR1czogbnVtYmVyfGJvb2xlYW47XHJcbiAgICAgIGlmIChjb250cm9sLnVudG91Y2hlZCAmJiBjb250cm9sLnByaXN0aW5lKSB7IC8vIOWIneasoeiBmueEpizmnKrovpPlhaXmg4XlhrXkuIvvvIzkuI3moKHpqoxcclxuICAgICAgICAgIHZhbGlkU3RhdHVzID0gLTE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IG1zZ0luZm9BcnI6IEFycmF5PGFueT4gPSBbXTtcclxuICAgICAgbGV0IG1zZ0l0ZW06IHN0cmluZyA9ICcnO1xyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBtc2dPYmopIHtcclxuICAgICAgICBpZiAobXNnT2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgIG1zZ0l0ZW0gPSBtc2dPYmpba2V5XTtcclxuICAgICAgICAgIG1zZ0luZm9BcnIucHVzaCh7XHJcbiAgICAgICAgICAgICAgbXNnOiBtc2dJdGVtLFxyXG4gICAgICAgICAgICAgIHZhbGlkU3RhdHVzOiBUaVB3ZE1zZ0NvbXBvbmVudC5fZ2V0VmFsaWRTdGF0dXModmFsaWRTdGF0dXMsIGtleSwgY29udHJvbClcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG1zZ0luZm9BcnI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBfZ2V0VmFsaWRTdGF0dXModmFsaWRTdGF0dXM6IG51bWJlcnxib29sZWFuLCBrZXk6IHN0cmluZywgY29udHJvbDogRm9ybUNvbnRyb2wpOiBudW1iZXJ8Ym9vbGVhbiB7XHJcbiAgICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsID0gY29udHJvbC5lcnJvcnM7XHJcbiAgICAvLyB2YWxpZFN0YXR1c+W3suWumuS5ieaDheWGteS4i++8jOebtOaOpei/lOWbnlxyXG4gICAgaWYgKCFVdGlsLmlzVW5kZWZpbmVkKHZhbGlkU3RhdHVzKSkge1xyXG4gICAgICByZXR1cm4gdmFsaWRTdGF0dXM7XHJcbiAgICB9XHJcbiAgICAvLyBlcnJvcnPkuK3mnInor6XmnaHmtojmga/vvIzor7TmmI7moKHpqozmnKrpgJrov4dcclxuICAgIGlmIChlcnJvcnMgJiYgIVV0aWwuaXNVbmRlZmluZWQoZXJyb3JzW2tleV0pKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIOWAvOS4uuepuueahOaDheWGteS4i++8jOmZpG5vdEVxdWFsUG9zUmV25aSW77yM5YW25LuW6KeE5YiZ5Z2H5Li66ZSZ6K+vXHJcbiAgICBpZiAoY29udHJvbC52YWx1ZSA9PT0gJycgJiYga2V5ICE9PSAnbm90RXF1YWxQb3NSZXYnKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWvhueggeW8uuW6puetiee6p1xyXG4gICAqIEBwYXJhbSB2YWx1ZSDovpPlhaXlgLxcclxuICAgKiBAcGFyYW0gdmFsaWRhdG9yIOagoemqjOinhOWImemFjee9rlxyXG4gICAqIEBwYXJhbSBsZXZlbEZuIOWvhueggeetiee6p+iuoeeul+WHveaVsFxyXG4gICAqIEByZXR1cm5zICDlr4bnoIHlvLrluqbnrYnnuqdcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBfZ2V0TGV2ZWwodmFsdWU6IHN0cmluZywgdmFsaWRhdG9yOiBhbnksIGxldmVsRm46IEZ1bmN0aW9uKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBsZXZlbEZuKHZhbHVlLCB2YWxpZGF0b3IpO1xyXG4gIH1cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHZhbHVlOiBzdHJpbmcgPSB0aGlzLmNvbnRyb2wudmFsdWU7XHJcbiAgICAvLyBsZXZlbOiuoeeul1xyXG4gICAgbGV0IGxldmVsOiBudW1iZXIgPSAtMTtcclxuICAgIGlmICghKHZhbHVlID09PSBudWxsIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkpIHsgLy8gdmFsdWXlgLzkuLrnqbrmg4XlhrXkuIssbGV2ZWzml6DmlYjlpITnkIZcclxuICAgICAgICBsZXZlbCA9IFRpUHdkTXNnQ29tcG9uZW50Ll9nZXRMZXZlbCh2YWx1ZSwgdGhpcy52YWxpZGF0b3IsIHRoaXMubGV2ZWxGbik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6K6+572u5ZGI546w5pe26ZyA6KaB5L2/55So55qE5a2X5q61XHJcbiAgICB0aGlzLm1zZ01vZGVsID0ge1xyXG4gICAgICAgIGxldmVsLFxyXG4gICAgICAgIG1zZ0l0ZW1zOiBUaVB3ZE1zZ0NvbXBvbmVudC5fZ2V0TXNnSXRlbXModGhpcy5tc2dJdGVtcywgdGhpcy5jb250cm9sKSxcclxuICAgICAgICBzZWN1cml0eVRleHQ6IFRpUHdkTXNnQ29tcG9uZW50Ll9nZXRQd2RTdHJlbmd0aExhbignc2VjdXJpdHlUZXh0JyksXHJcbiAgICAgICAgc2VjdXJpdHlTdGF0dXM6IGxldmVsID09PSAtMSA/ICcnIDogVGlQd2RNc2dDb21wb25lbnQuX2dldFB3ZFN0cmVuZ3RoTGFuKCdsZXZlbERlY0FycicpW2xldmVsXVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuIl19