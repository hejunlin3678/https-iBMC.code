import { Util } from '../../../utils/Util';
import { AsyncCheck } from './AsyncCheck';
/**
 * @ignore
 */
export class ChangeCheck extends AsyncCheck {
    onStatusChange(ele, formControl) {
        super.onStatusChange(ele, formControl);
        this._checkHandle(ele, this.validationConf, formControl);
    }
    onFocus(ele, formControl) {
        this._checkHandle(ele, this.validationConf, formControl);
    }
    onBlur(ele, formControl) {
        // 清除先前校验信息,已失焦情况不做校验提示或tip提示,只边框标红,边框标红在样式类中通过ng-invalid处理
        this.commonHandle.destroyTip(ele);
    }
    // 校验处理函数,该函数覆盖了focus和statusChange状态下的校验处理
    _checkHandle(ele, validationConf, formControl) {
        this.commonHandle.destroyTip(ele); // 清除先前校验信息
        // 已失焦情况不做校验提示或tip提示,只边框标红,边框标红只在样式类中通过ng-invalid处理,JS中无需处理
        if (!this.commonHandle.isFocused(ele)) {
            return;
        }
        // 三种情况只做Tip提示：
        // 1.初次focus且初次focus情况下输入值未发生改变时不进行校验
        //   (初次focus值一旦发生变化且出错情况下,就要改变为错误提示)
        // 2.校验正确
        // 3.是弹窗中autofocus的元素
        // （弹窗中autofocus的元素，在弹窗打开动画结束后会先blur再focus,会使其由untouched变成touched,
        // 但需要使其表现与初次focus一致）
        const errors = formControl.control.errors;
        if ((formControl.pristine && formControl.untouched) || errors === null ||
            ele.nativeElement.querySelector('[tiautofocusinmodal]')) {
            this._addTip(ele, validationConf, validationConf && validationConf.tip);
            return;
        }
        // 其它情况下做错误提示
        this._addValidTip(ele, errors, validationConf);
    }
    // 显示错误提示信息
    _addValidTip(ele, errors, validationConf) {
        const tipContentDom = this.commonHandle.getErrorMsg(errors, validationConf);
        if (tipContentDom === null) { // 无错误信息情况下,不做处理
            return;
        }
        this._addTip(ele, validationConf, tipContentDom);
    }
    // 显示tip提示
    _addTip(ele, validationConf, tipContent) {
        // tip内容无效情况下不做处理
        if (tipContent === '' || Util.isUndefined(tipContent)) {
            return;
        }
        // 添加Tip提示
        this.commonHandle.generateTip(ele, tipContent, validationConf);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2hhbmdlQ2hlY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueTMvZGlyZWN0aXZlcy92YWxpZGF0aW9uL2NoZWNrSGFuZGxlL0NoYW5nZUNoZWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMzQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBSzFDOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFdBQVksU0FBUSxVQUFVO0lBQ2hDLGNBQWMsQ0FBQyxHQUFlLEVBQUUsV0FBc0I7UUFDekQsS0FBSyxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDdkMsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsQ0FBQztJQUM3RCxDQUFDO0lBQ00sT0FBTyxDQUFDLEdBQWUsRUFBRSxXQUFzQjtRQUNsRCxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFDTSxNQUFNLENBQUMsR0FBZSxFQUFFLFdBQXNCO1FBQ2pELDJEQUEyRDtRQUMzRCxJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRUQsMENBQTBDO0lBQ2xDLFlBQVksQ0FBQyxHQUFlLEVBQUUsY0FBa0MsRUFBRSxXQUFzQjtRQUM1RixJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFdBQVc7UUFDOUMsMkRBQTJEO1FBQzNELElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNuQyxPQUFPO1NBQ1Y7UUFFRCxlQUFlO1FBQ2YscUNBQXFDO1FBQ3JDLHFDQUFxQztRQUNyQyxTQUFTO1FBQ1QscUJBQXFCO1FBQ3JCLGtFQUFrRTtRQUNsRSxxQkFBcUI7UUFDckIsTUFBTSxNQUFNLEdBQXFCLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO1FBQzVELElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxJQUFJLFdBQVcsQ0FBQyxTQUFTLENBQUMsSUFBSSxNQUFNLEtBQUssSUFBSTtZQUNsRSxHQUFHLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxzQkFBc0IsQ0FBQyxFQUFFO1lBQ3pELElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLGNBQWMsRUFBRSxjQUFjLElBQUksY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXhFLE9BQU87U0FDVjtRQUNELGFBQWE7UUFDYixJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUVELFdBQVc7SUFDSCxZQUFZLENBQUMsR0FBZSxFQUFFLE1BQXdCLEVBQUUsY0FBa0M7UUFDOUYsTUFBTSxhQUFhLEdBQVEsSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQ2pGLElBQUksYUFBYSxLQUFLLElBQUksRUFBRSxFQUFDLGdCQUFnQjtZQUN6QyxPQUFPO1NBQ1Y7UUFDRCxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxjQUFjLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELFVBQVU7SUFDRixPQUFPLENBQUMsR0FBZSxFQUFFLGNBQWtDLEVBQUUsVUFBa0I7UUFDbkYsaUJBQWlCO1FBQ2pCLElBQUksVUFBVSxLQUFLLEVBQUUsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ25ELE9BQU87U0FDVjtRQUNELFVBQVU7UUFDVixJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsVUFBVSxFQUFFLGNBQWMsQ0FBQyxDQUFDO0lBQ25FLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFV0aWwgfSBmcm9tICcuLi8uLi8uLi91dGlscy9VdGlsJztcclxuaW1wb3J0IHsgQXN5bmNDaGVjayB9IGZyb20gJy4vQXN5bmNDaGVjayc7XHJcbmltcG9ydCB7IE5nQ29udHJvbCwgVmFsaWRhdGlvbkVycm9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUaVZhbGlkYXRpb25Db25maWcgfSBmcm9tICcuLi9UaVZhbGlkYXRpb25JbnRlcmZhY2UnO1xyXG5cclxuLyoqXHJcbiAqIEBpZ25vcmVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDaGFuZ2VDaGVjayBleHRlbmRzIEFzeW5jQ2hlY2sge1xyXG4gICAgcHVibGljIG9uU3RhdHVzQ2hhbmdlKGVsZTogRWxlbWVudFJlZiwgZm9ybUNvbnRyb2w6IE5nQ29udHJvbCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm9uU3RhdHVzQ2hhbmdlKGVsZSwgZm9ybUNvbnRyb2wpO1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSGFuZGxlKGVsZSwgdGhpcy52YWxpZGF0aW9uQ29uZiwgZm9ybUNvbnRyb2wpO1xyXG4gICAgfVxyXG4gICAgcHVibGljIG9uRm9jdXMoZWxlOiBFbGVtZW50UmVmLCBmb3JtQ29udHJvbDogTmdDb250cm9sKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tIYW5kbGUoZWxlLCB0aGlzLnZhbGlkYXRpb25Db25mLCBmb3JtQ29udHJvbCk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgb25CbHVyKGVsZTogRWxlbWVudFJlZiwgZm9ybUNvbnRyb2w6IE5nQ29udHJvbCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOa4hemZpOWFiOWJjeagoemqjOS/oeaBryzlt7LlpLHnhKbmg4XlhrXkuI3lgZrmoKHpqozmj5DnpLrmiJZ0aXDmj5DnpLos5Y+q6L655qGG5qCH57qiLOi+ueahhuagh+e6ouWcqOagt+W8j+exu+S4remAmui/h25nLWludmFsaWTlpITnkIZcclxuICAgICAgICB0aGlzLmNvbW1vbkhhbmRsZS5kZXN0cm95VGlwKGVsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5qCh6aqM5aSE55CG5Ye95pWwLOivpeWHveaVsOimhuebluS6hmZvY3Vz5ZKMc3RhdHVzQ2hhbmdl54q25oCB5LiL55qE5qCh6aqM5aSE55CGXHJcbiAgICBwcml2YXRlIF9jaGVja0hhbmRsZShlbGU6IEVsZW1lbnRSZWYsIHZhbGlkYXRpb25Db25mOiBUaVZhbGlkYXRpb25Db25maWcsIGZvcm1Db250cm9sOiBOZ0NvbnRyb2wpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNvbW1vbkhhbmRsZS5kZXN0cm95VGlwKGVsZSk7IC8vIOa4hemZpOWFiOWJjeagoemqjOS/oeaBr1xyXG4gICAgICAgIC8vIOW3suWkseeEpuaDheWGteS4jeWBmuagoemqjOaPkOekuuaIlnRpcOaPkOekuizlj6rovrnmoYbmoIfnuqIs6L655qGG5qCH57qi5Y+q5Zyo5qC35byP57G75Lit6YCa6L+HbmctaW52YWxpZOWkhOeQhixKU+S4reaXoOmcgOWkhOeQhlxyXG4gICAgICAgIGlmICghdGhpcy5jb21tb25IYW5kbGUuaXNGb2N1c2VkKGVsZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g5LiJ56eN5oOF5Ya15Y+q5YGaVGlw5o+Q56S677yaXHJcbiAgICAgICAgLy8gMS7liJ3mrKFmb2N1c+S4lOWIneasoWZvY3Vz5oOF5Ya15LiL6L6T5YWl5YC85pyq5Y+R55Sf5pS55Y+Y5pe25LiN6L+b6KGM5qCh6aqMXHJcbiAgICAgICAgLy8gICAo5Yid5qyhZm9jdXPlgLzkuIDml6blj5HnlJ/lj5jljJbkuJTlh7rplJnmg4XlhrXkuIss5bCx6KaB5pS55Y+Y5Li66ZSZ6K+v5o+Q56S6KVxyXG4gICAgICAgIC8vIDIu5qCh6aqM5q2j56GuXHJcbiAgICAgICAgLy8gMy7mmK/lvLnnqpfkuK1hdXRvZm9jdXPnmoTlhYPntKBcclxuICAgICAgICAvLyDvvIjlvLnnqpfkuK1hdXRvZm9jdXPnmoTlhYPntKDvvIzlnKjlvLnnqpfmiZPlvIDliqjnlLvnu5PmnZ/lkI7kvJrlhYhibHVy5YaNZm9jdXMs5Lya5L2/5YW255SxdW50b3VjaGVk5Y+Y5oiQdG91Y2hlZCxcclxuICAgICAgICAvLyDkvYbpnIDopoHkvb/lhbbooajnjrDkuI7liJ3mrKFmb2N1c+S4gOiHtO+8iVxyXG4gICAgICAgIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9ycyA9IGZvcm1Db250cm9sLmNvbnRyb2wuZXJyb3JzO1xyXG4gICAgICAgIGlmICgoZm9ybUNvbnRyb2wucHJpc3RpbmUgJiYgZm9ybUNvbnRyb2wudW50b3VjaGVkKSB8fCBlcnJvcnMgPT09IG51bGwgfHxcclxuICAgICAgICAgICAgZWxlLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignW3RpYXV0b2ZvY3VzaW5tb2RhbF0nKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRUaXAoZWxlLCB2YWxpZGF0aW9uQ29uZiwgdmFsaWRhdGlvbkNvbmYgJiYgdmFsaWRhdGlvbkNvbmYudGlwKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5YW25a6D5oOF5Ya15LiL5YGa6ZSZ6K+v5o+Q56S6XHJcbiAgICAgICAgdGhpcy5fYWRkVmFsaWRUaXAoZWxlLCBlcnJvcnMsIHZhbGlkYXRpb25Db25mKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrplJnor6/mj5DnpLrkv6Hmga9cclxuICAgIHByaXZhdGUgX2FkZFZhbGlkVGlwKGVsZTogRWxlbWVudFJlZiwgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzLCB2YWxpZGF0aW9uQ29uZjogVGlWYWxpZGF0aW9uQ29uZmlnKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgdGlwQ29udGVudERvbTogYW55ID0gdGhpcy5jb21tb25IYW5kbGUuZ2V0RXJyb3JNc2coZXJyb3JzLCB2YWxpZGF0aW9uQ29uZik7XHJcbiAgICAgICAgaWYgKHRpcENvbnRlbnREb20gPT09IG51bGwpIHsvLyDml6DplJnor6/kv6Hmga/mg4XlhrXkuIss5LiN5YGa5aSE55CGXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYWRkVGlwKGVsZSwgdmFsaWRhdGlvbkNvbmYsIHRpcENvbnRlbnREb20pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOaYvuekunRpcOaPkOekulxyXG4gICAgcHJpdmF0ZSBfYWRkVGlwKGVsZTogRWxlbWVudFJlZiwgdmFsaWRhdGlvbkNvbmY6IFRpVmFsaWRhdGlvbkNvbmZpZywgdGlwQ29udGVudDogc3RyaW5nKTogLyogVmlld0NvbnRhaW5lckRhdGEgKi92b2lkIHtcclxuICAgICAgICAvLyB0aXDlhoXlrrnml6DmlYjmg4XlhrXkuIvkuI3lgZrlpITnkIZcclxuICAgICAgICBpZiAodGlwQ29udGVudCA9PT0gJycgfHwgVXRpbC5pc1VuZGVmaW5lZCh0aXBDb250ZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa3u+WKoFRpcOaPkOekulxyXG4gICAgICAgIHRoaXMuY29tbW9uSGFuZGxlLmdlbmVyYXRlVGlwKGVsZSwgdGlwQ29udGVudCwgdmFsaWRhdGlvbkNvbmYpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==