import { Directive, ElementRef, Input } from '@angular/core';
import { Util } from '../../utils/Util';
import { TiTipService } from '../../services/tip/TiTipService';
// TODO:exportAs: 'tiTip' 可去除？
/**
 * tip提供了两种使用方式:
 * 1.服务方式：[TiTipService]{@link ../injectables/TiTipService.html}
 *
 * 2.指令方式（见如下说明）
 *
 * <example-url>../tiny3demo/#/tip/tip-all</example-url>
 */
export class TiTipDirective {
    constructor(tipService, hostEleRef) {
        this.tipService = tipService;
        /**
         * Tip显示位置属性配置
         */
        this.tiTipPosition = 'auto';
        /**
         * 最大宽度
         *
         */
        this.tiTipMaxWidth = '276px';
        /**
         * 是否带箭头
         */
        this.tiTipHasArrow = true;
        /**
         * tip生成方式，默认支持鼠标移入移出时显示/隐藏
         *
         * 注意：指令形式时才会使用到该参数
         */
        this.tiTipTrigger = 'mouse';
        this.hostEle = hostEleRef.nativeElement;
    }
    static isInValidValue(value) {
        return Util.isUndefined(value) || Util.isNull(value) || value === '';
    }
    ngOnInit() {
        // 初始创建tip实例
        this.tipInstance = this.tipService.create(this.hostEle, {
            position: this.tiTipPosition,
            maxWidth: this.tiTipMaxWidth,
            hasArrow: this.tiTipHasArrow,
            hostEleX: this.tiTipHostEleX,
            trigger: this.tiTipTrigger || 'mouse',
            showFn: () => {
                if (!this.tipInstance || TiTipDirective.isInValidValue(this._tiTip)) {
                    return;
                }
                return { content: this._tiTip, context: this.tiTipContext };
            }
        });
    }
    /**
     * tip显示内容配置
     *
     * 类型：string | TemplateRef<any> | any
     *
     * 传入string类型时，在v3.0.6及之前的版本存在XSS攻击风险；v3.0.7做了安全处理后不存在XSS风险了，把传入的字符串当做纯文本解析，传入什么显示什么；
     * v10.1.4版本支持html字符串片段，也已做安全处理。
     */
    set tiTip(value) {
        this._tiTip = value;
        if (TiTipDirective.isInValidValue(value)) {
            this.hide();
        }
    }
    /**
     * @ignore
     */
    get tiTip() {
        return this._tiTip;
    }
    /**
     * 显示tip方法
     */
    show() {
        if (!this.tipInstance || TiTipDirective.isInValidValue(this._tiTip)) {
            return;
        }
        return this.tipInstance.show(this._tiTip, this.tiTipContext);
    }
    /**
     * 隐藏tip方法
     */
    hide() {
        if (this.tipInstance) {
            this.tipInstance.hide();
        }
    }
    // 宿主销毁，tip连带销毁
    ngOnDestroy() {
        this.tipInstance.hide();
        /* tslint:disable:no-null-keyword */
        this.tipInstance = null;
    }
}
TiTipDirective.decorators = [
    { type: Directive, args: [{
                selector: '[tiTip]',
                exportAs: 'tiTip'
            },] }
];
TiTipDirective.ctorParameters = () => [
    { type: TiTipService },
    { type: ElementRef }
];
TiTipDirective.propDecorators = {
    tiTipPosition: [{ type: Input }],
    tiTipMaxWidth: [{ type: Input }],
    tiTipHasArrow: [{ type: Input }],
    tiTipContext: [{ type: Input }],
    tiTipTrigger: [{ type: Input }],
    tiTipHostEleX: [{ type: Input }],
    tiTip: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlUaXBEaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueTMvZGlyZWN0aXZlcy90aXAvVGlUaXBEaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFnQixTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBNkMsTUFBTSxlQUFlLENBQUM7QUFDdEgsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBR3hDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUUvRCw4QkFBOEI7QUFDOUI7Ozs7Ozs7R0FPRztBQUtILE1BQU0sT0FBTyxjQUFjO0lBa0N2QixZQUFvQixVQUF3QixFQUNoQyxVQUFzQjtRQURkLGVBQVUsR0FBVixVQUFVLENBQWM7UUFqQzVDOztXQUVHO1FBQ00sa0JBQWEsR0FBb0IsTUFBTSxDQUFDO1FBQ2xEOzs7V0FHRztRQUNNLGtCQUFhLEdBQVcsT0FBTyxDQUFDO1FBQ3hDOztXQUVHO1FBQ00sa0JBQWEsR0FBYSxJQUFJLENBQUM7UUFPeEM7Ozs7V0FJRztRQUNNLGlCQUFZLEdBQXNCLE9BQU8sQ0FBQztRQVcvQyxJQUFJLENBQUMsT0FBTyxHQUFHLFVBQVUsQ0FBQyxhQUFhLENBQUM7SUFDNUMsQ0FBQztJQUVPLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBZ0M7UUFDMUQsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztJQUN6RSxDQUFDO0lBQ0QsUUFBUTtRQUNKLFlBQVk7UUFDWixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDcEQsUUFBUSxFQUFFLElBQUksQ0FBQyxhQUFhO1lBQzVCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYTtZQUM1QixRQUFRLEVBQUUsSUFBSSxDQUFDLGFBQWE7WUFDNUIsUUFBUSxFQUFFLElBQUksQ0FBQyxhQUFhO1lBQzVCLE9BQU8sRUFBRSxJQUFJLENBQUMsWUFBWSxJQUFJLE9BQU87WUFDckMsTUFBTSxFQUFFLEdBQWtCLEVBQUU7Z0JBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLGNBQWMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO29CQUNqRSxPQUFPO2lCQUNWO2dCQUVELE9BQU8sRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ2hFLENBQUM7U0FDSixDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0Q7Ozs7Ozs7T0FPRztJQUNILElBS0ksS0FBSyxDQUFDLEtBQWdDO1FBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLElBQUksY0FBYyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN0QyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDZjtJQUNMLENBQUM7SUFDRDs7T0FFRztJQUNILElBQUksS0FBSztRQUNMLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBQ0Q7O09BRUc7SUFDSSxJQUFJO1FBQ1AsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUksY0FBYyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDakUsT0FBTztTQUNWO1FBRUQsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBQ0Q7O09BRUc7SUFDSSxJQUFJO1FBQ1AsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDM0I7SUFDTCxDQUFDO0lBQ0QsZUFBZTtJQUNmLFdBQVc7UUFDUCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3hCLG9DQUFvQztRQUNwQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztJQUM1QixDQUFDOzs7WUEvR0osU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxTQUFTO2dCQUNuQixRQUFRLEVBQUUsT0FBTzthQUNsQjs7O1lBZFEsWUFBWTtZQUphLFVBQVU7Ozs0QkF1QnZDLEtBQUs7NEJBS04sS0FBSzs0QkFJSixLQUFLOzJCQU1MLEtBQUs7MkJBTUwsS0FBSzs0QkFLTCxLQUFLO29CQXFDTCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50UmVmLCBEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgUmVuZGVyZXIyLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBVdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCB7IFRpUG9zaXRpb25UeXBlIH0gZnJvbSAnLi4vLi4vdXRpbHMvUG9zaXRpb24nO1xyXG5pbXBvcnQgeyBUaVRpcFJlZiwgVGlUaXBTaG93SW5mbyB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RpcC9UaVRpcEludGVyZmFjZSc7XHJcbmltcG9ydCB7IFRpVGlwU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RpcC9UaVRpcFNlcnZpY2UnO1xyXG5cclxuLy8gVE9ETzpleHBvcnRBczogJ3RpVGlwJyDlj6/ljrvpmaTvvJ9cclxuLyoqXHJcbiAqIHRpcOaPkOS+m+S6huS4pOenjeS9v+eUqOaWueW8jzpcclxuICogMS7mnI3liqHmlrnlvI/vvJpbVGlUaXBTZXJ2aWNlXXtAbGluayAuLi9pbmplY3RhYmxlcy9UaVRpcFNlcnZpY2UuaHRtbH1cclxuICpcclxuICogMi7mjIfku6TmlrnlvI/vvIjop4HlpoLkuIvor7TmmI7vvIlcclxuICpcclxuICogPGV4YW1wbGUtdXJsPi4uL3RpbnkzZGVtby8jL3RpcC90aXAtYWxsPC9leGFtcGxlLXVybD5cclxuICovXHJcbkBEaXJlY3RpdmUoe1xyXG4gIHNlbGVjdG9yOiAnW3RpVGlwXScsXHJcbiAgZXhwb3J0QXM6ICd0aVRpcCdcclxufSlcclxuZXhwb3J0IGNsYXNzIFRpVGlwRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaXDmmL7npLrkvY3nva7lsZ7mgKfphY3nva5cclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgdGlUaXBQb3NpdGlvbj86IFRpUG9zaXRpb25UeXBlID0gJ2F1dG8nO1xyXG4gICAvKipcclxuICAgICog5pyA5aSn5a695bqmXHJcbiAgICAqXHJcbiAgICAqL1xyXG4gICBASW5wdXQoKSB0aVRpcE1heFdpZHRoOiBzdHJpbmcgPSAnMjc2cHgnO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmK/lkKbluKbnrq3lpLRcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgdGlUaXBIYXNBcnJvdz86IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiB0aXDmmL7npLrlhoXlrrnlr7nlupTnmoTkuIrkuIvmlofvvIx0aXDlhoXlrrnnsbvlnovkuLp0ZW1wbGF0ZVJlZuaIlkNvbXBvbmVudOW9ouW8j+aXtuS8mueUqOWIsOivpeWPguaVsO+8jOWPguaVsOS4uuiHquWumuS5ieWvueixoeW9ouW8j1xyXG4gICAgICpcclxuICAgICAqIOazqOaEj++8muaMh+S7pOW9ouW8j+aXtuaJjeS8muS9v+eUqOWIsOivpeWPguaVsFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSB0aVRpcENvbnRleHQ/OiBhbnk7XHJcbiAgICAvKipcclxuICAgICAqIHRpcOeUn+aIkOaWueW8j++8jOm7mOiupOaUr+aMgem8oOagh+enu+WFpeenu+WHuuaXtuaYvuekui/pmpDol49cclxuICAgICAqXHJcbiAgICAgKiDms6jmhI/vvJrmjIfku6TlvaLlvI/ml7bmiY3kvJrkvb/nlKjliLDor6Xlj4LmlbBcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgdGlUaXBUcmlnZ2VyPzogJ21vdXNlJ3wnbWFudWFsJyA9ICdtb3VzZSc7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOWGs+WumnRpcOawtOW5s+aWueWQkeS9jee9rueahOWuv+S4u+WFg+e0oOmFjee9rlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSB0aVRpcEhvc3RFbGVYOiBFbGVtZW50O1xyXG4gICAgcHJvdGVjdGVkIHRpcEluc3RhbmNlOiBUaVRpcFJlZjtcclxuICAgIHByaXZhdGUgaG9zdEVsZTogRWxlbWVudDtcclxuICAgIHByaXZhdGUgX3RpVGlwOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0aXBTZXJ2aWNlOiBUaVRpcFNlcnZpY2UsXHJcbiAgICAgICAgICAgICAgICBob3N0RWxlUmVmOiBFbGVtZW50UmVmKSB7XHJcbiAgICAgICAgdGhpcy5ob3N0RWxlID0gaG9zdEVsZVJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGlzSW5WYWxpZFZhbHVlKHZhbHVlOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjxhbnk+KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIFV0aWwuaXNVbmRlZmluZWQodmFsdWUpIHx8IFV0aWwuaXNOdWxsKHZhbHVlKSB8fCB2YWx1ZSA9PT0gJyc7XHJcbiAgICB9XHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyDliJ3lp4vliJvlu7p0aXDlrp7kvotcclxuICAgICAgICB0aGlzLnRpcEluc3RhbmNlID0gdGhpcy50aXBTZXJ2aWNlLmNyZWF0ZSh0aGlzLmhvc3RFbGUsIHtcclxuICAgICAgICAgICAgcG9zaXRpb246IHRoaXMudGlUaXBQb3NpdGlvbixcclxuICAgICAgICAgICAgbWF4V2lkdGg6IHRoaXMudGlUaXBNYXhXaWR0aCxcclxuICAgICAgICAgICAgaGFzQXJyb3c6IHRoaXMudGlUaXBIYXNBcnJvdyxcclxuICAgICAgICAgICAgaG9zdEVsZVg6IHRoaXMudGlUaXBIb3N0RWxlWCxcclxuICAgICAgICAgICAgdHJpZ2dlcjogdGhpcy50aVRpcFRyaWdnZXIgfHwgJ21vdXNlJywgLy8g5oyH5Luk5pa55byP77yM6buY6K6k5Li6J21vdXNlJ1xyXG4gICAgICAgICAgICBzaG93Rm46ICgpOiBUaVRpcFNob3dJbmZvID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aXBJbnN0YW5jZSB8fCBUaVRpcERpcmVjdGl2ZS5pc0luVmFsaWRWYWx1ZSh0aGlzLl90aVRpcCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgY29udGVudDogdGhpcy5fdGlUaXAsIGNvbnRleHQ6IHRoaXMudGlUaXBDb250ZXh0IH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogdGlw5pi+56S65YaF5a656YWN572uXHJcbiAgICAgKlxyXG4gICAgICog57G75Z6L77yac3RyaW5nIHwgVGVtcGxhdGVSZWY8YW55PiB8IGFueVxyXG4gICAgICpcclxuICAgICAqIOS8oOWFpXN0cmluZ+exu+Wei+aXtu+8jOWcqHYzLjAuNuWPiuS5i+WJjeeahOeJiOacrOWtmOWcqFhTU+aUu+WHu+mjjumZqe+8m3YzLjAuN+WBmuS6huWuieWFqOWkhOeQhuWQjuS4jeWtmOWcqFhTU+mjjumZqeS6hu+8jOaKiuS8oOWFpeeahOWtl+espuS4suW9k+WBmue6r+aWh+acrOino+aekO+8jOS8oOWFpeS7gOS5iOaYvuekuuS7gOS5iO+8m1xyXG4gICAgICogdjEwLjEuNOeJiOacrOaUr+aMgWh0bWzlrZfnrKbkuLLniYfmrrXvvIzkuZ/lt7LlgZrlronlhajlpITnkIbjgIJcclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIC8vIOebkeWQrHRpcOWAvOeahOWPmOWMlu+8jOW9k3RpcOS4uicn5oiWdW5kZWZpbmVk5oOF5Ya15LiL77yM55u05o6l6ZqQ6JePdGlw57uE5Lu2XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgc2V0IHRpVGlwKHZhbHVlOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjxhbnk+KSB7XHJcbiAgICAgICAgdGhpcy5fdGlUaXAgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoVGlUaXBEaXJlY3RpdmUuaXNJblZhbGlkVmFsdWUodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBnZXQgdGlUaXAoKTogc3RyaW5nIHwgVGVtcGxhdGVSZWY8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpVGlwO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLp0aXDmlrnms5VcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNob3coKTogQ29tcG9uZW50UmVmPGFueT4ge1xyXG4gICAgICAgIGlmICghdGhpcy50aXBJbnN0YW5jZSB8fCBUaVRpcERpcmVjdGl2ZS5pc0luVmFsaWRWYWx1ZSh0aGlzLl90aVRpcCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGlwSW5zdGFuY2Uuc2hvdyh0aGlzLl90aVRpcCwgdGhpcy50aVRpcENvbnRleHQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDpmpDol490aXDmlrnms5VcclxuICAgICAqL1xyXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMudGlwSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgdGhpcy50aXBJbnN0YW5jZS5oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5a6/5Li76ZSA5q+B77yMdGlw6L+e5bim6ZSA5q+BXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRpcEluc3RhbmNlLmhpZGUoKTtcclxuICAgICAgICAvKiB0c2xpbnQ6ZGlzYWJsZTpuby1udWxsLWtleXdvcmQgKi9cclxuICAgICAgICB0aGlzLnRpcEluc3RhbmNlID0gbnVsbDtcclxuICAgIH1cclxufVxyXG4iXX0=