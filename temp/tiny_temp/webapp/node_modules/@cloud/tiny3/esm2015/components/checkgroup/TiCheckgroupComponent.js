import { Component, EventEmitter, HostListener, Input, Output } from '@angular/core';
import { ObservableMap, ObservableSet, TiLog } from '../../utils/Util';
import { TiCheckitemComponent } from './TiCheckitemComponent';
// TODO: 有些用户提出，响应式表单里，checkgroup value没有绑定已选中数据，不方便。
/**
 * Checkgroup全选框组件，主要功能为从一数据集合中选择某几条数据，与多选组件(Select multiple)功能相同，只是数据规模和视觉呈现不同。
 *
 * 复选框组通常由一个全选框和多个子复选框构成。
 *
 * <example-url>../tiny3demo/#/checkgroup/checkgroup-all</example-url>
 */
export class TiCheckgroupComponent extends TiCheckitemComponent {
    constructor() {
        super(...arguments);
        /**
         * 已选中数据集，双向绑定
         */
        this.checkedsChange = new EventEmitter();
        this.disabledSet = new ObservableSet(); // 储存本组所有禁用的子选项
        /**
         * 【6】globeCheckedMap→checkedMap
         */
        this.globeCheckedMapObserverFn = (item, value, isAdd, from) => {
            if (from !== this.checkedMap && this.items.includes(item)) {
                // 同步globe的改变到本地
                if (isAdd) {
                    this.checkedMap.set(item, value, TiCheckitemComponent.globeCheckedMap);
                }
                else {
                    // !isAdd. 如果globe删除了某项，但这项属于自己的子项，那么把这一项添加回globe。（场景：子项item动态改变，并未销毁，却触发了全局delete）
                    TiCheckitemComponent.globeCheckedMap.set(item, this.checkedMap.get(item), this.checkedMap);
                }
            }
        };
        /**
         * 【7】globeDisabledSet→disabledSet
         */
        this.globeDisabledSetObserverFn = (item, isAdd) => {
            if (isAdd && this.items.includes(item)) {
                this.disabledSet.add(item);
            }
            else if (!isAdd) {
                this.disabledSet.delete(item);
            }
        };
    }
    /**
     * @ignore
     * 监听change事件，会多触发一次DoCheck。
     * @param checked 原生change事件选中状态：全选，全不选
     */
    onHostChange(checked) {
        super.onHostChange(checked);
        if (this.nativeElement.checked === true) {
            // 全选
            this.checkAll(true);
        }
        else if (this.nativeElement.indeterminate === true) {
            // 半选情况，不作处理。
        }
        else {
            // 全不选
            this.checkAll(false);
        }
    }
    ngOnInit() {
        super.ngOnInit();
        this.initCheckedMap();
        this.initGlobeCheckedMap();
        this.initDisabledSet();
        this.setChecked();
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        // 解除监听
        TiCheckitemComponent.globeCheckedMap.removeObserver(this.globeCheckedMapObserverFn);
        TiCheckitemComponent.globeDisabledSet.removeObserver(this.globeDisabledSetObserverFn);
    }
    ngDoCheck() {
        super.ngDoCheck();
        // 【1】[items][checkeds] →  checkedMap
        const itemsChanges = this.itemsDiffer.diff(this.items);
        const checkedsChanges = this.checkedsDiffer.diff(this.checkeds);
        if (checkedsChanges) {
            checkedsChanges.forEachAddedItem(record => {
                const item = this.getItem(record.item);
                if (this.items.includes(item)) {
                    this.checkedMap.set(item, true, this.checkeds);
                }
                else {
                    // 正常不会走到这里
                    this.checkedMap.delete(item, this.checkeds);
                    // 表格需求：允许用户设置的checkeds，范围大于items。所以会走到这里
                    // TiLog.warn('checkeds new item is not in items');
                }
            });
            checkedsChanges.forEachRemovedItem(record => {
                const item = this.getItem(record.item);
                if (this.items.includes(item)) {
                    if (this.checkedMap.get(item) === true || this.checkedMap.get(item) === undefined) {
                        this.checkedMap.set(item, false, this.checkeds);
                    }
                }
                else {
                    this.checkedMap.delete(item, this.checkeds);
                }
                // 强调：如果子选项是半选状态null，就不再置false了。
                // 规律：父节点，不会下达让子节点由null到false的指令。父节点，只会下达让节点由null到true的指令。
                // 注意：在树型结构中，外界@Input checkeds不能强制指定某个半选节点，变为不选。（checkeds中去除某个节点，此节点保持半选不变。）
            });
        }
        // 将每次的变化，合入到全局变量中。因为多出来的项目，可能是刚才使用过的，所以需要重新赋值
        if (itemsChanges) {
            itemsChanges.forEachAddedItem(record => {
                // Map中没有此项，会返回undefined
                if (this.checkedMap.has(record.item)) {
                    //  初始化为什么会走到这里？本以为没有代码可以走到这里
                    // 【5】checkedMap→globeCheckedMap
                    TiCheckitemComponent.globeCheckedMap.set(record.item, this.checkedMap.get(record.item), this.checkedMap);
                }
                else {
                    // 表格需求：checkeds允许范围比items更大。所以，根据checkeds来给checkedMap设置。
                    let isChecked = false;
                    const value = this.getValue(record.item);
                    if (this.checkeds instanceof Array) {
                        isChecked = this.checkeds.includes(value);
                    }
                    else if (this.checkeds instanceof Set) {
                        isChecked = this.checkeds.has(value);
                    }
                    this.checkedMap.set(record.item, isChecked, this.checkeds);
                    if (TiCheckitemComponent.globeDisabledSet.has(record.item)) {
                        this.disabledSet.add(record.item);
                    }
                    else {
                        this.disabledSet.delete(record.item);
                    }
                }
            });
            itemsChanges.forEachRemovedItem(record => {
                this.checkedMap.delete(record.item, this.checkeds); // from标志从checkeds来，所以词条checkedMap变化，并未同步到checkeds。
                // 注意：会造成checkeds范围大于items
                this.disabledSet.delete(record.item);
            });
        }
        if (checkedsChanges || itemsChanges) {
            // 【3】checkedMap →  Group checked
            this.setChecked(); // 设置全选状态。本地checkedMap变化，元素很多，但只初始化一次。
        }
        // 发出事件：checkeds改变
        if (checkedsChanges) {
            // TODO：后面可能要做，更新引用。
            // 一旦更新引用，就得要求所有用户双向绑定[(checkeds)]。但旧版demo里是单向绑定，对一些遗留用户不友好。
            // tslint:disable-next-line:prefer-conditional-expression
            // if (this.checkeds instanceof Array) {
            //     this.checkeds = this.checkeds.concat([]); // 更新引用
            // } else {
            //     this.checkeds = new Set(Array.from(this.checkeds)); // 更新引用
            // }
            /**
             * checkedsChange 回调中同步修改其他数据会报错，影响正常功能，所以需要延时，
             * 为什么不使用setTimout而使用Promise，Promise.then 是微任务，比setTimout(宏任务)先执行，想尽量早emit事件
             * 宏任务和微任务：https://juejin.cn/post/6844903657264136200
             * issue: https://git.huawei.com/WCC/Tiny3/issues/1588
             * 扩展：ngDoCheck,ngAfterViewChecked中emit事件，在事件回调中同步修改数据，都存在同样问题。
             */
            Promise.resolve(null).then(() => {
                this.checkedsChange.emit(this.checkeds);
            });
        }
    }
    initCheckedMap() {
        // 监听items和checkeds
        this.itemsDiffer = this.iterableDiffers.find(this.items).create(null);
        this.checkedsDiffer = this.iterableDiffers.find(this.checkeds).create(null);
        this.checkedMap = new ObservableMap();
        this.items.forEach(// 【1】[items][checkeds] →  checkedMap
        // 【1】[items][checkeds] →  checkedMap
        item => {
            let isChecked = false;
            const value = this.getValue(item);
            if (this.checkeds instanceof Array) {
                isChecked = this.checkeds.includes(value);
            }
            else if (this.checkeds instanceof Set) {
                isChecked = this.checkeds.has(value);
            }
            if (isChecked) { // 选中态，直接添加
                this.checkedMap.set(item, true, this.checkeds);
            }
            else if (this.checkedMap.get(item) === true || this.checkedMap.get(item) === undefined) { // 初始化
                this.checkedMap.set(item, false, this.checkeds);
                // 强调：如果子选项是半选状态null，就不再置false了。
                // 规律：父节点，不会下达让子节点由null到false的指令。父节点，只会下达让节点由null到true的指令。
                // 注意：在树型结构中，外界@Input checkeds不能强制指定某个半选节点，变为不选。（checkeds中去除某个节点，此节点保持半选不变。）
            }
        });
        this.checkedMap.addObserver((item, value, isAdd, from) => {
            // 有多个来源：chekceds，（items），checkall，globe
            // 不是从checkeds来的，就要同步到chekeds
            if (from !== this.checkeds) {
                // 【2】checkedMap- >[checkeds]
                const isChecked = isAdd && this.checkedMap.get(item);
                const newItem = this.getValue(item);
                if (this.checkeds instanceof Set) {
                    isChecked ? this.checkeds.add(newItem) : this.checkeds.delete(item);
                }
                else if (this.checkeds instanceof Array) { // TODO:写公用的Array remove函数
                    const index = this.checkeds.indexOf(newItem);
                    if (isChecked && index === -1) {
                        this.checkeds.push(newItem);
                    }
                    else if (!isChecked && index !== -1) {
                        this.checkeds.splice(index, 1);
                    }
                }
            }
            // 不是从全局来的，就要同步到全球。
            if (from !== TiCheckitemComponent.globeCheckedMap) {
                // 【5】checkedMap→globeCheckedMap
                TiCheckitemComponent.globeCheckedMap.set(item, value, this.checkedMap);
            }
            // 从全局来的，需要更新全选状态。（树形结构层级较多，需要这个逻辑）
            if (from === TiCheckitemComponent.globeCheckedMap) {
                // 【3】checkedMap →  Group checked
                this.setChecked();
            }
        });
    }
    initGlobeCheckedMap() {
        // checkedMap以group端优先，disabled以item端优先。
        // checkedMap同步加入到globeCheckedMap
        this.checkedMap.getMap()
            .forEach(item => {
            // 【5】checkedMap→globeCheckedMap
            TiCheckitemComponent.globeCheckedMap.set(item[0], item[1], this.checkedMap);
        });
        // 监听globecheckedMap
        TiCheckitemComponent.globeCheckedMap.addObserver(this.globeCheckedMapObserverFn);
    }
    initDisabledSet() {
        // 【7】globeDisabledSet→disabledSet，并监听
        this.items.forEach(item => {
            TiCheckitemComponent.globeDisabledSet.has(item) ?
                this.disabledSet.add(item) : this.disabledSet.delete(item);
        });
        // 【7】globeDisabledSet→disabledSet，监听globeDisabledSet
        TiCheckitemComponent.globeDisabledSet.addObserver(this.globeDisabledSetObserverFn);
        // 【8】disabledSet→Group checked
        this.disabledSet.addObserver((item, isAdd) => {
            this.setChecked();
        });
    }
    /**
     * 设置本group全选框的状态 【3】checkedMap →  Group checked
     */
    setChecked() {
        this.checked(this.getCheckedStatus());
    }
    /**
     * 规则一：disabled状态的复选框不影响全选状态，所以需要将其从统计信息中过滤
     * 例如有3个复选框，前两个为选中状态，最后一个是disabled，则认为整体为全部选中状态
     * 所以无需关心disabled复选框的选中状态，只需关心非disabled状态即可
     * 规则二：但当子复选框全部是disabled状态时，将会影响全选的状态
     * @returns 全选：true，全不选：false，半选：null
     */
    getCheckedStatus() {
        if (this.items.length === 0) { // 情景零：没有选项
            return false;
        }
        // 用户可勾选项目数
        let checkedableNum = this.items.length - this.disabledSet.size;
        const isTotalCount = (this.disabledSet.size === 0 || checkedableNum === 0); // 全部可用，或者全部禁用。所有选项进入统计。
        if (checkedableNum === 0) { // 如果全部禁用，那么所有选项都计入统计。
            checkedableNum = this.items.length;
        }
        let checkedNum = 0; // 选中项数目（非禁用）
        let notCheckedNum = 0; // 未选项数目（非禁用）
        for (const item of this.items) {
            if (isTotalCount || !this.disabledSet.has(item)) { // 全部进入统计，或者未禁用项进入统计。
                switch (this.checkedMap.get(item)) {
                    case true:
                        checkedNum++;
                        break;
                    case false:
                        notCheckedNum++;
                        break;
                    case null:
                        return null; // 只要有一个子选项是半选，那么结果是半选。
                    default:
                        // 不会走到这里
                        TiLog.error('getCheckedStatus(),can not reach code, items item is not in checkedMap');
                        break;
                }
                if (checkedNum !== 0 && notCheckedNum !== 0) {
                    // 有选中，有不选中，所以半选。
                    return null; // 半选
                }
                else if (checkedNum === checkedableNum) {
                    return true;
                }
                else if (notCheckedNum === checkedableNum) {
                    return false;
                }
            }
        }
        // Logger.error('getCheckedStatus(),end, can not reach code,');
        return false;
    }
    /**
     *  设置全选框的状态值
     * 【4】Group checked →  checkedMap
     * @param checked
     */
    checkAll(checked) {
        this.items.forEach(item => {
            if (!this.disabledSet.has(item)) {
                // 【4】Group checked →  checkedMap
                this.checkedMap.set(item, checked, this.checkAll);
            }
        });
    }
    /**
     * 输出：得到整个item对象
     * @param value item对象或者数据的身份标识
     *
     */
    getItem(value) {
        for (const obj of this.items) {
            if (obj === value || obj[this.valueKey] === value) {
                return obj;
            }
        }
        return null;
    }
}
TiCheckgroupComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: '[tiCheckgroup]',
                template: "<!--Tiny3\u4F18\u5316\uFF1A\u51CF\u5C11label\u5D4C\u5957\uFF0C\u53BB\u9664\u5185\u5C42label-->\r\n<label #labelRef class='ti3-checkbox' [for]='id'  [id]=\"appendId('checkbox')\">\r\n    <!-- \u517C\u5BB9IE11\u6DFB\u52A0spacebar\u4E8B\u4EF6 -->\r\n    <span #proxyRef class='ti3-checkbox-skin ti3-icon ti3-icon-checkmark' tiOutline\r\n        (keydown.spacebar)=\"onSpaceKeydown($event)\"  (keyup.spacebar)=\"onSpaceKeyup($event)\"\r\n        (keydown.space)=\"onSpaceKeydown($event)\"  (keyup.space)=\"onSpaceKeyup($event)\"></span>\r\n    <span class='ti3-checkbox-label' [id]=\"appendId('label')\">{{label}}</span>\r\n</label>",
                // tslint:disable-next-line:use-host-property-decorator
                host: {
                    'tiCheckbox': '' // 给宿主元素添加tiCheckbox属性，实现定制样式
                },
                styles: [":hostinput[type=checkbox][tiCheckbox]{display:none!important}:hostinput[type=checkbox][tiCheckbox]+.ti3-checkbox{-ms-box-sizing:border-box;-ms-user-select:none;-webkit-user-select:none;box-sizing:border-box;cursor:pointer;display:inline-block;font-weight:400;line-height:1em;margin-bottom:0;user-select:none;vertical-align:middle}:hostinput[type=checkbox][tiCheckbox]+.ti3-checkbox .ti3-checkbox-skin{-ms-box-sizing:border-box;background-color:var(--ti-checkbox-bg-color);border:1px solid var(--ti-checkbox-border-color);border-collapse:separate;border-radius:2px;box-sizing:border-box;color:transparent;display:inline-block;height:var(--ti-checkbox-size);line-height:var(--ti-checkbox-mark-size);margin-bottom:0;margin-right:var(--ti-checkbox-label-right-space);position:relative;text-align:center;transition:background-color .15s,border-color .15s;vertical-align:middle;width:var(--ti-checkbox-size)}:hostinput[type=checkbox][tiCheckbox]+.ti3-checkbox .ti3-checkbox-label{-ms-user-select:none;-webkit-user-select:none;color:var(--ti-checkbox-label-color);display:inline;margin-bottom:0;user-select:none;vertical-align:middle}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):checked+.ti3-checkbox .ti3-checkbox-skin{background-color:var(--ti-checkbox-bg-color-checked);border-color:var(--ti-checkbox-border-color-checked);color:var(--ti-checkbox-label-color-checked)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):checked+.ti3-checkbox .ti3-checkbox-skin:focus,:hostinput[type=checkbox][tiCheckbox]:not([disabled]):checked+.ti3-checkbox .ti3-checkbox-skin:hover{background-color:var(--ti-checkbox-bg-color-checked-hover);border-color:var(--ti-checkbox-bg-color-checked-hover)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):checked+.ti3-checkbox .ti3-checkbox-skin:active{background-color:var(--ti-checkbox-bg-color-checked-active);border-color:var(--ti-checkbox-bg-color-checked-active)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):not(:checked)+.ti3-checkbox .ti3-checkbox-skin:focus,:hostinput[type=checkbox][tiCheckbox]:not([disabled]):not(:checked)+.ti3-checkbox .ti3-checkbox-skin:hover{border-color:var(--ti-checkbox-border-color-hover)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):not(:checked)+.ti3-checkbox .ti3-checkbox-skin:active{background-color:var(--ti-checkbox-bg-color-unchecked-active);border-color:var(--ti-checkbox-border-color-unchecked-active)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):indeterminate+.ti3-checkbox .ti3-checkbox-skin{background-color:var(--ti-checkbox-partial-color-checked);border-color:var(--ti-checkbox-partial-color-checked)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):indeterminate+.ti3-checkbox .ti3-checkbox-skin:before{background-color:var(--ti-checkbox-label-color-checked)}:hostinput[type=checkbox][tiCheckbox]:not([disabled]):indeterminate+.ti3-checkbox .ti3-checkbox-skin:hover{background-color:var(--ti-checkbox-partial-color-checked-hover);border-color:var(--ti-checkbox-partial-color-checked-hover)}:hostinput[type=checkbox][tiCheckbox][disabled]+.ti3-checkbox{cursor:not-allowed}:hostinput[type=checkbox][tiCheckbox][disabled]+.ti3-checkbox .ti3-checkbox-skin{background-color:var(--ti-checkbox-label-color-checked);outline:none}:hostinput[type=checkbox][tiCheckbox][disabled]+.ti3-checkbox .ti3-checkbox-label{color:var(--ti-checkbox-label-color-disabled)}:hostinput[type=checkbox][tiCheckbox][disabled]:checked+.ti3-checkbox .ti3-checkbox-skin{background-color:var(--ti-checkbox-bg-color-disable);border-color:var(--ti-checkbox-border-color-checked-disabled);color:var(--ti-checkbox-mark-color-disabled)}:hostinput[type=checkbox][tiCheckbox][disabled]:not(:checked)+.ti3-checkbox .ti3-checkbox-skin{background-color:var(--ti-checkbox-bg-color-disable);border-color:var(--ti-checkbox-border-color-unchecked-disabled);color:transparent}:hostinput[type=checkbox][tiCheckbox][disabled]:indeterminate+.ti3-checkbox .ti3-checkbox-skin:before{background-color:var(--ti-checkbox-partial-color-checked-disabled)}:hostinput[type=checkbox][tiCheckbox]:checked+.ti3-checkbox .ti3-checkbox-skin:before{-ms-box-sizing:border-box;border-style:solid;border-width:0 2px 2px 0;box-sizing:border-box;content:\" \";display:table;height:9px;left:21%;position:absolute;top:50%;transform:rotate(45deg) translate(-55%,-55%) scale(1);width:7px}:hostinput[type=checkbox][tiCheckbox]:indeterminate+.ti3-checkbox .ti3-checkbox-skin:before{border-radius:1px;content:\"\";height:var(--ti-checkbox-partial-center-size);left:4px;position:absolute;top:4px;width:var(--ti-checkbox-partial-center-size)}@keyframes rect-selectedAnimate{0%{transform:scale(0);transform-origin:center}to{color:var(--ti-checkbox-label-color-checked);transform:scale(1);transform-origin:center}}@keyframes tick-selectedAnimate{0%{transform:rotate(45deg) translate(-55%,-55%) scale(0);transform-origin:center}to{color:var(--ti-checkbox-label-color-checked);transform:rotate(45deg) translate(-55%,-55%) scale(1);transform-origin:center}}input[type=checkbox][tiCheckbox]:not(:disabled):checked+.ti3-checkbox .ti3-icon-checkmark:before{animation:tick-selectedAnimate .2s var(--ti-timing-function-default) forwards}input[type=checkbox][tiCheckbox]:not(:disabled):indeterminate+.ti3-checkbox .ti3-icon-checkmark:before{animation:rect-selectedAnimate .2s var(--ti-timing-function-default) forwards}input[type=checkbox][tiCheckbox]:not(:disabled):checked+.ti3-checkbox .ti3-checkbox-skin:hover{transition:border-color .2s var(--ti-timing-function-default),background-color .2s var(--ti-timing-function-default)}"]
            },] }
];
TiCheckgroupComponent.propDecorators = {
    items: [{ type: Input }],
    checkeds: [{ type: Input }],
    checkedsChange: [{ type: Output }],
    onHostChange: [{ type: HostListener, args: ['change', ['$event'],] }]
};
/*
需求：Group checked，Item checked，[(checkedSet)]三者其一改变，都要通知其他二者。所以采用中介者模式。

版本一：Tiny2,中介者是[(checkedSet)]，但要求Item也去绑定[(groupCheckedSet)]

                           Group checked    ←  disabledSet
                                     ↕                               ↑
[dataArray]         [checkedSet]            groupDisabledSet
                                     ↕                               ↑
                            Item checked             Item disabled

版本二：中介者是全局变量globeCheckedSet，不要求Item绑定其他变量。

                          Group checked   ←   disabledSet
[dataArray]                   ↕                              ↑
[(checkedSet)]↔globeCheckedSet     globeDisabledSet
                                     ↕                              ↑
                            Item checked           Item disabled

版本三：链条传递，不要求Item绑定其他变量。

                   Group checked       ←     disabledSet
                            ↕                                         ↑
[dataArray] [checkedSet]                               ↑
                            ↕                                         ↑
                   globeCheckedSet            globeDisabledSet
                            ↕                                         ↑
                    Item checked                  Item disabled

版本四：Tiny3, 链条传递，不要求Item绑定其他变量。但也可以绑定所属于组织选中变量。Array/Set兼容

                                    Group checked       ←     disabledSet
                                            ↕                                     ↑
            [checkeds] ↔  checkedSet                            ↑
                                            ↕                                     ↑
                                    globeCheckedSet            globeDisabledSet
                                             ↕                                     ↑
                                    Item checked                   Item disabled
                                             ↕
         [beCheckeds] ↔ beCheckedSet
版本五：Tiny3, 链条传递，不要求Item绑定其他变量。但也可以绑定所属于组织选中变量。Array/Set兼容。
兼容Tree树形结构，子节点也有可能是半选状态。
                                                                    8
                                    Group checked       ←     disabledSet
                             1>         3↑↓4                                 ↑
 [items][checkeds] ↔  checkedMap                           ↑
                            <2          5↓↑6                                  ↑7
                                    globeCheckedMap          globeDisabledSet
                                            ↓↑                                     ↑
                                    Item checked                    Item disabled
                                            ↓↑
         [beCheckeds] ↔ beCheckedSet
*/
/*
@Input支持Set<any>|Array<any>
方案一：每次使用时，都判断类型，调用不同方法。
方案二：@Input set时，给Array绑定上has()、add()、delete()方法，但是get size怎么绑定？
方案三：Set<any>|Array，赋值给新的Set。Tiny3采用
 */
/* TODO：Tiny3已去除此逻辑，推测Tiny3应该没有此Bug。等IE环境好了后，再测试。
  解决IE浏览器下的复选框半选状态BUG，
  bug单号：http://code.huawei.com/WCC/TinyPlus/issues/1397
  BUG表现：当复选框的状态为半选状态，
           点击复选框的时候IE浏览器会把复选框状态为  checked = false，
           而其他浏览器会直接变成checked = true,
  原因分析参考地址：https://github.com/jquery/jquery/issues/1698
                    http://www.xuebuyuan.com/1322692.html
  解决方案：绑定点击事件，手动更改checked状态，同时更新子复选框选中状态。
 */
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlDaGVja2dyb3VwQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvY2hlY2tncm91cC9UaUNoZWNrZ3JvdXBDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBa0IsTUFBTSxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUV4SCxPQUFPLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxLQUFLLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN2RSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM5RCxxREFBcUQ7QUFDckQ7Ozs7OztHQU1HO0FBV0gsTUFBTSxPQUFPLHFCQUFzQixTQUFRLG9CQUFvQjtJQVYvRDs7UUFvQkk7O1dBRUc7UUFDZ0IsbUJBQWMsR0FBd0MsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFHM0csZ0JBQVcsR0FBa0IsSUFBSSxhQUFhLEVBQUUsQ0FBQyxDQUFDLGVBQWU7UUE4TnpFOztXQUVHO1FBQ0ssOEJBQXlCLEdBQUcsQ0FBQyxJQUFTLEVBQUUsS0FBVSxFQUFFLEtBQWMsRUFBRSxJQUFTLEVBQUUsRUFBRTtZQUNyRixJQUFJLElBQUksS0FBSyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUN2RCxnQkFBZ0I7Z0JBQ2hCLElBQUksS0FBSyxFQUFFO29CQUNQLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsb0JBQW9CLENBQUMsZUFBZSxDQUFDLENBQUM7aUJBQzFFO3FCQUFNO29CQUNILG1GQUFtRjtvQkFDbkYsb0JBQW9CLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFB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bmVudCwgRXZlbnRFbWl0dGVyLCBIb3N0TGlzdGVuZXIsIElucHV0LCBJdGVyYWJsZURpZmZlciwgT3V0cHV0LCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgT2JzZXJ2YWJsZU1hcCwgT2JzZXJ2YWJsZVNldCwgVGlMb2cgfSBmcm9tICcuLi8uLi91dGlscy9VdGlsJztcclxuaW1wb3J0IHsgVGlDaGVja2l0ZW1Db21wb25lbnQgfSBmcm9tICcuL1RpQ2hlY2tpdGVtQ29tcG9uZW50JztcclxuLy8gVE9ETzog5pyJ5Lqb55So5oi35o+Q5Ye677yM5ZON5bqU5byP6KGo5Y2V6YeM77yMY2hlY2tncm91cCB2YWx1Zeayoeaciee7keWumuW3sumAieS4reaVsOaNru+8jOS4jeaWueS+v+OAglxyXG4vKipcclxuICogQ2hlY2tncm91cOWFqOmAieahhue7hOS7tu+8jOS4u+imgeWKn+iDveS4uuS7juS4gOaVsOaNrumbhuWQiOS4remAieaLqeafkOWHoOadoeaVsOaNru+8jOS4juWkmumAiee7hOS7tihTZWxlY3QgbXVsdGlwbGUp5Yqf6IO955u45ZCM77yM5Y+q5piv5pWw5o2u6KeE5qih5ZKM6KeG6KeJ5ZGI546w5LiN5ZCM44CCXHJcbiAqXHJcbiAqIOWkjemAieahhue7hOmAmuW4uOeUseS4gOS4quWFqOmAieahhuWSjOWkmuS4quWtkOWkjemAieahhuaehOaIkOOAglxyXG4gKlxyXG4gKiA8ZXhhbXBsZS11cmw+Li4vdGlueTNkZW1vLyMvY2hlY2tncm91cC9jaGVja2dyb3VwLWFsbDwvZXhhbXBsZS11cmw+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcclxuICAgIHNlbGVjdG9yOiAnW3RpQ2hlY2tncm91cF0nLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuLi9jaGVja2JveC9jaGVja2JveC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuLi9jaGVja2JveC9jaGVja2JveC5sZXNzJ10sXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dXNlLWhvc3QtcHJvcGVydHktZGVjb3JhdG9yXHJcbiAgICBob3N0OiB7XHJcbiAgICAgICAgJ3RpQ2hlY2tib3gnOiAnJyAvLyDnu5nlrr/kuLvlhYPntKDmt7vliqB0aUNoZWNrYm945bGe5oCn77yM5a6e546w5a6a5Yi25qC35byPXHJcbiAgICB9XHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUaUNoZWNrZ3JvdXBDb21wb25lbnQgZXh0ZW5kcyBUaUNoZWNraXRlbUNvbXBvbmVudCB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiYDmnInlrZDpgInpobnmlbDmja5cclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXRlbXM6IEFycmF5PGFueT47XHJcbiAgICAvKipcclxuICAgICAqIOW3sumAieS4reaVsOaNrumbhu+8jOWPjOWQkee7keWumlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjaGVja2VkczogQXJyYXk8YW55PiB8IFNldDxhbnk+O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlt7LpgInkuK3mlbDmja7pm4bvvIzlj4zlkJHnu5HlrppcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpIHJlYWRvbmx5IGNoZWNrZWRzQ2hhbmdlOiBFdmVudEVtaXR0ZXI8U2V0PGFueT4gfCBBcnJheTxhbnk+PiA9IG5ldyBFdmVudEVtaXR0ZXI8U2V0PGFueT4gfCBBcnJheTxhbnk+PigpO1xyXG5cclxuICAgIHByaXZhdGUgY2hlY2tlZE1hcDogT2JzZXJ2YWJsZU1hcDsgLy8g5YKo5a2Y5pys57uE5omA5pyJ5a2Q6YCJ6aG554q25oCB77yaa2V577yaaXRlbe+8jHZhbHVl77yadHJ1ZS9mYWxzZS9udWxsLCDlhajpgIkv5LiN6YCJL+WNiumAiVxyXG4gICAgcHJpdmF0ZSBkaXNhYmxlZFNldDogT2JzZXJ2YWJsZVNldCA9IG5ldyBPYnNlcnZhYmxlU2V0KCk7IC8vIOWCqOWtmOacrOe7hOaJgOacieemgeeUqOeahOWtkOmAiemhuVxyXG5cclxuICAgIHByaXZhdGUgaXRlbXNEaWZmZXI6IEl0ZXJhYmxlRGlmZmVyPGFueT47XHJcbiAgICBwcml2YXRlIGNoZWNrZWRzRGlmZmVyOiBJdGVyYWJsZURpZmZlcjxhbnk+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog55uR5ZCsY2hhbmdl5LqL5Lu277yM5Lya5aSa6Kem5Y+R5LiA5qyhRG9DaGVja+OAglxyXG4gICAgICogQHBhcmFtIGNoZWNrZWQg5Y6f55SfY2hhbmdl5LqL5Lu26YCJ5Lit54q25oCB77ya5YWo6YCJ77yM5YWo5LiN6YCJXHJcbiAgICAgKi9cclxuICAgIEBIb3N0TGlzdGVuZXIoJ2NoYW5nZScsIFsnJGV2ZW50J10pIHB1YmxpYyBvbkhvc3RDaGFuZ2UoY2hlY2tlZDogYW55KTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIub25Ib3N0Q2hhbmdlKGNoZWNrZWQpO1xyXG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZUVsZW1lbnQuY2hlY2tlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAvLyDlhajpgIlcclxuICAgICAgICAgICAgdGhpcy5jaGVja0FsbCh0cnVlKTtcclxuICAgICAgIH0gZWxzZSBpZiAodGhpcy5uYXRpdmVFbGVtZW50LmluZGV0ZXJtaW5hdGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgLy8g5Y2K6YCJ5oOF5Ya177yM5LiN5L2c5aSE55CG44CCXHJcbiAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlhajkuI3pgIlcclxuICAgICAgICAgICAgdGhpcy5jaGVja0FsbChmYWxzZSk7XHJcbiAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIubmdPbkluaXQoKTtcclxuICAgICAgICB0aGlzLmluaXRDaGVja2VkTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbml0R2xvYmVDaGVja2VkTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbml0RGlzYWJsZWRTZXQoKTtcclxuICAgICAgICB0aGlzLnNldENoZWNrZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uRGVzdHJveSgpO1xyXG4gICAgICAgIC8vIOino+mZpOebkeWQrFxyXG4gICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlQ2hlY2tlZE1hcC5yZW1vdmVPYnNlcnZlcih0aGlzLmdsb2JlQ2hlY2tlZE1hcE9ic2VydmVyRm4pO1xyXG4gICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlRGlzYWJsZWRTZXQucmVtb3ZlT2JzZXJ2ZXIodGhpcy5nbG9iZURpc2FibGVkU2V0T2JzZXJ2ZXJGbik7XHJcbiAgICB9XHJcblxyXG4gICAgbmdEb0NoZWNrKCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nRG9DaGVjaygpO1xyXG4gICAgICAgIC8vIOOAkDHjgJFbaXRlbXNdW2NoZWNrZWRzXSDihpIgIGNoZWNrZWRNYXBcclxuICAgICAgICBjb25zdCBpdGVtc0NoYW5nZXM6IGFueSA9IHRoaXMuaXRlbXNEaWZmZXIuZGlmZih0aGlzLml0ZW1zKTtcclxuICAgICAgICBjb25zdCBjaGVja2Vkc0NoYW5nZXM6IGFueSA9IHRoaXMuY2hlY2tlZHNEaWZmZXIuZGlmZih0aGlzLmNoZWNrZWRzKTtcclxuICAgICAgICBpZiAoY2hlY2tlZHNDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIGNoZWNrZWRzQ2hhbmdlcy5mb3JFYWNoQWRkZWRJdGVtKFxyXG4gICAgICAgICAgICAgICAgcmVjb3JkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtOiBhbnkgPSB0aGlzLmdldEl0ZW0ocmVjb3JkLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLml0ZW1zLmluY2x1ZGVzKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZE1hcC5zZXQoaXRlbSwgdHJ1ZSwgdGhpcy5jaGVja2Vkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5q2j5bi45LiN5Lya6LWw5Yiw6L+Z6YeMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZE1hcC5kZWxldGUoaXRlbSwgdGhpcy5jaGVja2Vkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOihqOagvOmcgOaxgu+8muWFgeiuuOeUqOaIt+iuvue9rueahGNoZWNrZWRz77yM6IyD5Zu05aSn5LqOaXRlbXPjgILmiYDku6XkvJrotbDliLDov5nph4xcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGlMb2cud2FybignY2hlY2tlZHMgbmV3IGl0ZW0gaXMgbm90IGluIGl0ZW1zJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjaGVja2Vkc0NoYW5nZXMuZm9yRWFjaFJlbW92ZWRJdGVtKFxyXG4gICAgICAgICAgICAgICAgcmVjb3JkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtOiBhbnkgPSB0aGlzLmdldEl0ZW0ocmVjb3JkLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLml0ZW1zLmluY2x1ZGVzKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrZWRNYXAuZ2V0KGl0ZW0pID09PSB0cnVlIHx8IHRoaXMuY2hlY2tlZE1hcC5nZXQoaXRlbSkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkTWFwLnNldChpdGVtLCBmYWxzZSwgdGhpcy5jaGVja2Vkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRNYXAuZGVsZXRlKGl0ZW0sIHRoaXMuY2hlY2tlZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDlvLrosIPvvJrlpoLmnpzlrZDpgInpobnmmK/ljYrpgInnirbmgIFudWxs77yM5bCx5LiN5YaN572uZmFsc2XkuobjgIJcclxuICAgICAgICAgICAgICAgICAgICAvLyDop4TlvovvvJrniLboioLngrnvvIzkuI3kvJrkuIvovr7orqnlrZDoioLngrnnlLFudWxs5YiwZmFsc2XnmoTmjIfku6TjgILniLboioLngrnvvIzlj6rkvJrkuIvovr7orqnoioLngrnnlLFudWxs5YiwdHJ1ZeeahOaMh+S7pOOAglxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOazqOaEj++8muWcqOagkeWei+e7k+aehOS4re+8jOWklueVjEBJbnB1dCBjaGVja2Vkc+S4jeiDveW8uuWItuaMh+WumuafkOS4quWNiumAieiKgueCue+8jOWPmOS4uuS4jemAieOAgu+8iGNoZWNrZWRz5Lit5Y676Zmk5p+Q5Liq6IqC54K577yM5q2k6IqC54K55L+d5oyB5Y2K6YCJ5LiN5Y+Y44CC77yJXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWwhuavj+asoeeahOWPmOWMlu+8jOWQiOWFpeWIsOWFqOWxgOWPmOmHj+S4reOAguWboOS4uuWkmuWHuuadpeeahOmhueebru+8jOWPr+iDveaYr+WImuaJjeS9v+eUqOi/h+eahO+8jOaJgOS7pemcgOimgemHjeaWsOi1i+WAvFxyXG4gICAgICAgIGlmIChpdGVtc0NoYW5nZXMpIHtcclxuICAgICAgICAgICAgaXRlbXNDaGFuZ2VzLmZvckVhY2hBZGRlZEl0ZW0oXHJcbiAgICAgICAgICAgICAgICByZWNvcmQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIE1hcOS4reayoeacieatpOmhue+8jOS8mui/lOWbnnVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrZWRNYXAuaGFzKHJlY29yZC5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAg5Yid5aeL5YyW5Li65LuA5LmI5Lya6LWw5Yiw6L+Z6YeM77yf5pys5Lul5Li65rKh5pyJ5Luj56CB5Y+v5Lul6LWw5Yiw6L+Z6YeMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOOAkDXjgJFjaGVja2VkTWFw4oaSZ2xvYmVDaGVja2VkTWFwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlQ2hlY2tlZE1hcC5zZXQocmVjb3JkLml0ZW0sIHRoaXMuY2hlY2tlZE1hcC5nZXQocmVjb3JkLml0ZW0pLCB0aGlzLmNoZWNrZWRNYXApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOihqOagvOmcgOaxgu+8mmNoZWNrZWRz5YWB6K646IyD5Zu05q+UaXRlbXPmm7TlpKfjgILmiYDku6XvvIzmoLnmja5jaGVja2Vkc+adpee7mWNoZWNrZWRNYXDorr7nva7jgIJcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlzQ2hlY2tlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUocmVjb3JkLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja2VkcyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSB0aGlzLmNoZWNrZWRzLmluY2x1ZGVzKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrZWRzIGluc3RhbmNlb2YgU2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSB0aGlzLmNoZWNrZWRzLmhhcyh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkTWFwLnNldChyZWNvcmQuaXRlbSwgaXNDaGVja2VkLCB0aGlzLmNoZWNrZWRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlRGlzYWJsZWRTZXQuaGFzKHJlY29yZC5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZFNldC5hZGQocmVjb3JkLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZFNldC5kZWxldGUocmVjb3JkLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpdGVtc0NoYW5nZXMuZm9yRWFjaFJlbW92ZWRJdGVtKFxyXG4gICAgICAgICAgICAgICAgcmVjb3JkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRNYXAuZGVsZXRlKHJlY29yZC5pdGVtLCB0aGlzLmNoZWNrZWRzKTsgLy8gZnJvbeagh+W/l+S7jmNoZWNrZWRz5p2l77yM5omA5Lul6K+N5p2hY2hlY2tlZE1hcOWPmOWMlu+8jOW5tuacquWQjOatpeWIsGNoZWNrZWRz44CCXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rOo5oSP77ya5Lya6YCg5oiQY2hlY2tlZHPojIPlm7TlpKfkuo5pdGVtc1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRTZXQuZGVsZXRlKHJlY29yZC5pdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoZWNrZWRzQ2hhbmdlcyB8fCBpdGVtc0NoYW5nZXMpIHtcclxuICAgICAgICAgICAgLy8g44CQM+OAkWNoZWNrZWRNYXAg4oaSICBHcm91cCBjaGVja2VkXHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZCgpOyAvLyDorr7nva7lhajpgInnirbmgIHjgILmnKzlnLBjaGVja2VkTWFw5Y+Y5YyW77yM5YWD57Sg5b6I5aSa77yM5L2G5Y+q5Yid5aeL5YyW5LiA5qyh44CCXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWPkeWHuuS6i+S7tu+8mmNoZWNrZWRz5pS55Y+YXHJcbiAgICAgICAgaWYgKGNoZWNrZWRzQ2hhbmdlcykge1xyXG4gICAgICAgICAgICAvLyBUT0RP77ya5ZCO6Z2i5Y+v6IO96KaB5YGa77yM5pu05paw5byV55So44CCXHJcbiAgICAgICAgICAgIC8vIOS4gOaXpuabtOaWsOW8leeUqO+8jOWwseW+l+imgeaxguaJgOacieeUqOaIt+WPjOWQkee7keWumlsoY2hlY2tlZHMpXeOAguS9huaXp+eJiGRlbW/ph4zmmK/ljZXlkJHnu5HlrprvvIzlr7nkuIDkupvpgZfnlZnnlKjmiLfkuI3lj4vlpb3jgIJcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25kaXRpb25hbC1leHByZXNzaW9uXHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLmNoZWNrZWRzIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuY2hlY2tlZHMgPSB0aGlzLmNoZWNrZWRzLmNvbmNhdChbXSk7IC8vIOabtOaWsOW8leeUqFxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5jaGVja2VkcyA9IG5ldyBTZXQoQXJyYXkuZnJvbSh0aGlzLmNoZWNrZWRzKSk7IC8vIOabtOaWsOW8leeUqFxyXG4gICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogY2hlY2tlZHNDaGFuZ2Ug5Zue6LCD5Lit5ZCM5q2l5L+u5pS55YW25LuW5pWw5o2u5Lya5oql6ZSZ77yM5b2x5ZON5q2j5bi45Yqf6IO977yM5omA5Lul6ZyA6KaB5bu25pe277yMXHJcbiAgICAgICAgICAgICAqIOS4uuS7gOS5iOS4jeS9v+eUqHNldFRpbW91dOiAjOS9v+eUqFByb21pc2XvvIxQcm9taXNlLnRoZW4g5piv5b6u5Lu75Yqh77yM5q+Uc2V0VGltb3V0KOWuj+S7u+WKoSnlhYjmiafooYzvvIzmg7PlsL3ph4/ml6llbWl05LqL5Lu2XHJcbiAgICAgICAgICAgICAqIOWuj+S7u+WKoeWSjOW+ruS7u+WKoe+8mmh0dHBzOi8vanVlamluLmNuL3Bvc3QvNjg0NDkwMzY1NzI2NDEzNjIwMFxyXG4gICAgICAgICAgICAgKiBpc3N1ZTogaHR0cHM6Ly9naXQuaHVhd2VpLmNvbS9XQ0MvVGlueTMvaXNzdWVzLzE1ODhcclxuICAgICAgICAgICAgICog5omp5bGV77yabmdEb0NoZWNrLG5nQWZ0ZXJWaWV3Q2hlY2tlZOS4rWVtaXTkuovku7bvvIzlnKjkuovku7blm57osIPkuK3lkIzmraXkv67mlLnmlbDmja7vvIzpg73lrZjlnKjlkIzmoLfpl67popjjgIJcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShudWxsKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZHNDaGFuZ2UuZW1pdCh0aGlzLmNoZWNrZWRzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBpbml0Q2hlY2tlZE1hcCgpOiB2b2lkIHtcclxuICAgICAgICAvLyDnm5HlkKxpdGVtc+WSjGNoZWNrZWRzXHJcbiAgICAgICAgdGhpcy5pdGVtc0RpZmZlciA9IHRoaXMuaXRlcmFibGVEaWZmZXJzLmZpbmQodGhpcy5pdGVtcykuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHRoaXMuY2hlY2tlZHNEaWZmZXIgPSB0aGlzLml0ZXJhYmxlRGlmZmVycy5maW5kKHRoaXMuY2hlY2tlZHMpLmNyZWF0ZShudWxsKTtcclxuICAgICAgICB0aGlzLmNoZWNrZWRNYXAgPSBuZXcgT2JzZXJ2YWJsZU1hcCgpO1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCgvLyDjgJAx44CRW2l0ZW1zXVtjaGVja2Vkc10g4oaSICBjaGVja2VkTWFwXHJcbiAgICAgICAgICAgIGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGlzQ2hlY2tlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWU6IGFueSA9IHRoaXMuZ2V0VmFsdWUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja2VkcyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNDaGVja2VkID0gdGhpcy5jaGVja2Vkcy5pbmNsdWRlcyh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2hlY2tlZHMgaW5zdGFuY2VvZiBTZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSB0aGlzLmNoZWNrZWRzLmhhcyh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNDaGVja2VkKSB7IC8vIOmAieS4reaAge+8jOebtOaOpea3u+WKoFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZE1hcC5zZXQoaXRlbSwgdHJ1ZSwgdGhpcy5jaGVja2Vkcyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2hlY2tlZE1hcC5nZXQoaXRlbSkgPT09IHRydWUgfHwgdGhpcy5jaGVja2VkTWFwLmdldChpdGVtKSA9PT0gdW5kZWZpbmVkKSB7IC8vIOWIneWni+WMllxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZE1hcC5zZXQoaXRlbSwgZmFsc2UsIHRoaXMuY2hlY2tlZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOW8uuiwg++8muWmguaenOWtkOmAiemhueaYr+WNiumAieeKtuaAgW51bGzvvIzlsLHkuI3lho3nva5mYWxzZeS6huOAglxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOinhOW+i++8mueItuiKgueCue+8jOS4jeS8muS4i+i+vuiuqeWtkOiKgueCueeUsW51bGzliLBmYWxzZeeahOaMh+S7pOOAgueItuiKgueCue+8jOWPquS8muS4i+i+vuiuqeiKgueCueeUsW51bGzliLB0cnVl55qE5oyH5Luk44CCXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rOo5oSP77ya5Zyo5qCR5Z6L57uT5p6E5Lit77yM5aSW55WMQElucHV0IGNoZWNrZWRz5LiN6IO95by65Yi25oyH5a6a5p+Q5Liq5Y2K6YCJ6IqC54K577yM5Y+Y5Li65LiN6YCJ44CC77yIY2hlY2tlZHPkuK3ljrvpmaTmn5DkuKroioLngrnvvIzmraToioLngrnkv53mjIHljYrpgInkuI3lj5jjgILvvIlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tlZE1hcC5hZGRPYnNlcnZlcihcclxuICAgICAgICAgICAgKGl0ZW06IGFueSwgdmFsdWU6IGFueSwgaXNBZGQ6IGJvb2xlYW4sIGZyb206IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g5pyJ5aSa5Liq5p2l5rqQ77yaY2hla2NlZHPvvIzvvIhpdGVtc++8ie+8jGNoZWNrYWxs77yMZ2xvYmVcclxuICAgICAgICAgICAgICAgIC8vIOS4jeaYr+S7jmNoZWNrZWRz5p2l55qE77yM5bCx6KaB5ZCM5q2l5YiwY2hla2Vkc1xyXG4gICAgICAgICAgICAgICAgaWYgKGZyb20gIT09IHRoaXMuY2hlY2tlZHMgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g44CQMuOAkWNoZWNrZWRNYXAtID5bY2hlY2tlZHNdXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDaGVja2VkOiBib29sZWFuID0gaXNBZGQgJiYgdGhpcy5jaGVja2VkTWFwLmdldChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdJdGVtOiBhbnkgPSB0aGlzLmdldFZhbHVlKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrZWRzIGluc3RhbmNlb2YgU2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA/IHRoaXMuY2hlY2tlZHMuYWRkKG5ld0l0ZW0pIDogdGhpcy5jaGVja2Vkcy5kZWxldGUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrZWRzIGluc3RhbmNlb2YgQXJyYXkpIHsgLy8gVE9ETzrlhpnlhaznlKjnmoRBcnJheSByZW1vdmXlh73mlbBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IHRoaXMuY2hlY2tlZHMuaW5kZXhPZihuZXdJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2hlY2tlZCAmJiBpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZHMucHVzaChuZXdJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNDaGVja2VkICYmIGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2Vkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5LiN5piv5LuO5YWo5bGA5p2l55qE77yM5bCx6KaB5ZCM5q2l5Yiw5YWo55CD44CCXHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbSAhPT0gVGlDaGVja2l0ZW1Db21wb25lbnQuZ2xvYmVDaGVja2VkTWFwKSAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOOAkDXjgJFjaGVja2VkTWFw4oaSZ2xvYmVDaGVja2VkTWFwXHJcbiAgICAgICAgICAgICAgICAgICAgVGlDaGVja2l0ZW1Db21wb25lbnQuZ2xvYmVDaGVja2VkTWFwLnNldChpdGVtLCB2YWx1ZSwgdGhpcy5jaGVja2VkTWFwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOS7juWFqOWxgOadpeeahO+8jOmcgOimgeabtOaWsOWFqOmAieeKtuaAgeOAgu+8iOagkeW9oue7k+aehOWxgue6p+i+g+Wkmu+8jOmcgOimgei/meS4qumAu+i+ke+8iVxyXG4gICAgICAgICAgICAgICAgaWYgKGZyb20gPT09IFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlQ2hlY2tlZE1hcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOOAkDPjgJFjaGVja2VkTWFwIOKGkiAgR3JvdXAgY2hlY2tlZFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgaW5pdEdsb2JlQ2hlY2tlZE1hcCgpOiB2b2lkIHtcclxuICAgICAgICAvLyBjaGVja2VkTWFw5LulZ3JvdXDnq6/kvJjlhYjvvIxkaXNhYmxlZOS7pWl0ZW3nq6/kvJjlhYjjgIJcclxuICAgICAgICAvLyBjaGVja2VkTWFw5ZCM5q2l5Yqg5YWl5YiwZ2xvYmVDaGVja2VkTWFwXHJcbiAgICAgICAgdGhpcy5jaGVja2VkTWFwLmdldE1hcCgpXHJcbiAgICAgICAgLmZvckVhY2goXHJcbiAgICAgICAgICAgIGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g44CQNeOAkWNoZWNrZWRNYXDihpJnbG9iZUNoZWNrZWRNYXBcclxuICAgICAgICAgICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlQ2hlY2tlZE1hcC5zZXQoaXRlbVswXSwgaXRlbVsxXSwgdGhpcy5jaGVja2VkTWFwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgLy8g55uR5ZCsZ2xvYmVjaGVja2VkTWFwXHJcbiAgICAgICAgVGlDaGVja2l0ZW1Db21wb25lbnQuZ2xvYmVDaGVja2VkTWFwLmFkZE9ic2VydmVyKHRoaXMuZ2xvYmVDaGVja2VkTWFwT2JzZXJ2ZXJGbik7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGluaXREaXNhYmxlZFNldCgpOiB2b2lkIHtcclxuICAgICAgICAvLyDjgJA344CRZ2xvYmVEaXNhYmxlZFNldOKGkmRpc2FibGVkU2V077yM5bm255uR5ZCsXHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKFxyXG4gICAgICAgICAgICBpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlRGlzYWJsZWRTZXQuaGFzKGl0ZW0pID9cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkU2V0LmFkZChpdGVtKSA6IHRoaXMuZGlzYWJsZWRTZXQuZGVsZXRlKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICAvLyDjgJA344CRZ2xvYmVEaXNhYmxlZFNldOKGkmRpc2FibGVkU2V077yM55uR5ZCsZ2xvYmVEaXNhYmxlZFNldFxyXG4gICAgICAgIFRpQ2hlY2tpdGVtQ29tcG9uZW50Lmdsb2JlRGlzYWJsZWRTZXQuYWRkT2JzZXJ2ZXIodGhpcy5nbG9iZURpc2FibGVkU2V0T2JzZXJ2ZXJGbik7XHJcbiAgICAgICAgLy8g44CQOOOAkWRpc2FibGVkU2V04oaSR3JvdXAgY2hlY2tlZFxyXG4gICAgICAgIHRoaXMuZGlzYWJsZWRTZXQuYWRkT2JzZXJ2ZXIoXHJcbiAgICAgICAgICAgIChpdGVtOiBhbnksIGlzQWRkOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldENoZWNrZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOOAkDbjgJFnbG9iZUNoZWNrZWRNYXDihpJjaGVja2VkTWFwXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2xvYmVDaGVja2VkTWFwT2JzZXJ2ZXJGbiA9IChpdGVtOiBhbnksIHZhbHVlOiBhbnksIGlzQWRkOiBib29sZWFuLCBmcm9tOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoZnJvbSAhPT0gdGhpcy5jaGVja2VkTWFwICYmIHRoaXMuaXRlbXMuaW5jbHVkZXMoaXRlbSkpIHtcclxuICAgICAgICAgICAgLy8g5ZCM5q2lZ2xvYmXnmoTmlLnlj5jliLDmnKzlnLBcclxuICAgICAgICAgICAgaWYgKGlzQWRkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRNYXAuc2V0KGl0ZW0sIHZhbHVlLCBUaUNoZWNraXRlbUNvbXBvbmVudC5nbG9iZUNoZWNrZWRNYXApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gIWlzQWRkLiDlpoLmnpxnbG9iZeWIoOmZpOS6huafkOmhue+8jOS9hui/memhueWxnuS6juiHquW3seeahOWtkOmhue+8jOmCo+S5iOaKiui/meS4gOmhuea3u+WKoOWbnmdsb2Jl44CC77yI5Zy65pmv77ya5a2Q6aG5aXRlbeWKqOaAgeaUueWPmO+8jOW5tuacqumUgOavge+8jOWNtOinpuWPkeS6huWFqOWxgGRlbGV0Ze+8iVxyXG4gICAgICAgICAgICAgICAgVGlDaGVja2l0ZW1Db21wb25lbnQuZ2xvYmVDaGVja2VkTWFwLnNldChpdGVtLCB0aGlzLmNoZWNrZWRNYXAuZ2V0KGl0ZW0pLCB0aGlzLmNoZWNrZWRNYXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDjgJA344CRZ2xvYmVEaXNhYmxlZFNldOKGkmRpc2FibGVkU2V0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2xvYmVEaXNhYmxlZFNldE9ic2VydmVyRm4gPSAoaXRlbTogYW55LCBpc0FkZDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIGlmIChpc0FkZCAmJiB0aGlzLml0ZW1zLmluY2x1ZGVzKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRTZXQuYWRkKGl0ZW0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIWlzQWRkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRTZXQuZGVsZXRlKGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5pysZ3JvdXDlhajpgInmoYbnmoTnirbmgIEg44CQM+OAkWNoZWNrZWRNYXAg4oaSICBHcm91cCBjaGVja2VkXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2V0Q2hlY2tlZCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNoZWNrZWQodGhpcy5nZXRDaGVja2VkU3RhdHVzKCkpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDop4TliJnkuIDvvJpkaXNhYmxlZOeKtuaAgeeahOWkjemAieahhuS4jeW9seWTjeWFqOmAieeKtuaAge+8jOaJgOS7pemcgOimgeWwhuWFtuS7jue7n+iuoeS/oeaBr+S4rei/h+a7pFxyXG4gICAgICog5L6L5aaC5pyJM+S4quWkjemAieahhu+8jOWJjeS4pOS4quS4uumAieS4reeKtuaAge+8jOacgOWQjuS4gOS4quaYr2Rpc2FibGVk77yM5YiZ6K6k5Li65pW05L2T5Li65YWo6YOo6YCJ5Lit54q25oCBXHJcbiAgICAgKiDmiYDku6Xml6DpnIDlhbPlv4NkaXNhYmxlZOWkjemAieahhueahOmAieS4reeKtuaAge+8jOWPqumcgOWFs+W/g+mdnmRpc2FibGVk54q25oCB5Y2z5Y+vXHJcbiAgICAgKiDop4TliJnkuozvvJrkvYblvZPlrZDlpI3pgInmoYblhajpg6jmmK9kaXNhYmxlZOeKtuaAgeaXtu+8jOWwhuS8muW9seWTjeWFqOmAieeahOeKtuaAgVxyXG4gICAgICogQHJldHVybnMg5YWo6YCJ77yadHJ1Ze+8jOWFqOS4jemAie+8mmZhbHNl77yM5Y2K6YCJ77yabnVsbFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldENoZWNrZWRTdGF0dXMoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID09PSAwKSB7Ly8g5oOF5pmv6Zu277ya5rKh5pyJ6YCJ6aG5XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g55So5oi35Y+v5Yu+6YCJ6aG555uu5pWwXHJcbiAgICAgICAgbGV0IGNoZWNrZWRhYmxlTnVtID0gdGhpcy5pdGVtcy5sZW5ndGggLSB0aGlzLmRpc2FibGVkU2V0LnNpemU7XHJcbiAgICAgICAgY29uc3QgaXNUb3RhbENvdW50ID0gKHRoaXMuZGlzYWJsZWRTZXQuc2l6ZSA9PT0gMCB8fCBjaGVja2VkYWJsZU51bSA9PT0gMCk7IC8vIOWFqOmDqOWPr+eUqO+8jOaIluiAheWFqOmDqOemgeeUqOOAguaJgOaciemAiemhuei/m+WFpee7n+iuoeOAglxyXG4gICAgICAgIGlmIChjaGVja2VkYWJsZU51bSA9PT0gMCkgeyAvLyDlpoLmnpzlhajpg6jnpoHnlKjvvIzpgqPkuYjmiYDmnInpgInpobnpg73orqHlhaXnu5/orqHjgIJcclxuICAgICAgICAgICAgY2hlY2tlZGFibGVOdW0gPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNoZWNrZWROdW0gPSAwOyAvLyDpgInkuK3pobnmlbDnm67vvIjpnZ7npoHnlKjvvIlcclxuICAgICAgICBsZXQgbm90Q2hlY2tlZE51bSA9IDA7IC8vIOacqumAiemhueaVsOebru+8iOmdnuemgeeUqO+8iVxyXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLml0ZW1zKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1RvdGFsQ291bnQgfHwgIXRoaXMuZGlzYWJsZWRTZXQuaGFzKGl0ZW0pKSB7IC8vIOWFqOmDqOi/m+WFpee7n+iuoe+8jOaIluiAheacquemgeeUqOmhuei/m+WFpee7n+iuoeOAglxyXG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLmNoZWNrZWRNYXAuZ2V0KGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cnVlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkTnVtKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZmFsc2U6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdENoZWNrZWROdW0rKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBudWxsOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8g5Y+q6KaB5pyJ5LiA5Liq5a2Q6YCJ6aG55piv5Y2K6YCJ77yM6YKj5LmI57uT5p6c5piv5Y2K6YCJ44CCXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5LiN5Lya6LWw5Yiw6L+Z6YeMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFRpTG9nLmVycm9yKCdnZXRDaGVja2VkU3RhdHVzKCksY2FuIG5vdCByZWFjaCBjb2RlLCBpdGVtcyBpdGVtIGlzIG5vdCBpbiBjaGVja2VkTWFwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrZWROdW0gIT09IDAgJiYgbm90Q2hlY2tlZE51bSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaciemAieS4re+8jOacieS4jemAieS4re+8jOaJgOS7peWNiumAieOAglxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyDljYrpgIlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hlY2tlZE51bSA9PT0gY2hlY2tlZGFibGVOdW0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90Q2hlY2tlZE51bSA9PT0gY2hlY2tlZGFibGVOdW0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTG9nZ2VyLmVycm9yKCdnZXRDaGVja2VkU3RhdHVzKCksZW5kLCBjYW4gbm90IHJlYWNoIGNvZGUsJyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiAg6K6+572u5YWo6YCJ5qGG55qE54q25oCB5YC8XHJcbiAgICAgKiDjgJA044CRR3JvdXAgY2hlY2tlZCDihpIgIGNoZWNrZWRNYXBcclxuICAgICAqIEBwYXJhbSBjaGVja2VkXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2hlY2tBbGwoY2hlY2tlZDogYm9vbGVhbik6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goXHJcbiAgICAgICAgICAgIGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkU2V0LmhhcyhpdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDjgJA044CRR3JvdXAgY2hlY2tlZCDihpIgIGNoZWNrZWRNYXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkTWFwLnNldChpdGVtLCBjaGVja2VkLCB0aGlzLmNoZWNrQWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOi+k+WHuu+8muW+l+WIsOaVtOS4qml0ZW3lr7nosaFcclxuICAgICAqIEBwYXJhbSB2YWx1ZSBpdGVt5a+56LGh5oiW6ICF5pWw5o2u55qE6Lqr5Lu95qCH6K+GXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldEl0ZW0odmFsdWU6IGFueSk6IGFueSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBvYmogb2YgdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICBpZiAob2JqID09PSB2YWx1ZSB8fCBvYmpbdGhpcy52YWx1ZUtleV0gPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG4vKlxyXG7pnIDmsYLvvJpHcm91cCBjaGVja2Vk77yMSXRlbSBjaGVja2Vk77yMWyhjaGVja2VkU2V0KV3kuInogIXlhbbkuIDmlLnlj5jvvIzpg73opoHpgJrnn6Xlhbbku5bkuozogIXjgILmiYDku6Xph4fnlKjkuK3ku4vogIXmqKHlvI/jgIJcclxuXHJcbueJiOacrOS4gO+8mlRpbnkyLOS4reS7i+iAheaYr1soY2hlY2tlZFNldCld77yM5L2G6KaB5rGCSXRlbeS5n+WOu+e7keWumlsoZ3JvdXBDaGVja2VkU2V0KV1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyb3VwIGNoZWNrZWQgICAg4oaQICBkaXNhYmxlZFNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaVICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG5bZGF0YUFycmF5XSAgICAgICAgIFtjaGVja2VkU2V0XSAgICAgICAgICAgIGdyb3VwRGlzYWJsZWRTZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGlSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW0gY2hlY2tlZCAgICAgICAgICAgICBJdGVtIGRpc2FibGVkXHJcblxyXG7niYjmnKzkuozvvJrkuK3ku4vogIXmmK/lhajlsYDlj5jph49nbG9iZUNoZWNrZWRTZXTvvIzkuI3opoHmsYJJdGVt57uR5a6a5YW25LuW5Y+Y6YeP44CCXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIEdyb3VwIGNoZWNrZWQgICDihpAgICBkaXNhYmxlZFNldFxyXG5bZGF0YUFycmF5XSAgICAgICAgICAgICAgICAgICDihpUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpFcclxuWyhjaGVja2VkU2V0KV3ihpRnbG9iZUNoZWNrZWRTZXQgICAgIGdsb2JlRGlzYWJsZWRTZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGlSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSXRlbSBjaGVja2VkICAgICAgICAgICBJdGVtIGRpc2FibGVkXHJcblxyXG7niYjmnKzkuInvvJrpk77mnaHkvKDpgJLvvIzkuI3opoHmsYJJdGVt57uR5a6a5YW25LuW5Y+Y6YeP44CCXHJcblxyXG4gICAgICAgICAgICAgICAgICAgR3JvdXAgY2hlY2tlZCAgICAgICDihpAgICAgIGRpc2FibGVkU2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG5bZGF0YUFycmF5XSBbY2hlY2tlZFNldF0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaRXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gICAgICAgICAgICAgICAgICAgZ2xvYmVDaGVja2VkU2V0ICAgICAgICAgICAgZ2xvYmVEaXNhYmxlZFNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaVICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpFcclxuICAgICAgICAgICAgICAgICAgICBJdGVtIGNoZWNrZWQgICAgICAgICAgICAgICAgICBJdGVtIGRpc2FibGVkXHJcblxyXG7niYjmnKzlm5vvvJpUaW55Mywg6ZO+5p2h5Lyg6YCS77yM5LiN6KaB5rGCSXRlbee7keWumuWFtuS7luWPmOmHj+OAguS9huS5n+WPr+S7pee7keWumuaJgOWxnuS6jue7hOe7h+mAieS4reWPmOmHj+OAgkFycmF5L1NldOWFvOWuuVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JvdXAgY2hlY2tlZCAgICAgICDihpAgICAgIGRpc2FibGVkU2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaVICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gICAgICAgICAgICBbY2hlY2tlZHNdIOKGlCAgY2hlY2tlZFNldCAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaRXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JlQ2hlY2tlZFNldCAgICAgICAgICAgIGdsb2JlRGlzYWJsZWRTZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaVICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJdGVtIGNoZWNrZWQgICAgICAgICAgICAgICAgICAgSXRlbSBkaXNhYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpVcclxuICAgICAgICAgW2JlQ2hlY2tlZHNdIOKGlCBiZUNoZWNrZWRTZXRcclxu54mI5pys5LqU77yaVGlueTMsIOmTvuadoeS8oOmAku+8jOS4jeimgeaxgkl0ZW3nu5Hlrprlhbbku5blj5jph4/jgILkvYbkuZ/lj6/ku6Xnu5HlrprmiYDlsZ7kuo7nu4Tnu4fpgInkuK3lj5jph4/jgIJBcnJheS9TZXTlhbzlrrnjgIJcclxu5YW85a65VHJlZeagkeW9oue7k+aehO+8jOWtkOiKgueCueS5n+acieWPr+iDveaYr+WNiumAieeKtuaAgeOAglxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JvdXAgY2hlY2tlZCAgICAgICDihpAgICAgIGRpc2FibGVkU2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMT4gICAgICAgICAz4oaR4oaTNCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gW2l0ZW1zXVtjaGVja2Vkc10g4oaUICBjaGVja2VkTWFwICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaRXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8MiAgICAgICAgICA14oaT4oaRNiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpE3XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JlQ2hlY2tlZE1hcCAgICAgICAgICBnbG9iZURpc2FibGVkU2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4oaT4oaRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKGkVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJdGVtIGNoZWNrZWQgICAgICAgICAgICAgICAgICAgIEl0ZW0gZGlzYWJsZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDihpPihpFcclxuICAgICAgICAgW2JlQ2hlY2tlZHNdIOKGlCBiZUNoZWNrZWRTZXRcclxuKi9cclxuLypcclxuQElucHV05pSv5oyBU2V0PGFueT58QXJyYXk8YW55PlxyXG7mlrnmoYjkuIDvvJrmr4/mrKHkvb/nlKjml7bvvIzpg73liKTmlq3nsbvlnovvvIzosIPnlKjkuI3lkIzmlrnms5XjgIJcclxu5pa55qGI5LqM77yaQElucHV0IHNldOaXtu+8jOe7mUFycmF557uR5a6a5LiKaGFzKCnjgIFhZGQoKeOAgWRlbGV0ZSgp5pa55rOV77yM5L2G5pivZ2V0IHNpemXmgI7kuYjnu5HlrprvvJ9cclxu5pa55qGI5LiJ77yaU2V0PGFueT58QXJyYXnvvIzotYvlgLznu5nmlrDnmoRTZXTjgIJUaW55M+mHh+eUqFxyXG4gKi9cclxuICAgICAgICAgICAgLyogVE9ET++8mlRpbnkz5bey5Y676Zmk5q2k6YC76L6R77yM5o6o5rWLVGlueTPlupTor6XmsqHmnInmraRCdWfjgILnrYlJReeOr+Wig+WlveS6huWQju+8jOWGjea1i+ivleOAglxyXG4gICAgICAgICAgICAgIOino+WGs0lF5rWP6KeI5Zmo5LiL55qE5aSN6YCJ5qGG5Y2K6YCJ54q25oCBQlVH77yMXHJcbiAgICAgICAgICAgICAgYnVn5Y2V5Y+377yaaHR0cDovL2NvZGUuaHVhd2VpLmNvbS9XQ0MvVGlueVBsdXMvaXNzdWVzLzEzOTdcclxuICAgICAgICAgICAgICBCVUfooajnjrDvvJrlvZPlpI3pgInmoYbnmoTnirbmgIHkuLrljYrpgInnirbmgIHvvIxcclxuICAgICAgICAgICAgICAgICAgICAgICDngrnlh7vlpI3pgInmoYbnmoTml7blgJlJRea1j+iniOWZqOS8muaKiuWkjemAieahhueKtuaAgeS4uiAgY2hlY2tlZCA9IGZhbHNl77yMXHJcbiAgICAgICAgICAgICAgICAgICAgICAg6ICM5YW25LuW5rWP6KeI5Zmo5Lya55u05o6l5Y+Y5oiQY2hlY2tlZCA9IHRydWUsXHJcbiAgICAgICAgICAgICAg5Y6f5Zug5YiG5p6Q5Y+C6ICD5Zyw5Z2A77yaaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvaXNzdWVzLzE2OThcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwOi8vd3d3Lnh1ZWJ1eXVhbi5jb20vMTMyMjY5Mi5odG1sXHJcbiAgICAgICAgICAgICAg6Kej5Yaz5pa55qGI77ya57uR5a6a54K55Ye75LqL5Lu277yM5omL5Yqo5pu05pS5Y2hlY2tlZOeKtuaAge+8jOWQjOaXtuabtOaWsOWtkOWkjemAieahhumAieS4reeKtuaAgeOAglxyXG4gICAgICAgICAgICAgKi9cclxuIl19