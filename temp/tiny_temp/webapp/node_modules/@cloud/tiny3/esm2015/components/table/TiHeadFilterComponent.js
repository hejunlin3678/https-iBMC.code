import { Component, ElementRef, Input, ViewChild } from '@angular/core';
import { TiSelectComponent } from '../select/TiSelectModule';
import { TiHeadFilterDropComponent } from './TiHeadFilterDropComponent';
import { TiFormComponent } from '../base/TiBaseModule';
import { TiBrowser } from '../../utils/Util';
// 下面注释，可以避免编译lib时正则报错。原理未知，副作用未知。
// @dynamic
/**
 * TiHeadFilter 表头过滤(漏斗)组件， 嵌在表头的 th 中使用。
 *
 * ti-head-filter 用来显示过滤操作漏斗图标，点击其可打开下拉框，选中下拉框中的选项时，
 * 可在提供的 select 事件中做对应的表格数据过滤处理。
 *
 * ### 接口说明
 * **Inputs：**
 *
 * |     名称    |  类型   | 默认值   | 功能描述  |
 * | --------   | :-----   | :---- | :---- |
 * | options   | array  | [] | 所有过滤项 |
 * | ngModel   | object  | false | 可设置和获取 headfilter下拉选中值 |
 * | labelKey   |  string  | 'label' | 下拉面板中要显示的字段, 10.0.2版本新增 |
 * | panelMaxHeight   |  string  | 最大显示8条数据 | 下下拉面板的最大显示高度，溢出时则出滚动条。 |
 * | id   | string  | undefined | HTML属性id，自动化测试要求必须给id赋值 |
 * | select   | function  | 无 | 下拉面板选中事件，向外通知选中数据 |
 * | multiple   |  boolean  | false | 下拉面板是否为多选 |
 * | selectAll   |  boolean  | false | 下拉面板是否显示全选框 |
 * | panelAlign   |  string  | 'left' | 下拉面板展开对齐方式，9.0.4版本新增 |
 * | searchable   |  boolean  | false | 是否开启搜索功能，10.0.2版本新增 |
 * | panelWidth   |  'auto' 或 string  | 'auto' | 设置下拉面板的宽度，"auto"表示下拉框的宽度根据下拉选项的内容自动撑开，也可设置固定的下拉框宽度(不小于过滤图标的宽度)，例如："200px", 10.0.2版本新增 |
 * | noDataText   |  string  | '...' | 无数据时的显示文本。10.0.3版本新增 |
 *
 * <p><span style="color: red">以下说明不可用，不做参考。</span>该组件只有以上5个Input接口和1个Output接口
 * 可用，其余方法、Input、输出等(继承于TiSelectComponent,是供select的内部使用的)都不可用</p>
 */
export class TiHeadFilterComponent extends TiSelectComponent {
    constructor() {
        super(...arguments);
        /**
         * 面板对齐方式
         *
         * 9.0.4新增
         */
        this.panelAlign = 'left';
        // 由于headfilter与select中的panelWidth的默认值和类型不一样，所以这里重定义panelWidth接口
        /**
         * 下拉面板的最大显示宽度，该变量与下拉类组件保持一致
         *
         * 1."auto": 下拉框的宽度根据下拉选项的内容自动撑开；
         *
         * 2.表示宽度的字符串: 设置固定的下拉框宽度(不小于Select组件的宽度)。例如："200px"
         *
         * 10.0.2版本新增，默认为'auto'，10.1.2起<b>搜索场景下</b>默认值修改为“180px”，
         */
        // 置为undefined是为了覆盖父类的panelWidth值
        this.panelWidth = undefined;
    }
    ngAfterViewChecked() {
        // 这里不能调用父类方法，因为Select父类对dominator处理，空指针报错。
        // TODO: 看是否能够不继承select
        if (this.searchable !== this.oldSearchable) {
            this.oldSearchable = this.searchable;
            if (this.searchable) {
                this.setFocusableElems([this.filterIconEleRef.nativeElement]
                    .concat(this.dropsearchCom.getFocusableElems()));
            }
            else {
                this.setFocusableElems([this.filterIconEleRef.nativeElement]);
            }
        }
    }
    /**
     * @ignore
     * 失焦情况下，仅关闭面板，不做聚焦等处理
     */
    onBlur() {
        super.onBlur();
        if (TiBrowser.isIE() && this.searchable) {
            if (getComputedStyle(this.filterIconEleRef.nativeElement).outlineStyle === 'none') {
                this.renderer.setStyle(this.filterIconEleRef.nativeElement, 'outlineStyle', '');
            }
        }
    }
}
TiHeadFilterComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-head-filter',
                template: "<a #filterIcon\r\n     href=\"javascript:void(0)\"\r\n     oncontextmenu=\"return false\"\r\n     class=\"ti3-icon ti3-icon-filter ti3-head-filter-icon\"\r\n     (click)=\"onClickDominator()\"\r\n     (keydown)=\"onKeydown($event)\"\r\n     [id]=\"appendId('head-filter')\">\r\n</a>\r\n<ti-head-filter-drop [dominatorElem]=\"filterIconEleRef.nativeElement\"\r\n                     [(ngModel)]=\"model\"\r\n                     [panelWidth]=\"panelWidth?panelWidth:searchable?'180px':'auto'\"\r\n                     [panelAlign]='panelAlign'\r\n                     [searchable]=\"searchable\"\r\n                     [options]=\"options\"\r\n                     [multiple]=\"multiple\"\r\n                     [selectAll]=\"selectAll\"\r\n                     [panelMaxHeight]=\"panelMaxHeight\"\r\n                     [labelKey]=\"labelKey\"\r\n                     [noDataText]=\"noDataText\"\r\n                     (select)=\"onSelect($event)\"\r\n                     [id]=\"appendId('headfilter_drop')\"></ti-head-filter-drop>",
                providers: [TiFormComponent.getValueAccessor(TiHeadFilterComponent)],
                host: {
                    '[class.ti3-head-filter-container]': 'true',
                    '(blur)': 'onBlur()'
                },
                styles: [":host.ti3-head-filter-container{display:inline-block;line-height:16px;padding-left:5px;vertical-align:middle;width:16px}:host.ti3-head-filter-container .ti3-head-filter-icon{color:var(--ti-table-details-icon-color);cursor:pointer;font-size:16px;text-decoration:none}:host.ti3-head-filter-container .ti3-head-filter-icon:hover{color:var(--ti-table-details-icon-color-hover)}:host.ti3-head-filter-container.ti3-head-filtered .ti3-head-filter-icon{color:var(--ti-head-filter-filtered-color)}"]
            },] }
];
TiHeadFilterComponent.propDecorators = {
    panelAlign: [{ type: Input }],
    panelWidth: [{ type: Input }],
    filterIconEleRef: [{ type: ViewChild, args: ['filterIcon', { static: true },] }],
    dropsearchCom: [{ type: ViewChild, args: [TiHeadFilterDropComponent, { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlIZWFkRmlsdGVyQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvdGFibGUvVGlIZWFkRmlsdGVyQ29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQ1QsVUFBVSxFQUNWLEtBQUssRUFDTCxTQUFTLEVBQ1osTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDN0QsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDeEUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUU3QyxrQ0FBa0M7QUFDbEMsV0FBVztBQUNYOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQTBCRztBQVdILE1BQU0sT0FBTyxxQkFBc0IsU0FBUSxpQkFBaUI7SUFWNUQ7O1FBV0k7Ozs7V0FJRztRQUNNLGVBQVUsR0FBcUIsTUFBTSxDQUFDO1FBQy9DLGdFQUFnRTtRQUNoRTs7Ozs7Ozs7V0FRRztRQUNILGlDQUFpQztRQUN4QixlQUFVLEdBQW1CLFNBQVMsQ0FBQztJQW9DcEQsQ0FBQztJQTFCRyxrQkFBa0I7UUFDZCwyQ0FBMkM7UUFDM0MsdUJBQXVCO1FBQ3ZCLElBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ3hDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztZQUNyQyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7Z0JBQ2pCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUM7cUJBQ3ZELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQ3hEO2lCQUFNO2dCQUNILElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO2FBQ2pFO1NBQ0o7SUFDTCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTTtRQUNULEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNmLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDckMsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLENBQUMsWUFBWSxLQUFLLE1BQU0sRUFBRTtnQkFDL0UsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsRUFBRSxjQUFjLEVBQUUsRUFBRSxDQUFDLENBQUM7YUFDbkY7U0FDSjtJQUNMLENBQUM7OztZQS9ESixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLGdCQUFnQjtnQkFDMUIsd2hDQUFpQztnQkFFakMsU0FBUyxFQUFFLENBQUMsZUFBZSxDQUFDLGdCQUFnQixDQUFDLHFCQUFxQixDQUFDLENBQUM7Z0JBQ3BFLElBQUksRUFBRTtvQkFDRixtQ0FBbUMsRUFBRSxNQUFNO29CQUMzQyxRQUFRLEVBQUUsVUFBVTtpQkFDdkI7O2FBQ0o7Ozt5QkFPSSxLQUFLO3lCQVlMLEtBQUs7K0JBSUwsU0FBUyxTQUFDLFlBQVksRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7NEJBSXhDLFNBQVMsU0FBQyx5QkFBeUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIElucHV0LFxyXG4gICAgVmlld0NoaWxkXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFRpU2VsZWN0Q29tcG9uZW50IH0gZnJvbSAnLi4vc2VsZWN0L1RpU2VsZWN0TW9kdWxlJztcclxuaW1wb3J0IHsgVGlIZWFkRmlsdGVyRHJvcENvbXBvbmVudCB9IGZyb20gJy4vVGlIZWFkRmlsdGVyRHJvcENvbXBvbmVudCc7XHJcbmltcG9ydCB7IFRpRm9ybUNvbXBvbmVudCB9IGZyb20gJy4uL2Jhc2UvVGlCYXNlTW9kdWxlJztcclxuaW1wb3J0IHsgVGlCcm93c2VyIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcblxyXG4vLyDkuIvpnaLms6jph4rvvIzlj6/ku6Xpgb/lhY3nvJbor5FsaWLml7bmraPliJnmiqXplJnjgILljp/nkIbmnKrnn6XvvIzlia/kvZznlKjmnKrnn6XjgIJcclxuLy8gQGR5bmFtaWNcclxuLyoqXHJcbiAqIFRpSGVhZEZpbHRlciDooajlpLTov4fmu6Qo5ryP5paXKee7hOS7tu+8jCDltYzlnKjooajlpLTnmoQgdGgg5Lit5L2/55So44CCXHJcbiAqXHJcbiAqIHRpLWhlYWQtZmlsdGVyIOeUqOadpeaYvuekuui/h+a7pOaTjeS9nOa8j+aWl+Wbvuagh++8jOeCueWHu+WFtuWPr+aJk+W8gOS4i+aLieahhu+8jOmAieS4reS4i+aLieahhuS4reeahOmAiemhueaXtu+8jFxyXG4gKiDlj6/lnKjmj5DkvpvnmoQgc2VsZWN0IOS6i+S7tuS4reWBmuWvueW6lOeahOihqOagvOaVsOaNrui/h+a7pOWkhOeQhuOAglxyXG4gKlxyXG4gKiAjIyMg5o6l5Y+j6K+05piOXHJcbiAqICoqSW5wdXRz77yaKipcclxuICpcclxuICogfCAgICAg5ZCN56ewICAgIHwgIOexu+WeiyAgIHwg6buY6K6k5YC8ICAgfCDlip/og73mj4/ov7AgIHxcclxuICogfCAtLS0tLS0tLSAgIHwgOi0tLS0tICAgfCA6LS0tLSB8IDotLS0tIHxcclxuICogfCBvcHRpb25zICAgfCBhcnJheSAgfCBbXSB8IOaJgOaciei/h+a7pOmhuSB8XHJcbiAqIHwgbmdNb2RlbCAgIHwgb2JqZWN0ICB8IGZhbHNlIHwg5Y+v6K6+572u5ZKM6I635Y+WIGhlYWRmaWx0ZXLkuIvmi4npgInkuK3lgLwgfFxyXG4gKiB8IGxhYmVsS2V5ICAgfCAgc3RyaW5nICB8ICdsYWJlbCcgfCDkuIvmi4npnaLmnb/kuK3opoHmmL7npLrnmoTlrZfmrrUsIDEwLjAuMueJiOacrOaWsOWiniB8XHJcbiAqIHwgcGFuZWxNYXhIZWlnaHQgICB8ICBzdHJpbmcgIHwg5pyA5aSn5pi+56S6OOadoeaVsOaNriB8IOS4i+S4i+aLiemdouadv+eahOacgOWkp+aYvuekuumrmOW6pu+8jOa6ouWHuuaXtuWImeWHuua7muWKqOadoeOAgiB8XHJcbiAqIHwgaWQgICB8IHN0cmluZyAgfCB1bmRlZmluZWQgfCBIVE1M5bGe5oCnaWTvvIzoh6rliqjljJbmtYvor5XopoHmsYLlv4Xpobvnu5lpZOi1i+WAvCB8XHJcbiAqIHwgc2VsZWN0ICAgfCBmdW5jdGlvbiAgfCDml6AgfCDkuIvmi4npnaLmnb/pgInkuK3kuovku7bvvIzlkJHlpJbpgJrnn6XpgInkuK3mlbDmja4gfFxyXG4gKiB8IG11bHRpcGxlICAgfCAgYm9vbGVhbiAgfCBmYWxzZSB8IOS4i+aLiemdouadv+aYr+WQpuS4uuWkmumAiSB8XHJcbiAqIHwgc2VsZWN0QWxsICAgfCAgYm9vbGVhbiAgfCBmYWxzZSB8IOS4i+aLiemdouadv+aYr+WQpuaYvuekuuWFqOmAieahhiB8XHJcbiAqIHwgcGFuZWxBbGlnbiAgIHwgIHN0cmluZyAgfCAnbGVmdCcgfCDkuIvmi4npnaLmnb/lsZXlvIDlr7npvZDmlrnlvI/vvIw5LjAuNOeJiOacrOaWsOWiniB8XHJcbiAqIHwgc2VhcmNoYWJsZSAgIHwgIGJvb2xlYW4gIHwgZmFsc2UgfCDmmK/lkKblvIDlkK/mkJzntKLlip/og73vvIwxMC4wLjLniYjmnKzmlrDlop4gfFxyXG4gKiB8IHBhbmVsV2lkdGggICB8ICAnYXV0bycg5oiWIHN0cmluZyAgfCAnYXV0bycgfCDorr7nva7kuIvmi4npnaLmnb/nmoTlrr3luqbvvIxcImF1dG9cIuihqOekuuS4i+aLieahhueahOWuveW6puagueaNruS4i+aLiemAiemhueeahOWGheWuueiHquWKqOaSkeW8gO+8jOS5n+WPr+iuvue9ruWbuuWumueahOS4i+aLieahhuWuveW6pijkuI3lsI/kuo7ov4fmu6Tlm77moIfnmoTlrr3luqYp77yM5L6L5aaC77yaXCIyMDBweFwiLCAxMC4wLjLniYjmnKzmlrDlop4gfFxyXG4gKiB8IG5vRGF0YVRleHQgICB8ICBzdHJpbmcgIHwgJy4uLicgfCDml6DmlbDmja7ml7bnmoTmmL7npLrmlofmnKzjgIIxMC4wLjPniYjmnKzmlrDlop4gfFxyXG4gKlxyXG4gKiA8cD48c3BhbiBzdHlsZT1cImNvbG9yOiByZWRcIj7ku6XkuIvor7TmmI7kuI3lj6/nlKjvvIzkuI3lgZrlj4LogIPjgII8L3NwYW4+6K+l57uE5Lu25Y+q5pyJ5Lul5LiKNeS4qklucHV05o6l5Y+j5ZKMMeS4qk91dHB1dOaOpeWPo1xyXG4gKiDlj6/nlKjvvIzlhbbkvZnmlrnms5XjgIFJbnB1dOOAgei+k+WHuuetiSjnu6fmib/kuo5UaVNlbGVjdENvbXBvbmVudCzmmK/kvptzZWxlY3TnmoTlhoXpg6jkvb/nlKjnmoQp6YO95LiN5Y+v55SoPC9wPlxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3RpLWhlYWQtZmlsdGVyJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9oZWFkLWZpbHRlci5odG1sJyxcclxuICAgIHN0eWxlVXJsczpbJy4vaGVhZC1maWx0ZXIubGVzcyddLFxyXG4gICAgcHJvdmlkZXJzOiBbVGlGb3JtQ29tcG9uZW50LmdldFZhbHVlQWNjZXNzb3IoVGlIZWFkRmlsdGVyQ29tcG9uZW50KV0sXHJcbiAgICBob3N0OiB7XHJcbiAgICAgICAgJ1tjbGFzcy50aTMtaGVhZC1maWx0ZXItY29udGFpbmVyXSc6ICd0cnVlJyxcclxuICAgICAgICAnKGJsdXIpJzogJ29uQmx1cigpJ1xyXG4gICAgfVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGlIZWFkRmlsdGVyQ29tcG9uZW50IGV4dGVuZHMgVGlTZWxlY3RDb21wb25lbnQge1xyXG4gICAgLyoqXHJcbiAgICAgKiDpnaLmnb/lr7npvZDmlrnlvI9cclxuICAgICAqXHJcbiAgICAgKiA5LjAuNOaWsOWinlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBwYW5lbEFsaWduOiAnbGVmdCcgfCAncmlnaHQnID0gJ2xlZnQnO1xyXG4gICAgLy8g55Sx5LqOaGVhZGZpbHRlcuS4jnNlbGVjdOS4reeahHBhbmVsV2lkdGjnmoTpu5jorqTlgLzlkoznsbvlnovkuI3kuIDmoLfvvIzmiYDku6Xov5nph4zph43lrprkuYlwYW5lbFdpZHRo5o6l5Y+jXHJcbiAgICAvKipcclxuICAgICAqIOS4i+aLiemdouadv+eahOacgOWkp+aYvuekuuWuveW6pu+8jOivpeWPmOmHj+S4juS4i+aLieexu+e7hOS7tuS/neaMgeS4gOiHtFxyXG4gICAgICpcclxuICAgICAqIDEuXCJhdXRvXCI6IOS4i+aLieahhueahOWuveW6puagueaNruS4i+aLiemAiemhueeahOWGheWuueiHquWKqOaSkeW8gO+8m1xyXG4gICAgICpcclxuICAgICAqIDIu6KGo56S65a695bqm55qE5a2X56ym5LiyOiDorr7nva7lm7rlrprnmoTkuIvmi4nmoYblrr3luqYo5LiN5bCP5LqOU2VsZWN057uE5Lu255qE5a695bqmKeOAguS+i+Wmgu+8mlwiMjAwcHhcIlxyXG4gICAgICpcclxuICAgICAqIDEwLjAuMueJiOacrOaWsOWinu+8jOm7mOiupOS4uidhdXRvJ++8jDEwLjEuMui1tzxiPuaQnOe0ouWcuuaZr+S4izwvYj7pu5jorqTlgLzkv67mlLnkuLrigJwxODBweOKAne+8jFxyXG4gICAgICovXHJcbiAgICAvLyDnva7kuLp1bmRlZmluZWTmmK/kuLrkuobopobnm5bniLbnsbvnmoRwYW5lbFdpZHRo5YC8XHJcbiAgICBASW5wdXQoKSBwYW5lbFdpZHRoOiAnYXV0byd8IHN0cmluZyA9IHVuZGVmaW5lZDtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCdmaWx0ZXJJY29uJywgeyBzdGF0aWM6IHRydWUgfSkgZmlsdGVySWNvbkVsZVJlZjogRWxlbWVudFJlZjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKFRpSGVhZEZpbHRlckRyb3BDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIGRyb3BzZWFyY2hDb206IFRpSGVhZEZpbHRlckRyb3BDb21wb25lbnQ7XHJcblxyXG4gICAgbmdBZnRlclZpZXdDaGVja2VkKCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOi/memHjOS4jeiDveiwg+eUqOeItuexu+aWueazle+8jOWboOS4ulNlbGVjdOeItuexu+WvuWRvbWluYXRvcuWkhOeQhu+8jOepuuaMh+mSiOaKpemUmeOAglxyXG4gICAgICAgIC8vIFRPRE86IOeci+aYr+WQpuiDveWkn+S4jee7p+aJv3NlbGVjdFxyXG4gICAgICAgIGlmICh0aGlzLnNlYXJjaGFibGUgIT09IHRoaXMub2xkU2VhcmNoYWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLm9sZFNlYXJjaGFibGUgPSB0aGlzLnNlYXJjaGFibGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXNhYmxlRWxlbXMoW3RoaXMuZmlsdGVySWNvbkVsZVJlZi5uYXRpdmVFbGVtZW50XVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQodGhpcy5kcm9wc2VhcmNoQ29tLmdldEZvY3VzYWJsZUVsZW1zKCkpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXNhYmxlRWxlbXMoW3RoaXMuZmlsdGVySWNvbkVsZVJlZi5uYXRpdmVFbGVtZW50XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlpLHnhKbmg4XlhrXkuIvvvIzku4XlhbPpl63pnaLmnb/vvIzkuI3lgZrogZrnhKbnrYnlpITnkIZcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uQmx1cigpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5vbkJsdXIoKTtcclxuICAgICAgICBpZiAoVGlCcm93c2VyLmlzSUUoKSAmJiB0aGlzLnNlYXJjaGFibGUpIHtcclxuICAgICAgICAgICAgaWYgKGdldENvbXB1dGVkU3R5bGUodGhpcy5maWx0ZXJJY29uRWxlUmVmLm5hdGl2ZUVsZW1lbnQpLm91dGxpbmVTdHlsZSA9PT0gJ25vbmUnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZmlsdGVySWNvbkVsZVJlZi5uYXRpdmVFbGVtZW50LCAnb3V0bGluZVN0eWxlJywgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==