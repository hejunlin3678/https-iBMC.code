import { Directive, ElementRef, IterableDiffers, NgZone, Renderer2, Inject } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { TiTableComponent } from './TiTableComponent';
import { TiRenderer } from '../../services/renderer/TiRenderer';
import { Util } from '../../utils/Util';
import { TiTableFixedHeadService } from './TiTableFixedHeadService';
/**
 * TiColsResizable 表格列拖动指令
 *
 * 支持拖动表格列来调整各列宽度。
 *
 * 在ti-table标签上加了tiColsResizable属性，则表格自动具有列拖动功能；
 * 同时还需要对table元素包裹父容器div，并对父容器设置 ti3-resize-wrapper样式类。
 */
export class TiColsResizableDirective {
    constructor(tableCom, renderer, elementRef, zone, tiRenderer, iterableDiffers, fixedHeadService, document) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.zone = zone;
        this.tiRenderer = tiRenderer;
        this.iterableDiffers = iterableDiffers;
        this.fixedHeadService = fixedHeadService;
        this.document = document;
        /**
         * @ignore
         */
        this.notResizableAttr = 'not-resizable';
        /**
         * @ignore
         */
        this.resizableOpts = {
            table: null,
            ths: null,
            wrap: null,
            mouseXPosition: 0,
            target: null,
            storedSizes: [],
            storedSortEleSizes: [],
            storeTableWidthChange: 0,
            isYOverflowedWithX: false
        }; // 初始化列拖动属性的配置项
        this.isDragStart = false;
        this.isColumnsInit = true;
        /**
         * @ignore
         */
        this.isfirstYScrollStateChange = true;
        /**
         * @ignore
         * 将当前表格各列的宽度更新到到resizableOpts.storedSizes中
         */
        this.updateStoredSizes = () => {
            this.resizableOpts.storedSizes = [];
            this.resizableOpts.ths.forEach((th, index) => {
                this.tiRenderer.setAttributes(th, { 'ti-visible-index': index });
                this.resizableOpts.storedSizes[index] = TiColsResizableDirective.getWidth(th);
            });
            // 更新表格记忆
            if (this.tableCom.storageId && this.tableCom.storageConfig.colsWidth) {
                this.tableCom.localStorageState['colsWidth'] = this.resizableOpts.storedSizes;
            }
        };
        /**
         * @ignore
         */
        this.setWidth = (element, width) => {
            this.renderer.setStyle(element, 'width', width + 'px');
        };
        this.hostEle = this.elementRef.nativeElement;
        this.tableCom = tableCom;
    }
    static getThs(table) {
        return Array.from(table.children[0].children[0].children);
    }
    static getWidth(element) {
        return parseFloat(element.getBoundingClientRect().width
            .toFixed(1));
    }
    static trackByFn(index, item) {
        return item.show;
    }
    ngOnInit() {
        this.subscription = this.tableCom.viewInitSubject.subscribe(() => {
            this.processColsResizable();
            this.isColumnsInit = false; // 主要处理 columns 初始为空，异步的场景
            // 表格记忆
            // 版本更新后用户第一次访问，localStorageState['colsWidth']不存在
            // 修复SSR错误：ERROR TypeError: Cannot read property 'colsWidth' of undefined 
            if (this.tableCom.storageId && this.tableCom.storageConfig && this.tableCom.storageConfig.colsWidth
                && this.tableCom.localStorageState && this.tableCom.localStorageState['colsWidth']) {
                this.initStorageColsWidth();
            }
        });
        this.columsDiffer = this.iterableDiffers.find(this.tableCom.columns)
            .create(TiColsResizableDirective.trackByFn);
    }
    ngDoCheck() {
        const columsDiffer = this.columsDiffer.diff(this.tableCom.columns);
        if (columsDiffer) {
            if (this.isColumnsInit) {
                this.isColumnsInit = false;
                return;
            }
            this.zone.runOutsideAngular(() => {
                setTimeout(() => {
                    this.setDefaultWidth();
                }, 0);
            });
        }
    }
    ngOnDestroy() {
        this.subscription.unsubscribe();
        if (this.documentMouseMoveListener) {
            this.documentMouseMoveListener();
        }
        if (this.documentMouseUpListener) {
            this.documentMouseUpListener();
        }
        if (this.windowResizeListener) {
            this.windowResizeListener();
        }
    }
    processColsResizable() {
        this.setTableWidthChange();
        const table = this.resizableOpts.table = this.getTable();
        const thead = table.children[0];
        if (this.tableCom.isFixedHead) {
            this.resizableOpts.secondTable = this.getSecondTable();
            this.resizableOpts.xScrollState = this.overflowedX();
            this.resizableOpts.yScrollState = this.overflowedY();
            this.resizableOpts.ths = TiColsResizableDirective.getThs(table);
            this.resizableOpts.secondThs = TiColsResizableDirective.getThs(this.resizableOpts.secondTable);
            this.tableCom.processYScrollStateChangeWithColsResizable = () => {
                this.fixedHeadService.processYScrollStateChange(this);
            };
        }
        this.zone.runOutsideAngular(() => {
            this.renderer.listen(thead, 'mousemove', (event) => {
                const currentTh = event.target;
                if (currentTh['nodeName'] !== 'TH') {
                    return;
                }
                // 获取当前th距页面文档的left值
                const left = currentTh['getBoundingClientRect']().left + this.document.documentElement.scrollLeft;
                const thWidth = currentTh['getBoundingClientRect']().width;
                // 判断光标是否落在th的右边缘
                const isOnColBorder = Math.abs(event.pageX - Math.round(left + thWidth)) <=
                    TiColsResizableDirective.COL_BORDER_RANGE;
                if (isOnColBorder) {
                    if (event.target['hasAttribute'](this.notResizableAttr) ||
                        this.isLastColumn(currentTh)) {
                        return;
                    }
                    this.createDividingLine(currentTh);
                }
                else {
                    this.removeDividingLine();
                }
            });
            this.renderer.listen(thead, 'mouseleave', () => {
                this.removeDividingLine();
            });
            this.renderer.listen(thead, 'mousedown', (event) => {
                const currentTh = event.target;
                if (this.tiRenderer.hasClass(currentTh, 'col-resize-active')) {
                    this.isDragStart = true;
                    // 鼠标点击的当前列
                    this.resizableOpts.target = currentTh;
                    // 更新光标位置
                    this.resizableOpts.mouseXPosition = event.pageX;
                    // 在拖动前获取当前表格最新的列信息、宽度，很关键，使得设置宽度与样式实际宽度一直
                    this.updateTableInfo();
                    // 给页面设置不可选样式，避免拖动时页面或表格内部出现被选中的蓝色区域
                    this.toggleTextSelection(true);
                }
                if (this.tableCom.isFixedHead) {
                    this.resizableOpts.xScrollState = this.overflowedX();
                    this.resizableOpts.yScrollState = this.overflowedY();
                }
            });
            const tableContainer = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];
            if (!this.tiRenderer.hasClass(tableContainer, 'ti3-table-container')) {
                this.renderer.listen(tableContainer, 'scroll', () => {
                    Util.trigger(this.document, 'tiScroll');
                });
            }
            this.documentMouseMoveListener = this.renderer.listen(this.document, 'mousemove', (event) => {
                // 列拖动的动作应该是先mousedown，然后mousemove，因此先判断是否已经触发了mousedown
                if (!this.isDragStart || this.resizableOpts.mouseXPosition === 0 || !this.resizableOpts.target) {
                    return;
                }
                this.mouseMove(event);
            });
            this.documentMouseUpListener = this.renderer.listen(this.document, 'mouseup', (event) => {
                if (!this.isDragStart) {
                    return;
                }
                this.toggleTextSelection(false); // 恢复页面可选样式
                this.stopResize(); // 保存最新宽度到浏览器中
                this.isDragStart = false;
            });
            // 修复SSR报错：ERROR ReferenceError: window is not defined
            if (typeof window === 'undefined') {
                return;
            }
            this.windowResizeListener = this.renderer.listen(window, 'resize', () => {
                this.setTableWidthChange();
            });
        });
    }
    mouseMove(event) {
        const options = this.resizableOpts;
        const lastColIndex = options.ths.length - 1;
        const curColIndex = parseInt(options.target.getAttribute('ti-visible-index'), 10);
        const colWidth = options.storedSizes[curColIndex];
        const leftEdge = parseFloat((event.pageX - options.mouseXPosition).toFixed(1));
        const minWidth = this.getColMinWidth(options.target);
        // 当拖拽方向为列宽度减小的方向且列宽已达到文本区最小宽度时阻止拖动
        if ((leftEdge >= 0) || (colWidth + leftEdge > Math.ceil(minWidth))) {
            // 更新拖动列宽度
            options.storedSizes[curColIndex] += leftEdge;
            this.setWidth(options.target, options.storedSizes[curColIndex]);
            // 对最后一列的列宽的整体处理方案：
            // 如果更新拖动列宽度后的表格的总宽度小于表格初始宽度，则将宽度差补偿到最后一列;
            // 如果更新拖动列宽度后的表格的总宽度大于表格初始宽度，且之前最后一列列宽有补偿时，
            // 将最后一列的补偿先抵消掉，然后有超出时再出滚动条
            // s: storeTableWidthChange(此次拖动前各列拖动值的累计和)
            // b: 此次拖动前给末列的补偿值
            // l: leftEdge(此次拖动的距离)
            //   s      l        s + l       b       此次拖动后对末列宽的设置
            //  -5     -1       -6 < 0      +5          +1(-leftEdge)
            //  -5     +3       -2 < 0      +5          -3(-leftEdge)
            //  +5     -8       -3 < 0       0          +3(-(storeColsWidthChange+leftEdge))
            //  -5     +8        3 > 0      +5          -5(+storeColsWidthChange)
            //  +5     +3        8 > 0       0          +0(不做处理)
            //  +5     -3        2 > 0       0          +0(不做处理)
            if (leftEdge + options.storeTableWidthChange < 0) {
                if (options.storeTableWidthChange < 0) {
                    options.storedSizes[lastColIndex] -= leftEdge;
                }
                else {
                    options.storedSizes[lastColIndex] -= (leftEdge + options.storeTableWidthChange);
                }
            }
            else {
                if (options.storeTableWidthChange < 0) {
                    options.storedSizes[lastColIndex] += options.storeTableWidthChange;
                }
            }
            this.setWidth(options.ths[lastColIndex], options.storedSizes[lastColIndex]);
            // 更新各列拖动相对值的累计和
            options.storeTableWidthChange += leftEdge;
            // 表头锁定
            if (this.tableCom.isFixedHead) {
                // 更新第二个表格（bodyTable）中的当前列和最后一列的宽度
                this.setWidth(options.secondThs[curColIndex], options.storedSizes[curColIndex]);
                this.setWidth(options.secondThs[options.secondThs.length - 1], options.storedSizes[lastColIndex]);
                this.fixedHeadService.handleYNotOverflowedWithX(this.resizableOpts, this.tableCom.tbodyContainer);
                // 当横向滚动条出现导致纵向滚动条出现时对账本做处理
                this.fixedHeadService.handleYOverflowedWithX(this.resizableOpts, this.tableCom.tbodyContainer);
                // 纵向滚动条状态变化时对固定的表头右边填充块的处理
                this.fixedHeadService.processOverflowY(this.tableCom.theadContainer, this.tableCom.tbodyContainer, this.tableCom);
            }
            if (this.tableCom.fixedColumnInfo.hasFixedColumn) {
                this.tableCom.thResizeSubject.next({
                    th: options.target,
                    leftEdge,
                    resizableOpts: this.resizableOpts
                });
                const container = this.tableCom.fixedColumnInfo.container;
                if (container) {
                    const scrollLeft = container.scrollLeft;
                    const isRightColumnFloat = scrollLeft + container.clientWidth < container.scrollWidth;
                    this.tableCom.containerScrollXChangeSubject.next({
                        scrollLeft,
                        isRightColumnFloat
                    });
                }
            }
        }
        // 更新光标位置
        options.mouseXPosition = event.pageX;
    }
    getColMinWidth(thElement) {
        // 此处的值是'...'所占宽度，文本区的宽度最小为省略号所占宽度；当容器宽度小于此值时，文本会完全显示，但超出部分会直接被截断。
        // Chrome 和 IE下省略号'...'所占宽度大概为10px;
        // Firefox 下不会出现只有'...'的情况，最小为：一个字符 + '...',其所占宽度大概为28px(中文字符下)；
        // 此处为保证三个浏览器都表现正常，取值29(28 + 1, 1为矫正偏差值)。
        let minWidth = 29;
        minWidth += parseFloat(window.getComputedStyle(thElement).paddingLeft) +
            parseFloat(window.getComputedStyle(thElement).paddingRight);
        const sortEle = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-sort-container')[0];
        const iconsEle = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-cell-icons-container')[0];
        const headFilterEle = this.tiRenderer.findChildrenByClassName(thElement, 'ti3-head-filter-container')[0];
        if (sortEle) {
            const sortWidth = parseFloat(sortEle.getBoundingClientRect().width
                .toFixed(1));
            minWidth += sortWidth;
        }
        if (iconsEle) {
            const filterWidth = parseFloat(iconsEle.getBoundingClientRect().width
                .toFixed(1));
            minWidth += filterWidth;
        }
        if (headFilterEle) {
            const headFilterWidth = parseFloat(headFilterEle.getBoundingClientRect().width
                .toFixed(1));
            minWidth += headFilterWidth;
        }
        return minWidth;
    }
    setTableWidthChange() {
        const tableContainer = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];
        // 表格容器自身宽度（不包括Y方向滚动条的宽度）
        const clientWidth = tableContainer ? tableContainer['clientWidth'] : 0;
        // 表格容器实际内容区域宽度
        const scrollWidth = tableContainer ? tableContainer['scrollWidth'] : 0;
        // resizableOpts.storeColsWidthChange为各列拖动相对值的累计和
        // 将表格内容溢出部分的宽度赋给各列拖动相对值的累计和
        this.resizableOpts.storeTableWidthChange = scrollWidth - clientWidth;
    }
    stopResize() {
        this.updateStoredSizes();
        this.resizableOpts.mouseXPosition = 0;
        this.resizableOpts.target = null;
        if (this.tableCom.isFixedHead) {
            this.resizableOpts.xScrollState = this.overflowedX();
            this.resizableOpts.yScrollState = this.overflowedY();
        }
    }
    getTable() {
        // 用户给table元素加父容器，通过父容器设置overflow属性
        const tableContainerClassName = this.tableCom.isFixedHead ? 'ti3-table-fixed-head' : 'ti3-resize-wrapper';
        const tableContainer = this.tiRenderer.findChildrenByClassName(this.hostEle, tableContainerClassName)[0];
        const table = tableContainer.children[0].nodeName === 'TABLE' ? tableContainer.children[0] : null;
        return table;
    }
    /**
     * @ignore
     */
    isLastColumn(th) {
        const parentElement = th.parentElement;
        if (!parentElement) {
            return true;
        }
        const ths = th.parentElement.children;
        const index = Array.from(ths)
            .indexOf(th);
        return index === ths.length - 1;
    }
    // 当光标移到感应区时，出现拖动分割线
    createDividingLine(th) {
        this.renderer.addClass(th, 'col-resize-active');
        const index = Array.from(th.parentElement.children)
            .indexOf(th);
        const bodyTable = this.tableCom.isFixedHead ? this.resizableOpts.secondTable : this.resizableOpts.table;
        // 防止不存在tbody的场景报错
        if (!bodyTable.children[1]) {
            return;
        }
        const trs = Array.from(bodyTable.children[1].children)
            .filter((tr) => {
            return this.needDividingLine(tr);
        });
        trs.forEach((tr) => {
            // 分组场景index 大于tr.children.length
            if (!tr.children[index]) {
                return;
            }
            this.renderer.addClass(tr.children[index], 'col-resize-active');
        });
    }
    // 当光标离开感应区时，拖动分割线消失
    removeDividingLine() {
        const bodyTable = this.tableCom.isFixedHead ? this.resizableOpts.secondTable : this.resizableOpts.table;
        const ths = Array.from(this.resizableOpts.table.children[0].children[0].children);
        ths.forEach((th) => {
            this.renderer.removeClass(th, 'col-resize-active');
        });
        // 防止不存在tbody的场景报错
        if (!bodyTable.children[1]) {
            return;
        }
        const trs = Array.from(bodyTable.children[1].children);
        trs.forEach((tr) => {
            if (!this.needDividingLine(tr)) {
                return;
            }
            Array.from(tr.children)
                .forEach((td) => {
                this.renderer.removeClass(td, 'col-resize-active');
            });
        });
    }
    updateTableInfo() {
        this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);
        this.updateStoredSizes(); // 保存最新宽度
        this.setComputedWidth(); // 设置最新宽度
    }
    initStorageColsWidth() {
        this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);
        this.resizableOpts.storedSizes = this.tableCom.localStorageState['colsWidth'];
        this.setComputedWidth();
        // 各列宽度设置后，可能出现滚动条，所以要计算一次 storeTableWidthChange的值
        this.setTableWidthChange();
    }
    setComputedWidth() {
        if (this.resizableOpts.table && this.resizableOpts.ths && this.resizableOpts.ths.length) {
            this.resizableOpts.ths.forEach((th, index) => {
                this.setWidth(th, this.resizableOpts.storedSizes[index]);
                // 表头锁定
                if (this.tableCom.isFixedHead) {
                    this.resizableOpts.secondThs = TiColsResizableDirective.getThs(this.resizableOpts.secondTable);
                    this.setWidth(this.resizableOpts.secondThs[index], this.resizableOpts.storedSizes[index]);
                }
            });
        }
    }
    // 将表格宽度设置为默认宽度
    setDefaultWidth() {
        const ths = this.resizableOpts.ths = TiColsResizableDirective.getThs(this.resizableOpts.table);
        // 列隐藏或显示后，将各列宽设置为初始用户设置的列宽
        ths.forEach((th) => {
            const width = th.getAttribute('width') ? th.getAttribute('width') : '';
            // 注意：设置列宽的方式有多种，此处统一默认以width属性设置的宽为准
            this.renderer.setStyle(th, 'width', width);
        });
        // 表头锁定
        if (this.tableCom.isFixedHead) {
            const secondTable = this.getSecondTable();
            const secondThs = TiColsResizableDirective.getThs(secondTable);
            this.resizableOpts.secondThs = secondThs;
            this.resizableOpts.xScrollState = this.overflowedX();
            this.resizableOpts.yScrollState = this.overflowedY();
            secondThs.forEach((th) => {
                const width = th.getAttribute('width') ? th.getAttribute('width') : '';
                // 注意：设置列宽的方式有多种，此处统一默认以width属性设置的宽为准
                this.renderer.setStyle(th, 'width', width);
            });
            this.fixedHeadService.processYScrollStateChange(this);
        }
        this.setTableWidthChange();
    }
    // 当列拖动进行时去掉文字可选样式(user-select: none)
    toggleTextSelection(toggle) {
        const body = this.document.body;
        if (toggle) {
            this.renderer.addClass(body, 'ti3-unselectable');
            this.renderer.setAttribute(body, 'unselectable', 'on');
        }
        else {
            this.renderer.removeClass(body, 'ti3-unselectable');
            body.removeAttribute('unselectable');
        }
    }
    needDividingLine(tr) {
        if (!tr) {
            return false;
        }
        const classes = ['ti3-details-tr', 'ti3-table-nodata', 'ti3-table-loadfail',
            'ti3-table-nodata-guide', 'ti3-table-nodata-simple'];
        for (const className of classes) {
            if (this.tiRenderer.hasClass(tr, className)) {
                return false;
            }
        }
        return true;
    }
    // 供表头锁定使用
    getSecondTable() {
        const secondTableContainer = this.tiRenderer.findChildrenByClassName(this.hostEle, 'ti3-resize-wrapper')[0];
        return secondTableContainer ? secondTableContainer.children[0] : null;
    }
    overflowedX(isNum) {
        return this.fixedHeadService.overflowedResult(this.tableCom.tbodyContainer, 'X', isNum);
    }
    overflowedY(isNum) {
        return this.fixedHeadService.overflowedResult(this.tableCom.tbodyContainer, 'Y', isNum);
    }
}
/**
 * @ignore
 */
TiColsResizableDirective.UNSELECTABLE_CLASS = 'ti3-unselectable';
/**
 * @ignore
 * 移到表头能够显示拖动线的感应范围
 */
TiColsResizableDirective.COL_BORDER_RANGE = 10;
TiColsResizableDirective.decorators = [
    { type: Directive, args: [{
                selector: 'ti-table[tiColsResizable]'
            },] }
];
TiColsResizableDirective.ctorParameters = () => [
    { type: TiTableComponent },
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgZone },
    { type: TiRenderer },
    { type: IterableDiffers },
    { type: TiTableFixedHeadService },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlDb2xzUmVzaXphYmxlRGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvdGFibGUvVGlDb2xzUmVzaXphYmxlRGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsVUFBVSxFQUdWLGVBQWUsRUFDZixNQUFNLEVBR04sU0FBUyxFQUNULE1BQU0sRUFDUCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFHM0MsT0FBTyxFQUFrQixnQkFBZ0IsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUNoRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFeEMsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFvQnBFOzs7Ozs7O0dBT0c7QUFJSCxNQUFNLE9BQU8sd0JBQXdCO0lBNENqQyxZQUFZLFFBQTBCLEVBQVUsUUFBbUIsRUFDL0MsVUFBc0IsRUFBVSxJQUFZLEVBQVUsVUFBc0IsRUFDNUUsZUFBZ0MsRUFDaEMsZ0JBQXlDLEVBQ3ZCLFFBQVE7UUFKRSxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQy9DLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxTQUFJLEdBQUosSUFBSSxDQUFRO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUM1RSxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDaEMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUF5QjtRQUN2QixhQUFRLEdBQVIsUUFBUSxDQUFBO1FBdEM5Qzs7V0FFRztRQUNhLHFCQUFnQixHQUFXLGVBQWUsQ0FBQztRQUMzRDs7V0FFRztRQUNJLGtCQUFhLEdBQWtCO1lBQ2xDLEtBQUssRUFBRSxJQUFJO1lBQ1gsR0FBRyxFQUFFLElBQUk7WUFDVCxJQUFJLEVBQUUsSUFBSTtZQUNWLGNBQWMsRUFBRSxDQUFDO1lBQ2pCLE1BQU0sRUFBRSxJQUFJO1lBQ1osV0FBVyxFQUFFLEVBQUU7WUFDZixrQkFBa0IsRUFBRSxFQUFFO1lBQ3RCLHFCQUFxQixFQUFFLENBQUM7WUFDeEIsa0JBQWtCLEVBQUUsS0FBSztTQUM1QixDQUFDLENBQUMsZUFBZTtRQUtWLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBRzdCLGtCQUFhLEdBQVksSUFBSSxDQUFDO1FBQ3RDOztXQUVHO1FBQ0ksOEJBQXlCLEdBQVksSUFBSSxDQUFDO1FBOFlqRDs7O1dBR0c7UUFDSSxzQkFBaUIsR0FBRyxHQUFTLEVBQUU7WUFDbEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1lBQ3BDLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQU8sRUFBRSxLQUFhLEVBQUUsRUFBRTtnQkFDdEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsRUFBRSxFQUFFLEVBQUMsa0JBQWtCLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztnQkFDL0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsd0JBQXdCLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2xGLENBQUMsQ0FBQyxDQUFDO1lBQ0gsU0FBUztZQUNULElBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLElBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUFDO2dCQUM5RCxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxHQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDO2FBQ2hGO1FBQ0wsQ0FBQyxDQUFBO1FBZUQ7O1dBRUc7UUFDSSxhQUFRLEdBQUcsQ0FBQyxPQUFZLEVBQUUsS0FBYSxFQUFRLEVBQUU7WUFDcEQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDM0QsQ0FBQyxDQUFBO1FBdGFHLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUM7UUFDN0MsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDN0IsQ0FBQztJQUVPLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBYztRQUNoQyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVPLE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBWTtRQUNoQyxPQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxLQUFLO2FBQ2xELE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JCLENBQUM7SUFFTyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQWEsRUFBRSxJQUFzQjtRQUMxRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDckIsQ0FBQztJQUVELFFBQVE7UUFDSixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUU7WUFDN0QsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7WUFDNUIsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUMsQ0FBQywwQkFBMEI7WUFDdEQsT0FBTztZQUNQLGlEQUFpRDtZQUNqRCwwRUFBMEU7WUFDMUUsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxTQUFTO21CQUM1RixJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLEVBQUU7Z0JBQ3BGLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO2FBQy9CO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO2FBQy9ELE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBRUQsU0FBUztRQUNMLE1BQU0sWUFBWSxHQUFvQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3BHLElBQUksWUFBWSxFQUFFO1lBQ2QsSUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO2dCQUNwQixJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQztnQkFFM0IsT0FBTzthQUNWO1lBQ0QsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7Z0JBQzdCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7b0JBQ1osSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUM5QixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDUCxDQUFDLENBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQztJQUVELFdBQVc7UUFDUCxJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2hDLElBQUksSUFBSSxDQUFDLHlCQUF5QixFQUFFO1lBQ2hDLElBQUksQ0FBQyx5QkFBeUIsRUFBRSxDQUFDO1NBQ3BDO1FBQ0QsSUFBSSxJQUFJLENBQUMsdUJBQXVCLEVBQUU7WUFDOUIsSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7U0FDbEM7UUFDRCxJQUFJLElBQUksQ0FBQyxvQkFBb0IsRUFBRTtZQUMzQixJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztTQUMvQjtJQUNMLENBQUM7SUFFTyxvQkFBb0I7UUFDeEIsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFDM0IsTUFBTSxLQUFLLEdBQVEsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzlELE1BQU0sS0FBSyxHQUFRLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRTtZQUMzQixJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdkQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3JELElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNyRCxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsR0FBRyx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEdBQUcsd0JBQXdCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDL0YsSUFBSSxDQUFDLFFBQVEsQ0FBQywwQ0FBMEMsR0FBRyxHQUFTLEVBQUU7Z0JBQ2xFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxRCxDQUFDLENBQUM7U0FDTDtRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFO1lBQzdCLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsQ0FBQyxLQUFpQixFQUFFLEVBQUU7Z0JBQzNELE1BQU0sU0FBUyxHQUFRLEtBQUssQ0FBQyxNQUFNLENBQUM7Z0JBRXBDLElBQUksU0FBUyxDQUFDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtvQkFDaEMsT0FBTztpQkFDVjtnQkFFRCxvQkFBb0I7Z0JBQ3BCLE1BQU0sSUFBSSxHQUFXLFNBQVMsQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLFVBQVUsQ0FBQztnQkFDMUcsTUFBTSxPQUFPLEdBQVcsU0FBUyxDQUFDLHVCQUF1QixDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUM7Z0JBQ25FLGlCQUFpQjtnQkFDakIsTUFBTSxhQUFhLEdBQVksSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxDQUFDO29CQUM3RSx3QkFBd0IsQ0FBQyxnQkFBZ0IsQ0FBQztnQkFFOUMsSUFBSSxhQUFhLEVBQUU7b0JBQ2YsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQzt3QkFDbkQsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsRUFBRTt3QkFDOUIsT0FBTztxQkFDVjtvQkFDRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUM7aUJBQ3RDO3FCQUFNO29CQUNILElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO2lCQUM3QjtZQUNMLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLFlBQVksRUFBRSxHQUFHLEVBQUU7Z0JBQzNDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBQzlCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxDQUFDLEtBQWlCLEVBQUUsRUFBRTtnQkFDM0QsTUFBTSxTQUFTLEdBQVEsS0FBSyxDQUFDLE1BQU0sQ0FBQztnQkFDcEMsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsbUJBQW1CLENBQUMsRUFBRTtvQkFDMUQsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7b0JBQ3hCLFdBQVc7b0JBQ1gsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDO29CQUN0QyxTQUFTO29CQUNULElBQUksQ0FBQyxhQUFhLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7b0JBQ2hELDBDQUEwQztvQkFDMUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO29CQUN2QixvQ0FBb0M7b0JBQ3BDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztpQkFDbEM7Z0JBRUQsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRTtvQkFDM0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUNyRCxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7aUJBQ3hEO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFFSCxNQUFNLGNBQWMsR0FBUSxJQUFJLENBQUMsVUFBVSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMzRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLHFCQUFxQixDQUFDLEVBQUU7Z0JBQ2xFLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFO29CQUNoRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7Z0JBQzVDLENBQUMsQ0FBQyxDQUFDO2FBQ047WUFFRCxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxXQUFXLEVBQUUsQ0FBQyxLQUFpQixFQUFFLEVBQUU7Z0JBQ3BHLHdEQUF3RDtnQkFDeEQsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUU7b0JBQzVGLE9BQU87aUJBQ1Y7Z0JBRUQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMxQixDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxDQUFDLEtBQWlCLEVBQUUsRUFBRTtnQkFDaEcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7b0JBQ25CLE9BQU87aUJBQ1Y7Z0JBRUQsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsV0FBVztnQkFDNUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsY0FBYztnQkFDakMsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUM7WUFFSCxzREFBc0Q7WUFDdEQsSUFBRyxPQUFPLE1BQU0sS0FBSyxXQUFXLEVBQUM7Z0JBQzdCLE9BQU87YUFDVjtZQUNELElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRTtnQkFDcEUsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTyxTQUFTLENBQUMsS0FBaUI7UUFDL0IsTUFBTSxPQUFPLEdBQWtCLElBQUksQ0FBQyxhQUFhLENBQUM7UUFDbEQsTUFBTSxZQUFZLEdBQVcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ3BELE1BQU0sV0FBVyxHQUFXLFFBQVEsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzFGLE1BQU0sUUFBUSxHQUFXLE9BQU8sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDMUQsTUFBTSxRQUFRLEdBQVcsVUFBVSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkYsTUFBTSxRQUFRLEdBQVcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFN0QsbUNBQW1DO1FBQ25DLElBQUksQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRTtZQUNoRSxVQUFVO1lBQ1YsT0FBTyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsSUFBSSxRQUFRLENBQUM7WUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztZQUVoRSxtQkFBbUI7WUFDbkIsMENBQTBDO1lBQzFDLDJDQUEyQztZQUMzQywyQkFBMkI7WUFFM0IsMkNBQTJDO1lBQzNDLGtCQUFrQjtZQUNsQix1QkFBdUI7WUFDdkIscURBQXFEO1lBQ3JELHlEQUF5RDtZQUN6RCx5REFBeUQ7WUFDekQsZ0ZBQWdGO1lBQ2hGLHFFQUFxRTtZQUNyRSxvREFBb0Q7WUFDcEQsb0RBQW9EO1lBQ3BELElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsR0FBRyxDQUFDLEVBQUU7Z0JBQzlDLElBQUksT0FBTyxDQUFDLHFCQUFxQixHQUFHLENBQUMsRUFBRTtvQkFDbkMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsSUFBSSxRQUFRLENBQUM7aUJBQ2pEO3FCQUFNO29CQUNILE9BQU8sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUM7aUJBQ25GO2FBQ0o7aUJBQU07Z0JBQ0gsSUFBSSxPQUFPLENBQUMscUJBQXFCLEdBQUcsQ0FBQyxFQUFFO29CQUNuQyxPQUFPLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQztpQkFDdEU7YUFDSjtZQUVELElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsRUFBRSxPQUFPLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFFNUUsZ0JBQWdCO1lBQ2hCLE9BQU8sQ0FBQyxxQkFBcUIsSUFBSSxRQUFRLENBQUM7WUFFMUMsT0FBTztZQUNQLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUU7Z0JBRTNCLGtDQUFrQztnQkFDbEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztnQkFDaEYsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztnQkFFbEcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLHlCQUF5QixDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFFbEcsMkJBQTJCO2dCQUMzQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUUvRiwyQkFBMkI7Z0JBQzNCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDckg7WUFFRCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLGNBQWMsRUFBRTtnQkFDOUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO29CQUMvQixFQUFFLEVBQUUsT0FBTyxDQUFDLE1BQU07b0JBQ2xCLFFBQVE7b0JBQ1IsYUFBYSxFQUFFLElBQUksQ0FBQyxhQUFhO2lCQUNwQyxDQUFDLENBQUM7Z0JBQ0gsTUFBTSxTQUFTLEdBQVEsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDO2dCQUMvRCxJQUFJLFNBQVMsRUFBRTtvQkFDWCxNQUFNLFVBQVUsR0FBVyxTQUFTLENBQUMsVUFBVSxDQUFDO29CQUNoRCxNQUFNLGtCQUFrQixHQUFZLFVBQVUsR0FBRyxTQUFTLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQyxXQUFXLENBQUM7b0JBQy9GLElBQUksQ0FBQyxRQUFRLENBQUMsNkJBQTZCLENBQUMsSUFBSSxDQUFDO3dCQUM3QyxVQUFVO3dCQUNWLGtCQUFrQjtxQkFDckIsQ0FBQyxDQUFDO2lCQUNOO2FBQ0o7U0FDSjtRQUVELFNBQVM7UUFDVCxPQUFPLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7SUFDekMsQ0FBQztJQUVPLGNBQWMsQ0FBQyxTQUFjO1FBQ2pDLGtFQUFrRTtRQUNsRSxtQ0FBbUM7UUFDbkMsZ0VBQWdFO1FBQ2hFLHlDQUF5QztRQUN6QyxJQUFJLFFBQVEsR0FBVyxFQUFFLENBQUM7UUFFMUIsUUFBUSxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxDQUFDO1lBQ2xFLFVBQVUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDaEUsTUFBTSxPQUFPLEdBQVEsSUFBSSxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxTQUFTLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqRyxNQUFNLFFBQVEsR0FBUSxJQUFJLENBQUMsVUFBVSxDQUFDLHVCQUF1QixDQUFDLFNBQVMsRUFBRSwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hHLE1BQU0sYUFBYSxHQUFRLElBQUksQ0FBQyxVQUFVLENBQUMsdUJBQXVCLENBQUMsU0FBUyxFQUFFLDJCQUEyQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFOUcsSUFBSSxPQUFPLEVBQUU7WUFDVCxNQUFNLFNBQVMsR0FBVyxVQUFVLENBQUMsT0FBTyxDQUFDLHFCQUFxQixFQUFFLENBQUMsS0FBSztpQkFDckUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakIsUUFBUSxJQUFJLFNBQVMsQ0FBQztTQUN6QjtRQUVELElBQUksUUFBUSxFQUFFO1lBQ1YsTUFBTSxXQUFXLEdBQVcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLEtBQUs7aUJBQ3hFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLFFBQVEsSUFBSSxXQUFXLENBQUM7U0FDM0I7UUFFRCxJQUFJLGFBQWEsRUFBRTtZQUNmLE1BQU0sZUFBZSxHQUFXLFVBQVUsQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxLQUFLO2lCQUNqRixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqQixRQUFRLElBQUksZUFBZSxDQUFDO1NBQy9CO1FBRUQsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQztJQUVPLG1CQUFtQjtRQUN2QixNQUFNLGNBQWMsR0FBUSxJQUFJLENBQUMsVUFBVSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzRyx5QkFBeUI7UUFDekIsTUFBTSxXQUFXLEdBQVcsY0FBYyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvRSxlQUFlO1FBQ2YsTUFBTSxXQUFXLEdBQVcsY0FBYyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUUvRSxpREFBaUQ7UUFDakQsNEJBQTRCO1FBQzVCLElBQUksQ0FBQyxhQUFhLENBQUMscUJBQXFCLEdBQUcsV0FBVyxHQUFHLFdBQVcsQ0FBQztJQUN6RSxDQUFDO0lBRU8sVUFBVTtRQUNkLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxhQUFhLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQztRQUN0QyxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDakMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRTtZQUMzQixJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDckQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3hEO0lBQ0wsQ0FBQztJQUVPLFFBQVE7UUFDWixtQ0FBbUM7UUFDbkMsTUFBTSx1QkFBdUIsR0FBVyxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO1FBQ2xILE1BQU0sY0FBYyxHQUFRLElBQUksQ0FBQyxVQUFVLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlHLE1BQU0sS0FBSyxHQUFRLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBRXZHLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRDs7T0FFRztJQUNJLFlBQVksQ0FBQyxFQUFPO1FBQ3ZCLE1BQU0sYUFBYSxHQUFRLEVBQUUsQ0FBQyxhQUFhLENBQUM7UUFDNUMsSUFBSSxDQUFDLGFBQWEsRUFBRTtZQUNoQixPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsTUFBTSxHQUFHLEdBQVEsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUM7UUFDM0MsTUFBTSxLQUFLLEdBQVcsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7YUFDaEMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLE9BQU8sS0FBSyxLQUFLLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxvQkFBb0I7SUFDWixrQkFBa0IsQ0FBQyxFQUFPO1FBQzlCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBRWhELE1BQU0sS0FBSyxHQUFXLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUM7YUFDdEQsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2pCLE1BQU0sU0FBUyxHQUFRLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUM7UUFDN0csa0JBQWtCO1FBQ2xCLElBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFDO1lBQ3RCLE9BQU87U0FDVjtRQUNELE1BQU0sR0FBRyxHQUFlLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7YUFDN0QsTUFBTSxDQUFDLENBQUMsRUFBTyxFQUFFLEVBQUU7WUFDaEIsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7UUFDSCxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBTyxFQUFFLEVBQUU7WUFDcEIsaUNBQWlDO1lBQ2pDLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNyQixPQUFPO2FBQ1Y7WUFDRCxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsb0JBQW9CO0lBQ1osa0JBQWtCO1FBQ3RCLE1BQU0sU0FBUyxHQUFRLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUM7UUFDN0csTUFBTSxHQUFHLEdBQWUsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTlGLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFXLEVBQUUsRUFBRTtZQUN4QixJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztRQUN2RCxDQUFDLENBQUMsQ0FBQztRQUVILGtCQUFrQjtRQUNsQixJQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN2QixPQUFPO1NBQ1Y7UUFDRCxNQUFNLEdBQUcsR0FBZSxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbkUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQVcsRUFBRSxFQUFFO1lBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLEVBQUU7Z0JBQzVCLE9BQU87YUFDVjtZQUNELEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQztpQkFDbEIsT0FBTyxDQUFDLENBQUMsRUFBTyxFQUFFLEVBQUU7Z0JBQ2pCLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEVBQUUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1lBQzNELENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRU8sZUFBZTtRQUNuQixJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsR0FBRyx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuRixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDLFNBQVM7UUFDbkMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxTQUFTO0lBQ3RDLENBQUM7SUFFTyxvQkFBb0I7UUFFeEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEdBQUcsd0JBQXdCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM5RSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4QixrREFBa0Q7UUFDbEQsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDL0IsQ0FBQztJQWtCTyxnQkFBZ0I7UUFDcEIsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUU7WUFDckYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBTyxFQUFFLEtBQWEsRUFBRSxFQUFFO2dCQUN0RCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUN6RCxPQUFPO2dCQUNQLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUU7b0JBQzNCLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxHQUFHLHdCQUF3QixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDO29CQUMvRixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7aUJBQzdGO1lBQ0wsQ0FBQyxDQUFDLENBQUM7U0FDTjtJQUNMLENBQUM7SUFTRCxlQUFlO0lBQ1AsZUFBZTtRQUNuQixNQUFNLEdBQUcsR0FBZSxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsR0FBRyx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzRywyQkFBMkI7UUFDM0IsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQU8sRUFBRSxFQUFFO1lBQ3BCLE1BQU0sS0FBSyxHQUFXLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUMvRSxxQ0FBcUM7WUFDckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFO1lBQzNCLE1BQU0sV0FBVyxHQUFRLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUMvQyxNQUFNLFNBQVMsR0FBZSx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDM0UsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNyRCxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFFckQsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQU8sRUFBRSxFQUFFO2dCQUMxQixNQUFNLEtBQUssR0FBVyxFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0JBQy9FLHFDQUFxQztnQkFDckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztZQUMvQyxDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN6RDtRQUNELElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRCxxQ0FBcUM7SUFDN0IsbUJBQW1CLENBQUMsTUFBZTtRQUN2QyxNQUFNLElBQUksR0FBUSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztRQUNyQyxJQUFJLE1BQU0sRUFBRTtZQUNSLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBQ2pELElBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDMUQ7YUFBTTtZQUNILElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3BELElBQUksQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDeEM7SUFDTCxDQUFDO0lBRU8sZ0JBQWdCLENBQUMsRUFBTztRQUM1QixJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ0wsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFDRCxNQUFNLE9BQU8sR0FBa0IsQ0FBQyxnQkFBZ0IsRUFBRSxrQkFBa0IsRUFBRSxvQkFBb0I7WUFDdEYsd0JBQXdCLEVBQUUseUJBQXlCLENBQUMsQ0FBQztRQUN6RCxLQUFLLE1BQU0sU0FBUyxJQUFJLE9BQU8sRUFBRTtZQUM3QixJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxTQUFTLENBQUMsRUFBRTtnQkFDekMsT0FBTyxLQUFLLENBQUM7YUFDaEI7U0FDSjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxVQUFVO0lBQ0YsY0FBYztRQUNsQixNQUFNLG9CQUFvQixHQUFRLElBQUksQ0FBQyxVQUFVLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWpILE9BQU8sb0JBQW9CLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQzFFLENBQUM7SUFFTyxXQUFXLENBQUMsS0FBZTtRQUMvQixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDNUYsQ0FBQztJQUVPLFdBQVcsQ0FBQyxLQUFlO1FBQy9CLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM1RixDQUFDOztBQTVoQkQ7O0dBRUc7QUFDb0IsMkNBQWtCLEdBQVksa0JBQWtCLENBQUM7QUFDeEU7OztHQUdHO0FBQ29CLHlDQUFnQixHQUFXLEVBQUUsQ0FBQzs7WUFaeEQsU0FBUyxTQUFFO2dCQUNSLFFBQVEsRUFBRSwyQkFBMkI7YUFDeEM7OztZQWxDd0IsZ0JBQWdCO1lBTnZDLFNBQVM7WUFQVCxVQUFVO1lBSVYsTUFBTTtZQVVDLFVBQVU7WUFYakIsZUFBZTtZQWNSLHVCQUF1Qjs0Q0ErRWYsTUFBTSxTQUFDLFFBQVEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIERpcmVjdGl2ZSxcclxuICBEb0NoZWNrLFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgSXRlcmFibGVDaGFuZ2VzLFxyXG4gIEl0ZXJhYmxlRGlmZmVyLFxyXG4gIEl0ZXJhYmxlRGlmZmVycyxcclxuICBOZ1pvbmUsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uSW5pdCxcclxuICBSZW5kZXJlcjIsXHJcbiAgSW5qZWN0XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBUaVRhYmxlQ29sdW1ucywgVGlUYWJsZUNvbXBvbmVudCB9IGZyb20gJy4vVGlUYWJsZUNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFRpUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9yZW5kZXJlci9UaVJlbmRlcmVyJztcclxuaW1wb3J0IHsgVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL1V0aWwnO1xyXG5cclxuaW1wb3J0IHsgVGlUYWJsZUZpeGVkSGVhZFNlcnZpY2UgfSBmcm9tICcuL1RpVGFibGVGaXhlZEhlYWRTZXJ2aWNlJztcclxuXHJcbi8qKlxyXG4gKiBAaWdub3JlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJlc2l6YWJsZU9wdHMge1xyXG4gICAgdGFibGU6IGFueTtcclxuICAgIHRoczogQXJyYXk8YW55PjtcclxuICAgIHdyYXA6IGFueTsgLy8g5YyF6KO56KGo5qC855qE54i25a655Zmo77yM5ouW5Yqo6KGo5qC86LaF6L+H54i25a655Zmo5pe25Ye65rua5Yqo5p2hXHJcbiAgICBtb3VzZVhQb3NpdGlvbjogbnVtYmVyOyAvLyDlhYnmoIfkvY3nva7vvIzliJfmi5bliqjml7bkvb/nlKhcclxuICAgIHRhcmdldDogYW55OyAvLyDmi5bliqjnmoTlvZPliY3liJdcclxuICAgIHN0b3JlZFNpemVzOiBBcnJheTxudW1iZXI+OyAvLyDnlKjmnaXlrp7ml7bkv53lrZjlkITliJflrr3luqZcclxuICAgIHN0b3JlZFNvcnRFbGVTaXplczogQXJyYXk8bnVtYmVyPjsgLy8g55So5p2l5L+d5a2Y5ZCE5YiXc29ydOWFg+e0oOeahOWuveW6pixcclxuICAgIHN0b3JlVGFibGVXaWR0aENoYW5nZTogbnVtYmVyO1xyXG4gICAgc2Vjb25kVGFibGU/OiBhbnk7XHJcbiAgICBzZWNvbmRUaHM/OiBBcnJheTxhbnk+O1xyXG4gICAgeFNjcm9sbFN0YXRlPzogYm9vbGVhbjtcclxuICAgIHlTY3JvbGxTdGF0ZT86IGJvb2xlYW47XHJcbiAgICBpc1lPdmVyZmxvd2VkV2l0aFg/OiBib29sZWFuOyAvLyDooajlpLTplIHlrprml7Ys5YiX5ouW5Yqo6L+H56iL5Lit5qiq5ZCR5rua5Yqo5p2h55qE5Ye6546w5a+86Ie057q15ZCR5rua5Yqo5p2h5Ye6546w55qE5qCH5b+X5L2NXHJcbn1cclxuLyoqXHJcbiAqIFRpQ29sc1Jlc2l6YWJsZSDooajmoLzliJfmi5bliqjmjIfku6RcclxuICpcclxuICog5pSv5oyB5ouW5Yqo6KGo5qC85YiX5p2l6LCD5pW05ZCE5YiX5a695bqm44CCXHJcbiAqXHJcbiAqIOWcqHRpLXRhYmxl5qCH562+5LiK5Yqg5LqGdGlDb2xzUmVzaXphYmxl5bGe5oCn77yM5YiZ6KGo5qC86Ieq5Yqo5YW35pyJ5YiX5ouW5Yqo5Yqf6IO977ybXHJcbiAqIOWQjOaXtui/mOmcgOimgeWvuXRhYmxl5YWD57Sg5YyF6KO554i25a655ZmoZGl277yM5bm25a+554i25a655Zmo6K6+572uIHRpMy1yZXNpemUtd3JhcHBlcuagt+W8j+exu+OAglxyXG4gKi9cclxuQERpcmVjdGl2ZSAoe1xyXG4gICAgc2VsZWN0b3I6ICd0aS10YWJsZVt0aUNvbHNSZXNpemFibGVdJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgVGlDb2xzUmVzaXphYmxlRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBEb0NoZWNrLCBPbkRlc3Ryb3kge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgVU5TRUxFQ1RBQkxFX0NMQVNTOiBzdHJpbmcgPSAgJ3RpMy11bnNlbGVjdGFibGUnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDnp7vliLDooajlpLTog73lpJ/mmL7npLrmi5bliqjnur/nmoTmhJ/lupTojIPlm7RcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBDT0xfQk9SREVSX1JBTkdFOiBudW1iZXIgPSAxMDtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVhZG9ubHkgbm90UmVzaXphYmxlQXR0cjogc3RyaW5nID0gJ25vdC1yZXNpemFibGUnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZXNpemFibGVPcHRzOiBSZXNpemFibGVPcHRzID0ge1xyXG4gICAgICAgIHRhYmxlOiBudWxsLFxyXG4gICAgICAgIHRoczogbnVsbCxcclxuICAgICAgICB3cmFwOiBudWxsLFxyXG4gICAgICAgIG1vdXNlWFBvc2l0aW9uOiAwLFxyXG4gICAgICAgIHRhcmdldDogbnVsbCxcclxuICAgICAgICBzdG9yZWRTaXplczogW10sXHJcbiAgICAgICAgc3RvcmVkU29ydEVsZVNpemVzOiBbXSxcclxuICAgICAgICBzdG9yZVRhYmxlV2lkdGhDaGFuZ2U6IDAsXHJcbiAgICAgICAgaXNZT3ZlcmZsb3dlZFdpdGhYOiBmYWxzZVxyXG4gICAgfTsgLy8g5Yid5aeL5YyW5YiX5ouW5Yqo5bGe5oCn55qE6YWN572u6aG5XHJcbiAgICBwcml2YXRlIGhvc3RFbGU6IEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGRvY3VtZW50TW91c2VNb3ZlTGlzdGVuZXI6ICgpID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIGRvY3VtZW50TW91c2VVcExpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSB3aW5kb3dSZXNpemVMaXN0ZW5lcjogKCkgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgaXNEcmFnU3RhcnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgY29sdW1zRGlmZmVyOiBJdGVyYWJsZURpZmZlcjxPYmplY3Q+O1xyXG4gICAgcHJpdmF0ZSBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgaXNDb2x1bW5zSW5pdDogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGlzZmlyc3RZU2Nyb2xsU3RhdGVDaGFuZ2U6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0YWJsZUNvbTogVGlUYWJsZUNvbXBvbmVudDtcclxuICAgIGNvbnN0cnVjdG9yKHRhYmxlQ29tOiBUaVRhYmxlQ29tcG9uZW50LCBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgICAgICAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgem9uZTogTmdab25lLCBwcml2YXRlIHRpUmVuZGVyZXI6IFRpUmVuZGVyZXIsXHJcbiAgICAgICAgICAgICAgICBwcml2YXRlIGl0ZXJhYmxlRGlmZmVyczogSXRlcmFibGVEaWZmZXJzLFxyXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBmaXhlZEhlYWRTZXJ2aWNlOiBUaVRhYmxlRml4ZWRIZWFkU2VydmljZSxcclxuICAgICAgICAgICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQpIHtcclxuICAgICAgICB0aGlzLmhvc3RFbGUgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB0aGlzLnRhYmxlQ29tID0gdGFibGVDb207XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2V0VGhzKHRhYmxlOiBFbGVtZW50KTogQXJyYXk8RWxlbWVudD4ge1xyXG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRhYmxlLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBnZXRXaWR0aChlbGVtZW50OiBhbnkpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGhcclxuICAgICAgICAgICAgLnRvRml4ZWQoMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIHRyYWNrQnlGbihpbmRleDogbnVtYmVyLCBpdGVtOiB7c2hvdz86IGJvb2xlYW59KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGl0ZW0uc2hvdztcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IHRoaXMudGFibGVDb20udmlld0luaXRTdWJqZWN0LnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0NvbHNSZXNpemFibGUoKTtcclxuICAgICAgICAgICAgdGhpcy5pc0NvbHVtbnNJbml0ID0gZmFsc2U7IC8vIOS4u+imgeWkhOeQhiBjb2x1bW5zIOWIneWni+S4uuepuu+8jOW8guatpeeahOWcuuaZr1xyXG4gICAgICAgICAgICAvLyDooajmoLzorrDlv4ZcclxuICAgICAgICAgICAgLy8g54mI5pys5pu05paw5ZCO55So5oi356ys5LiA5qyh6K6/6Zeu77yMbG9jYWxTdG9yYWdlU3RhdGVbJ2NvbHNXaWR0aCdd5LiN5a2Y5ZyoXHJcbiAgICAgICAgICAgIC8vIOS/ruWkjVNTUumUmeivr++8mkVSUk9SIFR5cGVFcnJvcjogQ2Fubm90IHJlYWQgcHJvcGVydHkgJ2NvbHNXaWR0aCcgb2YgdW5kZWZpbmVkIFxyXG4gICAgICAgICAgICBpZiAodGhpcy50YWJsZUNvbS5zdG9yYWdlSWQgJiYgdGhpcy50YWJsZUNvbS5zdG9yYWdlQ29uZmlnICYmIHRoaXMudGFibGVDb20uc3RvcmFnZUNvbmZpZy5jb2xzV2lkdGhcclxuICAgICAgICAgICAgICAgICYmIHRoaXMudGFibGVDb20ubG9jYWxTdG9yYWdlU3RhdGUgJiYgdGhpcy50YWJsZUNvbS5sb2NhbFN0b3JhZ2VTdGF0ZVsnY29sc1dpZHRoJ10pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFN0b3JhZ2VDb2xzV2lkdGgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmNvbHVtc0RpZmZlciA9IHRoaXMuaXRlcmFibGVEaWZmZXJzLmZpbmQodGhpcy50YWJsZUNvbS5jb2x1bW5zKVxyXG4gICAgICAgICAgICAuY3JlYXRlKFRpQ29sc1Jlc2l6YWJsZURpcmVjdGl2ZS50cmFja0J5Rm4pO1xyXG4gICAgfVxyXG5cclxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBjb2x1bXNEaWZmZXI6IEl0ZXJhYmxlQ2hhbmdlczxUaVRhYmxlQ29sdW1ucz4gPSB0aGlzLmNvbHVtc0RpZmZlci5kaWZmKHRoaXMudGFibGVDb20uY29sdW1ucyk7XHJcbiAgICAgICAgaWYgKGNvbHVtc0RpZmZlcikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0NvbHVtbnNJbml0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ29sdW1uc0luaXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RGVmYXVsdFdpZHRoKCk7XHJcbiAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRNb3VzZU1vdmVMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50TW91c2VNb3ZlTGlzdGVuZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRNb3VzZVVwTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudE1vdXNlVXBMaXN0ZW5lcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy53aW5kb3dSZXNpemVMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZUxpc3RlbmVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcHJvY2Vzc0NvbHNSZXNpemFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zZXRUYWJsZVdpZHRoQ2hhbmdlKCk7XHJcbiAgICAgICAgY29uc3QgdGFibGU6IGFueSA9IHRoaXMucmVzaXphYmxlT3B0cy50YWJsZSA9IHRoaXMuZ2V0VGFibGUoKTtcclxuICAgICAgICBjb25zdCB0aGVhZDogYW55ID0gdGFibGUuY2hpbGRyZW5bMF07XHJcbiAgICAgICAgaWYgKHRoaXMudGFibGVDb20uaXNGaXhlZEhlYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNpemFibGVPcHRzLnNlY29uZFRhYmxlID0gdGhpcy5nZXRTZWNvbmRUYWJsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueFNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWCgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueVNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWSgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMudGhzID0gVGlDb2xzUmVzaXphYmxlRGlyZWN0aXZlLmdldFRocyh0YWJsZSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVzaXphYmxlT3B0cy5zZWNvbmRUaHMgPSBUaUNvbHNSZXNpemFibGVEaXJlY3RpdmUuZ2V0VGhzKHRoaXMucmVzaXphYmxlT3B0cy5zZWNvbmRUYWJsZSk7XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVDb20ucHJvY2Vzc1lTY3JvbGxTdGF0ZUNoYW5nZVdpdGhDb2xzUmVzaXphYmxlID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXhlZEhlYWRTZXJ2aWNlLnByb2Nlc3NZU2Nyb2xsU3RhdGVDaGFuZ2UodGhpcyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7IC8vIOmBv+WFjeS4jeWBnOinpuWPkeWPmOWMluajgOa1i1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGVhZCwgJ21vdXNlbW92ZScsIChldmVudDogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRoOiBhbnkgPSBldmVudC50YXJnZXQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUaFsnbm9kZU5hbWUnXSAhPT0gJ1RIJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyDojrflj5blvZPliY10aOi3nemhtemdouaWh+aho+eahGxlZnTlgLxcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlZnQ6IG51bWJlciA9IGN1cnJlbnRUaFsnZ2V0Qm91bmRpbmdDbGllbnRSZWN0J10oKS5sZWZ0ICsgdGhpcy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRoV2lkdGg6IG51bWJlciA9IGN1cnJlbnRUaFsnZ2V0Qm91bmRpbmdDbGllbnRSZWN0J10oKS53aWR0aDtcclxuICAgICAgICAgICAgICAgIC8vIOWIpOaWreWFieagh+aYr+WQpuiQveWcqHRo55qE5Y+z6L6557yYXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc09uQ29sQm9yZGVyOiBib29sZWFuID0gTWF0aC5hYnMoZXZlbnQucGFnZVggLSBNYXRoLnJvdW5kKGxlZnQgKyB0aFdpZHRoKSkgPD1cclxuICAgICAgICAgICAgICAgICAgICBUaUNvbHNSZXNpemFibGVEaXJlY3RpdmUuQ09MX0JPUkRFUl9SQU5HRTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNPbkNvbEJvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXRbJ2hhc0F0dHJpYnV0ZSddKHRoaXMubm90UmVzaXphYmxlQXR0cikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xhc3RDb2x1bW4oY3VycmVudFRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRGl2aWRpbmdMaW5lKGN1cnJlbnRUaCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRGl2aWRpbmdMaW5lKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGVhZCwgJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZURpdmlkaW5nTGluZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhlYWQsICdtb3VzZWRvd24nLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRUaDogYW55ID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGlSZW5kZXJlci5oYXNDbGFzcyhjdXJyZW50VGgsICdjb2wtcmVzaXplLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RyYWdTdGFydCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6byg5qCH54K55Ye755qE5b2T5YmN5YiXXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemFibGVPcHRzLnRhcmdldCA9IGN1cnJlbnRUaDtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmm7TmlrDlhYnmoIfkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMubW91c2VYUG9zaXRpb24gPSBldmVudC5wYWdlWDtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlnKjmi5bliqjliY3ojrflj5blvZPliY3ooajmoLzmnIDmlrDnmoTliJfkv6Hmga/jgIHlrr3luqbvvIzlvojlhbPplK7vvIzkvb/lvpforr7nva7lrr3luqbkuI7moLflvI/lrp7pmYXlrr3luqbkuIDnm7RcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhYmxlSW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOe7memhtemdouiuvue9ruS4jeWPr+mAieagt+W8j++8jOmBv+WFjeaLluWKqOaXtumhtemdouaIluihqOagvOWGhemDqOWHuueOsOiiq+mAieS4reeahOiTneiJsuWMuuWfn1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlVGV4dFNlbGVjdGlvbih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YWJsZUNvbS5pc0ZpeGVkSGVhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXphYmxlT3B0cy54U2Nyb2xsU3RhdGUgPSB0aGlzLm92ZXJmbG93ZWRYKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemFibGVPcHRzLnlTY3JvbGxTdGF0ZSA9IHRoaXMub3ZlcmZsb3dlZFkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0YWJsZUNvbnRhaW5lcjogYW55ID0gdGhpcy50aVJlbmRlcmVyLmZpbmRDaGlsZHJlbkJ5Q2xhc3NOYW1lKHRoaXMuaG9zdEVsZSwgJ3RpMy1yZXNpemUtd3JhcHBlcicpWzBdO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMudGlSZW5kZXJlci5oYXNDbGFzcyh0YWJsZUNvbnRhaW5lciwgJ3RpMy10YWJsZS1jb250YWluZXInKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGFibGVDb250YWluZXIsICdzY3JvbGwnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgVXRpbC50cmlnZ2VyKHRoaXMuZG9jdW1lbnQsICd0aVNjcm9sbCcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRNb3VzZU1vdmVMaXN0ZW5lciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZG9jdW1lbnQsICdtb3VzZW1vdmUnLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIOWIl+aLluWKqOeahOWKqOS9nOW6lOivpeaYr+WFiG1vdXNlZG93bu+8jOeEtuWQjm1vdXNlbW92Ze+8jOWboOatpOWFiOWIpOaWreaYr+WQpuW3sue7j+inpuWPkeS6hm1vdXNlZG93blxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRHJhZ1N0YXJ0IHx8IHRoaXMucmVzaXphYmxlT3B0cy5tb3VzZVhQb3NpdGlvbiA9PT0gMCB8fCAhdGhpcy5yZXNpemFibGVPcHRzLnRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlTW92ZShldmVudCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50TW91c2VVcExpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5kb2N1bWVudCwgJ21vdXNldXAnLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0RyYWdTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVRleHRTZWxlY3Rpb24oZmFsc2UpOyAvLyDmgaLlpI3pobXpnaLlj6/pgInmoLflvI9cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcFJlc2l6ZSgpOyAvLyDkv53lrZjmnIDmlrDlrr3luqbliLDmtY/op4jlmajkuK1cclxuICAgICAgICAgICAgICAgIHRoaXMuaXNEcmFnU3RhcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyDkv67lpI1TU1LmiqXplJnvvJpFUlJPUiBSZWZlcmVuY2VFcnJvcjogd2luZG93IGlzIG5vdCBkZWZpbmVkXHJcbiAgICAgICAgICAgIGlmKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZUxpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4od2luZG93LCAncmVzaXplJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUYWJsZVdpZHRoQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW91c2VNb3ZlKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uczogUmVzaXphYmxlT3B0cyA9IHRoaXMucmVzaXphYmxlT3B0cztcclxuICAgICAgICBjb25zdCBsYXN0Q29sSW5kZXg6IG51bWJlciA9IG9wdGlvbnMudGhzLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgY29uc3QgY3VyQ29sSW5kZXg6IG51bWJlciA9IHBhcnNlSW50KG9wdGlvbnMudGFyZ2V0LmdldEF0dHJpYnV0ZSgndGktdmlzaWJsZS1pbmRleCcpLCAxMCk7XHJcbiAgICAgICAgY29uc3QgY29sV2lkdGg6IG51bWJlciA9IG9wdGlvbnMuc3RvcmVkU2l6ZXNbY3VyQ29sSW5kZXhdO1xyXG4gICAgICAgIGNvbnN0IGxlZnRFZGdlOiBudW1iZXIgPSBwYXJzZUZsb2F0KChldmVudC5wYWdlWCAtIG9wdGlvbnMubW91c2VYUG9zaXRpb24pLnRvRml4ZWQoMSkpO1xyXG4gICAgICAgIGNvbnN0IG1pbldpZHRoOiBudW1iZXIgPSB0aGlzLmdldENvbE1pbldpZHRoKG9wdGlvbnMudGFyZ2V0KTtcclxuXHJcbiAgICAgICAgLy8g5b2T5ouW5ou95pa55ZCR5Li65YiX5a695bqm5YeP5bCP55qE5pa55ZCR5LiU5YiX5a695bey6L6+5Yiw5paH5pys5Yy65pyA5bCP5a695bqm5pe26Zi75q2i5ouW5YqoXHJcbiAgICAgICAgaWYgKChsZWZ0RWRnZSA+PSAwKSB8fCAoY29sV2lkdGggKyBsZWZ0RWRnZSA+IE1hdGguY2VpbChtaW5XaWR0aCkpKSB7XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOaLluWKqOWIl+WuveW6plxyXG4gICAgICAgICAgICBvcHRpb25zLnN0b3JlZFNpemVzW2N1ckNvbEluZGV4XSArPSBsZWZ0RWRnZTtcclxuICAgICAgICAgICAgdGhpcy5zZXRXaWR0aChvcHRpb25zLnRhcmdldCwgb3B0aW9ucy5zdG9yZWRTaXplc1tjdXJDb2xJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgLy8g5a+55pyA5ZCO5LiA5YiX55qE5YiX5a6955qE5pW05L2T5aSE55CG5pa55qGI77yaXHJcbiAgICAgICAgICAgIC8vIOWmguaenOabtOaWsOaLluWKqOWIl+WuveW6puWQjueahOihqOagvOeahOaAu+WuveW6puWwj+S6juihqOagvOWIneWni+WuveW6pu+8jOWImeWwhuWuveW6puW3ruihpeWBv+WIsOacgOWQjuS4gOWIlztcclxuICAgICAgICAgICAgLy8g5aaC5p6c5pu05paw5ouW5Yqo5YiX5a695bqm5ZCO55qE6KGo5qC855qE5oC75a695bqm5aSn5LqO6KGo5qC85Yid5aeL5a695bqm77yM5LiU5LmL5YmN5pyA5ZCO5LiA5YiX5YiX5a695pyJ6KGl5YG/5pe277yMXHJcbiAgICAgICAgICAgIC8vIOWwhuacgOWQjuS4gOWIl+eahOihpeWBv+WFiOaKtea2iOaOie+8jOeEtuWQjuaciei2heWHuuaXtuWGjeWHuua7muWKqOadoVxyXG5cclxuICAgICAgICAgICAgLy8gczogc3RvcmVUYWJsZVdpZHRoQ2hhbmdlKOatpOasoeaLluWKqOWJjeWQhOWIl+aLluWKqOWAvOeahOe0r+iuoeWSjClcclxuICAgICAgICAgICAgLy8gYjog5q2k5qyh5ouW5Yqo5YmN57uZ5pyr5YiX55qE6KGl5YG/5YC8XHJcbiAgICAgICAgICAgIC8vIGw6IGxlZnRFZGdlKOatpOasoeaLluWKqOeahOi3neemuylcclxuICAgICAgICAgICAgLy8gICBzICAgICAgbCAgICAgICAgcyArIGwgICAgICAgYiAgICAgICDmraTmrKHmi5bliqjlkI7lr7nmnKvliJflrr3nmoTorr7nva5cclxuICAgICAgICAgICAgLy8gIC01ICAgICAtMSAgICAgICAtNiA8IDAgICAgICArNSAgICAgICAgICArMSgtbGVmdEVkZ2UpXHJcbiAgICAgICAgICAgIC8vICAtNSAgICAgKzMgICAgICAgLTIgPCAwICAgICAgKzUgICAgICAgICAgLTMoLWxlZnRFZGdlKVxyXG4gICAgICAgICAgICAvLyAgKzUgICAgIC04ICAgICAgIC0zIDwgMCAgICAgICAwICAgICAgICAgICszKC0oc3RvcmVDb2xzV2lkdGhDaGFuZ2UrbGVmdEVkZ2UpKVxyXG4gICAgICAgICAgICAvLyAgLTUgICAgICs4ICAgICAgICAzID4gMCAgICAgICs1ICAgICAgICAgIC01KCtzdG9yZUNvbHNXaWR0aENoYW5nZSlcclxuICAgICAgICAgICAgLy8gICs1ICAgICArMyAgICAgICAgOCA+IDAgICAgICAgMCAgICAgICAgICArMCjkuI3lgZrlpITnkIYpXHJcbiAgICAgICAgICAgIC8vICArNSAgICAgLTMgICAgICAgIDIgPiAwICAgICAgIDAgICAgICAgICAgKzAo5LiN5YGa5aSE55CGKVxyXG4gICAgICAgICAgICBpZiAobGVmdEVkZ2UgKyBvcHRpb25zLnN0b3JlVGFibGVXaWR0aENoYW5nZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0b3JlVGFibGVXaWR0aENoYW5nZSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnN0b3JlZFNpemVzW2xhc3RDb2xJbmRleF0gLT0gbGVmdEVkZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc3RvcmVkU2l6ZXNbbGFzdENvbEluZGV4XSAtPSAobGVmdEVkZ2UgKyBvcHRpb25zLnN0b3JlVGFibGVXaWR0aENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdG9yZVRhYmxlV2lkdGhDaGFuZ2UgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zdG9yZWRTaXplc1tsYXN0Q29sSW5kZXhdICs9IG9wdGlvbnMuc3RvcmVUYWJsZVdpZHRoQ2hhbmdlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldFdpZHRoKG9wdGlvbnMudGhzW2xhc3RDb2xJbmRleF0sIG9wdGlvbnMuc3RvcmVkU2l6ZXNbbGFzdENvbEluZGV4XSk7XHJcblxyXG4gICAgICAgICAgICAvLyDmm7TmlrDlkITliJfmi5bliqjnm7jlr7nlgLznmoTntK/orqHlkoxcclxuICAgICAgICAgICAgb3B0aW9ucy5zdG9yZVRhYmxlV2lkdGhDaGFuZ2UgKz0gbGVmdEVkZ2U7XHJcblxyXG4gICAgICAgICAgICAvLyDooajlpLTplIHlrppcclxuICAgICAgICAgICAgaWYgKHRoaXMudGFibGVDb20uaXNGaXhlZEhlYWQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDmm7TmlrDnrKzkuozkuKrooajmoLzvvIhib2R5VGFibGXvvInkuK3nmoTlvZPliY3liJflkozmnIDlkI7kuIDliJfnmoTlrr3luqZcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0V2lkdGgob3B0aW9ucy5zZWNvbmRUaHNbY3VyQ29sSW5kZXhdLCBvcHRpb25zLnN0b3JlZFNpemVzW2N1ckNvbEluZGV4XSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFdpZHRoKG9wdGlvbnMuc2Vjb25kVGhzW29wdGlvbnMuc2Vjb25kVGhzLmxlbmd0aCAtIDFdLCBvcHRpb25zLnN0b3JlZFNpemVzW2xhc3RDb2xJbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRIZWFkU2VydmljZS5oYW5kbGVZTm90T3ZlcmZsb3dlZFdpdGhYKHRoaXMucmVzaXphYmxlT3B0cywgdGhpcy50YWJsZUNvbS50Ym9keUNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8g5b2T5qiq5ZCR5rua5Yqo5p2h5Ye6546w5a+86Ie057q15ZCR5rua5Yqo5p2h5Ye6546w5pe25a+56LSm5pys5YGa5aSE55CGXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpeGVkSGVhZFNlcnZpY2UuaGFuZGxlWU92ZXJmbG93ZWRXaXRoWCh0aGlzLnJlc2l6YWJsZU9wdHMsIHRoaXMudGFibGVDb20udGJvZHlDb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIOe6teWQkea7muWKqOadoeeKtuaAgeWPmOWMluaXtuWvueWbuuWumueahOihqOWktOWPs+i+ueWhq+WFheWdl+eahOWkhOeQhlxyXG4gICAgICAgICAgICAgICAgdGhpcy5maXhlZEhlYWRTZXJ2aWNlLnByb2Nlc3NPdmVyZmxvd1kodGhpcy50YWJsZUNvbS50aGVhZENvbnRhaW5lciwgdGhpcy50YWJsZUNvbS50Ym9keUNvbnRhaW5lciwgdGhpcy50YWJsZUNvbSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRhYmxlQ29tLmZpeGVkQ29sdW1uSW5mby5oYXNGaXhlZENvbHVtbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YWJsZUNvbS50aFJlc2l6ZVN1YmplY3QubmV4dCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGg6IG9wdGlvbnMudGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRFZGdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZU9wdHM6IHRoaXMucmVzaXphYmxlT3B0c1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXI6IGFueSA9IHRoaXMudGFibGVDb20uZml4ZWRDb2x1bW5JbmZvLmNvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3JvbGxMZWZ0OiBudW1iZXIgPSBjb250YWluZXIuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1JpZ2h0Q29sdW1uRmxvYXQ6IGJvb2xlYW4gPSBzY3JvbGxMZWZ0ICsgY29udGFpbmVyLmNsaWVudFdpZHRoIDwgY29udGFpbmVyLnNjcm9sbFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFibGVDb20uY29udGFpbmVyU2Nyb2xsWENoYW5nZVN1YmplY3QubmV4dCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbExlZnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUmlnaHRDb2x1bW5GbG9hdFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDmm7TmlrDlhYnmoIfkvY3nva5cclxuICAgICAgICBvcHRpb25zLm1vdXNlWFBvc2l0aW9uID0gZXZlbnQucGFnZVg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDb2xNaW5XaWR0aCh0aEVsZW1lbnQ6IGFueSk6IG51bWJlciB7XHJcbiAgICAgICAgLy8g5q2k5aSE55qE5YC85pivJy4uLifmiYDljaDlrr3luqbvvIzmlofmnKzljLrnmoTlrr3luqbmnIDlsI/kuLrnnIHnlaXlj7fmiYDljaDlrr3luqbvvJvlvZPlrrnlmajlrr3luqblsI/kuo7mraTlgLzml7bvvIzmlofmnKzkvJrlrozlhajmmL7npLrvvIzkvYbotoXlh7rpg6jliIbkvJrnm7TmjqXooqvmiKrmlq3jgIJcclxuICAgICAgICAvLyBDaHJvbWUg5ZKMIElF5LiL55yB55Wl5Y+3Jy4uLifmiYDljaDlrr3luqblpKfmpoLkuLoxMHB4O1xyXG4gICAgICAgIC8vIEZpcmVmb3gg5LiL5LiN5Lya5Ye6546w5Y+q5pyJJy4uLifnmoTmg4XlhrXvvIzmnIDlsI/kuLrvvJrkuIDkuKrlrZfnrKYgKyAnLi4uJyzlhbbmiYDljaDlrr3luqblpKfmpoLkuLoyOHB4KOS4reaWh+Wtl+espuS4iynvvJtcclxuICAgICAgICAvLyDmraTlpITkuLrkv53or4HkuInkuKrmtY/op4jlmajpg73ooajnjrDmraPluLjvvIzlj5blgLwyOSgyOCArIDEsIDHkuLrnn6vmraPlgY/lt67lgLwp44CCXHJcbiAgICAgICAgbGV0IG1pbldpZHRoOiBudW1iZXIgPSAyOTtcclxuXHJcbiAgICAgICAgbWluV2lkdGggKz0gcGFyc2VGbG9hdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aEVsZW1lbnQpLnBhZGRpbmdMZWZ0KSArXHJcbiAgICAgICAgICAgIHBhcnNlRmxvYXQod2luZG93LmdldENvbXB1dGVkU3R5bGUodGhFbGVtZW50KS5wYWRkaW5nUmlnaHQpO1xyXG4gICAgICAgIGNvbnN0IHNvcnRFbGU6IGFueSA9IHRoaXMudGlSZW5kZXJlci5maW5kQ2hpbGRyZW5CeUNsYXNzTmFtZSh0aEVsZW1lbnQsICd0aTMtc29ydC1jb250YWluZXInKVswXTtcclxuICAgICAgICBjb25zdCBpY29uc0VsZTogYW55ID0gdGhpcy50aVJlbmRlcmVyLmZpbmRDaGlsZHJlbkJ5Q2xhc3NOYW1lKHRoRWxlbWVudCwgJ3RpMy1jZWxsLWljb25zLWNvbnRhaW5lcicpWzBdO1xyXG4gICAgICAgIGNvbnN0IGhlYWRGaWx0ZXJFbGU6IGFueSA9IHRoaXMudGlSZW5kZXJlci5maW5kQ2hpbGRyZW5CeUNsYXNzTmFtZSh0aEVsZW1lbnQsICd0aTMtaGVhZC1maWx0ZXItY29udGFpbmVyJylbMF07XHJcblxyXG4gICAgICAgIGlmIChzb3J0RWxlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNvcnRXaWR0aDogbnVtYmVyID0gcGFyc2VGbG9hdChzb3J0RWxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXHJcbiAgICAgICAgICAgICAgICAudG9GaXhlZCgxKSk7XHJcbiAgICAgICAgICAgIG1pbldpZHRoICs9IHNvcnRXaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpY29uc0VsZSkge1xyXG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJXaWR0aDogbnVtYmVyID0gcGFyc2VGbG9hdChpY29uc0VsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aFxyXG4gICAgICAgICAgICAgICAgLnRvRml4ZWQoMSkpO1xyXG4gICAgICAgICAgICBtaW5XaWR0aCArPSBmaWx0ZXJXaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoZWFkRmlsdGVyRWxlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRGaWx0ZXJXaWR0aDogbnVtYmVyID0gcGFyc2VGbG9hdChoZWFkRmlsdGVyRWxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXHJcbiAgICAgICAgICAgICAgICAudG9GaXhlZCgxKSk7XHJcbiAgICAgICAgICAgIG1pbldpZHRoICs9IGhlYWRGaWx0ZXJXaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBtaW5XaWR0aDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFRhYmxlV2lkdGhDaGFuZ2UoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgdGFibGVDb250YWluZXI6IGFueSA9IHRoaXMudGlSZW5kZXJlci5maW5kQ2hpbGRyZW5CeUNsYXNzTmFtZSh0aGlzLmhvc3RFbGUsICd0aTMtcmVzaXplLXdyYXBwZXInKVswXTtcclxuICAgICAgICAvLyDooajmoLzlrrnlmajoh6rouqvlrr3luqbvvIjkuI3ljIXmi6xZ5pa55ZCR5rua5Yqo5p2h55qE5a695bqm77yJXHJcbiAgICAgICAgY29uc3QgY2xpZW50V2lkdGg6IG51bWJlciA9IHRhYmxlQ29udGFpbmVyID8gdGFibGVDb250YWluZXJbJ2NsaWVudFdpZHRoJ10gOiAwO1xyXG4gICAgICAgIC8vIOihqOagvOWuueWZqOWunumZheWGheWuueWMuuWfn+WuveW6plxyXG4gICAgICAgIGNvbnN0IHNjcm9sbFdpZHRoOiBudW1iZXIgPSB0YWJsZUNvbnRhaW5lciA/IHRhYmxlQ29udGFpbmVyWydzY3JvbGxXaWR0aCddIDogMDtcclxuXHJcbiAgICAgICAgLy8gcmVzaXphYmxlT3B0cy5zdG9yZUNvbHNXaWR0aENoYW5nZeS4uuWQhOWIl+aLluWKqOebuOWvueWAvOeahOe0r+iuoeWSjFxyXG4gICAgICAgIC8vIOWwhuihqOagvOWGheWuuea6ouWHuumDqOWIhueahOWuveW6pui1i+e7meWQhOWIl+aLluWKqOebuOWvueWAvOeahOe0r+iuoeWSjFxyXG4gICAgICAgIHRoaXMucmVzaXphYmxlT3B0cy5zdG9yZVRhYmxlV2lkdGhDaGFuZ2UgPSBzY3JvbGxXaWR0aCAtIGNsaWVudFdpZHRoO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RvcFJlc2l6ZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVN0b3JlZFNpemVzKCk7XHJcbiAgICAgICAgdGhpcy5yZXNpemFibGVPcHRzLm1vdXNlWFBvc2l0aW9uID0gMDtcclxuICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy50YWJsZUNvbS5pc0ZpeGVkSGVhZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueFNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWCgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueVNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFRhYmxlKCk6IGFueSB7XHJcbiAgICAgICAgLy8g55So5oi357uZdGFibGXlhYPntKDliqDniLblrrnlmajvvIzpgJrov4fniLblrrnlmajorr7nva5vdmVyZmxvd+WxnuaAp1xyXG4gICAgICAgIGNvbnN0IHRhYmxlQ29udGFpbmVyQ2xhc3NOYW1lOiBzdHJpbmcgPSB0aGlzLnRhYmxlQ29tLmlzRml4ZWRIZWFkID8gJ3RpMy10YWJsZS1maXhlZC1oZWFkJyA6ICd0aTMtcmVzaXplLXdyYXBwZXInO1xyXG4gICAgICAgIGNvbnN0IHRhYmxlQ29udGFpbmVyOiBhbnkgPSB0aGlzLnRpUmVuZGVyZXIuZmluZENoaWxkcmVuQnlDbGFzc05hbWUodGhpcy5ob3N0RWxlLCB0YWJsZUNvbnRhaW5lckNsYXNzTmFtZSlbMF07XHJcbiAgICAgICAgY29uc3QgdGFibGU6IGFueSA9IHRhYmxlQ29udGFpbmVyLmNoaWxkcmVuWzBdLm5vZGVOYW1lID09PSAnVEFCTEUnID8gdGFibGVDb250YWluZXIuY2hpbGRyZW5bMF0gOiBudWxsO1xyXG5cclxuICAgICAgICByZXR1cm4gdGFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpc0xhc3RDb2x1bW4odGg6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHBhcmVudEVsZW1lbnQ6IGFueSA9IHRoLnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKCFwYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0aHM6IGFueSA9IHRoLnBhcmVudEVsZW1lbnQuY2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IEFycmF5LmZyb20odGhzKVxyXG4gICAgICAgICAgICAuaW5kZXhPZih0aCk7XHJcblxyXG4gICAgICAgIHJldHVybiBpbmRleCA9PT0gdGhzLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5b2T5YWJ5qCH56e75Yiw5oSf5bqU5Yy65pe277yM5Ye6546w5ouW5Yqo5YiG5Ymy57q/XHJcbiAgICBwcml2YXRlIGNyZWF0ZURpdmlkaW5nTGluZSh0aDogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aCwgJ2NvbC1yZXNpemUtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGluZGV4OiBudW1iZXIgPSBBcnJheS5mcm9tKHRoLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4pXHJcbiAgICAgICAgICAgIC5pbmRleE9mKHRoKTtcclxuICAgICAgICBjb25zdCBib2R5VGFibGU6IGFueSA9IHRoaXMudGFibGVDb20uaXNGaXhlZEhlYWQgPyB0aGlzLnJlc2l6YWJsZU9wdHMuc2Vjb25kVGFibGUgOiB0aGlzLnJlc2l6YWJsZU9wdHMudGFibGU7XHJcbiAgICAgICAgLy8g6Ziy5q2i5LiN5a2Y5ZyodGJvZHnnmoTlnLrmma/miqXplJlcclxuICAgICAgICBpZighYm9keVRhYmxlLmNoaWxkcmVuWzFdKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0cnM6IEFycmF5PGFueT4gPSBBcnJheS5mcm9tKGJvZHlUYWJsZS5jaGlsZHJlblsxXS5jaGlsZHJlbilcclxuICAgICAgICAgICAgLmZpbHRlcigodHI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubmVlZERpdmlkaW5nTGluZSh0cik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdHJzLmZvckVhY2goKHRyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8g5YiG57uE5Zy65pmvaW5kZXgg5aSn5LqOdHIuY2hpbGRyZW4ubGVuZ3RoXHJcbiAgICAgICAgICAgIGlmICghdHIuY2hpbGRyZW5baW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0ci5jaGlsZHJlbltpbmRleF0sICdjb2wtcmVzaXplLWFjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOW9k+WFieagh+emu+W8gOaEn+W6lOWMuuaXtu+8jOaLluWKqOWIhuWJsue6v+a2iOWksVxyXG4gICAgcHJpdmF0ZSByZW1vdmVEaXZpZGluZ0xpbmUoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgYm9keVRhYmxlOiBhbnkgPSB0aGlzLnRhYmxlQ29tLmlzRml4ZWRIZWFkID8gdGhpcy5yZXNpemFibGVPcHRzLnNlY29uZFRhYmxlIDogdGhpcy5yZXNpemFibGVPcHRzLnRhYmxlO1xyXG4gICAgICAgIGNvbnN0IHRoczogQXJyYXk8YW55PiA9IEFycmF5LmZyb20odGhpcy5yZXNpemFibGVPcHRzLnRhYmxlLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuKTtcclxuXHJcbiAgICAgICAgdGhzLmZvckVhY2goKHRoOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGgsICdjb2wtcmVzaXplLWFjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyDpmLLmraLkuI3lrZjlnKh0Ym9keeeahOWcuuaZr+aKpemUmVxyXG4gICAgICAgIGlmKCFib2R5VGFibGUuY2hpbGRyZW5bMV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0cnM6IEFycmF5PGFueT4gPSBBcnJheS5mcm9tKGJvZHlUYWJsZS5jaGlsZHJlblsxXS5jaGlsZHJlbik7XHJcbiAgICAgICAgdHJzLmZvckVhY2goKHRyOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5uZWVkRGl2aWRpbmdMaW5lKHRyKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIEFycmF5LmZyb20odHIuY2hpbGRyZW4pXHJcbiAgICAgICAgICAgICAgICAuZm9yRWFjaCgodGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGQsICdjb2wtcmVzaXplLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVRhYmxlSW5mbygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMudGhzID0gVGlDb2xzUmVzaXphYmxlRGlyZWN0aXZlLmdldFRocyh0aGlzLnJlc2l6YWJsZU9wdHMudGFibGUpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlU3RvcmVkU2l6ZXMoKTsgLy8g5L+d5a2Y5pyA5paw5a695bqmXHJcbiAgICAgICAgdGhpcy5zZXRDb21wdXRlZFdpZHRoKCk7IC8vIOiuvue9ruacgOaWsOWuveW6plxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdFN0b3JhZ2VDb2xzV2lkdGgoKTp2b2lkIHtcclxuXHJcbiAgICAgICAgdGhpcy5yZXNpemFibGVPcHRzLnRocyA9IFRpQ29sc1Jlc2l6YWJsZURpcmVjdGl2ZS5nZXRUaHModGhpcy5yZXNpemFibGVPcHRzLnRhYmxlKTtcclxuICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMuc3RvcmVkU2l6ZXMgPSB0aGlzLnRhYmxlQ29tLmxvY2FsU3RvcmFnZVN0YXRlWydjb2xzV2lkdGgnXTtcclxuICAgICAgICB0aGlzLnNldENvbXB1dGVkV2lkdGgoKTtcclxuICAgICAgICAvLyDlkITliJflrr3luqborr7nva7lkI7vvIzlj6/og73lh7rnjrDmu5rliqjmnaHvvIzmiYDku6XopoHorqHnrpfkuIDmrKEgc3RvcmVUYWJsZVdpZHRoQ2hhbmdl55qE5YC8XHJcbiAgICAgICAgdGhpcy5zZXRUYWJsZVdpZHRoQ2hhbmdlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlsIblvZPliY3ooajmoLzlkITliJfnmoTlrr3luqbmm7TmlrDliLDliLByZXNpemFibGVPcHRzLnN0b3JlZFNpemVz5LitXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVTdG9yZWRTaXplcyA9ICgpOiB2b2lkID0+IHtcclxuICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMuc3RvcmVkU2l6ZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMudGhzLmZvckVhY2goKHRoOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50aVJlbmRlcmVyLnNldEF0dHJpYnV0ZXModGgsIHsndGktdmlzaWJsZS1pbmRleCc6IGluZGV4fSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVzaXphYmxlT3B0cy5zdG9yZWRTaXplc1tpbmRleF0gPSBUaUNvbHNSZXNpemFibGVEaXJlY3RpdmUuZ2V0V2lkdGgodGgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOabtOaWsOihqOagvOiusOW/hlxyXG4gICAgICAgIGlmKHRoaXMudGFibGVDb20uc3RvcmFnZUlkJiZ0aGlzLnRhYmxlQ29tLnN0b3JhZ2VDb25maWcuY29sc1dpZHRoKXtcclxuICAgICAgICAgICAgdGhpcy50YWJsZUNvbS5sb2NhbFN0b3JhZ2VTdGF0ZVsnY29sc1dpZHRoJ109IHRoaXMucmVzaXphYmxlT3B0cy5zdG9yZWRTaXplcztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRDb21wdXRlZFdpZHRoKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnJlc2l6YWJsZU9wdHMudGFibGUgJiYgdGhpcy5yZXNpemFibGVPcHRzLnRocyAmJiB0aGlzLnJlc2l6YWJsZU9wdHMudGhzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMudGhzLmZvckVhY2goKHRoOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0V2lkdGgodGgsIHRoaXMucmVzaXphYmxlT3B0cy5zdG9yZWRTaXplc1tpbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgLy8g6KGo5aS06ZSB5a6aXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YWJsZUNvbS5pc0ZpeGVkSGVhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXphYmxlT3B0cy5zZWNvbmRUaHMgPSBUaUNvbHNSZXNpemFibGVEaXJlY3RpdmUuZ2V0VGhzKHRoaXMucmVzaXphYmxlT3B0cy5zZWNvbmRUYWJsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRXaWR0aCh0aGlzLnJlc2l6YWJsZU9wdHMuc2Vjb25kVGhzW2luZGV4XSwgdGhpcy5yZXNpemFibGVPcHRzLnN0b3JlZFNpemVzW2luZGV4XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFdpZHRoID0gKGVsZW1lbnQ6IGFueSwgd2lkdGg6IG51bWJlcik6IHZvaWQgPT4ge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoZWxlbWVudCwgJ3dpZHRoJywgd2lkdGggKyAncHgnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlsIbooajmoLzlrr3luqborr7nva7kuLrpu5jorqTlrr3luqZcclxuICAgIHByaXZhdGUgc2V0RGVmYXVsdFdpZHRoKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHRoczogQXJyYXk8YW55PiA9IHRoaXMucmVzaXphYmxlT3B0cy50aHMgPSBUaUNvbHNSZXNpemFibGVEaXJlY3RpdmUuZ2V0VGhzKHRoaXMucmVzaXphYmxlT3B0cy50YWJsZSk7XHJcbiAgICAgICAgLy8g5YiX6ZqQ6JeP5oiW5pi+56S65ZCO77yM5bCG5ZCE5YiX5a696K6+572u5Li65Yid5aeL55So5oi36K6+572u55qE5YiX5a69XHJcbiAgICAgICAgdGhzLmZvckVhY2goKHRoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgd2lkdGg6IHN0cmluZyA9IHRoLmdldEF0dHJpYnV0ZSgnd2lkdGgnKSA/IHRoLmdldEF0dHJpYnV0ZSgnd2lkdGgnKSA6ICcnO1xyXG4gICAgICAgICAgICAvLyDms6jmhI/vvJrorr7nva7liJflrr3nmoTmlrnlvI/mnInlpJrnp43vvIzmraTlpITnu5/kuIDpu5jorqTku6V3aWR0aOWxnuaAp+iuvue9rueahOWuveS4uuWHhlxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoLCAnd2lkdGgnLCB3aWR0aCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIOihqOWktOmUgeWumlxyXG4gICAgICAgIGlmICh0aGlzLnRhYmxlQ29tLmlzRml4ZWRIZWFkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlY29uZFRhYmxlOiBhbnkgPSB0aGlzLmdldFNlY29uZFRhYmxlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlY29uZFRoczogQXJyYXk8YW55PiA9IFRpQ29sc1Jlc2l6YWJsZURpcmVjdGl2ZS5nZXRUaHMoc2Vjb25kVGFibGUpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMuc2Vjb25kVGhzID0gc2Vjb25kVGhzO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueFNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWCgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6YWJsZU9wdHMueVNjcm9sbFN0YXRlID0gdGhpcy5vdmVyZmxvd2VkWSgpO1xyXG5cclxuICAgICAgICAgICAgc2Vjb25kVGhzLmZvckVhY2goKHRoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoOiBzdHJpbmcgPSB0aC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJykgPyB0aC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJykgOiAnJztcclxuICAgICAgICAgICAgICAgIC8vIOazqOaEj++8muiuvue9ruWIl+WuveeahOaWueW8j+acieWkmuenje+8jOatpOWkhOe7n+S4gOm7mOiupOS7pXdpZHRo5bGe5oCn6K6+572u55qE5a695Li65YeGXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoLCAnd2lkdGgnLCB3aWR0aCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkSGVhZFNlcnZpY2UucHJvY2Vzc1lTY3JvbGxTdGF0ZUNoYW5nZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRUYWJsZVdpZHRoQ2hhbmdlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5b2T5YiX5ouW5Yqo6L+b6KGM5pe25Y675o6J5paH5a2X5Y+v6YCJ5qC35byPKHVzZXItc2VsZWN0OiBub25lKVxyXG4gICAgcHJpdmF0ZSB0b2dnbGVUZXh0U2VsZWN0aW9uKHRvZ2dsZTogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGJvZHk6IGFueSA9IHRoaXMuZG9jdW1lbnQuYm9keTtcclxuICAgICAgICBpZiAodG9nZ2xlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoYm9keSwgJ3RpMy11bnNlbGVjdGFibGUnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUoYm9keSwgJ3Vuc2VsZWN0YWJsZScsICdvbicpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3MoYm9keSwgJ3RpMy11bnNlbGVjdGFibGUnKTtcclxuICAgICAgICAgICAgYm9keS5yZW1vdmVBdHRyaWJ1dGUoJ3Vuc2VsZWN0YWJsZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG5lZWREaXZpZGluZ0xpbmUodHI6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghdHIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjbGFzc2VzOiBBcnJheTxzdHJpbmc+ID0gWyd0aTMtZGV0YWlscy10cicsICd0aTMtdGFibGUtbm9kYXRhJywgJ3RpMy10YWJsZS1sb2FkZmFpbCcsXHJcbiAgICAgICAgICAgICd0aTMtdGFibGUtbm9kYXRhLWd1aWRlJywgJ3RpMy10YWJsZS1ub2RhdGEtc2ltcGxlJ107XHJcbiAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgY2xhc3Nlcykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aVJlbmRlcmVyLmhhc0NsYXNzKHRyLCBjbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOS+m+ihqOWktOmUgeWumuS9v+eUqFxyXG4gICAgcHJpdmF0ZSBnZXRTZWNvbmRUYWJsZSgpOiBFbGVtZW50IHtcclxuICAgICAgICBjb25zdCBzZWNvbmRUYWJsZUNvbnRhaW5lcjogYW55ID0gdGhpcy50aVJlbmRlcmVyLmZpbmRDaGlsZHJlbkJ5Q2xhc3NOYW1lKHRoaXMuaG9zdEVsZSwgJ3RpMy1yZXNpemUtd3JhcHBlcicpWzBdO1xyXG5cclxuICAgICAgICByZXR1cm4gc2Vjb25kVGFibGVDb250YWluZXIgPyBzZWNvbmRUYWJsZUNvbnRhaW5lci5jaGlsZHJlblswXSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBvdmVyZmxvd2VkWChpc051bT86IGJvb2xlYW4pOiBhbnkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpeGVkSGVhZFNlcnZpY2Uub3ZlcmZsb3dlZFJlc3VsdCh0aGlzLnRhYmxlQ29tLnRib2R5Q29udGFpbmVyLCAnWCcsIGlzTnVtKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG92ZXJmbG93ZWRZKGlzTnVtPzogYm9vbGVhbik6IGFueSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZml4ZWRIZWFkU2VydmljZS5vdmVyZmxvd2VkUmVzdWx0KHRoaXMudGFibGVDb20udGJvZHlDb250YWluZXIsICdZJywgaXNOdW0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==