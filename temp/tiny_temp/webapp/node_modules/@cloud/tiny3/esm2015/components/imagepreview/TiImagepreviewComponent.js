import { Component, ElementRef, Input, Renderer2, ViewChild } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { TiBaseComponent } from '../base/TiBaseModule';
/**
 * @ignore
 *
 * 10.0.2版本新增组件
 *
 * 该组件主要用于图片放大预览
 *
 * <example-url>../tiny3demo/#/imagepreview/imagepreview-all</example-url>
 */
export class TiImagepreviewComponent extends TiBaseComponent {
    constructor(sanitizer, renderer, elementRef) {
        super(elementRef, renderer);
        this.sanitizer = sanitizer;
        this.renderer = renderer;
        this.elementRef = elementRef;
        /**
         * 需要预览的文件列表
         */
        this.fileList = [];
        /**
         * 是否展示文件名称，默认展示
         */
        this.showFileName = true;
        /**
         * 默认展示的图片的索引
         */
        this.index = 0;
    }
    ngAfterViewInit() {
        this.addImgLoadListener();
    }
    /**
     * @ignore 翻到上一张图片
     */
    toNext() {
        if (this.index === (this.fileList.length - 1)) {
            return;
        }
        this.addImgLoadListener();
        this.index++;
    }
    /**
     * @ignore 翻到下一张图片
     */
    toPrevious() {
        if (this.index === 0) {
            return;
        }
        this.addImgLoadListener();
        this.index--;
    }
    // 由于图片高度不确定，需动态设置top值，所以增加load事件。
    addImgLoadListener() {
        this.imgTemplate.nativeElement.onload = () => {
            const imgHeight = this.imgTemplate.nativeElement.height;
            if (imgHeight !== 0) {
                const top = (imgHeight - 48) / 2;
                this.renderer.setStyle(this.switchBtnTemplate.nativeElement, 'top', top + 'px');
            }
            // 防止循环触发load事件
            // tslint:disable-next-line: no-null-keyword
            this.imgTemplate.nativeElement.onload = null;
        };
    }
}
TiImagepreviewComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-imagepreview',
                template: "<ti-modal-header class=\"ti3-image-preview-modal-header\">\r\n    <span *ngIf=\"showFileName\" [id]=\"appendId('name')\">{{fileList[index].name}}</span>\r\n</ti-modal-header>\r\n<ti-modal-body class='ti3-image-preview-modal-body'>\r\n    <div class='ti3-image-preview-container'>\r\n        <img #imgTemplate [src]='sanitizer.bypassSecurityTrustUrl(fileList[index].previewUrl)' />\r\n    </div>\r\n    <div #switchBtn class=\"ti3-image-preview-icon-container\">\r\n        <ti-icon tiOutline [tabindex]=\"index === 0 ? -1 : 0\" name='angle-left' class=\"ti3-image-preview-icon ti3-image-preview-icon-left\"\r\n            [ngClass]=\"{'ti3-image-preview-icon-disabled': index === 0 ? true: false }\" (click)=\"toPrevious()\" (keydown.enter)=\"toPrevious()\" [id]=\"appendId('left')\"></ti-icon>\r\n        <ti-icon tiOutline [tabindex]=\"index === fileList.length - 1 ? -1 : 0\" name=\"angle-right\" class=\"ti3-image-preview-icon ti3-image-preview-icon-right\"\r\n            [ngClass]=\"{'ti3-image-preview-icon-disabled': index === fileList.length - 1 ? true : false}\" (click)=\"toNext()\" (keydown.enter)=\"toNext()\" [id]=\"appendId('right')\"></ti-icon>\r\n    </div>\r\n</ti-modal-body>",
                styles: ["::ng-deep :root{--ti-image-preview-container-margin:var(--ti-common-space-5x);--ti-image-preview-container-width:600px;--ti-image-preview-icon-width:24px;--ti-image-preview-modal-header-font-size:14px;--ti-image-preview-modal-header-line-height:20px;--ti-image-preview-modal-header-padding-left:var(--ti-common-space-5x);--ti-image-preview-modal-header-padding-top:12px}.ti3-image-preview-modal-header{font-size:var(--ti-image-preview-modal-header-font-size)!important;line-height:var(--ti-image-preview-modal-header-line-height)!important;padding:var(--ti-image-preview-modal-header-padding-top) var(--ti-image-preview-modal-header-padding-left)!important}.ti3-image-preview-modal-body{margin:0 var(--ti-image-preview-container-margin)!important;max-height:none!important;padding:0}.ti3-image-preview-container{margin:0 auto var(--ti-image-preview-container-margin);width:var(--ti-image-preview-container-width)}.ti3-image-preview-container img{border-style:none;display:inline-block;width:100%}.ti3-image-preview-icon-container{position:absolute;width:100%}.ti3-image-preview-icon-container .ti3-image-preview-icon{background:rgba(0,0,0,.2);border-radius:2px;color:#fff;cursor:pointer;display:inline-block;font-size:calc(var(--ti-common-font-size-base)*2);height:calc(var(--ti-image-preview-icon-width)*2);line-height:calc(var(--ti-image-preview-icon-width)*2);width:var(--ti-image-preview-icon-width)}.ti3-image-preview-icon-container .ti3-image-preview-icon:focus,.ti3-image-preview-icon-container .ti3-image-preview-icon:hover{background:rgba(0,0,0,.3)}.ti3-image-preview-icon-container .ti3-image-preview-icon-disabled{background:rgba(0,0,0,.2)!important;color:hsla(0,0%,100%,.4);cursor:not-allowed;outline:none}.ti3-image-preview-icon-container .ti3-image-preview-icon-left{float:left}.ti3-image-preview-icon-container .ti3-image-preview-icon-right{float:right}"]
            },] }
];
TiImagepreviewComponent.ctorParameters = () => [
    { type: DomSanitizer },
    { type: Renderer2 },
    { type: ElementRef }
];
TiImagepreviewComponent.propDecorators = {
    fileList: [{ type: Input }],
    showFileName: [{ type: Input }],
    index: [{ type: Input }],
    imgTemplate: [{ type: ViewChild, args: ['imgTemplate', { static: true },] }],
    switchBtnTemplate: [{ type: ViewChild, args: ['switchBtn', { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlJbWFnZXByZXZpZXdDb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueTMvY29tcG9uZW50cy9pbWFnZXByZXZpZXcvVGlJbWFnZXByZXZpZXdDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFpQixTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xHLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFxQnZEOzs7Ozs7OztHQVFHO0FBTUgsTUFBTSxPQUFPLHVCQUF3QixTQUFRLGVBQWU7SUEwQnhELFlBQW1CLFNBQXVCLEVBQVcsUUFBbUIsRUFBVSxVQUFzQjtRQUNoRyxLQUFLLENBQUMsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRGpCLGNBQVMsR0FBVCxTQUFTLENBQWM7UUFBVyxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQXhCeEc7O1dBRUc7UUFDTSxhQUFRLEdBQTZCLEVBQUUsQ0FBQztRQUVqRDs7V0FFRztRQUNNLGlCQUFZLEdBQVksSUFBSSxDQUFDO1FBRXRDOztXQUVHO1FBQ00sVUFBSyxHQUFXLENBQUMsQ0FBQztJQWEzQixDQUFDO0lBRUQsZUFBZTtRQUNYLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzlCLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU07UUFDVCxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRTtZQUMzQyxPQUFPO1NBQ1Y7UUFDRCxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUMxQixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDakIsQ0FBQztJQUVEOztPQUVHO0lBQ0ksVUFBVTtRQUNiLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxDQUFDLEVBQUU7WUFDbEIsT0FBTztTQUNWO1FBQ0QsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDMUIsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ2pCLENBQUM7SUFFRCxrQ0FBa0M7SUFDMUIsa0JBQWtCO1FBQ3RCLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLE1BQU0sR0FBRyxHQUFTLEVBQUU7WUFDL0MsTUFBTSxTQUFTLEdBQVcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDO1lBQ2hFLElBQUksU0FBUyxLQUFLLENBQUMsRUFBRTtnQkFDakIsTUFBTSxHQUFHLEdBQVcsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN6QyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLENBQUM7YUFDbkY7WUFDRCxlQUFlO1lBQ2YsNENBQTRDO1lBQzVDLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDakQsQ0FBQyxDQUFDO0lBQ04sQ0FBQzs7O1lBekVKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsaUJBQWlCO2dCQUMzQixzckNBQWtDOzthQUVyQzs7O1lBbkNRLFlBQVk7WUFEaUMsU0FBUztZQUE1QixVQUFVOzs7dUJBMEN4QyxLQUFLOzJCQUtMLEtBQUs7b0JBS0wsS0FBSzswQkFLTCxTQUFTLFNBQUMsYUFBYSxFQUFFLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBQztnQ0FJdkMsU0FBUyxTQUFDLFdBQVcsRUFBRSxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIElucHV0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuaW1wb3J0IHsgVGlCYXNlQ29tcG9uZW50IH0gZnJvbSAnLi4vYmFzZS9UaUJhc2VNb2R1bGUnO1xyXG5cclxuLy8g5paH5Lu26aKE6KeI5L+h5oGv5o6l5Y+jXHJcbi8vIDEwLjAuMueJiOacrOaWsOWinlxyXG5leHBvcnQgaW50ZXJmYWNlIFRpRmlsZVByZXZpZXdJbmZvIHtcclxuICAgIC8qKlxyXG4gICAgICog5paH5Lu25ZCN56ewXHJcbiAgICAgKi9cclxuICAgIG5hbWU/OiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpooTop4jlnLDlnYBcclxuICAgICAqL1xyXG4gICAgcHJldmlld1VybD86IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWFgeiuuOacieWkmuS9meeahOWxnuaAp+Wtl+autVxyXG4gICAgICovXHJcbiAgICBbcHJvcE5hbWU6IHN0cmluZ106IGFueTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBpZ25vcmVcclxuICpcclxuICogMTAuMC4y54mI5pys5paw5aKe57uE5Lu2XHJcbiAqXHJcbiAqIOivpee7hOS7tuS4u+imgeeUqOS6juWbvueJh+aUvuWkp+mihOiniFxyXG4gKlxyXG4gKiA8ZXhhbXBsZS11cmw+Li4vdGlueTNkZW1vLyMvaW1hZ2VwcmV2aWV3L2ltYWdlcHJldmlldy1hbGw8L2V4YW1wbGUtdXJsPlxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3RpLWltYWdlcHJldmlldycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vaW1hZ2VwcmV2aWV3Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vaW1hZ2VwcmV2aWV3Lmxlc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGlJbWFnZXByZXZpZXdDb21wb25lbnQgZXh0ZW5kcyBUaUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0IHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOmcgOimgemihOiniOeahOaWh+S7tuWIl+ihqFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBmaWxlTGlzdDogQXJyYXk8VGlGaWxlUHJldmlld0luZm8+ID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmmK/lkKblsZXnpLrmlofku7blkI3np7DvvIzpu5jorqTlsZXnpLpcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgc2hvd0ZpbGVOYW1lOiBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOm7mOiupOWxleekuueahOWbvueJh+eahOe0ouW8lVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBpbmRleDogbnVtYmVyID0gMDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmUg5YaF6YOo5Y+Y6YePXHJcbiAgICAgKi9cclxuICAgIEBWaWV3Q2hpbGQoJ2ltZ1RlbXBsYXRlJywge3N0YXRpYzogdHJ1ZX0pIGltZ1RlbXBsYXRlOiBFbGVtZW50UmVmO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlIOWGhemDqOWPmOmHj1xyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCdzd2l0Y2hCdG4nLCB7c3RhdGljOiB0cnVlfSkgc3dpdGNoQnRuVGVtcGxhdGU6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIHNhbml0aXplcjogRG9tU2FuaXRpemVyLHByb3RlY3RlZCByZW5kZXJlcjogUmVuZGVyZXIyLCBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYpIHtcclxuICAgICAgICAgICAgc3VwZXIoZWxlbWVudFJlZiwgcmVuZGVyZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmFkZEltZ0xvYWRMaXN0ZW5lcigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZSDnv7vliLDkuIrkuIDlvKDlm77niYdcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRvTmV4dCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pbmRleCA9PT0gKHRoaXMuZmlsZUxpc3QubGVuZ3RoIC0gMSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZEltZ0xvYWRMaXN0ZW5lcigpO1xyXG4gICAgICAgIHRoaXMuaW5kZXgrKztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmUg57+75Yiw5LiL5LiA5byg5Zu+54mHXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0b1ByZXZpb3VzKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRJbWdMb2FkTGlzdGVuZXIoKTtcclxuICAgICAgICB0aGlzLmluZGV4LS07XHJcbiAgICB9XHJcblxyXG4gICAgLy8g55Sx5LqO5Zu+54mH6auY5bqm5LiN56Gu5a6a77yM6ZyA5Yqo5oCB6K6+572udG9w5YC877yM5omA5Lul5aKe5YqgbG9hZOS6i+S7tuOAglxyXG4gICAgcHJpdmF0ZSBhZGRJbWdMb2FkTGlzdGVuZXIoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5pbWdUZW1wbGF0ZS5uYXRpdmVFbGVtZW50Lm9ubG9hZCA9ICgpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaW1nSGVpZ2h0OiBudW1iZXIgPSB0aGlzLmltZ1RlbXBsYXRlLm5hdGl2ZUVsZW1lbnQuaGVpZ2h0O1xyXG4gICAgICAgICAgICBpZiAoaW1nSGVpZ2h0ICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b3A6IG51bWJlciA9IChpbWdIZWlnaHQgLSA0OCkgLyAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnN3aXRjaEJ0blRlbXBsYXRlLm5hdGl2ZUVsZW1lbnQsICd0b3AnLCB0b3AgKyAncHgnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDpmLLmraLlvqrnjq/op6blj5Fsb2Fk5LqL5Lu2XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tbnVsbC1rZXl3b3JkXHJcbiAgICAgICAgICAgIHRoaXMuaW1nVGVtcGxhdGUubmF0aXZlRWxlbWVudC5vbmxvYWQgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuIl19