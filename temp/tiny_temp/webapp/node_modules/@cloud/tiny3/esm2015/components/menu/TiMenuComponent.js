import { Component, ContentChild, ElementRef, EventEmitter, Input, Output, QueryList, TemplateRef, ViewChild, ViewChildren } from '@angular/core';
import { TiFormComponent } from '../base/TiBaseModule';
import { TiDropComponent } from '../drop/TiDropModule';
import { TiMenuListComponent } from './TiMenuListComponent';
import { TiKeymap } from '../../utils/Util';
/**
 * Menu菜单组件
 *
 * 提供了一种方便的生成菜单下拉列表的方式，提供分组、自定义内容等功能。
 *
 * <example-url>../tiny3demo/#/menu/menu-all</example-url>
 */
export class TiMenuComponent extends TiFormComponent {
    constructor() {
        super(...arguments);
        /**
         * 下拉菜单面板与按钮对齐方式。
         */
        this.panelAlign = 'right';
        /**
         * 下拉面板最大宽度，超过时换行，对所有子菜单都生效。
         */
        this.panelMaxWidth = '9999px';
        /**
         * 下拉面板最大高度，超过时出现竖向滚动条，对所有子菜单都生效。
         */
        this.panelMaxHeight = '9999px';
        /**
         * 要显示文字的键值
         */
        this.labelKey = 'label'; // labelKey
        /**
         * 选中菜单项事件
         */
        this.select = new EventEmitter();
        /**
         * 打开面板之前，通知事件。完全交给业务用户处理。
         */
        this.beforeOpen = new EventEmitter();
        /**
         * @ignore
         * itemsArr[0]存放根面板内容，itemArr[1]存放次级面板内容，itemArr[2]存放次次级面板内容
         */
        this.itemsArr = [];
        /**
         * @ignore
         *  与开关距离
         */
        this.dominatorSpace = '10px';
    }
    ngOnInit() {
        // 基类中做了设置宿主id的操作
        super.ngOnInit();
        this.hasBorder = this.nativeElement.hasAttribute('hasborder');
    }
    ngOnChanges(changes) {
        this.setFocusableElems([this.mytoggleRef.nativeElement]);
        super.ngOnChanges(changes);
        if (changes['items']) { // 外部修改show属性的处理，初始定义在ngOnInit中处理
            this.itemsArr[0] = this.items;
        }
    }
    /**
     * 兼容旧版：
     * 10.0.3 版本之前只能内嵌一个模板，无命名。
     * 新版可以内嵌两个模板，示例书写要求都命名（#item，#tip）。
     * 但需要兼容旧版无命名测试用例。
     */
    // tslint:disable-next-line: use-life-cycle-interface
    ngAfterContentInit() {
        super.ngAfterContentInit();
        // 如果 item 模板为空 && 存在第一个模板，那么把第一个出现的 “非#tip 标签” 的模板作为 item 模板
        if (!this.itemTemplate && this.firstTemplate
            && (this.firstTemplate.elementRef.nativeElement !== (this.tipTemplate && this.tipTemplate.elementRef.nativeElement))) {
            this.itemTemplate = this.firstTemplate;
        }
    }
    /**
     * 打开面板
     */
    open() {
        if (this.disabled) {
            return;
        }
        // 打开面板前重置menulist最大高度
        this.initListMaxHeight();
        this.dropComs.first.show();
        this.listComs.first.hoverOption = null;
        // 根据drop的最大高度设置menulist最大高度
        this.restyleListMaxHeight();
        // IE滚动条Bug的监听
        this.listComs.toArray().forEach(listCom => {
            listCom.listenIESrollbarBug();
        });
    }
    /**
     * 关闭面板
     */
    close() {
        this.dropComs.first.hide();
        this.onHover(null, 0);
        // 解除IE滚动条Bug的监听
        this.listComs.toArray().forEach(listCom => {
            listCom.unlistenIESrollbarBug();
        });
    }
    /**
     * 切换面板状态：打开/关闭
     */
    toggle() {
        this.dropComs.first.isShow ? this.close() : this.open();
    }
    /**
     * @ignore
     */
    onKeydown(event) {
        switch (event.keyCode) {
            case TiKeymap.KEY_SPACE: // 原生SPACE键仅可打开。但Tiny2,3都跟Enter键保持一致
            case TiKeymap.KEY_ENTER: // ENTER键 相当于click
            case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)
                // 第一级已打开，但无选中项。或者第一级没有打开。相当于鼠标点击逻辑。
                if ((this.dropComs.first.isShow && !this.listComs.toArray()[0].hoverOption)
                    || !this.dropComs.first.isShow) {
                    this.onMousedown(null); // 相当于鼠标点击
                    break; // 注意:break在if内，如果if不满足，则走到default，list处理按键
                }
            // 上面的回车键, 可能继续走到下面分支。
            // tslint:disable-next-line:no-switch-case-fall-through
            // eslint-disable-next-line no-fallthrough
            case TiKeymap.KEY_ARROW_LEFT: // 左右箭头，焦点在左右面板转移
            case TiKeymap.KEY_ARROW_RIGHT: // 左右箭头，焦点在左右面板转移
            case TiKeymap.KEY_ARROW_UP: // 上下箭头，上下移动选中项
            case TiKeymap.KEY_ARROW_DOWN: // 上下箭头，上下移动选中项
                for (let i = this.dropComs.length - 1; i >= 0; i--) { // 寻找末尾面板且有hover，list处理按键
                    if (this.dropComs.toArray()[i].isShow && this.listComs.toArray()[i].hoverOption) {
                        this.onKeydownLastHoverList(event, i);
                        // break; //这里触发了for循环的break；并没有走到switch的break;所以改为return;
                        return;
                    }
                }
                // 没有hover的面板，那么第一级面板（肯定是展开的）处理按键
                this.listComs.first.onKeydown(event);
                break;
            default:
                break;
        }
    }
    onKeydownLastHoverList(event, i) {
        switch (event.keyCode) {
            case TiKeymap.KEY_ARROW_LEFT: // 左右箭头，焦点在左右面板转移
            case TiKeymap.KEY_ARROW_RIGHT: // 左右箭头，焦点在左右面板转移
                if ((this.panelAlign === 'right' && event.keyCode === TiKeymap.KEY_ARROW_LEFT)
                    || (this.panelAlign === 'left' && event.keyCode === TiKeymap.KEY_ARROW_RIGHT)) { // 次级面板方向键
                    if (i + 1 < this.dropComs.length && this.dropComs.toArray()[i + 1].isShow) { // 次级存在且展开
                        this.listComs.toArray()[i + 1].nextOption(false); // 次级面板hover由null改为下一个
                    }
                }
                else { // 上级面板方向键
                    this.listComs.toArray()[i].hoverOption = null;
                }
                break;
            case TiKeymap.KEY_SPACE: // 原生SPACE键仅可打开。但Tiny2,3都跟Enter键保持一致
            case TiKeymap.KEY_ENTER: // ENTER键 相当于click
            case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)
                if (!this.listComs.toArray()[i].isGroup(this.listComs.toArray()[i].hoverOption)) {
                    this.listComs.toArray()[i].onKeydown(event);
                }
                break;
            default: // 上下键等，和上面的回车键也会走到这里。
                this.listComs.toArray()[i].onKeydown(event);
                break;
        }
    }
    /**
     * @ignore
     */
    onMousedown(event) {
        if (this.dropComs.first.isShow) { // 已打开，则关闭
            this.close();
        }
        else if (this.beforeOpen.observers.length === 0) { // 已打开，且无beforeOpen，则打开
            this.open();
        }
        else { // 已打开，有beforeOpen
            this.beforeOpen.emit(this);
        }
    }
    /**
     * @ignore
     */
    onSelect(panelIndex) {
        this.select.emit(this.listComs.toArray()[panelIndex].model);
        this.close();
    }
    /**
     * @ignore
     */
    onBlur() {
        this.close();
    }
    /**
     * @ignore
     */
    onHover(item, panelIndex) {
        if (panelIndex + 1 === this.dropComs.length) { // 当前hover面板，已经是最后一级面板
            return;
        }
        const dropComArr = this.dropComs.toArray();
        const listComArr = this.listComs.toArray();
        if (item && listComArr[panelIndex].isGroup(item) && !listComArr[panelIndex].isDisabledFn(item)) { // 根据数据，是否展开下一级
            this.itemsArr[panelIndex + 1] = item.children; // 下一级数据，赋新值。
            listComArr[panelIndex + 1].hoverOption = null; // 下一级面板赋空hoverOption，会触发onHover，进而关闭下一级面板的后续面板。
            // 赋新值以后，等模板有了新的尺寸，再弹出。
            setTimeout(() => {
                const currentPanel = dropComArr[panelIndex].nativeElement; // 当前面板元素
                const nextPanel = dropComArr[panelIndex + 1].nativeElement; // 下一级面板元素
                dropComArr[panelIndex + 1].show(); // 打开下一级面板
                // 位置调整，X方向 // TODO: 使用Position是否可行？
                const leftOffset = (this.panelAlign === 'left') ?
                    currentPanel.offsetLeft + currentPanel.offsetWidth :
                    currentPanel.offsetLeft - nextPanel.offsetWidth;
                nextPanel.style.left = `${leftOffset}px`;
                // 位置调整，Y方向
                const itemIndex = this.itemsArr[panelIndex].indexOf(item);
                const itemElem = listComArr[panelIndex].nativeElement.getElementsByTagName('LI')[itemIndex];
                // 当前li距离面板顶部的距离 = 当前li距离可视区顶部的距离 - 当前面板到可视区顶部的距离;
                const itemElmTop = itemElem.getBoundingClientRect().top - currentPanel.getBoundingClientRect().top;
                // 当前li距离页面底部的距离 = 可视区窗口高度 + 文档滚动高度 - 当前面板的offsetTop - 当前li距离面板顶部的距离;
                const bottomOffset = document.documentElement.clientHeight + document.documentElement.scrollTop -
                    currentPanel.offsetTop - itemElmTop;
                // 下一级面板的的高度
                const itemHeight = nextPanel.offsetHeight;
                // 底部空间能放下下一级面板：下一级面板的top = 当前面板的offsetTop + 当前li距离面板顶部的距离 - 面板的上下留白
                const nextPanelTop = currentPanel.offsetTop + itemElmTop - 4;
                if (bottomOffset > itemHeight) {
                    nextPanel.style.top = nextPanelTop + 'px';
                    return;
                }
                // 底部空间不足，和浏览器底部对齐
                nextPanel.style.top = nextPanelTop + bottomOffset - itemHeight + 'px';
            }, 0);
        }
        else {
            // 当hover到具体项目（非分组）或 null（移出当前面板），需要闭合所有后续面板
            for (let i = panelIndex + 1; i < dropComArr.length; i++) {
                dropComArr[i].hide();
            }
        }
    }
    /**
     * @ignore
     */
    onMouseoutDrop(event, panelIndex) {
        // 默认需要隐藏, 除非鼠标进入面板区域。
        for (let i = 0; i < this.dropComs.length; i++) {
            const dropRect = this.dropComs.toArray()[i].nativeElement
                .getBoundingClientRect();
            // 因为慢慢移出本面板时，移出鼠标事件依然停留在本面板内（1px误差），所以面板rect四周范围要更小1px。
            if (dropRect.left < event.clientX && event.clientX < dropRect.right
                && dropRect.top < event.clientY && event.clientY < dropRect.bottom) {
                return;
            }
        }
        // 给第一级面板置无选中，那么次级面板自然会关闭。
        this.listComs.first.hoverOption = null; // 会触发到上面this.onHover(null, 0);
    }
    // 初始化menulist最大高度
    initListMaxHeight() {
        this.menulistMaxHeight = parseInt(this.panelMaxHeight, 10);
        this.listComs.toArray().forEach(listCom => {
            this.renderer.setStyle(listCom.nativeElement, 'max-height', this.menulistMaxHeight + 'px');
        });
    }
    // 考虑drop的压缩情况，设置menulist的max-height
    restyleListMaxHeight() {
        const dropCurMaxHeight = parseInt(this.dropComs.first.nativeElement.style.maxHeight, 10);
        if (!isNaN(dropCurMaxHeight) && dropCurMaxHeight < this.menulistMaxHeight) {
            this.listComs.toArray().forEach(listCom => {
                this.renderer.setStyle(listCom.nativeElement, 'max-height', dropCurMaxHeight + 'px');
            });
        }
    }
}
TiMenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-menu',
                template: "<a #mytoggle class=\"ti3-menu-toggle ti3-menu-toggle-menu \"\r\n        (mousedown)=\"onMousedown($event)\"\r\n        (keydown)=\"onKeydown($event)\"\r\n        oncontextmenu=\"return false\"\r\n        href=\"javascript:void(0)\"\r\n        [id]=\"appendId('toggle')\">\r\n        <ng-content></ng-content>\r\n</a>\r\n<ng-container *ngTemplateOutlet=\"pannelTemplate; context: {$implicit: itemsArr[0], panelIndex: 0}\">\r\n</ng-container>\r\n<ng-container *ngTemplateOutlet=\"pannelTemplate; context: {$implicit: itemsArr[1],panelIndex: 1}\">\r\n</ng-container>\r\n<ng-container *ngTemplateOutlet=\"pannelTemplate; context: {$implicit: itemsArr[2], panelIndex: 2}\">\r\n</ng-container>\r\n<ng-template #pannelTemplate let-options let-panelIndex=panelIndex>\r\n        <ti-drop #drop\r\n        [ngClass]=\"{'ti3-menu-border-drop': hasBorder}\"\r\n        class=\"ti3-menu-panel-container\"\r\n        [dominatorElem]=\"mytoggleRef.nativeElement\"\r\n        [panelAlign]=\"panelAlign\"\r\n        panelWidth='auto'\r\n        height='auto'\r\n        [id]=\"appendId('drop'+panelIndex)\"\r\n        (mouseout)=\"onMouseoutDrop($event, panelIndex)\">\r\n                <ti-menulist #menulist\r\n                        [options]=\"options\"\r\n                        [labelKey]=\"labelKey\"\r\n                        [panelAlign]=\"panelAlign\"\r\n                        style=\"display:block;\"\r\n                        (select)=\"onSelect(panelIndex)\"\r\n                        size =\"small\"\r\n                        [ngStyle]=\"{'max-width': panelMaxWidth}\"\r\n                         (hover)=\"onHover($event, panelIndex)\"\r\n                         [id]=\"appendId('menulist'+panelIndex)\">\r\n                        <ng-template let-item let-i=index>\r\n                                <section [tiTip]='tipTemplate ? tipTemplate : item.tip' [tiTipContext]='item' [tiTipPosition]='item.tipPosition'>\r\n                                        <ng-container *ngIf=\"itemTemplate else listLabelTemplate\">\r\n                                                <ng-container *ngTemplateOutlet=\"itemTemplate; context: {$implicit: item,index: i}\">\r\n                                                </ng-container>\r\n                                        </ng-container>\r\n                                        <ng-template #listLabelTemplate>{{item[labelKey]}}</ng-template>\r\n                                </section>\r\n                        </ng-template>\r\n                </ti-menulist>\r\n        </ti-drop>\r\n<ng-template>\r\n",
                host: {
                    '(blur)': 'onBlur()'
                },
                styles: [".ti3-compnent-container-border,:host[hasborder]{-ms-box-sizing:border-box;border:1px solid;border-radius:var(--ti-input-border-radius);box-sizing:border-box;display:inline-block}.ti3-compnent-container-border:not([disabled]),:host[hasborder]:not([disabled]){background-color:var(--ti-input-bg-color);border-color:var(--ti-input-border-color)}.ti3-compnent-container-border:not([disabled]):hover,:host[hasborder]:not([disabled]):hover{border-color:var(--ti-input-border-color-hover)}.ti3-compnent-container-border:not([disabled])[tiFocused],:host[hasborder]:not([disabled])[tiFocused]{border-color:var(--ti-input-border-color-focus)}.ti3-compnent-container-border[disabled],:host[hasborder][disabled]{background-color:var(--ti-input-bg-color-disabled);border-color:var(--ti-input-border-color-disabled);cursor:not-allowed!important}:host{display:inline-block}.ti3-menu-toggle,a.ti3-menu-toggle:focus{color:var(--ti-menu-item-color)}.ti3-menu-toggle-menu{-ms-user-select:none;-webkit-user-select:none;cursor:pointer;display:inline-block;text-decoration:none;user-select:none}.ti3-menu-toggle-menu:hover{color:var(--ti-menu-item-color-hover)}.ti3-menu-toggle-menu:hover:after{border-top-color:var(--ti-menu-item-color-hover)}.ti3-menu-toggle-menu:active{color:var(--ti-menu-item-color-active)}.ti3-menu-toggle-menu:active:after{border-top-color:var(--ti-menu-item-color-active)}.ti3-menu-toggle-menu:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid var(--ti-menu-item-color);content:\"\";display:inline-block;height:0;margin-left:5px;vertical-align:middle;width:0}.ti3-menu-toggle-button{-ms-user-select:none;-webkit-user-select:none;cursor:pointer;display:inline-block;user-select:none}.ti3-menu-toggle-button:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid;content:\"\";display:inline-block;height:0;margin-left:3px;vertical-align:middle;width:0}.ti3-menu-panel-container{-ms-box-sizing:border-box;background-color:#fff;border-radius:2px;box-shadow:0 2px 8px 1px rgba(0,0,0,.2);box-sizing:border-box;display:none;list-style:none;position:absolute;z-index:1060}.ti3-menu-panel-container.ti3-button-menu-panel-container{border:1px solid var(--ti-menu-button-panel-border-color);box-shadow:none}.ti3-menu-panel-container.ti3-button-menu-panel-container .ti3-menu-panel-list:hover{color:var(--ti-menu-button-panel-border-color)}.ti3-menu-panel-container.ti3-button-menu-panel-container .ti3-menu-panel-list.ti3-menu-panel-list-active{background-color:var(--ti-menu-button-panel-border-color);color:var(--ti-menu-panel-item-color-active)}.ti3-menu-panel-container.ti3-region-menu-panel-container-down{border-top:1px solid #ccc}.ti3-menu-panel-container.ti3-region-menu-panel-container-up{border-bottom:1px solid #ccc}:host[hasborder] .ti3-menu-toggle-menu{border:1px solid transparent;color:var(--ti-input-text-color);height:var(--ti-input-height);line-height:var(--ti-input-height);margin:-1px;padding-left:var(--ti-common-space-5x);padding-right:var(--ti-common-space-4x)}:host[hasborder] .ti3-menu-toggle-menu:focus,:host[hasborder] .ti3-menu-toggle-menu:hover{color:var(--ti-default-font-color)}:host[hasborder] .ti3-menu-toggle-menu:after,:host[hasborder] .ti3-menu-toggle-menu:hover:after{border-top-color:var(--ti-dominator-select-arrow-color)}:host[hasborder]:hover:not([disabled]){border-color:var(--ti-common-color-line-active)}:host[disabled] .ti3-menu-toggle-menu{color:var(--ti-input-text-color-disabled)!important;cursor:not-allowed}:host[disabled] .ti3-menu-toggle-menu:after{border-top-color:var(--ti-input-text-color-disabled)!important}.ti3-menu-border-drop ti-menulist{max-height:inherit;overflow-y:auto}.ti3-menu-border-drop ti-menulist .ti3-menu-panel-list{padding-left:var(--ti-common-space-10);padding-right:var(--ti-common-space-10)}"]
            },] }
];
TiMenuComponent.propDecorators = {
    panelAlign: [{ type: Input }],
    items: [{ type: Input }],
    panelMaxWidth: [{ type: Input }],
    panelMaxHeight: [{ type: Input }],
    labelKey: [{ type: Input }],
    mytoggleRef: [{ type: ViewChild, args: ['mytoggle', { static: true },] }],
    dropComs: [{ type: ViewChildren, args: [TiDropComponent,] }],
    listComs: [{ type: ViewChildren, args: [TiMenuListComponent,] }],
    firstTemplate: [{ type: ContentChild, args: [TemplateRef, /* TODO: add static flag */ { static: true },] }],
    itemTemplate: [{ type: ContentChild, args: ['item', /* TODO: add static flag */ { static: true },] }],
    tipTemplate: [{ type: ContentChild, args: ['tip', /* TODO: add static flag */ { static: false },] }],
    select: [{ type: Output }],
    beforeOpen: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlNZW51Q29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvbWVudS9UaU1lbnVDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUNuRSxTQUFTLEVBQWlCLFdBQVcsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDdkQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDNUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBb0M1Qzs7Ozs7O0dBTUc7QUFTSCxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxlQUFlO0lBUnBEOztRQVNNOztXQUVHO1FBQ00sZUFBVSxHQUFxQixPQUFPLENBQUM7UUFLaEQ7O1dBRUc7UUFDTSxrQkFBYSxHQUFXLFFBQVEsQ0FBQztRQUMxQzs7V0FFRztRQUNNLG1CQUFjLEdBQVcsUUFBUSxDQUFDO1FBQzNDOztXQUVHO1FBQ00sYUFBUSxHQUFXLE9BQU8sQ0FBQyxDQUFDLFdBQVc7UUFtQmhEOztXQUVHO1FBQ2dCLFdBQU0sR0FBNkIsSUFBSSxZQUFZLEVBQWMsQ0FBQztRQUNyRjs7V0FFRztRQUNnQixlQUFVLEdBQWtDLElBQUksWUFBWSxFQUFtQixDQUFDO1FBQ25HOzs7V0FHRztRQUNJLGFBQVEsR0FBNkIsRUFBRSxDQUFDO1FBQy9DOzs7V0FHRztRQUNJLG1CQUFjLEdBQVcsTUFBTSxDQUFDO0lBaVA3QyxDQUFDO0lBeE9LLFFBQVE7UUFDRixpQkFBaUI7UUFDakIs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dGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIENvbnRlbnRDaGlsZCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT3V0cHV0LFxyXG4gICAgICBRdWVyeUxpc3QsIFNpbXBsZUNoYW5nZXMsIFRlbXBsYXRlUmVmLCBWaWV3Q2hpbGQsIFZpZXdDaGlsZHJlbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUaUZvcm1Db21wb25lbnQgfSBmcm9tICcuLi9iYXNlL1RpQmFzZU1vZHVsZSc7XHJcbmltcG9ydCB7IFRpRHJvcENvbXBvbmVudCB9IGZyb20gJy4uL2Ryb3AvVGlEcm9wTW9kdWxlJztcclxuaW1wb3J0IHsgVGlNZW51TGlzdENvbXBvbmVudCB9IGZyb20gJy4vVGlNZW51TGlzdENvbXBvbmVudCc7XHJcbmltcG9ydCB7IFRpS2V5bWFwIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCB7IFRpUG9zaXRpb25UeXBlIH0gZnJvbSAnLi4vLi4vdXRpbHMvUG9zaXRpb24nO1xyXG4vLyBUT0RPOiBiZWZvck9wZW7lu7bml7bmiZPlvIDvvIzpnIDopoHliqjmgIHovazlnIjnrYnlvoVcclxuLyoqXHJcbiAqIE1lbnVJdGVt5pivaXRlbemhueeahOaVsOaNruaOpeWPo1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUaU1lbnVJdGVtIHtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIOiuvue9ruW9k+WJjeiPnOWNlemhueaWh+acrOWGheWuuTtcclxuICAgICAgICovXHJcbiAgICAgIGxhYmVsPzogc3RyaW5nO1xyXG4gICAgICAvKipcclxuICAgICAgICog6K6+572u5b2T5YmN6I+c5Y2V6aG5dGlw5o+Q56S65YaF5a65XHJcbiAgICAgICAqL1xyXG4gICAgICB0aXA/OiBzdHJpbmc7XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDorr7nva7lvZPliY3oj5zljZXpobl0aXDmj5DnpLrkvY3nva7vvIzpu5jorqTlgLzkuLrvvJpyaWdodO+8m1xyXG4gICAgICAgKi9cclxuICAgICAgdGlwUG9zaXRpb24/OiBUaVBvc2l0aW9uVHlwZTtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIOiuvue9ruW9k+WJjeiPnOWNlemhueaYr+WQpue9rueBsO+8m1xyXG4gICAgICAgKi9cclxuICAgICAgZGlzYWJsZWQ/OiBib29sZWFuO1xyXG4gICAgICAvKipcclxuICAgICAgICog6K6+572u5b2T5YmN6I+c5Y2V6aG555qE5a2Q6I+c5Y2V6aG577yM6K+l5pWw57uE55qE5q+P5Liq5YWD57Sg6YO95piv5LiA5Liq5a+56LGh77yM5a+55bqU5a2Q6I+c5Y2V6aG555qE5LiA6aG577yMXHJcbiAgICAgICAqL1xyXG4gICAgICBjaGlsZHJlbj86IEFycmF5PFRpTWVudUl0ZW0+O1xyXG4gICAgICAvKipcclxuICAgICAgICog6K6+572u5LiL5ouJ6Z2i5p2/5LiN5ZCM57uE5LmL6Ze05aKe5Yqg5YiG5Ymy57q/77yM5a6e546w5YiG57uE55qE5pWI5p6c44CC5YW25bGe5oCn5Lmf5pivdGl0bGXjgIF0aXDjgIFkaXNhYmxl44CBY2xpY2vlkoxjaGlsZHJlbnPjgILms6jmhI/vvJptZW5157uE5Lu25pyA5aSa5pSv5oyBM+e6p+iPnOWNleOAgiDmn6XnnIvnpLrkvotcclxuICAgICAgICovXHJcbiAgICAgIGdyb3VwSWQ/OiBzdHJpbmc7XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDlhYHorrjmnInlpJrkvZnnmoTlsZ7mgKflrZfmrrVcclxuICAgICAgICovXHJcbiAgICAgIFtwcm9wTmFtZTogc3RyaW5nXTogYW55O1xyXG59XHJcbi8qKlxyXG4gKiBNZW516I+c5Y2V57uE5Lu2XHJcbiAqXHJcbiAqIOaPkOS+m+S6huS4gOenjeaWueS+v+eahOeUn+aIkOiPnOWNleS4i+aLieWIl+ihqOeahOaWueW8j++8jOaPkOS+m+WIhue7hOOAgeiHquWumuS5ieWGheWuueetieWKn+iDveOAglxyXG4gKlxyXG4gKiA8ZXhhbXBsZS11cmw+Li4vdGlueTNkZW1vLyMvbWVudS9tZW51LWFsbDwvZXhhbXBsZS11cmw+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgICAgc2VsZWN0b3I6ICd0aS1tZW51JyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICcuL21lbnUuaHRtbCcsXHJcbiAgICAgIHN0eWxlVXJsczogWycuL21lbnUubGVzcyddLFxyXG4gICAgICBob3N0OiB7XHJcbiAgICAgICAgICAgICcoYmx1ciknOiAnb25CbHVyKCknXHJcbiAgICAgIH1cclxufSlcclxuZXhwb3J0IGNsYXNzIFRpTWVudUNvbXBvbmVudCBleHRlbmRzIFRpRm9ybUNvbXBvbmVudCB7ICAvLyDmnKzlupTnu6fmib/oh6pCYXNlQ29tcO+8jOS9huaYr+aDs+imgUHmoIfnrb7nhKbngrnlip/og71cclxuICAgICAgLyoqXHJcbiAgICAgICAqIOS4i+aLieiPnOWNlemdouadv+S4juaMiemSruWvuem9kOaWueW8j+OAglxyXG4gICAgICAgKi9cclxuICAgICAgQElucHV0KCkgcGFuZWxBbGlnbjogJ2xlZnQnIHwgJ3JpZ2h0JyA9ICdyaWdodCc7XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDkuIvmi4npnaLmnb/lhoXlrrlcclxuICAgICAgICovXHJcbiAgICAgIEBJbnB1dCgpIGl0ZW1zOiBBcnJheTxUaU1lbnVJdGVtPjtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIOS4i+aLiemdouadv+acgOWkp+WuveW6pu+8jOi2hei/h+aXtuaNouihjO+8jOWvueaJgOacieWtkOiPnOWNlemDveeUn+aViOOAglxyXG4gICAgICAgKi9cclxuICAgICAgQElucHV0KCkgcGFuZWxNYXhXaWR0aDogc3RyaW5nID0gJzk5OTlweCc7XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDkuIvmi4npnaLmnb/mnIDlpKfpq5jluqbvvIzotoXov4fml7blh7rnjrDnq5blkJHmu5rliqjmnaHvvIzlr7nmiYDmnInlrZDoj5zljZXpg73nlJ/mlYjjgIJcclxuICAgICAgICovXHJcbiAgICAgIEBJbnB1dCgpIHBhbmVsTWF4SGVpZ2h0OiBzdHJpbmcgPSAnOTk5OXB4JztcclxuICAgICAgLyoqXHJcbiAgICAgICAqIOimgeaYvuekuuaWh+Wtl+eahOmUruWAvFxyXG4gICAgICAgKi9cclxuICAgICAgQElucHV0KCkgbGFiZWxLZXk6IHN0cmluZyA9ICdsYWJlbCc7IC8vIGxhYmVsS2V5XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAaWdub3JlXHJcbiAgICAgICAqL1xyXG4gICAgICBAVmlld0NoaWxkKCdteXRvZ2dsZScsIHsgc3RhdGljOiB0cnVlIH0pICBteXRvZ2dsZVJlZjogRWxlbWVudFJlZjtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICovXHJcbiAgICAgIEBWaWV3Q2hpbGRyZW4oVGlEcm9wQ29tcG9uZW50KSBkcm9wQ29tczogUXVlcnlMaXN0PFRpRHJvcENvbXBvbmVudD47XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAaWdub3JlXHJcbiAgICAgICAqL1xyXG4gICAgICBAVmlld0NoaWxkcmVuKFRpTWVudUxpc3RDb21wb25lbnQpIGxpc3RDb21zOiBRdWVyeUxpc3Q8VGlNZW51TGlzdENvbXBvbmVudD47XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAaWdub3JlXHJcbiAgICAgICAqL1xyXG4gICAgICBAQ29udGVudENoaWxkKFRlbXBsYXRlUmVmLCAvKiBUT0RPOiBhZGQgc3RhdGljIGZsYWcgKi8geyBzdGF0aWM6IHRydWUgfSkgZmlyc3RUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgICAgQENvbnRlbnRDaGlsZCgnaXRlbScsIC8qIFRPRE86IGFkZCBzdGF0aWMgZmxhZyAqLyB7IHN0YXRpYzogdHJ1ZSB9KSBpdGVtVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47IC8vIOiHquWumuS5iWxpc3TkuK3nmoRpdGVt55qE5qih5p2/XHJcbiAgICAgIEBDb250ZW50Q2hpbGQoJ3RpcCcsIC8qIFRPRE86IGFkZCBzdGF0aWMgZmxhZyAqLyB7IHN0YXRpYzogZmFsc2UgfSkgdGlwVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47IC8vIOiHquWumuS5iWxpc3TkuK3nmoR0aXDnmoTmqKHmnb9cclxuICAgICAgLyoqXHJcbiAgICAgICAqIOmAieS4reiPnOWNlemhueS6i+S7tlxyXG4gICAgICAgKi9cclxuICAgICAgQE91dHB1dCgpIHJlYWRvbmx5IHNlbGVjdDogRXZlbnRFbWl0dGVyPFRpTWVudUl0ZW0+ID0gbmV3IEV2ZW50RW1pdHRlcjxUaU1lbnVJdGVtPigpO1xyXG4gICAgICAvKipcclxuICAgICAgICog5omT5byA6Z2i5p2/5LmL5YmN77yM6YCa55+l5LqL5Lu244CC5a6M5YWo5Lqk57uZ5Lia5Yqh55So5oi35aSE55CG44CCXHJcbiAgICAgICAqL1xyXG4gICAgICBAT3V0cHV0KCkgcmVhZG9ubHkgYmVmb3JlT3BlbjogRXZlbnRFbWl0dGVyPFRpTWVudUNvbXBvbmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPFRpTWVudUNvbXBvbmVudD4oKTtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICogaXRlbXNBcnJbMF3lrZjmlL7moLnpnaLmnb/lhoXlrrnvvIxpdGVtQXJyWzFd5a2Y5pS+5qyh57qn6Z2i5p2/5YaF5a6577yMaXRlbUFyclsyXeWtmOaUvuasoeasoee6p+mdouadv+WGheWuuVxyXG4gICAgICAgKi9cclxuICAgICAgcHVibGljIGl0ZW1zQXJyOiBBcnJheTxBcnJheTxUaU1lbnVJdGVtPj4gPSBbXTtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICogIOS4juW8gOWFs+i3neemu1xyXG4gICAgICAgKi9cclxuICAgICAgcHVibGljIGRvbWluYXRvclNwYWNlOiBzdHJpbmcgPSAnMTBweCc7XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiAg5Li6dHJ1ZeaXtuS4umJ1dHRvbnNlbGVjdOe7hOS7tlxyXG4gICAgICAgKi9cclxuICAgICAgcHVibGljIGhhc0JvcmRlcjogYm9vbGVhbjtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIG1lbnVsaXN05pyA5aSn6auY5bqmXHJcbiAgICAgICAqL1xyXG4gICAgICBwdWJsaWMgbWVudWxpc3RNYXhIZWlnaHQ6IG51bWJlcjtcclxuICAgICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIC8vIOWfuuexu+S4reWBmuS6huiuvue9ruWuv+S4u2lk55qE5pON5L2cXHJcbiAgICAgICAgICAgIHN1cGVyLm5nT25Jbml0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzQm9yZGVyID0gdGhpcy5uYXRpdmVFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnaGFzYm9yZGVyJyk7XHJcbiAgICAgIH1cclxuICAgICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzYWJsZUVsZW1zKFt0aGlzLm15dG9nZ2xlUmVmLm5hdGl2ZUVsZW1lbnRdKTtcclxuICAgICAgICAgICAgc3VwZXIubmdPbkNoYW5nZXMoY2hhbmdlcyk7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzWydpdGVtcyddKSB7IC8vIOWklumDqOS/ruaUuXNob3flsZ7mgKfnmoTlpITnkIbvvIzliJ3lp4vlrprkuYnlnKhuZ09uSW5pdOS4reWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zQXJyWzBdID0gdGhpcy5pdGVtcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiDlhbzlrrnml6fniYjvvJpcclxuICAgICAgICogMTAuMC4zIOeJiOacrOS5i+WJjeWPquiDveWGheW1jOS4gOS4quaooeadv++8jOaXoOWRveWQjeOAglxyXG4gICAgICAgKiDmlrDniYjlj6/ku6XlhoXltYzkuKTkuKrmqKHmnb/vvIznpLrkvovkuablhpnopoHmsYLpg73lkb3lkI3vvIgjaXRlbe+8jCN0aXDvvInjgIJcclxuICAgICAgICog5L2G6ZyA6KaB5YW85a655pen54mI5peg5ZG95ZCN5rWL6K+V55So5L6L44CCXHJcbiAgICAgICAqL1xyXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHVzZS1saWZlLWN5Y2xlLWludGVyZmFjZVxyXG4gICAgICBuZ0FmdGVyQ29udGVudEluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHN1cGVyLm5nQWZ0ZXJDb250ZW50SW5pdCgpO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpwgaXRlbSDmqKHmnb/kuLrnqbogJiYg5a2Y5Zyo56ys5LiA5Liq5qih5p2/77yM6YKj5LmI5oqK56ys5LiA5Liq5Ye6546w55qEIOKAnOmdniN0aXAg5qCH562+4oCdIOeahOaooeadv+S9nOS4uiBpdGVtIOaooeadv1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXRlbVRlbXBsYXRlICYmIHRoaXMuZmlyc3RUZW1wbGF0ZVxyXG4gICAgICAgICAgICAgICAgJiYgKHRoaXMuZmlyc3RUZW1wbGF0ZS5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQgIT09ICh0aGlzLnRpcFRlbXBsYXRlICYmIHRoaXMudGlwVGVtcGxhdGUuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KSkpIHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtVGVtcGxhdGUgPSB0aGlzLmZpcnN0VGVtcGxhdGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvKipcclxuICAgICAgICog5omT5byA6Z2i5p2/XHJcbiAgICAgICAqL1xyXG4gICAgICBwdWJsaWMgb3BlbigpOiB2b2lkIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOaJk+W8gOmdouadv+WJjemHjee9rm1lbnVsaXN05pyA5aSn6auY5bqmXHJcbiAgICAgICAgICAgIHRoaXMuaW5pdExpc3RNYXhIZWlnaHQoKTtcclxuICAgICAgICAgICAgdGhpcy5kcm9wQ29tcy5maXJzdC5zaG93KCk7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdENvbXMuZmlyc3QuaG92ZXJPcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAvLyDmoLnmja5kcm9w55qE5pyA5aSn6auY5bqm6K6+572ubWVudWxpc3TmnIDlpKfpq5jluqZcclxuICAgICAgICAgICAgdGhpcy5yZXN0eWxlTGlzdE1heEhlaWdodCgpO1xyXG4gICAgICAgICAgICAvLyBJRea7muWKqOadoUJ1Z+eahOebkeWQrFxyXG4gICAgICAgICAgICB0aGlzLmxpc3RDb21zLnRvQXJyYXkoKS5mb3JFYWNoKGxpc3RDb20gPT4ge1xyXG4gICAgICAgICAgICAgICAgICBsaXN0Q29tLmxpc3RlbklFU3JvbGxiYXJCdWcoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgICAvKipcclxuICAgICAgICog5YWz6Zet6Z2i5p2/XHJcbiAgICAgICAqL1xyXG4gICAgICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJvcENvbXMuZmlyc3QuaGlkZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm9uSG92ZXIobnVsbCwgMCk7XHJcbiAgICAgICAgICAgIC8vIOino+mZpElF5rua5Yqo5p2hQnVn55qE55uR5ZCsXHJcbiAgICAgICAgICAgIHRoaXMubGlzdENvbXMudG9BcnJheSgpLmZvckVhY2gobGlzdENvbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGxpc3RDb20udW5saXN0ZW5JRVNyb2xsYmFyQnVnKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgICAgLyoqXHJcbiAgICAgICAqIOWIh+aNoumdouadv+eKtuaAge+8muaJk+W8gC/lhbPpl61cclxuICAgICAgICovXHJcbiAgICAgIHB1YmxpYyB0b2dnbGUoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJvcENvbXMuZmlyc3QuaXNTaG93ID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7XHJcbiAgICAgIH1cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICovXHJcbiAgICAgIHB1YmxpYyBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX1NQQUNFOiAvLyDljp/nlJ9TUEFDRemUruS7heWPr+aJk+W8gOOAguS9hlRpbnkyLDPpg73ot59FbnRlcumUruS/neaMgeS4gOiHtFxyXG4gICAgICAgICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9FTlRFUjogLy8gRU5URVLplK4g55u45b2T5LqOY2xpY2tcclxuICAgICAgICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfTlVNUEFEX0VOVEVSOiAvLyBFTlRFUumUrijoi7nmnpzmlbDlrZflsI/plK7nm5gpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOesrOS4gOe6p+W3suaJk+W8gO+8jOS9huaXoOmAieS4remhueOAguaIluiAheesrOS4gOe6p+ayoeacieaJk+W8gOOAguebuOW9k+S6jum8oOagh+eCueWHu+mAu+i+keOAglxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHRoaXMuZHJvcENvbXMuZmlyc3QuaXNTaG93ICYmICF0aGlzLmxpc3RDb21zLnRvQXJyYXkoKVswXS5ob3Zlck9wdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgIXRoaXMuZHJvcENvbXMuZmlyc3QuaXNTaG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Nb3VzZWRvd24obnVsbCk7IC8vIOebuOW9k+S6jum8oOagh+eCueWHu1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8g5rOo5oSPOmJyZWFr5ZyoaWblhoXvvIzlpoLmnpxpZuS4jea7oei2s++8jOWImei1sOWIsGRlZmF1bHTvvIxsaXN05aSE55CG5oyJ6ZSuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgLy8g5LiK6Z2i55qE5Zue6L2m6ZSuLCDlj6/og73nu6fnu63otbDliLDkuIvpnaLliIbmlK/jgIJcclxuICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLXN3aXRjaC1jYXNlLWZhbGwtdGhyb3VnaFxyXG4gICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2hcclxuICAgICAgICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfQVJST1dfTEVGVDogLy8g5bem5Y+z566t5aS077yM54Sm54K55Zyo5bem5Y+z6Z2i5p2/6L2s56e7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX0FSUk9XX1JJR0hUOiAvLyDlt6blj7Pnrq3lpLTvvIznhKbngrnlnKjlt6blj7PpnaLmnb/ovaznp7tcclxuICAgICAgICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfQVJST1dfVVA6IC8vIOS4iuS4i+eureWktO+8jOS4iuS4i+enu+WKqOmAieS4remhuVxyXG4gICAgICAgICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9BUlJPV19ET1dOOiAvLyDkuIrkuIvnrq3lpLTvvIzkuIrkuIvnp7vliqjpgInkuK3poblcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMuZHJvcENvbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsgLy8g5a+75om+5pyr5bC+6Z2i5p2/5LiU5pyJaG92ZXLvvIxsaXN05aSE55CG5oyJ6ZSuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRyb3BDb21zLnRvQXJyYXkoKVtpXS5pc1Nob3cgJiYgdGhpcy5saXN0Q29tcy50b0FycmF5KClbaV0uaG92ZXJPcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbktleWRvd25MYXN0SG92ZXJMaXN0KGV2ZW50LCBpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyZWFrOyAvL+i/memHjOinpuWPkeS6hmZvcuW+queOr+eahGJyZWFr77yb5bm25rKh5pyJ6LWw5Yiwc3dpdGNo55qEYnJlYWs75omA5Lul5pS55Li6cmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmsqHmnIlob3ZlcueahOmdouadv++8jOmCo+S5iOesrOS4gOe6p+mdouadv++8iOiCr+WumuaYr+WxleW8gOeahO+8ieWkhOeQhuaMiemUrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDb21zLmZpcnN0Lm9uS2V5ZG93bihldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHByaXZhdGUgb25LZXlkb3duTGFzdEhvdmVyTGlzdChldmVudDogS2V5Ym9hcmRFdmVudCwgaTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9BUlJPV19MRUZUOiAvLyDlt6blj7Pnrq3lpLTvvIznhKbngrnlnKjlt6blj7PpnaLmnb/ovaznp7tcclxuICAgICAgICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfQVJST1dfUklHSFQ6IC8vIOW3puWPs+eureWktO+8jOeEpueCueWcqOW3puWPs+mdouadv+i9rOenu1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHRoaXMucGFuZWxBbGlnbiA9PT0gJ3JpZ2h0JyAmJiBldmVudC5rZXlDb2RlID09PSBUaUtleW1hcC5LRVlfQVJST1dfTEVGVClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgKHRoaXMucGFuZWxBbGlnbiA9PT0gJ2xlZnQnICYmIGV2ZW50LmtleUNvZGUgPT09IFRpS2V5bWFwLktFWV9BUlJPV19SSUdIVCkpIHsgLy8g5qyh57qn6Z2i5p2/5pa55ZCR6ZSuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICsgMSA8IHRoaXMuZHJvcENvbXMubGVuZ3RoICYmIHRoaXMuZHJvcENvbXMudG9BcnJheSgpW2kgKyAxXS5pc1Nob3cpIHsvLyDmrKHnuqflrZjlnKjkuJTlsZXlvIBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q29tcy50b0FycmF5KClbaSArIDFdLm5leHRPcHRpb24oZmFsc2UpOyAvLyDmrKHnuqfpnaLmnb9ob3ZlcueUsW51bGzmlLnkuLrkuIvkuIDkuKpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyDkuIrnuqfpnaLmnb/mlrnlkJHplK5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q29tcy50b0FycmF5KClbaV0uaG92ZXJPcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9TUEFDRTogLy8g5Y6f55SfU1BBQ0XplK7ku4Xlj6/miZPlvIDjgILkvYZUaW55Miwz6YO96LefRW50ZXLplK7kv53mjIHkuIDoh7RcclxuICAgICAgICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfRU5URVI6IC8vIEVOVEVS6ZSuIOebuOW9k+S6jmNsaWNrXHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX05VTVBBRF9FTlRFUjogLy8gRU5URVLplK4o6Iu55p6c5pWw5a2X5bCP6ZSu55uYKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubGlzdENvbXMudG9BcnJheSgpW2ldLmlzR3JvdXAodGhpcy5saXN0Q29tcy50b0FycmF5KClbaV0uaG92ZXJPcHRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENvbXMudG9BcnJheSgpW2ldLm9uS2V5ZG93bihldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IC8vIOS4iuS4i+mUruetie+8jOWSjOS4iumdoueahOWbnui9pumUruS5n+S8mui1sOWIsOi/memHjOOAglxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDb21zLnRvQXJyYXkoKVtpXS5vbktleWRvd24oZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAaWdub3JlXHJcbiAgICAgICAqL1xyXG4gICAgICBwdWJsaWMgb25Nb3VzZWRvd24oZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZHJvcENvbXMuZmlyc3QuaXNTaG93KSB7IC8vIOW3suaJk+W8gO+8jOWImeWFs+mXrVxyXG4gICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5iZWZvcmVPcGVuLm9ic2VydmVycy5sZW5ndGggPT09IDApIHsgLy8g5bey5omT5byA77yM5LiU5pegYmVmb3JlT3Blbu+8jOWImeaJk+W8gFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLm9wZW4oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHsgLy8g5bey5omT5byA77yM5pyJYmVmb3JlT3BlblxyXG4gICAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZU9wZW4uZW1pdCh0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAaWdub3JlXHJcbiAgICAgICAqL1xyXG4gICAgICBwdWJsaWMgb25TZWxlY3QocGFuZWxJbmRleDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQodGhpcy5saXN0Q29tcy50b0FycmF5KClbcGFuZWxJbmRleF0ubW9kZWwpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICovXHJcbiAgICAgIHB1YmxpYyBvbkJsdXIoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgICAvKipcclxuICAgICAgICogQGlnbm9yZVxyXG4gICAgICAgKi9cclxuICAgICAgcHVibGljIG9uSG92ZXIoaXRlbTogYW55LCBwYW5lbEluZGV4OiBudW1iZXIpOiB2b2lkIHsgLy8g5b2TaXRlbeS4uuepuu+8jOihqOekuum8oOagh+enu+WHuuW9k+WJjemdouadv++8jOS5n+mcgOimgeWFs+mXreasoee6p+mdouadv+OAglxyXG4gICAgICAgICAgICBpZiAocGFuZWxJbmRleCArIDEgPT09IHRoaXMuZHJvcENvbXMubGVuZ3RoKSB7Ly8g5b2T5YmNaG92ZXLpnaLmnb/vvIzlt7Lnu4/mmK/mnIDlkI7kuIDnuqfpnaLmnb9cclxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGRyb3BDb21BcnI6IEFycmF5PFRpRHJvcENvbXBvbmVudD4gPSB0aGlzLmRyb3BDb21zLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgY29uc3QgbGlzdENvbUFycjogQXJyYXk8VGlNZW51TGlzdENvbXBvbmVudD4gPSB0aGlzLmxpc3RDb21zLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgaWYgKGl0ZW0gJiYgbGlzdENvbUFycltwYW5lbEluZGV4XS5pc0dyb3VwKGl0ZW0pICYmICFsaXN0Q29tQXJyW3BhbmVsSW5kZXhdLmlzRGlzYWJsZWRGbihpdGVtKSkgeyAvLyDmoLnmja7mlbDmja7vvIzmmK/lkKblsZXlvIDkuIvkuIDnuqdcclxuICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtc0FycltwYW5lbEluZGV4ICsgMV0gPSBpdGVtLmNoaWxkcmVuOyAvLyDkuIvkuIDnuqfmlbDmja7vvIzotYvmlrDlgLzjgIJcclxuICAgICAgICAgICAgICAgICAgbGlzdENvbUFycltwYW5lbEluZGV4ICsgMV0uaG92ZXJPcHRpb24gPSBudWxsOyAvLyDkuIvkuIDnuqfpnaLmnb/otYvnqbpob3Zlck9wdGlvbu+8jOS8muinpuWPkW9uSG92ZXLvvIzov5vogIzlhbPpl63kuIvkuIDnuqfpnaLmnb/nmoTlkI7nu63pnaLmnb/jgIJcclxuICAgICAgICAgICAgICAgICAgLy8g6LWL5paw5YC85Lul5ZCO77yM562J5qih5p2/5pyJ5LqG5paw55qE5bC65a+477yM5YaN5by55Ye644CCXHJcbiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50UGFuZWw6IEhUTUxFbGVtZW50ID0gZHJvcENvbUFycltwYW5lbEluZGV4XS5uYXRpdmVFbGVtZW50OyAvLyDlvZPliY3pnaLmnb/lhYPntKBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFBhbmVsOiBIVE1MRWxlbWVudCA9IGRyb3BDb21BcnJbcGFuZWxJbmRleCArIDFdLm5hdGl2ZUVsZW1lbnQ7IC8vIOS4i+S4gOe6p+mdouadv+WFg+e0oFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcENvbUFycltwYW5lbEluZGV4ICsgMV0uc2hvdygpOyAvLyDmiZPlvIDkuIvkuIDnuqfpnaLmnb9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5L2N572u6LCD5pW077yMWOaWueWQkSAvLyBUT0RPOiDkvb/nlKhQb3NpdGlvbuaYr+WQpuWPr+ihjO+8n1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWZ0T2Zmc2V0OiBudW1iZXIgPSAodGhpcy5wYW5lbEFsaWduID09PSAnbGVmdCcpID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhbmVsLm9mZnNldExlZnQgKyBjdXJyZW50UGFuZWwub2Zmc2V0V2lkdGggOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGFuZWwub2Zmc2V0TGVmdCAtIG5leHRQYW5lbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFBhbmVsLnN0eWxlLmxlZnQgPSBgJHtsZWZ0T2Zmc2V0fXB4YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5L2N572u6LCD5pW077yMWeaWueWQkVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtSW5kZXg6IG51bWJlciA9IHRoaXMuaXRlbXNBcnJbcGFuZWxJbmRleF0uaW5kZXhPZihpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbUVsZW06IGFueSA9IGxpc3RDb21BcnJbcGFuZWxJbmRleF0ubmF0aXZlRWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnTEknKVtpdGVtSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlvZPliY1saei3neemu+mdouadv+mhtumDqOeahOi3neemuyA9IOW9k+WJjWxp6Led56a75Y+v6KeG5Yy66aG26YOo55qE6Led56a7IC0g5b2T5YmN6Z2i5p2/5Yiw5Y+v6KeG5Yy66aG26YOo55qE6Led56a7O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtRWxtVG9wOiBudW1iZXIgPSBpdGVtRWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSBjdXJyZW50UGFuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlvZPliY1saei3neemu+mhtemdouW6lemDqOeahOi3neemuyA9IOWPr+inhuWMuueql+WPo+mrmOW6piArIOaWh+aho+a7muWKqOmrmOW6piAtIOW9k+WJjemdouadv+eahG9mZnNldFRvcCAtIOW9k+WJjWxp6Led56a76Z2i5p2/6aG26YOo55qE6Led56a7O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib3R0b21PZmZzZXQ6IG51bWJlciA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIC1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhbmVsLm9mZnNldFRvcCAtIGl0ZW1FbG1Ub3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS4i+S4gOe6p+mdouadv+eahOeahOmrmOW6plxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtSGVpZ2h0OiBudW1iZXIgPSBuZXh0UGFuZWwub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlupXpg6jnqbrpl7Tog73mlL7kuIvkuIvkuIDnuqfpnaLmnb/vvJrkuIvkuIDnuqfpnaLmnb/nmoR0b3AgPSDlvZPliY3pnaLmnb/nmoRvZmZzZXRUb3AgKyDlvZPliY1saei3neemu+mdouadv+mhtumDqOeahOi3neemuyAtIOmdouadv+eahOS4iuS4i+eVmeeZvVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0UGFuZWxUb3A6IG51bWJlciA9IGN1cnJlbnRQYW5lbC5vZmZzZXRUb3AgKyBpdGVtRWxtVG9wIC0gNDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvdHRvbU9mZnNldCA+IGl0ZW1IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFBhbmVsLnN0eWxlLnRvcCA9IG5leHRQYW5lbFRvcCArICdweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW6lemDqOepuumXtOS4jei2s++8jOWSjOa1j+iniOWZqOW6lemDqOWvuem9kFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0UGFuZWwuc3R5bGUudG9wID0gbmV4dFBhbmVsVG9wICsgYm90dG9tT2Zmc2V0IC0gaXRlbUhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAvLyDlvZNob3ZlcuWIsOWFt+S9k+mhueebru+8iOmdnuWIhue7hO+8ieaIliBudWxs77yI56e75Ye65b2T5YmN6Z2i5p2/77yJ77yM6ZyA6KaB6Zet5ZCI5omA5pyJ5ZCO57ut6Z2i5p2/XHJcbiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGk6IG51bWJlciA9IHBhbmVsSW5kZXggKyAxOyBpIDwgZHJvcENvbUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wQ29tQXJyW2ldLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBpZ25vcmVcclxuICAgICAgICovXHJcbiAgICAgIHB1YmxpYyBvbk1vdXNlb3V0RHJvcChldmVudDogTW91c2VFdmVudCwgcGFuZWxJbmRleDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgICAgIC8vIOm7mOiupOmcgOimgemakOiXjywg6Zmk6Z2e6byg5qCH6L+b5YWl6Z2i5p2/5Yy65Z+f44CCXHJcbiAgICAgICAgICAgIGZvciAobGV0IGk6IG51bWJlciA9IDA7IGkgPCB0aGlzLmRyb3BDb21zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGRyb3BSZWN0OiBET01SZWN0ID0gdGhpcy5kcm9wQ29tcy50b0FycmF5KClbaV0ubmF0aXZlRWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAvLyDlm6DkuLrmhaLmhaLnp7vlh7rmnKzpnaLmnb/ml7bvvIznp7vlh7rpvKDmoIfkuovku7bkvp3nhLblgZznlZnlnKjmnKzpnaLmnb/lhoXvvIgxcHjor6/lt67vvInvvIzmiYDku6XpnaLmnb9yZWN05Zub5ZGo6IyD5Zu06KaB5pu05bCPMXB444CCXHJcbiAgICAgICAgICAgICAgICAgIGlmIChkcm9wUmVjdC5sZWZ0IDwgZXZlbnQuY2xpZW50WCAmJiBldmVudC5jbGllbnRYIDwgZHJvcFJlY3QucmlnaHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZHJvcFJlY3QudG9wIDwgZXZlbnQuY2xpZW50WSAmJiBldmVudC5jbGllbnRZIDwgZHJvcFJlY3QuYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOe7meesrOS4gOe6p+mdouadv+e9ruaXoOmAieS4re+8jOmCo+S5iOasoee6p+mdouadv+iHqueEtuS8muWFs+mXreOAglxyXG4gICAgICAgICAgICB0aGlzLmxpc3RDb21zLmZpcnN0LmhvdmVyT3B0aW9uID0gbnVsbDsgLy8g5Lya6Kem5Y+R5Yiw5LiK6Z2idGhpcy5vbkhvdmVyKG51bGwsIDApO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIOWIneWni+WMlm1lbnVsaXN05pyA5aSn6auY5bqmXHJcbiAgICAgIHB1YmxpYyBpbml0TGlzdE1heEhlaWdodCgpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5tZW51bGlzdE1heEhlaWdodCA9IHBhcnNlSW50KHRoaXMucGFuZWxNYXhIZWlnaHQsIDEwKTtcclxuICAgICAgICAgICAgdGhpcy5saXN0Q29tcy50b0FycmF5KCkuZm9yRWFjaChsaXN0Q29tID0+IHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShsaXN0Q29tLm5hdGl2ZUVsZW1lbnQsICdtYXgtaGVpZ2h0JywgdGhpcy5tZW51bGlzdE1heEhlaWdodCArICdweCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgIC8vIOiAg+iZkWRyb3DnmoTljovnvKnmg4XlhrXvvIzorr7nva5tZW51bGlzdOeahG1heC1oZWlnaHRcclxuICAgICAgcHVibGljIHJlc3R5bGVMaXN0TWF4SGVpZ2h0KCk6IHZvaWQge1xyXG4gICAgICAgICAgICBjb25zdCBkcm9wQ3VyTWF4SGVpZ2h0OiBudW1iZXIgPSBwYXJzZUludCh0aGlzLmRyb3BDb21zLmZpcnN0Lm5hdGl2ZUVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0LCAxMCk7XHJcbiAgICAgICAgICAgIGlmICghaXNOYU4oZHJvcEN1ck1heEhlaWdodCkgJiYgZHJvcEN1ck1heEhlaWdodCA8IHRoaXMubWVudWxpc3RNYXhIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q29tcy50b0FycmF5KCkuZm9yRWFjaChsaXN0Q29tID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShsaXN0Q29tLm5hdGl2ZUVsZW1lbnQsICdtYXgtaGVpZ2h0JywgIGRyb3BDdXJNYXhIZWlnaHQgKyAncHgnKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgfVxyXG59Il19