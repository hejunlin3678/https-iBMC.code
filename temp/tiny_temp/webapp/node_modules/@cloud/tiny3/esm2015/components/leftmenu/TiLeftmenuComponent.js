import { Component, ElementRef, EventEmitter, Input, NgZone, Optional, Output, Renderer2, ViewEncapsulation, Inject } from '@angular/core';
import { ActivatedRoute, NavigationEnd, Router } from '@angular/router';
import { DOCUMENT } from '@angular/common';
import { Util } from '../../utils/Util';
import { TiBaseComponent } from '../base/TiBaseModule';
import { TiRenderer } from '../../services/renderer/TiRenderer';
/**
 * TiLeftmenu组件提供了一种方便灵活实现页面布局左侧菜单的方式，支持两级菜单。
 *
 * 其内部包含5个组件:
 *
 * TiLeftmenu : 左侧菜单最外层的指令；
 *
 * TiLeftmenuGroup: 菜单分组指令；
 *
 * TileftmenuGroupItem：分组文本内容指令；
 *
 * TiLeftmenuHead : 菜单头部内容指令；
 *
 * TiLeftmenuLevel1 ：一级菜单指令；
 *
 * TiLeftmenuItem ：一级菜单文本内容指令；
 *
 * TiLeftmenuLevel2 ：二级菜单指令。
 *
 * <example-url>../tiny3demo/#/leftmenu/leftmenu-all</example-url>
 */
export class TiLeftmenuComponent extends TiBaseComponent {
    constructor(elementRef, renderer2, router, activeRoute, tiRenderer, zone, document) {
        super(elementRef, renderer2);
        this.renderer2 = renderer2;
        this.router = router;
        this.activeRoute = activeRoute;
        this.tiRenderer = tiRenderer;
        this.zone = zone;
        this.document = document;
        /**
         * 激活菜单项改变时向外通知
         */
        this.activeChange = new EventEmitter();
        /**
         * 控制右侧内容区的刷新
         *
         * 注意：当重复点击当前激活菜单项时，需要刷新右侧内容区，为了实现此功能设置了该接口；
         * 该接口是双向绑定的，当重复点击当前激活菜单项时，reloadState的值会经历 true(上次的值) -> false -> true
         * 的变化过程，开发者给改接口与其右侧区域容器上ngIf接口绑定的是同一个变量，所以ngIf的值也会经历同样的变化，
         * 从而做到右侧内容区的刷新。
         */
        this.reloadState = true;
        /**
         * 右侧内容区是否需要刷新的状态值改变时向外通知
         */
        this.reloadStateChange = new EventEmitter();
        // routable接口在3.0.3版本起对外隐藏，10.0.1重新开放
        /**
         * 10.0.1新增
         *
         * 设置是否使用路由来控制菜单对应内容显示/隐藏，默认使用路由。
         */
        this.routable = true;
        /**
         * 是否开启左侧菜单面板可折叠功能，默认开启。
         */
        this.toggleable = true;
        /**
         * 左侧菜单面板是否为收起状态，用于设置面板收起/展开状态，默认展开。
         */
        this.collapsed = false;
        /**
         * 左侧菜单面板收起/展开状态改变时向外通知
         */
        this.collapsedChange = new EventEmitter();
        /**
         * @ignore
         * tiLeftmenu中包含的 TiLeftmenuLevel1Component 实例集合
         */
        this.level1Items = [];
        /**
         * @ignore
         */
        this.resolvedPromise = Promise.resolve(null);
        /**
         * 标志量，是否为url改变(需要去改变active)
         */
        this.isUrlChange = false;
    }
    // 判断item的router是否是父路由下默认激活的子路由（即子路由与父路由路径一致）
    static isDefaultActiveChildRoute(item) {
        // 默认激活的子路由的router可设为[]或['']
        return !item.router || item.router.length === 0 || item.router[0] === '';
    }
    ngOnInit() {
        super.ngOnInit();
        // 初始时右侧内容区默认显示，需使外部用户的reloadState值为true。
        // 双向绑定数据时，对初始传入的值立即修改并传出时会报错，
        // 此处参考ngModel源码setValue的处理，使用promise延后执行时序
        this.resolvedPromise.then(() => {
            this.reloadStateChange.emit(true);
        });
        this.scrollWidth = this.getScrollbarSize('Y');
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        if (!this.routable) {
            return;
        }
        // 直接输入url(刷新页面)改变状态时，leftmenu能同步修改激活状态
        const urlActiveItem = this.getActiveItemByUrl(this.level1Items);
        if (urlActiveItem) {
            // 双向绑定数据时，对初始传入的值立即修改并传出时会报错，
            // 此处参考ngModel源码setValue的处理，使用promise延后执行时序
            this.resolvedPromise.then(() => {
                if (urlActiveItem !== this.active) {
                    this.isUrlChange = true;
                    this.active = urlActiveItem;
                    this.activeChange.emit(this.active);
                }
            });
        }
        else {
            this.link();
        }
        // 从非leftMenu处跳转改变状态时，leftmenu能同步修改激活状态
        this.navigationSubscription = this.router.events.subscribe((evt) => {
            if (evt instanceof NavigationEnd) {
                const newActiveItem = this.getActiveItemByUrl(this.level1Items);
                if (newActiveItem && newActiveItem !== this.active) {
                    this.active = newActiveItem;
                    this.activeChange.emit(this.active);
                    this.isUrlChange = true;
                }
            }
        });
        this.panelContainer = this.nativeElement.querySelector('.ti3-leftmenu-panel-container');
        const headElement = this.nativeElement.querySelector('.ti3-leftmenu-head');
        let headCloneElement;
        this.zone.runOutsideAngular(() => {
            this.renderer2.listen(this.panelContainer, 'scroll', () => {
                const scrollTop = this.panelContainer.scrollTop;
                if (scrollTop > 0) {
                    if (!headCloneElement) {
                        headCloneElement = headElement.cloneNode(true);
                        this.renderer2.addClass(headCloneElement, 'ti3-leftmenu-head-clone');
                        this.renderer2.setStyle(headCloneElement, 'width', `calc(100% - ${this.scrollWidth}px)`);
                        this.nativeElement.appendChild(headCloneElement);
                    }
                }
                else if (headCloneElement) {
                    this.nativeElement.removeChild(headCloneElement);
                    headCloneElement = undefined;
                }
            });
        });
    }
    ngOnChanges(changes) {
        const activeObj = changes['active'];
        if (activeObj && !activeObj.firstChange) {
            for (const level1Item of this.level1Items) {
                level1Item.setShowChildren();
                level1Item.setActiveState();
            }
            if (this.routable && !this.isUrlChange) {
                this.link();
            }
            this.isUrlChange = false;
        }
    }
    ngOnDestroy() {
        if (this.navigationSubscription) {
            this.navigationSubscription.unsubscribe();
        }
    }
    /**
     * @ignore
     * 模板中使用
     */
    toggleClickFn() {
        this.collapsed = !this.collapsed;
        this.collapsedChange.emit(this.collapsed);
    }
    getActiveItemByUrl(arr) {
        let resultItem;
        for (const component of arr) {
            if (this.isActived(component.item)) {
                resultItem = component.item;
                if (TiLeftmenuComponent.isDefaultActiveChildRoute(component.item)) {
                    continue;
                }
                else {
                    return resultItem;
                }
            }
            if (component.children && component.children.length > 0) {
                const result = this.getActiveItemByUrl(component.children);
                if (result) {
                    return result;
                }
            }
        }
        return resultItem;
    }
    isActived(item) {
        const relativeRoute = this.getRelativeRoute(item.routerExtras);
        if (this.isMatchCurrentUrl(item.router, relativeRoute)) {
            return true;
        }
        if (Util.isArray(item.routerList) && item.routerList.length > 0) {
            for (const router of item.routerList) {
                if (this.isMatchCurrentUrl(router, relativeRoute)) {
                    return true;
                }
            }
        }
        return false;
    }
    isMatchCurrentUrl(router, relativeRoute) {
        if (!Util.isArray(router)) {
            return false;
        }
        const itemUrlTree = this.router.createUrlTree(router, relativeRoute);
        return this.router.isActive(itemUrlTree, false);
    }
    link() {
        if (this.active) {
            this.navigate(this.active);
        }
    }
    /**
     * @ignore
     */
    navigate(item) {
        if (TiLeftmenuComponent.isDefaultActiveChildRoute(item)) {
            //  routeConfig 可能为null
            if (!this.activeRoute.routeConfig) {
                return;
            }
            const path = this.activeRoute.routeConfig.path;
            const url = this.router.routerState.snapshot.url;
            const rootUrl = url.split(path)[0];
            // 绝对路径跳转
            this.router.navigate([rootUrl + path], item.routerExtras);
        }
        else {
            this.router.navigate(item.router, this.getNavigationExtras(item.routerExtras));
        }
    }
    /**
     * @ignore
     * 点击当前选中项时，触发内容区重载
     * @param item 当前点击项
     */
    triggerReload(item) {
        // 使reloadState由false变为true,配合内容区的ngIf做到内容区的重载
        this.reloadStateChange.emit(false);
        setTimeout(() => {
            this.reloadStateChange.emit(true);
            // 如果当前路由就是item.router对应路由，则此导航不作用(路由相同)；
            // 如果当前路由是item.routerList中的路由，则需要跳转到item.router对应路由
            this.navigate(item);
        }, 0);
    }
    getNavigationExtras(routerExtras) {
        return Object.assign({ relativeTo: this.activeRoute }, routerExtras);
    }
    getRelativeRoute(routerExtras) {
        if (!routerExtras || !routerExtras['relativeTo']) {
            return { relativeTo: this.activeRoute };
        }
        return { relativeTo: routerExtras['relativeTo'] };
    }
    /**
 * 得到浏览器滚动条的宽度和高度
 * 代表滚动条的方向，取值为X or Y
 */
    getScrollbarSize(direction) {
        const outerDiv = this.renderer.createElement('div');
        const innerDiv = this.renderer.createElement('div');
        this.renderer.setStyle(innerDiv, 'width', '100%');
        this.renderer.setStyle(innerDiv, 'height', '100%');
        this.renderer.appendChild(outerDiv, innerDiv);
        this.tiRenderer.setStyles(outerDiv, {
            position: 'absolute',
            top: '-9999px',
            left: '-9999px',
            width: '100px',
            height: '100px',
            overflow: 'hidden'
        });
        this.renderer.appendChild(this.document.body, outerDiv);
        const field = direction === 'X' ? 'height' : 'width';
        const noScrollSize = typeof innerDiv.getBoundingClientRect === 'function' ? innerDiv.getBoundingClientRect()[field] : 0;
        this.renderer.setStyle(outerDiv, 'overflow', 'scroll');
        const withScrollSize = typeof innerDiv.getBoundingClientRect === 'function' ? innerDiv.getBoundingClientRect()[field] : 0;
        this.document.body.removeChild(outerDiv);
        return parseFloat((noScrollSize - withScrollSize).toFixed(1));
    }
}
TiLeftmenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-leftmenu',
                template: "<div  class=\"ti3-leftmenu-panel-container\">\r\n    <div class=\"ti3-leftmenu-panel\">\r\n        <ng-content></ng-content>\r\n    </div>\r\n</div>\r\n<ng-content *ngIf='!collapsed' select=\"ti-leftmenu-foot\"></ng-content>\r\n<div class=\"ti3-leftmenu-toggle\"\r\n     *ngIf=\"toggleable\"\r\n     [ngClass]=\"{'ti3-leftmenu-toggle-show' : !collapsed,\r\n                 'ti3-leftmenu-toggle-hide' : collapsed }\"\r\n    [tabindex]=\"0\"\r\n    tiOutline\r\n    (keydown.enter)=\"toggleClickFn()\"\r\n    (click)=\"toggleClickFn()\"\r\n    [id]=\"appendId('toggle')\">\r\n</div>\r\n",
                host: {
                    '[class.ti3-leftmenu-container]': 'true',
                    '[class.ti3-leftmenu-hide]': 'collapsed'
                },
                encapsulation: ViewEncapsulation.None,
                styles: [":root{--ti-leftmenu-level2-left-line:30px;--ti-leftmenu-toggle-width:12px}.ti3-leftmenu-container{background-color:var(--ti-leftmenu-container-bg-color);bottom:0;box-shadow:var(--ti-common-shadow-1-right);display:block;left:0;position:fixed;top:0;width:var(--ti-leftmenu-width);z-index:990}.ti3-leftmenu-container.ti3-leftmenu-hide{width:0!important}.ti3-leftmenu-container.ti3-leftmenu-hide .ti3-leftmenu-panel-container{height:0!important}.ti3-leftmenu-container.ti3-leftmenu-hide .ti3-leftmenu-foot,.ti3-leftmenu-container.ti3-leftmenu-hide .ti3-leftmenu-head{margin:0;padding:0}.ti3-leftmenu-panel-container{overflow-x:hidden;overflow-y:auto}.ti3-leftmenu-panel,.ti3-leftmenu-panel-container{-ms-box-sizing:border-box;bottom:0;box-sizing:border-box;left:0;position:absolute;top:0;width:100%}.ti3-leftmenu-panel{color:var(--ti-common-color-text-secondary);font-size:var(--ti-leftmenu-font-size);overflow-x:visible;overflow-y:visible;padding:0 2px}.ti3-leftmenu-toggle{background-color:var(--ti-leftmenu-container-bg-color);border-radius:0 var(--ti-leftmenu-toggle-width) var(--ti-leftmenu-toggle-width) 0;cursor:pointer;height:80px;position:absolute;top:50%;transform:translateY(-50%);width:var(--ti-leftmenu-toggle-width)}.ti3-leftmenu-toggle:after{border-left:calc(var(--ti-leftmenu-angle-normal-width)/2) solid transparent;border-right:calc(var(--ti-leftmenu-angle-normal-width)/2) solid transparent;border-top:var(--ti-leftmenu-angle-normal-height) solid var(--ti-leftmenu-icon-color-nomal);content:\"\";display:block;height:0;left:calc(50% - var(--ti-leftmenu-angle-normal-width)/2);position:relative;top:calc(50% - var(--ti-leftmenu-angle-normal-height)/2);transform:rotate(90deg);width:0}.ti3-leftmenu-toggle.ti3-leftmenu-toggle-show{left:auto;right:calc(-1*var(--ti-leftmenu-toggle-width))}.ti3-leftmenu-toggle.ti3-leftmenu-toggle-hide{left:0;right:auto}.ti3-leftmenu-toggle.ti3-leftmenu-toggle-hide:after{transform:rotate(270deg)}.ti3-leftmenu-head{-ms-box-sizing:border-box;box-sizing:border-box;color:var(--ti-leftmenu-head-text-color);display:block;font-size:var(--ti-leftmenu-head-font-size);line-height:20px;margin-bottom:10px;overflow:hidden;padding:var(--ti-leftmenu-head-padding);text-align:var(--ti-leftment-leftmenu-head-text-align)}.ti3-leftmenu-head:after{border-bottom:1px solid var(--ti-leftmenu-head-line-dividing-color);bottom:-20px;content:\"\";display:block;position:relative;width:100%}.ti3-leftmenu-head-clone{background:var(--ti-leftmenu-container-bg-color);left:0;position:absolute;top:0;z-index:3}.ti3-leftmenu-level1{display:block;margin:0;padding:0}.ti3-leftmenu-level1+.ti3-leftmenu-group-container:before{border:1px dashed var(--ti-common-color-line-dividing);bottom:auto;content:\"\";left:var(--ti-leftmenu-group-padding-left);position:absolute;top:-2px;width:calc(100% - var(--ti-leftmenu-group-padding-left) - var(--ti-leftmenu-group-padding-right))}.ti3-leftmenu-level1-dividing{position:relative}.ti3-leftmenu-level1-dividing:after{border:1px dashed var(--ti-common-color-line-dividing);bottom:0;content:\"\";left:var(--ti-leftmenu-group-padding-left);position:absolute;top:auto;width:calc(100% - var(--ti-leftmenu-group-padding-left) - var(--ti-leftmenu-group-padding-right))}.ti3-leftmenu-level2-container{position:relative}.ti3-leftmenu-level2-container:after{border:1px solid var(--ti-common-color-line-dividing);bottom:var(--ti-common-space-10);content:\"\";display:block;left:var(--ti-leftmenu-level2-left-line);position:absolute;top:var(--ti-common-space-10)}.ti3-leftmenu-level1-item{-ms-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:block;line-height:var(--ti-common-line-height-number);position:relative}.ti3-leftmenu-level1-item .ti3-leftmenu-triangle.ti3-leftmenu-triangle-down{transform:rotate(0)}.ti3-leftmenu-level1-item .ti3-leftmenu-triangle.ti3-leftmenu-triangle-up{transform:rotate(180deg)}.ti3-leftmenu-level1-item:hover{background-color:var(--ti-leftmenu-item-bg-color-hover);color:var(--ti-leftmenu-item-text-color-hover)}.ti3-leftmenu-level1-item:hover .ti3-leftmenu-triangle.ti3-leftmenu-triangle-down,.ti3-leftmenu-level1-item:hover .ti3-leftmenu-triangle.ti3-leftmenu-triangle-up{border-top-color:var(--ti-leftmenu-icon-color-hover)}.ti3-leftmenu-level1-item.ti3-leftmenu-level1-active-item{color:var(--ti-leftmenu-item-selected-text-color)}.ti3-leftmenu-level1-active-item,.ti3-leftmenu-level2-active{position:relative}.ti3-leftmenu-level1-active-item .ti3-leftmenu-triangle.ti3-leftmenu-triangle-down,.ti3-leftmenu-level2-active .ti3-leftmenu-triangle.ti3-leftmenu-triangle-down{border-top-color:var(--ti-leftmenu-icon-color-hover)}.ti3-leftmenu-level1-active-item:before,.ti3-leftmenu-level2-active:before{background:var(--ti-leftmenu-item-selected-border-left-color);bottom:var(--ti-common-space-10);content:\"\";position:absolute;top:var(--ti-common-space-10);width:var(--ti-leftmenu-border-left-width);z-index:1}.ti3-leftmenu-level1-active-item:before{left:var(--ti-common-space-10)}.ti3-leftmenu-level2-active:before{left:var(--ti-leftmenu-level2-left-line)}.ti3-leftmenu-level1-label{display:block;padding:var(--ti-leftmenu-level1-label-padding)}.ti3-leftmenu-level1-state-icon{font-size:12px;position:absolute;right:9px;top:calc(50% - 11px)}.ti3-leftmenu-level2{-ms-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:block;line-height:var(--ti-common-line-height-number);padding:var(--ti-leftmenu-second-level-padding);position:relative}.ti3-leftmenu-level2:hover{background-color:var(--ti-leftmenu-item-bg-color-hover);color:var(--ti-leftmenu-item-text-color-hover)}.ti3-leftmenu-level2.ti3-leftmenu-level2-active{color:var(--ti-leftmenu-item-selected-text-color)}.ti3-leftmenu-triangle{border-left:calc(var(--ti-leftmenu-angle-normal-width)/2) solid transparent;border-right:calc(var(--ti-leftmenu-angle-normal-width)/2) solid transparent;border-top:var(--ti-leftmenu-angle-normal-height) solid var(--ti-leftmenu-icon-color-nomal);content:\"\";height:0;position:absolute;right:14px;top:calc(50% - var(--ti-leftmenu-angle-normal-height)/2);width:0}.ti3-leftmenu-href{font-size:16px;position:absolute;right:10px;top:50%;transform:translateY(-50%)}.ti3-leftmenu-logo{height:60px}.ti3-leftmenu-logo .ti3-leftmenu-logo-ficon{color:var(--ti-leftmenu-head-text-color);font-size:60px;line-height:60px;vertical-align:middle}.ti3-leftmenu-item-group:after{border-top:1px dashed var(--ti-common-color-line-dividing);content:\"\";display:block;margin:var(--ti-common-space-10) var(--ti-leftmenu-group-padding-right) var(--ti-common-space-10) var(--ti-leftmenu-group-padding-left)}.ti3-leftmenu-content{background:#fff;bottom:0;left:240px;overflow:auto;position:absolute;right:0;top:0}.ti3-leftmenu-group-container{display:block;position:relative}.ti3-leftmenu-group-container:after{border:1px dashed var(--ti-common-color-line-dividing);bottom:0;content:\"\";left:var(--ti-leftmenu-group-padding-left);position:absolute;top:auto;width:calc(100% - var(--ti-leftmenu-group-padding-left) - var(--ti-leftmenu-group-padding-right))}.ti3-leftmenu-group-container:last-child:after{display:none}.ti3-leftmenu-group-wrapper{color:var(--ti-common-color-text-weaken);cursor:pointer;line-height:var(--ti-common-line-height-number);padding:var(--ti-leftmenu-group-padding-top) var(--ti-leftmenu-group-padding-right) var(--ti-leftmenu-group-padding-bottom) var(--ti-leftmenu-group-padding-left);position:relative}.ti3-leftmenu-group-wrapper .ti3-leftmenu-triangle-down{transform:rotate(0)}.ti3-leftmenu-group-wrapper .ti3-leftmenu-triangle-up{display:none}.ti3-leftmenu-group-wrapper:hover{background:var(--ti-leftmenu-item-bg-color-hover);color:var(--ti-leftmenu-item-text-color-hover)}.ti3-leftmenu-group-wrapper:hover .ti3-leftmenu-triangle-down{border-top-color:var(--ti-leftmenu-icon-color-hover)}.ti3-leftmenu-group-wrapper:hover .ti3-leftmenu-triangle-up{border-top-color:var(--ti-leftmenu-icon-color-hover);display:block;transform:rotate(180deg)}.ti3-leftmenu-group-active{color:var(--ti-leftmenu-item-text-color-hover)}.ti3-leftmenu-group-active .ti3-leftmenu-triangle-down{border-top-color:var(--ti-leftmenu-icon-color-hover)}.ti3-leftmenu-group-active:before{background:var(--ti-leftmenu-icon-color-hover);content:\"\";height:calc(100% - var(--ti-leftmenu-group-padding-top) - var(--ti-leftmenu-group-padding-bottom));left:10px;position:absolute;top:var(--ti-leftmenu-group-padding-top);width:2px}.ti3-leftmenu-foot{-ms-box-sizing:border-box;background:var(--ti-leftmenu-container-bg-color);bottom:0;box-sizing:border-box;color:var(--ti-leftmenu-foot-text-color);line-height:var(--ti-common-line-height-number);overflow:hidden;padding:var(--ti-leftmenu-foot-padding-top) 0 var(--ti-leftmenu-foot-padding-bottom) var(--ti-leftmenu-foot-padding-left);position:absolute;stroke-width:var(--ti-leftmenu-foot-space-right);text-align:var(--ti-leftment-leftmenu-head-text-align);z-index:3}.ti3-leftmenu-foot:hover{color:var(--ti-leftmenu-foot-text-color-hover);cursor:pointer}.ti3-leftmenu-foot:before{border-bottom:1px solid var(--ti-common-color-line-dividing);content:\"\";display:block;left:0;position:relative;top:calc(-1*var(--ti-leftmenu-foot-padding-top))}"]
            },] }
];
TiLeftmenuComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: Router, decorators: [{ type: Optional }] },
    { type: ActivatedRoute, decorators: [{ type: Optional }] },
    { type: TiRenderer },
    { type: NgZone },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
TiLeftmenuComponent.propDecorators = {
    active: [{ type: Input }],
    activeChange: [{ type: Output }],
    reloadState: [{ type: Input }],
    reloadStateChange: [{ type: Output }],
    routable: [{ type: Input }],
    toggleable: [{ type: Input }],
    collapsed: [{ type: Input }],
    collapsedChange: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlMZWZ0bWVudUNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL0BjbG91ZC90aW55My9jb21wb25lbnRzL2xlZnRtZW51L1RpTGVmdG1lbnVDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNILFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFDTCxNQUFNLEVBQ04sUUFBUSxFQUNSLE1BQU0sRUFDTixTQUFTLEVBR1QsaUJBQWlCLEVBQ2pCLE1BQU0sRUFDVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsY0FBYyxFQUFFLGFBQWEsRUFBb0IsTUFBTSxFQUFXLE1BQU0saUJBQWlCLENBQUM7QUFDbkcsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRzNDLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN4QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFdkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBNkNoRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQkc7QUFXSCxNQUFNLE9BQU8sbUJBQW9CLFNBQVEsZUFBZTtJQW9FcEQsWUFBWSxVQUFzQixFQUFTLFNBQW9CLEVBQy9CLE1BQWMsRUFDZCxXQUEyQixFQUN2QyxVQUFzQixFQUFVLElBQVksRUFBNEIsUUFBUTtRQUNoRyxLQUFLLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBSlUsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUMvQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsZ0JBQVcsR0FBWCxXQUFXLENBQWdCO1FBQ3ZDLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxTQUFJLEdBQUosSUFBSSxDQUFRO1FBQTRCLGFBQVEsR0FBUixRQUFRLENBQUE7UUFoRXBHOztXQUVHO1FB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O1lBOUZHLFVBQVU7WUFNVixTQUFTO1lBTTZDLE1BQU0sdUJBd0ovQyxRQUFRO1lBeEpoQixjQUFjLHVCQXlKTixRQUFRO1lBbEpoQixVQUFVO1lBaEJmLE1BQU07NENBbUs2RCxNQUFNLFNBQUMsUUFBUTs7O3FCQWpFakYsS0FBSzsyQkFLTCxNQUFNOzBCQVNOLEtBQUs7Z0NBSUwsTUFBTTt1QkFPTixLQUFLO3lCQUlMLEtBQUs7d0JBSUwsS0FBSzs4QkFJTCxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuICAgIEVsZW1lbnRSZWYsXHJcbiAgICBFdmVudEVtaXR0ZXIsXHJcbiAgICBJbnB1dCxcclxuICAgIE5nWm9uZSxcclxuICAgIE9wdGlvbmFsLFxyXG4gICAgT3V0cHV0LFxyXG4gICAgUmVuZGVyZXIyLFxyXG4gICAgU2ltcGxlQ2hhbmdlLFxyXG4gICAgU2ltcGxlQ2hhbmdlcyxcclxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxyXG4gICAgSW5qZWN0XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlLCBOYXZpZ2F0aW9uRW5kLCBOYXZpZ2F0aW9uRXh0cmFzLCBSb3V0ZXIsIFVybFRyZWUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5cclxuaW1wb3J0IHsgVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL1V0aWwnO1xyXG5pbXBvcnQgeyBUaUJhc2VDb21wb25lbnQgfSBmcm9tICcuLi9iYXNlL1RpQmFzZU1vZHVsZSc7XHJcbmltcG9ydCB7IFRpTGVmdG1lbnVMZXZlbDFDb21wb25lbnQgfSBmcm9tICcuL1RpTGVmdG1lbnVMZXZlbDFDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBUaVJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcmVuZGVyZXIvVGlSZW5kZXJlcic7XHJcblxyXG4vKipcclxuICog5bem5L6n6I+c5Y2V5ZCE6aG55pWw5o2u5o6l5Y+jXHJcbiAqXHJcbiAqIOaYr1RpTGVmdG1lbnVMZXZlbDEg5ZKMIFRpTGVmdG1lbnVMZXZlbDIg57uE5Lu255qEIGl0ZW0g5o6l5Y+j55qE5pWw5o2u57G75Z6LXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFRpTGVmdG1lbnVJdGVtIHtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5b2T5YmN6I+c5Y2V6aG55a+55bqU55qE6Lev55Sx77yM5LiOIFJvdXRlci5uYXZpZ2F0ZeaWueazleeahOesrOS4gOS4quWPguaVsOS4gOagt1xyXG4gICAgICovXHJcbiAgICByb3V0ZXI/OiBBcnJheTxhbnk+O1xyXG4gICAgLy8gcm91dGVyRXh0cmFzPzogeyByZWxhdGl2ZVRvPzogc3RyaW5nLCBxdWVyeVBhcmFtcz86IE9iamVjdCwgZnJhZ21lbnQ/OiBzdHJpbmcgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5b2T5YmN6I+c5Y2V6aG55a+55bqU6Lev55Sx55qE6YWN572u5L+h5oGv77yM5LiOIFJvdXRlci5uYXZpZ2F0ZeaWueazleeahOesrOS6jOS4quWPguaVsOS4gOagt1xyXG4gICAgICovXHJcbiAgICByb3V0ZXJFeHRyYXM/OiBOYXZpZ2F0aW9uRXh0cmFzO1xyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7kuIDkuKpyb3V0ZXLot6/nlLHliJfooajvvIzlvZPor6XliJfooajkuK3nmoTot6/nlLHooqvmv4DmtLvml7bvvIzlhbblr7nlupTnmoToj5zljZXpobnooqvmv4DmtLvlpITkuo7pq5jkuq7nirbmgIHjgIJcclxuICAgICAqIOWFtuS9v+eUqOWcuuaZr+S4uuWkmuS4qui3r+eUseWvueW6lOWQjOS4gOS4quW3puS+p+iPnOWNlemhueOAglxyXG4gICAgICpcclxuICAgICAqIHJvdXRlckxpc3Qg5pWw57uE5Lit5q+P5LiA5Liq5YWD57Sg5LiOIFJvdXRlci5uYXZpZ2F0ZeaWueazleeahOesrOS4gOS4quWPguaVsOS4gOagt1xyXG4gICAgICovXHJcbiAgICByb3V0ZXJMaXN0PzogQXJyYXk8QXJyYXk8YW55Pj47IC8vIOaVsOe7hOS4reWFg+e0oOS5n+S4uuaVsOe7hFxyXG4gICAgLyoqXHJcbiAgICAgKiDpk77mjqXlnLDlnYDvvIzngrnlh7vlkI7ot6/nlLHmv4DmtLvpobnkuI3lj5jvvIzlnKjmlrDpobXpnaLmiZPlvIDphY3nva7lnLDlnYDjgIJcclxuICAgICAqXHJcbiAgICAgKiAxMC4wLjHmlrDlop5cclxuICAgICAqXHJcbiAgICAgKiB2MTAuMC4xIH4gdjEwLjEuM+eJiOacrOWtmOWcqFhTU+aUu+WHuyh1cmznsbvlnosp6aOO6Zmp5ZKM55So5oi354K55Ye76L+Z5Liq6ZO+5o6l5bm26L+b5YWl5LiA5Liq5paw55qE5qCH562+77yM5paw5qCH562+5Lit55qE6aG16Z2i5aaC5p6c5a2Y5Zyo5oG25oSP5Luj56CB77yM5bCx5Y+v5Lul5bCG5Y6f572R56uZ55u05o6l5a+86Iiq5Yiw5LiA5Liq6Jma5YGH572R56uZ55qE5a6J5YWo6aOO6Zmp44CCXHJcbiAgICAgKlxyXG4gICAgICogdjEwLjEuNCDniYjmnKzlgZrkuoblronlhajlpITnkIbvvIzlt7LkuI3lrZjlnKjkuIrov7DkuKTnp43lronlhajpl67popjvvIzlu7rorq7kuJrliqHlsL3lv6vljYfnuqfniYjmnKzjgIJcclxuICAgICAqL1xyXG4gICAgaHJlZj86IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5YiG55WM57q/77yI5Y+q5pSv5oyB5LiA57qn6I+c5Y2V77yJ77yM5Zyo6K6+572u6K+l5bGe5oCn6I+c5Y2V6aG555qE5bqV6YOo55Sf5oiQ5LiA5p2h5Yy65Z2X5YiG55WM57q/44CCXHJcbiAgICAgKlxyXG4gICAgICogMTAuMC4y5paw5aKeXHJcbiAgICAgKi9cclxuICAgIHNob3dEaXZpZGluZ0xpbmU/OiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhYHorrjmnInlpJrkvZnnmoTlsZ7mgKflrZfmrrVcclxuICAgICAqL1xyXG4gICAgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnk7XHJcbn1cclxuLyoqXHJcbiAqIFRpTGVmdG1lbnXnu4Tku7bmj5DkvpvkuobkuIDnp43mlrnkvr/ngbXmtLvlrp7njrDpobXpnaLluIPlsYDlt6bkvqfoj5zljZXnmoTmlrnlvI/vvIzmlK/mjIHkuKTnuqfoj5zljZXjgIJcclxuICpcclxuICog5YW25YaF6YOo5YyF5ZCrNeS4que7hOS7tjpcclxuICpcclxuICogVGlMZWZ0bWVudSA6IOW3puS+p+iPnOWNleacgOWkluWxgueahOaMh+S7pO+8m1xyXG4gKlxyXG4gKiBUaUxlZnRtZW51R3JvdXA6IOiPnOWNleWIhue7hOaMh+S7pO+8m1xyXG4gKlxyXG4gKiBUaWxlZnRtZW51R3JvdXBJdGVt77ya5YiG57uE5paH5pys5YaF5a655oyH5Luk77ybXHJcbiAqXHJcbiAqIFRpTGVmdG1lbnVIZWFkIDog6I+c5Y2V5aS06YOo5YaF5a655oyH5Luk77ybXHJcbiAqXHJcbiAqIFRpTGVmdG1lbnVMZXZlbDEg77ya5LiA57qn6I+c5Y2V5oyH5Luk77ybXHJcbiAqXHJcbiAqIFRpTGVmdG1lbnVJdGVtIO+8muS4gOe6p+iPnOWNleaWh+acrOWGheWuueaMh+S7pO+8m1xyXG4gKlxyXG4gKiBUaUxlZnRtZW51TGV2ZWwyIO+8muS6jOe6p+iPnOWNleaMh+S7pOOAglxyXG4gKlxyXG4gKiA8ZXhhbXBsZS11cmw+Li4vdGlueTNkZW1vLyMvbGVmdG1lbnUvbGVmdG1lbnUtYWxsPC9leGFtcGxlLXVybD5cclxuICovXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICd0aS1sZWZ0bWVudScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vbGVmdG1lbnUuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9sZWZ0bWVudS5sZXNzJ10sXHJcbiAgICBob3N0OiB7XHJcbiAgICAgICAgJ1tjbGFzcy50aTMtbGVmdG1lbnUtY29udGFpbmVyXSc6ICd0cnVlJyxcclxuICAgICAgICAnW2NsYXNzLnRpMy1sZWZ0bWVudS1oaWRlXSc6ICdjb2xsYXBzZWQnXHJcbiAgICB9LFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGlMZWZ0bWVudUNvbXBvbmVudCBleHRlbmRzIFRpQmFzZUNvbXBvbmVudCB7XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9rua/gOa0u+iPnOWNlemhueOAgui/meS4quWAvOW6lOivpeaYryBUaUxlZnRtZW51TGV2ZWwxIOWSjCBUaUxlZnRtZW51TGV2ZWwyIOe7hOS7tueahCBpdGVtIOaOpeWPo+S8oOWFpeeahOWAvOeahOmbhuWQiOS4reeahOS4gOS4qihpdGVtKVxyXG4gICAgICpcclxuICAgICAqIOatpOaOpeWPo+aYr+WPjOWQkee7keWumueahO+8jOiuvue9ruaXtuS4reaLrOWPt+KAnFtd4oCd5ZKM5ZyG5ous5Y+34oCcKCnigJ3opoHlkIzml7bkvb/nlKhcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgYWN0aXZlOiBUaUxlZnRtZW51SXRlbTtcclxuICAgIC8qKlxyXG4gICAgICog5r+A5rS76I+c5Y2V6aG55pS55Y+Y5pe25ZCR5aSW6YCa55+lXHJcbiAgICAgKi9cclxuXHJcbiAgICBAT3V0cHV0KCkgcmVhZG9ubHkgYWN0aXZlQ2hhbmdlOiBFdmVudEVtaXR0ZXI8VGlMZWZ0bWVudUl0ZW0+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjqfliLblj7PkvqflhoXlrrnljLrnmoTliLfmlrBcclxuICAgICAqXHJcbiAgICAgKiDms6jmhI/vvJrlvZPph43lpI3ngrnlh7vlvZPliY3mv4DmtLvoj5zljZXpobnml7bvvIzpnIDopoHliLfmlrDlj7PkvqflhoXlrrnljLrvvIzkuLrkuoblrp7njrDmraTlip/og73orr7nva7kuobor6XmjqXlj6PvvJtcclxuICAgICAqIOivpeaOpeWPo+aYr+WPjOWQkee7keWumueahO+8jOW9k+mHjeWkjeeCueWHu+W9k+WJjea/gOa0u+iPnOWNlemhueaXtu+8jHJlbG9hZFN0YXRl55qE5YC85Lya57uP5Y6GIHRydWUo5LiK5qyh55qE5YC8KSAtPiBmYWxzZSAtPiB0cnVlXHJcbiAgICAgKiDnmoTlj5jljJbov4fnqIvvvIzlvIDlj5HogIXnu5nmlLnmjqXlj6PkuI7lhbblj7PkvqfljLrln5/lrrnlmajkuIpuZ0lm5o6l5Y+j57uR5a6a55qE5piv5ZCM5LiA5Liq5Y+Y6YeP77yM5omA5LulbmdJZueahOWAvOS5n+S8mue7j+WOhuWQjOagt+eahOWPmOWMlu+8jFxyXG4gICAgICog5LuO6ICM5YGa5Yiw5Y+z5L6n5YaF5a655Yy655qE5Yi35paw44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHJlbG9hZFN0YXRlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIC8qKlxyXG4gICAgICog5Y+z5L6n5YaF5a655Yy65piv5ZCm6ZyA6KaB5Yi35paw55qE54q25oCB5YC85pS55Y+Y5pe25ZCR5aSW6YCa55+lXHJcbiAgICAgKi9cclxuICAgIEBPdXRwdXQoKSByZWFkb25seSByZWxvYWRTdGF0ZUNoYW5nZTogRXZlbnRFbWl0dGVyPGJvb2xlYW4+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLy8gcm91dGFibGXmjqXlj6PlnKgzLjAuM+eJiOacrOi1t+WvueWklumakOiXj++8jDEwLjAuMemHjeaWsOW8gOaUvlxyXG4gICAgLyoqXHJcbiAgICAgKiAxMC4wLjHmlrDlop5cclxuICAgICAqXHJcbiAgICAgKiDorr7nva7mmK/lkKbkvb/nlKjot6/nlLHmnaXmjqfliLboj5zljZXlr7nlupTlhoXlrrnmmL7npLov6ZqQ6JeP77yM6buY6K6k5L2/55So6Lev55Sx44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHJvdXRhYmxlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5byA5ZCv5bem5L6n6I+c5Y2V6Z2i5p2/5Y+v5oqY5Y+g5Yqf6IO977yM6buY6K6k5byA5ZCv44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHRvZ2dsZWFibGU6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlt6bkvqfoj5zljZXpnaLmnb/mmK/lkKbkuLrmlLbotbfnirbmgIHvvIznlKjkuo7orr7nva7pnaLmnb/mlLbotbcv5bGV5byA54q25oCB77yM6buY6K6k5bGV5byA44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNvbGxhcHNlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlt6bkvqfoj5zljZXpnaLmnb/mlLbotbcv5bGV5byA54q25oCB5pS55Y+Y5pe25ZCR5aSW6YCa55+lXHJcbiAgICAgKi9cclxuICAgIEBPdXRwdXQoKSByZWFkb25seSBjb2xsYXBzZWRDaGFuZ2U6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogdGlMZWZ0bWVudeS4reWMheWQq+eahCBUaUxlZnRtZW51TGV2ZWwxQ29tcG9uZW50IOWunuS+i+mbhuWQiFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbGV2ZWwxSXRlbXM6IEFycmF5PFRpTGVmdG1lbnVMZXZlbDFDb21wb25lbnQ+ID0gW107XHJcbiAgICBwcml2YXRlIG5hdmlnYXRpb25TdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVhZG9ubHkgcmVzb2x2ZWRQcm9taXNlOiBQcm9taXNlPGFueT4gPSBQcm9taXNlLnJlc29sdmUobnVsbCk7XHJcbiAgICAvKipcclxuICAgICAqIOagh+W/l+mHj++8jOaYr+WQpuS4unVybOaUueWPmCjpnIDopoHljrvmlLnlj5hhY3RpdmUpXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNVcmxDaGFuZ2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHBhbmVsQ29udGFpbmVyOiBhbnk7XHJcbiAgICAvKipcclxuICAgICAqIOa7muWKqOadoeeahOWuveW6piwg5ZyoIFRpTGVmdG1lbnVGb2905Lit5Lmf5pyJ5L2/55SoXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzY3JvbGxXaWR0aDogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHB1YmxpYyByZW5kZXJlcjI6IFJlbmRlcmVyMixcclxuICAgICAgICAgICAgICAgIEBPcHRpb25hbCgpIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcbiAgICAgICAgICAgICAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGFjdGl2ZVJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgdGlSZW5kZXJlcjogVGlSZW5kZXJlciwgcHJpdmF0ZSB6b25lOiBOZ1pvbmUsIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQpIHtcclxuICAgICAgICBzdXBlcihlbGVtZW50UmVmLCByZW5kZXJlcjIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIpOaWrWl0ZW3nmoRyb3V0ZXLmmK/lkKbmmK/niLbot6/nlLHkuIvpu5jorqTmv4DmtLvnmoTlrZDot6/nlLHvvIjljbPlrZDot6/nlLHkuI7niLbot6/nlLHot6/lvoTkuIDoh7TvvIlcclxuICAgIHByaXZhdGUgc3RhdGljIGlzRGVmYXVsdEFjdGl2ZUNoaWxkUm91dGUoaXRlbTogVGlMZWZ0bWVudUl0ZW0pOiBib29sZWFuIHtcclxuICAgICAgICAvLyDpu5jorqTmv4DmtLvnmoTlrZDot6/nlLHnmoRyb3V0ZXLlj6/orr7kuLpbXeaIllsnJ11cclxuICAgICAgICByZXR1cm4gIWl0ZW0ucm91dGVyIHx8IGl0ZW0ucm91dGVyLmxlbmd0aCA9PT0gMCB8fCBpdGVtLnJvdXRlclswXSA9PT0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIubmdPbkluaXQoKTtcclxuICAgICAgICAvLyDliJ3lp4vml7blj7PkvqflhoXlrrnljLrpu5jorqTmmL7npLrvvIzpnIDkvb/lpJbpg6jnlKjmiLfnmoRyZWxvYWRTdGF0ZeWAvOS4unRydWXjgIJcclxuICAgICAgICAvLyDlj4zlkJHnu5HlrprmlbDmja7ml7bvvIzlr7nliJ3lp4vkvKDlhaXnmoTlgLznq4vljbPkv67mlLnlubbkvKDlh7rml7bkvJrmiqXplJnvvIxcclxuICAgICAgICAvLyDmraTlpITlj4LogINuZ01vZGVs5rqQ56CBc2V0VmFsdWXnmoTlpITnkIbvvIzkvb/nlKhwcm9taXNl5bu25ZCO5omn6KGM5pe25bqPXHJcbiAgICAgICAgdGhpcy5yZXNvbHZlZFByb21pc2UudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVsb2FkU3RhdGVDaGFuZ2UuZW1pdCh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNjcm9sbFdpZHRoID0gdGhpcy5nZXRTY3JvbGxiYXJTaXplKCdZJyk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nQWZ0ZXJWaWV3SW5pdCgpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMucm91dGFibGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g55u05o6l6L6T5YWldXJsKOWIt+aWsOmhtemdoinmlLnlj5jnirbmgIHml7bvvIxsZWZ0bWVudeiDveWQjOatpeS/ruaUuea/gOa0u+eKtuaAgVxyXG4gICAgICAgIGNvbnN0IHVybEFjdGl2ZUl0ZW06IFRpTGVmdG1lbnVJdGVtID0gdGhpcy5nZXRBY3RpdmVJdGVtQnlVcmwodGhpcy5sZXZlbDFJdGVtcyk7XHJcblxyXG4gICAgICAgIGlmICh1cmxBY3RpdmVJdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIOWPjOWQkee7keWumuaVsOaNruaXtu+8jOWvueWIneWni+S8oOWFpeeahOWAvOeri+WNs+S/ruaUueW5tuS8oOWHuuaXtuS8muaKpemUme+8jFxyXG4gICAgICAgICAgICAvLyDmraTlpITlj4LogINuZ01vZGVs5rqQ56CBc2V0VmFsdWXnmoTlpITnkIbvvIzkvb/nlKhwcm9taXNl5bu25ZCO5omn6KGM5pe25bqPXHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZWRQcm9taXNlLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHVybEFjdGl2ZUl0ZW0gIT09IHRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1VybENoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSB1cmxBY3RpdmVJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2hhbmdlLmVtaXQodGhpcy5hY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxpbmsoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOS7jumdnmxlZnRNZW515aSE6Lez6L2s5pS55Y+Y54q25oCB5pe277yMbGVmdG1lbnXog73lkIzmraXkv67mlLnmv4DmtLvnirbmgIFcclxuICAgICAgICB0aGlzLm5hdmlnYXRpb25TdWJzY3JpcHRpb24gPSB0aGlzLnJvdXRlci5ldmVudHMuc3Vic2NyaWJlKChldnQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZ0IGluc3RhbmNlb2YgTmF2aWdhdGlvbkVuZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QWN0aXZlSXRlbTogVGlMZWZ0bWVudUl0ZW0gPSB0aGlzLmdldEFjdGl2ZUl0ZW1CeVVybCh0aGlzLmxldmVsMUl0ZW1zKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdBY3RpdmVJdGVtICYmIG5ld0FjdGl2ZUl0ZW0gIT09IHRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSBuZXdBY3RpdmVJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2hhbmdlLmVtaXQodGhpcy5hY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNVcmxDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucGFuZWxDb250YWluZXIgPSB0aGlzLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnRpMy1sZWZ0bWVudS1wYW5lbC1jb250YWluZXInKTtcclxuICAgICAgICBjb25zdCBoZWFkRWxlbWVudDogYW55ID0gdGhpcy5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aTMtbGVmdG1lbnUtaGVhZCcpO1xyXG4gICAgICAgIGxldCBoZWFkQ2xvbmVFbGVtZW50OiBhbnkgO1xyXG4gICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7IC8vIOmBv+WFjeS4jeWBnOinpuWPkeWPmOWMluajgOa1i1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyMi5saXN0ZW4odGhpcy5wYW5lbENvbnRhaW5lciwgJ3Njcm9sbCcsICgpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNjcm9sbFRvcDogbnVtYmVyID0gdGhpcy5wYW5lbENvbnRhaW5lci5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsVG9wID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaGVhZENsb25lRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkQ2xvbmVFbGVtZW50ID0gaGVhZEVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyMi5hZGRDbGFzcyhoZWFkQ2xvbmVFbGVtZW50LCAndGkzLWxlZnRtZW51LWhlYWQtY2xvbmUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIyLnNldFN0eWxlKGhlYWRDbG9uZUVsZW1lbnQsICd3aWR0aCcsIGBjYWxjKDEwMCUgLSAke3RoaXMuc2Nyb2xsV2lkdGh9cHgpYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlRWxlbWVudC5hcHBlbmRDaGlsZChoZWFkQ2xvbmVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhlYWRDbG9uZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZUVsZW1lbnQucmVtb3ZlQ2hpbGQoaGVhZENsb25lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZENsb25lRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZU9iajogU2ltcGxlQ2hhbmdlID0gY2hhbmdlc1snYWN0aXZlJ107XHJcbiAgICAgICAgaWYgKGFjdGl2ZU9iaiAmJiAhYWN0aXZlT2JqLmZpcnN0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGV2ZWwxSXRlbSBvZiB0aGlzLmxldmVsMUl0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICBsZXZlbDFJdGVtLnNldFNob3dDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgbGV2ZWwxSXRlbS5zZXRBY3RpdmVTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5yb3V0YWJsZSAmJiAhdGhpcy5pc1VybENoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saW5rKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNVcmxDaGFuZ2UgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvblN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOaooeadv+S4reS9v+eUqFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdG9nZ2xlQ2xpY2tGbigpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNvbGxhcHNlZCA9ICF0aGlzLmNvbGxhcHNlZDtcclxuICAgICAgICB0aGlzLmNvbGxhcHNlZENoYW5nZS5lbWl0KHRoaXMuY29sbGFwc2VkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEFjdGl2ZUl0ZW1CeVVybChhcnI6IEFycmF5PGFueT4pOiBUaUxlZnRtZW51SXRlbSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdEl0ZW06IFRpTGVmdG1lbnVJdGVtO1xyXG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIGFycikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZWQoY29tcG9uZW50Lml0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRJdGVtID0gY29tcG9uZW50Lml0ZW07XHJcbiAgICAgICAgICAgICAgICBpZiAoVGlMZWZ0bWVudUNvbXBvbmVudC5pc0RlZmF1bHRBY3RpdmVDaGlsZFJvdXRlKGNvbXBvbmVudC5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0SXRlbTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5jaGlsZHJlbiAmJiBjb21wb25lbnQuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0OiBUaUxlZnRtZW51SXRlbSA9IHRoaXMuZ2V0QWN0aXZlSXRlbUJ5VXJsKGNvbXBvbmVudC5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdEl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc0FjdGl2ZWQoaXRlbTogVGlMZWZ0bWVudUl0ZW0pOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCByZWxhdGl2ZVJvdXRlOiBOYXZpZ2F0aW9uRXh0cmFzID0gdGhpcy5nZXRSZWxhdGl2ZVJvdXRlKGl0ZW0ucm91dGVyRXh0cmFzKTtcclxuICAgICAgICBpZiAodGhpcy5pc01hdGNoQ3VycmVudFVybChpdGVtLnJvdXRlciwgcmVsYXRpdmVSb3V0ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoVXRpbC5pc0FycmF5KGl0ZW0ucm91dGVyTGlzdCkgJiYgaXRlbS5yb3V0ZXJMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByb3V0ZXIgb2YgaXRlbS5yb3V0ZXJMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hdGNoQ3VycmVudFVybChyb3V0ZXIsIHJlbGF0aXZlUm91dGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGlzTWF0Y2hDdXJyZW50VXJsKHJvdXRlcjogQXJyYXk8YW55PiwgcmVsYXRpdmVSb3V0ZTogTmF2aWdhdGlvbkV4dHJhcyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghVXRpbC5pc0FycmF5KHJvdXRlcikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaXRlbVVybFRyZWU6IFVybFRyZWUgPSB0aGlzLnJvdXRlci5jcmVhdGVVcmxUcmVlKHJvdXRlciwgcmVsYXRpdmVSb3V0ZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlci5pc0FjdGl2ZShpdGVtVXJsVHJlZSwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbGluaygpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZSh0aGlzLmFjdGl2ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBuYXZpZ2F0ZShpdGVtOiBUaUxlZnRtZW51SXRlbSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChUaUxlZnRtZW51Q29tcG9uZW50LmlzRGVmYXVsdEFjdGl2ZUNoaWxkUm91dGUoaXRlbSkpIHtcclxuICAgICAgICAgICAgLy8gIHJvdXRlQ29uZmlnIOWPr+iDveS4um51bGxcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZVJvdXRlLnJvdXRlQ29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgcGF0aDogc3RyaW5nID0gdGhpcy5hY3RpdmVSb3V0ZS5yb3V0ZUNvbmZpZy5wYXRoO1xyXG4gICAgICAgICAgICBjb25zdCB1cmw6IHN0cmluZyA9IHRoaXMucm91dGVyLnJvdXRlclN0YXRlLnNuYXBzaG90LnVybDtcclxuICAgICAgICAgICAgY29uc3Qgcm9vdFVybDogc3RyaW5nID0gdXJsLnNwbGl0KHBhdGgpWzBdO1xyXG4gICAgICAgICAgICAvLyDnu53lr7not6/lvoTot7PovaxcclxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3Jvb3RVcmwgKyBwYXRoXSwgaXRlbS5yb3V0ZXJFeHRyYXMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKGl0ZW0ucm91dGVyLCB0aGlzLmdldE5hdmlnYXRpb25FeHRyYXMoaXRlbS5yb3V0ZXJFeHRyYXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDngrnlh7vlvZPliY3pgInkuK3pobnml7bvvIzop6blj5HlhoXlrrnljLrph43ovb1cclxuICAgICAqIEBwYXJhbSBpdGVtIOW9k+WJjeeCueWHu+mhuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdHJpZ2dlclJlbG9hZChpdGVtOiBUaUxlZnRtZW51SXRlbSk6IHZvaWQge1xyXG4gICAgICAgIC8vIOS9v3JlbG9hZFN0YXRl55SxZmFsc2Xlj5jkuLp0cnVlLOmFjeWQiOWGheWuueWMuueahG5nSWblgZrliLDlhoXlrrnljLrnmoTph43ovb1cclxuICAgICAgICB0aGlzLnJlbG9hZFN0YXRlQ2hhbmdlLmVtaXQoZmFsc2UpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbG9hZFN0YXRlQ2hhbmdlLmVtaXQodHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjei3r+eUseWwseaYr2l0ZW0ucm91dGVy5a+55bqU6Lev55Sx77yM5YiZ5q2k5a+86Iiq5LiN5L2c55SoKOi3r+eUseebuOWQjCnvvJtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5b2T5YmN6Lev55Sx5pivaXRlbS5yb3V0ZXJMaXN05Lit55qE6Lev55Sx77yM5YiZ6ZyA6KaB6Lez6L2s5YiwaXRlbS5yb3V0ZXLlr7nlupTot6/nlLFcclxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZShpdGVtKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldE5hdmlnYXRpb25FeHRyYXMocm91dGVyRXh0cmFzOiBPYmplY3QpOiBPYmplY3Qge1xyXG4gICAgICAgIHJldHVybiB7IHJlbGF0aXZlVG86IHRoaXMuYWN0aXZlUm91dGUsIC4uLnJvdXRlckV4dHJhc307XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRSZWxhdGl2ZVJvdXRlKHJvdXRlckV4dHJhczogT2JqZWN0KTogTmF2aWdhdGlvbkV4dHJhcyB7XHJcbiAgICAgICAgaWYgKCFyb3V0ZXJFeHRyYXMgfHwgIXJvdXRlckV4dHJhc1sncmVsYXRpdmVUbyddKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHJlbGF0aXZlVG86IHRoaXMuYWN0aXZlUm91dGUgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHJlbGF0aXZlVG86IHJvdXRlckV4dHJhc1sncmVsYXRpdmVUbyddIH07XHJcbiAgICB9XHJcbiAgICAgICAgLyoqXHJcbiAgICAgKiDlvpfliLDmtY/op4jlmajmu5rliqjmnaHnmoTlrr3luqblkozpq5jluqZcclxuICAgICAqIOS7o+ihqOa7muWKqOadoeeahOaWueWQke+8jOWPluWAvOS4ulggb3IgWVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFNjcm9sbGJhclNpemUoZGlyZWN0aW9uOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IG91dGVyRGl2OiBhbnkgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGNvbnN0IGlubmVyRGl2OiBhbnkgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGlubmVyRGl2LCAnd2lkdGgnLCAnMTAwJScpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoaW5uZXJEaXYsICdoZWlnaHQnLCAnMTAwJScpO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKG91dGVyRGl2LCBpbm5lckRpdik7XHJcbiAgICAgICAgdGhpcy50aVJlbmRlcmVyLnNldFN0eWxlcyhvdXRlckRpdiwge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgICAgICAgdG9wOiAnLTk5OTlweCcsXHJcbiAgICAgICAgICAgIGxlZnQ6ICctOTk5OXB4JyxcclxuICAgICAgICAgICAgd2lkdGg6ICcxMDBweCcsXHJcbiAgICAgICAgICAgIGhlaWdodDogJzEwMHB4JyxcclxuICAgICAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQodGhpcy5kb2N1bWVudC5ib2R5LCBvdXRlckRpdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpZWxkOiBzdHJpbmcgPSBkaXJlY3Rpb24gPT09ICdYJyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcclxuICAgICAgICBjb25zdCBub1Njcm9sbFNpemU6IG51bWJlciA9IHR5cGVvZiBpbm5lckRpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QgPT09ICdmdW5jdGlvbicgPyBpbm5lckRpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVtmaWVsZF0gOiAwO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUob3V0ZXJEaXYsICdvdmVyZmxvdycsICdzY3JvbGwnKTtcclxuICAgICAgICBjb25zdCB3aXRoU2Nyb2xsU2l6ZTogbnVtYmVyID0gdHlwZW9mIGlubmVyRGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCA9PT0gJ2Z1bmN0aW9uJyA/IGlubmVyRGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpW2ZpZWxkXSA6IDA7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG91dGVyRGl2KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoKG5vU2Nyb2xsU2l6ZSAtIHdpdGhTY3JvbGxTaXplKS50b0ZpeGVkKDEpKTtcclxuXHJcbiAgICB9XHJcbn1cclxuIl19