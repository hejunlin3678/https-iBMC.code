import { Component, ContentChild, ElementRef, EventEmitter, Input, IterableDiffers, Output, Renderer2, TemplateRef, ViewChildren, QueryList, ChangeDetectorRef } from '@angular/core';
import { Util, TiKeymap } from '../../utils/Util';
import { TiBaseComponent } from '../base/TiBaseModule';
import { TiTreeUtil } from './TiTreeUtil';
import { TiLocale } from '../../locale/TiLocaleModule';
import { TiRenderer } from '../../services/renderer/TiRenderer';
/**
 * Tree树组件
 *
 * 分类：支持单选、多选两种类型
 *
 * 公共方法：树组件提供 [TiTreeUtil]{@link ../classes/TiTreeUtil.html} 公共方法，包括增、删、改、查、选中、取消选中、遍历、筛选、获取选中项等操作
 *
 * <example-url>../tiny3demo/#/tree/tree-all</example-url>
 */
export class TiTreeComponent extends TiBaseComponent {
    constructor(elementRef, renderer2, iterableDiffers, tiRenderer, cdRef) {
        super(elementRef, renderer2);
        this.elementRef = elementRef;
        this.renderer2 = renderer2;
        this.iterableDiffers = iterableDiffers;
        this.tiRenderer = tiRenderer;
        this.cdRef = cdRef;
        /**
         * 设置多选树时，父节点是否可被点击选中，默认父节点子节点都显示复选框，都可被选中，设置false时，只有子节点前边显示复选框。
         */
        this.parentCheckable = true;
        /**
         * 设置是否为多选。
         */
        this.multiple = false;
        /**
         * 当为多选时该接口才生效。
         *
         * 默认为 false, 当设置为 true 时：
         *
         * 1.点击文本，复选框状态不会改变，只会触发select事件；
         *
         * 2.点击复选框只会触发change事件；
         *
         * 3.复选框disabled时，点击文本会触发select事件。
         *
         * Tiny3.1.1-alpha新增。
         */
        this.changedByCheckbox = false;
        /**
         * 10.1.4 新增
         * 支持拖放
         */
        this.nodeDraggable = false;
        /**
         * 树节点展开前的事件回调，一般用于异步数据获取
         */
        this.beforeExpand = new EventEmitter();
        /**
         * 当用户点击某一节点时触发的事件
         */
        // tslint:disable-next-line:no-output-named-after-standard-event
        this.select = new EventEmitter();
        /**
         * 当前选中项发生变化时，触发change事件
         */
        // tslint:disable-next-line:no-output-named-after-standard-event
        this.change = new EventEmitter();
        /**
         * 10.1.4 新增
         * drop event
         */
        this.nodeDrop = new EventEmitter();
        /**
         * 10.1.4 新增
         * 悬浮增加节点按钮回调
         */
        this.nodeAdded = new EventEmitter();
        /**
         * 10.1.4 新增
         * 悬浮编辑节点按钮回调
         */
        this.nodeEdited = new EventEmitter();
        /**
         * 10.1.4 新增
         * 悬浮删除节点按钮回调
         */
        this.nodeDeleted = new EventEmitter();
        /**
         * @ignore
         * 词条
         */
        this.treeLan = TiLocale.getLocaleWords().tiTree;
        // 处理当前节点选中状态变化后，对父子节点的影响
        this.setSeletedState = (node, allData, checked) => {
            if (checked === true) {
                TiTreeUtil.selectAllChildren(node);
                TiTreeUtil.selectParents(node, allData, true);
            }
            else {
                TiTreeUtil.deSelectAllChildren(node);
                TiTreeUtil.deSelectParents(node, allData);
            }
        };
        /**
         * 单选时，取消所有节点的选中状态
         * @param  allData 所有节点数据
         */
        this.deSelectAllNode = (allData) => {
            allData.forEach((node) => {
                TiTreeUtil.deSelectAllChildren(node);
            });
        };
        // 初始化选中项高亮
        this.initActived = (data) => {
            let result;
            for (const node of data) {
                if (node.checked === true) {
                    return node;
                }
                if (!TiTreeUtil.isLeaf(node)) {
                    result = this.initActived(node.children);
                }
                if (!Util.isUndefined(result)) {
                    return result;
                }
            }
            return result;
        };
    }
    ngOnInit() {
        super.ngOnInit();
        this.dataDiffer = this.iterableDiffers.find(this.data)
            .create();
        // 内部使用的数据，用于记录用户的操作改变
        // TODO: 仅在初始化时挡非法数据，是不够的。建议去除。但因为要兼容已发出的版本，所以不去除。
        this.data = !Util.isArray(this.data) ? [] : this.data;
        // 初始化默认选中项高亮
        this.actived = this.initActived(this.data);
    }
    ngDoCheck() {
        super.ngDoCheck();
        const dataChanges = this.dataDiffer.diff(this.data);
        if (dataChanges) {
            // 重新初始化默认选中项高亮
            this.actived = this.initActived(this.data);
        }
    }
    /**
     * @ignore
     * @description 判断是否显示复选框
     * @param node 节点数据
     */
    showCheckboxFn(node) {
        if (this.multiple !== true) {
            return false;
        }
        if (this.parentCheckable === true) {
            return true;
        }
        return TiTreeUtil.isLeaf(node);
    }
    /**
     * @ignore
     * @description 点击父节点图标执行的逻辑
     * @param  node 当前节点数据
     */
    onClickPnodeIcon(node, event) {
        if (node.disabled) {
            return;
        }
        // 阻止事件冒泡：点击父节点图标无高亮样式
        event.stopPropagation();
        this.beforeExpandNode = node;
        // 1.当前节点是展开状态
        if (node.expanded) {
            node.expanded = false;
        }
        else if (this.beforeExpand.observers.length === 0) { // 2.如果未定义beforeExpand事件(非异步)，点击时让节点展开
            node.expanded = true;
        }
        else { // 3.异步获取数据：将组件实例通知出去
            this.beforeExpand.emit(this);
        }
    }
    // 获取异步点击的节点
    getBeforeExpandNode() {
        return this.beforeExpandNode;
    }
    /**
     * @ignore
     * @description 根据item的isExpanded属性获取item图标
     * @param node 当前节点数据
     */
    getItemIcon(node) {
        if (TiTreeUtil.isLeaf(node)) {
            return `${node.expandIcon} ti3-tree-node-icon`;
        }
        return `${(node.expanded) ? node.expandIcon : node.collapseIcon} ti3-tree-node-icon`;
    }
    /**
     * @ignore
     * @description 点击复选框触发select、change事件
     * 需要注意：click事件中拿到的是操作前的选中状态，而change事件中拿到的是操作后的选中状态
     * @param node 当前节点数据
     */
    onInputChange(node, event) {
        if (node.disabled === true) {
            return;
        }
        // 点击当前项高亮
        this.actived = node;
        this.setSeletedState(node, this.data, node.checked);
        if (!this.changedByCheckbox) {
            this.select.emit(node);
        }
        this.change.emit(node);
    }
    /**
     * @ignore
     * 点击文本区域
     * @param node 当前节点数据
     * @param event 鼠标事件
     * @returns void
     */
    onItemWrapperClick(node) {
        if (node.disabled === true || node.editing) {
            return;
        }
        // 悬浮功能: 点击生成节点时，显示操作按钮
        if (!node.editing) {
            node.isHover = true;
        }
        // 点击当前项高亮
        this.actived = node;
        // 1.处理多选情况
        if (this.multiple === true) {
            if (this.changedByCheckbox) {
                this.select.emit(node);
                return;
            }
            // 1.1 处理父节点不支持多选
            if (!this.showCheckboxFn(node)) {
                return;
            }
            // 1.2 处理父节点支持多选
            node.checked = !node.checked;
            // 处理当前节点选中状态变化后，对父子节点的影响
            this.setSeletedState(node, this.data, node.checked);
            this.select.emit(node);
            this.change.emit(node);
            return;
        }
        // 2.处理单选场景
        // 2.1(单选且已选中)或者(单选且非叶子节点)的情况下，点击只会触发select事件,因为当前选中项不会发生变化
        if (node.checked === true || !TiTreeUtil.isLeaf(node)) {
            // 触发select事件
            this.select.emit(node);
            return;
        }
        // 2.2单选叶子节点未选中
        this.deSelectAllNode(this.data);
        node.checked = true;
        TiTreeUtil.selectParents(node, this.data, 'indeterminate'); // 设置祖先节点的选中状态
        // 触发select和change事件
        this.select.emit(node);
        this.change.emit(node);
    }
    /**
     * @ignore
     */
    trackByFn(index, node) {
        return index;
    }
    /**
     * @ignore
     * 判断是否为叶子节点
     */
    isLeaf(node) {
        return !(Util.isArray(node.children));
    }
    /**
     * @ignore
     * @param node 节点数据
     */
    onBlur(node) {
        if (node.focused) {
            node.focused = false; // 失焦后节点删除获焦标志类
        }
    }
    /**
     * @ignore
     * @param node 节点数据
     */
    onFocus(node) {
        if (!node.focused && !node.disabled) {
            node.focused = true; // 设置获焦标志类
        }
    }
    /**
     * @ignore
     * @param event 键盘事件
     * @param node 当前节点数据
     */
    onKeydown(event, node) {
        /**
         * 快捷键交互定义
         * 1,tab键切换焦点至树组件的文本区域，复选框无需提供焦点，文本样式为文本悬浮态
         * 2,树组件内部焦点切换支持上下左右键：
         *    -上下键：按上下键可以在并列的节点移动，如无并列节点无法移动。
         *    -左右键：展开收起节点及跨层级移动焦点。当焦点再子节点时，按左键可收起改节点，焦点移动至父节点；
         *     当焦点在父节点上时，按右键可将焦点移动到启子节点上,如节点未展开则同时展开该子节点
         * 3,Enter键或Space键：当焦点在节点名称上时，按下键则选中或取消该节点，选中后节点变为选中态
         */
        // 阻止默认和冒泡
        if ([TiKeymap.KEY_ENTER, TiKeymap.KEY_NUMPAD_ENTER, TiKeymap.KEY_SPACE, TiKeymap.KEY_ARROW_UP, TiKeymap.KEY_ARROW_DOWN,
            TiKeymap.KEY_ARROW_LEFT, TiKeymap.KEY_ARROW_RIGHT].indexOf(event.keyCode) > -1) {
            event.preventDefault();
            event.stopPropagation();
        }
        switch (event.keyCode) {
            case TiKeymap.KEY_ENTER: // ENTER键
            case TiKeymap.KEY_NUMPAD_ENTER: // ENTER键(苹果数字小键盘)
            case TiKeymap.KEY_SPACE:
                this.onItemWrapperClick(node);
                break;
            case TiKeymap.KEY_ARROW_UP: // 向上箭头，同级
                this.setKeyDownUp(node, 'up');
                break;
            case TiKeymap.KEY_ARROW_DOWN: // 向下箭头，同级
                this.setKeyDownUp(node, 'down');
                break;
            case TiKeymap.KEY_ARROW_LEFT: // 向左箭头，跨节点层级
                this.setKeyleft(node);
                break;
            case TiKeymap.KEY_ARROW_RIGHT: // 向右箭头，跨节点层级
                this.setKeyright(node);
                break;
            default:
                break;
        }
    }
    // 上下键
    setKeyDownUp(node, type) {
        let parArr;
        const pareNode = TiTreeUtil.getParentNode(this.data, node); // 获取父节点
        if (pareNode) {
            parArr = pareNode.children;
        }
        else {
            parArr = this.data;
        }
        const curIndex = parArr.findIndex((item) => item === node); // 获取当前节点在其父节点集合的index
        this.setFocusNode(node, parArr, curIndex, type);
    }
    // 左键
    setKeyleft(node) {
        // 当正在编辑时，关闭其父节点时，节点恢复文本状态
        if (node.editing && node.label !== '') {
            delete node.editing;
        }
        const pareNode = TiTreeUtil.getParentNode(this.data, node);
        if (!pareNode) { // 当前节点时一级节点时 return
            return;
        }
        pareNode.expanded = false;
        if (pareNode.disabled) {
            this.setKeyleft(pareNode);
            return;
        }
        pareNode.focused = true;
        this.setFocusElem(node);
    }
    // 右键
    setKeyright(node) {
        if (TiTreeUtil.isLeaf(node)) {
            return;
        }
        const childNodeArr = node.children;
        const childnoDisabledArr = childNodeArr.filter((childNode) => !childNode.disabled); // 获取子节点未禁用的节点集合
        if (childnoDisabledArr.length < 1) {
            return;
        }
        const childFirstNode = childnoDisabledArr[0]; // 未禁用的节点集合的first获取焦点
        childFirstNode.focused = true;
        if (!node.expanded) {
            node.expanded = true;
        }
        this.setFocusElem(node);
    }
    // 上下键焦点处理
    setFocusNode(node, parList, curIndex, type) {
        let targetNode;
        let targetIndex;
        let _curIndex = curIndex;
        if (type === 'up') { // 同级获取上一个节点
            targetIndex = _curIndex - 1;
            if (targetIndex < 0) {
                targetIndex = parList.length - 1;
            }
            targetNode = parList[targetIndex];
        }
        else { // 同级获取下一个节点
            targetIndex = _curIndex + 1;
            if (targetIndex > (parList.length - 1)) {
                targetIndex = 0;
            }
            targetNode = parList[targetIndex];
        }
        // 上下移动时，first或last节点禁用时,return
        if ((targetNode === parList[0] || targetNode === parList[parList.length - 1]) && targetNode.disabled) {
            return;
        }
        // 当中间节点有禁用时，移动到禁用的节点上一个或下一个节点
        if (targetNode.disabled) {
            _curIndex = targetIndex;
            this.setFocusNode(node, parList, _curIndex, type);
            return;
        }
        targetNode.focused = true;
        this.setFocusElem(node);
    }
    // 目标元素获取焦点
    setFocusElem(node) {
        if (node.focused) {
            node.focused = false;
        }
        // 当按键操作会改变文本元素是否添加class`ti3-tree-text-focus`, 加延时是为了class变更后，获取正确的含有class的文本区域元素
        // 类ti3-tree-text-focus作为获焦元素的标志
        setTimeout(() => {
            // 找到含有类ti3-tree-text-focus的文本元素
            const focusNode = this.elems.toArray().find((elem) => this.tiRenderer.hasClass(elem.nativeElement, 'ti3-tree-text-focus'));
            if (focusNode) {
                focusNode.nativeElement.focus();
            }
        }, 0);
    }
    /**
     * @ignore
     * @param startEvent 鼠标事件
     * @param node 当前节点数据
     * @description 拖拽开始时在被拖拽元素上触发此事件
     */
    onDragstart(event, node) {
        event.stopPropagation();
        this.dragNode = node; // 保存被拖拽的节点
    }
    /**
     * @ignore
     * @param enterEvent 鼠标事件
     * @param node 当前节点数据
     * @description 拖拽鼠标进入元素时在该元素上触发
     */
    onDragenter(event, node) {
        event.preventDefault();
        this.overNode = null;
        // 拖拽节点和目标节点是同一节点,retuen
        if (node === this.dragNode) {
            return;
        }
        // 保存移动到的节点
        this.overNode = node;
        // 拖拽的节点拖拽到其子节点时，关闭其节点
        if (this.dragNode === TiTreeUtil.getParentNode(this.data, node)) {
            this.dragNode.expanded = false;
        }
    }
    /**
     * @ignore
     * @param overEvent 鼠标事件
     * @param node 当前节点数据
     * @description 拖拽时鼠标在目标元素上移动时触发
     */
    onDragover(event, node) {
        event.preventDefault();
        event.dataTransfer.effectAllowed = "move";
        if (node === this.overNode) {
            this.clearDragClass(event); // 清除节点之前的样式
            this.dropPosition = this.calcDropPosition(event); // 获取移动到节点的位置
            // 拖拽经过节点,放置内部位置时，且该节点未展开时，展开其节点
            if (this.dropPosition === 0 && !node.expanded) {
                node.expanded = true;
            }
            // 设置拖动过程中的状态样式
            this.renderer2.addClass(event.currentTarget, this.setDragOverClass(node));
        }
        ;
    }
    /**
     * @ignore
     * @param leaveEvent 鼠标事件
     * @param node 当前节点数据
     * @description 拖拽时鼠标在离开目标元素时触发
     */
    onDragleave(event, node) {
        event.preventDefault();
        this.clearDragClass(event);
    }
    /**
     * @ignore
     * @param dropEvent 鼠标事件
     * @param node 当前节点数据
     * @description 鼠标在拖放目标上释放时,在拖放目标上触发
     */
    onDrop(event, node) {
        event.preventDefault();
        this.dragNode.focused = false;
        this.clearDragClass(event);
        // 异步加载节点时禁止放置到节点内部
        if (this.dropPosition === 0 && node.loadStatus === 'loading') {
            return;
        }
        // 拖拽节点和目标节点是同一节点,retuen
        if (node === this.dragNode) {
            return;
        }
        const params = {
            event: event,
            targetNode: node,
            dragNode: this.dragNode,
            dropPosition: this.dropPosition
        };
        TiTreeUtil.dropApply(params, this.data, this.multiple);
        this.nodeDrop.emit(params);
    }
    /**
     * @ignore
     * @param endEvent 鼠标事件
     * @param node 当前节点数据
     * @description 鼠标在拖放目标上释放时,在拖拽元素上触发
     */
    onDragend(event, node) {
        event.preventDefault();
        this.dragNode = null;
        this.overNode = null;
    }
    // 计算拖拽节点的放置方式0（作为目标节点的子节点），-1（放置在目标节点的前面）,1（放置在目标节点的后面）
    calcDropPosition(event) {
        const clientY = event.clientY;
        const { top, height } = event.target.getBoundingClientRect();
        const gapHeight = height / 3;
        if (clientY > top + height - gapHeight) {
            return 1;
        }
        if (clientY < top + gapHeight) {
            return -1;
        }
        return 0;
    }
    // 清除拖拽样式
    clearDragClass(event) {
        // 拖拽过程中的三种状态
        const dragClasses = ['ti3-tree-drag-over-inner', 'ti3-tree-drag-over-top', 'ti3-tree-drag-over-bottom'];
        dragClasses.forEach((item) => {
            this.renderer2.removeClass(event.currentTarget, item);
        });
    }
    // 根据拖动的位置获取相应的样式
    setDragOverClass(node) {
        if (node !== this.overNode) {
            return;
        }
        if (this.dropPosition === 0) {
            return "ti3-tree-drag-over-inner";
        }
        else if (this.dropPosition === -1) {
            return "ti3-tree-drag-over-top";
        }
        else if (this.dropPosition === 1) {
            return "ti3-tree-drag-over-bottom";
        }
        return "";
    }
    /**
     * @ignore
     * @param node 节点
     * @param type hover标志
     */
    onMousenode(node, type) {
        // 鼠标进入节点且不是编辑状态时，显示操作按钮
        if (type === 'enter' && !node.editing) {
            node.isHover = true;
        }
        else {
            delete node.isHover;
        }
    }
    /**
     * @ignore
     * @param node 节点
     */
    onBlurEdit(node) {
        if (node.label !== '') {
            delete node.editing;
        }
    }
    /**
      * @ignore
      * @param deleteEvent 删除事件
      * @param node 节点
      */
    deleteNode(event, node) {
        // 阻止事件冒泡 防止触发选中
        event.stopPropagation();
        const parentNode = TiTreeUtil.getParentNode(this.data, node);
        TiTreeUtil.removeNode(this.data, node);
        // 节点的父节点无子节点时， 删除children属性，解决依旧会显示展开图标问题
        if (parentNode && parentNode.children.length < 1) {
            delete parentNode.children;
        }
        // 更新多选状态
        if (this.multiple) {
            TiTreeUtil.updateChecked(this.data);
        }
        this.nodeDeleted.emit(node);
    }
    /**
     * @ignore
     * @param editEvent 编辑事件
     * @param node 节点
     */
    editNode(event, node) {
        // 阻止事件冒泡 防止触发选中
        event.stopPropagation();
        node.editing = true;
        delete node.isHover;
        this.nodeEdited.emit(node);
        // autofocus视图变化时 会报错 视图变化时 强制变检一次，消除报错(Expression has changed after it was checked)
        this.cdRef.detectChanges();
    }
    /**
     * @ignore
     * @param addEvent 增加事件
     * @param node 节点
     */
    addNode(event, node) {
        // 阻止事件冒泡 防止触发选中
        event.stopPropagation();
        const newNode = {
            label: this.treeLan.newNode,
            editing: true,
        };
        node.expanded = true;
        this.nodeAdded.emit(newNode);
        TiTreeUtil.addNode(this.data, [newNode], 0, node);
        // 更新多选状态
        if (this.multiple) {
            TiTreeUtil.updateChecked(this.data);
        }
        // autofocus视图变化时 会报错 强制变检一次，消除报错(Expression has changed after it was checked)
        this.cdRef.detectChanges();
    }
}
TiTreeComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-tree',
                template: "<ul class=\"ti3-tree-container ti3-tree-parent-node\" [id]=\"appendId('list')\">\r\n    <li *ngFor=\"let node of data; index as i;\">\r\n        <ng-container *ngTemplateOutlet=\"treeItem; context: {$implicit: node, index: i}\"></ng-container>\r\n    </li>\r\n</ul>\r\n\r\n<ng-template #treeItem let-node let-i=index>\r\n    <div class=\"ti3-tree-content-box\"\r\n        [id]=\"appendId(i + '_node')\"\r\n        [ngClass]=\"{'ti3-tree-item-leaf': isLeaf(node), 'ti3-tree-content-box-disabled': node.disabled}\">\r\n        <span class=\"ti3-tree-item-guide-line\"></span>\r\n        <ti-loading *ngIf=\"node.loadStatus === 'loading'\" class=\"ti3-tree-item-loading\"></ti-loading>\r\n        <i (click)=\"onClickPnodeIcon(node, $event)\" *ngIf=\"!node.loadStatus || node.loadStatus !== 'loading'\"\r\n            [id]=\"appendId(i + '_icon')\"\r\n            class=\"ti3-icon\"\r\n            [ngClass]=\"{'ti3-icon-minus-square': !isLeaf(node) && node.expanded,\r\n                        'ti3-icon-plus-square': !isLeaf(node) && !node.expanded,\r\n                        'ti3-icon-square-disabled': !isLeaf(node) && node.disabled}\">\r\n        </i>\r\n        <label class=\"ti3-tree-checkbox-wrapper\" *ngIf=\"multiple\">\r\n            <input type=\"checkbox\" [(ngModel)]=\"node.checked\" [disabled]=\"node.disabled\" *ngIf=\"showCheckboxFn(node)\" [id]=\"appendId('checkbox_' + i)\"\r\n                [indeterminate]=\"node.checked === 'indeterminate'\" (change)=\"onInputChange(node, $event)\" tabindex=\"-1\" tiCheckbox />\r\n        </label>\r\n        <div (click)=\"onItemWrapperClick(node)\" [id]=\"appendId(i + '_content')\" class=\"ti3-tree-node-text-wrapper\" #nodeList\r\n             (keydown)=\"onKeydown($event, node)\"\r\n             (blur)=\"onBlur(node)\"\r\n             (focus)=\"onFocus(node)\"\r\n             [tabindex]=\"node.disabled ? -1 : 0\"\r\n             [draggable]=\"node.disabled ? false : nodeDraggable\"\r\n             (dragstart)=\"onDragstart($event, node)\"\r\n             (dragenter)=\"onDragenter($event, node)\"\r\n             (dragover)=\"onDragover($event, node)\"\r\n             (dragleave)=\"onDragleave($event, node)\"\r\n             (drop)=\"onDrop($event, node)\"\r\n             (dragend)=\"onDragend($event, node)\"\r\n             (mouseenter)=\"onMousenode(node, 'enter')\"\r\n             (mouseleave)=\"onMousenode(node, 'leave')\"\r\n             [ngClass]=\"{'ti3-tree-item-active' : actived === node,\r\n                    'ti3-tree-text-disabled-wrapper': node.disabled,\r\n                    'ti3-tree-text-nomultiple-wrapper': !multiple && !isLeaf(node),\r\n                    'ti3-tree-text-multiple-leaf-wrapper': multiple && isLeaf(node),\r\n                    'ti3-tree-text-leaf-wrapper': !multiple && isLeaf(node),\r\n                    'ti3-tree-text-focus': node.focused,\r\n                    'ti3-tree-content-drag-box': nodeDraggable}\">\r\n            <ng-container *ngIf=\"itemTemplate else labelTemplate\">\r\n                <ng-container *ngTemplateOutlet=\"itemTemplate; context: {$implicit: node, index: i}\">\r\n                </ng-container>\r\n            </ng-container>\r\n            <ng-template #labelTemplate>\r\n                <ng-container *ngIf=\"(node.loadStatus !== 'error') else errorTemplate\">\r\n                    <i class=\"{{getItemIcon(node)}}\" *ngIf='node.expandIcon || node.collapseIcon'></i>\r\n                    <span [title]=\"node.label\" *ngIf=\"!node.editing\" class='ti3-tree-node-text' [innerHTML]=\"node.label | tiHighlight: highlightWords\"></span>\r\n                    <input  tiText\r\n                            tiValidation\r\n                            tiRequired\r\n                            tiAutoSelect\r\n                            autofocus\r\n                            *ngIf=\"node.editing\"\r\n                            autoComplete=\"off\"\r\n                            class=\"ti3-tree-edit-input\"\r\n                            [id]=\"appendId(i + '_input')\"\r\n                            (blur)=\"onBlurEdit(node)\"\r\n                            [(ngModel)] = \"node.label\"\r\n                            (keyup.enter)=\"onBlurEdit(node)\">\r\n                    <ng-container *ngIf=\"node.isHover && !node.disabled\">\r\n                        <ti-icon name=\"add1\"\r\n                                *ngIf=\"node.addable\"\r\n                                [id]=\"appendId(i + '_add')\"\r\n                                (click)=\"addNode($event, node)\"\r\n                                class=\"ti3-tree-operate\"></ti-icon>\r\n                        <ti-icon\r\n                                name=\"edit\"\r\n                                *ngIf=\"node.editable\"\r\n                                [id]=\"appendId(i + '_edit')\"\r\n                                (click)=\"editNode($event, node)\"\r\n                                class=\"ti3-tree-operate\"></ti-icon>\r\n                        <ti-icon name=\"delete-1\"\r\n                                *ngIf=\"node.deleteable\"\r\n                                [id]=\"appendId(i + '_delete')\"\r\n                                (click)=\"deleteNode($event,node)\"\r\n                                class=\"ti3-tree-operate\"></ti-icon>\r\n                    </ng-container>\r\n                </ng-container>\r\n                <ng-template #errorTemplate>\r\n                    <i class='ti3-tree-error-icon ti3-icon ti3-icon-alert-warn'></i>\r\n                    <span>{{treeLan.loadError}}<span [id]=\"appendId(i + '_error')\" (click)=\"onClickPnodeIcon(node, $event)\" class=\"ti3-tree-item-reload\">{{treeLan.reload}}</span></span>\r\n                </ng-template>\r\n            </ng-template>\r\n        </div>\r\n    </div>\r\n    <ul *ngIf=\"!isLeaf(node) && node.expanded\" class='ti3-tree-parent-node' [id]=\"appendId('child_list_' + i)\">\r\n        <li class='ti3-tree-leaf-node'\r\n            *ngFor=\"let children of node.children; index as j; trackBy: trackByFn\">\r\n            <ng-container *ngTemplateOutlet=\"treeItem; context: {$implicit: children, index: i + '_' + j}\"></ng-container>\r\n        </li>\r\n    </ul>\r\n</ng-template>",
                styles: ["::ng-deep :root{--ti-tree-error-icon-size:16px;--ti-tree-item-guide-line-first-child-space:var(--ti-common-space-2x);--ti-tree-item-guide-line-width:8px;--ti-tree-node-icon-font-size:16px;--ti-tree-node-icon-space:calc(var(--ti-tree-square-icon-font-size) + var(--ti-tree-node-icon-font-size) + var(--ti-common-space-base)*2 + var(--ti-tree-icon-right-space)*2);--ti-tree-node-text-multiple-leaf-space:calc(var(--ti-tree-node-icon-font-size) + var(--ti-common-space-base) + var(--ti-tree-icon-right-space)*2);--ti-tree-node-text-nomultiple-space:calc(var(--ti-tree-square-icon-font-size) + var(--ti-tree-icon-right-space)*2);--ti-tree-node-text-padding-space:calc(var(--ti-common-space-2x) + var(--ti-common-space-base));--ti-tree-small-checkbox-size:12px;--ti-tree-small-icon-font-size:12px;--ti-tree-small-icon-space:calc(var(--ti-common-space-base)/2)}.ti3-tree-node-text{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ti3-tree-parent-node{font-size:var(--ti-common-font-size-base);position:relative}.ti3-tree-node-icon{font-size:var(--ti-tree-node-icon-font-size);margin-right:var(--ti-tree-icon-right-space);text-align:center}.ti3-tree-leaf-node{margin-left:var(--ti-common-space-6x);position:relative}.ti3-tree-node-text-wrapper{align-items:center;display:flex;padding:0 var(--ti-common-space-2x) 0 var(--ti-common-space-base);white-space:nowrap;width:calc(100% - var(--ti-tree-node-icon-space))}.ti3-tree-node-text-wrapper:hover{background:var(--ti-tree-content-box-color-hover)}.ti3-tree-node-text-wrapper:hover.ti3-tree-text-disabled-wrapper{background:none}.ti3-tree-node-text-wrapper:focus{outline:none}.ti3-tree-node-text-wrapper.ti3-tree-text-focus{background:var(--ti-tree-content-box-color-hover);outline:none}.ti3-tree-node-text-wrapper .ti3-tree-operate{color:var(--ti-common-color-icon-normal);font-size:var(--ti-common-font-size-2);margin-left:var(--ti-common-space-2x)}.ti3-tree-node-text-wrapper .ti3-tree-operate:active,.ti3-tree-node-text-wrapper .ti3-tree-operate:hover{color:var(--ti-common-color-icon-hover);cursor:pointer}.ti3-tree-node-text-wrapper .ti3-tree-operate:first-of-type{margin-left:var(--ti-common-space-3x)}.ti3-tree-node-text-wrapper .ti3-tree-edit-input{height:var(--ti-tree-item-height)}.ti3-tree-text-nomultiple-wrapper{width:calc(100% - var(--ti-tree-node-text-nomultiple-space))}.ti3-tree-text-multiple-leaf-wrapper{width:calc(100% - var(--ti-tree-node-text-multiple-leaf-space))}.ti3-tree-text-leaf-wrapper{width:calc(100% - var(--ti-tree-node-text-padding-space))}.ti3-tree-content-box{align-items:center;cursor:pointer;display:flex;height:var(--ti-tree-item-height);line-height:var(--ti-tree-item-lineheight);padding-left:var(--ti-tree-content-box-left-space)}.ti3-tree-content-box-disabled{color:var(--ti-common-color-text-disabled);cursor:not-allowed}.ti3-tree-item-active,.ti3-tree-item-active:focus,.ti3-tree-item-active:hover{background:var(--ti-tree-node-bg-color-checked)}.ti3-tree-item-leaf{margin-left:calc(var(--ti-tree-square-icon-font-size) + var(--ti-common-space-base))}.ti3-tree-checkbox-wrapper{display:inline-block;font-size:0}:host .ti3-tree-content-box .ti3-tree-checkbox-wrapper ::ng-deep input[type=checkbox][tiCheckbox]+.ti3-checkbox .ti3-checkbox-skin{margin:0 var(--ti-common-space-base) 0 var(--ti-common-space-base)}.ti3-tree-item-loading{margin-right:var(--ti-common-space-2x)}.ti3-tree-item-reload{color:var(--ti-common-color-text-link);text-decoration:none}.ti3-tree-item-reload:hover{color:var(--ti-common-color-text-link-hover);text-decoration:underline}.ti3-tree-error-icon{background-color:var(--ti-valid-error-color);border-radius:50%;color:var(--ti-common-color-text-white);display:inline-block;height:var(--ti-tree-error-icon-size);line-height:var(--ti-tree-error-icon-size);margin-right:var(--ti-common-space-2x);text-align:center;width:var(--ti-tree-error-icon-size)}.ti3-tree-container .ti3-icon-minus-square{color:var(--ti-tree-minus-square-color)}.ti3-tree-container .ti3-icon-plus-square{color:var(--ti-tree-plus-square-color)}.ti3-tree-container .ti3-icon-square-disabled{background:var(--ti-common-color-bg-disabled);color:var(--ti-common-color-icon-graybg-disabled)}.ti3-tree-container .ti3-icon-minus-square,.ti3-tree-container .ti3-icon-plus-square{display:inline-block;font-size:var(--ti-tree-square-icon-font-size);line-height:var(--ti-tree-square-icon-font-size);margin-right:var(--ti-common-space-base);width:var(--ti-tree-square-icon-font-size)}.ti3-tree-container .ti3-icon-minus-square:hover,.ti3-tree-container .ti3-icon-plus-square:hover{color:var(--ti-tree-icon-color-active);cursor:pointer}.ti3-tree-container .ti3-icon-minus-square:hover.ti3-icon-square-disabled,.ti3-tree-container .ti3-icon-plus-square:hover.ti3-icon-square-disabled{color:var(--ti-common-color-icon-graybg-disabled);cursor:not-allowed}.ti3-tree-container .ti3-icon-minus-square:active,.ti3-tree-container .ti3-icon-plus-square:active{background:var(--ti-tree-icon-bg-color-active);color:var(--ti-tree-icon-color-active)}.ti3-tree-container .ti3-icon-minus-square:active.ti3-icon-square-disabled,.ti3-tree-container .ti3-icon-plus-square:active.ti3-icon-square-disabled{background:var(--ti-common-color-bg-disabled);color:var(--ti-common-color-icon-graybg-disabled)}.ti3-tree-content-drag-box{border-bottom:2px solid transparent;border-top:2px solid transparent;box-sizing:border-box;height:var(--ti-tree-item-height)}.ti3-tree-drag-over-inner{border:2px solid var(--ti-common-color-line-active);padding:0 6px 0 2px}.ti3-tree-drag-over-top{border-top:2px solid var(--ti-common-color-line-active)}.ti3-tree-drag-over-bottom{border-bottom:2px solid var(--ti-common-color-line-active)}.ti3-tree-leaf-node>.ti3-tree-content-box>.ti3-tree-item-guide-line{-ms-box-sizing:border-box;border-bottom:1px solid var(--ti-tree-item-guide-line-color);border-left:1px solid var(--ti-tree-item-guide-line-color);box-sizing:border-box;height:var(--ti-tree-item-height);left:calc(-1*var(--ti-tree-square-icon-font-size)/2);position:absolute;top:calc(-1*var(--ti-tree-item-height)/2);width:var(--ti-tree-item-guide-line-width)}.ti3-tree-leaf-node:first-child>.ti3-tree-content-box>.ti3-tree-item-guide-line{height:calc(var(--ti-tree-item-height) - var(--ti-tree-square-icon-font-size)/2 - var(--ti-tree-item-guide-line-first-child-space));top:calc(var(--ti-tree-square-icon-font-size)/2 + var(--ti-tree-item-guide-line-first-child-space) - var(--ti-tree-item-height)/2)}.ti3-tree-leaf-node:not(:last-child)>.ti3-tree-parent-node:after{-ms-box-sizing:border-box;border-left:1px solid var(--ti-tree-item-guide-line-color);box-sizing:border-box;content:\"\";height:100%;left:calc(-1*var(--ti-tree-square-icon-font-size)/2);position:absolute;top:calc(-1*var(--ti-tree-item-height)/2);width:var(--ti-tree-item-guide-line-width)}:host[small] .ti3-icon-minus-square,:host[small] .ti3-icon-plus-square{font-size:var(--ti-tree-small-icon-font-size);line-height:var(--ti-tree-small-icon-font-size);margin-right:var(--ti-tree-small-icon-space);width:var(--ti-tree-small-icon-font-size)}:host[small] .ti3-tree-node-icon{font-size:var(--ti-tree-small-icon-font-size);margin-right:var(--ti-common-space-base)}:host[small] .ti3-tree-content-box .ti3-tree-checkbox-wrapper ::ng-deep input[type=checkbox][tiCheckbox]+.ti3-checkbox .ti3-checkbox-skin{height:var(--ti-tree-small-checkbox-size);line-height:var(--ti-tree-small-checkbox-size);margin:0 var(--ti-tree-small-icon-space) 0 var(--ti-tree-small-icon-space);width:var(--ti-tree-small-checkbox-size)}:host[small] .ti3-tree-content-box .ti3-tree-checkbox-wrapper ::ng-deep input[type=checkbox][tiCheckbox]:indeterminate+.ti3-checkbox .ti3-checkbox-skin:before{left:2px;top:2px}:host[small] .ti3-tree-content-box .ti3-tree-checkbox-wrapper ::ng-deep input[type=checkbox][tiCheckbox]:checked+.ti3-checkbox .ti3-checkbox-skin:before{height:7px;width:5px}:host[small] .ti3-tree-item-leaf{margin-left:calc(var(--ti-tree-small-icon-font-size) + var(--ti-tree-small-icon-space))}:host[small] .ti3-tree-content-box{padding-left:var(--ti-common-space-base)}:host[small] .ti3-tree-leaf-node{margin-left:calc(var(--ti-common-space-base) + var(--ti-tree-small-icon-font-size))}:host[small] .ti3-tree-leaf-node .ti3-tree-content-box{padding-left:var(--ti-common-space-base)}:host[small] .ti3-tree-leaf-node>.ti3-tree-content-box>.ti3-tree-item-guide-line{left:calc(-1*var(--ti-tree-small-icon-font-size)/2);width:calc(var(--ti-tree-small-icon-font-size)/2)}:host[small] .ti3-tree-leaf-node:not(:last-child)>.ti3-tree-parent-node:after{left:calc(-1*var(--ti-tree-small-icon-font-size)/2)}:host[small] .ti3-tree-node-text-wrapper{padding-left:var(--ti-tree-small-icon-space)}::ng-deep .ti3-font-highlight{color:var(--ti-common-color-text-highlight)}"]
            },] }
];
TiTreeComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: IterableDiffers },
    { type: TiRenderer },
    { type: ChangeDetectorRef }
];
TiTreeComponent.propDecorators = {
    data: [{ type: Input }],
    parentCheckable: [{ type: Input }],
    multiple: [{ type: Input }],
    changedByCheckbox: [{ type: Input }],
    highlightWords: [{ type: Input }],
    nodeDraggable: [{ type: Input }],
    beforeExpand: [{ type: Output }],
    select: [{ type: Output }],
    change: [{ type: Output }],
    nodeDrop: [{ type: Output }],
    nodeAdded: [{ type: Output }],
    nodeEdited: [{ type: Output }],
    nodeDeleted: [{ type: Output }],
    itemTemplate: [{ type: ContentChild, args: [TemplateRef, /* TODO: add static flag */ { static: true },] }],
    elems: [{ type: ViewChildren, args: ['nodeList',] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlUcmVlQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvdHJlZS9UaVRyZWVDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQzdELGVBQWUsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3RILE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDMUMsT0FBTyxFQUFFLFFBQVEsRUFBRyxNQUFNLDZCQUE2QixDQUFDO0FBQ3hELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQXFGaEU7Ozs7Ozs7O0dBUUc7QUFNSCxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxlQUFlO0lBK0doRCxZQUFzQixVQUFzQixFQUN0QixTQUFvQixFQUNwQixlQUFnQyxFQUNsQyxVQUFzQixFQUN0QixLQUF3QjtRQUNoQyxLQUFLLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBTG5CLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNwQixvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDbEMsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixVQUFLLEdBQUwsS0FBSyxDQUFtQjtRQTlHNUM7O1dBRUc7UUFDTSxvQkFBZSxHQUFZLElBQUksQ0FBQztRQUN6Qzs7V0FFRztRQUNNLGFBQVEsR0FBWSxLQUFLLENB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QixDQUFDOzs7WUFodEJKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsU0FBUztnQkFDbkIsa2xNQUEwQjs7YUFFN0I7OztZQXhHaUMsVUFBVTtZQUNmLFNBQVM7WUFBbEMsZUFBZTtZQUtWLFVBQVU7WUFMMkQsaUJBQWlCOzs7bUJBNEcxRixLQUFLOzhCQUlMLEtBQUs7dUJBSUwsS0FBSztnQ0FjTCxLQUFLOzZCQUtMLEtBQUs7NEJBS0wsS0FBSzsyQkFJTCxNQUFNO3FCQUtOLE1BQU07cUJBS04sTUFBTTt1QkFLTixNQUFNO3dCQUtOLE1BQU07eUJBS04sTUFBTTswQkFLTixNQUFNOzJCQWFOLFlBQVksU0FBQyxXQUFXLEVBQUUsMkJBQTJCLENBQUMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO29CQUt0RSxZQUFZLFNBQUMsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29udGVudENoaWxkLCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIElucHV0LCBJdGVyYWJsZUNoYW5nZXMsIEl0ZXJhYmxlRGlmZmVyLFxyXG4gICAgSXRlcmFibGVEaWZmZXJzLCBPdXRwdXQsIFJlbmRlcmVyMiwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZHJlbiwgUXVlcnlMaXN0LCBDaGFuZ2VEZXRlY3RvclJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFV0aWwsIFRpS2V5bWFwIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCB7IFRpQmFzZUNvbXBvbmVudCB9IGZyb20gJy4uL2Jhc2UvVGlCYXNlTW9kdWxlJztcclxuaW1wb3J0IHsgVGlUcmVlVXRpbCB9IGZyb20gJy4vVGlUcmVlVXRpbCc7XHJcbmltcG9ydCB7IFRpTG9jYWxlICB9IGZyb20gJy4uLy4uL2xvY2FsZS9UaUxvY2FsZU1vZHVsZSc7XHJcbmltcG9ydCB7IFRpUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9yZW5kZXJlci9UaVJlbmRlcmVyJztcclxuLy8gVE9ETzog6YeH55SoVGlDaGVja2dyb3Vw6YeN5p6E5ZCO77yM5LiN6ZyA6KaB6YKj5LmI5aSaVHJlZVV0aWzmlrnms5XvvIzkuI3pnIDopoHpgInkuK3oioLngrkv5Y+W5raI6YCJ5Lit6IqC54K55pa55rOV44CCXHJcbi8qKlxyXG4gKiDmoJHnu4Tku7bkuK3mr4/kuKroioLngrnnmoTphY3nva5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGlUcmVlTm9kZSB7XHJcbiAgICAvKipcclxuICAgICAqIOiKgueCueWxleekuuWGheWuuVxyXG4gICAgICovXHJcbiAgICBsYWJlbD86IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog5o6n5Yi26IqC54K55piv5ZCm5bGV5byAXHJcbiAgICAgKi9cclxuICAgIGV4cGFuZGVkPzogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICog6IqC54K56YCJ5Lit54q25oCB77yI5aSa6YCJ5Zy65pmv77yJ77ya6YCJ5Lit77yM5pyq6YCJ5Lit77yM5Y2K6YCJIHRydWUgfCBmYWxzZSB8ICdpbmRldGVybWluYXRlJ1xyXG4gICAgICovXHJcbiAgICBjaGVja2VkPzogYm9vbGVhbiB8IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog6IqC54K55bGV5byA5pe255qE5a2X5L2T5Zu+5qCH77ya6IqC54K55Zu+5qCH55qE5qC35byP57G75ZCN56ewXHJcbiAgICAgKlxyXG4gICAgICogMTAuMS4y54mI5pys5LmL5ZCO5Y+v6YCa6L+H6Ieq5a6a5LmJ5qih5p2/5re75Yqg5Zu+5qCH5Y+K5qC35byPXHJcbiAgICAgKi9cclxuICAgIGV4cGFuZEljb24/OiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOiKgueCueaUtui1t+aXtueahOWtl+S9k+Wbvuagh++8muiKgueCueWbvuagh+eahOagt+W8j+exu+WQjeensFxyXG4gICAgICpcclxuICAgICAqIDEwLjEuMueJiOacrOS5i+WQjuWPr+mAmui/h+iHquWumuS5ieaooeadv+a3u+WKoOWbvuagh+WPiuagt+W8j1xyXG4gICAgICovXHJcbiAgICBjb2xsYXBzZUljb24/OiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOaOp+WItuWkmumAieeahOiKgueCuWNoZWNrYm945piv5ZCm54Gw5YyWXHJcbiAgICAgKi9cclxuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICog5a2Q6IqC54K55a2X5q6177yM5LiA5pem6K6+572uY2hpbGRyZW46IFtd77yM5YiZ6K6k5Li66K+l6IqC54K56Z2e5Y+25a2Q6IqC54K5XHJcbiAgICAgKi9cclxuICAgIGNoaWxkcmVuPzogQXJyYXk8VGlUcmVlTm9kZT47XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuMiDmlrDlop5cclxuICAgICAqIOW8guatpeWKoOi9veeKtuaAge+8jGxvYWRpbmfmraPlnKjliqDovb3vvIxlcnJvcuWKoOi9veWksei0pe+8jHN1Y2Nlc3PliqDovb3miJDlip9cclxuICAgICAqL1xyXG4gICAgbG9hZFN0YXR1cz86ICdsb2FkaW5nJyB8ICdlcnJvcicgfCAnc3VjY2Vzcyc7XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuNCDmlrDlop5cclxuICAgICAqIOaUr+aMgeaCrOa1rue8lui+keWKn+iDvVxyXG4gICAgICovXHJcbiAgICBlZGl0YWJsZT86IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuNCDmlrDlop5cclxuICAgICAqIOaUr+aMgeaCrOa1ruWinuWKoOWKn+iDvVxyXG4gICAgICovXHJcbiAgICBhZGRhYmxlPzogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICogMTAuMS40IOaWsOWinlxyXG4gICAgICog5pSv5oyB5oKs5rWu5Yig6Zmk5Yqf6IO9XHJcbiAgICAgKi9cclxuICAgIGRlbGV0ZWFibGU/OiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhYHorrjmnInlpJrkvZnnmoTlsZ7mgKflrZfmrrVcclxuICAgICAqL1xyXG4gICAgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnk7XHJcbn1cclxuLyoqXHJcbiAqIDEwLjEuNCDmlrDlop5cclxuICogZHJhZyBpbmZvXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFRpVHJlZURyYWdOb2RlIHtcclxuICAgIC8qKlxyXG4gICAgICog5LqL5Lu25a+56LGhXHJcbiAgICAgKi9cclxuICAgIGV2ZW50PzogRHJhZ0V2ZW50LFxyXG4gICAgLyoqXHJcbiAgICAgKiDnm67moIfoioLngrlcclxuICAgICAqL1xyXG4gICAgdGFyZ2V0Tm9kZT86IFRpVHJlZU5vZGUsXHJcbiAgICAvKipcclxuICAgICAqIOiiq+aLluaLveeahOiKgueCuVxyXG4gICAgICovXHJcbiAgICBkcmFnTm9kZT86IFRpVHJlZU5vZGUsXHJcbiAgICAvKipcclxuICAgICAqIOaUvue9ruS9jee9ru+8jC0x5Luj6KGo5b2T5YmN6IqC54K55YmN77yMMOS7o+ihqOW9k+WJjeiKgueCuemHjOmdou+8jDHku6PooajlvZPliY3oioLngrnlkI5cclxuICAgICAqL1xyXG4gICAgZHJvcFBvc2l0aW9uPzogbnVtYmVyXHJcbiB9XHJcbi8qKlxyXG4gKiBUcmVl5qCR57uE5Lu2XHJcbiAqXHJcbiAqIOWIhuexu++8muaUr+aMgeWNlemAieOAgeWkmumAieS4pOenjeexu+Wei1xyXG4gKlxyXG4gKiDlhazlhbHmlrnms5XvvJrmoJHnu4Tku7bmj5DkvpsgW1RpVHJlZVV0aWxde0BsaW5rIC4uL2NsYXNzZXMvVGlUcmVlVXRpbC5odG1sfSDlhazlhbHmlrnms5XvvIzljIXmi6zlop7jgIHliKDjgIHmlLnjgIHmn6XjgIHpgInkuK3jgIHlj5bmtojpgInkuK3jgIHpgY3ljobjgIHnrZvpgInjgIHojrflj5bpgInkuK3pobnnrYnmk43kvZxcclxuICpcclxuICogPGV4YW1wbGUtdXJsPi4uL3RpbnkzZGVtby8jL3RyZWUvdHJlZS1hbGw8L2V4YW1wbGUtdXJsPlxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3RpLXRyZWUnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3RyZWUuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi90cmVlLmxlc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIFRpVHJlZUNvbXBvbmVudCBleHRlbmRzIFRpQmFzZUNvbXBvbmVudCB7XHJcbiAgICAvKipcclxuICAgICAqIFRyZWXnu4Tku7bkvb/nlKjnmoTmlbDmja5cclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgZGF0YTogQXJyYXk8VGlUcmVlTm9kZT47XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruWkmumAieagkeaXtu+8jOeItuiKgueCueaYr+WQpuWPr+iiq+eCueWHu+mAieS4re+8jOm7mOiupOeItuiKgueCueWtkOiKgueCuemDveaYvuekuuWkjemAieahhu+8jOmDveWPr+iiq+mAieS4re+8jOiuvue9rmZhbHNl5pe277yM5Y+q5pyJ5a2Q6IqC54K55YmN6L655pi+56S65aSN6YCJ5qGG44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHBhcmVudENoZWNrYWJsZTogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruaYr+WQpuS4uuWkmumAieOAglxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBtdWx0aXBsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPkuLrlpJrpgInml7bor6XmjqXlj6PmiY3nlJ/mlYjjgIJcclxuICAgICAqXHJcbiAgICAgKiDpu5jorqTkuLogZmFsc2UsIOW9k+iuvue9ruS4uiB0cnVlIOaXtu+8mlxyXG4gICAgICpcclxuICAgICAqIDEu54K55Ye75paH5pys77yM5aSN6YCJ5qGG54q25oCB5LiN5Lya5pS55Y+Y77yM5Y+q5Lya6Kem5Y+Rc2VsZWN05LqL5Lu277ybXHJcbiAgICAgKlxyXG4gICAgICogMi7ngrnlh7vlpI3pgInmoYblj6rkvJrop6blj5FjaGFuZ2Xkuovku7bvvJtcclxuICAgICAqXHJcbiAgICAgKiAzLuWkjemAieahhmRpc2FibGVk5pe277yM54K55Ye75paH5pys5Lya6Kem5Y+Rc2VsZWN05LqL5Lu244CCXHJcbiAgICAgKlxyXG4gICAgICogVGlueTMuMS4xLWFscGhh5paw5aKe44CCXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNoYW5nZWRCeUNoZWNrYm94OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuMiDmlrDlop5cclxuICAgICAqIOaQnOe0ouS8oOWFpeeahOWAvCzlr7nljLnphY3nmoTmlofmnKzpq5jkuq7mmL7npLpcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaGlnaGxpZ2h0V29yZHM6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICogMTAuMS40IOaWsOWinlxyXG4gICAgICog5pSv5oyB5ouW5pS+XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIG5vZGVEcmFnZ2FibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog5qCR6IqC54K55bGV5byA5YmN55qE5LqL5Lu25Zue6LCD77yM5LiA6Iis55So5LqO5byC5q2l5pWw5o2u6I635Y+WXHJcbiAgICAgKi9cclxuICAgIEBPdXRwdXQoKSByZWFkb25seSBiZWZvcmVFeHBhbmQ6IEV2ZW50RW1pdHRlcjxUaVRyZWVDb21wb25lbnQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxUaVRyZWVDb21wb25lbnQ+KCk7XHJcbiAgICAvKipcclxuICAgICAqIOW9k+eUqOaIt+eCueWHu+afkOS4gOiKgueCueaXtuinpuWPkeeahOS6i+S7tlxyXG4gICAgICovXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW5hbWVkLWFmdGVyLXN0YW5kYXJkLWV2ZW50XHJcbiAgICBAT3V0cHV0KCkgcmVhZG9ubHkgc2VsZWN0OiBFdmVudEVtaXR0ZXI8VGlUcmVlTm9kZT4gPSBuZXcgRXZlbnRFbWl0dGVyPFRpVHJlZU5vZGU+KCk7XHJcbiAgICAvKipcclxuICAgICAqIOW9k+WJjemAieS4remhueWPkeeUn+WPmOWMluaXtu+8jOinpuWPkWNoYW5nZeS6i+S7tlxyXG4gICAgICovXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW5hbWVkLWFmdGVyLXN0YW5kYXJkLWV2ZW50XHJcbiAgICBAT3V0cHV0KCkgcmVhZG9ubHkgY2hhbmdlOiBFdmVudEVtaXR0ZXI8VGlUcmVlTm9kZT4gPSBuZXcgRXZlbnRFbWl0dGVyPFRpVHJlZU5vZGU+KCk7XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuNCDmlrDlop5cclxuICAgICAqIGRyb3AgZXZlbnRcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpIHJlYWRvbmx5IG5vZGVEcm9wOiBFdmVudEVtaXR0ZXI8VGlUcmVlRHJhZ05vZGU+ID0gbmV3IEV2ZW50RW1pdHRlcjxUaVRyZWVEcmFnTm9kZT4oKTtcclxuICAgIC8qKlxyXG4gICAgICogMTAuMS40IOaWsOWinlxyXG4gICAgICog5oKs5rWu5aKe5Yqg6IqC54K55oyJ6ZKu5Zue6LCDXHJcbiAgICAgKi9cclxuICAgIEBPdXRwdXQoKSByZWFkb25seSBub2RlQWRkZWQ6IEV2ZW50RW1pdHRlcjxUaVRyZWVOb2RlPiA9IG5ldyBFdmVudEVtaXR0ZXI8VGlUcmVlTm9kZT4oKTtcclxuICAgIC8qKlxyXG4gICAgICogMTAuMS40IOaWsOWinlxyXG4gICAgICog5oKs5rWu57yW6L6R6IqC54K55oyJ6ZKu5Zue6LCDXHJcbiAgICAgKi9cclxuICAgIEBPdXRwdXQoKSByZWFkb25seSBub2RlRWRpdGVkOiBFdmVudEVtaXR0ZXI8VGlUcmVlTm9kZT4gPSBuZXcgRXZlbnRFbWl0dGVyPFRpVHJlZU5vZGU+KCk7XHJcbiAgICAvKipcclxuICAgICAqIDEwLjEuNCDmlrDlop5cclxuICAgICAqIOaCrOa1ruWIoOmZpOiKgueCueaMiemSruWbnuiwg1xyXG4gICAgICovXHJcbiAgICBAT3V0cHV0KCkgcmVhZG9ubHkgbm9kZURlbGV0ZWQ6IEV2ZW50RW1pdHRlcjxUaVRyZWVOb2RlPiA9IG5ldyBFdmVudEVtaXR0ZXI8VGlUcmVlTm9kZT4oKTtcclxuICAgIC8qKlxyXG4gICAgICog55So5LqO5byC5q2l5Zy65pmv77ya5b2T5YmN54K55Ye76ZyA6KaB5bGV5byA55qE54i26IqC54K5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYmVmb3JlRXhwYW5kTm9kZTogVGlUcmVlTm9kZTtcclxuICAgIC8qKlxyXG4gICAgICog55uR5ZCsZGF0YeaUueWPmFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGRhdGFEaWZmZXI6IEl0ZXJhYmxlRGlmZmVyPGFueT47XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOiOt+WPluWIsOeUqOaIt+iHquWumuS5ieeahOaooeadv1xyXG4gICAgICovXHJcbiAgICBAQ29udGVudENoaWxkKFRlbXBsYXRlUmVmLCAvKiBUT0RPOiBhZGQgc3RhdGljIGZsYWcgKi8geyBzdGF0aWM6IHRydWUgfSkgaXRlbVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDojrflj5bmlofmnKzljLrln59kb23pm4blkIhcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZHJlbignbm9kZUxpc3QnKSBlbGVtczogUXVlcnlMaXN0PEVsZW1lbnRSZWY+O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDmqKHmnb/kuK3kvb/nlKjvvIzpq5jkuq7nmoTpgInkuK3poblcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFjdGl2ZWQ6IFRpVHJlZU5vZGU7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOivjeadoVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdHJlZUxhbiA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudGlUcmVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDooqvmi5bmi73oioLngrlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkcmFnTm9kZTogVGlUcmVlTm9kZTtcclxuICAgIC8qKlxyXG4gICAgICog5ouW5ou9cG9zaXRpb25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkcm9wUG9zaXRpb246IG51bWJlcjtcclxuICAgIC8qKlxyXG4gICAgICog5ouW5pS+57uP6L+H55qE6IqC54K5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb3Zlck5vZGU6IFRpVHJlZU5vZGU7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgZWxlbWVudFJlZjogRWxlbWVudFJlZixcclxuICAgICAgICAgICAgICAgIHByb3RlY3RlZCByZW5kZXJlcjI6IFJlbmRlcmVyMixcclxuICAgICAgICAgICAgICAgIHByb3RlY3RlZCBpdGVyYWJsZURpZmZlcnM6IEl0ZXJhYmxlRGlmZmVycyxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgdGlSZW5kZXJlcjogVGlSZW5kZXJlcixcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgY2RSZWY6IENoYW5nZURldGVjdG9yUmVmKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcihlbGVtZW50UmVmLCByZW5kZXJlcjIpO1xyXG4gICAgfVxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIubmdPbkluaXQoKTtcclxuICAgICAgICB0aGlzLmRhdGFEaWZmZXIgPSB0aGlzLml0ZXJhYmxlRGlmZmVycy5maW5kKHRoaXMuZGF0YSlcclxuICAgICAgICAgICAgICAgIC5jcmVhdGUoKTtcclxuICAgICAgICAvLyDlhoXpg6jkvb/nlKjnmoTmlbDmja7vvIznlKjkuo7orrDlvZXnlKjmiLfnmoTmk43kvZzmlLnlj5hcclxuICAgICAgICAvLyBUT0RPOiDku4XlnKjliJ3lp4vljJbml7bmjKHpnZ7ms5XmlbDmja7vvIzmmK/kuI3lpJ/nmoTjgILlu7rorq7ljrvpmaTjgILkvYblm6DkuLropoHlhbzlrrnlt7Llj5Hlh7rnmoTniYjmnKzvvIzmiYDku6XkuI3ljrvpmaTjgIJcclxuICAgICAgICB0aGlzLmRhdGEgPSAhVXRpbC5pc0FycmF5KHRoaXMuZGF0YSkgPyBbXSA6IHRoaXMuZGF0YTtcclxuICAgICAgICAvLyDliJ3lp4vljJbpu5jorqTpgInkuK3pobnpq5jkuq5cclxuICAgICAgICB0aGlzLmFjdGl2ZWQgPSB0aGlzLmluaXRBY3RpdmVkKHRoaXMuZGF0YSk7XHJcbiAgICB9XHJcbiAgICBuZ0RvQ2hlY2soKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIubmdEb0NoZWNrKCk7XHJcbiAgICAgICAgY29uc3QgZGF0YUNoYW5nZXM6IEl0ZXJhYmxlQ2hhbmdlczxUaVRyZWVOb2RlPiA9IHRoaXMuZGF0YURpZmZlci5kaWZmKHRoaXMuZGF0YSk7XHJcbiAgICAgICAgaWYgKGRhdGFDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIC8vIOmHjeaWsOWIneWni+WMlum7mOiupOmAieS4remhuemrmOS6rlxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZWQgPSB0aGlzLmluaXRBY3RpdmVkKHRoaXMuZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g5Yik5pat5piv5ZCm5pi+56S65aSN6YCJ5qGGXHJcbiAgICAgKiBAcGFyYW0gbm9kZSDoioLngrnmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHNob3dDaGVja2JveEZuKG5vZGU6IFRpVHJlZU5vZGUpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZSAhPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5wYXJlbnRDaGVja2FibGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gVGlUcmVlVXRpbC5pc0xlYWYobm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g54K55Ye754i26IqC54K55Zu+5qCH5omn6KGM55qE6YC76L6RXHJcbiAgICAgKiBAcGFyYW0gIG5vZGUg5b2T5YmN6IqC54K55pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkNsaWNrUG5vZGVJY29uKG5vZGU6IFRpVHJlZU5vZGUsIGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKG5vZGUuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDpmLvmraLkuovku7blhpLms6HvvJrngrnlh7vniLboioLngrnlm77moIfml6Dpq5jkuq7moLflvI9cclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLmJlZm9yZUV4cGFuZE5vZGUgPSBub2RlO1xyXG4gICAgICAgIC8vIDEu5b2T5YmN6IqC54K55piv5bGV5byA54q25oCBXHJcbiAgICAgICAgaWYgKG5vZGUuZXhwYW5kZWQpIHtcclxuICAgICAgICAgICAgbm9kZS5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5iZWZvcmVFeHBhbmQub2JzZXJ2ZXJzLmxlbmd0aCA9PT0gMCkgeyAgLy8gMi7lpoLmnpzmnKrlrprkuYliZWZvcmVFeHBhbmTkuovku7Yo6Z2e5byC5q2lKe+8jOeCueWHu+aXtuiuqeiKgueCueWxleW8gFxyXG4gICAgICAgICAgICBub2RlLmV4cGFuZGVkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgeyAvLyAzLuW8guatpeiOt+WPluaVsOaNru+8muWwhue7hOS7tuWunuS+i+mAmuefpeWHuuWOu1xyXG4gICAgICAgICAgICB0aGlzLmJlZm9yZUV4cGFuZC5lbWl0KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDojrflj5blvILmraXngrnlh7vnmoToioLngrlcclxuICAgIHB1YmxpYyBnZXRCZWZvcmVFeHBhbmROb2RlKCk6IFRpVHJlZU5vZGUge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJlZm9yZUV4cGFuZE5vZGU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g5qC55o2uaXRlbeeahGlzRXhwYW5kZWTlsZ7mgKfojrflj5ZpdGVt5Zu+5qCHXHJcbiAgICAgKiBAcGFyYW0gbm9kZSDlvZPliY3oioLngrnmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEl0ZW1JY29uKG5vZGU6IFRpVHJlZU5vZGUpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmIChUaVRyZWVVdGlsLmlzTGVhZihub2RlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7bm9kZS5leHBhbmRJY29ufSB0aTMtdHJlZS1ub2RlLWljb25gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGAkeyhub2RlLmV4cGFuZGVkKSA/IG5vZGUuZXhwYW5kSWNvbiA6IG5vZGUuY29sbGFwc2VJY29ufSB0aTMtdHJlZS1ub2RlLWljb25gO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQGRlc2NyaXB0aW9uIOeCueWHu+WkjemAieahhuinpuWPkXNlbGVjdOOAgWNoYW5nZeS6i+S7tlxyXG4gICAgICog6ZyA6KaB5rOo5oSP77yaY2xpY2vkuovku7bkuK3mi7/liLDnmoTmmK/mk43kvZzliY3nmoTpgInkuK3nirbmgIHvvIzogIxjaGFuZ2Xkuovku7bkuK3mi7/liLDnmoTmmK/mk43kvZzlkI7nmoTpgInkuK3nirbmgIFcclxuICAgICAqIEBwYXJhbSBub2RlIOW9k+WJjeiKgueCueaVsOaNrlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb25JbnB1dENoYW5nZShub2RlOiBUaVRyZWVOb2RlLCBldmVudDogRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBpZiAobm9kZS5kaXNhYmxlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOeCueWHu+W9k+WJjemhuemrmOS6rlxyXG4gICAgICAgIHRoaXMuYWN0aXZlZCA9IG5vZGU7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxldGVkU3RhdGUobm9kZSwgdGhpcy5kYXRhLCBub2RlLmNoZWNrZWQpO1xyXG4gICAgICAgIGlmICghdGhpcy5jaGFuZ2VkQnlDaGVja2JveCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdC5lbWl0KG5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYW5nZS5lbWl0KG5vZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog54K55Ye75paH5pys5Yy65Z+fXHJcbiAgICAgKiBAcGFyYW0gbm9kZSDlvZPliY3oioLngrnmlbDmja5cclxuICAgICAqIEBwYXJhbSBldmVudCDpvKDmoIfkuovku7ZcclxuICAgICAqIEByZXR1cm5zIHZvaWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uSXRlbVdyYXBwZXJDbGljayhub2RlOiBUaVRyZWVOb2RlKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKG5vZGUuZGlzYWJsZWQgPT09IHRydWUgfHwgbm9kZS5lZGl0aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5oKs5rWu5Yqf6IO9OiDngrnlh7vnlJ/miJDoioLngrnml7bvvIzmmL7npLrmk43kvZzmjInpkq5cclxuICAgICAgICBpZiAoIW5vZGUuZWRpdGluZykge1xyXG4gICAgICAgICAgICBub2RlLmlzSG92ZXIgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDngrnlh7vlvZPliY3pobnpq5jkuq5cclxuICAgICAgICB0aGlzLmFjdGl2ZWQgPSBub2RlO1xyXG4gICAgICAgIC8vIDEu5aSE55CG5aSa6YCJ5oOF5Ya1XHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2hhbmdlZEJ5Q2hlY2tib3gpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAxLjEg5aSE55CG54i26IqC54K55LiN5pSv5oyB5aSa6YCJXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zaG93Q2hlY2tib3hGbihub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAxLjIg5aSE55CG54i26IqC54K55pSv5oyB5aSa6YCJXHJcbiAgICAgICAgICAgIG5vZGUuY2hlY2tlZCA9ICFub2RlLmNoZWNrZWQ7XHJcbiAgICAgICAgICAgIC8vIOWkhOeQhuW9k+WJjeiKgueCuemAieS4reeKtuaAgeWPmOWMluWQju+8jOWvueeItuWtkOiKgueCueeahOW9seWTjVxyXG4gICAgICAgICAgICB0aGlzLnNldFNlbGV0ZWRTdGF0ZShub2RlLCB0aGlzLmRhdGEsIG5vZGUuY2hlY2tlZCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQobm9kZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlLmVtaXQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAyLuWkhOeQhuWNlemAieWcuuaZr1xyXG4gICAgICAgIC8vIDIuMSjljZXpgInkuJTlt7LpgInkuK0p5oiW6ICFKOWNlemAieS4lOmdnuWPtuWtkOiKgueCuSnnmoTmg4XlhrXkuIvvvIzngrnlh7vlj6rkvJrop6blj5FzZWxlY3Tkuovku7Ys5Zug5Li65b2T5YmN6YCJ5Lit6aG55LiN5Lya5Y+R55Sf5Y+Y5YyWXHJcbiAgICAgICAgaWYgKG5vZGUuY2hlY2tlZCA9PT0gdHJ1ZSB8fCAhVGlUcmVlVXRpbC5pc0xlYWYobm9kZSkpIHtcclxuICAgICAgICAgICAgLy8g6Kem5Y+Rc2VsZWN05LqL5Lu2XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAyLjLljZXpgInlj7blrZDoioLngrnmnKrpgInkuK1cclxuICAgICAgICB0aGlzLmRlU2VsZWN0QWxsTm9kZSh0aGlzLmRhdGEpO1xyXG4gICAgICAgIG5vZGUuY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgVGlUcmVlVXRpbC5zZWxlY3RQYXJlbnRzKG5vZGUsIHRoaXMuZGF0YSwgJ2luZGV0ZXJtaW5hdGUnKTsgLy8g6K6+572u56WW5YWI6IqC54K555qE6YCJ5Lit54q25oCBXHJcblxyXG4gICAgICAgIC8vIOinpuWPkXNlbGVjdOWSjGNoYW5nZeS6i+S7tlxyXG4gICAgICAgIHRoaXMuc2VsZWN0LmVtaXQobm9kZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hhbmdlLmVtaXQobm9kZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIOWkhOeQhuW9k+WJjeiKgueCuemAieS4reeKtuaAgeWPmOWMluWQju+8jOWvueeItuWtkOiKgueCueeahOW9seWTjVxyXG4gICAgcHJpdmF0ZSBzZXRTZWxldGVkU3RhdGUgPSAobm9kZTogVGlUcmVlTm9kZSwgYWxsRGF0YTogQXJyYXk8VGlUcmVlTm9kZT4sIGNoZWNrZWQ6IGJvb2xlYW4gfCBzdHJpbmcpOiB2b2lkID0+IHtcclxuICAgICAgICBpZiAoY2hlY2tlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBUaVRyZWVVdGlsLnNlbGVjdEFsbENoaWxkcmVuKG5vZGUpO1xyXG4gICAgICAgICAgICBUaVRyZWVVdGlsLnNlbGVjdFBhcmVudHMobm9kZSwgYWxsRGF0YSwgdHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgVGlUcmVlVXRpbC5kZVNlbGVjdEFsbENoaWxkcmVuKG5vZGUpO1xyXG4gICAgICAgICAgICBUaVRyZWVVdGlsLmRlU2VsZWN0UGFyZW50cyhub2RlLCBhbGxEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDljZXpgInml7bvvIzlj5bmtojmiYDmnInoioLngrnnmoTpgInkuK3nirbmgIFcclxuICAgICAqIEBwYXJhbSAgYWxsRGF0YSDmiYDmnInoioLngrnmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkZVNlbGVjdEFsbE5vZGUgPSAoYWxsRGF0YTogQXJyYXk8VGlUcmVlTm9kZT4pOiB2b2lkID0+IHtcclxuICAgICAgICBhbGxEYXRhLmZvckVhY2goKG5vZGU6IFRpVHJlZU5vZGUpID0+IHtcclxuICAgICAgICAgICAgVGlUcmVlVXRpbC5kZVNlbGVjdEFsbENoaWxkcmVuKG5vZGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdHJhY2tCeUZuKGluZGV4OiBudW1iZXIsIG5vZGU6IGFueSk6IGFueSB7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDliKTmlq3mmK/lkKbkuLrlj7blrZDoioLngrlcclxuICAgICAqL1xyXG4gICAgcHVibGljIGlzTGVhZihub2RlOiBUaVRyZWVOb2RlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICEoVXRpbC5pc0FycmF5KG5vZGUuY2hpbGRyZW4pKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliJ3lp4vljJbpgInkuK3pobnpq5jkuq5cclxuICAgIHByaXZhdGUgaW5pdEFjdGl2ZWQgPSAoZGF0YTogQXJyYXk8VGlUcmVlTm9kZT4pOiBhbnkgPT4ge1xyXG4gICAgICAgIGxldCByZXN1bHQ6IFRpVHJlZU5vZGU7XHJcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUuY2hlY2tlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghVGlUcmVlVXRpbC5pc0xlYWYobm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW5pdEFjdGl2ZWQobm9kZS5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghVXRpbC5pc1VuZGVmaW5lZChyZXN1bHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gbm9kZSDoioLngrnmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uQmx1cihub2RlOiBUaVRyZWVOb2RlKSB7XHJcbiAgICAgICAgaWYgKG5vZGUuZm9jdXNlZCkge1xyXG4gICAgICAgICAgICBub2RlLmZvY3VzZWQgPSBmYWxzZTsgLy8g5aSx54Sm5ZCO6IqC54K55Yig6Zmk6I6354Sm5qCH5b+X57G7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gbm9kZSDoioLngrnmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uRm9jdXMobm9kZTogVGlUcmVlTm9kZSkge1xyXG4gICAgICAgIGlmICghbm9kZS5mb2N1c2VkICYmICFub2RlLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIG5vZGUuZm9jdXNlZCA9IHRydWU7IC8vIOiuvue9ruiOt+eEpuagh+W/l+exu1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQHBhcmFtIGV2ZW50IOmUruebmOS6i+S7tlxyXG4gICAgICogQHBhcmFtIG5vZGUg5b2T5YmN6IqC54K55pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQsIG5vZGU6IFRpVHJlZU5vZGUpOiB2b2lkIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlv6vmjbfplK7kuqTkupLlrprkuYlcclxuICAgICAgICAgKiAxLHRhYumUruWIh+aNoueEpueCueiHs+agkee7hOS7tueahOaWh+acrOWMuuWfn++8jOWkjemAieahhuaXoOmcgOaPkOS+m+eEpueCue+8jOaWh+acrOagt+W8j+S4uuaWh+acrOaCrOa1ruaAgVxyXG4gICAgICAgICAqIDIs5qCR57uE5Lu25YaF6YOo54Sm54K55YiH5o2i5pSv5oyB5LiK5LiL5bem5Y+z6ZSu77yaXHJcbiAgICAgICAgICogICAgLeS4iuS4i+mUru+8muaMieS4iuS4i+mUruWPr+S7peWcqOW5tuWIl+eahOiKgueCueenu+WKqO+8jOWmguaXoOW5tuWIl+iKgueCueaXoOazleenu+WKqOOAglxyXG4gICAgICAgICAqICAgIC3lt6blj7PplK7vvJrlsZXlvIDmlLbotbfoioLngrnlj4rot6jlsYLnuqfnp7vliqjnhKbngrnjgILlvZPnhKbngrnlho3lrZDoioLngrnml7bvvIzmjInlt6bplK7lj6/mlLbotbfmlLnoioLngrnvvIznhKbngrnnp7vliqjoh7PniLboioLngrnvvJtcclxuICAgICAgICAgKiAgICAg5b2T54Sm54K55Zyo54i26IqC54K55LiK5pe277yM5oyJ5Y+z6ZSu5Y+v5bCG54Sm54K556e75Yqo5Yiw5ZCv5a2Q6IqC54K55LiKLOWmguiKgueCueacquWxleW8gOWImeWQjOaXtuWxleW8gOivpeWtkOiKgueCuVxyXG4gICAgICAgICAqIDMsRW50ZXLplK7miJZTcGFjZemUru+8muW9k+eEpueCueWcqOiKgueCueWQjeensOS4iuaXtu+8jOaMieS4i+mUruWImemAieS4reaIluWPlua2iOivpeiKgueCue+8jOmAieS4reWQjuiKgueCueWPmOS4uumAieS4reaAgVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC8vIOmYu+atoum7mOiupOWSjOWGkuazoVxyXG4gICAgICAgIGlmKFxyXG4gICAgICAgICAgICBbVGlLZXltYXAuS0VZX0VOVEVSLCBUaUtleW1hcC5LRVlfTlVNUEFEX0VOVEVSLCBUaUtleW1hcC5LRVlfU1BBQ0UsIFRpS2V5bWFwLktFWV9BUlJPV19VUCwgVGlLZXltYXAuS0VZX0FSUk9XX0RPV04sXHJcbiAgICAgICAgICAgIFRpS2V5bWFwLktFWV9BUlJPV19MRUZULCBUaUtleW1hcC5LRVlfQVJST1dfUklHSFRdLmluZGV4T2YoZXZlbnQua2V5Q29kZSkgPiAtMVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX0VOVEVSOiAvLyBFTlRFUumUrlxyXG4gICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9OVU1QQURfRU5URVI6IC8vIEVOVEVS6ZSuKOiLueaenOaVsOWtl+Wwj+mUruebmClcclxuICAgICAgICAgICAgY2FzZSBUaUtleW1hcC5LRVlfU1BBQ0U6XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uSXRlbVdyYXBwZXJDbGljayhub2RlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9BUlJPV19VUDogLy8g5ZCR5LiK566t5aS077yM5ZCM57qnXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEtleURvd25VcChub2RlLCAndXAnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRpS2V5bWFwLktFWV9BUlJPV19ET1dOOiAvLyDlkJHkuIvnrq3lpLTvvIzlkIznuqdcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEtleURvd25VcChub2RlLCAnZG93bicpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX0FSUk9XX0xFRlQ6IC8vIOWQkeW3pueureWktO+8jOi3qOiKgueCueWxgue6p1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRLZXlsZWZ0KG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgVGlLZXltYXAuS0VZX0FSUk9XX1JJR0hUOiAvLyDlkJHlj7Pnrq3lpLTvvIzot6joioLngrnlsYLnuqdcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0S2V5cmlnaHQobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDkuIrkuIvplK5cclxuICAgIHByaXZhdGUgc2V0S2V5RG93blVwKG5vZGU6IFRpVHJlZU5vZGUsIHR5cGU6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBwYXJBcnI6IEFycmF5PFRpVHJlZU5vZGU+O1xyXG4gICAgICAgIGNvbnN0IHBhcmVOb2RlOiBUaVRyZWVOb2RlID0gVGlUcmVlVXRpbC5nZXRQYXJlbnROb2RlKHRoaXMuZGF0YSwgbm9kZSk7IC8vIOiOt+WPlueItuiKgueCuVxyXG4gICAgICAgIGlmIChwYXJlTm9kZSkge1xyXG4gICAgICAgICAgICBwYXJBcnIgPSBwYXJlTm9kZS5jaGlsZHJlbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJBcnIgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGN1ckluZGV4OiBudW1iZXIgPSBwYXJBcnIuZmluZEluZGV4KChpdGVtOiBUaVRyZWVOb2RlKSA9PiBpdGVtID09PSBub2RlKTsgLy8g6I635Y+W5b2T5YmN6IqC54K55Zyo5YW254i26IqC54K56ZuG5ZCI55qEaW5kZXhcclxuICAgICAgICB0aGlzLnNldEZvY3VzTm9kZShub2RlLCBwYXJBcnIsIGN1ckluZGV4LCB0eXBlKTtcclxuICAgIH1cclxuICAgIC8vIOW3pumUrlxyXG4gICAgcHJpdmF0ZSBzZXRLZXlsZWZ0KG5vZGU6IFRpVHJlZU5vZGUpIHtcclxuICAgICAgICAvLyDlvZPmraPlnKjnvJbovpHml7bvvIzlhbPpl63lhbbniLboioLngrnml7bvvIzoioLngrnmgaLlpI3mlofmnKznirbmgIFcclxuICAgICAgICBpZiAobm9kZS5lZGl0aW5nICYmIG5vZGUubGFiZWwgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBub2RlLmVkaXRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmVOb2RlOiBUaVRyZWVOb2RlID0gVGlUcmVlVXRpbC5nZXRQYXJlbnROb2RlKHRoaXMuZGF0YSwgbm9kZSk7XHJcbiAgICAgICAgaWYgKCFwYXJlTm9kZSkgeyAvLyDlvZPliY3oioLngrnml7bkuIDnuqfoioLngrnml7YgcmV0dXJuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyZU5vZGUuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAocGFyZU5vZGUuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRLZXlsZWZ0KHBhcmVOb2RlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJlTm9kZS5mb2N1c2VkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNldEZvY3VzRWxlbShub2RlKTtcclxuICAgIH1cclxuICAgIC8vIOWPs+mUrlxyXG4gICAgcHJpdmF0ZSBzZXRLZXlyaWdodChub2RlOiBUaVRyZWVOb2RlKSB7XHJcbiAgICAgICAgaWYgKFRpVHJlZVV0aWwuaXNMZWFmKG5vZGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY2hpbGROb2RlQXJyOiBBcnJheTxUaVRyZWVOb2RlPiA9IG5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgY2hpbGRub0Rpc2FibGVkQXJyOiAgQXJyYXk8VGlUcmVlTm9kZT4gPSBjaGlsZE5vZGVBcnIuZmlsdGVyKChjaGlsZE5vZGU6IFRpVHJlZU5vZGUpID0+ICFjaGlsZE5vZGUuZGlzYWJsZWQpOyAvLyDojrflj5blrZDoioLngrnmnKrnpoHnlKjnmoToioLngrnpm4blkIhcclxuICAgICAgICBpZiAoY2hpbGRub0Rpc2FibGVkQXJyLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjaGlsZEZpcnN0Tm9kZTogVGlUcmVlTm9kZSA9IGNoaWxkbm9EaXNhYmxlZEFyclswXTsgLy8g5pyq56aB55So55qE6IqC54K56ZuG5ZCI55qEZmlyc3Tojrflj5bnhKbngrlcclxuICAgICAgICBjaGlsZEZpcnN0Tm9kZS5mb2N1c2VkID0gdHJ1ZTtcclxuICAgICAgICBpZiAoIW5vZGUuZXhwYW5kZWQpIHtcclxuICAgICAgICAgICAgbm9kZS5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0Rm9jdXNFbGVtKG5vZGUpO1xyXG4gICAgfVxyXG4gICAgLy8g5LiK5LiL6ZSu54Sm54K55aSE55CGXHJcbiAgICBwcml2YXRlIHNldEZvY3VzTm9kZShub2RlOiBUaVRyZWVOb2RlLCBwYXJMaXN0OiBBcnJheTxUaVRyZWVOb2RlPiwgY3VySW5kZXg6IG51bWJlciwgdHlwZTogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IHRhcmdldE5vZGU6IFRpVHJlZU5vZGU7XHJcbiAgICAgICAgbGV0IHRhcmdldEluZGV4OiBudW1iZXI7XHJcbiAgICAgICAgbGV0IF9jdXJJbmRleCA9IGN1ckluZGV4O1xyXG4gICAgICAgIGlmICh0eXBlID09PSAndXAnKSB7IC8vIOWQjOe6p+iOt+WPluS4iuS4gOS4quiKgueCuVxyXG4gICAgICAgICAgICB0YXJnZXRJbmRleCA9IF9jdXJJbmRleCAtIDE7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRJbmRleCA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldEluZGV4ID0gcGFyTGlzdC5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhcmdldE5vZGUgPSBwYXJMaXN0W3RhcmdldEluZGV4XTtcclxuICAgICAgICB9IGVsc2UgeyAvLyDlkIznuqfojrflj5bkuIvkuIDkuKroioLngrlcclxuICAgICAgICAgICAgdGFyZ2V0SW5kZXggPSBfY3VySW5kZXggKyAxO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0SW5kZXggPiAocGFyTGlzdC5sZW5ndGggLSAxKSkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0SW5kZXggPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhcmdldE5vZGUgPSBwYXJMaXN0W3RhcmdldEluZGV4XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5LiK5LiL56e75Yqo5pe277yMZmlyc3TmiJZsYXN06IqC54K556aB55So5pe2LHJldHVyblxyXG4gICAgICAgIGlmICgodGFyZ2V0Tm9kZSA9PT0gcGFyTGlzdFswXSB8fCB0YXJnZXROb2RlID09PSBwYXJMaXN0W3Bhckxpc3QubGVuZ3RoIC0gMV0pICYmIHRhcmdldE5vZGUuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlvZPkuK3pl7ToioLngrnmnInnpoHnlKjml7bvvIznp7vliqjliLDnpoHnlKjnmoToioLngrnkuIrkuIDkuKrmiJbkuIvkuIDkuKroioLngrlcclxuICAgICAgICBpZiAodGFyZ2V0Tm9kZS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICBfY3VySW5kZXggPSB0YXJnZXRJbmRleDtcclxuICAgICAgICAgICAgdGhpcy5zZXRGb2N1c05vZGUobm9kZSwgcGFyTGlzdCwgX2N1ckluZGV4LCB0eXBlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0YXJnZXROb2RlLmZvY3VzZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2V0Rm9jdXNFbGVtKG5vZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOebruagh+WFg+e0oOiOt+WPlueEpueCuVxyXG4gICAgcHJpdmF0ZSBzZXRGb2N1c0VsZW0obm9kZTogVGlUcmVlTm9kZSl7XHJcbiAgICAgICAgaWYgKG5vZGUuZm9jdXNlZCkge1xyXG4gICAgICAgICAgICBub2RlLmZvY3VzZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5b2T5oyJ6ZSu5pON5L2c5Lya5pS55Y+Y5paH5pys5YWD57Sg5piv5ZCm5re75YqgY2xhc3NgdGkzLXRyZWUtdGV4dC1mb2N1c2AsIOWKoOW7tuaXtuaYr+S4uuS6hmNsYXNz5Y+Y5pu05ZCO77yM6I635Y+W5q2j56Gu55qE5ZCr5pyJY2xhc3PnmoTmlofmnKzljLrln5/lhYPntKBcclxuICAgICAgICAvLyDnsbt0aTMtdHJlZS10ZXh0LWZvY3Vz5L2c5Li66I6354Sm5YWD57Sg55qE5qCH5b+XXHJcbiAgICAgICAgc2V0VGltZW91dCgoKT0+IHtcclxuICAgICAgICAgICAgLy8g5om+5Yiw5ZCr5pyJ57G7dGkzLXRyZWUtdGV4dC1mb2N1c+eahOaWh+acrOWFg+e0oFxyXG4gICAgICAgICAgICBjb25zdCBmb2N1c05vZGUgPSB0aGlzLmVsZW1zLnRvQXJyYXkoKS5maW5kKChlbGVtKSA9PiB0aGlzLnRpUmVuZGVyZXIuaGFzQ2xhc3MoZWxlbS5uYXRpdmVFbGVtZW50LCAndGkzLXRyZWUtdGV4dC1mb2N1cycpKTtcclxuICAgICAgICAgICAgaWYgKGZvY3VzTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgZm9jdXNOb2RlLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDApXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gc3RhcnRFdmVudCDpvKDmoIfkuovku7ZcclxuICAgICAqIEBwYXJhbSBub2RlIOW9k+WJjeiKgueCueaVsOaNrlxyXG4gICAgICogQGRlc2NyaXB0aW9uIOaLluaLveW8gOWni+aXtuWcqOiiq+aLluaLveWFg+e0oOS4iuinpuWPkeatpOS6i+S7tlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb25EcmFnc3RhcnQoZXZlbnQ6IERyYWdFdmVudCwgbm9kZTogVGlUcmVlTm9kZSkge1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHRoaXMuZHJhZ05vZGUgPSBub2RlOyAvLyDkv53lrZjooqvmi5bmi73nmoToioLngrlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBlbnRlckV2ZW50IOm8oOagh+S6i+S7tlxyXG4gICAgICogQHBhcmFtIG5vZGUg5b2T5YmN6IqC54K55pWw5o2uXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g5ouW5ou96byg5qCH6L+b5YWl5YWD57Sg5pe25Zyo6K+l5YWD57Sg5LiK6Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyYWdlbnRlcihldmVudDogRHJhZ0V2ZW50LCBub2RlOiBUaVRyZWVOb2RlKSB7XHJcblxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5vdmVyTm9kZSA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIOaLluaLveiKgueCueWSjOebruagh+iKgueCueaYr+WQjOS4gOiKgueCuSxyZXR1ZW5cclxuICAgICAgICBpZiAobm9kZSA9PT0gdGhpcy5kcmFnTm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDkv53lrZjnp7vliqjliLDnmoToioLngrlcclxuICAgICAgICB0aGlzLm92ZXJOb2RlID0gbm9kZTtcclxuXHJcbiAgICAgICAgLy8g5ouW5ou955qE6IqC54K55ouW5ou95Yiw5YW25a2Q6IqC54K55pe277yM5YWz6Zet5YW26IqC54K5XHJcbiAgICAgICAgaWYgKHRoaXMuZHJhZ05vZGUgPT09IFRpVHJlZVV0aWwuZ2V0UGFyZW50Tm9kZSh0aGlzLmRhdGEsIG5vZGUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ05vZGUuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gb3ZlckV2ZW50IOm8oOagh+S6i+S7tlxyXG4gICAgICogQHBhcmFtIG5vZGUg5b2T5YmN6IqC54K55pWw5o2uXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g5ouW5ou95pe26byg5qCH5Zyo55uu5qCH5YWD57Sg5LiK56e75Yqo5pe26Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyYWdvdmVyKGV2ZW50OiBEcmFnRXZlbnQsIG5vZGU6IFRpVHJlZU5vZGUpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XHJcbiAgICAgICAgaWYgKG5vZGUgPT09IHRoaXMub3Zlck5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckRyYWdDbGFzcyhldmVudCk7IC8vIOa4hemZpOiKgueCueS5i+WJjeeahOagt+W8j1xyXG4gICAgICAgICAgICB0aGlzLmRyb3BQb3NpdGlvbiA9IHRoaXMuY2FsY0Ryb3BQb3NpdGlvbihldmVudCk7IC8vIOiOt+WPluenu+WKqOWIsOiKgueCueeahOS9jee9rlxyXG4gICAgICAgICAgICAvLyDmi5bmi73nu4/ov4foioLngrks5pS+572u5YaF6YOo5L2N572u5pe277yM5LiU6K+l6IqC54K55pyq5bGV5byA5pe277yM5bGV5byA5YW26IqC54K5XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRyb3BQb3NpdGlvbiA9PT0gMCAmJiAhbm9kZS5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6K6+572u5ouW5Yqo6L+H56iL5Lit55qE54q25oCB5qC35byPXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIyLmFkZENsYXNzKGV2ZW50LmN1cnJlbnRUYXJnZXQsIHRoaXMuc2V0RHJhZ092ZXJDbGFzcyhub2RlKSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBsZWF2ZUV2ZW50IOm8oOagh+S6i+S7tlxyXG4gICAgICogQHBhcmFtIG5vZGUg5b2T5YmN6IqC54K55pWw5o2uXHJcbiAgICAgKiBAZGVzY3JpcHRpb24g5ouW5ou95pe26byg5qCH5Zyo56a75byA55uu5qCH5YWD57Sg5pe26Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyYWdsZWF2ZShldmVudDogRHJhZ0V2ZW50LCBub2RlOiBUaVRyZWVOb2RlKSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLmNsZWFyRHJhZ0NsYXNzKGV2ZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBkcm9wRXZlbnQg6byg5qCH5LqL5Lu2XHJcbiAgICAgKiBAcGFyYW0gbm9kZSDlvZPliY3oioLngrnmlbDmja5cclxuICAgICAqIEBkZXNjcmlwdGlvbiDpvKDmoIflnKjmi5bmlL7nm67moIfkuIrph4rmlL7ml7Ys5Zyo5ouW5pS+55uu5qCH5LiK6Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyb3AoZXZlbnQ6IERyYWdFdmVudCwgbm9kZTogVGlUcmVlTm9kZSkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5kcmFnTm9kZS5mb2N1c2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jbGVhckRyYWdDbGFzcyhldmVudCk7XHJcbiAgICAgICAgLy8g5byC5q2l5Yqg6L296IqC54K55pe256aB5q2i5pS+572u5Yiw6IqC54K55YaF6YOoXHJcbiAgICAgICAgaWYgKHRoaXMuZHJvcFBvc2l0aW9uID09PSAwICYmIG5vZGUubG9hZFN0YXR1cyA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5ouW5ou96IqC54K55ZKM55uu5qCH6IqC54K55piv5ZCM5LiA6IqC54K5LHJldHVlblxyXG4gICAgICAgIGlmIChub2RlID09PSB0aGlzLmRyYWdOb2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW1zOiBUaVRyZWVEcmFnTm9kZSA9IHtcclxuICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxyXG4gICAgICAgICAgICB0YXJnZXROb2RlOiBub2RlLFxyXG4gICAgICAgICAgICBkcmFnTm9kZTogdGhpcy5kcmFnTm9kZSxcclxuICAgICAgICAgICAgZHJvcFBvc2l0aW9uOiB0aGlzLmRyb3BQb3NpdGlvblxyXG4gICAgICAgIH1cclxuICAgICAgICBUaVRyZWVVdGlsLmRyb3BBcHBseShwYXJhbXMsIHRoaXMuZGF0YSwgdGhpcy5tdWx0aXBsZSk7XHJcbiAgICAgICAgdGhpcy5ub2RlRHJvcC5lbWl0KHBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gZW5kRXZlbnQg6byg5qCH5LqL5Lu2XHJcbiAgICAgKiBAcGFyYW0gbm9kZSDlvZPliY3oioLngrnmlbDmja5cclxuICAgICAqIEBkZXNjcmlwdGlvbiDpvKDmoIflnKjmi5bmlL7nm67moIfkuIrph4rmlL7ml7Ys5Zyo5ouW5ou95YWD57Sg5LiK6Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyYWdlbmQoZXZlbnQ6IERyYWdFdmVudCwgbm9kZTogVGlUcmVlTm9kZSkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5kcmFnTm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVyTm9kZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6K6h566X5ouW5ou96IqC54K555qE5pS+572u5pa55byPMO+8iOS9nOS4uuebruagh+iKgueCueeahOWtkOiKgueCue+8ie+8jC0x77yI5pS+572u5Zyo55uu5qCH6IqC54K555qE5YmN6Z2i77yJLDHvvIjmlL7nva7lnKjnm67moIfoioLngrnnmoTlkI7pnaLvvIlcclxuICAgIHByaXZhdGUgY2FsY0Ryb3BQb3NpdGlvbihldmVudDogRHJhZ0V2ZW50KTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBjbGllbnRZOiBudW1iZXIgID0gZXZlbnQuY2xpZW50WTtcclxuICAgICAgICBjb25zdCB7IHRvcCwgaGVpZ2h0IH0gPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBnYXBIZWlnaHQ6IG51bWJlciA9IGhlaWdodCAvIDM7XHJcbiAgICAgICAgaWYgKGNsaWVudFkgPiB0b3AgKyBoZWlnaHQgLSBnYXBIZWlnaHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjbGllbnRZIDwgdG9wICsgZ2FwSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gMDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5riF6Zmk5ouW5ou95qC35byPXHJcbiAgICBwcml2YXRlIGNsZWFyRHJhZ0NsYXNzKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAvLyDmi5bmi73ov4fnqIvkuK3nmoTkuInnp43nirbmgIFcclxuICAgICAgICBjb25zdCBkcmFnQ2xhc3NlczogQXJyYXk8c3RyaW5nPiA9IFsndGkzLXRyZWUtZHJhZy1vdmVyLWlubmVyJywgJ3RpMy10cmVlLWRyYWctb3Zlci10b3AnLCAndGkzLXRyZWUtZHJhZy1vdmVyLWJvdHRvbSddO1xyXG4gICAgICAgIGRyYWdDbGFzc2VzLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyMi5yZW1vdmVDbGFzcyhldmVudC5jdXJyZW50VGFyZ2V0LCBpdGVtKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOagueaNruaLluWKqOeahOS9jee9ruiOt+WPluebuOW6lOeahOagt+W8j1xyXG4gICAgcHJpdmF0ZSBzZXREcmFnT3ZlckNsYXNzKG5vZGU6IFRpVHJlZU5vZGUpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmIChub2RlICE9PSB0aGlzLm92ZXJOb2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5kcm9wUG9zaXRpb24gPT09IDApIHtcclxuICAgICAgICAgIHJldHVybiBcInRpMy10cmVlLWRyYWctb3Zlci1pbm5lclwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kcm9wUG9zaXRpb24gPT09IC0xKSB7XHJcbiAgICAgICAgICByZXR1cm4gXCJ0aTMtdHJlZS1kcmFnLW92ZXItdG9wXCI7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRyb3BQb3NpdGlvbiA9PT0gMSkge1xyXG4gICAgICAgICAgcmV0dXJuIFwidGkzLXRyZWUtZHJhZy1vdmVyLWJvdHRvbVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBub2RlIOiKgueCuVxyXG4gICAgICogQHBhcmFtIHR5cGUgaG92ZXLmoIflv5dcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uTW91c2Vub2RlKG5vZGU6IFRpVHJlZU5vZGUsIHR5cGU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIC8vIOm8oOagh+i/m+WFpeiKgueCueS4lOS4jeaYr+e8lui+keeKtuaAgeaXtu+8jOaYvuekuuaTjeS9nOaMiemSrlxyXG4gICAgICAgIGlmICh0eXBlID09PSAnZW50ZXInICYmICFub2RlLmVkaXRpbmcpIHtcclxuICAgICAgICAgICAgbm9kZS5pc0hvdmVyID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkZWxldGUgbm9kZS5pc0hvdmVyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBub2RlIOiKgueCuVxyXG4gICAgICovXHJcbiAgIHB1YmxpYyBvbkJsdXJFZGl0KG5vZGU6IFRpVHJlZU5vZGUpOiB2b2lkIHtcclxuICAgICAgIGlmIChub2RlLmxhYmVsICE9PSAnJykge1xyXG4gICAgICAgICAgIGRlbGV0ZSBub2RlLmVkaXRpbmc7XHJcbiAgICAgICB9XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQHBhcmFtIGRlbGV0ZUV2ZW50IOWIoOmZpOS6i+S7tlxyXG4gICAgICogQHBhcmFtIG5vZGUg6IqC54K5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkZWxldGVOb2RlKGV2ZW50OiBFdmVudCwgbm9kZTogVGlUcmVlTm9kZSk6IHZvaWQge1xyXG4gICAgICAgIC8vIOmYu+atouS6i+S7tuWGkuazoSDpmLLmraLop6blj5HpgInkuK1cclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBjb25zdCBwYXJlbnROb2RlOiBUaVRyZWVOb2RlID0gVGlUcmVlVXRpbC5nZXRQYXJlbnROb2RlKHRoaXMuZGF0YSwgbm9kZSk7XHJcbiAgICAgICAgVGlUcmVlVXRpbC5yZW1vdmVOb2RlKHRoaXMuZGF0YSwgbm9kZSk7XHJcbiAgICAgICAgLy8g6IqC54K555qE54i26IqC54K55peg5a2Q6IqC54K55pe277yMIOWIoOmZpGNoaWxkcmVu5bGe5oCn77yM6Kej5Yaz5L6d5pen5Lya5pi+56S65bGV5byA5Zu+5qCH6Zeu6aKYXHJcbiAgICAgICAgaWYgKHBhcmVudE5vZGUgJiYgcGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBwYXJlbnROb2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmm7TmlrDlpJrpgInnirbmgIFcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZSkge1xyXG4gICAgICAgICAgICBUaVRyZWVVdGlsLnVwZGF0ZUNoZWNrZWQodGhpcy5kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ub2RlRGVsZXRlZC5lbWl0KG5vZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQHBhcmFtIGVkaXRFdmVudCDnvJbovpHkuovku7ZcclxuICAgICAqIEBwYXJhbSBub2RlIOiKgueCuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZWRpdE5vZGUoZXZlbnQ6IEV2ZW50LCBub2RlOiBUaVRyZWVOb2RlKTogdm9pZCB7XHJcbiAgICAgICAgLy8g6Zi75q2i5LqL5Lu25YaS5rOhIOmYsuatouinpuWPkemAieS4rVxyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIG5vZGUuZWRpdGluZyA9IHRydWU7XHJcbiAgICAgICAgZGVsZXRlIG5vZGUuaXNIb3ZlcjtcclxuICAgICAgICB0aGlzLm5vZGVFZGl0ZWQuZW1pdChub2RlKTtcclxuICAgICAgICAvLyBhdXRvZm9jdXPop4blm77lj5jljJbml7Yg5Lya5oql6ZSZIOinhuWbvuWPmOWMluaXtiDlvLrliLblj5jmo4DkuIDmrKHvvIzmtojpmaTmiqXplJkoRXhwcmVzc2lvbiBoYXMgY2hhbmdlZCBhZnRlciBpdCB3YXMgY2hlY2tlZClcclxuICAgICAgICB0aGlzLmNkUmVmLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEBwYXJhbSBhZGRFdmVudCDlop7liqDkuovku7ZcclxuICAgICAqIEBwYXJhbSBub2RlIOiKgueCuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWRkTm9kZShldmVudDogRXZlbnQsIG5vZGU6IFRpVHJlZU5vZGUpOiB2b2lkIHtcclxuICAgICAgICAvLyDpmLvmraLkuovku7blhpLms6Eg6Ziy5q2i6Kem5Y+R6YCJ5LitXHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgY29uc3QgbmV3Tm9kZTogVGlUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgbGFiZWw6IHRoaXMudHJlZUxhbi5uZXdOb2RlLFxyXG4gICAgICAgICAgICBlZGl0aW5nOiB0cnVlLFxyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLmV4cGFuZGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLm5vZGVBZGRlZC5lbWl0KG5ld05vZGUpO1xyXG4gICAgICAgIFRpVHJlZVV0aWwuYWRkTm9kZSh0aGlzLmRhdGEsIFtuZXdOb2RlXSwgMCwgbm9kZSk7XHJcbiAgICAgICAgLy8g5pu05paw5aSa6YCJ54q25oCBXHJcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgVGlUcmVlVXRpbC51cGRhdGVDaGVja2VkKHRoaXMuZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGF1dG9mb2N1c+inhuWbvuWPmOWMluaXtiDkvJrmiqXplJkg5by65Yi25Y+Y5qOA5LiA5qyh77yM5raI6Zmk5oql6ZSZKEV4cHJlc3Npb24gaGFzIGNoYW5nZWQgYWZ0ZXIgaXQgd2FzIGNoZWNrZWQpXHJcbiAgICAgICAgdGhpcy5jZFJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcbn1cclxuIl19