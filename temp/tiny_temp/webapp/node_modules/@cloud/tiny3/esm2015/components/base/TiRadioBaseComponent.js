import { Component, ElementRef, HostListener, Input, ViewChild } from '@angular/core';
import { Util } from '../../utils/Util';
import { TiFormComponent } from './TiFormComponent';
// 编译lib要求注册Component，不能用抽象类
/**
 * 单选/多选共同的基类。单选多选唯一的差异：单选只有在未选状态才接受空格键改变状态。
 */
export class TiRadioBaseComponent extends TiFormComponent {
    ngOnInit() {
        super.ngOnInit();
        this.creatId();
        this.setFocusableElems([this.proxyRef.nativeElement]);
        this.moveNode();
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        this.renderer.removeChild(this.renderer.parentNode(this.nativeElement), this.renderer.nextSibling(this.nativeElement));
    }
    /**
     * 将input子元素label，调整为兄弟元素。
     */
    moveNode() {
        const parentNode = this.renderer.parentNode(this.nativeElement);
        const nextNode = this.renderer.nextSibling(this.nativeElement);
        this.renderer.insertBefore(parentNode, this.labelRef.nativeElement, nextNode);
    }
    // Tiny3 TODO: 原始节点改为0高度，不显示。那么所有宿主元素focus都转移到proxy。
    // @HostListener('focus') onHostFocus() {
    //       Logger.log('onHostFocus');
    //       this.proxyNode.focus();
    //   }
    /**
     * @ignore
     * 点选元素后，聚集到对应的checkbox-skin
     * 经赵梦测试，这段逻辑，是为了解决radio火狐下tab键只聚焦不选中。
     * @param event 鼠标点击事件
     */
    onHostClick(event) {
        if (!this.nativeElement.disabled) {
            this.focusElem.focus();
        }
    }
    // 阻止事件冒泡：当子组件中有input元素时，change事件会冒泡到父组件
    // 问题：多选树模板包含复选框组件，树组件中有自己的change事件，点击复选框会触发两次change事件
    // 一次是树组件自身触发，一次是复选框组件冒泡，故需阻止该事件，例如下边代码会打印日志
    onHostChange(event) {
        event.stopPropagation();
    }
    /**
     * @ignore
     * 阻止checkbox-skin和checkbox-label的事件冒泡，防止上层dom绑定的事件被多次触发
     * 原因：span和label使用for和input关联，input上的click等事件也会触发span/label的事件处理，
     * 如果不做处理，上层dom绑定的事件会被触发两次
     * @param event 鼠标点击事件
     */
    onLabelClick(event) {
        event.stopPropagation();
    }
    /**
     * @ignore
     * 快捷键的处理(Enter和Space)：考虑到交互的友好性及与原生的一致性，
     * 在keyup中做相应的事件处理(keydown和keypress会存在一次点击，多次触发的情况);
     * 此外，需要阻止浏览器默认事件（空格键会触发页面滚动条滚到底部的行为，
     * 默认事件的阻止需要在keyup之前，因此此处在keydown中阻止）
     * @param event 键盘按键事件
     */
    onSpaceKeydown(event) {
        if (!this.nativeElement.disabled) {
            event.preventDefault();
        }
    }
    /**
     * @ignore
     * @param event 键盘按键事件
     */
    onSpaceKeyup(event) {
        if (!this.nativeElement.disabled && this.canChange()) {
            this.nativeElement.checked = !this.nativeElement.checked; // 设置元素的选中状态
            // this.cdRef.detectChanges();  执行并不能触发checked改变检查，所以只有下面的change事件才可以。
            // 触发check原生的change事件"createEvent" in document. 因为原生只有blur时才触发onchange
            Util.trigger(this.nativeElement, 'change');
        }
    }
    /**
     * @ignore
     * 这是单选多选唯一的差异：单选只有在未选状态才接受空格键改变状态。
     * @returns 默认返回true，多选框会继承这个方法。单选框重写这个方法。
     */
    canChange() {
        return true;
    }
} // end of class
TiRadioBaseComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-radiobase',
                template: ''
            },] }
];
TiRadioBaseComponent.propDecorators = {
    label: [{ type: Input }],
    labelRef: [{ type: ViewChild, args: ['labelRef', /* TODO: add static flag */ { static: true },] }],
    proxyRef: [{ type: ViewChild, args: ['proxyRef', /* TODO: add static flag */ { static: true },] }],
    onHostClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onHostChange: [{ type: HostListener, args: ['change', ['$event'],] }]
};
// Tiny3去除：不再操作宿主tabindex。取消input元素的tab聚焦行为(input 可聚焦情况下，tab键切换时会聚焦该元素)
// this.renderer.setAttribute(hostNode, 'tabindex', '-1'); // 经测试，display：none元素压根拿不到焦点。
// Tiny3去除：不再支持fosused属性。
// if ( this.nativeElement.focused !== this.hostAttrOld.focused) {
//   Logger.log('change hostAttrOld.focused');
//   if (this.nativeElement.focused) {
//       this.mySkinRef.nativeElement.focus();
//   }
//   this.hostAttrOld.focused = this.nativeElement.focused;
// Tiny3去除：增加对半选状态的支持。改为用户在模板上直接操作indeterminate
// const partialCheck = this.nativeElement.getAttribute('partialCheck');
// if (partialCheck !== this.hostAttrOld.partialCheck) {
//   Logger.log('change partialCheck=' + partialCheck);
//   this.nativeElement.indeterminate = partialCheck;
//   this.hostAttrOld.partialCheck = partialCheck;
// }
// Tiny3去除：event.which ||
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlSYWRpb0Jhc2VDb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueTMvY29tcG9uZW50cy9iYXNlL1RpUmFkaW9CYXNlQ29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3RGLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUN2QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsNEJBQTRCO0FBQzVCOztHQUVHO0FBS0gsTUFBTSxPQUFPLG9CQUFxQixTQUFRLGVBQWU7SUFjckQsUUFBUTtRQUNKLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNqQixJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDZixJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxXQUFXO1FBQ1AsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztJQUMzSCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxRQUFRO1FBQ1osTUFBTSxVQUFVLEdBQVEsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3JFLE1BQU0sUUFBUSxHQUFTLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDbEYsQ0FBQztJQUVELG9EQUFvRDtJQUNwRCx5Q0FBeUM7SUFDekMsbUNBQW1DO0lBQ25DLGdDQUFnQztJQUNoQyxNQUFNO0lBQ047Ozs7O09BS0c7SUFDdUMsV0FBVyxDQUFDLEtBQWlCO1FBQ25FLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRTtZQUM5QixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQzFCO0lBQ0wsQ0FBQztJQUVELHdDQUF3QztJQUN4QyxzREFBc0Q7SUFDdEQsNENBQTRDO0lBQ0QsWUFBWSxDQUFDLEtBQVk7UUFDaEUsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFDRDs7Ozs7O09BTUc7SUFDSSxZQUFZLENBQUMsS0FBaUI7UUFDakMsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFDRDs7Ozs7OztPQU9HO0lBQ0ksY0FBYyxDQUFDLEtBQW9CO1FBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRTtZQUM5QixLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDMUI7SUFDTCxDQUFDO0lBQ0Q7OztPQUdHO0lBQ0ksWUFBWSxDQUFDLEtBQW9CO1FBQ3BDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLEVBQUU7WUFDbEQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVk7WUFDdEUsc0VBQXNFO1lBQ3RFLHNFQUFzRTtZQUN0RSxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLENBQUM7U0FDOUM7SUFDTCxDQUFDO0lBQ0Q7Ozs7T0FJRztJQUNPLFNBQVM7UUFDZixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0VBQ0osZUFBZTs7WUF6R2YsU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxjQUFjO2dCQUN4QixRQUFRLEVBQUUsRUFBRTthQUNmOzs7b0JBS0ksS0FBSzt1QkFJTCxTQUFTLFNBQUMsVUFBVSxFQUFFLDJCQUEyQixDQUFDLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTt1QkFJbEUsU0FBUyxTQUFDLFVBQVUsRUFBRSwyQkFBMkIsQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7MEJBa0NsRSxZQUFZLFNBQUMsT0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDOzJCQVNoQyxZQUFZLFNBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDOztBQWdEdEMsdUVBQXVFO0FBQ3ZFLHdGQUF3RjtBQUN4Rix5QkFBeUI7QUFDekIsa0VBQWtFO0FBQ2xFLDhDQUE4QztBQUM5QyxzQ0FBc0M7QUFDdEMsOENBQThDO0FBQzlDLE1BQU07QUFDTiwyREFBMkQ7QUFDM0QsK0NBQStDO0FBQy9DLHdFQUF3RTtBQUN4RSx3REFBd0Q7QUFDeEQsdURBQXVEO0FBQ3ZELHFEQUFxRDtBQUNyRCxrREFBa0Q7QUFDbEQsSUFBSTtBQUNKLHlCQUF5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgSG9zdExpc3RlbmVyLCBJbnB1dCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFV0aWwgfSBmcm9tICcuLi8uLi91dGlscy9VdGlsJ1xyXG5pbXBvcnQgeyBUaUZvcm1Db21wb25lbnQgfSBmcm9tICcuL1RpRm9ybUNvbXBvbmVudCc7XHJcbi8vIOe8luivkWxpYuimgeaxguazqOWGjENvbXBvbmVudO+8jOS4jeiDveeUqOaKveixoeexu1xyXG4vKipcclxuICog5Y2V6YCJL+WkmumAieWFseWQjOeahOWfuuexu+OAguWNlemAieWkmumAieWUr+S4gOeahOW3ruW8gu+8muWNlemAieWPquacieWcqOacqumAieeKtuaAgeaJjeaOpeWPl+epuuagvOmUruaUueWPmOeKtuaAgeOAglxyXG4gKi9cclxuQENvbXBvbmVudCh7Ly8gbGli57yW6K+R6KaB5rGCQENvbXBvbmVudFxyXG4gICAgc2VsZWN0b3I6ICd0aS1yYWRpb2Jhc2UnLFxyXG4gICAgdGVtcGxhdGU6ICcnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUaVJhZGlvQmFzZUNvbXBvbmVudCBleHRlbmRzIFRpRm9ybUNvbXBvbmVudCB7XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumueahOWPr+eCueWHu+aWh+Wtl+OAglxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBsYWJlbDogc3RyaW5nOyAvLyBUaW55M+aWsOWinlxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIEBWaWV3Q2hpbGQoJ2xhYmVsUmVmJywgLyogVE9ETzogYWRkIHN0YXRpYyBmbGFnICovIHsgc3RhdGljOiB0cnVlIH0pIHByaXZhdGUgbGFiZWxSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZCgncHJveHlSZWYnLCAvKiBUT0RPOiBhZGQgc3RhdGljIGZsYWcgKi8geyBzdGF0aWM6IHRydWUgfSkgcHJpdmF0ZSBwcm94eVJlZjogRWxlbWVudFJlZjtcclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uSW5pdCgpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRJZCgpO1xyXG4gICAgICAgIHRoaXMuc2V0Rm9jdXNhYmxlRWxlbXMoW3RoaXMucHJveHlSZWYubmF0aXZlRWxlbWVudF0pO1xyXG4gICAgICAgIHRoaXMubW92ZU5vZGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uRGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2hpbGQodGhpcy5yZW5kZXJlci5wYXJlbnROb2RlKHRoaXMubmF0aXZlRWxlbWVudCksIHRoaXMucmVuZGVyZXIubmV4dFNpYmxpbmcodGhpcy5uYXRpdmVFbGVtZW50KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlsIZpbnB1dOWtkOWFg+e0oGxhYmVs77yM6LCD5pW05Li65YWE5byf5YWD57Sg44CCXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbW92ZU5vZGUoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgcGFyZW50Tm9kZTogYW55ID0gdGhpcy5yZW5kZXJlci5wYXJlbnROb2RlKHRoaXMubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgY29uc3QgbmV4dE5vZGU6IGFueSAgPSB0aGlzLnJlbmRlcmVyLm5leHRTaWJsaW5nKHRoaXMubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5pbnNlcnRCZWZvcmUocGFyZW50Tm9kZSwgdGhpcy5sYWJlbFJlZi5uYXRpdmVFbGVtZW50LCBuZXh0Tm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGlueTMgVE9ETzog5Y6f5aeL6IqC54K55pS55Li6MOmrmOW6pu+8jOS4jeaYvuekuuOAgumCo+S5iOaJgOacieWuv+S4u+WFg+e0oGZvY3Vz6YO96L2s56e75YiwcHJveHnjgIJcclxuICAgIC8vIEBIb3N0TGlzdGVuZXIoJ2ZvY3VzJykgb25Ib3N0Rm9jdXMoKSB7XHJcbiAgICAvLyAgICAgICBMb2dnZXIubG9nKCdvbkhvc3RGb2N1cycpO1xyXG4gICAgLy8gICAgICAgdGhpcy5wcm94eU5vZGUuZm9jdXMoKTtcclxuICAgIC8vICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDngrnpgInlhYPntKDlkI7vvIzogZrpm4bliLDlr7nlupTnmoRjaGVja2JveC1za2luXHJcbiAgICAgKiDnu4/otbXmoqbmtYvor5XvvIzov5nmrrXpgLvovpHvvIzmmK/kuLrkuobop6PlhrNyYWRpb+eBq+eLkOS4i3RhYumUruWPquiBmueEpuS4jemAieS4reOAglxyXG4gICAgICogQHBhcmFtIGV2ZW50IOm8oOagh+eCueWHu+S6i+S7tlxyXG4gICAgICovXHJcbiAgICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pIHB1YmxpYyBvbkhvc3RDbGljayhldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVFbGVtZW50LmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9jdXNFbGVtLmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOmYu+atouS6i+S7tuWGkuazoe+8muW9k+WtkOe7hOS7tuS4reaciWlucHV05YWD57Sg5pe277yMY2hhbmdl5LqL5Lu25Lya5YaS5rOh5Yiw54i257uE5Lu2XHJcbiAgICAvLyDpl67popjvvJrlpJrpgInmoJHmqKHmnb/ljIXlkKvlpI3pgInmoYbnu4Tku7bvvIzmoJHnu4Tku7bkuK3mnInoh6rlt7HnmoRjaGFuZ2Xkuovku7bvvIzngrnlh7vlpI3pgInmoYbkvJrop6blj5HkuKTmrKFjaGFuZ2Xkuovku7ZcclxuICAgIC8vIOS4gOasoeaYr+agkee7hOS7tuiHqui6q+inpuWPke+8jOS4gOasoeaYr+WkjemAieahhue7hOS7tuWGkuazoe+8jOaVhemcgOmYu+atouivpeS6i+S7tu+8jOS+i+WmguS4i+i+ueS7o+eggeS8muaJk+WNsOaXpeW/l1xyXG4gICAgQEhvc3RMaXN0ZW5lcignY2hhbmdlJywgWyckZXZlbnQnXSkgcHVibGljIG9uSG9zdENoYW5nZShldmVudDogRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog6Zi75q2iY2hlY2tib3gtc2tpbuWSjGNoZWNrYm94LWxhYmVs55qE5LqL5Lu25YaS5rOh77yM6Ziy5q2i5LiK5bGCZG9t57uR5a6a55qE5LqL5Lu26KKr5aSa5qyh6Kem5Y+RXHJcbiAgICAgKiDljp/lm6DvvJpzcGFu5ZKMbGFiZWzkvb/nlKhmb3LlkoxpbnB1dOWFs+iBlO+8jGlucHV05LiK55qEY2xpY2vnrYnkuovku7bkuZ/kvJrop6blj5FzcGFuL2xhYmVs55qE5LqL5Lu25aSE55CG77yMXHJcbiAgICAgKiDlpoLmnpzkuI3lgZrlpITnkIbvvIzkuIrlsYJkb23nu5HlrprnmoTkuovku7bkvJrooqvop6blj5HkuKTmrKFcclxuICAgICAqIEBwYXJhbSBldmVudCDpvKDmoIfngrnlh7vkuovku7ZcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uTGFiZWxDbGljayhldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlv6vmjbfplK7nmoTlpITnkIYoRW50ZXLlkoxTcGFjZSnvvJrogIPomZHliLDkuqTkupLnmoTlj4vlpb3mgKflj4rkuI7ljp/nlJ/nmoTkuIDoh7TmgKfvvIxcclxuICAgICAqIOWcqGtleXVw5Lit5YGa55u45bqU55qE5LqL5Lu25aSE55CGKGtleWRvd27lkoxrZXlwcmVzc+S8muWtmOWcqOS4gOasoeeCueWHu++8jOWkmuasoeinpuWPkeeahOaDheWGtSk7XHJcbiAgICAgKiDmraTlpJbvvIzpnIDopoHpmLvmraLmtY/op4jlmajpu5jorqTkuovku7bvvIjnqbrmoLzplK7kvJrop6blj5HpobXpnaLmu5rliqjmnaHmu5rliLDlupXpg6jnmoTooYzkuLrvvIxcclxuICAgICAqIOm7mOiupOS6i+S7tueahOmYu+atoumcgOimgeWcqGtleXVw5LmL5YmN77yM5Zug5q2k5q2k5aSE5Zyoa2V5ZG93buS4remYu+atou+8iVxyXG4gICAgICogQHBhcmFtIGV2ZW50IOmUruebmOaMiemUruS6i+S7tlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb25TcGFjZUtleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHsgLy8gd2l0aCB0eXBlIGluZm9cclxuICAgICAgICBpZiAoIXRoaXMubmF0aXZlRWxlbWVudC5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQHBhcmFtIGV2ZW50IOmUruebmOaMiemUruS6i+S7tlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb25TcGFjZUtleXVwKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCB7IC8vIHdpdGggdHlwZSBpbmZvXHJcbiAgICAgICAgaWYgKCF0aGlzLm5hdGl2ZUVsZW1lbnQuZGlzYWJsZWQgJiYgdGhpcy5jYW5DaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuY2hlY2tlZCA9ICF0aGlzLm5hdGl2ZUVsZW1lbnQuY2hlY2tlZDsgLy8g6K6+572u5YWD57Sg55qE6YCJ5Lit54q25oCBXHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2RSZWYuZGV0ZWN0Q2hhbmdlcygpOyAg5omn6KGM5bm25LiN6IO96Kem5Y+RY2hlY2tlZOaUueWPmOajgOafpe+8jOaJgOS7peWPquacieS4i+mdoueahGNoYW5nZeS6i+S7tuaJjeWPr+S7peOAglxyXG4gICAgICAgICAgICAvLyDop6blj5FjaGVja+WOn+eUn+eahGNoYW5nZeS6i+S7tlwiY3JlYXRlRXZlbnRcIiBpbiBkb2N1bWVudC4g5Zug5Li65Y6f55Sf5Y+q5pyJYmx1cuaXtuaJjeinpuWPkW9uY2hhbmdlXHJcbiAgICAgICAgICAgIFV0aWwudHJpZ2dlcih0aGlzLm5hdGl2ZUVsZW1lbnQsICdjaGFuZ2UnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOi/meaYr+WNlemAieWkmumAieWUr+S4gOeahOW3ruW8gu+8muWNlemAieWPquacieWcqOacqumAieeKtuaAgeaJjeaOpeWPl+epuuagvOmUruaUueWPmOeKtuaAgeOAglxyXG4gICAgICogQHJldHVybnMg6buY6K6k6L+U5ZuedHJ1Ze+8jOWkmumAieahhuS8mue7p+aJv+i/meS4quaWueazleOAguWNlemAieahhumHjeWGmei/meS4quaWueazleOAglxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgY2FuQ2hhbmdlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59Ly8gZW5kIG9mIGNsYXNzXHJcblxyXG4vLyBUaW55M+WOu+mZpO+8muS4jeWGjeaTjeS9nOWuv+S4u3RhYmluZGV444CC5Y+W5raIaW5wdXTlhYPntKDnmoR0YWLogZrnhKbooYzkuLooaW5wdXQg5Y+v6IGa54Sm5oOF5Ya15LiL77yMdGFi6ZSu5YiH5o2i5pe25Lya6IGa54Sm6K+l5YWD57SgKVxyXG4vLyB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShob3N0Tm9kZSwgJ3RhYmluZGV4JywgJy0xJyk7IC8vIOe7j+a1i+ivle+8jGRpc3BsYXnvvJpub25l5YWD57Sg5Y6L5qC55ou/5LiN5Yiw54Sm54K544CCXHJcbi8vIFRpbnkz5Y676Zmk77ya5LiN5YaN5pSv5oyBZm9zdXNlZOWxnuaAp+OAglxyXG4vLyBpZiAoIHRoaXMubmF0aXZlRWxlbWVudC5mb2N1c2VkICE9PSB0aGlzLmhvc3RBdHRyT2xkLmZvY3VzZWQpIHtcclxuLy8gICBMb2dnZXIubG9nKCdjaGFuZ2UgaG9zdEF0dHJPbGQuZm9jdXNlZCcpO1xyXG4vLyAgIGlmICh0aGlzLm5hdGl2ZUVsZW1lbnQuZm9jdXNlZCkge1xyXG4vLyAgICAgICB0aGlzLm15U2tpblJlZi5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbi8vICAgfVxyXG4vLyAgIHRoaXMuaG9zdEF0dHJPbGQuZm9jdXNlZCA9IHRoaXMubmF0aXZlRWxlbWVudC5mb2N1c2VkO1xyXG4vLyBUaW55M+WOu+mZpO+8muWinuWKoOWvueWNiumAieeKtuaAgeeahOaUr+aMgeOAguaUueS4uueUqOaIt+WcqOaooeadv+S4iuebtOaOpeaTjeS9nGluZGV0ZXJtaW5hdGVcclxuLy8gY29uc3QgcGFydGlhbENoZWNrID0gdGhpcy5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgncGFydGlhbENoZWNrJyk7XHJcbi8vIGlmIChwYXJ0aWFsQ2hlY2sgIT09IHRoaXMuaG9zdEF0dHJPbGQucGFydGlhbENoZWNrKSB7XHJcbi8vICAgTG9nZ2VyLmxvZygnY2hhbmdlIHBhcnRpYWxDaGVjaz0nICsgcGFydGlhbENoZWNrKTtcclxuLy8gICB0aGlzLm5hdGl2ZUVsZW1lbnQuaW5kZXRlcm1pbmF0ZSA9IHBhcnRpYWxDaGVjaztcclxuLy8gICB0aGlzLmhvc3RBdHRyT2xkLnBhcnRpYWxDaGVjayA9IHBhcnRpYWxDaGVjaztcclxuLy8gfVxyXG4vLyBUaW55M+WOu+mZpO+8mmV2ZW50LndoaWNoIHx8XHJcbiJdfQ==