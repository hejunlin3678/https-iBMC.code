import { ChangeDetectorRef, Component, ElementRef, Input } from '@angular/core';
import { TiFormfieldComponent } from './TiFormfieldComponent';
import { Util } from '../../utils/Util';
/**
 * 本组件嵌在 tiFormfield 中使用，包裹着单个表单条目的所有内容
 */
export class TiItemComponent {
    constructor(formfield, elementRef, changeDetector) {
        this.formfield = formfield;
        this.elementRef = elementRef;
        this.changeDetector = changeDetector;
        /**
         * 设置当前表单条目是否是必填，如果是必填，则前面会显示 *
         */
        this.required = false;
        /**
         * 设置当前表单条目是否显示
         *
         * tiItem 不支持 ngIf 和 hidden，由该接口来控制单个表单条目的显示与否
         */
        this.show = true;
        /**
         * 行合并，设置当前表单条目可横跨的行数
         */
        this.rowspan = 1;
        /**
         * 列合并，设置当前表单条目可横跨的列数
         */
        this.colspan = 1;
        /**
         * @ignore
         */
        this.hasLabel = false;
        /**
         * @ignore
         */
        this.gapWidth = '0px';
    }
    // 有两处改变label
    // 1. label接口传入的值
    // 2. 在ti-item-label组件中修改label的值
    /**
     * 设置当前表单条目的label文本，支持简单字符串文本，如果开发者希望基于html定制文本，
     * 建议使用[TiItemLabelComponent]{@link ./TiItemLabelComponent.html}组件
     *
     * 类型：string | Node
     */
    set label(labelParm) {
        this.setItemLabel(labelParm);
    }
    ngOnInit() {
        this.formfield.itemTotal++;
        this.decorateItem();
        if (this.show) {
            this.formfield.addCntItem(this);
        }
    }
    ngOnChanges(changes) {
        const showObj = changes['show'];
        if (showObj && !showObj.firstChange) {
            if (showObj.currentValue) {
                this.formfield.addCntItem(this);
            }
            else {
                this.formfield.removeCntItem(this);
            }
        }
    }
    ngOnDestroy() {
        // 在外部将ti-iem销毁时，应将此item从items数组中去掉
        this.formfield.removeCntItem(this);
        this.changeDetector.detach();
    }
    decorateItem() {
        this.itemIndex = Util.isNumber(this.index) ? this.index : this.formfield.itemTotal - 1;
        this.element = this.elementRef.nativeElement;
        this.verticalAlignObj = Util.isUndefined(this.verticalAlign) ?
            {} : { 'vertical-align': this.verticalAlign };
        // item-label的自定义的样式（垂直对齐方式、宽度）
        this.labelStyle = {
            'vertical-align': this.verticalAlign,
            width: this.formfield.labelWidth
        };
        // item-content的自定义的样式（垂直对齐方式）
        this.contentStyle = {
            'vertical-align': this.verticalAlign
        };
        // 为纯文本描述类表单时，可设置 item 的行高
        if (this.formfield.type === this.formfield.textType) {
            this.labelStyle['line-height'] = this.formfield.textLineHeight;
            this.contentStyle['line-height'] = this.formfield.textLineHeight;
        }
        // item 自定义行列合并样式
        if (this.formfield.useGrid) {
            this.itemStyle = { 'grid-area': `span ${this.rowspan} / span ${this.colspan}` };
        }
    }
    setItemLabel(label) {
        if (label) {
            this.hasLabel = true;
            this.itemLabel = label;
        }
        else {
            this.hasLabel = false;
        }
        this.changeDetector.detectChanges();
    }
}
TiItemComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-item',
                template: "<ng-content></ng-content>"
            },] }
];
TiItemComponent.ctorParameters = () => [
    { type: TiFormfieldComponent },
    { type: ElementRef },
    { type: ChangeDetectorRef }
];
TiItemComponent.propDecorators = {
    required: [{ type: Input }],
    verticalAlign: [{ type: Input }],
    show: [{ type: Input }],
    rowspan: [{ type: Input }],
    colspan: [{ type: Input }],
    index: [{ type: Input }],
    label: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlJdGVtQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvZm9ybWZpZWxkL1RpSXRlbUNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0gsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsS0FBSyxFQU1SLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzlELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUV4Qzs7R0FFRztBQUtILE1BQU0sT0FBTyxlQUFlO0lBd0V4QixZQUFvQixTQUErQixFQUFVLFVBQXNCLEVBQy9ELGNBQWlDO1FBRGpDLGNBQVMsR0FBVCxTQUFTLENBQXNCO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUMvRCxtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUF4RXJEOztXQUVHO1FBQ00sYUFBUSxHQUFZLEtBQUssQ0FBQztRQU9uQzs7OztXQUlHO1FBQ00sU0FBSSxHQUFZLElBQUksQ0FBQztRQUM5Qjs7V0FFRztRQUNNLFlBQU8sR0FBVyxDQUFDLENBQUM7UUFDN0I7O1dBRUc7UUFDTSxZQUFPLEdBQVcsQ0FBQyxDQUFDO1FBd0M3Qjs7V0FFRztRQUNJLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFDakM7O1dBRUc7UUFDSSxhQUFRLEdBQVcsS0FBSyxDQUFDO0lBRXdCLENBQUM7SUFFekQsYUFBYTtJQUNiLGlCQUFpQjtJQUNqQixnQ0FBZ0M7SUFDaEM7Ozs7O09BS0c7SUFDSCxJQUNJLEtBQUssQ0FBQyxTQUF3QjtRQUM5QixJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxRQUFRO1FBQ0osSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUMz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QkFBaUI7Ozt1QkF3QmhCLEtBQUs7NEJBTUwsS0FBSzttQkFNTCxLQUFLO3NCQUlMLEtBQUs7c0JBSUwsS0FBSztvQkFVTCxLQUFLO29CQWtETCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgQ29tcG9uZW50LFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIElucHV0LFxyXG4gICAgT25DaGFuZ2VzLFxyXG4gICAgT25EZXN0cm95LFxyXG4gICAgT25Jbml0LFxyXG4gICAgU2ltcGxlQ2hhbmdlLFxyXG4gICAgU2ltcGxlQ2hhbmdlc1xyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUaUZvcm1maWVsZENvbXBvbmVudCB9IGZyb20gJy4vVGlGb3JtZmllbGRDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBVdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcblxyXG4vKipcclxuICog5pys57uE5Lu25bWM5ZyoIHRpRm9ybWZpZWxkIOS4reS9v+eUqO+8jOWMheijueedgOWNleS4quihqOWNleadoeebrueahOaJgOacieWGheWuuVxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3RpLWl0ZW0nLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2Zvcm1maWVsZC1pdGVtLmh0bWwnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUaUl0ZW1Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5b2T5YmN6KGo5Y2V5p2h55uu5piv5ZCm5piv5b+F5aGr77yM5aaC5p6c5piv5b+F5aGr77yM5YiZ5YmN6Z2i5Lya5pi+56S6ICpcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgcmVxdWlyZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5b2T5YmN6KGo5Y2V5p2h55uu55qE5Z6C55u05a+56b2Q5pa55byP77yM6buY6K6k5Li6dG9w77yI5LiK5LiL5biD5bGA6KGo5Y2V5LiN5pSv5oyB6K+l5bGe5oCn77yJ44CCXHJcbiAgICAgKlxyXG4gICAgICog6IO95aSf6KaG55uWdGlGb3JtZmllbGTmjIfku6TkuIrnmoR2ZXJ0aWNhbEFsaWdu6K6+572uXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHZlcnRpY2FsQWxpZ246ICd0b3AnIHwgJ21pZGRsZScgfCAnYm90dG9tJztcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5b2T5YmN6KGo5Y2V5p2h55uu5piv5ZCm5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogdGlJdGVtIOS4jeaUr+aMgSBuZ0lmIOWSjCBoaWRkZW7vvIznlLHor6XmjqXlj6PmnaXmjqfliLbljZXkuKrooajljZXmnaHnm67nmoTmmL7npLrkuI7lkKZcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgc2hvdzogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAvKipcclxuICAgICAqIOihjOWQiOW5tu+8jOiuvue9ruW9k+WJjeihqOWNleadoeebruWPr+aoqui3qOeahOihjOaVsFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSByb3dzcGFuOiBudW1iZXIgPSAxO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJflkIjlubbvvIzorr7nva7lvZPliY3ooajljZXmnaHnm67lj6/mqKrot6jnmoTliJfmlbBcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgY29sc3BhbjogbnVtYmVyID0gMTtcclxuICAgIC8qKlxyXG4gICAgICog5ZyoIHRpLWZvcm1maWVsZCDkuK3nmoTlsZXnpLrpobrluo/vvIzmlbDlgLzotorlpKfotorpnaDlkI7lsZXnpLrvvJtcclxuICAgICAqXHJcbiAgICAgKiDopoHkvb/nlKjor6XmjqXlj6Pml7bvvIzlvZPliY10aS1mb3JtZmllbGTkuK3nmoTmiYDku6V0aS1pdGVt6YO96KaB6K6+572u6K+l5o6l5Y+j77ybXHJcbiAgICAgKlxyXG4gICAgICog5LiN6K6+572u5pe25oyJIHRpLWl0ZW0g55qE6Kej5p6Q6aG65bqP5bGV56S6XHJcbiAgICAgKlxyXG4gICAgICogMTAuMC4x5paw5aKeXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGluZGV4OiBudW1iZXI7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIHRpSXRlbeeahOe0ouW8leWAvO+8jOeUqOS6juaOp+WItuWFtuaYvuekuuaXtueahOS9jee9rumhuuW6j1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaXRlbUluZGV4OiBudW1iZXI7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHZlcnRpY2FsQWxpZ25PYmo6IHsgJ3ZlcnRpY2FsLWFsaWduJz86IHN0cmluZyB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpdGVtU3R5bGU6IHsgJ2dyaWQtYXJlYSc/OiBzdHJpbmcgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbGFiZWxTdHlsZTogeyAndmVydGljYWwtYWxpZ24nPzogc3RyaW5nLCB3aWR0aD86IHN0cmluZywgJ2xpbmUtaGVpZ2h0Jz86IHN0cmluZyB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb250ZW50U3R5bGU6IHsgJ3ZlcnRpY2FsLWFsaWduJz86IHN0cmluZywgJ2xpbmUtaGVpZ2h0Jz86IHN0cmluZywgJ3dpZHRoJz86IHN0cmluZyB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaXRlbUxhYmVsOiBzdHJpbmcgfCBOb2RlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBoYXNMYWJlbDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnYXBXaWR0aDogc3RyaW5nID0gJzBweCc7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGZvcm1maWVsZDogVGlGb3JtZmllbGRDb21wb25lbnQsIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZixcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgY2hhbmdlRGV0ZWN0b3I6IENoYW5nZURldGVjdG9yUmVmKSB7fVxyXG5cclxuICAgIC8vIOacieS4pOWkhOaUueWPmGxhYmVsXHJcbiAgICAvLyAxLiBsYWJlbOaOpeWPo+S8oOWFpeeahOWAvFxyXG4gICAgLy8gMi4g5ZyodGktaXRlbS1sYWJlbOe7hOS7tuS4reS/ruaUuWxhYmVs55qE5YC8XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruW9k+WJjeihqOWNleadoeebrueahGxhYmVs5paH5pys77yM5pSv5oyB566A5Y2V5a2X56ym5Liy5paH5pys77yM5aaC5p6c5byA5Y+R6ICF5biM5pyb5Z+65LqOaHRtbOWumuWItuaWh+acrO+8jFxyXG4gICAgICog5bu66K6u5L2/55SoW1RpSXRlbUxhYmVsQ29tcG9uZW50XXtAbGluayAuL1RpSXRlbUxhYmVsQ29tcG9uZW50Lmh0bWx957uE5Lu2XHJcbiAgICAgKlxyXG4gICAgICog57G75Z6L77yac3RyaW5nIHwgTm9kZVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGxhYmVsKGxhYmVsUGFybTogc3RyaW5nIHwgTm9kZSkge1xyXG4gICAgICAgIHRoaXMuc2V0SXRlbUxhYmVsKGxhYmVsUGFybSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5mb3JtZmllbGQuaXRlbVRvdGFsKys7XHJcbiAgICAgICAgdGhpcy5kZWNvcmF0ZUl0ZW0oKTtcclxuICAgICAgICBpZiAodGhpcy5zaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybWZpZWxkLmFkZENudEl0ZW0odGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBzaG93T2JqOiBTaW1wbGVDaGFuZ2UgPSBjaGFuZ2VzWydzaG93J107XHJcbiAgICAgICAgaWYgKHNob3dPYmogJiYgIXNob3dPYmouZmlyc3RDaGFuZ2UpIHtcclxuICAgICAgICAgICAgaWYgKHNob3dPYmouY3VycmVudFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1maWVsZC5hZGRDbnRJdGVtKHRoaXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtZmllbGQucmVtb3ZlQ250SXRlbSh0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICAvLyDlnKjlpJbpg6jlsIZ0aS1pZW3plIDmr4Hml7bvvIzlupTlsIbmraRpdGVt5LuOaXRlbXPmlbDnu4TkuK3ljrvmjolcclxuICAgICAgICB0aGlzLmZvcm1maWVsZC5yZW1vdmVDbnRJdGVtKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0YWNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZWNvcmF0ZUl0ZW0oKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5pdGVtSW5kZXggPSBVdGlsLmlzTnVtYmVyKHRoaXMuaW5kZXgpID8gdGhpcy5pbmRleCA6IHRoaXMuZm9ybWZpZWxkLml0ZW1Ub3RhbCAtIDE7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy52ZXJ0aWNhbEFsaWduT2JqID0gVXRpbC5pc1VuZGVmaW5lZCh0aGlzLnZlcnRpY2FsQWxpZ24pID9cclxuICAgICAgICAgICAge30gOiB7ICd2ZXJ0aWNhbC1hbGlnbic6IHRoaXMudmVydGljYWxBbGlnbiB9O1xyXG5cclxuICAgICAgICAvLyBpdGVtLWxhYmVs55qE6Ieq5a6a5LmJ55qE5qC35byP77yI5Z6C55u05a+56b2Q5pa55byP44CB5a695bqm77yJXHJcbiAgICAgICAgdGhpcy5sYWJlbFN0eWxlID0ge1xyXG4gICAgICAgICAgICAndmVydGljYWwtYWxpZ24nOiB0aGlzLnZlcnRpY2FsQWxpZ24sXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLmZvcm1maWVsZC5sYWJlbFdpZHRoXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gaXRlbS1jb250ZW5055qE6Ieq5a6a5LmJ55qE5qC35byP77yI5Z6C55u05a+56b2Q5pa55byP77yJXHJcbiAgICAgICAgdGhpcy5jb250ZW50U3R5bGUgPSB7XHJcbiAgICAgICAgICAgICd2ZXJ0aWNhbC1hbGlnbic6IHRoaXMudmVydGljYWxBbGlnblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5Li657qv5paH5pys5o+P6L+w57G76KGo5Y2V5pe277yM5Y+v6K6+572uIGl0ZW0g55qE6KGM6auYXHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybWZpZWxkLnR5cGUgPT09IHRoaXMuZm9ybWZpZWxkLnRleHRUeXBlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxTdHlsZVsnbGluZS1oZWlnaHQnXSA9IHRoaXMuZm9ybWZpZWxkLnRleHRMaW5lSGVpZ2h0O1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRTdHlsZVsnbGluZS1oZWlnaHQnXSA9IHRoaXMuZm9ybWZpZWxkLnRleHRMaW5lSGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaXRlbSDoh6rlrprkuYnooYzliJflkIjlubbmoLflvI9cclxuICAgICAgICBpZiAodGhpcy5mb3JtZmllbGQudXNlR3JpZCkge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1TdHlsZSA9IHsgJ2dyaWQtYXJlYSc6IGBzcGFuICR7dGhpcy5yb3dzcGFufSAvIHNwYW4gJHt0aGlzLmNvbHNwYW59YCB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldEl0ZW1MYWJlbChsYWJlbDogc3RyaW5nIHwgTm9kZSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgICAgICB0aGlzLmhhc0xhYmVsID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5pdGVtTGFiZWwgPSBsYWJlbDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhhc0xhYmVsID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==