import { Component, ElementRef, Input, NgZone, Renderer2, ViewChild, Inject } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { TiBaseComponent } from '../base/TiBaseModule';
import { TiRenderer } from '../../services/renderer/TiRenderer';
import { TiDroplistComponent } from '../droplist/TiDroplistModule';
import { Util } from '../../utils/Util';
/**
 * TiTabs组件属于布局组件，通过该组件产品可以实现不同视图的切换功能。
 *
 * 其内部包含2个组件 TiTab 和 TiTabHeader
 *
 * <example-url>../tiny3demo/#/tab/tab-all</example-url>
 */
export class TiTabsComponent extends TiBaseComponent {
    constructor(elementRef, renderer2, tiRenderer, zone, document) {
        super(elementRef, renderer2);
        this.elementRef = elementRef;
        this.renderer2 = renderer2;
        this.tiRenderer = tiRenderer;
        this.zone = zone;
        this.document = document;
        /**
         * 1."justified"(默认): 下拉框的宽度与输入框的宽度保持一致；
         *
         * 2."auto": 下拉框的宽度根据下拉项的内容自动撑开；
         *
         * 3.表示宽度的字符串: 设置固定的下拉框宽度(不小于输入框的宽度)。例如："200px"。
         *
         * 10.0.1新增
         */
        this.panelWidth = '100px';
        /**
         * 面板对齐方式
         *
         * 10.0.1新增
         *
         */
        this.panelAlign = 'right';
        /**
         * 指定下拉项超长文本提示方向
         *
         * 10.0.1新增
         *
         */
        this.tipPosition = 'left';
        /**
         * @ignore
         */
        this.labelKey = 'header';
        /**
         * @ignore
         * 下拉项
         */
        this.options = [];
        /**
         * @ignore
         * TiTabs中包裹的所有的 TiTabComponent 集合
         */
        this.tabs = [];
        this.isNotVisibleInit = false; // 标志初始时是否可见
        /**
         * @ignore
         * TiTabComponent.ts中使用
         */
        this.destroyed = false;
        /**
         * @ignore
         * 是否显示滑动条slider（一级页签显示，二级/暗色页签不显示）
         * TiTabHeaderComponent.ts中使用
         */
        this.hasSlider = false;
        /**
         * @ignore
         * TiTabHeaderComponent.ts中使用
         */
        this.headerWidthChange = false;
        this.resolvedPromise = Promise.resolve(null);
    }
    /**
     * @ignore
     * 下拉选项变更时触发
     */
    onDroplistChange($event) {
        this.tabs.forEach((item) => {
            if (item.id === this.selectedTab.id) {
                this.setActiveValue(item, true);
                this.activeTab(item, true);
            }
        });
    }
    /**
     * @ignore
     * 点击下拉按钮打开下拉面板
     */
    showMorePanel(event) {
        this.dropListComp.show();
        event.stopPropagation();
    }
    ngOnInit() {
        super.ngOnInit();
        // 初始化是否显示滑动条slider（一级页签显示，二级/暗色页签不显示）
        this.hasSlider = !this.nativeElement.hasAttribute('level2') && !this.nativeElement.hasAttribute('dark');
    }
    ngAfterViewInit() {
        super.ngAfterContentInit();
        if (this.hasSlider) {
            // 如果祖先元素中display为none，获取到的组件的宽度为0,元素不可见
            this.isNotVisibleInit = this.nativeElement.clientWidth === 0;
        }
        this.zone.runOutsideAngular(() => {
            // 点击documnet优惠信息窗口关闭
            this.onlistenClick = this.renderer2.listen(this.document, 'click', () => this.dropListComp.hide());
            if (typeof window === 'undefined') {
                return;
            }
            this.windowResizeListener = this.renderer2.listen(window, 'resize', () => {
                this.setMoreStyle();
                this.setTabStyle(true);
            });
        });
    }
    ngAfterViewChecked() {
        super.ngAfterViewChecked();
        // 初始祖先元素中display为none，之后第一次由none变成可见时，需要重置silder
        if (this.isNotVisibleInit && this.nativeElement.clientWidth !== 0) {
            this.setTabStyle(false);
            this.isNotVisibleInit = false;
            return;
        }
        // 此处执行晚于TiTabHeaderComponent的ngAfterViewChecked
        if (this.headerWidthChange) {
            this.setTabStyle(false);
            this.headerWidthChange = false;
            this.setMoreStyle();
        }
    }
    ngOnDestroy() {
        this.destroyed = true;
        if (this.windowResizeListener) {
            this.windowResizeListener();
        }
        if (this.onlistenClick) {
            this.onlistenClick();
        }
    }
    /**
     * @ignore
     */
    setMoreStyle() {
        if (this.isOverflow()) {
            this.renderer2.setStyle(this.moreRef.nativeElement, 'display', 'block');
        }
        else {
            this.renderer2.setStyle(this.moreRef.nativeElement, 'display', 'none');
        }
    }
    /**
     * @ignore
     * TiTabComponent.ts 中调用
     */
    addTab(tab) {
        if (tab.active) {
            this.tabs.forEach((item) => {
                if (item.active) {
                    this.setActiveValue(item, false);
                }
            });
        }
        this.tabs.push(tab);
        const tabElements = Array.from(this.tabContentContainer.nativeElement.children);
        this.tabs.sort((a, b) => {
            return tabElements.indexOf(a.nativeElement) - tabElements.indexOf(b.nativeElement);
        });
        if (!tab.active && this.selectedTab
            && tabElements.indexOf(tab.nativeElement) < tabElements.indexOf(this.selectedTab.nativeElement)) {
            setTimeout(() => {
                this.setTabStyle(true);
            }, 0);
        }
        this.options = this.tabs;
        setTimeout(() => {
            this.setMoreStyle();
        }, 0);
    }
    /**
     * @ignore
     * TiTabComponent.ts 中调用
     */
    removeTab(tab) {
        const index = this.tabs.indexOf(tab);
        const length = this.tabs.length;
        this.tabs.splice(index, 1);
        setTimeout(() => {
            this.setMoreStyle();
        }, 0);
        // 删除当前激活状态的tab
        if (tab.active && length > 1) {
            const newActiveIndex = this.getNewActiveIndex(index, length);
            if (newActiveIndex !== -1) {
                this.setActiveValue(this.tabs[newActiveIndex], true);
                this.activeTab(this.tabs[newActiveIndex], true);
            }
            return;
        }
        // 删除的是非激活状态的tab,那么就在删除后的tabs数组中查找剩下的哪一个tab是激活状态，再设置激活状态；
        if (!tab.active) {
            setTimeout(() => {
                this.setTabStyle(true);
            }, 0);
        }
    }
    /**
     * @ignore
     * TiTabComponent.ts 中调用
     */
    activeTab(selectedTab, enableAnimate) {
        this.deActiveOthers(selectedTab);
        selectedTab.loaded = true;
        this.selectedTab = selectedTab;
        // 只有不是灰化状态时，才触发切换动效
        if (!selectedTab.disabled) {
            // 添加定时器，处理ngFor未渲染完毕，获取到得silder的位置不准确
            setTimeout(() => {
                // 初始化激活时没有动效
                this.setTabStyle(enableAnimate);
            }, 0);
        }
    }
    deActiveOthers(selectTab) {
        this.tabs.forEach((tab) => {
            if (tab.active && tab !== selectTab) {
                this.setActiveValue(tab, false);
            }
        });
    }
    /**
     * @ignore
     */
    click(tab) {
        if (!tab.disabled && !tab.active) {
            this.setActiveValue(tab, true);
            this.activeTab(tab, true);
        }
    }
    // 删除当前激活状态的tab后，需要激活下一个active tab
    getNewActiveIndex(index, length) {
        // 如果删除的当前激活状态的tab是最后一个，
        // 那么下一个激活的tab就是从右到左第一个不是禁用的tab
        if (index === length - 1) {
            for (let i = index - 1; i >= 0; i--) {
                if (!this.tabs[i].disabled) {
                    return i;
                }
            }
            // 如果删除的当前激活状态的tab不是最后一个，
            // 那么下一个激活的tab就是从左到右第一个不是禁用的tab
        }
        else {
            for (let i = index; i < this.tabs.length; i++) {
                if (!this.tabs[i].disabled) {
                    return i;
                }
            }
        }
        return -1;
    }
    // 设置页签样式
    setTabStyle(enableAnimate) {
        const targetTab = this.selectedTab && this.selectedTab.headNode.parentNode.parentNode;
        // 容错处理：没有获取到DOM时直接return；
        if (Util.isUndefined(targetTab) || !targetTab.classList.contains('ti3-tab-li')) {
            return;
        }
        // 获取该页签的偏移量
        const tagetLeft = targetTab.offsetLeft;
        // 需要显示滑动条时设置滑动条的样式及动效
        if (this.hasSlider) {
            // 修复SSR错误：ERROR TypeError: targetTab.getBoundingClientRect is not a function
            const targetWidth = typeof (targetTab.getBoundingClientRect) === 'function' ? parseFloat(targetTab.getBoundingClientRect().width
                .toFixed(2)) : 0;
            const transitionSet = enableAnimate ? 'left 0.1s ease-in-out' : 'none';
            this.tiRenderer.setStyles(this.slider.nativeElement, {
                transition: transitionSet,
                width: `${targetWidth}px`,
                left: `${tagetLeft}px`
            });
        }
        this.setTabScroll(targetTab, tagetLeft);
    }
    // 设置页签超长滑动动效
    setTabScroll(target, distance) {
        const moreWidth = this.moreRef && this.moreRef.nativeElement.offsetWidth;
        const tabsHeaderWidth = this.tabsHeaderRef && this.tabsHeaderRef.nativeElement.offsetWidth;
        const listWidth = this.tabsListRef && this.tabsListRef.nativeElement.offsetWidth;
        // 修复SSR错误：ERROR TypeError: this.tabsContainerRef.nativeElement.getBoundingClientRect is not a function
        if (typeof this.tabsContainerRef.nativeElement.getBoundingClientRect !== 'function') {
            return;
        }
        const tabsContainerClientRect = this.tabsContainerRef && this.tabsContainerRef.nativeElement.getBoundingClientRect();
        const targetClientRect = target.getBoundingClientRect();
        // 1、条件1和2：激活项能在当前屏范围内完全显示时
        // 2、尾部页签紧贴右侧时（页签动态删减，导致尾部页签没有紧贴右侧 #15412）
        // 同时满足，tabs无需滑动
        if (targetClientRect.x >= tabsContainerClientRect.x
            && targetClientRect.x <= tabsContainerClientRect.x + tabsContainerClientRect.width - moreWidth - targetClientRect.width
            && tabsHeaderWidth <= listWidth + moreWidth) {
            return;
        }
        let marginLeftDistance = distance;
        const maxDistance = this.tabsListRef.nativeElement.scrollWidth - tabsContainerClientRect.width + moreWidth;
        if (maxDistance > 0) {
            if (distance >= maxDistance) {
                marginLeftDistance = maxDistance;
            }
        }
        else {
            marginLeftDistance = 0;
        }
        this.renderer2.setStyle(this.tabsHeaderRef.nativeElement, 'transition', 'margin-left 0.1s ease-in-out');
        this.renderer2.setStyle(this.tabsHeaderRef.nativeElement, 'margin-left', -marginLeftDistance + 'px');
    }
    setActiveValue(tab, value) {
        // 双向数据绑定时，初始传入的值不合法立即修改并传出时会报错。
        // 此处参考ngModel源码setValue的处理，使用promise延后执行时序
        this.resolvedPromise.then(() => {
            tab.active = value;
            tab.activeChange.emit(value);
        });
    }
    /**
     * @ignore
     */
    trackByFn(index, item) {
        return item.headNode;
    }
    // 空间不足时，出现下拉面板
    isOverflow() {
        const headerWidth = this.tabsContainerRef.nativeElement.offsetWidth;
        const listWidth = this.tabsListRef.nativeElement.scrollWidth;
        const moreWidth = this.moreRef.nativeElement.offsetWidth;
        return headerWidth - moreWidth < listWidth;
    }
}
TiTabsComponent.decorators = [
    { type: Component, args: [{
                selector: 'ti-tabs',
                template: "<div class='ti3-tabs-container1' #tabsContainer>\r\n    <div class='ti3-tabs-header' #tabsHeader>\r\n        <ul class=\"ti3-tabs\" #tabsList [id]=\"appendId('list')\">\r\n            <li class=\"ti3-tab-li\" style='display: inline-block;'\r\n                *ngFor=\"let tab of tabs; let i = index; trackBy: trackByFn\"\r\n                [ngClass]=\"{'ti3-tab-active': tab.active, disabled: tab.disabled}\">\r\n                <a href=\"javascript:void(0);\"\r\n                    oncontextmenu=\"return false\"\r\n                    (click)=\"click(tab)\"\r\n                    [tiInclude]=\"tab.headNode\"\r\n                    [id]=\"appendId(tab.id===undefined||tab.id===''?i:tab.id+'_a')\"\r\n                    [tabindex]=\"tab.disabled ? -1 : 0\"></a>\r\n            </li>\r\n        </ul>\r\n        <span class='ti3-tab-more' (click)='showMorePanel($event)' #more [id]=\"appendId('moreicon')\">\r\n            <ti-icon name=\"accordion-unfold\" #moreIcon></ti-icon>\r\n        </span>\r\n        <div class='ti3-tab-slider-container'>\r\n            <div #slider class=\"ti3-tab-slider\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"ti3-tab-content\" #tabContentContainer>\r\n    <ng-content></ng-content>\r\n</div>\r\n<ti-droplist #droplist\r\n              [dominatorElem]=\"moreIconRef.nativeElement\"\r\n              [(ngModel)]=\"selectedTab\"\r\n              [options]='options'\r\n              [labelKey]=\"labelKey\"\r\n              [panelMaxHeight]=\"panelMaxHeight\"\r\n              [panelWidth]=\"panelWidth\"\r\n              [panelAlign]=\"panelAlign\"\r\n              [tipPosition]='tipPosition'\r\n              (ngModelChange)=\"onDroplistChange($event)\"\r\n              [id]=\"appendId('droplist')\">\r\n</ti-droplist>\r\n\r\n\r\n",
                host: {
                    '[class.ti3-tabs-container]': 'true' // 给host添加类ti-tabs-container替代之前的组件模板内部的最外层div
                },
                styles: ["::ng-deep :root{--ti-tab-dark-li-height:37px;--ti-tab-header-height:36px;--ti-tab-header-line-height:1.5;--ti-tab-second-level-header-height:28px;--ti-tab-second-level-header-line-height:calc(var(--ti-tab-second-level-header-height) - 2px);--ti-tab-second-level-header-margin-horizon:var(--ti-common-space-5x)}:host.ti3-tabs-container{display:block}.ti3-tab-content{border-top:1px solid var(--ti-tab-border-color)}.ti3-tabs{-ms-box-sizing:border-box;box-sizing:border-box;color:var(--ti-tab-header-text-color);font-size:0;height:var(--ti-tab-header-height);list-style:none;margin-bottom:0;padding-left:0;position:relative}.ti3-tabs:after,.ti3-tabs:before{-ms-box-sizing:border-box;box-sizing:border-box;content:\" \";display:table}.ti3-tabs:after{clear:both}.ti3-tabs>li{-ms-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:inline-block;font-size:var(--ti-tab-header-font-size);height:var(--ti-tab-header-height);line-height:var(--ti-tab-header-line-height);margin:0 var(--ti-common-space-5x);position:relative}.ti3-tabs>li:first-child{margin-left:0}.ti3-tabs>li>a{-ms-box-sizing:border-box;box-sizing:border-box;color:var(--ti-tab-header-text-color);display:block;height:var(--ti-tab-header-height);line-height:var(--ti-tab-header-line-height);padding:6px 0 var(--ti-common-space-2x);position:relative;text-decoration:none;transition:color .15s}.ti3-tabs>li:not(.disabled)>a:focus,.ti3-tabs>li:not(.disabled)>a:hover{border-bottom-color:transparent;color:var(--ti-tab-header-text-color-hover);outline:none;transition:color .2s}.ti3-tabs>li.ti3-tab-active:not(.disabled)>a{color:var(--ti-tab-header-text-color-active);cursor:default;font-weight:var(--ti-tab-header-text-color-active-font-weight)}.ti3-tabs>li.disabled>a{background-color:transparent;color:var(--ti-common-color-text-disabled);cursor:not-allowed}.ti3-tabs>li.disabled>a:focus{outline:none!important}.ti3-tab-slider-container{border-bottom:3px solid transparent;bottom:0;left:0;position:absolute;right:0}.ti3-tab-slider{-ms-box-sizing:border-box;border-bottom:var(--ti-tab-header-border-bottom-active);bottom:-3px;box-sizing:border-box;left:-50px;position:absolute;width:0}:host[level2] .ti3-tabs-container1{position:relative;top:1px}:host[level2] .ti3-tabs{height:var(--ti-tab-second-level-header-height)}:host[level2] .ti3-tabs .ti3-tab-li:not(:last-child):after{right:calc(-1*(var(--ti-tab-second-level-header-margin-horizon) + 1px))}:host[level2] .ti3-tabs+.ti3-tab-more+.ti3-tab-slider-container .ti3-tab-slider{border-bottom:none;display:none}:host[level2] .ti3-tabs>li{font-size:var(--ti-common-font-size-base);margin:0}:host[level2] .ti3-tabs>li,:host[level2] .ti3-tabs>li>a{height:var(--ti-tab-second-level-header-height);line-height:var(--ti-tab-second-level-header-line-height)}:host[level2] .ti3-tabs>li>a{-ms-box-sizing:border-box;border:1px solid transparent;box-sizing:border-box;color:var(--ti-tab-header-text-color);padding:0 var(--ti-common-space-3x)}:host[level2] .ti3-tabs>li:not(.disabled)>a:focus,:host[level2] .ti3-tabs>li:not(.disabled)>a:hover{color:var(--ti-tab-second-level-header-text-color-hover);outline:none}:host[level2] .ti3-tabs>li.ti3-tab-active:not(.disabled)>a{border-bottom-color:var(--ti-tab-border-color);border-color:var(--ti-tab-border-color) var(--ti-tab-border-color) var(--ti-common-color-bg-white-normal);color:var(--ti-tab-second-level-header-text-color-active);padding:0 var(--ti-common-space-3x)}:host[level2] .ti3-tabs>li.ti3-tab-active:not(.disabled),:host[level2] .ti3-tabs>li:last-child{margin-right:0}:host[level2] .ti3-tabs>li.disabled>a{background-color:transparent;color:var(--ti-common-color-text-disabled);cursor:not-allowed}:host[dark]>.ti3-tabs-container1 .ti3-tabs-header{background-color:var(--ti-tab-dark-bg-color)}:host[dark]>.ti3-tabs-container1 .ti3-tabs{height:40px;padding-top:3px}:host[dark]>.ti3-tabs-container1 .ti3-tabs .ti3-tab-li:not(:last-child):after{width:0}:host[dark]>.ti3-tabs-container1 .ti3-tabs+.ti3-tab-more{color:var(--ti-tab-dark-text-color);padding-right:20px;padding-top:3px}:host[dark]>.ti3-tabs-container1 .ti3-tabs+.ti3-tab-more:hover{color:var(--ti-common-color-bg-emphasize)}:host[dark]>.ti3-tabs-container1 .ti3-tabs+.ti3-tab-more+.ti3-tab-slider-container .ti3-tab-slider{border-bottom:none;display:none}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li{margin-left:0;margin-right:4px}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li>a{-ms-box-sizing:border-box;box-sizing:border-box;color:var(--ti-tab-dark-text-color);height:var(--ti-tab-dark-li-height);line-height:var(--ti-tab-dark-li-height);padding:0 var(--ti-tab-dark-padding-horizon);transition:background .15s ease-in}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li:not(.disabled)>a:focus,:host[dark]>.ti3-tabs-container1 .ti3-tabs>li:not(.disabled)>a:hover{background-color:var(--ti-tab-dark-bg-color-hover);border-radius:var(--ti-tab-dark-border-radius);color:var(--ti-tab-dark-text-color-hover);outline:none;transition:background .2s}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li.ti3-tab-active:not(.disabled)>a{background-color:var(--ti-tab-dark-bg-color-avtive);border-radius:var(--ti-tab-dark-border-radius);color:var(--ti-tab-dark-text-color-active);transition:background .25s}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li.disabled>a{background-color:transparent;color:var(--ti-tab-dark-color-disabled);cursor:not-allowed}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li:first-child{margin-left:20px}:host[dark]>.ti3-tabs-container1 .ti3-tabs>li:last-child{margin-right:0}:host[dark].ti3-tabs-container>.ti3-tab-content{border:none}:host[small] .ti3-tab-li{font-size:var(--ti-common-font-size-base);margin:0 var(--ti-common-space-10)}@keyframes tiFadeIn{0%{opacity:0}to{opacity:1}}.ti3-tabs{display:flex;flex-shrink:1;overflow:hidden;white-space:nowrap}.ti3-tab-more{cursor:pointer;display:none;padding-left:10px}.ti3-tab-more:hover{color:var(--ti-tab-header-text-color-hover)}.ti3-tabs-header{align-items:center;display:flex;justify-content:space-between;position:relative}.ti3-tabs-container1{overflow:hidden}.ti3-tab-head-no-outline{outline:none}"]
            },] }
];
TiTabsComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: TiRenderer },
    { type: NgZone },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
TiTabsComponent.propDecorators = {
    panelWidth: [{ type: Input }],
    panelAlign: [{ type: Input }],
    panelMaxHeight: [{ type: Input }],
    tipPosition: [{ type: Input }],
    slider: [{ type: ViewChild, args: ['slider', { static: true },] }],
    tabContentContainer: [{ type: ViewChild, args: ['tabContentContainer', { static: true },] }],
    moreRef: [{ type: ViewChild, args: ['more', { static: true },] }],
    moreIconRef: [{ type: ViewChild, args: ['moreIcon', { static: true },] }],
    tabsListRef: [{ type: ViewChild, args: ['tabsList', { static: true },] }],
    tabsHeaderRef: [{ type: ViewChild, args: ['tabsHeader', { static: true },] }],
    tabsContainerRef: [{ type: ViewChild, args: ['tabsContainer', { static: true },] }],
    dropListComp: [{ type: ViewChild, args: ['droplist', { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlUYWJzQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vQGNsb3VkL3RpbnkzL2NvbXBvbmVudHMvdGFiL1RpVGFic0NvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBR0gsU0FBUyxFQUNULFVBQVUsRUFDVixLQUFLLEVBQ0wsTUFBTSxFQUdOLFNBQVMsRUFDVCxTQUFTLEVBQ1QsTUFBTSxFQUNULE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUczQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQ2hFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUV4Qzs7Ozs7O0dBTUc7QUFTSCxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxlQUFlO0lBZ0loRCxZQUFvQixVQUFzQixFQUFVLFNBQW9CLEVBQzdELFVBQXNCLEVBQVUsSUFBWSxFQUE0QixRQUFRO1FBQ3ZGLEtBQUssQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFGYixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUM3RCxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQVUsU0FBSSxHQUFKLElBQUksQ0FBUTtRQUE0QixhQUFRLEdBQVIsUUFBUSxDQUFBO1FBaEkzRjs7Ozs7Ozs7V0FRRztRQUNNLGVBQVUsR0FBVyxPQUFPLENBQUM7UUFDdEM7Ozs7O1dBS0c7UUFDTSxlQUFVLEdBQXFCLE9BQU8sQ0FBQztRQVFoRDs7Ozs7V0FLRztRQUNNLGdCQUFXLEdBQW1CLE1BQU0sQ0FBQztRQWlDOUM7O1dBRUc7UUFDSSxh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QUFDO0lBQy9DLENBQUM7OztZQW5aSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLFNBQVM7Z0JBQ25CLDJ3REFBMEI7Z0JBRTFCLElBQUksRUFBRTtvQkFDRiw0QkFBNEIsRUFBRSxNQUFNLENBQUMsOENBQThDO2lCQUN0Rjs7YUFDSjs7O1lBL0JHLFVBQVU7WUFLVixTQUFTO1lBUUosVUFBVTtZQVhmLE1BQU07NENBK0pvRCxNQUFNLFNBQUMsUUFBUTs7O3lCQXZIeEUsS0FBSzt5QkFPTCxLQUFLOzZCQU9MLEtBQUs7MEJBT0wsS0FBSztxQkFJTCxTQUFTLFNBQUMsUUFBUSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtrQ0FJcEMsU0FBUyxTQUFDLHFCQUFxQixFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtzQkFJakQsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7MEJBSWxDLFNBQVMsU0FBQyxVQUFVLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzBCQUl0QyxTQUFTLFNBQUMsVUFBVSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTs0QkFJdEMsU0FBUyxTQUFDLFlBQVksRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7K0JBSXhDLFNBQVMsU0FBQyxlQUFlLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzJCQUkzQyxTQUFTLFNBQUMsVUFBVSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBBZnRlclZpZXdDaGVja2VkLFxyXG4gICAgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIENvbXBvbmVudCxcclxuICAgIEVsZW1lbnRSZWYsXHJcbiAgICBJbnB1dCxcclxuICAgIE5nWm9uZSxcclxuICAgIE9uSW5pdCxcclxuICAgIE9uRGVzdHJveSxcclxuICAgIFJlbmRlcmVyMixcclxuICAgIFZpZXdDaGlsZCxcclxuICAgIEluamVjdFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcblxyXG5pbXBvcnQgeyBUaVRhYkNvbXBvbmVudCB9IGZyb20gJy4vVGlUYWJDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBUaUJhc2VDb21wb25lbnQgfSBmcm9tICcuLi9iYXNlL1RpQmFzZU1vZHVsZSc7XHJcbmltcG9ydCB7IFRpUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9yZW5kZXJlci9UaVJlbmRlcmVyJztcclxuaW1wb3J0IHsgVGlEcm9wbGlzdENvbXBvbmVudCB9IGZyb20gJy4uL2Ryb3BsaXN0L1RpRHJvcGxpc3RNb2R1bGUnO1xyXG5pbXBvcnQgeyBVdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCB7IFRpUG9zaXRpb25UeXBlIH0gZnJvbSAnLi4vLi4vdXRpbHMvUG9zaXRpb24nO1xyXG4vKipcclxuICogVGlUYWJz57uE5Lu25bGe5LqO5biD5bGA57uE5Lu277yM6YCa6L+H6K+l57uE5Lu25Lqn5ZOB5Y+v5Lul5a6e546w5LiN5ZCM6KeG5Zu+55qE5YiH5o2i5Yqf6IO944CCXHJcbiAqXHJcbiAqIOWFtuWGhemDqOWMheWQqzLkuKrnu4Tku7YgVGlUYWIg5ZKMIFRpVGFiSGVhZGVyXHJcbiAqXHJcbiAqIDxleGFtcGxlLXVybD4uLi90aW55M2RlbW8vIy90YWIvdGFiLWFsbDwvZXhhbXBsZS11cmw+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAndGktdGFicycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vdGFicy5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL3RhYnMubGVzcyddLFxyXG4gICAgaG9zdDoge1xyXG4gICAgICAgICdbY2xhc3MudGkzLXRhYnMtY29udGFpbmVyXSc6ICd0cnVlJyAvLyDnu5lob3N05re75Yqg57G7dGktdGFicy1jb250YWluZXLmm7/ku6PkuYvliY3nmoTnu4Tku7bmqKHmnb/lhoXpg6jnmoTmnIDlpJblsYJkaXZcclxuICAgIH1cclxufSlcclxuZXhwb3J0IGNsYXNzIFRpVGFic0NvbXBvbmVudCBleHRlbmRzIFRpQmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQsIE9uSW5pdCwgT25EZXN0cm95IHtcclxuICAgIC8qKlxyXG4gICAgICogMS5cImp1c3RpZmllZFwiKOm7mOiupCk6IOS4i+aLieahhueahOWuveW6puS4jui+k+WFpeahhueahOWuveW6puS/neaMgeS4gOiHtO+8m1xyXG4gICAgICpcclxuICAgICAqIDIuXCJhdXRvXCI6IOS4i+aLieahhueahOWuveW6puagueaNruS4i+aLiemhueeahOWGheWuueiHquWKqOaSkeW8gO+8m1xyXG4gICAgICpcclxuICAgICAqIDMu6KGo56S65a695bqm55qE5a2X56ym5LiyOiDorr7nva7lm7rlrprnmoTkuIvmi4nmoYblrr3luqYo5LiN5bCP5LqO6L6T5YWl5qGG55qE5a695bqmKeOAguS+i+Wmgu+8mlwiMjAwcHhcIuOAglxyXG4gICAgICpcclxuICAgICAqIDEwLjAuMeaWsOWinlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBwYW5lbFdpZHRoOiBzdHJpbmcgPSAnMTAwcHgnO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpnaLmnb/lr7npvZDmlrnlvI9cclxuICAgICAqXHJcbiAgICAgKiAxMC4wLjHmlrDlop5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHBhbmVsQWxpZ246ICdsZWZ0JyB8ICdyaWdodCcgPSAncmlnaHQnO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpnaLmnb/mnIDlpKfpq5jluqZcclxuICAgICAqXHJcbiAgICAgKiAxMC4wLjHmlrDlop5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHBhbmVsTWF4SGVpZ2h0OiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOaMh+WumuS4i+aLiemhuei2hemVv+aWh+acrOaPkOekuuaWueWQkVxyXG4gICAgICpcclxuICAgICAqIDEwLjAuMeaWsOWinlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgdGlwUG9zaXRpb246IFRpUG9zaXRpb25UeXBlID0gJ2xlZnQnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIEBWaWV3Q2hpbGQoJ3NsaWRlcicsIHsgc3RhdGljOiB0cnVlIH0pIHNsaWRlcjogRWxlbWVudFJlZjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCd0YWJDb250ZW50Q29udGFpbmVyJywgeyBzdGF0aWM6IHRydWUgfSkgdGFiQ29udGVudENvbnRhaW5lcjogRWxlbWVudFJlZjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCdtb3JlJywgeyBzdGF0aWM6IHRydWUgfSkgbW9yZVJlZjogRWxlbWVudFJlZjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCdtb3JlSWNvbicsIHsgc3RhdGljOiB0cnVlIH0pIG1vcmVJY29uUmVmOiBFbGVtZW50UmVmO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIEBWaWV3Q2hpbGQoJ3RhYnNMaXN0JywgeyBzdGF0aWM6IHRydWUgfSkgdGFic0xpc3RSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZCgndGFic0hlYWRlcicsIHsgc3RhdGljOiB0cnVlIH0pIHRhYnNIZWFkZXJSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZCgndGFic0NvbnRhaW5lcicsIHsgc3RhdGljOiB0cnVlIH0pIHRhYnNDb250YWluZXJSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZCgnZHJvcGxpc3QnLCB7IHN0YXRpYzogdHJ1ZSB9KSBkcm9wTGlzdENvbXA6IFRpRHJvcGxpc3RDb21wb25lbnQ7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGxhYmVsS2V5OiBzdHJpbmcgPSAnaGVhZGVyJztcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5LiL5ouJ6aG5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvcHRpb25zOiBBcnJheTxhbnk+ID0gW107XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9ubGlzdGVuQ2xpY2s6ICgpID0+IHZvaWQ7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHdpbmRvd1Jlc2l6ZUxpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBUaVRhYnPkuK3ljIXoo7nnmoTmiYDmnInnmoQgVGlUYWJDb21wb25lbnQg6ZuG5ZCIXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0YWJzOiBBcnJheTxUaVRhYkNvbXBvbmVudD4gPSBbXTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2VsZWN0ZWRUYWI6IFRpVGFiQ29tcG9uZW50OyAvLyDlvZPliY3pgInkuK3nmoR0YWJcclxuICAgIHByaXZhdGUgaXNOb3RWaXNpYmxlSW5pdDogYm9vbGVhbiA9IGZhbHNlOyAvLyDmoIflv5fliJ3lp4vml7bmmK/lkKblj6/op4FcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogVGlUYWJDb21wb25lbnQudHPkuK3kvb/nlKhcclxuICAgICAqL1xyXG4gICAgcHVibGljIGRlc3Ryb3llZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDmmK/lkKbmmL7npLrmu5HliqjmnaFzbGlkZXLvvIjkuIDnuqfpobXnrb7mmL7npLrvvIzkuoznuqcv5pqX6Imy6aG1562+5LiN5pi+56S677yJXHJcbiAgICAgKiBUaVRhYkhlYWRlckNvbXBvbmVudC50c+S4reS9v+eUqFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaGFzU2xpZGVyOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIFRpVGFiSGVhZGVyQ29tcG9uZW50LnRz5Lit5L2/55SoXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBoZWFkZXJXaWR0aENoYW5nZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSByZXNvbHZlZFByb21pc2U6IFByb21pc2U8YW55PiA9IFByb21pc2UucmVzb2x2ZShudWxsKTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5LiL5ouJ6YCJ6aG55Y+Y5pu05pe26Kem5Y+RXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbkRyb3BsaXN0Q2hhbmdlKCRldmVudDogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50YWJzLmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5pZCA9PT0gdGhpcy5zZWxlY3RlZFRhYi5pZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmVWYWx1ZShpdGVtLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiKGl0ZW0sIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOeCueWHu+S4i+aLieaMiemSruaJk+W8gOS4i+aLiemdouadv1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2hvd01vcmVQYW5lbChldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZHJvcExpc3RDb21wLnNob3coKTtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZiwgcHJpdmF0ZSByZW5kZXJlcjI6IFJlbmRlcmVyMixcclxuICAgICAgICBwdWJsaWMgdGlSZW5kZXJlcjogVGlSZW5kZXJlciwgcHJpdmF0ZSB6b25lOiBOZ1pvbmUsIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQpIHtcclxuICAgICAgICBzdXBlcihlbGVtZW50UmVmLCByZW5kZXJlcjIpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nT25Jbml0KCk7XHJcbiAgICAgICAgLy8g5Yid5aeL5YyW5piv5ZCm5pi+56S65ruR5Yqo5p2hc2xpZGVy77yI5LiA57qn6aG1562+5pi+56S677yM5LqM57qnL+aal+iJsumhteetvuS4jeaYvuekuu+8iVxyXG4gICAgICAgIHRoaXMuaGFzU2xpZGVyID0gIXRoaXMubmF0aXZlRWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2xldmVsMicpICYmICF0aGlzLm5hdGl2ZUVsZW1lbnQuaGFzQXR0cmlidXRlKCdkYXJrJyk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nQWZ0ZXJDb250ZW50SW5pdCgpO1xyXG4gICAgICAgIGlmICh0aGlzLmhhc1NsaWRlcikge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpznpZblhYjlhYPntKDkuK1kaXNwbGF55Li6bm9uZe+8jOiOt+WPluWIsOeahOe7hOS7tueahOWuveW6puS4ujAs5YWD57Sg5LiN5Y+v6KeBXHJcbiAgICAgICAgICAgIHRoaXMuaXNOb3RWaXNpYmxlSW5pdCA9IHRoaXMubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aCA9PT0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgLy8g54K55Ye7ZG9jdW1uZXTkvJjmg6Dkv6Hmga/nqpflj6PlhbPpl61cclxuICAgICAgICAgICAgdGhpcy5vbmxpc3RlbkNsaWNrID0gdGhpcy5yZW5kZXJlcjIubGlzdGVuKHRoaXMuZG9jdW1lbnQsICdjbGljaycsICgpID0+IHRoaXMuZHJvcExpc3RDb21wLmhpZGUoKSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93UmVzaXplTGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyMi5saXN0ZW4od2luZG93LCAncmVzaXplJyxcclxuICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldE1vcmVTdHlsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGFiU3R5bGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0NoZWNrZWQoKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIubmdBZnRlclZpZXdDaGVja2VkKCk7XHJcbiAgICAgICAgLy8g5Yid5aeL56WW5YWI5YWD57Sg5LitZGlzcGxheeS4um5vbmXvvIzkuYvlkI7nrKzkuIDmrKHnlLFub25l5Y+Y5oiQ5Y+v6KeB5pe277yM6ZyA6KaB6YeN572uc2lsZGVyXHJcbiAgICAgICAgaWYgKHRoaXMuaXNOb3RWaXNpYmxlSW5pdCAmJiB0aGlzLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGggIT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRUYWJTdHlsZShmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNOb3RWaXNpYmxlSW5pdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmraTlpITmiafooYzmmZrkuo5UaVRhYkhlYWRlckNvbXBvbmVudOeahG5nQWZ0ZXJWaWV3Q2hlY2tlZFxyXG4gICAgICAgIGlmICh0aGlzLmhlYWRlcldpZHRoQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0VGFiU3R5bGUoZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLmhlYWRlcldpZHRoQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0TW9yZVN0eWxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy53aW5kb3dSZXNpemVMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZUxpc3RlbmVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm9ubGlzdGVuQ2xpY2spIHtcclxuICAgICAgICAgICAgdGhpcy5vbmxpc3RlbkNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRNb3JlU3R5bGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNPdmVyZmxvdygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIyLnNldFN0eWxlKHRoaXMubW9yZVJlZi5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIyLnNldFN0eWxlKHRoaXMubW9yZVJlZi5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdub25lJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogVGlUYWJDb21wb25lbnQudHMg5Lit6LCD55SoXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRUYWIodGFiOiBUaVRhYkNvbXBvbmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0YWIuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFicy5mb3JFYWNoKChpdGVtOiBUaVRhYkNvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmVWYWx1ZShpdGVtLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRhYnMucHVzaCh0YWIpO1xyXG4gICAgICAgIGNvbnN0IHRhYkVsZW1lbnRzOiBBcnJheTxhbnk+ID0gQXJyYXkuZnJvbSh0aGlzLnRhYkNvbnRlbnRDb250YWluZXIubmF0aXZlRWxlbWVudC5jaGlsZHJlbik7XHJcbiAgICAgICAgdGhpcy50YWJzLnNvcnQoKGE6IFRpVGFiQ29tcG9uZW50LCBiOiBUaVRhYkNvbXBvbmVudCk6IG51bWJlciA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YWJFbGVtZW50cy5pbmRleE9mKGEubmF0aXZlRWxlbWVudCkgLSB0YWJFbGVtZW50cy5pbmRleE9mKGIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCF0YWIuYWN0aXZlICYmIHRoaXMuc2VsZWN0ZWRUYWJcclxuICAgICAgICAgICAgJiYgdGFiRWxlbWVudHMuaW5kZXhPZih0YWIubmF0aXZlRWxlbWVudCkgPCB0YWJFbGVtZW50cy5pbmRleE9mKHRoaXMuc2VsZWN0ZWRUYWIubmF0aXZlRWxlbWVudCkpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRhYlN0eWxlKHRydWUpO1xyXG4gICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy50YWJzO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldE1vcmVTdHlsZSgpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBUaVRhYkNvbXBvbmVudC50cyDkuK3osIPnlKhcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZVRhYih0YWI6IFRpVGFiQ29tcG9uZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IHRoaXMudGFicy5pbmRleE9mKHRhYik7XHJcbiAgICAgICAgY29uc3QgbGVuZ3RoOiBudW1iZXIgPSB0aGlzLnRhYnMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudGFicy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZXRNb3JlU3R5bGUoKTtcclxuICAgICAgICB9LCAwKTtcclxuXHJcbiAgICAgICAgLy8g5Yig6Zmk5b2T5YmN5r+A5rS754q25oCB55qEdGFiXHJcbiAgICAgICAgaWYgKHRhYi5hY3RpdmUgJiYgbGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdBY3RpdmVJbmRleDogbnVtYmVyID0gdGhpcy5nZXROZXdBY3RpdmVJbmRleChpbmRleCwgbGVuZ3RoKTtcclxuICAgICAgICAgICAgaWYgKG5ld0FjdGl2ZUluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmVWYWx1ZSh0aGlzLnRhYnNbbmV3QWN0aXZlSW5kZXhdLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiKHRoaXMudGFic1tuZXdBY3RpdmVJbmRleF0sIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDliKDpmaTnmoTmmK/pnZ7mv4DmtLvnirbmgIHnmoR0YWIs6YKj5LmI5bCx5Zyo5Yig6Zmk5ZCO55qEdGFic+aVsOe7hOS4reafpeaJvuWJqeS4i+eahOWTquS4gOS4qnRhYuaYr+a/gOa0u+eKtuaAge+8jOWGjeiuvue9rua/gOa0u+eKtuaAge+8m1xyXG4gICAgICAgIGlmICghdGFiLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGFiU3R5bGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogVGlUYWJDb21wb25lbnQudHMg5Lit6LCD55SoXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhY3RpdmVUYWIoc2VsZWN0ZWRUYWI6IFRpVGFiQ29tcG9uZW50LCBlbmFibGVBbmltYXRlOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kZUFjdGl2ZU90aGVycyhzZWxlY3RlZFRhYik7XHJcblxyXG4gICAgICAgIHNlbGVjdGVkVGFiLmxvYWRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRUYWIgPSBzZWxlY3RlZFRhYjtcclxuXHJcbiAgICAgICAgLy8g5Y+q5pyJ5LiN5piv54Gw5YyW54q25oCB5pe277yM5omN6Kem5Y+R5YiH5o2i5Yqo5pWIXHJcbiAgICAgICAgaWYgKCFzZWxlY3RlZFRhYi5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAvLyDmt7vliqDlrprml7blmajvvIzlpITnkIZuZ0Zvcuacqua4suafk+WujOavle+8jOiOt+WPluWIsOW+l3NpbGRlcueahOS9jee9ruS4jeWHhuehrlxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIOWIneWni+WMlua/gOa0u+aXtuayoeacieWKqOaViFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUYWJTdHlsZShlbmFibGVBbmltYXRlKTtcclxuICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVBY3RpdmVPdGhlcnMoc2VsZWN0VGFiOiBUaVRhYkNvbXBvbmVudCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudGFicy5mb3JFYWNoKCh0YWI6IFRpVGFiQ29tcG9uZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0YWIuYWN0aXZlICYmIHRhYiAhPT0gc2VsZWN0VGFiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZVZhbHVlKHRhYiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjbGljayh0YWI6IFRpVGFiQ29tcG9uZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF0YWIuZGlzYWJsZWQgJiYgIXRhYi5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmVWYWx1ZSh0YWIsIHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVRhYih0YWIsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDliKDpmaTlvZPliY3mv4DmtLvnirbmgIHnmoR0YWLlkI7vvIzpnIDopoHmv4DmtLvkuIvkuIDkuKphY3RpdmUgdGFiXHJcbiAgICBwcml2YXRlIGdldE5ld0FjdGl2ZUluZGV4KGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgICAgICAvLyDlpoLmnpzliKDpmaTnmoTlvZPliY3mv4DmtLvnirbmgIHnmoR0YWLmmK/mnIDlkI7kuIDkuKrvvIxcclxuICAgICAgICAvLyDpgqPkuYjkuIvkuIDkuKrmv4DmtLvnmoR0YWLlsLHmmK/ku47lj7PliLDlt6bnrKzkuIDkuKrkuI3mmK/npoHnlKjnmoR0YWJcclxuICAgICAgICBpZiAoaW5kZXggPT09IGxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gaW5kZXggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRhYnNbaV0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlpoLmnpzliKDpmaTnmoTlvZPliY3mv4DmtLvnirbmgIHnmoR0YWLkuI3mmK/mnIDlkI7kuIDkuKrvvIxcclxuICAgICAgICAgICAgLy8g6YKj5LmI5LiL5LiA5Liq5r+A5rS755qEdGFi5bCx5piv5LuO5bem5Yiw5Y+z56ys5LiA5Liq5LiN5piv56aB55So55qEdGFiXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gaW5kZXg7IGkgPCB0aGlzLnRhYnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50YWJzW2ldLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDorr7nva7pobXnrb7moLflvI9cclxuICAgIHByaXZhdGUgc2V0VGFiU3R5bGUoZW5hYmxlQW5pbWF0ZTogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHRhcmdldFRhYjogYW55ID0gdGhpcy5zZWxlY3RlZFRhYiAmJiB0aGlzLnNlbGVjdGVkVGFiLmhlYWROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAvLyDlrrnplJnlpITnkIbvvJrmsqHmnInojrflj5bliLBET03ml7bnm7TmjqVyZXR1cm7vvJtcclxuICAgICAgICBpZiAoVXRpbC5pc1VuZGVmaW5lZCh0YXJnZXRUYWIpIHx8ICF0YXJnZXRUYWIuY2xhc3NMaXN0LmNvbnRhaW5zKCd0aTMtdGFiLWxpJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDojrflj5bor6XpobXnrb7nmoTlgY/np7vph49cclxuICAgICAgICBjb25zdCB0YWdldExlZnQ6IG51bWJlciA9IHRhcmdldFRhYi5vZmZzZXRMZWZ0O1xyXG4gICAgICAgIC8vIOmcgOimgeaYvuekuua7keWKqOadoeaXtuiuvue9rua7keWKqOadoeeahOagt+W8j+WPiuWKqOaViFxyXG4gICAgICAgIGlmICh0aGlzLmhhc1NsaWRlcikge1xyXG4gICAgICAgICAgICAvLyDkv67lpI1TU1LplJnor6/vvJpFUlJPUiBUeXBlRXJyb3I6IHRhcmdldFRhYi5nZXRCb3VuZGluZ0NsaWVudFJlY3QgaXMgbm90IGEgZnVuY3Rpb25cclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0V2lkdGg6IG51bWJlciA9IHR5cGVvZih0YXJnZXRUYWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSA9PT0gJ2Z1bmN0aW9uJyA/IHBhcnNlRmxvYXQodGFyZ2V0VGFiLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXHJcbiAgICAgICAgICAgICAgICAudG9GaXhlZCgyKSkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCB0cmFuc2l0aW9uU2V0OiBzdHJpbmcgPSBlbmFibGVBbmltYXRlID8gJ2xlZnQgMC4xcyBlYXNlLWluLW91dCcgOiAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMudGlSZW5kZXJlci5zZXRTdHlsZXModGhpcy5zbGlkZXIubmF0aXZlRWxlbWVudCwge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNpdGlvblNldCxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiBgJHt0YXJnZXRXaWR0aH1weGAsXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBgJHt0YWdldExlZnR9cHhgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFRhYlNjcm9sbCh0YXJnZXRUYWIsIHRhZ2V0TGVmdCk7XHJcbiAgICB9XHJcbiAgICAvLyDorr7nva7pobXnrb7otoXplb/mu5HliqjliqjmlYhcclxuICAgIHByaXZhdGUgc2V0VGFiU2Nyb2xsKHRhcmdldDogYW55LCBkaXN0YW5jZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgbW9yZVdpZHRoOiBudW1iZXIgPSB0aGlzLm1vcmVSZWYgJiYgdGhpcy5tb3JlUmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgY29uc3QgdGFic0hlYWRlcldpZHRoOiBudW1iZXIgPSB0aGlzLnRhYnNIZWFkZXJSZWYgJiYgdGhpcy50YWJzSGVhZGVyUmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgY29uc3QgbGlzdFdpZHRoOiBudW1iZXIgPSB0aGlzLnRhYnNMaXN0UmVmICYmIHRoaXMudGFic0xpc3RSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAvLyDkv67lpI1TU1LplJnor6/vvJpFUlJPUiBUeXBlRXJyb3I6IHRoaXMudGFic0NvbnRhaW5lclJlZi5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyBub3QgYSBmdW5jdGlvblxyXG4gICAgICAgIGlmKHR5cGVvZiB0aGlzLnRhYnNDb250YWluZXJSZWYubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09ICdmdW5jdGlvbicpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHRhYnNDb250YWluZXJDbGllbnRSZWN0OiBhbnkgPSB0aGlzLnRhYnNDb250YWluZXJSZWYgJiYgdGhpcy50YWJzQ29udGFpbmVyUmVmLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0Q2xpZW50UmVjdDogYW55ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIC8vIDHjgIHmnaHku7Yx5ZKMMu+8mua/gOa0u+mhueiDveWcqOW9k+WJjeWxj+iMg+WbtOWGheWujOWFqOaYvuekuuaXtlxyXG4gICAgICAgIC8vIDLjgIHlsL7pg6jpobXnrb7ntKfotLTlj7Pkvqfml7bvvIjpobXnrb7liqjmgIHliKDlh4/vvIzlr7zoh7TlsL7pg6jpobXnrb7msqHmnInntKfotLTlj7PkvqcgIzE1NDEy77yJXHJcbiAgICAgICAgLy8g5ZCM5pe25ruh6Laz77yMdGFic+aXoOmcgOa7keWKqFxyXG4gICAgICAgIGlmICh0YXJnZXRDbGllbnRSZWN0LnggPj0gdGFic0NvbnRhaW5lckNsaWVudFJlY3QueFxyXG4gICAgICAgICAgICAmJiB0YXJnZXRDbGllbnRSZWN0LnggPD0gdGFic0NvbnRhaW5lckNsaWVudFJlY3QueCArIHRhYnNDb250YWluZXJDbGllbnRSZWN0LndpZHRoIC0gbW9yZVdpZHRoIC0gdGFyZ2V0Q2xpZW50UmVjdC53aWR0aFxyXG4gICAgICAgICAgICAmJiB0YWJzSGVhZGVyV2lkdGggPD0gbGlzdFdpZHRoICsgbW9yZVdpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBtYXJnaW5MZWZ0RGlzdGFuY2U6IG51bWJlciA9IGRpc3RhbmNlO1xyXG4gICAgICAgIGNvbnN0IG1heERpc3RhbmNlOiBudW1iZXIgPSB0aGlzLnRhYnNMaXN0UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggLSB0YWJzQ29udGFpbmVyQ2xpZW50UmVjdC53aWR0aCArIG1vcmVXaWR0aDtcclxuICAgICAgICBpZiAobWF4RGlzdGFuY2UgPiAwKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA+PSBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgbWFyZ2luTGVmdERpc3RhbmNlID0gbWF4RGlzdGFuY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0RGlzdGFuY2UgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbmRlcmVyMi5zZXRTdHlsZSh0aGlzLnRhYnNIZWFkZXJSZWYubmF0aXZlRWxlbWVudCwgJ3RyYW5zaXRpb24nLCAnbWFyZ2luLWxlZnQgMC4xcyBlYXNlLWluLW91dCcpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIyLnNldFN0eWxlKHRoaXMudGFic0hlYWRlclJlZi5uYXRpdmVFbGVtZW50LCAnbWFyZ2luLWxlZnQnLCAtIG1hcmdpbkxlZnREaXN0YW5jZSArICdweCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0QWN0aXZlVmFsdWUodGFiOiBUaVRhYkNvbXBvbmVudCwgdmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgICAgICAvLyDlj4zlkJHmlbDmja7nu5Hlrprml7bvvIzliJ3lp4vkvKDlhaXnmoTlgLzkuI3lkIjms5Xnq4vljbPkv67mlLnlubbkvKDlh7rml7bkvJrmiqXplJnjgIJcclxuICAgICAgICAvLyDmraTlpITlj4LogINuZ01vZGVs5rqQ56CBc2V0VmFsdWXnmoTlpITnkIbvvIzkvb/nlKhwcm9taXNl5bu25ZCO5omn6KGM5pe25bqPXHJcbiAgICAgICAgdGhpcy5yZXNvbHZlZFByb21pc2UudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRhYi5hY3RpdmUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgdGFiLmFjdGl2ZUNoYW5nZS5lbWl0KHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRyYWNrQnlGbihpbmRleDogbnVtYmVyLCBpdGVtOiBhbnkpOiBOb2RlIHtcclxuICAgICAgICByZXR1cm4gaXRlbS5oZWFkTm9kZTtcclxuICAgIH1cclxuICAgIC8vIOepuumXtOS4jei2s+aXtu+8jOWHuueOsOS4i+aLiemdouadv1xyXG4gICAgcHJpdmF0ZSBpc092ZXJmbG93KCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IGhlYWRlcldpZHRoOiBudW1iZXIgPSB0aGlzLnRhYnNDb250YWluZXJSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgICAgICBjb25zdCBsaXN0V2lkdGg6IG51bWJlciA9IHRoaXMudGFic0xpc3RSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aDtcclxuICAgICAgICBjb25zdCBtb3JlV2lkdGg6IG51bWJlciA9IHRoaXMubW9yZVJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG5cclxuICAgICAgICByZXR1cm4gaGVhZGVyV2lkdGggLSBtb3JlV2lkdGggPCBsaXN0V2lkdGg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==