import { Component, ElementRef, Renderer2, Input, NgZone } from '@angular/core';
import { TiLeftmenuComponent } from './TiLeftmenuComponent';
import { TiLeftmenuLevel1Component } from './TiLeftmenuLevel1Component';
import { TiBaseComponent } from '../base/TiBaseModule';
/**
 * TiLeftmenuLevel2Component 是二级菜单组件，嵌在 TiLeftmenuLevel1 中使用
 */
export class TiLeftmenuLevel2Component extends TiBaseComponent {
    constructor(elementRef, renderer2, leftmenu, level1, zone) {
        super(elementRef, renderer2);
        this.level1 = level1;
        this.zone = zone;
        this.leftmenu = leftmenu;
        this.level2Ele = elementRef;
        this.renderer = renderer2;
    }
    ngOnInit() {
        this.level1.children.push(this);
    }
    ngAfterViewInit() {
        this.zone.runOutsideAngular(() => {
            this.renderer.listen(this.level2Ele.nativeElement, 'mousedown', () => {
                this.renderer.setStyle(this.level2Ele.nativeElement, 'outline', 'none');
            });
            this.renderer.listen(this.level2Ele.nativeElement, 'blur', () => {
                this.renderer.setStyle(this.level2Ele.nativeElement, 'outline', '');
            });
        });
    }
    /**
     * @ignore
     * 模板中使用，点击二级菜单项时调用
     */
    selectFn() {
        if (this.item.href) {
            this.level1.openHref(this.item.href);
            this.level2Ele.nativeElement.blur(); // 为了没有outline。
            return;
        }
        if (this.leftmenu.routable) {
            // 点击当前已经激活的item时，刷新对应路由
            if (this.leftmenu.active === this.item) {
                this.leftmenu.triggerReload(this.item);
            }
            else {
                // 点击其他项需要进行跳转，来触发路由守卫，实际是否跳转取决于路由守卫返回值。
                this.leftmenu.navigate(this.item);
            }
        }
        else {
            if (this.leftmenu.active !== this.item) {
                this.leftmenu.active = this.item;
                this.leftmenu.activeChange.emit(this.item);
            }
        }
    }
    ngOnDestroy() {
        const index = this.level1.children.indexOf(this);
        if (index !== -1) {
            this.level1.children.splice(index, 1);
        }
    }
}
TiLeftmenuLevel2Component.decorators = [
    { type: Component, args: [{
                selector: 'ti-leftmenu-level2',
                template: "<ng-content></ng-content>\r\n<!-- \u94FE\u63A5\u56FE\u6807 -->\r\n<span *ngIf=\"item.href\" class=\"ti3-icon-action-binding ti3-icon ti3-leftmenu-href\"></span>\r\n",
                host: {
                    '[class.ti3-leftmenu-level2]': 'true',
                    '[class.ti3-leftmenu-level2-active]': 'this.item === this.leftmenu.active',
                    '[attr.tabindex]': '0',
                    '[id]': 'appendId("leftmenu_level2")',
                    '(click)': 'selectFn()',
                    '(keyup.enter)': 'selectFn()'
                }
            },] }
];
TiLeftmenuLevel2Component.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: TiLeftmenuComponent },
    { type: TiLeftmenuLevel1Component },
    { type: NgZone }
];
TiLeftmenuLevel2Component.propDecorators = {
    item: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGlMZWZ0bWVudUxldmVsMkNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL0BjbG91ZC90aW55My9jb21wb25lbnRzL2xlZnRtZW51L1RpTGVmdG1lbnVMZXZlbDJDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxVQUFVLEVBQ1YsU0FBUyxFQUNULEtBQUssRUFJTCxNQUFNLEVBQ1AsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLG1CQUFtQixFQUFrQixNQUFNLHVCQUF1QixDQUFDO0FBQzVFLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN2RDs7R0FFRztBQWNILE1BQU0sT0FBTyx5QkFBMEIsU0FBUSxlQUFlO0lBdUI1RCxZQUFZLFVBQXNCLEVBQUUsU0FBb0IsRUFBRSxRQUE2QixFQUFVLE1BQWlDLEVBQ3ZILElBQVk7UUFDckIsS0FBSyxDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUZrRSxXQUFNLEdBQU4sTUFBTSxDQUEyQjtRQUN2SCxTQUFJLEdBQUosSUFBSSxDQUFRO1FBRXJCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxTQUFTLEdBQUcsVUFBVSxDQUFDO1FBQzVCLElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO0lBQzVCLENBQUM7SUFFRCxRQUFRO1FBQ04sSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFDRCxlQUFlO1FBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7WUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsV0FBVyxFQUFFLEdBQVMsRUFBRTtnQkFDdkUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQzVFLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsTUFBTSxFQUFFLEdBQVMsRUFBRTtnQkFDbEUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3hFLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0M7OztPQUdHO0lBQ0ksUUFBUTtRQUNiLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDbEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLGVBQWU7WUFFcEQsT0FBTztTQUNSO1FBRUQsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRTtZQUMxQix3QkFBd0I7WUFDeEIsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsSUFBSSxFQUFFO2dCQUNyQyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDekM7aUJBQU07Z0JBQ0wsd0NBQXdDO2dCQUN4QyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDbkM7U0FDRjthQUFNO1lBQ0wsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsSUFBSSxFQUFFO2dCQUN0QyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO2dCQUNqQyxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQzVDO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsV0FBVztRQUNOLE1BQU0sS0FBSyxHQUFXLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6RCxJQUFJLEtBQUssS0FBSyxDQUFDLENBQUMsRUFBRTtZQUNiLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDMUM7SUFDSixDQUFDOzs7WUExRkosU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxvQkFBb0I7Z0JBQzlCLGdMQUFxQztnQkFDckMsSUFBSSxFQUFFO29CQUNKLDZCQUE2QixFQUFFLE1BQU07b0JBQ3JDLG9DQUFvQyxFQUFFLG9DQUFvQztvQkFDMUUsaUJBQWlCLEVBQUUsR0FBRztvQkFDdEIsTUFBTSxFQUFFLDZCQUE2QjtvQkFDckMsU0FBUyxFQUFFLFlBQVk7b0JBQ3ZCLGVBQWUsRUFBRSxZQUFZO2lCQUM5QjthQUNGOzs7WUF6QkMsVUFBVTtZQUNWLFNBQVM7WUFPRixtQkFBbUI7WUFDbkIseUJBQXlCO1lBSGhDLE1BQU07OzttQkFvQ0wsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgUmVuZGVyZXIyLFxyXG4gIElucHV0LFxyXG4gIE9uRGVzdHJveSxcclxuICBPbkluaXQsXHJcbiAgQWZ0ZXJWaWV3SW5pdCxcclxuICBOZ1pvbmVcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVGlMZWZ0bWVudUNvbXBvbmVudCwgVGlMZWZ0bWVudUl0ZW0gfSBmcm9tICcuL1RpTGVmdG1lbnVDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBUaUxlZnRtZW51TGV2ZWwxQ29tcG9uZW50IH0gZnJvbSAnLi9UaUxlZnRtZW51TGV2ZWwxQ29tcG9uZW50JztcclxuaW1wb3J0IHsgVGlCYXNlQ29tcG9uZW50IH0gZnJvbSAnLi4vYmFzZS9UaUJhc2VNb2R1bGUnO1xyXG4vKipcclxuICogVGlMZWZ0bWVudUxldmVsMkNvbXBvbmVudCDmmK/kuoznuqfoj5zljZXnu4Tku7bvvIzltYzlnKggVGlMZWZ0bWVudUxldmVsMSDkuK3kvb/nlKhcclxuICovXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAndGktbGVmdG1lbnUtbGV2ZWwyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vbGVmdG1lbnUtbGV2ZWwyLmh0bWwnLFxyXG4gIGhvc3Q6IHtcclxuICAgICdbY2xhc3MudGkzLWxlZnRtZW51LWxldmVsMl0nOiAndHJ1ZScsXHJcbiAgICAnW2NsYXNzLnRpMy1sZWZ0bWVudS1sZXZlbDItYWN0aXZlXSc6ICd0aGlzLml0ZW0gPT09IHRoaXMubGVmdG1lbnUuYWN0aXZlJyxcclxuICAgICdbYXR0ci50YWJpbmRleF0nOiAnMCcsXHJcbiAgICAnW2lkXSc6ICdhcHBlbmRJZChcImxlZnRtZW51X2xldmVsMlwiKScsXHJcbiAgICAnKGNsaWNrKSc6ICdzZWxlY3RGbigpJyxcclxuICAgICcoa2V5dXAuZW50ZXIpJzogJ3NlbGVjdEZuKCknXHJcbiAgfVxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFRpTGVmdG1lbnVMZXZlbDJDb21wb25lbnQgZXh0ZW5kcyBUaUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgLyoqXHJcbiAgICog6K6+572u5b2T5YmN6I+c5Y2V6aG555qE5YaF5a655L+h5oGvXHJcbiAgICpcclxuICAgKiByb3V0ZXIo57G75Z6L77yaQXJyYXk8YW55Pik6IOiuvue9ruW9k+WJjemhueWvueW6lOeahOi3r+eUse+8jOS4jiBSb3V0ZXIubmF2aWdhdGXmlrnms5XnmoTnrKzkuIDkuKrlj4LmlbDkuIDmoLfvvJtcclxuICAgKlxyXG4gICAqIHJvdXRlckV4dHJhcyjnsbvlnovvvJpOYXZpZ2F0aW9uRXh0cmFzKTog6K6+572u5b2T5YmN6aG55a+55bqU6Lev55Sx55qE6YWN572u5L+h5oGv77yM5LiOIFJvdXRlci5uYXZpZ2F0ZeaWueazleeahOesrOS6jOS4quWPguaVsOS4gOagt++8m1xyXG4gICAqXHJcbiAgICogcm91dGVyTGlzdCjnsbvlnovvvJpBcnJheTxBcnJheTxhbnk+Pik6IOiuvue9ruS4gOS4qnJvdXRlcui3r+eUseWIl+ihqO+8jOW9k+ivpeWIl+ihqOS4reeahOi3r+eUseiiq+a/gOa0u+aXtu+8jOWFtuWvueW6lOeahOiPnOWNlemhueiiq+a/gOa0u+WkhOS6jumrmOS6rueKtuaAgeOAglxyXG4gICAqIOWFtuS9v+eUqOWcuuaZr+S4uuWkmuS4qui3r+eUseWvueW6lOWQjOS4gOS4quW3puS+p+iPnOWNlemhueOAglxyXG4gICAqXHJcbiAgICogaHJlZijnsbvlnovvvJpzdHJpbmcp77yadjEwLjAuMeeJiOacrOaWsOWinu+8jOS4uuivpeiPnOWNlemFjee9rumTvuaOpeWcsOWdgO+8jOeCueWHu+WQjui3r+eUsea/gOa0u+mhueS4jeWPmO+8jOWcqOaWsOmhtemdouaJk+W8gOmFjee9ruWcsOWdgOOAglxyXG4gICAqIHYxMC4wLjEgfiB2MTAuMS4z54mI5pys5a2Y5ZyoWFNT5pS75Ye7KHVybOexu+Weiynpo47pmanlkoznlKjmiLfngrnlh7vov5nkuKrpk77mjqXlubbov5vlhaXkuIDkuKrmlrDnmoTmoIfnrb7vvIzmlrDmoIfnrb7kuK3nmoTpobXpnaLlpoLmnpzlrZjlnKjmgbbmhI/ku6PnoIHvvIzlsLHlj6/ku6XlsIbljp/nvZHnq5nnm7TmjqXlr7zoiKrliLDkuIDkuKromZrlgYfnvZHnq5nnmoTlronlhajpo47pmanjgIJcclxuICAgKiB2MTAuMS40IOeJiOacrOWBmuS6huWuieWFqOWkhOeQhu+8jOW3suS4jeWtmOWcqOS4iui/sOS4pOenjeWuieWFqOmXrumimO+8jOW7uuiuruS4muWKoeWwveW/q+WNh+e6p+eJiOacrOOAglxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGl0ZW06IFRpTGVmdG1lbnVJdGVtO1xyXG4gIC8qKlxyXG4gICAqIEBpZ25vcmVcclxuICAgKi9cclxuICBwdWJsaWMgbGVmdG1lbnU6IFRpTGVmdG1lbnVDb21wb25lbnQ7XHJcbiAgcHVibGljIGxldmVsMkVsZTogYW55O1xyXG4gIHB1YmxpYyByZW5kZXJlcjogYW55O1xyXG5cclxuICBjb25zdHJ1Y3RvcihlbGVtZW50UmVmOiBFbGVtZW50UmVmLCByZW5kZXJlcjI6IFJlbmRlcmVyMiwgbGVmdG1lbnU6IFRpTGVmdG1lbnVDb21wb25lbnQsIHByaXZhdGUgbGV2ZWwxOiBUaUxlZnRtZW51TGV2ZWwxQ29tcG9uZW50XHJcbiAgICAscHJpdmF0ZSB6b25lOiBOZ1pvbmUpIHtcclxuICAgIHN1cGVyKGVsZW1lbnRSZWYsIHJlbmRlcmVyMik7XHJcbiAgICB0aGlzLmxlZnRtZW51ID0gbGVmdG1lbnU7XHJcbiAgICB0aGlzLmxldmVsMkVsZSA9IGVsZW1lbnRSZWY7XHJcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXIyO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmxldmVsMS5jaGlsZHJlbi5wdXNoKHRoaXMpO1xyXG4gIH1cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmxldmVsMkVsZS5uYXRpdmVFbGVtZW50LCAnbW91c2Vkb3duJywgKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmxldmVsMkVsZS5uYXRpdmVFbGVtZW50LCAnb3V0bGluZScsICdub25lJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmxldmVsMkVsZS5uYXRpdmVFbGVtZW50LCAnYmx1cicsICgpOiB2b2lkID0+IHtcclxuICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5sZXZlbDJFbGUubmF0aXZlRWxlbWVudCwgJ291dGxpbmUnLCAnJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuICAvKipcclxuICAgKiBAaWdub3JlXHJcbiAgICog5qih5p2/5Lit5L2/55So77yM54K55Ye75LqM57qn6I+c5Y2V6aG55pe26LCD55SoXHJcbiAgICovXHJcbiAgcHVibGljIHNlbGVjdEZuKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuaXRlbS5ocmVmKSB7XHJcbiAgICAgIHRoaXMubGV2ZWwxLm9wZW5IcmVmKHRoaXMuaXRlbS5ocmVmKTtcclxuICAgICAgdGhpcy5sZXZlbDJFbGUubmF0aXZlRWxlbWVudC5ibHVyKCk7IC8vIOS4uuS6huayoeaciW91dGxpbmXjgIJcclxuXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5sZWZ0bWVudS5yb3V0YWJsZSkge1xyXG4gICAgICAvLyDngrnlh7vlvZPliY3lt7Lnu4/mv4DmtLvnmoRpdGVt5pe277yM5Yi35paw5a+55bqU6Lev55SxXHJcbiAgICAgIGlmICh0aGlzLmxlZnRtZW51LmFjdGl2ZSA9PT0gdGhpcy5pdGVtKSB7XHJcbiAgICAgICAgIHRoaXMubGVmdG1lbnUudHJpZ2dlclJlbG9hZCh0aGlzLml0ZW0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOeCueWHu+WFtuS7lumhuemcgOimgei/m+ihjOi3s+i9rO+8jOadpeinpuWPkei3r+eUseWuiOWNq++8jOWunumZheaYr+WQpui3s+i9rOWPluWGs+S6jui3r+eUseWuiOWNq+i/lOWbnuWAvOOAglxyXG4gICAgICAgIHRoaXMubGVmdG1lbnUubmF2aWdhdGUodGhpcy5pdGVtKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHRoaXMubGVmdG1lbnUuYWN0aXZlICE9PSB0aGlzLml0ZW0pIHtcclxuICAgICAgICB0aGlzLmxlZnRtZW51LmFjdGl2ZSA9IHRoaXMuaXRlbTtcclxuICAgICAgICB0aGlzLmxlZnRtZW51LmFjdGl2ZUNoYW5nZS5lbWl0KHRoaXMuaXRlbSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IHRoaXMubGV2ZWwxLmNoaWxkcmVuLmluZGV4T2YodGhpcyk7XHJcbiAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGV2ZWwxLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19