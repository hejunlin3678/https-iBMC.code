import { Component, ElementRef, HostBinding, Input, ViewChild } from '@angular/core';
import { TiBaseComponent, TiLocale, Util } from '@cloud/tiny3';
/**
 * @ignore
 */
export class TpIdentityauthModalComponent extends TiBaseComponent {
    constructor() {
        super(...arguments);
        this.id = 'tp-identityauth';
        /**
         * 组件使用的词条，此处统一获取
         */
        this.i18n_Identityauth = TiLocale.getLocaleWords().tpIdentityauth;
        /**
         * @ignore
         * 弹窗上部的红色alert相关配置
         */
        this.errorAlert = {
            show: false,
            label: ''
        };
        /**
         * @ignore
         * 是否显示校验的错误提示
         *
         * 本组件不使用校验组件，只是引入tiErrorMsgComponent，在必要的时候显示或隐藏
         */
        this.showErrorMessage = false;
        /**
         * @ignore
         * 不同绑定方式下，组件的通用配置
         */
        this.identityAuthModel = {
            title: this.i18n_Identityauth.title,
            nowBind: this.i18n_Identityauth.bind,
            noBindTip: this.i18n_Identityauth.no_bind,
            hasBound: this.i18n_Identityauth.has_bound,
            changeBindContent: this.i18n_Identityauth.change,
            okButtonLabel: this.i18n_Identityauth.okBtn,
            cancelLabel: TiLocale.getLocaleWords().tiCommon.cancelBtn
        };
        /**
         * 验证方式为虚拟MFA的配置，表单中‘验证方式’选为'虚拟MFA'时生效
         */
        this.bindMfaModel = {
            id: 'vmfa',
            key: this.i18n_Identityauth.verification_mfa,
            label: this.i18n_Identityauth.verification_mfa,
            content: '',
            url: '',
            disabled: !TiLocale.getLocaleWords().tpSupportMFA,
            forbidChange: true,
            hideBoundContent: true,
            helpTip: this.i18n_Identityauth.mfa_label_tip,
            codeInput: {
                value: '',
                helpTip: this.i18n_Identityauth.bind_mfa_help_tip,
                placeholder: this.i18n_Identityauth.verification_placeholder
            },
            getCodeBtn: {
                label: ''
            }
        };
        /**
         * 验证方式为手机的配置，表单中‘验证方式’选为'手机'时生效
         */
        this.bindPhone = {
            id: 'sms',
            key: this.i18n_Identityauth.verification_mobile,
            label: this.i18n_Identityauth.bind_mobile,
            content: '',
            url: '',
            forbidChange: false,
            hideBoundContent: false,
            codeInput: {
                value: '',
                helpTip: '',
                placeholder: this.i18n_Identityauth.verification_placeholder
            },
            getCodeBtn: {
                label: this.i18n_Identityauth.get_verification_code
            }
        };
        /**
         * 验证方式为邮箱的配置，表单中‘验证方式’选为'邮箱'时生效
         */
        this.bindEmail = {
            id: 'email',
            key: this.i18n_Identityauth.verification_email,
            label: this.i18n_Identityauth.bind_email,
            content: '',
            disabled: !TiLocale.getLocaleWords().tpSupportEmail,
            url: '',
            forbidChange: false,
            hideBoundContent: false,
            codeInput: {
                value: '',
                helpTip: '',
                placeholder: this.i18n_Identityauth.email_verification_placeholder
            },
            getCodeBtn: {
                label: this.i18n_Identityauth.get_verification_code
            }
        };
        /**
         * @ignore
         *
         * 表单中使用的主要数据
         */
        this.formModel = {
            selected: {
                content: '',
                disabled: false,
                url: '',
                codeInput: {
                    label: this.i18n_Identityauth.verification_code,
                    value: '',
                    change: ($event) => {
                        this.formModel.selected.okBtn.disabled = !$event;
                    },
                    focus: () => {
                        this.clearValidMessage();
                    }
                },
                getCodeBtn: {
                    disabled: false,
                    isLock: false,
                    tip: '',
                    click: () => {
                        // 获取验证码
                        this.getVerificationCode();
                    }
                },
                okBtn: {
                    disabled: true,
                    click: () => {
                        this.verifyVerificationCode();
                    }
                }
            },
            verificationModel: {
                modelList: [this.bindPhone, this.bindEmail, this.bindMfaModel],
                selected: {
                    value: '',
                    change: ($event) => {
                        this.formModel.selected = TpIdentityauthModalComponent.deepMerge(this.formModel.selected, this.formModel.verificationModel.modelList.filter(item => item.id === $event)[0]);
                        this.clearValidMessage();
                    }
                }
            },
            refresh: {
                loaded: true,
                refreshTip: this.i18n_Identityauth.refresh_tip,
                click: () => {
                    this.formModel.refresh.loaded = false;
                    this.camel.get({
                        url: {
                            s: `${this.appWebPath}/rest/v3.0/OS-MFA/userinfo/{userId}`,
                            o: {
                                userId: this.userId
                            }
                        },
                        timeout: 30000
                    })
                        .then((response) => {
                        this.formModel.refresh.loaded = true;
                        this.handleUserBoundInfo(response);
                    }, () => {
                        this.formModel.refresh.loaded = true;
                        // 错误提示
                        this.requestErrorTip();
                    });
                }
            }
        };
    }
    // 获取https://console.huaweicloud.com/iam/
    static getIamEndpoint(id, endpointList) {
        const endpoint = endpointList.filter((item) => item.id === id)[0];
        if (endpoint) {
            return endpoint.endpoint;
        }
        return '';
    }
    /**
     * 对象深合并方法，不适宜数组对象
     *
     * 1.targetObj中已存在的简单属性会被覆盖；已存在的同名数组被合并；已存在的对象属性会进入内部进行合并，规则同上
     * 2.targetObj中不存在的属性直接添加
     *
     * @param targetObj 对象类型
     * @param sourceObj 对象类型
     * @returns 被合并的targetObj
     */
    static deepMerge(targetObj, sourceObj) {
        for (const key in sourceObj) {
            if (Array.isArray(sourceObj[key])) {
                targetObj[key].push(...sourceObj[key]);
            }
            else if (typeof sourceObj[key] === 'object') {
                this.deepMerge(targetObj[key], sourceObj[key]);
            }
            else {
                targetObj[key] = sourceObj[key];
            }
        }
        return targetObj;
    }
    /**
     * 初始化用户信息
     */
    handleUserBoundInfo(response) {
        const verificationModel = this.formModel.verificationModel;
        if (!response.method) {
            verificationModel.selected.value = verificationModel.selected.value || verificationModel.modelList[0].id;
        }
        verificationModel.modelList.forEach((item) => {
            if (!response.method) {
                item.content = '';
                return;
            }
            // response.method默认绑定方式
            if (response.method === item.id) {
                // 刷新时要保持原来选择
                verificationModel.selected.value = verificationModel.selected.value || item.id;
                // response.info默认绑定方式的绑定信息
                item.content = response.info[response.method] || response.info.mobile;
            }
            else if (response[item.id] || (item.id === 'sms' && response.mobile)) {
                item.content = response[item.id] || response.mobile;
            }
            // 电话号码格式需单独处理
            if (item.id === 'sms' && item.content) {
                const infoArr = item.content.split('-');
                // tslint:disable-next-line: newline-per-chained-call
                item.content = `+${infoArr[0].trim().replace(/^0+/, '')}${infoArr[1]}`;
            }
        });
        verificationModel.selected.change(verificationModel.selected.value);
    }
    getVerificationCode() {
        this.mask.show();
        const sendCodeRequestData = {
            user_id: this.userId,
            method: this.formModel.verificationModel.selected.value,
            scene: 'opsProtect'
        };
        this.camel.post({
            url: {
                s: `${this.appWebPath}/rest/v3.0/OS-MFA/sendcode`,
                o: {}
            },
            timeout: 30000,
            params: sendCodeRequestData
        })
            .then((res) => {
            this.mask.hide();
            this.formModel.selected.okBtn.disabled = !this.formModel.selected.codeInput.value;
            // 按钮灰化，倒计时 变化按钮提示
            this.changeVerificationCodeBtnTip(res.remain_counter);
            this.formModel.selected.getCodeBtn.disabled = true;
            this.countDown(60);
        }, (e) => {
            this.mask.hide();
            // 该功能已锁定,请30分钟之后再操作。
            const label = e.status === 423 ? this.i18n_Identityauth.operation_lock : this.i18n_Identityauth.system_busy;
            // 错误提示
            this.requestErrorTip(label);
        });
    }
    // 获取验证码提示变化
    changeVerificationCodeBtnTip(remainCounter) {
        if (remainCounter <= 3 && remainCounter > 0) { // 再请求获取验证码{0}次,该功能将被锁定。
            this.formModel.selected.getCodeBtn.tip =
                Util.formatEntry(this.i18n_Identityauth.get_verification_code_times, [remainCounter]);
        }
        else if (remainCounter <= 0) { // 该功能已锁定
            this.formModel.selected.getCodeBtn.isLock = true;
            this.formModel.selected.getCodeBtn.tip = this.i18n_Identityauth.operation_lock_btn_tip;
        }
        else {
            this.formModel.selected.getCodeBtn.tip = '';
        }
    }
    requestErrorTip(label) {
        this.errorAlert.label = label || this.i18n_Identityauth.system_busy;
        this.errorAlert.show = true;
    }
    // 倒计时
    countDown(s) {
        let time = s;
        time--;
        if (time >= 0) {
            this.formModel.selected.getCodeBtn.label =
                Util.formatEntry(this.i18n_Identityauth.next_get_verification_code, [time]);
            setTimeout(() => {
                this.countDown(time);
            }, 1000);
        }
        else if (this.formModel.selected.getCodeBtn.isLock) { // 已锁定
            this.formModel.selected.getCodeBtn.disabled = true;
            this.formModel.selected.getCodeBtn.label = this.i18n_Identityauth.get_verification_code;
        }
        else {
            this.formModel.selected.getCodeBtn.disabled = false;
            this.formModel.selected.getCodeBtn.label = this.i18n_Identityauth.get_verification_code;
        }
    }
    verifyVerificationCode() {
        const requestData = {
            verifycode: this.formModel.selected.codeInput.value,
            method: this.formModel.verificationModel.selected.value,
            scene: 'opsProtect'
        };
        this.mask.show();
        this.camel.post({
            url: {
                s: `${this.appWebPath}/rest/v3.0/OS-MFA/verifycode`,
                o: {}
            },
            timeout: 30000,
            params: requestData
        })
            .then((res) => {
            this.mask.hide();
            if (res.cloud_verify_ticket) {
                // 存储验证码ticket到cookie
                document.cookie =
                    `cloud_verify_ticket=${res.cloud_verify_ticket};path=/;domain=${document.domain.replace(/.+?\./, '')}`;
                // 服务业务逻辑处理
                this.successFn();
                this.close();
            }
            else {
                this.addValidMessage();
            }
        }, () => {
            this.mask.hide();
            this.addValidMessage();
        });
    }
    /**
     * 去掉input红色边框及背景，隐藏errorMessage
     */
    clearValidMessage() {
        this.showErrorMessage = false;
        const codeInputElem = this.nativeElement.querySelector('ti-item .tp-identityauth-code .tp-identityauth-code-input');
        if (codeInputElem) {
            this.renderer.removeClass(codeInputElem, 'ng-invalid');
        }
    }
    /**
     * 添加input红色边框及背景，显示errorMessage
     */
    addValidMessage() {
        this.showErrorMessage = true;
        const codeInputElem = this.nativeElement.querySelector('ti-item .tp-identityauth-code .tp-identityauth-code-input');
        if (codeInputElem) {
            this.renderer.addClass(codeInputElem, 'ng-invalid');
        }
    }
    /**
     * @ignore
     *
     * 验证码输入框回车操作
     */
    enter() {
        Util.trigger(this.OKButton.nativeElement, 'focus');
        this.formModel.selected.okBtn.click();
    }
    /**
     * @ignore
     */
    close() { }
    /**
     * @ignore
     */
    dismiss() { }
    ngOnInit() {
        this.iamUrl = TpIdentityauthModalComponent.getIamEndpoint('iam', this.serviceEndpointList);
        this.bindMfaModel.url = `${this.iamUrl}#/iam/bindMFA/${this.userId}`;
        // ctc下定制了修改绑定内容的链接
        this.bindPhone.url = this.i18n_Identityauth.changeBindContent || `${this.iamUrl}?#/modifyCredential/phone`;
        this.bindEmail.url = `${this.iamUrl}?#/modifyCredential/email`;
        // roles里有"secu_admin"时为管理员
        this.isSecuAdmin = this.roleInfoRes.roles.indexOf('secu_admin') === -1 ? false : true;
        // 管理员提示文本中有取消操作保护的链接
        if (this.isSecuAdmin) {
            // closeIdentityauth字段是ctc局点下定制的关闭二次认证的链接
            this.alertLabelLink = this.i18n_Identityauth.closeIdentityauth
                || this.iamUrl + this.i18n_Identityauth.method_alert_label_link_url;
        }
        this.handleUserBoundInfo(this.userInfoRes);
    }
}
TpIdentityauthModalComponent.decorators = [
    { type: Component, args: [{
                template: "\r\n<div class=\"tp-identityauth-alert\">\r\n    <ti-alert type=\"error\" [(open)]=\"errorAlert.show\" dismissOnTimeout=\"3000\">{{errorAlert.label}}</ti-alert>\r\n</div>\r\n<ti-modal-header>\r\n    <span>{{ 'tpIdentityauth.title' | tiTranslate }}</span>\r\n</ti-modal-header>\r\n\r\n<ti-modal-body>\r\n    <ti-alert type=\"prompt\" typeIcon=\"true\" closeIcon=\"false\" style=\"width: 100%;\">\r\n        <ng-container *ngIf=\"isSecuAdmin else notSecuAdmin\">\r\n            {{'tpIdentityauth.method_alert_label' | tiTranslate}}\r\n            <a [href]=\"alertLabelLink\" target=\"_blank\" tiNavigation rel=\"noopener noreferrer\">\r\n                {{'tpIdentityauth.method_alert_label_link' | tiTranslate}}\r\n            </a>\r\n        </ng-container>\r\n    </ti-alert>\r\n    <div class=\"tp-identityauth-body\">\r\n        <ti-formfield id=\"identityAuth\" verticalAlign=\"top\" labelWidth=\"80px\">\r\n            <!--\u9A8C\u8BC1\u65B9\u5F0F-->\r\n            <ti-item>\r\n                <ti-item-label>{{ 'tpIdentityauth.verification_method' | tiTranslate }}</ti-item-label>\r\n                <div class=\"tp-identityauth-method\"\r\n                    *ngFor=\"let item of formModel.verificationModel.modelList; let i = index\">\r\n                    <input type=\"radio\" name=\"verification_method\" [label]=\"item.key\" [value]=\"item.id\"\r\n                        [id]=\"appendId('_radio_' + i)\"\r\n                        [disabled]=\"item.disabled\" [(ngModel)]=\"formModel.verificationModel.selected.value\"\r\n                        (ngModelChange)=\"formModel.verificationModel.selected.change($event)\" tiRadio>\r\n                    <tp-helptip *ngIf=\"item.helpTip\" [iconTip]=\"item.helpTip\"></tp-helptip>\r\n                </div>\r\n            </ti-item>\r\n\r\n            <!--\u7ED1\u5B9A\u65B9\u5F0F-->\r\n            <ti-item>\r\n                <ti-item-label>{{formModel.selected.label}}</ti-item-label>\r\n                <div style=\"line-height: 32px;\">\r\n                    <span *ngIf=\"formModel.selected.content && !formModel.selected.hideBoundContent\">\r\n                        {{formModel.selected.content}}</span>\r\n                    <span *ngIf=\"formModel.selected.content && formModel.selected.hideBoundContent\">\r\n                        {{identityAuthModel.hasBound}}</span>\r\n                    <span *ngIf=\"!formModel.selected.content\">\r\n                        <span class=\"tp-identity-unbind\">{{identityAuthModel.noBindTip}}</span>\r\n                        <span>\r\n                            <a tiNavigation [href]=\"formModel.selected.url\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                                [id]=\"appendId('_identityAuth_' + formModel.selected.id)\">\r\n                                {{identityAuthModel.nowBind}}</a>\r\n                        </span>\r\n                    </span>\r\n\r\n                    <!-- \u5237\u65B0\u6309\u94AE -->\r\n                    <span class=\"tp-identity-refresh\"\r\n                        *ngIf=\"!formModel.selected.forbidChange || !formModel.selected.content\">\r\n                        <ng-container *ngIf=\"formModel.refresh.loaded else refreshUnloaded\">\r\n                            <span tiOutline [id]=\"appendId('_refresh')\" [tabindex]=\"0\"\r\n                                class=\"ti3-icon ti3-icon-refresh tp-identity-refresh-loaded\"\r\n                                [tiTip]=\"formModel.refresh.refreshTip\" (click)=\"formModel.refresh.click()\" (keydown.enter)=\"formModel.refresh.click()\">\r\n                            </span>\r\n                        </ng-container>\r\n                    </span>\r\n                    <a tiNavigation [id]=\"appendId('_changeBind')\"\r\n                        *ngIf=\"!formModel.selected.forbidChange && formModel.selected.content\"\r\n                        [href]=\"formModel.selected.url\" target=\"_blank\"\r\n                        rel=\"noopener noreferrer\">{{identityAuthModel.changeBindContent}}</a>\r\n                </div>\r\n            </ti-item>\r\n\r\n            <!--\u9A8C\u8BC1\u7801-->\r\n            <ti-item>\r\n                <ti-item-label>{{formModel.selected.codeInput.label}}</ti-item-label>\r\n                <ng-container *ngIf=\"formModel.selected.content else noBindMethod\">\r\n                    <div class=\"tp-identityauth-code\">\r\n                        <input type=\"text\" [id]=\"appendId('_input')\"\r\n                            class=\"tp-identityauth-code-input\"\r\n                            [placeholder]=\"formModel.selected.codeInput.placeholder\"\r\n                            [(ngModel)]=\"formModel.selected.codeInput.value\"\r\n                            (ngModelChange)=\"formModel.selected.codeInput.change($event)\"\r\n                            (focus)=\"formModel.selected.codeInput.focus()\"\r\n                            (keyup.enter)=\"enter()\" tiText />\r\n\r\n                        <tp-helptip class=\"tp-identityauth-code-helptip\"\r\n                            *ngIf=\"formModel.selected.codeInput.helpTip\"\r\n                            [iconTip]=\"formModel.selected.codeInput.helpTip\">\r\n                        </tp-helptip>\r\n                        <span [tiTip]=\"formModel.selected.getCodeBtn.tip\">\r\n                            <button tiButton [id]=\"appendId('_getCode')\"\r\n                                *ngIf=\"formModel.selected.getCodeBtn.label\"\r\n                                [disabled]=\"formModel.selected.getCodeBtn.disabled\"\r\n                                (click)=\"formModel.selected.getCodeBtn.click()\">\r\n                                {{formModel.selected.getCodeBtn.label}}\r\n                            </button>\r\n                        </span>\r\n                    </div>\r\n                    <ti-error-msg *ngIf=\"showErrorMessage\"\r\n                        [errorMessage]=\"'tpIdentityauth.verification_code_error' | tiTranslate\" isAppendBody=\"fasle\">\r\n                    </ti-error-msg>\r\n                </ng-container>\r\n            </ti-item>\r\n        </ti-formfield>\r\n    </div>\r\n</ti-modal-body>\r\n\r\n<ti-modal-footer>\r\n    <button tiButton type=\"button\" [id]=\"appendId('_ok_btn')\" color=\"danger\" #OKButton\r\n        [disabled]=\"formModel.selected.okBtn.disabled\"\r\n        (mousedown)=\"formModel.selected.okBtn.click()\"\r\n        (click)=\"close()\"\r\n        >{{identityAuthModel.okButtonLabel}}</button>\r\n    <button type=\"button\" tiButton [id]=\"appendId('_cancel_btn')\"\r\n        (click)=\"dismiss()\">{{identityAuthModel.cancelLabel}}</button>\r\n</ti-modal-footer>\r\n\r\n<ng-template #notSecuAdmin>\r\n    {{'tpIdentityauth.not_admin_method_alert_label' | tiTranslate}}\r\n</ng-template>\r\n\r\n<ng-template #refreshUnloaded>\r\n    <ti-loading size=\"small\"></ti-loading>\r\n</ng-template>\r\n<ng-template #noBindMethod>\r\n    <span>--</span>\r\n</ng-template>",
                styles: ["::ng-deep.ti3-modal .tp-identityauth-modal{width:570px}.tp-identityauth-alert{font-size:var(--ti-common-font-size-base);left:30px;position:absolute;right:30px;top:40px;z-index:1000}.tp-identityauth-body{margin-top:var(--ti-common-space-4x)}.tp-identityauth-body .tp-identityauth-method{display:inline-flex;margin-right:var(--ti-common-space-4x)}.tp-identityauth-body .tp-identity-unbind{color:var(--ti-common-color-error);margin-right:var(--ti-common-space-2x)}.tp-identityauth-body .tp-identity-refresh{display:inline-block;line-height:1;margin:0 var(--ti-common-space-10)}.tp-identityauth-body .tp-identity-refresh-loaded{cursor:pointer}.tp-identityauth-body .tp-identityauth-code{display:flex}.tp-identityauth-body .tp-identityauth-code .tp-identityauth-code-helptip{align-items:center;margin-right:var(--ti-common-space-2x)}.tp-identityauth-body .tp-identityauth-code .tp-identityauth-code-input{margin-right:var(--ti-common-space-2x);width:150px}"]
            },] }
];
TpIdentityauthModalComponent.propDecorators = {
    userInfoRes: [{ type: Input }],
    roleInfoRes: [{ type: Input }],
    userId: [{ type: Input }],
    serviceEndpointList: [{ type: Input }],
    mask: [{ type: Input }],
    camel: [{ type: Input }],
    successFn: [{ type: Input }],
    appWebPath: [{ type: Input }],
    id: [{ type: HostBinding, args: ['attr.id',] }],
    OKButton: [{ type: ViewChild, args: ['OKButton', { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHBJZGVudGl0eWF1dGhtb2RhbENvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL0BjbG91ZC90aW55cGx1czMvc2VydmljZXMvaWRlbnRpdHlhdXRoL1RwSWRlbnRpdHlhdXRobW9kYWxDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDckYsT0FBTyxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQy9EOztHQUVHO0FBTUgsTUFBTSxPQUFPLDRCQUE2QixTQUFRLGVBQWU7SUFMakU7O1FBZTRCLE9BQUUsR0FBVyxpQkFBaUIsQ0FBQztRQUV2RDs7V0FFRztRQUNLLHNCQUFpQixHQUFRLFFBQVEsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxjQUFjLENBQUM7UUFDMUU7OztXQUdHO1FBQ0ksZUFBVSxHQUFRO1lBQ3JCLElBQUksRUFBRSxLQUFLO1lBQ1gsS0FBSyxFQUFFLEVBQUU7U0FDWixDQUFDO1FBQ0Y7Ozs7O1dBS0c7UUFDSSxxQkFBZ0IsR0FBWSxLQUFLLENBQUM7UUFDekM7OztXQUdHO1FBQ0ksc0JBQWlCLEdBQVE7WUFDNUIsS0FBSyxFQUFFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLO1lBQ25DLE9BQU8sRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSTtZQUNwQyxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU87WUFDekMsUUFBUSxFQUFFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTO1lBQzFDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNO1lBQ2hELGFBQWEsRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSztZQUMzQyxXQUFX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aUI7bUJBQ3ZELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLDJCQUEyQixDQUFDO1NBQzNFO1FBRUQsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUMvQyxDQUFDOzs7WUF6YUosU0FBUyxTQUFDO2dCQUNQLDAxTkFBdUM7O2FBRTFDOzs7MEJBR0ksS0FBSzswQkFDTCxLQUFLO3FCQUNMLEtBQUs7a0NBQ0wsS0FBSzttQkFDTCxLQUFLO29CQUNMLEtBQUs7d0JBQ0wsS0FBSzt5QkFDTCxLQUFLO2lCQUVMLFdBQVcsU0FBQyxTQUFTO3VCQUNyQixTQUFTLFNBQUMsVUFBVSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgSG9zdEJpbmRpbmcsIElucHV0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVGlCYXNlQ29tcG9uZW50LCBUaUxvY2FsZSwgVXRpbCB9IGZyb20gJ0BjbG91ZC90aW55Myc7XHJcbi8qKlxyXG4gKiBAaWdub3JlXHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9pZGVudGl0eWF1dGhtb2RhbC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2lkZW50aXR5YXV0aG1vZGFsLmxlc3MnXVxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFRwSWRlbnRpdHlhdXRoTW9kYWxDb21wb25lbnQgZXh0ZW5kcyBUaUJhc2VDb21wb25lbnQge1xyXG4gICAgQElucHV0KCkgdXNlckluZm9SZXM6IGFueTtcclxuICAgIEBJbnB1dCgpIHJvbGVJbmZvUmVzOiBhbnk7XHJcbiAgICBASW5wdXQoKSB1c2VySWQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIHNlcnZpY2VFbmRwb2ludExpc3Q6IEFycmF5PGFueT47XHJcbiAgICBASW5wdXQoKSBtYXNrOiBhbnk7XHJcbiAgICBASW5wdXQoKSBjYW1lbDogYW55O1xyXG4gICAgQElucHV0KCkgc3VjY2Vzc0ZuOiBhbnk7XHJcbiAgICBASW5wdXQoKSBhcHBXZWJQYXRoOiBzdHJpbmc7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLmlkJykgaWQ6IHN0cmluZyA9ICd0cC1pZGVudGl0eWF1dGgnO1xyXG4gICAgQFZpZXdDaGlsZCgnT0tCdXR0b24nLCB7IHN0YXRpYzogdHJ1ZSB9KSBPS0J1dHRvbjogRWxlbWVudFJlZjtcclxuICAgIC8qKlxyXG4gICAgICog57uE5Lu25L2/55So55qE6K+N5p2h77yM5q2k5aSE57uf5LiA6I635Y+WXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaTE4bl9JZGVudGl0eWF1dGg6IGFueSA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBJZGVudGl0eWF1dGg7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOW8ueeql+S4iumDqOeahOe6ouiJsmFsZXJ055u45YWz6YWN572uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBlcnJvckFsZXJ0OiBhbnkgPSB7XHJcbiAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgbGFiZWw6ICcnXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDmmK/lkKbmmL7npLrmoKHpqoznmoTplJnor6/mj5DnpLpcclxuICAgICAqXHJcbiAgICAgKiDmnKznu4Tku7bkuI3kvb/nlKjmoKHpqoznu4Tku7bvvIzlj6rmmK/lvJXlhaV0aUVycm9yTXNnQ29tcG9uZW5077yM5Zyo5b+F6KaB55qE5pe25YCZ5pi+56S65oiW6ZqQ6JePXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG93RXJyb3JNZXNzYWdlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOS4jeWQjOe7keWumuaWueW8j+S4i++8jOe7hOS7tueahOmAmueUqOmFjee9rlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaWRlbnRpdHlBdXRoTW9kZWw6IGFueSA9IHtcclxuICAgICAgICB0aXRsZTogdGhpcy5pMThuX0lkZW50aXR5YXV0aC50aXRsZSwgLy8g6Lqr5Lu96aqM6K+BXHJcbiAgICAgICAgbm93QmluZDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5iaW5kLCAvLyDnq4vljbPnu5HlrppcclxuICAgICAgICBub0JpbmRUaXA6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgubm9fYmluZCwgLy8g5pyq57uR5a6aXHJcbiAgICAgICAgaGFzQm91bmQ6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGguaGFzX2JvdW5kLCAvLyDlt7Lnu5HlrppcclxuICAgICAgICBjaGFuZ2VCaW5kQ29udGVudDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5jaGFuZ2UsIC8vIOS/ruaUuVxyXG4gICAgICAgIG9rQnV0dG9uTGFiZWw6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgub2tCdG4sXHJcbiAgICAgICAgY2FuY2VsTGFiZWw6IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudGlDb21tb24uY2FuY2VsQnRuXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBJYW3mnI3liqHnvZHlnYBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGlhbVVybDogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDok53oibJhbGVydOeahOaWh+acrFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWxlcnRMYWJlbExpbms6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5piv5ZCm5Li6566h55CG5ZGYXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpc1NlY3VBZG1pbjogYm9vbGVhbjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOmqjOivgeaWueW8j+S4uuiZmuaLn01GQeeahOmFjee9ru+8jOihqOWNleS4reKAmOmqjOivgeaWueW8j+KAmemAieS4uifomZrmi59NRkEn5pe255Sf5pWIXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYmluZE1mYU1vZGVsOiBhbnkgPSB7XHJcbiAgICAgICAgaWQ6ICd2bWZhJyxcclxuICAgICAgICBrZXk6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgudmVyaWZpY2F0aW9uX21mYSxcclxuICAgICAgICBsYWJlbDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC52ZXJpZmljYXRpb25fbWZhLFxyXG4gICAgICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgICAgIHVybDogJycsXHJcbiAgICAgICAgZGlzYWJsZWQ6ICFUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwU3VwcG9ydE1GQSxcclxuICAgICAgICBmb3JiaWRDaGFuZ2U6IHRydWUsIC8vIOaYr+WQpuWFgeiuuOS/ruaUueW3sue7keWumuiZmuaLn21mYVxyXG4gICAgICAgIGhpZGVCb3VuZENvbnRlbnQ6IHRydWUsIC8vIOaYr+WQpumakOiXj+W3sue7keWumuWPguaVsFxyXG4gICAgICAgIGhlbHBUaXA6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgubWZhX2xhYmVsX3RpcCxcclxuICAgICAgICBjb2RlSW5wdXQ6IHsgLy8g6aqM6K+B56CB6L6T5YWl5qGGXHJcbiAgICAgICAgICAgIHZhbHVlOiAnJyxcclxuICAgICAgICAgICAgaGVscFRpcDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5iaW5kX21mYV9oZWxwX3RpcCxcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgudmVyaWZpY2F0aW9uX3BsYWNlaG9sZGVyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRDb2RlQnRuOiB7IC8vIG1mYeS4i+ayoeacieiOt+WPlumqjOivgeeggeeahOaMiemSrlxyXG4gICAgICAgICAgICBsYWJlbDogJydcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpqozor4HmlrnlvI/kuLrmiYvmnLrnmoTphY3nva7vvIzooajljZXkuK3igJjpqozor4HmlrnlvI/igJnpgInkuLon5omL5py6J+aXtueUn+aViFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJpbmRQaG9uZTogYW55ID0ge1xyXG4gICAgICAgIGlkOiAnc21zJyxcclxuICAgICAgICBrZXk6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgudmVyaWZpY2F0aW9uX21vYmlsZSxcclxuICAgICAgICBsYWJlbDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5iaW5kX21vYmlsZSxcclxuICAgICAgICBjb250ZW50OiAnJyxcclxuICAgICAgICB1cmw6ICcnLFxyXG4gICAgICAgIGZvcmJpZENoYW5nZTogZmFsc2UsXHJcbiAgICAgICAgaGlkZUJvdW5kQ29udGVudDogZmFsc2UsXHJcbiAgICAgICAgY29kZUlucHV0OiB7XHJcbiAgICAgICAgICAgIHZhbHVlOiAnJyxcclxuICAgICAgICAgICAgaGVscFRpcDogJycsXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLnZlcmlmaWNhdGlvbl9wbGFjZWhvbGRlclxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0Q29kZUJ0bjoge1xyXG4gICAgICAgICAgICBsYWJlbDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5nZXRfdmVyaWZpY2F0aW9uX2NvZGVcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpqozor4HmlrnlvI/kuLrpgq7nrrHnmoTphY3nva7vvIzooajljZXkuK3igJjpqozor4HmlrnlvI/igJnpgInkuLon6YKu566xJ+aXtueUn+aViFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJpbmRFbWFpbDogYW55ID0ge1xyXG4gICAgICAgIGlkOiAnZW1haWwnLFxyXG4gICAgICAgIGtleTogdGhpcy5pMThuX0lkZW50aXR5YXV0aC52ZXJpZmljYXRpb25fZW1haWwsXHJcbiAgICAgICAgbGFiZWw6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGguYmluZF9lbWFpbCxcclxuICAgICAgICBjb250ZW50OiAnJyxcclxuICAgICAgICBkaXNhYmxlZDogIVRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBTdXBwb3J0RW1haWwsXHJcbiAgICAgICAgdXJsOiAnJyxcclxuICAgICAgICBmb3JiaWRDaGFuZ2U6IGZhbHNlLFxyXG4gICAgICAgIGhpZGVCb3VuZENvbnRlbnQ6IGZhbHNlLFxyXG4gICAgICAgIGNvZGVJbnB1dDoge1xyXG4gICAgICAgICAgICB2YWx1ZTogJycsXHJcbiAgICAgICAgICAgIGhlbHBUaXA6ICcnLFxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogdGhpcy5pMThuX0lkZW50aXR5YXV0aC5lbWFpbF92ZXJpZmljYXRpb25fcGxhY2Vob2xkZXJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldENvZGVCdG46IHtcclxuICAgICAgICAgICAgbGFiZWw6IHRoaXMuaTE4bl9JZGVudGl0eWF1dGguZ2V0X3ZlcmlmaWNhdGlvbl9jb2RlXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICpcclxuICAgICAqIOihqOWNleS4reS9v+eUqOeahOS4u+imgeaVsOaNrlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZm9ybU1vZGVsOiBhbnkgPSB7XHJcbiAgICAgICAgc2VsZWN0ZWQ6IHtcclxuICAgICAgICAgICAgY29udGVudDogJycsXHJcbiAgICAgICAgICAgIGRpc2FibGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgdXJsOiAnJyxcclxuICAgICAgICAgICAgY29kZUlucHV0OiB7XHJcbiAgICAgICAgICAgICAgICBsYWJlbDogdGhpcy5pMThuX0lkZW50aXR5YXV0aC52ZXJpZmljYXRpb25fY29kZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiAnJyxcclxuICAgICAgICAgICAgICAgIGNoYW5nZTogKCRldmVudDogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQub2tCdG4uZGlzYWJsZWQgPSAhJGV2ZW50O1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZvY3VzOiAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclZhbGlkTWVzc2FnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXRDb2RlQnRuOiB7XHJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBpc0xvY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgdGlwOiAnJyxcclxuICAgICAgICAgICAgICAgIGNsaWNrOiAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W6aqM6K+B56CBXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRWZXJpZmljYXRpb25Db2RlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9rQnRuOiB7XHJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNsaWNrOiAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJpZnlWZXJpZmljYXRpb25Db2RlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHZlcmlmaWNhdGlvbk1vZGVsOiB7XHJcbiAgICAgICAgICAgIG1vZGVsTGlzdDogW3RoaXMuYmluZFBob25lLCB0aGlzLmJpbmRFbWFpbCwgdGhpcy5iaW5kTWZhTW9kZWxdLFxyXG4gICAgICAgICAgICBzZWxlY3RlZDoge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6ICcnLFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlOiAoJGV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQgPSBUcElkZW50aXR5YXV0aE1vZGFsQ29tcG9uZW50LmRlZXBNZXJnZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybU1vZGVsLnZlcmlmaWNhdGlvbk1vZGVsLm1vZGVsTGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLmlkID09PSAkZXZlbnQpWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVmFsaWRNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlZnJlc2g6IHtcclxuICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICByZWZyZXNoVGlwOiB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLnJlZnJlc2hfdGlwLFxyXG4gICAgICAgICAgICBjbGljazogKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwucmVmcmVzaC5sb2FkZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZWwuZ2V0KHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgczogYCR7dGhpcy5hcHBXZWJQYXRofS9yZXN0L3YzLjAvT1MtTUZBL3VzZXJpbmZvL3t1c2VySWR9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB0aGlzLnVzZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiAzMDAwMFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5yZWZyZXNoLmxvYWRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlVXNlckJvdW5kSW5mbyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5yZWZyZXNoLmxvYWRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmUmeivr+aPkOekulxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RFcnJvclRpcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDojrflj5ZodHRwczovL2NvbnNvbGUuaHVhd2VpY2xvdWQuY29tL2lhbS9cclxuICAgIHByaXZhdGUgc3RhdGljIGdldElhbUVuZHBvaW50KGlkOiBzdHJpbmcsIGVuZHBvaW50TGlzdDogQXJyYXk8YW55Pik6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3QgZW5kcG9pbnQ6IGFueSA9IGVuZHBvaW50TGlzdC5maWx0ZXIoKGl0ZW06IGFueSkgPT4gaXRlbS5pZCA9PT0gaWQpWzBdO1xyXG4gICAgICAgIGlmIChlbmRwb2ludCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZW5kcG9pbnQuZW5kcG9pbnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWvueixoea3seWQiOW5tuaWueazle+8jOS4jemAguWunOaVsOe7hOWvueixoVxyXG4gICAgICpcclxuICAgICAqIDEudGFyZ2V0T2Jq5Lit5bey5a2Y5Zyo55qE566A5Y2V5bGe5oCn5Lya6KKr6KaG55uW77yb5bey5a2Y5Zyo55qE5ZCM5ZCN5pWw57uE6KKr5ZCI5bm277yb5bey5a2Y5Zyo55qE5a+56LGh5bGe5oCn5Lya6L+b5YWl5YaF6YOo6L+b6KGM5ZCI5bm277yM6KeE5YiZ5ZCM5LiKXHJcbiAgICAgKiAyLnRhcmdldE9iauS4reS4jeWtmOWcqOeahOWxnuaAp+ebtOaOpea3u+WKoFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0YXJnZXRPYmog5a+56LGh57G75Z6LXHJcbiAgICAgKiBAcGFyYW0gc291cmNlT2JqIOWvueixoeexu+Wei1xyXG4gICAgICogQHJldHVybnMg6KKr5ZCI5bm255qEdGFyZ2V0T2JqXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc3RhdGljIGRlZXBNZXJnZSh0YXJnZXRPYmo6IE9iamVjdCwgc291cmNlT2JqOiBPYmplY3QpOiBhbnkge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNvdXJjZU9iaikge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2VPYmpba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldE9ialtrZXldLnB1c2goLi4uc291cmNlT2JqW2tleV0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBzb3VyY2VPYmpba2V5XSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVlcE1lcmdlKHRhcmdldE9ialtrZXldLCBzb3VyY2VPYmpba2V5XSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRPYmpba2V5XSA9IHNvdXJjZU9ialtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGFyZ2V0T2JqO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbnlKjmiLfkv6Hmga9cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBoYW5kbGVVc2VyQm91bmRJbmZvKHJlc3BvbnNlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25Nb2RlbDogYW55ID0gdGhpcy5mb3JtTW9kZWwudmVyaWZpY2F0aW9uTW9kZWw7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5tZXRob2QpIHtcclxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uTW9kZWwuc2VsZWN0ZWQudmFsdWUgPSB2ZXJpZmljYXRpb25Nb2RlbC5zZWxlY3RlZC52YWx1ZSB8fCB2ZXJpZmljYXRpb25Nb2RlbC5tb2RlbExpc3RbMF0uaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZlcmlmaWNhdGlvbk1vZGVsLm1vZGVsTGlzdC5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5tZXRob2QpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY29udGVudCA9ICcnO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyByZXNwb25zZS5tZXRob2Tpu5jorqTnu5HlrprmlrnlvI9cclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm1ldGhvZCA9PT0gaXRlbS5pZCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5Yi35paw5pe26KaB5L+d5oyB5Y6f5p2l6YCJ5oupXHJcbiAgICAgICAgICAgICAgICB2ZXJpZmljYXRpb25Nb2RlbC5zZWxlY3RlZC52YWx1ZSA9IHZlcmlmaWNhdGlvbk1vZGVsLnNlbGVjdGVkLnZhbHVlIHx8IGl0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICAvLyByZXNwb25zZS5pbmZv6buY6K6k57uR5a6a5pa55byP55qE57uR5a6a5L+h5oGvXHJcbiAgICAgICAgICAgICAgICBpdGVtLmNvbnRlbnQgPSByZXNwb25zZS5pbmZvW3Jlc3BvbnNlLm1ldGhvZF0gfHwgcmVzcG9uc2UuaW5mby5tb2JpbGU7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2VbaXRlbS5pZF0gfHwgKGl0ZW0uaWQgPT09ICdzbXMnICYmIHJlc3BvbnNlLm1vYmlsZSkpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY29udGVudCA9IHJlc3BvbnNlW2l0ZW0uaWRdIHx8IHJlc3BvbnNlLm1vYmlsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDnlLXor53lj7fnoIHmoLzlvI/pnIDljZXni6zlpITnkIZcclxuICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09ICdzbXMnICYmIGl0ZW0uY29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5mb0FycjogQXJyYXk8YW55PiA9IGl0ZW0uY29udGVudC5zcGxpdCgnLScpO1xyXG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuZXdsaW5lLXBlci1jaGFpbmVkLWNhbGxcclxuICAgICAgICAgICAgICAgIGl0ZW0uY29udGVudCA9IGArJHtpbmZvQXJyWzBdLnRyaW0oKS5yZXBsYWNlKC9eMCsvLCAnJyl9JHtpbmZvQXJyWzFdfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmVyaWZpY2F0aW9uTW9kZWwuc2VsZWN0ZWQuY2hhbmdlKHZlcmlmaWNhdGlvbk1vZGVsLnNlbGVjdGVkLnZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFZlcmlmaWNhdGlvbkNvZGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5tYXNrLnNob3coKTtcclxuICAgICAgICBjb25zdCBzZW5kQ29kZVJlcXVlc3REYXRhOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIHVzZXJfaWQ6IHRoaXMudXNlcklkLFxyXG4gICAgICAgICAgICBtZXRob2Q6IHRoaXMuZm9ybU1vZGVsLnZlcmlmaWNhdGlvbk1vZGVsLnNlbGVjdGVkLnZhbHVlLFxyXG4gICAgICAgICAgICBzY2VuZTogJ29wc1Byb3RlY3QnXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNhbWVsLnBvc3Qoe1xyXG4gICAgICAgICAgICB1cmw6IHtcclxuICAgICAgICAgICAgICAgIHM6IGAke3RoaXMuYXBwV2ViUGF0aH0vcmVzdC92My4wL09TLU1GQS9zZW5kY29kZWAsXHJcbiAgICAgICAgICAgICAgICBvOiB7fVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aW1lb3V0OiAzMDAwMCxcclxuICAgICAgICAgICAgcGFyYW1zOiBzZW5kQ29kZVJlcXVlc3REYXRhXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2suaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQub2tCdG4uZGlzYWJsZWQgPSAhdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQuY29kZUlucHV0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgLy8g5oyJ6ZKu54Gw5YyW77yM5YCS6K6h5pe2IOWPmOWMluaMiemSruaPkOekulxyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VWZXJpZmljYXRpb25Db2RlQnRuVGlwKHJlcy5yZW1haW5fY291bnRlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnREb3duKDYwKTtcclxuICAgICAgICAgICAgfSwgKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIC8vIOivpeWKn+iDveW3sumUgeWumizor7czMOWIhumSn+S5i+WQjuWGjeaTjeS9nOOAglxyXG4gICAgICAgICAgICAgICAgY29uc3QgbGFiZWw6IHN0cmluZyA9XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdGF0dXMgPT09IDQyMyA/IHRoaXMuaTE4bl9JZGVudGl0eWF1dGgub3BlcmF0aW9uX2xvY2sgOiB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLnN5c3RlbV9idXN5O1xyXG4gICAgICAgICAgICAgICAgLy8g6ZSZ6K+v5o+Q56S6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RFcnJvclRpcChsYWJlbCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPlumqjOivgeeggeaPkOekuuWPmOWMllxyXG4gICAgcHJpdmF0ZSBjaGFuZ2VWZXJpZmljYXRpb25Db2RlQnRuVGlwKHJlbWFpbkNvdW50ZXI6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGlmIChyZW1haW5Db3VudGVyIDw9IDMgJiYgcmVtYWluQ291bnRlciA+IDApIHsgLy8g5YaN6K+35rGC6I635Y+W6aqM6K+B56CBezB95qyhLOivpeWKn+iDveWwhuiiq+mUgeWumuOAglxyXG4gICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLnRpcCA9XHJcbiAgICAgICAgICAgICAgICBVdGlsLmZvcm1hdEVudHJ5KHRoaXMuaTE4bl9JZGVudGl0eWF1dGguZ2V0X3ZlcmlmaWNhdGlvbl9jb2RlX3RpbWVzLCBbcmVtYWluQ291bnRlcl0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocmVtYWluQ291bnRlciA8PSAwKSB7IC8vIOivpeWKn+iDveW3sumUgeWumlxyXG4gICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLmlzTG9jayA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLmdldENvZGVCdG4udGlwID0gdGhpcy5pMThuX0lkZW50aXR5YXV0aC5vcGVyYXRpb25fbG9ja19idG5fdGlwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLmdldENvZGVCdG4udGlwID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVxdWVzdEVycm9yVGlwKGxhYmVsPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5lcnJvckFsZXJ0LmxhYmVsID0gbGFiZWwgfHwgdGhpcy5pMThuX0lkZW50aXR5YXV0aC5zeXN0ZW1fYnVzeTtcclxuICAgICAgICB0aGlzLmVycm9yQWxlcnQuc2hvdyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YCS6K6h5pe2XHJcbiAgICBwcml2YXRlIGNvdW50RG93bihzOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICBsZXQgdGltZTogbnVtYmVyID0gcztcclxuICAgICAgICB0aW1lLS07XHJcbiAgICAgICAgaWYgKHRpbWUgPj0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLmxhYmVsID1cclxuICAgICAgICAgICAgICAgIFV0aWwuZm9ybWF0RW50cnkodGhpcy5pMThuX0lkZW50aXR5YXV0aC5uZXh0X2dldF92ZXJpZmljYXRpb25fY29kZSwgW3RpbWVdKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50RG93bih0aW1lKTtcclxuICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLmlzTG9jaykgeyAvLyDlt7LplIHlrppcclxuICAgICAgICAgICAgdGhpcy5mb3JtTW9kZWwuc2VsZWN0ZWQuZ2V0Q29kZUJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLmdldENvZGVCdG4ubGFiZWwgPSB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLmdldF92ZXJpZmljYXRpb25fY29kZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZvcm1Nb2RlbC5zZWxlY3RlZC5nZXRDb2RlQnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLmdldENvZGVCdG4ubGFiZWwgPSB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLmdldF92ZXJpZmljYXRpb25fY29kZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB2ZXJpZnlWZXJpZmljYXRpb25Db2RlKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3REYXRhOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIHZlcmlmeWNvZGU6IHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLmNvZGVJbnB1dC52YWx1ZSwgLy8g6aqM6K+B56CB6L6T5YWl5YC8XHJcbiAgICAgICAgICAgIG1ldGhvZDogdGhpcy5mb3JtTW9kZWwudmVyaWZpY2F0aW9uTW9kZWwuc2VsZWN0ZWQudmFsdWUsIC8vIOmqjOivgeaWueW8j1xyXG4gICAgICAgICAgICBzY2VuZTogJ29wc1Byb3RlY3QnXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1hc2suc2hvdygpO1xyXG4gICAgICAgIHRoaXMuY2FtZWwucG9zdCh7XHJcbiAgICAgICAgICAgIHVybDoge1xyXG4gICAgICAgICAgICAgICAgczogYCR7dGhpcy5hcHBXZWJQYXRofS9yZXN0L3YzLjAvT1MtTUZBL3ZlcmlmeWNvZGVgLFxyXG4gICAgICAgICAgICAgICAgbzoge31cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGltZW91dDogMzAwMDAsXHJcbiAgICAgICAgICAgIHBhcmFtczogcmVxdWVzdERhdGFcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFzay5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLmNsb3VkX3ZlcmlmeV90aWNrZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlrZjlgqjpqozor4HnoIF0aWNrZXTliLBjb29raWVcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBgY2xvdWRfdmVyaWZ5X3RpY2tldD0ke3Jlcy5jbG91ZF92ZXJpZnlfdGlja2V0fTtwYXRoPS87ZG9tYWluPSR7ZG9jdW1lbnQuZG9tYWluLnJlcGxhY2UoLy4rP1xcLi8sICcnKX1gO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOacjeWKoeS4muWKoemAu+i+keWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzc0ZuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFZhbGlkTWVzc2FnZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2suaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRWYWxpZE1lc3NhZ2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWOu+aOiWlucHV057qi6Imy6L655qGG5Y+K6IOM5pmv77yM6ZqQ6JePZXJyb3JNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2xlYXJWYWxpZE1lc3NhZ2UoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zaG93RXJyb3JNZXNzYWdlID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgY29kZUlucHV0RWxlbTogRWxlbWVudCA9IHRoaXMubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCd0aS1pdGVtIC50cC1pZGVudGl0eWF1dGgtY29kZSAudHAtaWRlbnRpdHlhdXRoLWNvZGUtaW5wdXQnKTtcclxuICAgICAgICBpZiAoY29kZUlucHV0RWxlbSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKGNvZGVJbnB1dEVsZW0sICduZy1pbnZhbGlkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqBpbnB1dOe6ouiJsui+ueahhuWPiuiDjOaZr++8jOaYvuekumVycm9yTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFkZFZhbGlkTWVzc2FnZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNob3dFcnJvck1lc3NhZ2UgPSB0cnVlO1xyXG4gICAgICAgIGNvbnN0IGNvZGVJbnB1dEVsZW06IEVsZW1lbnQgPSB0aGlzLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcigndGktaXRlbSAudHAtaWRlbnRpdHlhdXRoLWNvZGUgLnRwLWlkZW50aXR5YXV0aC1jb2RlLWlucHV0Jyk7XHJcbiAgICAgICAgaWYgKGNvZGVJbnB1dEVsZW0pIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjb2RlSW5wdXRFbGVtLCAnbmctaW52YWxpZCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqXHJcbiAgICAgKiDpqozor4HnoIHovpPlhaXmoYblm57ovabmk43kvZxcclxuICAgICAqL1xyXG4gICAgcHVibGljIGVudGVyKCk6IHZvaWQge1xyXG4gICAgICAgIFV0aWwudHJpZ2dlcih0aGlzLk9LQnV0dG9uLm5hdGl2ZUVsZW1lbnQsICdmb2N1cycpO1xyXG4gICAgICAgIHRoaXMuZm9ybU1vZGVsLnNlbGVjdGVkLm9rQnRuLmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNsb3NlKCk6IHZvaWQgeyB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGRpc21pc3MoKTogdm9pZCB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmlhbVVybCA9IFRwSWRlbnRpdHlhdXRoTW9kYWxDb21wb25lbnQuZ2V0SWFtRW5kcG9pbnQoJ2lhbScsIHRoaXMuc2VydmljZUVuZHBvaW50TGlzdCk7XHJcbiAgICAgICAgdGhpcy5iaW5kTWZhTW9kZWwudXJsID0gYCR7dGhpcy5pYW1Vcmx9Iy9pYW0vYmluZE1GQS8ke3RoaXMudXNlcklkfWA7XHJcbiAgICAgICAgLy8gY3Rj5LiL5a6a5Yi25LqG5L+u5pS557uR5a6a5YaF5a6555qE6ZO+5o6lXHJcbiAgICAgICAgdGhpcy5iaW5kUGhvbmUudXJsID0gdGhpcy5pMThuX0lkZW50aXR5YXV0aC5jaGFuZ2VCaW5kQ29udGVudCB8fCBgJHt0aGlzLmlhbVVybH0/Iy9tb2RpZnlDcmVkZW50aWFsL3Bob25lYDtcclxuICAgICAgICB0aGlzLmJpbmRFbWFpbC51cmwgPSBgJHt0aGlzLmlhbVVybH0/Iy9tb2RpZnlDcmVkZW50aWFsL2VtYWlsYDtcclxuICAgICAgICAvLyByb2xlc+mHjOaciVwic2VjdV9hZG1pblwi5pe25Li6566h55CG5ZGYXHJcbiAgICAgICAgdGhpcy5pc1NlY3VBZG1pbiA9IHRoaXMucm9sZUluZm9SZXMucm9sZXMuaW5kZXhPZignc2VjdV9hZG1pbicpID09PSAtMSA/IGZhbHNlIDogdHJ1ZTtcclxuICAgICAgICAvLyDnrqHnkIblkZjmj5DnpLrmlofmnKzkuK3mnInlj5bmtojmk43kvZzkv53miqTnmoTpk77mjqVcclxuICAgICAgICBpZiAodGhpcy5pc1NlY3VBZG1pbikge1xyXG4gICAgICAgICAgICAvLyBjbG9zZUlkZW50aXR5YXV0aOWtl+auteaYr2N0Y+WxgOeCueS4i+WumuWItueahOWFs+mXreS6jOasoeiupOivgeeahOmTvuaOpVxyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TGFiZWxMaW5rID0gdGhpcy5pMThuX0lkZW50aXR5YXV0aC5jbG9zZUlkZW50aXR5YXV0aFxyXG4gICAgICAgICAgICAgICAgfHwgdGhpcy5pYW1VcmwgKyB0aGlzLmkxOG5fSWRlbnRpdHlhdXRoLm1ldGhvZF9hbGVydF9sYWJlbF9saW5rX3VybDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaGFuZGxlVXNlckJvdW5kSW5mbyh0aGlzLnVzZXJJbmZvUmVzKTtcclxuICAgIH1cclxufVxyXG4iXX0=