import { Component, ElementRef, Renderer2, TemplateRef, ViewChild } from '@angular/core';
import { TiBaseComponent, TiTipService } from '@cloud/tiny3';
import { TpGoandbackService } from '../../services/goandback/TpGoandbackService';
/**
 * 用户受限组件
 * <example-url>../tinyplus3demo/#/restrict/restrict-all</example-url>
 */
export class TpRestrictComponent extends TiBaseComponent {
    constructor(hostRef, renderer2, tipService, tpGoandbackService) {
        super(hostRef, renderer2);
        this.hostRef = hostRef;
        this.renderer2 = renderer2;
        this.tipService = tipService;
        this.tpGoandbackService = tpGoandbackService;
        /**
         * @ignore
         * alert 是否展示控制项
         */
        this.open = false;
        /**
         * @ignore
         * alert 类型
         */
        this.alertType = 'error';
        /**
         * @ignore
         * 内部alert类型图标
         */
        this.typeIcon = true;
        /**
         * @ignore
         * 内部alert关闭图标
         */
        this.closeIcon = false;
        /**
         * @ignore
         * alert 内容
         */
        this.alertContent = '';
        /**
         * @ignore
         * tipcontent 内容
         */
        this.tipContent = '';
    }
    /**
     * 显示提示块
     */
    openAlert(content) {
        if (content) {
            this.alertContent = content;
            this.open = true;
        }
        else {
            this.open = false;
        }
    }
    /**
     * 给目标元素添加tip
     */
    addTip(target, content) {
        this.tipContent = content;
        if (this.tipContentTemplate) {
            return this.tipService.create(target, {
                trigger: 'mouse',
                showFn: () => {
                    return {
                        content: this.tipContentTemplate
                    };
                }
            });
        }
    }
    /**
     * 打开弹窗
     */
    openMessage(messageOption, confirmFn) {
        let words;
        if (messageOption.firstMessage) {
            const message = this.getMessageInfo(messageOption.firstMessage);
            words = Object.assign({ firstMessageContent: message.label, firstMessageOkButtonText: message.link, path: message.href }, messageOption);
        }
        else {
            words = messageOption;
        }
        this.tpGoandbackService.open({
            words,
            confirmFn,
            // 略过url添加params处理（restrict受限组件需略过tpGoandbackService中goToUrl方法对url的处理）
            addUrlParams: false
        });
    }
    //  message 弹窗的内容和按钮需要 alert 的内容转化
    // tslint:disable-next-line: prefer-function-over-method
    getMessageInfo(content) {
        let href;
        let link;
        let matchedString;
        // 返回数据中可能没有href属性，所有正则匹配两次
        // 提取出a 标签中的所有字符
        const reg = /<a([^>]*)>(.*?)<\/a>/g;
        let regExeRes = reg.exec(content);
        while (regExeRes && reg.lastIndex !== content.length) {
            regExeRes = reg.exec(content);
        }
        if (regExeRes) {
            // 提取a属性字符中的href内容
            const reg2 = /href=['"]?([^"]*)['"]?/g;
            matchedString = regExeRes[0];
            link = regExeRes[2];
            // 提取 href 的值
            const attrsStr = regExeRes[1];
            const regExeRes2 = reg2.exec(attrsStr);
            href = regExeRes2 ? regExeRes2[1] : '';
        }
        return {
            label: content.replace(matchedString, ''),
            link,
            href
        };
    }
}
TpRestrictComponent.decorators = [
    { type: Component, args: [{
                selector: 'tp-restrict',
                template: "<ti-alert\r\n    [type]=\"alertType\"\r\n    [closeIcon]=\"closeIcon\"\r\n    [typeIcon]=\"typeIcon\"\r\n    [open]=\"open\"\r\n    [id]=\"appendId('restrict_alert')\"\r\n    >\r\n    <ng-container>\r\n        <span [id]=\"appendId('content')\" [innerHTML]=\"alertContent\"></span>\r\n    </ng-container>\r\n</ti-alert>\r\n\r\n<!-- tip \u63D0\u793A\u5185\u5BB9\uFF0C\u56E0\u4E3A\u5B57\u7B26\u4E32\u4E2D\u6709a\u94FE\u63A5\u6240\u4EE5\u4F7F\u7528\u4E86\u6A21\u677F -->\r\n<ng-template #tipContentTemplate >\r\n    <ng-container>\r\n        <span [innerHTML]=\"tipContent\"></span>\r\n    </ng-container>\r\n</ng-template>\r\n",
                styles: [".tp-link-no-decoration{color:var(--ti-common-color-text-link);cursor:pointer;text-decoration:none}.tp-link-no-decoration:hover{color:var(--tp-link-no-decoration-color-hover);text-decoration:var(--tp-link-no-decoration-text-decoration)}:host{display:block}:host ::ng-deep ti-alert{width:100%}:host ::ng-deep ti-alert a{color:var(--ti-common-color-text-link);cursor:pointer;text-decoration:none}:host ::ng-deep ti-alert a:hover{color:var(--tp-link-no-decoration-color-hover);text-decoration:var(--tp-link-no-decoration-text-decoration)}"]
            },] }
];
TpRestrictComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: TiTipService },
    { type: TpGoandbackService }
];
TpRestrictComponent.propDecorators = {
    tipContentTemplate: [{ type: ViewChild, args: ['tipContentTemplate', { static: false },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHBSZXN0cmljdENvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL0BjbG91ZC90aW55cGx1czMvY29tcG9uZW50cy9yZXN0cmljdC9UcFJlc3RyaWN0Q29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pGLE9BQU8sRUFBRSxlQUFlLEVBQXdCLFlBQVksRUFBaUIsTUFBTSxjQUFjLENBQUM7QUFDbEcsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFZakY7OztHQUdHO0FBTUgsTUFBTSxPQUFPLG1CQUFvQixTQUFRLGVBQWU7SUF1Q3BELFlBQ2MsT0FBbUIsRUFDbkIsU0FBb0IsRUFDdEIsVUFBd0IsRUFDeEIsa0JBQXNDO1FBRTlDLEtBQUssQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFMaEIsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQUNuQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3RCLGVBQVUsR0FBVixVQUFVLENBQWM7UUFDeEIsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQW5DbEQ7OztXQUdHO1FBQ0ksU0FBSSxHQUFZLEtBQUssQ0FBQztRQUM3Qjs7O1dBR0c7UUFDSSxjQUFTLEdBQVcsT0FBTyxDQUFDO1FBQ25DOzs7V0FHRztRQUNJLGFBQVEsR0FBWSxJQUFJLENBQUM7UUFDaEM7OztXQUdHO1FBQ0ksY0FBUyxHQUFZLEtBQUssQ0FBQztRQUNsQzs7O1dBR0c7UUFDSSxpQkFBWSxHQUFXLEVBQUUsQ0FBQztRQUNqQzs7O1dBR0c7UUFDSSxlQUFVLEdBQVcsRUFBRSxDQUFDO0lBUy9CLENBQUM7SUFFRDs7T0FFRztJQUNJLFNBQVMsQ0FBQyxPQUFnQjtRQUM3QixJQUFJLE9BQU8sRUFBRTtZ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MkJ0QixTQUFTLFNBQUMsb0JBQW9CLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBSZW5kZXJlcjIsIFRlbXBsYXRlUmVmLCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVGlCYXNlQ29tcG9uZW50LCBUaU1vZGFsUmVmLCBUaVRpcFJlZiwgVGlUaXBTZXJ2aWNlLCBUaVRpcFNob3dJbmZvIH0gZnJvbSAnQGNsb3VkL3RpbnkzJztcclxuaW1wb3J0IHsgVHBHb2FuZGJhY2tTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZ29hbmRiYWNrL1RwR29hbmRiYWNrU2VydmljZSc7XHJcblxyXG4vKipcclxuICogQGlnbm9yZVxyXG4gKiDlhoXpg6jkvb/nlKhcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVHBSZXN0cmljdE1lc3NhZ2Uge1xyXG4gICAgbGFiZWw6IHN0cmluZztcclxuICAgIGhyZWY6IHN0cmluZztcclxuICAgIGxpbms6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIOeUqOaIt+WPl+mZkOe7hOS7tlxyXG4gKiA8ZXhhbXBsZS11cmw+Li4vdGlueXBsdXMzZGVtby8jL3Jlc3RyaWN0L3Jlc3RyaWN0LWFsbDwvZXhhbXBsZS11cmw+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAndHAtcmVzdHJpY3QnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3Jlc3RyaWN0Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vcmVzdHJpY3QubGVzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUcFJlc3RyaWN0Q29tcG9uZW50IGV4dGVuZHMgVGlCYXNlQ29tcG9uZW50IHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIHRpcCDlhoXlrrl0ZW1wbGF0ZVxyXG4gICAgICovXHJcbiAgICBAVmlld0NoaWxkKCd0aXBDb250ZW50VGVtcGxhdGUnLCB7IHN0YXRpYzogZmFsc2UgfSkgdGlwQ29udGVudFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogYWxlcnQg5piv5ZCm5bGV56S65o6n5Yi26aG5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvcGVuOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIGFsZXJ0IOexu+Wei1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWxlcnRUeXBlOiBzdHJpbmcgPSAnZXJyb3InO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlhoXpg6hhbGVydOexu+Wei+Wbvuagh1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdHlwZUljb246IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlhoXpg6hhbGVydOWFs+mXreWbvuagh1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2xvc2VJY29uOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIGFsZXJ0IOWGheWuuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWxlcnRDb250ZW50OiBzdHJpbmcgPSAnJztcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogdGlwY29udGVudCDlhoXlrrlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRpcENvbnRlbnQ6IHN0cmluZyA9ICcnO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByb3RlY3RlZCBob3N0UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByb3RlY3RlZCByZW5kZXJlcjI6IFJlbmRlcmVyMixcclxuICAgICAgICBwcml2YXRlIHRpcFNlcnZpY2U6IFRpVGlwU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIHRwR29hbmRiYWNrU2VydmljZTogVHBHb2FuZGJhY2tTZXJ2aWNlXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcihob3N0UmVmLCByZW5kZXJlcjIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pi+56S65o+Q56S65Z2XXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvcGVuQWxlcnQoY29udGVudD86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGlmIChjb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRDb250ZW50ID0gY29udGVudDtcclxuICAgICAgICAgICAgdGhpcy5vcGVuID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnu5nnm67moIflhYPntKDmt7vliqB0aXBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZFRpcCh0YXJnZXQ6IEhUTUxFbGVtZW50LCBjb250ZW50OiBzdHJpbmcpOiBUaVRpcFJlZiB7XHJcbiAgICAgICAgdGhpcy50aXBDb250ZW50ID0gY29udGVudDtcclxuICAgICAgICBpZiAodGhpcy50aXBDb250ZW50VGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGlwU2VydmljZS5jcmVhdGUodGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnbW91c2UnLFxyXG4gICAgICAgICAgICAgICAgc2hvd0ZuOiAoKTogVGlUaXBTaG93SW5mbyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogdGhpcy50aXBDb250ZW50VGVtcGxhdGVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOW8ueeql1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb3Blbk1lc3NhZ2UobWVzc2FnZU9wdGlvbjogYW55LCBjb25maXJtRm4/OiAoaW5zdGFuY2VzOiBUaU1vZGFsUmVmLCBvcGVuQWxlcnRGbjogRnVuY3Rpb24pID0+IHZvaWQpOiB2b2lkIHtcclxuICAgICAgICBsZXQgd29yZHM6IGFueTtcclxuICAgICAgICBpZiAobWVzc2FnZU9wdGlvbi5maXJzdE1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZTogVHBSZXN0cmljdE1lc3NhZ2UgPSB0aGlzLmdldE1lc3NhZ2VJbmZvKG1lc3NhZ2VPcHRpb24uZmlyc3RNZXNzYWdlKTtcclxuXHJcbiAgICAgICAgICAgIHdvcmRzID0ge1xyXG4gICAgICAgICAgICAgICAgZmlyc3RNZXNzYWdlQ29udGVudDogbWVzc2FnZS5sYWJlbCxcclxuICAgICAgICAgICAgICAgIGZpcnN0TWVzc2FnZU9rQnV0dG9uVGV4dDogbWVzc2FnZS5saW5rLFxyXG4gICAgICAgICAgICAgICAgcGF0aDogbWVzc2FnZS5ocmVmLFxyXG4gICAgICAgICAgICAgICAgLi4ubWVzc2FnZU9wdGlvblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdvcmRzID0gbWVzc2FnZU9wdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50cEdvYW5kYmFja1NlcnZpY2Uub3Blbih7XHJcbiAgICAgICAgICAgIHdvcmRzLFxyXG4gICAgICAgICAgICBjb25maXJtRm4sXHJcbiAgICAgICAgICAgIC8vIOeVpei/h3VybOa3u+WKoHBhcmFtc+WkhOeQhu+8iHJlc3RyaWN05Y+X6ZmQ57uE5Lu26ZyA55Wl6L+HdHBHb2FuZGJhY2tTZXJ2aWNl5LitZ29Ub1VybOaWueazleWvuXVybOeahOWkhOeQhu+8iVxyXG4gICAgICAgICAgICBhZGRVcmxQYXJhbXM6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vICBtZXNzYWdlIOW8ueeql+eahOWGheWuueWSjOaMiemSrumcgOimgSBhbGVydCDnmoTlhoXlrrnovazljJZcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogcHJlZmVyLWZ1bmN0aW9uLW92ZXItbWV0aG9kXHJcbiAgICBwcml2YXRlIGdldE1lc3NhZ2VJbmZvKGNvbnRlbnQ6IHN0cmluZyk6IFRwUmVzdHJpY3RNZXNzYWdlIHtcclxuICAgICAgICBsZXQgaHJlZjogc3RyaW5nO1xyXG4gICAgICAgIGxldCBsaW5rOiBzdHJpbmc7XHJcbiAgICAgICAgbGV0IG1hdGNoZWRTdHJpbmc6IHN0cmluZztcclxuICAgICAgICAvLyDov5Tlm57mlbDmja7kuK3lj6/og73msqHmnIlocmVm5bGe5oCn77yM5omA5pyJ5q2j5YiZ5Yy56YWN5Lik5qyhXHJcbiAgICAgICAgLy8g5o+Q5Y+W5Ye6YSDmoIfnrb7kuK3nmoTmiYDmnInlrZfnrKZcclxuICAgICAgICBjb25zdCByZWc6IFJlZ0V4cCA9IC88YShbXj5dKik+KC4qPyk8XFwvYT4vZztcclxuXHJcbiAgICAgICAgbGV0IHJlZ0V4ZVJlczogUmVnRXhwRXhlY0FycmF5ID0gcmVnLmV4ZWMoY29udGVudCk7XHJcbiAgICAgICAgd2hpbGUgKHJlZ0V4ZVJlcyAmJiByZWcubGFzdEluZGV4ICE9PSBjb250ZW50Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZWdFeGVSZXMgPSByZWcuZXhlYyhjb250ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlZ0V4ZVJlcykge1xyXG4gICAgICAgICAgICAvLyDmj5Dlj5Zh5bGe5oCn5a2X56ym5Lit55qEaHJlZuWGheWuuVxyXG4gICAgICAgICAgICBjb25zdCByZWcyOiBSZWdFeHAgPSAvaHJlZj1bJ1wiXT8oW15cIl0qKVsnXCJdPy9nO1xyXG4gICAgICAgICAgICBtYXRjaGVkU3RyaW5nID0gcmVnRXhlUmVzWzBdO1xyXG4gICAgICAgICAgICBsaW5rID0gcmVnRXhlUmVzWzJdO1xyXG4gICAgICAgICAgICAvLyDmj5Dlj5YgaHJlZiDnmoTlgLxcclxuICAgICAgICAgICAgY29uc3QgYXR0cnNTdHI6IHN0cmluZyA9IHJlZ0V4ZVJlc1sxXTtcclxuICAgICAgICAgICAgY29uc3QgcmVnRXhlUmVzMjogUmVnRXhwRXhlY0FycmF5ID0gcmVnMi5leGVjKGF0dHJzU3RyKTtcclxuICAgICAgICAgICAgaHJlZiA9IHJlZ0V4ZVJlczIgPyByZWdFeGVSZXMyWzFdIDogJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsYWJlbDogY29udGVudC5yZXBsYWNlKG1hdGNoZWRTdHJpbmcsICcnKSxcclxuICAgICAgICAgICAgbGluayxcclxuICAgICAgICAgICAgaHJlZlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==