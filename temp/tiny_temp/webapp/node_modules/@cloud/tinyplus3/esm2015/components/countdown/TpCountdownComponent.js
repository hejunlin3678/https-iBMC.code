// tslint:disable-next-line: no-implicit-dependencies
import { Component, Input } from '@angular/core';
import { TiLocale, TiBaseComponent } from '@cloud/tiny3';
import { CfUtil } from '../../cfutils/CfUtil';
import { TpDatePipe } from '../../pipes/locale/TpLocaleModule';
/**
 * 资源倒计时组件
 * <example-url>../tinyplus3demo/#/countdown/countdown-all</example-url>
 */
export class TpCountdownComponent extends TiBaseComponent {
    constructor() {
        super(...arguments);
        /**
         * 是否显示资源的状态
         */
        this.showStatus = true;
        /**
         * @ignore
         * 倒计时最后显示的文本
         */
        this.countdownText = '';
        /**
         * @ignore
         * tip 的内容
         */
        this.tipContext = [];
        /**
         * @ignore
         * tip 的最大宽度
         */
        this.tipMaxWidth = '500px';
    }
    // tslint:disable-next-line: use-life-cycle-interface
    ngOnInit() {
        super.ngOnInit();
        // 生成倒计时内容
        this.generateContent();
        // 生成tip内容
        this.generateTipContent();
    }
    /**
     * 生成倒计时内容
     */
    generateContent() {
        // 时间间隔
        let timespan = '';
        // 时间信息
        let hourInfo = '';
        let minuteInfo = '';
        //  根据返回时间拼接出时间间隔  {d} 天数 {h} 小时数 {m} 分钟数
        if (this.countDownInfos) {
            if (this.countDownInfos.nextOperationRemainingDay) {
                timespan = this.countDownInfos.nextOperationRemainingDay > 1 ?
                    TiLocale.getLocaleWords().tpCountdown.day
                        .replace(/{d}/, this.countDownInfos.nextOperationRemainingDay) :
                    TiLocale.getLocaleWords().tpCountdown.day
                        .replace(/s/, '')
                        .replace(/{d}/, this.countDownInfos.nextOperationRemainingDay);
            }
            else if (this.countDownInfos.nextOperationRemainingSecond) {
                timespan = TiLocale.getLocaleWords().tpCountdown.second;
            }
            else if (this.countDownInfos.nextOperationRemainingHour) {
                hourInfo = this.countDownInfos.nextOperationRemainingHour > 1 ?
                    TiLocale.getLocaleWords().tpCountdown.hour
                        .replace(/{h}/, this.countDownInfos.nextOperationRemainingHour) :
                    TiLocale.getLocaleWords().tpCountdown.hour
                        .replace(/s/, '')
                        .replace(/{h}/, this.countDownInfos.nextOperationRemainingHour);
                minuteInfo = this.countDownInfos.nextOperationRemainingMinute > 1 ?
                    TiLocale.getLocaleWords().tpCountdown.minute
                        .replace(/{m}/, this.countDownInfos.nextOperationRemainingMinute) :
                    TiLocale.getLocaleWords().tpCountdown.minute
                        .replace(/s/, '')
                        .replace(/{m}/, this.countDownInfos.nextOperationRemainingMinute);
                timespan = hourInfo + ' ' + minuteInfo;
            }
            else if (this.countDownInfos.nextOperationRemainingMinute) {
                timespan = this.countDownInfos.nextOperationRemainingMinute > 1 ?
                    TiLocale.getLocaleWords().tpCountdown.minute.replace(/{m}/, this.countDownInfos.nextOperationRemainingMinute) :
                    TiLocale.getLocaleWords().tpCountdown.minute.replace(/s/, '').replace(/{m}/, this.countDownInfos.nextOperationRemainingMinute);
            }
        }
        // 根据状态码，得到倒计时整体字符串。 {TS} 时间间隔
        const statusKey = this.countDownCode ? this.countDownCode.slice(14) : '';
        if (TiLocale.getLocaleWords().tpCountdown[statusKey]) {
            this.countdownText = TiLocale.getLocaleWords().tpCountdown[statusKey]
                .replace(/{TS}/, timespan);
        }
        // 如果是按需正常使用，没有倒计时，只提示创建时间，单独处理 {ymdhms} 是 格式为本地化日期时间
        if (this.countDownCode === 'hws_countdown_ondemand_using') {
            this.countdownText = this.countdownText.replace(/{ymdhms}/, new TpDatePipe().transform(this.countDownTips.effTime, 'dateTime'));
        }
        // 是否展示状态
        if (!this.showStatus) {
            this.countdownText = this.countdownText.split(TiLocale.getLocaleWords().tpCountdown.spliter)
                .pop();
        }
        // 添加样式类 宽限期，冻结期，违规冻结 提示红色，正常使用，如果小于七天，提示黄色
        if (this.countDownInfos.status > 2) {
            this.nativeElement.classList.add('tp-countdown-alarm');
        }
        else if ((this.countDownCode === 'hws_countdown_period_using' || this.countDownCode === 'hws_countdown_period_toondemand')
            && this.isDayLess7()) {
            this.nativeElement.classList.add('tp-countdown-warn');
        }
    }
    // 倒计时是否小于七天
    isDayLess7() {
        return !(this.countDownInfos.nextOperationRemainingDay && this.countDownInfos.nextOperationRemainingDay > 7);
    }
    /**
     * 生成tips 内容
     */
    generateTipContent() {
        switch (this.countDownCode) {
            case 'hws_countdown_period_using':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.create_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.effTime)}`
                });
                this.tipContext.push({
                    title: ` ${TiLocale.getLocaleWords().tpCountdown.expire_time} `,
                    time: `${this.formatLocaleDateTime(this.countDownTips.expTime)}`
                });
                break;
            case 'hws_countdown_period_gracing':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.expire_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.expTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time} `,
                    time: `${this.formatLocaleDateTime(this.countDownTips.graceTime)}`
                });
                break;
            case 'hws_countdown_period_frozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.release_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.releaseTime)}`
                });
                break;
            case 'hws_countdown_period_illegalfrozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time} `,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.release_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.releaseTime)}`
                });
                break;
            case 'hws_countdown_period_policefrozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time} `,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                break;
            case 'hws_countdown_period_toondemand':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.create_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.effTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.toonneed_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.expTime)}`
                });
                break;
            case 'hws_countdown_ondemand_using':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.create_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.effTime)}`
                });
                break;
            case 'hws_countdown_ondemand_gracing':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.arrears_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.expTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.graceTime)}`
                });
                break;
            case 'hws_countdown_ondemand_frozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.release_time} `,
                    time: `${this.formatLocaleDateTime(this.countDownTips.releaseTime)}`
                });
                break;
            case 'hws_countdown_ondemand_illegalfrozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                break;
            case 'hws_countdown_ondemand_illegalfrozen_arrear':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: ` ${this.formatLocaleDateTime(this.countDownTips.frozenTime)} `
                });
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.release_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.releaseTime)}`
                });
                break;
            case 'hws_countdown_ondemand_policefrozen':
                this.tipContext.push({
                    title: `${TiLocale.getLocaleWords().tpCountdown.frozen_time}`,
                    time: `${this.formatLocaleDateTime(this.countDownTips.frozenTime)}`
                });
                break;
            default:
                break;
        }
    }
    /**
     * 日期时间戳转换成带时区的
     */
    formatLocaleDateTime(req) {
        return CfUtil.formatLocaleDateTime(req);
    }
}
TpCountdownComponent.decorators = [
    { type: Component, args: [{
                selector: 'tp-countdown',
                template: "<span [tiTip]=\"tipContent\" [tiTipContext]='tipContext' [tiTipMaxWidth]='tipMaxWidth' [id]=\"appendId('countdown_text')\">{{countdownText}}</span>\r\n<ng-template #tipContent let-context='context'>\r\n    <ng-container *ngFor=\"let item of context\">{{item.title}} {{item.time}}<br></ng-container>\r\n</ng-template>\r\n",
                styles: [".ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host{border-bottom:1px dashed var(--ti-common-color-dash-line-normal);box-sizing:border-box;color:var(--ti-common-color-text-primary);cursor:default;display:inline;font-size:var(--ti-common-font-size-base);line-height:var(--ti-common-line-height-number)}:host.tp-countdown-warn{color:var(--ti-common-color-warn-text)}:host.tp-countdown-alarm{color:var(--ti-common-color-error-text)}"]
            },] }
];
TpCountdownComponent.propDecorators = {
    showStatus: [{ type: Input }],
    countDownCode: [{ type: Input }],
    countDownInfos: [{ type: Input }],
    countDownTips: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHBDb3VudGRvd25Db21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueXBsdXMzL2NvbXBvbmVudHMvY291bnRkb3duL1RwQ291bnRkb3duQ29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHFEQUFxRDtBQUNyRCxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNqRCxPQUFPLEVBQUUsUUFBUSxFQUFFLGVBQWUsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUN6RCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDOUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBMEMvRDs7O0dBR0c7QUFPSCxNQUFNLE9BQU8sb0JBQXFCLFNBQVEsZUFBZTtJQU56RDs7UUFRSTs7V0FFRztRQUNNLGVBQVUsR0FBWSxJQUFJLENBQUM7UUFjcEM7OztXQUdHO1FBQ0ksa0JBQWEsR0FBVyxFQUFFLENBQUM7UUFDbEM7OztXQUdHO1FBQ0ksZUFBVSxHQUFRLEVBQUUsQ0FBQztRQUM1Qjs7O1dBR0c7UUFDSSxnQkFBVyxHQUFXLE9BQU8sQ0FBQztJQStNekMsQ0FBQztJQTdNRyxxREFBcUQ7SUFDckQsUUFBUTtRQUNKLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNqQixVQUFVO1FBQ1YsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3ZCLFVBQVU7UUFDVixJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBRUQ7O09BRUc7SUFDSyxlQUFlO1FBQ3BCLE9BQU87UUFDUCxJQUFJLFFBQVEsR0FBVyxFQUFFLENBQUM7UUFDMUIsT0FBTztRQUNQLElBQUksUUFBUSxHQUFXLEVBQUUsQ0FBQztRQUMxQixJQUFJLFVBQVUsR0FBVyxFQUFFLENBQUM7UUFDNUIseUNBQXlDO1FBQ3pDLElB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RUc7SUFDSyxvQkFBb0IsQ0FBQyxHQUFXO1FBQ3BDLE9BQU8sTUFBTSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzVDLENBQUM7OztZQXBQSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLGNBQWM7Z0JBQ3hCLDRVQUErQjs7YUFFbEM7Ozt5QkFPSSxLQUFLOzRCQUlMLEtBQUs7NkJBSUwsS0FBSzs0QkFJTCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1pbXBsaWNpdC1kZXBlbmRlbmNpZXNcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUaUxvY2FsZSwgVGlCYXNlQ29tcG9uZW50IH0gZnJvbSAnQGNsb3VkL3RpbnkzJztcclxuaW1wb3J0IHsgQ2ZVdGlsIH0gZnJvbSAnLi4vLi4vY2Z1dGlscy9DZlV0aWwnO1xyXG5pbXBvcnQgeyBUcERhdGVQaXBlIH0gZnJvbSAnLi4vLi4vcGlwZXMvbG9jYWxlL1RwTG9jYWxlTW9kdWxlJztcclxuXHJcbi8qXHJcbiog5YCS6K6h5pe257G75YirLCDor6bmg4Xlj4LogIPigJzkupHov5DokKXlhazlhbHmjqXlj6Por7TmmI7igJ3mlofmoaPvvIwyLjIx5LqR5pyN5Yqh5YCS6K6h5pe25L+h5oGv5p+l6K+iXHJcbiovXHJcbmV4cG9ydCB0eXBlIFRwQ291bnREb3duQ29kZSA9ICdod3NfY291bnRkb3duX3BlcmlvZF91c2luZydcclxuICAgIHwgJ2h3c19jb3VudGRvd25fcGVyaW9kX2dyYWNpbmcnXHJcbiAgICB8ICdod3NfY291bnRkb3duX3BlcmlvZF9mcm96ZW4nXHJcbiAgICB8ICdod3NfY291bnRkb3duX3BlcmlvZF9pbGxlZ2FsZnJvemVuJ1xyXG4gICAgfCAnaHdzX2NvdW50ZG93bl9wZXJpb2RfcG9saWNlZnJvemVuJ1xyXG4gICAgfCAnaHdzX2NvdW50ZG93bl9wZXJpb2RfdG9vbmRlbWFuZCdcclxuICAgIHwgJ2h3c19jb3VudGRvd25fb25kZW1hbmRfdXNpbmcnXHJcbiAgICB8ICdod3NfY291bnRkb3duX29uZGVtYW5kX2dyYWNpbmcnXHJcbiAgICB8ICdod3NfY291bnRkb3duX29uZGVtYW5kX2Zyb3plbidcclxuICAgIHwgJ2h3c19jb3VudGRvd25fb25kZW1hbmRfaWxsZWdhbGZyb3plbidcclxuICAgIHwgJ2h3c19jb3VudGRvd25fb25kZW1hbmRfaWxsZWdhbGZyb3plbl9hcnJlYXInXHJcbiAgICB8ICdod3NfY291bnRkb3duX29uZGVtYW5kX3BvbGljZWZyb3plbic7XHJcblxyXG4vKipcclxuICog5YCS6K6h5pe25L+h5oGv77yM5o6l5Y+j5piv5qC55o2uXCLkupHov5DokKXlhazlhbHmjqXlj6Por7TmmI5cIuaWh+ahoyAyLjIx5LqR5pyN5Yqh5YCS6K6h5pe25L+h5oGv5p+l6K+i5o6l5Y+j6L+U5Zue5pWw5o2u6K6+572u77yM6K+m5oOF5Y+C6ICD5o6l5Y+jXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFRwQ291bnREb3duSW5mb3Mge1xyXG4gICAgc3RhdHVzOiBudW1iZXI7XHJcbiAgICBuZXh0T3BlcmF0aW9uUmVtYWluaW5nRGF5OiBudW1iZXI7XHJcbiAgICBuZXh0T3BlcmF0aW9uUmVtYWluaW5nSG91cjogbnVtYmVyO1xyXG4gICAgbmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZTogbnVtYmVyO1xyXG4gICAgbmV4dE9wZXJhdGlvblJlbWFpbmluZ1NlY29uZDogbnVtYmVyO1xyXG4gICAgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlgJLorqHml7bkv6Hmga/mj5DnpLrkv6Hmga/vvIzmjqXlj6PmmK/moLnmja5cIuS6kei/kOiQpeWFrOWFseaOpeWPo+ivtOaYjlwi5paH5qGjIDIuMjHkupHmnI3liqHlgJLorqHml7bkv6Hmga/mn6Xor6LmjqXlj6Pov5Tlm57mlbDmja7orr7nva7vvIzor6bmg4Xlj4LogIPmjqXlj6NcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVHBDb3VudERvd25UaXBzIHtcclxuICAgIGVmZlRpbWU6IHN0cmluZzsgLy8g6LWE5rqQ55Sf5pWI5pe26Ze077yI5Y2z6LWE5rqQ5Yib5bu65pe26Ze077yJXHJcbiAgICBleHBUaW1lOiBzdHJpbmc7IC8vIOi1hOa6kOWIsOacn+aXtumXtO+8jOWmguaenOW3sue7j+asoOi0ue+8jOWImeS4uui1hOa6kOasoOi0ueaXtumXtOOAglxyXG4gICAgZ3JhY2VUaW1lOiBzdHJpbmc7IC8vIOWuvemZkOacn+e7k+adn+aXtumXtFxyXG4gICAgcmVsZWFzZVRpbWU6IHN0cmluZzsgLy8g6LWE5rqQ6YeK5pS+5pe26Ze0XHJcbiAgICBmcm96ZW5UaW1lOiBzdHJpbmc7IC8vIOi1hOa6kOWGu+e7k+aXtumXtFxyXG4gICAgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDotYTmupDlgJLorqHml7bnu4Tku7ZcclxuICogPGV4YW1wbGUtdXJsPi4uL3RpbnlwbHVzM2RlbW8vIy9jb3VudGRvd24vY291bnRkb3duLWFsbDwvZXhhbXBsZS11cmw+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAndHAtY291bnRkb3duJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9jb3VudGRvd24uaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9jb3VudGRvd24ubGVzcyddXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgVHBDb3VudGRvd25Db21wb25lbnQgZXh0ZW5kcyBUaUJhc2VDb21wb25lbnQge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5pi+56S66LWE5rqQ55qE54q25oCBXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHNob3dTdGF0dXM6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgJLorqHml7bnsbvliKvvvIzljbPlgJLorqHml7Zjb3VudERvd25Db2Rl5a2X5q61XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNvdW50RG93bkNvZGU6IFRwQ291bnREb3duQ29kZTtcclxuICAgIC8qKlxyXG4gICAgICog5YCS6K6h5pe25pWw5o2uLCDlkowyLjIx5LqR5pyN5Yqh5YCS6K6h5pe25L+h5oGv5p+l6K+i5o6l5Y+j6L+U5Zue55qEY291bnREb3duSW5mb3PkuIDoh7RcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgY291bnREb3duSW5mb3M6IFRwQ291bnREb3duSW5mb3M7XHJcbiAgICAvKipcclxuICAgICAqIHRpcOaPkOekuuaVsOaNru+8jOWSjDIuMjHkupHmnI3liqHlgJLorqHml7bkv6Hmga/mn6Xor6LmjqXlj6Pov5Tlm57nmoRUcENvdW50RG93blRpcHPkuIDoh7RcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgY291bnREb3duVGlwczogVHBDb3VudERvd25UaXBzO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5YCS6K6h5pe25pyA5ZCO5pi+56S655qE5paH5pysXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb3VudGRvd25UZXh0OiBzdHJpbmcgPSAnJztcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogdGlwIOeahOWGheWuuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdGlwQ29udGV4dDogYW55ID0gW107XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIHRpcCDnmoTmnIDlpKflrr3luqZcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRpcE1heFdpZHRoOiBzdHJpbmcgPSAnNTAwcHgnO1xyXG5cclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogdXNlLWxpZmUtY3ljbGUtaW50ZXJmYWNlXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uSW5pdCgpO1xyXG4gICAgICAgIC8vIOeUn+aIkOWAkuiuoeaXtuWGheWuuVxyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZW50KCk7XHJcbiAgICAgICAgLy8g55Sf5oiQdGlw5YaF5a65XHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZVRpcENvbnRlbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOeUn+aIkOWAkuiuoeaXtuWGheWuuVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdlbmVyYXRlQ29udGVudCgpOiB2b2lkIHtcclxuICAgICAgIC8vIOaXtumXtOmXtOmalFxyXG4gICAgICAgbGV0IHRpbWVzcGFuOiBzdHJpbmcgPSAnJztcclxuICAgICAgIC8vIOaXtumXtOS/oeaBr1xyXG4gICAgICAgbGV0IGhvdXJJbmZvOiBzdHJpbmcgPSAnJztcclxuICAgICAgIGxldCBtaW51dGVJbmZvOiBzdHJpbmcgPSAnJztcclxuICAgICAgIC8vICDmoLnmja7ov5Tlm57ml7bpl7Tmi7zmjqXlh7rml7bpl7Tpl7TpmpQgIHtkfSDlpKnmlbAge2h9IOWwj+aXtuaVsCB7bX0g5YiG6ZKf5pWwXHJcbiAgICAgICBpZiAodGhpcy5jb3VudERvd25JbmZvcykge1xyXG4gICAgICAgICAgIGlmICh0aGlzLmNvdW50RG93bkluZm9zLm5leHRPcGVyYXRpb25SZW1haW5pbmdEYXkpIHtcclxuICAgICAgICAgICAgICAgdGltZXNwYW4gPSB0aGlzLmNvdW50RG93bkluZm9zLm5leHRPcGVyYXRpb25SZW1haW5pbmdEYXkgPiAxID9cclxuICAgICAgICAgICAgICAgICAgIFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZGF5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3tkfS8sIHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ0RheSkgOlxyXG4gICAgICAgICAgICAgICAgICAgVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5kYXlcclxuICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvcy8sICcnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC97ZH0vLCB0aGlzLmNvdW50RG93bkluZm9zLm5leHRPcGVyYXRpb25SZW1haW5pbmdEYXkpO1xyXG4gICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jb3VudERvd25JbmZvcy5uZXh0T3BlcmF0aW9uUmVtYWluaW5nU2Vjb25kKSB7XHJcbiAgICAgICAgICAgICAgIHRpbWVzcGFuID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5zZWNvbmQ7XHJcbiAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNvdW50RG93bkluZm9zLm5leHRPcGVyYXRpb25SZW1haW5pbmdIb3VyKSB7XHJcbiAgICAgICAgICAgICAgIGhvdXJJbmZvID0gdGhpcy5jb3VudERvd25JbmZvcy5uZXh0T3BlcmF0aW9uUmVtYWluaW5nSG91ciA+IDEgP1xyXG4gICAgICAgICAgICAgICAgICAgVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5ob3VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3tofS8sIHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ0hvdXIpIDpcclxuICAgICAgICAgICAgICAgICAgIFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uaG91clxyXG4gICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9zLywgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3tofS8sIHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ0hvdXIpO1xyXG5cclxuICAgICAgICAgICAgICAgbWludXRlSW5mbyA9IHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZSA+IDEgP1xyXG4gICAgICAgICAgICAgICAgICAgVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5taW51dGVcclxuICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgve219LywgdGhpcy5jb3VudERvd25JbmZvcy5uZXh0T3BlcmF0aW9uUmVtYWluaW5nTWludXRlKSA6XHJcbiAgICAgICAgICAgICAgICAgICBUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQ291bnRkb3duLm1pbnV0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9zLywgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3ttfS8sIHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZSk7XHJcblxyXG4gICAgICAgICAgICAgICB0aW1lc3BhbiA9IGhvdXJJbmZvICsgJyAnICsgbWludXRlSW5mbztcclxuICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZSkge1xyXG4gICAgICAgICAgICAgICB0aW1lc3BhbiA9IHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZSA+IDEgP1xyXG4gICAgICAgICAgICAgICAgICAgVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5taW51dGUucmVwbGFjZSgve219LywgdGhpcy5jb3VudERvd25JbmZvcy5uZXh0T3BlcmF0aW9uUmVtYWluaW5nTWludXRlKSA6XHJcbiAgICAgICAgICAgICAgICAgICBUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQ291bnRkb3duLm1pbnV0ZS5yZXBsYWNlKC9zLywgJycpLnJlcGxhY2UoL3ttfS8sIHRoaXMuY291bnREb3duSW5mb3MubmV4dE9wZXJhdGlvblJlbWFpbmluZ01pbnV0ZSk7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgfVxyXG5cclxuICAgICAgIC8vIOagueaNrueKtuaAgeegge+8jOW+l+WIsOWAkuiuoeaXtuaVtOS9k+Wtl+espuS4suOAgiB7VFN9IOaXtumXtOmXtOmalFxyXG4gICAgICAgY29uc3Qgc3RhdHVzS2V5OiBzdHJpbmcgPSB0aGlzLmNvdW50RG93bkNvZGUgPyB0aGlzLmNvdW50RG93bkNvZGUuc2xpY2UoMTQpIDogJyc7XHJcbiAgICAgICBpZiAoVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bltzdGF0dXNLZXldKSB7XHJcbiAgICAgICAgICAgdGhpcy5jb3VudGRvd25UZXh0ID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bltzdGF0dXNLZXldXHJcbiAgICAgICAgICAgICAgIC5yZXBsYWNlKC97VFN9LywgdGltZXNwYW4pO1xyXG4gICAgICAgfVxyXG5cclxuICAgICAgIC8vIOWmguaenOaYr+aMiemcgOato+W4uOS9v+eUqO+8jOayoeacieWAkuiuoeaXtu+8jOWPquaPkOekuuWIm+W7uuaXtumXtO+8jOWNleeLrOWkhOeQhiB7eW1kaG1zfSDmmK8g5qC85byP5Li65pys5Zyw5YyW5pel5pyf5pe26Ze0XHJcbiAgICAgICBpZiAodGhpcy5jb3VudERvd25Db2RlID09PSAnaHdzX2NvdW50ZG93bl9vbmRlbWFuZF91c2luZycpIHtcclxuICAgICAgICAgICB0aGlzLmNvdW50ZG93blRleHQgPSB0aGlzLmNvdW50ZG93blRleHQucmVwbGFjZSgve3ltZGhtc30vLCBuZXcgVHBEYXRlUGlwZSgpLnRyYW5zZm9ybSh0aGlzLmNvdW50RG93blRpcHMuZWZmVGltZSwgJ2RhdGVUaW1lJykpO1xyXG4gICAgICAgfVxyXG5cclxuICAgICAgIC8vIOaYr+WQpuWxleekuueKtuaAgVxyXG4gICAgICAgaWYgKCF0aGlzLnNob3dTdGF0dXMpIHtcclxuICAgICAgICAgICB0aGlzLmNvdW50ZG93blRleHQgPSB0aGlzLmNvdW50ZG93blRleHQuc3BsaXQoVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5zcGxpdGVyKVxyXG4gICAgICAgICAgICAgICAucG9wKCk7XHJcbiAgICAgICB9XHJcblxyXG4gICAgICAgLy8g5re75Yqg5qC35byP57G7IOWuvemZkOacn++8jOWGu+e7k+acn++8jOi/neinhOWGu+e7kyDmj5DnpLrnuqLoibLvvIzmraPluLjkvb/nlKjvvIzlpoLmnpzlsI/kuo7kuIPlpKnvvIzmj5DnpLrpu4ToibJcclxuICAgICAgIGlmICh0aGlzLmNvdW50RG93bkluZm9zLnN0YXR1cyA+IDIpIHtcclxuICAgICAgICAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndHAtY291bnRkb3duLWFsYXJtJyk7XHJcbiAgICAgICB9IGVsc2UgaWYgKCh0aGlzLmNvdW50RG93bkNvZGUgPT09ICdod3NfY291bnRkb3duX3BlcmlvZF91c2luZycgfHwgdGhpcy5jb3VudERvd25Db2RlID09PSAnaHdzX2NvdW50ZG93bl9wZXJpb2RfdG9vbmRlbWFuZCcpXHJcbiAgICAgICAgICAgJiYgdGhpcy5pc0RheUxlc3M3KCkpIHtcclxuICAgICAgICAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndHAtY291bnRkb3duLXdhcm4nKTtcclxuICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlgJLorqHml7bmmK/lkKblsI/kuo7kuIPlpKlcclxuICAgIHByaXZhdGUgaXNEYXlMZXNzNygpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gISh0aGlzLmNvdW50RG93bkluZm9zLm5leHRPcGVyYXRpb25SZW1haW5pbmdEYXkgJiYgdGhpcy5jb3VudERvd25JbmZvcy5uZXh0T3BlcmF0aW9uUmVtYWluaW5nRGF5ID4gNyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnlJ/miJB0aXBzIOWGheWuuVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdlbmVyYXRlVGlwQ29udGVudCgpOiB2b2lkIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuY291bnREb3duQ29kZSkge1xyXG4gICAgICAgICAgICBjYXNlICdod3NfY291bnRkb3duX3BlcmlvZF91c2luZyc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uY3JlYXRlX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5lZmZUaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZXhwaXJlX3RpbWV9IGAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMuZXhwVGltZSl9YFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnaHdzX2NvdW50ZG93bl9wZXJpb2RfZ3JhY2luZyc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZXhwaXJlX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5leHBUaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5mcm96ZW5fdGltZX0gYCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5ncmFjZVRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2h3c19jb3VudGRvd25fcGVyaW9kX2Zyb3plbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZnJvemVuX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5mcm96ZW5UaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5yZWxlYXNlX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5yZWxlYXNlVGltZSl9YFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnaHdzX2NvdW50ZG93bl9wZXJpb2RfaWxsZWdhbGZyb3plbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZnJvemVuX3RpbWV9IGAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMuZnJvemVuVGltZSl9YFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24ucmVsZWFzZV90aW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMucmVsZWFzZVRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2h3c19jb3VudGRvd25fcGVyaW9kX3BvbGljZWZyb3plbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZnJvemVuX3RpbWV9IGAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMuZnJvemVuVGltZSl9YFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnaHdzX2NvdW50ZG93bl9wZXJpb2RfdG9vbmRlbWFuZCc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uY3JlYXRlX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5lZmZUaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi50b29ubmVlZF90aW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMuZXhwVGltZSl9YFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnaHdzX2NvdW50ZG93bl9vbmRlbWFuZF91c2luZyc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uY3JlYXRlX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5lZmZUaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdod3NfY291bnRkb3duX29uZGVtYW5kX2dyYWNpbmcnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy50aXBDb250ZXh0LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQ291bnRkb3duLmFycmVhcnNfdGltZX1gLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IGAke3RoaXMuZm9ybWF0TG9jYWxlRGF0ZVRpbWUodGhpcy5jb3VudERvd25UaXBzLmV4cFRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aXBDb250ZXh0LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQ291bnRkb3duLmZyb3plbl90aW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMuZ3JhY2VUaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdod3NfY291bnRkb3duX29uZGVtYW5kX2Zyb3plbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZnJvemVuX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5mcm96ZW5UaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5yZWxlYXNlX3RpbWV9IGAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMucmVsZWFzZVRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2h3c19jb3VudGRvd25fb25kZW1hbmRfaWxsZWdhbGZyb3plbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24uZnJvemVuX3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiBgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5mcm96ZW5UaW1lKX1gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdod3NfY291bnRkb3duX29uZGVtYW5kX2lsbGVnYWxmcm96ZW5fYXJyZWFyJzpcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5mcm96ZW5fdGltZX1gLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IGAgJHt0aGlzLmZvcm1hdExvY2FsZURhdGVUaW1lKHRoaXMuY291bnREb3duVGlwcy5mcm96ZW5UaW1lKX0gYFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpcENvbnRleHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGAke1RpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBDb3VudGRvd24ucmVsZWFzZV90aW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogYCR7dGhpcy5mb3JtYXRMb2NhbGVEYXRlVGltZSh0aGlzLmNvdW50RG93blRpcHMucmVsZWFzZVRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2h3c19jb3VudGRvd25fb25kZW1hbmRfcG9saWNlZnJvemVuJzpcclxuICAgICAgICAgICAgICAgIHRoaXMudGlwQ29udGV4dC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7VGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cENvdW50ZG93bi5mcm96ZW5fdGltZX1gLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IGAke3RoaXMuZm9ybWF0TG9jYWxlRGF0ZVRpbWUodGhpcy5jb3VudERvd25UaXBzLmZyb3plblRpbWUpfWBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDml6XmnJ/ml7bpl7TmiLPovazmjaLmiJDluKbml7bljLrnmoRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBmb3JtYXRMb2NhbGVEYXRlVGltZShyZXE6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIENmVXRpbC5mb3JtYXRMb2NhbGVEYXRlVGltZShyZXEpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=