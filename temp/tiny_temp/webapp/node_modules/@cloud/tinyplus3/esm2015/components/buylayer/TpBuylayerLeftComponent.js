import { Component, ContentChild, EventEmitter, Input, Output, TemplateRef } from '@angular/core';
import { getLocaleCurrencySymbol } from '@angular/common';
import { TiBaseComponent, TiLocale, Util } from '@cloud/tiny3';
import { CfUtil } from '../../cfutils/CfUtil';
import { TpUtil } from './../../utils/TpUtil';
/**
 * @ignore
 * 购买浮层左侧价格区域
 * <example-url>../tinyplus3demo/#/buylayer/buylayer-all</example-url>
 */
export class TpBuylayerLeftComponent extends TiBaseComponent {
    constructor() {
        super(...arguments);
        /**
         * 浮层左侧价格列表集合
         */
        this.costs = [];
        /**
         * 可选优惠项切换选择项时触发
         *
         * 9.0.3 新增接口
         */
        this.discountsChange = new EventEmitter();
        /**
         * @ignore
         */
        this.freechargeDetailLink = '';
        /**
         * @ignore
         * tip中的表头
         */
        this.pricelistHead = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_pricelist;
        /**
         * @ignore
         * 主要价格是否包含数字。如果包含则需要出现计费详情，否则不出现。
         */
        this.hasNumberofMajorprice = false;
    }
    // tslint:disable-next-line:use-life-cycle-interface
    ngOnInit() {
        super.ngOnInit();
        const routeLink = TiLocale.getLocaleWords().tpBuylayer.buyLayer_freeCharge_detailLink;
        this.costsChange();
        this.discountChange();
        if (!Util.isUndefined(this.numFormat) && !Util.isUndefined(this.majorDiscoutsConfig)) {
            // 浮层配置的价格精度同样作用到优惠详情部分，两者保持一致。
            this.majorDiscoutsConfig.numFormat = this.numFormat;
        }
        CfUtil.getLinks()
            .then((linksData) => {
            if (linksData && linksData.links && linksData.links.user_center_common) {
                this.freechargeDetailLink = this.addLinkParams(linksData.links.user_center_common + routeLink);
            }
        });
    }
    // tslint:disable-next-line:use-life-cycle-interface
    ngOnChanges() {
        this.costsChange();
        this.discountChange();
    }
    ngDoCheck() {
        if (!Util.isArray(this.costs) || this.costs.length === 0) {
            return;
        }
        // costs动态hide之后，重新获取主次要价格数组，并且新数组的第一项（头部价格）不带加号连接符
        const currentMajorCosts = this.costs.filter((item) => !item.hide && item.majorPrice);
        const currentMinorCosts = this.costs.filter((item) => !item.hide && !item.majorPrice);
        currentMajorCosts.forEach((item, index) => {
            item.hideConnectSymbol = !index;
        });
        currentMinorCosts.forEach((item, index) => {
            item.hideConnectSymbol = !index;
        });
    }
    // 数据初始化及变更之后都需执行
    costsChange() {
        this.setMajorPrice();
        this.finalCosts = this.costs.filter((item) => !item.hide);
        this.majorPriceNum = this.getMajorPriceNum();
        this.isCostsAllHide();
        if (this.isRefund) {
            this.setRefundParams();
        }
        this.onlyHasMajorprice = this.finalCosts && this.finalCosts.length > 0 && this.majorPriceNum === this.finalCosts.length ? true : false;
    }
    hasDiscountsData(config) {
        const hasSelectableDiscounts = Util.isArray(config.selectableDiscounts) && config.selectableDiscounts.length > 0;
        const hasSelectedDiscounts = Util.isArray(config.selectedDiscounts) && config.selectedDiscounts.length > 0;
        const hasDiscounts = Util.isArray(config.discounts) && config.discounts.length > 0;
        return hasDiscounts || (hasSelectedDiscounts || hasSelectableDiscounts);
    }
    discountChange() {
        if (TpUtil.isObject(this.majorDiscoutsConfig) && this.hasDiscountsData(this.majorDiscoutsConfig) && this.majorPriceNum > 0) {
            this.showMajorDiscount = true;
        }
        else {
            this.showMajorDiscount = false;
        }
        const minorpriceNum = this.costs && this.costs.length - this.majorPriceNum; // 得到次要价格的数目
        if (TpUtil.isObject(this.minorDiscoutsConfig) && this.hasDiscountsData(this.minorDiscoutsConfig) && minorpriceNum > 0) {
            this.showMinorDiscount = true;
        }
        else {
            this.showMinorDiscount = false;
        }
    }
    /**
     * @ignore
     */
    change($event) {
        this.discountsChange.emit($event);
    }
    // 获取主要价格数量
    getMajorPriceNum() {
        if (this.finalCosts && this.finalCosts.length > 0) {
            let num = 0;
            for (const cost of this.finalCosts) {
                if (cost.majorPrice) {
                    num++;
                    if (this.isNumber(cost.value)) {
                        this.hasNumberofMajorprice = true;
                    }
                }
            }
            return num;
        }
        return 0;
    }
    // 判断主/次要价格是否都隐藏
    isCostsAllHide() {
        if (this.costs && this.costs.length > 0) {
            // 获取主要价格集合
            const majorPriceArr = this.costs.filter((item) => item.majorPrice);
            // 获取次要价格集合
            const minorPriceArr = this.costs.filter((item) => !item.majorPrice);
            this.isMinorPriceAllHide = this.isAllHide(minorPriceArr);
            this.isMajorPriceAllHide = this.isAllHide(majorPriceArr);
        }
    }
    isAllHide(arr) {
        let isAllHide = true;
        if (arr.length > 0) {
            for (const cost of arr) {
                if (!cost.hide) {
                    isAllHide = false;
                }
            }
        }
        return isAllHide;
    }
    // 设置价格类型
    setMajorPrice() {
        if (this.costs && this.costs.length > 0) {
            for (const cost of this.costs) {
                if (Util.isUndefined(cost.label) && !this.isRefund) {
                    cost.label = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_label;
                    cost.tipTitle = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_label;
                }
                if (Util.isUndefined(cost.majorPrice)) {
                    cost.majorPrice = true;
                }
            }
        }
    }
    /**
     * 设置退费场景下的相关参数
     */
    setRefundParams() {
        if (this.costs && this.costs.length > 0) {
            for (const cost of this.costs) {
                if (Util.isUndefined(cost.label)) {
                    cost.label = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_label_refund_majorprice;
                    cost.tipTitle = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_label_refund_detail;
                }
                if (cost.pricelist && cost.pricelist.length > 0) {
                    cost.pricelist[0].title = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_pricelist_label_before;
                    cost.pricelist[1].title = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_pricelist_label_after;
                    cost.pricelist[2] = {
                        title: TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_label_refund,
                        priceNum: cost.value
                    };
                    this.pricelistHead = TiLocale.getLocaleWords().tpBuylayer.buyLayer_cost_type;
                }
            }
        }
    }
    /**
     * @ignore
     */
    isNumber(val) {
        return Util.isNumber(val);
    }
    /**
     * @ignore
     */
    isPositiveNumber(val) {
        return Util.isNumber(val) && val > 0;
    }
    /**
     * @ignore
     * 货币国际化
     */
    getLocalSymble() {
        const localeKey = TiLocale.getLocaleWords().tiLocaleKey;
        return getLocaleCurrencySymbol(localeKey);
    }
    // 获取agencyID和locale
    addLinkParams(url) {
        if (url === '') {
            return url;
        }
        const storage = CfUtil.getStorageService();
        if (!(!Util.isUndefined(storage) && !Util.isUndefined(storage.cookieStorage) && Util.isFunction(storage.cookieStorage.getItem))) {
            return url;
        }
        const agencyID = storage.cookieStorage.getItem('agencyID');
        const locale = storage.cookieStorage.getItem('locale');
        let finalUrl = url;
        if (!Util.isEmptyString(agencyID)) {
            finalUrl = finalUrl + '?agencyId=' + agencyID;
            if (!Util.isEmptyString(locale)) {
                finalUrl = finalUrl + '&locale=' + locale;
            }
        }
        else if (!Util.isEmptyString(locale)) {
            finalUrl = finalUrl + '?locale=' + locale;
        }
        return finalUrl;
    }
}
TpBuylayerLeftComponent.decorators = [
    { type: Component, args: [{
                selector: 'tp-buylayer-left',
                template: "<div class='tp-buylayer-font-main'>\r\n  <!-- \u4EF7\u683C\u5217\u8868\u90E8\u5206\u5C55\u793A\uFF0C\u8DDF\u4EF7\u683C\u8BA1\u7B97\u5668\u90E8\u5206\u4E0D\u80FD\u540C\u65F6\u5B58\u5728 -->\r\n  <div class='tp-buyLayer-price-container' *ngIf='costs'>\r\n      <div *ngIf='leftZoneEle1'>\r\n          <ng-container *ngTemplateOutlet='leftZoneEle1'></ng-container>\r\n      </div>\r\n      <div>\r\n          <ng-container *ngTemplateOutlet='majorPrice'></ng-container>\r\n          <ng-container *ngTemplateOutlet='minorPrice'></ng-container>\r\n          <!--\u662F\u5426\u663E\u793A\u6298\u6263\u529B\u51CF-->\r\n          <div *ngIf='showFreechargeDetail'>\r\n            <tp-icon local class='tp-buyLayer-freechargeDetail-icon' name='cloud-action-gift'></tp-icon>\r\n            <span class=\"tp-buylayer-freecharge-label\">{{'tpBuylayer.buyLayer_freeCharge_detail' | tiTranslate}}</span>\r\n            <a [href]='freechargeDetailLink' class='tp-buylayer-link' target=\"_blank\" rel=\"noopener noreferrer\">{{'tpBeta.more' | tiTranslate}}</a>\r\n          </div>\r\n      </div>\r\n  </div>\r\n  <!-- \u4EF7\u683C\u8BA1\u7B97\u5668\u5C55\u793A \u53EA\u5728\u7279\u6B8A\u5C40\u70B9\uFF08\u5FB7\u7535\u3001\u6CD5\u7535\uFF09\u624D\u5C55\u793A -->\r\n  <div class='tp-buyLayer-price-cal'>\r\n      <ng-container *ngTemplateOutlet='pricecalc'></ng-container>\r\n  </div>\r\n</div>\r\n\r\n<!-- tip\u5185\u5BB9\u6A21\u677F\uFF0C\u5176\u4E2Dlet-\u5B9A\u4E49\u7684\u662F\u6A21\u677F\u4E2D\u7528\u5230\u7684\u4E0A\u4E0B\u6587 -->\r\n<ng-template #tipContent  let-context='context'>\r\n    <div *ngIf='context.pricelist && context.pricelist.length' class='tp-buylayer-pricelist-tip'>\r\n        <span class=\"tp-buylayer-pricelist-title\">{{context.tipTitle}}</span>\r\n        <ul style=\"padding:0\" [id]=\"appendId('list')\">\r\n            <li class=\"tp-buylayer-pricelist-head\">\r\n                <span>{{pricelistHead}}</span>\r\n                <span style=\"float:right\">{{'tpBuylayer.buyLayer_cost_price' | tiTranslate}}</span>\r\n            </li>\r\n            <li class=\"tp-buylayer-pricelist\" *ngFor='let price of context.pricelist; last as lastItem;'>\r\n              <span>{{price.title}}</span>\r\n              <span class=\"tp-buylayer-pricelist-item\" style='float:right'>\r\n                <span [ngClass]=\"{'tp-buylayer-priceNum-refund': isRefund,\r\n                'tp-buylayer-priceNum-refund-last': lastItem && isRefund}\">{{price.priceNum | tpCurrency: numFormat}}</span>\r\n                <span *ngIf=\"context.measureUnit\">/{{context.measureUnit}}</span>\r\n              </span>\r\n            </li>\r\n        </ul>\r\n      </div>\r\n</ng-template>\r\n<!-- \u95EE\u53F7\u56FE\u6807\u63D0\u793A\u6A21\u677F\uFF084.0\u89C4\u8303\u7684\u8BA1\u8D39\u8BE6\u60C5\uFF09 -->\r\n<ng-template #detailTip>\r\n    <span *ngIf='!costExplain'>{{'tpBuylayer.buyLayer_costExplain_label' | tiTranslate}}</span>\r\n    <span *ngIf='costExplain'>{{costExplain}}</span>\r\n    <!--\u6709\u7684\u4E00\u53E3\u4EF7\u5546\u54C1\uFF0C\u4E0D\u5B58\u5728\u8D85\u94FE\u63A5\uFF0C\u6240\u4EE5\u9700\u8981\u652F\u6301\u9690\u85CF-->\r\n    <a target=\"_blank\" *ngIf=\"detailHref || (costs && costs[0] && costs[0].link)\" [href]='detailHref || (costs && costs[0] && costs[0].link)' rel=\"noopener noreferrer\">{{'tpBuylayer.buyLayer_cost_linklabel' | tiTranslate}}</a>\r\n</ng-template>\r\n<!-- \u4E3B\u8981\u4EF7\u683C\u90E8\u5206\u6A21\u677F -->\r\n<ng-template #majorPrice>\r\n  <div *ngIf=\"!isMajorPriceAllHide\">\r\n    <div style='display: inline-block' *ngFor='let cost of costs | isMajorPrice;'>\r\n      <span *ngIf='!cost.hide'>\r\n        <tp-icon local *ngIf='!cost.hideConnectSymbol' name='cloud-action-add6' class='tp-buylayer-add'></tp-icon>\r\n        <span class='tp-buylayer-label'>{{cost.label}}</span>\r\n        <span *ngIf='cost.isBeta' class='tp-buylayer-beta-label'>{{'tpBuylayer.buyLayer_betaFree_label' | tiTranslate}}</span>\r\n        <span *ngIf='!cost.isBeta'>\r\n          <span *ngIf='!isNumber(cost.value)' [innerHTML]=\"cost.value\"></span>\r\n          <ng-container *ngIf='isNumber(cost.value)'>\r\n            <span *ngIf='cost.pricelist && cost.pricelist.length > 0' [ngClass]=\"{'tp-buyLayer-priceWithTip': cost.pricelist}\" [tiTip]='tipContent' [tiTipContext]='cost'>\r\n              <span class='tp-buylayer-majorprice-value'  [ngClass]=\"{'tp-buylayer-majorprice-refund': isRefund}\">{{cost.value | tpCurrency: numFormat}}</span>\r\n              <span *ngIf='cost.measureUnit'>/{{cost.measureUnit}}</span>\r\n            </span>\r\n            <span  *ngIf='!cost.pricelist || cost.pricelist.length === 0'>\r\n              <span class='tp-buylayer-majorprice-value'  [ngClass]=\"{'tp-buylayer-majorprice-refund': isRefund}\">{{cost.value | tpCurrency: numFormat}}</span>\r\n              <span *ngIf='cost.measureUnit'>/{{cost.measureUnit}}</span>\r\n            </span>\r\n            <span *ngIf='cost.discount && isPositiveNumber(cost.discount)' class='tp-buylayer-discount'>\r\n              <span>({{'tpBuylayer.buyLayer_priceDiscount_label' | tiTranslate}}</span>\r\n              <span>{{cost.discount | tpCurrency: numFormat}}</span>\r\n              <span *ngIf='cost.measureUnit'>/{{cost.measureUnit}}</span>\r\n              <span>)</span>\r\n            </span>\r\n          </ng-container>\r\n        </span>\r\n      </span>\r\n    </div>\r\n    <span *ngIf=\"showMajorDiscount\" class=\"tp-buylayer-discounts-container\">\r\n      <tp-discounts [discoutsConfig]='majorDiscoutsConfig' (discountsChange)='change($event)' [id]=\"appendId('major_discounts')\"></tp-discounts>\r\n    </span>\r\n    <tp-icon local *ngIf='onlyHasMajorprice && hasNumberofMajorprice' [tiTip]='detailTip' [tiTipMaxWidth]='detailTipMaxWidth' name=\"cloud-action-tip\" class='tp-buylayer-help' [id]=\"appendId('major_helptip')\"></tp-icon>\r\n  </div>\r\n</ng-template>\r\n<!-- \u6B21\u8981\u4EF7\u683C\u90E8\u5206\u6A21\u677F -->\r\n<ng-template #minorPrice>\r\n    <div *ngIf=\"!isMinorPriceAllHide\">\r\n        <div style='display: inline-block' *ngFor='let cost of costs | isMinorPrice;'>\r\n          <span *ngIf='!cost.hide'>\r\n            <tp-icon local name='cloud-action-add6' *ngIf='!cost.hideConnectSymbol' class='tp-buylayer-add' [ngClass]=\"{'tp-buylayer-add-first': cost.hideConnectSymbol}\"></tp-icon>\r\n            <span class='tp-buylayer-label'>{{cost.label}}</span>\r\n            <span *ngIf='cost.isBeta' class='tp-buylayer-beta-label'>{{'tpBuylayer.buyLayer_betaFree_label' | tiTranslate}}</span>\r\n            <span *ngIf='!cost.isBeta'>\r\n              <span *ngIf='!isNumber(cost.value)' [innerHTML]=\"cost.value\"></span>\r\n              <ng-container *ngIf='isNumber(cost.value)'>\r\n                <span *ngIf='cost.pricelist && cost.pricelist.length > 0' [ngClass]=\"{'tp-buyLayer-priceWithTip': cost.pricelist}\" [tiTip]='tipContent' [tiTipContext]='cost'>\r\n                  <span class='tp-buylayer-minorprice-value' [ngClass]=\"{'tp-buylayer-minorprice-refund': isRefund}\">{{cost.value | tpCurrency: numFormat}}</span>\r\n                  <span *ngIf='cost.measureUnit' class='tp-buylayer-minorprice-value' [ngClass]=\"{'tp-buylayer-minorprice-refund': isRefund}\">/{{cost.measureUnit}}</span>\r\n                </span>\r\n                <span *ngIf='!cost.pricelist || cost.pricelist.length === 0'>\r\n                  <span class='tp-buylayer-minorprice-value' [ngClass]=\"{'tp-buylayer-minorprice-refund': isRefund}\">{{cost.value | tpCurrency: numFormat}}</span>\r\n                  <span *ngIf='cost.measureUnit' class='tp-buylayer-minorprice-value' [ngClass]=\"{'tp-buylayer-minorprice-refund': isRefund}\">/{{cost.measureUnit}}</span>\r\n                </span>\r\n                <span *ngIf='cost.discount && isPositiveNumber(cost.discount)' class='tp-buylayer-discount'>\r\n                  <span>({{'tpBuylayer.buyLayer_priceDiscount_label' | tiTranslate}}</span>\r\n                  <span>{{cost.discount | tpCurrency: numFormat}}</span>\r\n                  <span *ngIf='cost.measureUnit'>/{{cost.measureUnit}}</span>\r\n                  <span>)</span>\r\n                </span>\r\n              </ng-container>\r\n            </span>\r\n          </span>\r\n        </div>\r\n        <span *ngIf=\"showMinorDiscount\" class=\"tp-buylayer-discounts-container\">\r\n          <tp-discounts [discoutsConfig]='minorDiscoutsConfig' [id]=\"appendId('minor_discounts')\"></tp-discounts>\r\n        </span>\r\n        <tp-icon local *ngIf='!onlyHasMajorprice && finalCosts.length > 0' [tiTip]='detailTip' [tiTipMaxWidth]='detailTipMaxWidth' name=\"cloud-action-tip\" class='tp-buylayer-help' [id]=\"appendId('minor_helptip')\"></tp-icon>\r\n      </div>\r\n  </ng-template>\r\n  <!-- \u4EF7\u683C\u8BA1\u7B97\u5668\u6A21\u677F -->\r\n<ng-template #pricecalc>\r\n    <tp-pricecalc *ngIf='calculator &&calculator.url' [url] = 'calculator.url' [id]=\"appendId('pricecalc')\"\r\n    [values]='calculator.values' [method]='calculator.method' [detailHref]='calculator.detailHref'></tp-pricecalc>\r\n    <div *ngIf='!costExplain && (detailHref || costs && costs[0] && costs[0].link)'>\r\n      <span>{{'tpBuylayer.buyLayer_costDetail_label.text_before_link' | tiTranslate}}</span>\r\n      <a target='_blank' class='tp-buylayer-link' [href]='detailHref || costs && costs[0] && costs[0].link' rel=\"noopener noreferrer\">{{'tpBuylayer.buyLayer_costDetail_label.link_info' | tiTranslate}}</a>\r\n      <span>{{'tpBuylayer.buyLayer_costDetail_label.text_after_link' | tiTranslate}}</span>\r\n    </div>\r\n    <div *ngIf='costExplain'>{{costExplain}}</div>\r\n</ng-template>\r\n\r\n",
                styles: [".tp-buylayer-font-main{color:var(--ti-common-color-text-secondary);font-size:var(--ti-common-font-size-base);line-height:var(--ti-common-line-height-number)}::ng-deep .tp-buyLayer-price-container{align-items:center;display:flex;justify-content:space-between}.tp-buyLayer-freechargeDetail-icon{color:var(--ti-common-color-warn)}.tp-buylayer-freecharge-label{padding-left:var(--ti-common-space-base)}.tp-buylayer-link{color:var(--ti-common-color-text-link);cursor:pointer;text-decoration:none}.tp-buylayer-link:hover{color:var(--ti-common-color-text-link-hover);text-decoration:underline}::ng-deep .tp-buyLayer-price-cal{display:none}.tp-buylayer-pricelist-tip{color:var(--ti-common-color-text-gray);display:inline-block;font-size:var(--ti-common-font-size-base);min-width:240px}.tp-buylayer-pricelist-title{display:inline-block;font-size:var(--ti-common-font-size-1);line-height:var(--ti-common-line-height-number);padding-bottom:var(--ti-common-space-2x)}.tp-buylayer-pricelist-head{background:hsla(0,0%,100%,.05);height:28px;line-height:28px}.tp-buylayer-pricelist,.tp-buylayer-pricelist-head{border-bottom:1px solid hsla(0,0%,100%,.1);padding:0 var(--ti-common-space-2x)}.tp-buylayer-pricelist{height:34px;line-height:34px}.tp-buylayer-pricelist-item{color:var(--ti-common-color-error);font-weight:700}.tp-buylayer-priceNum-refund{color:var(--ti-common-color-text-gray);font-weight:400}.tp-buylayer-priceNum-refund-last{color:var(--ti-common-color-text-success)}.tp-buylayer-add{color:var(--ti-common-color-icon-graybg-normal);padding:0 var(--ti-common-space-base)}.tp-buylayer-add-first{padding-left:0}.tp-buylayer-beta-label{color:var(--ti-common-bg-primary-active);font-size:var(--ti-common-font-size-4);line-height:30px}.tp-buylayer-label{padding-right:var(--ti-common-space-2x)}.tp-buyLayer-priceWithTip{border-bottom:1px dashed var(--ti-common-color-text-secondary)}.tp-buylayer-majorprice-value{color:var(--ti-common-color-error-text);font-size:var(--ti-common-font-size-4);line-height:30px}.tp-buylayer-minorprice-value{color:var(--ti-common-color-text-primary);font-weight:700}.tp-buylayer-discount{padding-left:var(--ti-common-space-base)}.tp-buylayer-majorprice-refund{color:var(--ti-common-color-text-success)}.tp-buylayer-minorprice-refund{color:var(--ti-common-color-error-text)}.tp-buylayer-discounts-container{border-left:1px solid var(--ti-common-color-line-dividing);padding-left:var(--ti-common-space-3x)}.tp-buylayer-discounts-container,.tp-buylayer-help{line-height:normal;margin-left:var(--ti-common-space-3x)}.tp-buylayer-help{display:inline-block;font-size:var(--ti-common-font-size-2);vertical-align:text-bottom}.tp-buylayer-help:hover{color:var(--ti-common-color-icon-hover);cursor:pointer}"]
            },] }
];
TpBuylayerLeftComponent.propDecorators = {
    costs: [{ type: Input }],
    majorDiscoutsConfig: [{ type: Input }],
    minorDiscoutsConfig: [{ type: Input }],
    showFreechargeDetail: [{ type: Input }],
    costExplain: [{ type: Input }],
    calculator: [{ type: Input }],
    numFormat: [{ type: Input }],
    detailHref: [{ type: Input }],
    isRefund: [{ type: Input }],
    detailTipMaxWidth: [{ type: Input }],
    discountsChange: [{ type: Output }],
    leftZoneEle1: [{ type: ContentChild, args: [TemplateRef,] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHBCdXlsYXllckxlZnRDb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueXBsdXMzL2NvbXBvbmVudHMvYnV5bGF5ZXIvVHBCdXlsYXllckxlZnRDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xHLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzFELE9BQU8sRUFBRSxlQUFlLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUUvRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFHOUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBc0U5Qzs7OztHQUlHO0FBT0gsTUFBTSxPQUFPLHVCQUF3QixTQUFRLGVBQWU7SUFONUQ7O1FBT0k7O1dBRUc7UUFDTSxVQUFLLEdBQW1CLEVBQUUsQ0FBQztRQXlDcEM7Ozs7V0FJRztRQUNnQixvQkFBZSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBSTNFOztXQUVHO1FBQ0kseUJBQW9CLEdBQVcsRUFBRSxDQUFDO1FBQ3pDOzs7V0FHRztRQUNJLGtCQUFhLEdBQVcsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQztRQVc1Rjs7O1dBR0c7UUFDSSwwQkFBcUIsR0FBWSxLQUFLLENBQUM7SUF5T2xELENBQUM7SUEvTUcsb0RBQW9EO0lBQ3BELFFBQVE7UUFDSixLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDakIsTUFBTSxTQUFTLEdBQVcsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQVUsQ0FBQyw4QkFBOEIsQ0FBQztR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TUFBTSxDQUFDO2FBQzdDO1NBQ0o7YUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUNwQyxRQUFRLEdBQUcsUUFBUSxHQUFHLFVBQVUsR0FBRyxNQUFNLENBQUM7U0FDN0M7UUFFRCxPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDOzs7WUExVEosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLGs5U0FBbUM7O2FBRXRDOzs7b0JBTUksS0FBSztrQ0FJTCxLQUFLO2tDQUlMLEtBQUs7bUNBSUwsS0FBSzswQkFJTCxLQUFLO3lCQUlMLEtBQUs7d0JBTUwsS0FBSzt5QkFJTCxLQUFLO3VCQUtMLEtBQUs7Z0NBS0wsS0FBSzs4QkFNTCxNQUFNOzJCQUVOLFlBQVksU0FBQyxXQUFXIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBDb250ZW50Q2hpbGQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgZ2V0TG9jYWxlQ3VycmVuY3lTeW1ib2wgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBUaUJhc2VDb21wb25lbnQsIFRpTG9jYWxlLCBVdGlsIH0gZnJvbSAnQGNsb3VkL3RpbnkzJztcclxuXHJcbmltcG9ydCB7IENmVXRpbCB9IGZyb20gJy4uLy4uL2NmdXRpbHMvQ2ZVdGlsJztcclxuaW1wb3J0IHsgVHBEaXNjb3V0c0NvbmZpZyB9IGZyb20gJy4uL2Rpc2NvdW50cy9UcERpc2NvdW50c01vZHVsZSc7XHJcblxyXG5pbXBvcnQgeyBUcFV0aWwgfSBmcm9tICcuLy4uLy4uL3V0aWxzL1RwVXRpbCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRwQ29zdHMge1xyXG4gICAgLyoqXHJcbiAgICAgKiDku7fmoLxsYWJlbFxyXG4gICAgICovXHJcbiAgICBsYWJlbD86IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog5Lu35qC85pWw5YC8XHJcbiAgICAgKi9cclxuICAgIHZhbHVlPzogbnVtYmVyIHwgc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDorqHph4/ljZXkvY1cclxuICAgICAqL1xyXG4gICAgbWVhc3VyZVVuaXQ/OiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuWFrOa1i1xyXG4gICAgICovXHJcbiAgICBpc0JldGE/OiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDkvJjmg6Dph5Hpop1cclxuICAgICAqL1xyXG4gICAgZGlzY291bnQ/OiBudW1iZXI7XHJcbiAgICAvKipcclxuICAgICAqIOS7t+agvOivpuaDhemTvuaOpVxyXG4gICAgICovXHJcbiAgICBsaW5rPzogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmK/lkKbmmK/kuLvopoHku7fmoLxcclxuICAgICAqL1xyXG4gICAgbWFqb3JQcmljZT86IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpumakOiXj+S7t+agvFxyXG4gICAgICpcclxuICAgICAqIDEwLjEuMCDmlrDlop5cclxuICAgICAqL1xyXG4gICAgaGlkZT86IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpumakOiXj+S7t+agvOS5i+mXtOeahOWKoOWPt+i/nuaOpeespuWPt1xyXG4gICAgICpcclxuICAgICAqIDEwLjEuMCDmlrDlop5cclxuICAgICAqL1xyXG4gICAgaGlkZUNvbm5lY3RTeW1ib2w/OiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDku7fmoLzmmI7nu4ZcclxuICAgICAqL1xyXG4gICAgcHJpY2VsaXN0PzogQXJyYXk8YW55PjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICB0aXBUaXRsZT86IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog5YWB6K645pyJ5aSa5L2Z55qE5bGe5oCn5a2X5q61XHJcbiAgICAgKlxyXG4gICAgICogMTAuMS4y5paw5aKeXHJcbiAgICAgKi9cclxuICAgIFtwcm9wTmFtZTogc3RyaW5nXTogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRwQ2FsY3VsYXRvciB7XHJcbiAgICAvKipcclxuICAgICAqIOmTvuaOpVxyXG4gICAgICovXHJcbiAgICB1cmw/OiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOWFgeiuuOacieWkmuS9meeahOWxnuaAp+Wtl+autVxyXG4gICAgICovXHJcbiAgICBbcHJvcE5hbWU6IHN0cmluZ106IGFueTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBpZ25vcmVcclxuICog6LSt5Lmw5rWu5bGC5bem5L6n5Lu35qC85Yy65Z+fXHJcbiAqIDxleGFtcGxlLXVybD4uLi90aW55cGx1czNkZW1vLyMvYnV5bGF5ZXIvYnV5bGF5ZXItYWxsPC9leGFtcGxlLXVybD5cclxuICovXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICd0cC1idXlsYXllci1sZWZ0JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9idXlsYXllci1sZWZ0Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vYnV5bGF5ZXItbGVmdC5sZXNzJ11cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBUcEJ1eWxheWVyTGVmdENvbXBvbmVudCBleHRlbmRzIFRpQmFzZUNvbXBvbmVudCB7XHJcbiAgICAvKipcclxuICAgICAqIOa1ruWxguW3puS+p+S7t+agvOWIl+ihqOmbhuWQiFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjb3N0czogQXJyYXk8VHBDb3N0cz4gPSBbXTtcclxuICAgIC8qKlxyXG4gICAgICog5LyY5oOg6K+m5oOF5by556qX5L+h5oGv6YWN572uKOS4u+imgeS7t+agvCnmgLvmjqXlj6PvvIzlhbfkvZPor6bmg4Xlj6/lj4LogINkaXNjb3VudHPnu4Tku7ZcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgbWFqb3JEaXNjb3V0c0NvbmZpZzogVHBEaXNjb3V0c0NvbmZpZztcclxuICAgIC8qKlxyXG4gICAgICog5LyY5oOg6K+m5oOF5by556qX5L+h5oGv6YWN572u77yI5qyh6KaB5Lu35qC877yJ5oC75o6l5Y+j77yM5YW35L2T6K+m5oOF5Y+v5Y+C6ICDZGlzY291bnRz57uE5Lu2XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIG1pbm9yRGlzY291dHNDb25maWc6IFRwRGlzY291dHNDb25maWc7XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuaYvuekuuWFjei0ueWll+mkkOWcuuaZr1xyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBzaG93RnJlZWNoYXJnZURldGFpbDogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICog55So5oi35Y+v6Ieq5a6a5LmJ5Lu35qC86K+m5oOF5L+h5oGvXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNvc3RFeHBsYWluOiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOS7t+agvOiuoeeul+WZqOWcuuaZr+WxleekuuaXtuWAmeeahOmFjee9ruaOpeWPo1xyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjYWxjdWxhdG9yOiBUcENhbGN1bGF0b3I7XHJcbiAgICAvKipcclxuICAgICAqIOi0p+W4geeyvuW6puiuvue9ruaOpeWPo1xyXG4gICAgICog6Ieq5a6a5LmJ5L+d55WZ5L2N5pWw77yM5L6L5aaC77yaMS4yLTTvvIzooajnpLrmlbTmlbDpg6jliIbmnIDlsJHkv53nlZkx5L2N77yM5bCP5pWw6YOo5YiG5pyA5bCP5L+d55WZMuS9je+8jOWwj+aVsOmDqOWIhuacgOWkp+S/neeVmTTkvY3jgIJcclxuICAgICAqIOm7mOiupOWAvOWPluiHquWQhOWxgOeCuVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBudW1Gb3JtYXQ6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog5LqG6Kej6K6h6LS56K+m5oOF6ZO+5o6lXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGRldGFpbEhyZWY6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5piv5ZCm5piv6YCA6LS55Zy65pmvXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGlzUmVmdW5kOiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDorqHotLnor6bmg4V0aXDmnIDlpKflrr3luqZcclxuICAgICAqIDEwLjEuNOaWsOWinlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBkZXRhaWxUaXBNYXhXaWR0aDogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj6/pgInkvJjmg6DpobnliIfmjaLpgInmi6npobnml7bop6blj5FcclxuICAgICAqXHJcbiAgICAgKiA5LjAuMyDmlrDlop7mjqXlj6NcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpIHJlYWRvbmx5IGRpc2NvdW50c0NoYW5nZTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQENvbnRlbnRDaGlsZChUZW1wbGF0ZVJlZikgbGVmdFpvbmVFbGUxOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZnJlZWNoYXJnZURldGFpbExpbms6IHN0cmluZyA9ICcnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiB0aXDkuK3nmoTooajlpLRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHByaWNlbGlzdEhlYWQ6IHN0cmluZyA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBCdXlsYXllci5idXlMYXllcl9jb3N0X3ByaWNlbGlzdDtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbWFqb3JQcmljZU51bTogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5piv5ZCm5Y+q5pyJ5Li76KaB5Lu35qC844CC5b2T5Y+q5pyJ5Li76KaB5Lu35qC85pe277yM6K6h6LS56K+m5oOFdGlw5Zyo5Li76KaB5Lu35qC85ZCO77yb5b2T5pyJ5qyh6KaB6LS555So5pe277yM5Zyo5qyh6KaB5Lu35qC85LmL5ZCO44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbmx5SGFzTWFqb3JwcmljZTogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5Li76KaB5Lu35qC85piv5ZCm5YyF5ZCr5pWw5a2X44CC5aaC5p6c5YyF5ZCr5YiZ6ZyA6KaB5Ye6546w6K6h6LS56K+m5oOF77yM5ZCm5YiZ5LiN5Ye6546w44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBoYXNOdW1iZXJvZk1ham9ycHJpY2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5piv5ZCm5pi+56S65Li76KaB5Lu35qC855qE5LyY5oOg6K+m5oOFXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG93TWFqb3JEaXNjb3VudDogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5piv5ZCm5pi+56S65qyh6KaB5Lu35qC855qE5LyY5oOg6K+m5oOFXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG93TWlub3JEaXNjb3VudDogYm9vbGVhbjtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5Li76KaB5Lu35qC85piv5ZCm5YWo6ZqQ6JePXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpc01ham9yUHJpY2VBbGxIaWRlOiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDmrKHopoHku7fmoLzmmK/lkKblhajpmpDol49cclxuICAgICAqL1xyXG4gICAgcHVibGljIGlzTWlub3JQcmljZUFsbEhpZGU6IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOa1ruWxguWunumZheWRiOeOsOeahOS7t+agvOaVsOe7hOmbhuWQiFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmluYWxDb3N0czogQXJyYXk8VHBDb3N0cz47XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dXNlLWxpZmUtY3ljbGUtaW50ZXJmYWNlXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uSW5pdCgpO1xyXG4gICAgICAgIGNvbnN0IHJvdXRlTGluazogc3RyaW5nID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cEJ1eWxheWVyLmJ1eUxheWVyX2ZyZWVDaGFyZ2VfZGV0YWlsTGluaztcclxuXHJcbiAgICAgICAgdGhpcy5jb3N0c0NoYW5nZSgpO1xyXG5cclxuICAgICAgICB0aGlzLmRpc2NvdW50Q2hhbmdlKCk7XHJcblxyXG4gICAgICAgIGlmICghVXRpbC5pc1VuZGVmaW5lZCh0aGlzLm51bUZvcm1hdCkgJiYgIVV0aWwuaXNVbmRlZmluZWQodGhpcy5tYWpvckRpc2NvdXRzQ29uZmlnKSkge1xyXG4gICAgICAgICAgICAvLyDmta7lsYLphY3nva7nmoTku7fmoLznsr7luqblkIzmoLfkvZznlKjliLDkvJjmg6Dor6bmg4Xpg6jliIbvvIzkuKTogIXkv53mjIHkuIDoh7TjgIJcclxuICAgICAgICAgICAgdGhpcy5tYWpvckRpc2NvdXRzQ29uZmlnLm51bUZvcm1hdCA9IHRoaXMubnVtRm9ybWF0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQ2ZVdGlsLmdldExpbmtzKClcclxuICAgICAgICAgICAgLnRoZW4oKGxpbmtzRGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rc0RhdGEgJiYgbGlua3NEYXRhLmxpbmtzICYmIGxpbmtzRGF0YS5saW5rcy51c2VyX2NlbnRlcl9jb21tb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZnJlZWNoYXJnZURldGFpbExpbmsgPSB0aGlzLmFkZExpbmtQYXJhbXMobGlua3NEYXRhLmxpbmtzLnVzZXJfY2VudGVyX2NvbW1vbiArIHJvdXRlTGluayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dXNlLWxpZmUtY3ljbGUtaW50ZXJmYWNlXHJcbiAgICBuZ09uQ2hhbmdlcygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNvc3RzQ2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy5kaXNjb3VudENoYW5nZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIVV0aWwuaXNBcnJheSh0aGlzLmNvc3RzKSB8fCB0aGlzLmNvc3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNvc3Rz5Yqo5oCBaGlkZeS5i+WQju+8jOmHjeaWsOiOt+WPluS4u+asoeimgeS7t+agvOaVsOe7hO+8jOW5tuS4lOaWsOaVsOe7hOeahOesrOS4gOmhue+8iOWktOmDqOS7t+agvO+8ieS4jeW4puWKoOWPt+i/nuaOpeesplxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRNYWpvckNvc3RzID0gdGhpcy5jb3N0cy5maWx0ZXIoKGl0ZW06IFRwQ29zdHMpID0+ICFpdGVtLmhpZGUgJiYgaXRlbS5tYWpvclByaWNlKTtcclxuICAgICAgICBjb25zdCBjdXJyZW50TWlub3JDb3N0cyA9IHRoaXMuY29zdHMuZmlsdGVyKChpdGVtOiBUcENvc3RzKSA9PiAhaXRlbS5oaWRlICYmICFpdGVtLm1ham9yUHJpY2UpO1xyXG4gICAgICAgIGN1cnJlbnRNYWpvckNvc3RzLmZvckVhY2goKGl0ZW06IFRwQ29zdHMsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgaXRlbS5oaWRlQ29ubmVjdFN5bWJvbCA9ICFpbmRleDtcclxuICAgICAgICB9KVxyXG4gICAgICAgIGN1cnJlbnRNaW5vckNvc3RzLmZvckVhY2goKGl0ZW06IFRwQ29zdHMsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgaXRlbS5oaWRlQ29ubmVjdFN5bWJvbCA9ICFpbmRleDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIOaVsOaNruWIneWni+WMluWPiuWPmOabtOS5i+WQjumDvemcgOaJp+ihjFxyXG4gICAgcHJpdmF0ZSBjb3N0c0NoYW5nZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNldE1ham9yUHJpY2UoKTtcclxuICAgICAgICB0aGlzLmZpbmFsQ29zdHMgPSB0aGlzLmNvc3RzLmZpbHRlcigoaXRlbTogVHBDb3N0cykgPT4gIWl0ZW0uaGlkZSk7XHJcbiAgICAgICAgdGhpcy5tYWpvclByaWNlTnVtID0gdGhpcy5nZXRNYWpvclByaWNlTnVtKCk7XHJcbiAgICAgICAgdGhpcy5pc0Nvc3RzQWxsSGlkZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzUmVmdW5kKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UmVmdW5kUGFyYW1zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm9ubHlIYXNNYWpvcnByaWNlID0gdGhpcy5maW5hbENvc3RzICYmIHRoaXMuZmluYWxDb3N0cy5sZW5ndGggPiAwICYmIHRoaXMubWFqb3JQcmljZU51bSA9PT0gdGhpcy5maW5hbENvc3RzLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGhhc0Rpc2NvdW50c0RhdGEoY29uZmlnOiBUcERpc2NvdXRzQ29uZmlnKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgaGFzU2VsZWN0YWJsZURpc2NvdW50czogYm9vbGVhbiA9IFV0aWwuaXNBcnJheShjb25maWcuc2VsZWN0YWJsZURpc2NvdW50cykgJiYgY29uZmlnLnNlbGVjdGFibGVEaXNjb3VudHMubGVuZ3RoID4gMDtcclxuICAgICAgICBjb25zdCBoYXNTZWxlY3RlZERpc2NvdW50czogYm9vbGVhbiA9IFV0aWwuaXNBcnJheShjb25maWcuc2VsZWN0ZWREaXNjb3VudHMpICYmIGNvbmZpZy5zZWxlY3RlZERpc2NvdW50cy5sZW5ndGggPiAwO1xyXG4gICAgICAgIGNvbnN0IGhhc0Rpc2NvdW50czogYm9vbGVhbiA9IFV0aWwuaXNBcnJheShjb25maWcuZGlzY291bnRzKSAmJiBjb25maWcuZGlzY291bnRzLmxlbmd0aCA+IDA7XHJcblxyXG4gICAgICAgIHJldHVybiBoYXNEaXNjb3VudHMgfHwgKGhhc1NlbGVjdGVkRGlzY291bnRzIHx8IGhhc1NlbGVjdGFibGVEaXNjb3VudHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGlzY291bnRDaGFuZ2UoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKFRwVXRpbC5pc09iamVjdCh0aGlzLm1ham9yRGlzY291dHNDb25maWcpICYmIHRoaXMuaGFzRGlzY291bnRzRGF0YSh0aGlzLm1ham9yRGlzY291dHNDb25maWcpICYmIHRoaXMubWFqb3JQcmljZU51bSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93TWFqb3JEaXNjb3VudCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93TWFqb3JEaXNjb3VudCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbWlub3JwcmljZU51bTogbnVtYmVyID0gdGhpcy5jb3N0cyAmJiB0aGlzLmNvc3RzLmxlbmd0aCAtIHRoaXMubWFqb3JQcmljZU51bTsgLy8g5b6X5Yiw5qyh6KaB5Lu35qC855qE5pWw55uuXHJcbiAgICAgICAgaWYgKFRwVXRpbC5pc09iamVjdCh0aGlzLm1pbm9yRGlzY291dHNDb25maWcpICYmIHRoaXMuaGFzRGlzY291bnRzRGF0YSh0aGlzLm1pbm9yRGlzY291dHNDb25maWcpICYmIG1pbm9ycHJpY2VOdW0gPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd01pbm9yRGlzY291bnQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd01pbm9yRGlzY291bnQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNoYW5nZSgkZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kaXNjb3VudHNDaGFuZ2UuZW1pdCgkZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgLy8g6I635Y+W5Li76KaB5Lu35qC85pWw6YePXHJcbiAgICBwcml2YXRlIGdldE1ham9yUHJpY2VOdW0oKTogbnVtYmVyIHtcclxuICAgICAgICBpZiAodGhpcy5maW5hbENvc3RzICYmIHRoaXMuZmluYWxDb3N0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGxldCBudW06IG51bWJlciA9IDA7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29zdCBvZiB0aGlzLmZpbmFsQ29zdHMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb3N0Lm1ham9yUHJpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBudW0rKztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc051bWJlcihjb3N0LnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc051bWJlcm9mTWFqb3JwcmljZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbnVtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgICAvLyDliKTmlq3kuLsv5qyh6KaB5Lu35qC85piv5ZCm6YO96ZqQ6JePXHJcbiAgICBwcml2YXRlIGlzQ29zdHNBbGxIaWRlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvc3RzICYmIHRoaXMuY29zdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyDojrflj5bkuLvopoHku7fmoLzpm4blkIhcclxuICAgICAgICAgICAgY29uc3QgbWFqb3JQcmljZUFyciA9IHRoaXMuY29zdHMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLm1ham9yUHJpY2UpO1xyXG4gICAgICAgICAgICAvLyDojrflj5bmrKHopoHku7fmoLzpm4blkIhcclxuICAgICAgICAgICAgY29uc3QgbWlub3JQcmljZUFyciA9IHRoaXMuY29zdHMuZmlsdGVyKChpdGVtKSA9PiAhaXRlbS5tYWpvclByaWNlKTtcclxuICAgICAgICAgICAgdGhpcy5pc01pbm9yUHJpY2VBbGxIaWRlID0gdGhpcy5pc0FsbEhpZGUobWlub3JQcmljZUFycik7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNYWpvclByaWNlQWxsSGlkZSA9IHRoaXMuaXNBbGxIaWRlKG1ham9yUHJpY2VBcnIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgaXNBbGxIaWRlKGFycik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCBpc0FsbEhpZGUgPSB0cnVlO1xyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvc3Qgb2YgYXJyKSB7XHJcbiAgICAgICAgICAgICAgICBpZighY29zdC5oaWRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNBbGxIaWRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlzQWxsSGlkZTtcclxuICAgIH1cclxuICAgIC8vIOiuvue9ruS7t+agvOexu+Wei1xyXG4gICAgcHJpdmF0ZSBzZXRNYWpvclByaWNlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmNvc3RzICYmIHRoaXMuY29zdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvc3Qgb2YgdGhpcy5jb3N0cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKFV0aWwuaXNVbmRlZmluZWQoY29zdC5sYWJlbCkgJiYgIXRoaXMuaXNSZWZ1bmQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb3N0LmxhYmVsID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cEJ1eWxheWVyLmJ1eUxheWVyX2Nvc3RfbGFiZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgY29zdC50aXBUaXRsZSA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBCdXlsYXllci5idXlMYXllcl9jb3N0X2xhYmVsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKFV0aWwuaXNVbmRlZmluZWQoY29zdC5tYWpvclByaWNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvc3QubWFqb3JQcmljZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9rumAgOi0ueWcuuaZr+S4i+eahOebuOWFs+WPguaVsFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNldFJlZnVuZFBhcmFtcygpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5jb3N0cyAmJiB0aGlzLmNvc3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBjb3N0IG9mIHRoaXMuY29zdHMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChVdGlsLmlzVW5kZWZpbmVkKGNvc3QubGFiZWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29zdC5sYWJlbCA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBCdXlsYXllci5idXlMYXllcl9jb3N0X2xhYmVsX3JlZnVuZF9tYWpvcnByaWNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvc3QudGlwVGl0bGUgPSBUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQnV5bGF5ZXIuYnV5TGF5ZXJfY29zdF9sYWJlbF9yZWZ1bmRfZGV0YWlsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjb3N0LnByaWNlbGlzdCAmJiBjb3N0LnByaWNlbGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29zdC5wcmljZWxpc3RbMF0udGl0bGUgPSBUaUxvY2FsZS5nZXRMb2NhbGVXb3JkcygpLnRwQnV5bGF5ZXIuYnV5TGF5ZXJfY29zdF9wcmljZWxpc3RfbGFiZWxfYmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvc3QucHJpY2VsaXN0WzFdLnRpdGxlID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cEJ1eWxheWVyLmJ1eUxheWVyX2Nvc3RfcHJpY2VsaXN0X2xhYmVsX2FmdGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvc3QucHJpY2VsaXN0WzJdID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cEJ1eWxheWVyLmJ1eUxheWVyX2Nvc3RfbGFiZWxfcmVmdW5kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmljZU51bTogY29zdC52YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpY2VsaXN0SGVhZCA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBCdXlsYXllci5idXlMYXllcl9jb3N0X3R5cGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGlzTnVtYmVyKHZhbDogYW55KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIFV0aWwuaXNOdW1iZXIodmFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaXNQb3NpdGl2ZU51bWJlcih2YWw6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBVdGlsLmlzTnVtYmVyKHZhbCkgJiYgdmFsID4gMDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog6LSn5biB5Zu96ZmF5YyWXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRMb2NhbFN5bWJsZSgpOiBhbnkge1xyXG4gICAgICAgIGNvbnN0IGxvY2FsZUtleTogc3RyaW5nID0gVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50aUxvY2FsZUtleTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGdldExvY2FsZUN1cnJlbmN5U3ltYm9sKGxvY2FsZUtleSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6I635Y+WYWdlbmN5SUTlkoxsb2NhbGVcclxuICAgIHByaXZhdGUgYWRkTGlua1BhcmFtcyh1cmw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKHVybCA9PT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVybDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc3RvcmFnZTogYW55ID0gQ2ZVdGlsLmdldFN0b3JhZ2VTZXJ2aWNlKCk7XHJcbiAgICAgICAgaWYgKCEoIVV0aWwuaXNVbmRlZmluZWQoc3RvcmFnZSkgJiYgIVV0aWwuaXNVbmRlZmluZWQoc3RvcmFnZS5jb29raWVTdG9yYWdlKSAmJiBVdGlsLmlzRnVuY3Rpb24oc3RvcmFnZS5jb29raWVTdG9yYWdlLmdldEl0ZW0pKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBhZ2VuY3lJRDogYW55ID0gc3RvcmFnZS5jb29raWVTdG9yYWdlLmdldEl0ZW0oJ2FnZW5jeUlEJyk7XHJcbiAgICAgICAgY29uc3QgbG9jYWxlOiBhbnkgPSBzdG9yYWdlLmNvb2tpZVN0b3JhZ2UuZ2V0SXRlbSgnbG9jYWxlJyk7XHJcbiAgICAgICAgbGV0IGZpbmFsVXJsOiBzdHJpbmcgPSB1cmw7XHJcbiAgICAgICAgaWYgKCFVdGlsLmlzRW1wdHlTdHJpbmcoYWdlbmN5SUQpKSB7XHJcbiAgICAgICAgICAgIGZpbmFsVXJsID0gZmluYWxVcmwgKyAnP2FnZW5jeUlkPScgKyBhZ2VuY3lJRDtcclxuICAgICAgICAgICAgaWYgKCFVdGlsLmlzRW1wdHlTdHJpbmcobG9jYWxlKSkge1xyXG4gICAgICAgICAgICAgICAgZmluYWxVcmwgPSBmaW5hbFVybCArICcmbG9jYWxlPScgKyBsb2NhbGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKCFVdGlsLmlzRW1wdHlTdHJpbmcobG9jYWxlKSkge1xyXG4gICAgICAgICAgICBmaW5hbFVybCA9IGZpbmFsVXJsICsgJz9sb2NhbGU9JyArIGxvY2FsZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmaW5hbFVybDtcclxuICAgIH1cclxuXHJcbn1cclxuIl19