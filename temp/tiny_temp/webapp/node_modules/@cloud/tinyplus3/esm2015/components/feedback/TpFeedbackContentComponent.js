import { Component, ElementRef, EventEmitter, Input, Output, Renderer2 } from '@angular/core';
import { FormBuilder, FormControl } from '@angular/forms';
import { TiBaseComponent, TiBrowser, TiLocale, TiValidators, Util } from '@cloud/tiny3';
import { CfUtil } from '../../cfutils/CfUtil';
/**
 * @ignore
 */
export class TpFeedbackContentComponent extends TiBaseComponent {
    constructor(hostRef, renderer2, fb) {
        super(hostRef, renderer2);
        this.hostRef = hostRef;
        this.renderer2 = renderer2;
        this.fb = fb;
        /**
         * 10.1.4新增
         * 提交问卷成功后事件
         */
        this.submit = new EventEmitter();
        /**
         * @ignore
         */
        this.showheader = true;
        /**
         * 初始化用来存储答案的数组
         */
        this.submitAnswer = [];
        this.vaildrules = {};
        // 得到复选框选中项的个数
        this.getCheckedNumber = (itemArray) => {
            let checkedNum = 0;
            for (const item of itemArray) {
                if (item.checked) {
                    checkedNum++;
                }
            }
            return checkedNum;
        };
        // 检查每个题目的完成情况，返回一个数组
        this.checkQuestion = (questionArray, answerArray) => {
            const resultArray = [];
            for (let i = 0; i < questionArray.length - 1; i++) {
                // 判断问题是否已正确填写. （1）必填 （2）show=true (3)有填写问卷
                if (questionArray[i].show === true && questionArray[i].require === true && answerArray[i].answer.length === 0) {
                    questionArray[i].hasfinshed = false;
                    resultArray[i] = false;
                }
            }
            return resultArray;
        };
        if (location.hostname.indexOf('huaweicloud.com') > -1) {
            TpFeedbackContentComponent.config = TpFeedbackContentComponent.prodConfig;
        }
    }
    ngOnInit() {
        super.ngOnInit();
        this.showQuestions();
    }
    // 初始化展示题目
    showQuestions() {
        const questionArray = this.options.customQuestion;
        this.options.customQuestion = Util.isArray(questionArray) ? questionArray : [];
        // 问题的个数必须是3的倍数
        if (questionArray && questionArray.length % 3 !== 0) {
            console.log('自定义题目的格式不符合规范！'); // 供服务查看
            this.showheader = false;
            return;
        }
        // 获取Feedback词条
        const tpFeedback = TiLocale.getLocaleWords().tpFeedback;
        // 模板中最终渲染的数据
        this.displayData = {
            title: Util.formatEntry(tpFeedback.title, [this.options.serviceName]),
            startDesc: tpFeedback.title_desc,
            questions: [
                {
                    type: 'radio',
                    show: true,
                    require: true,
                    title: [
                        {
                            title: Util.formatEntry(tpFeedback.question1_title, [this.options.serviceName]),
                            type: 'main'
                        },
                        {
                            title: tpFeedback.question1_title_desc
                        }
                    ]
                },
                {
                    type: 'checkbox',
                    show: false,
                    require: true,
                    title: [
                        {
                            title: tpFeedback.question1_title_unSati
                        }
                    ],
                    hasOtherReason: true,
                    options: [
                        {
                            value: '1',
                            remark: tpFeedback.question_unSati_options1
                        },
                        {
                            value: '2',
                            remark: tpFeedback.question_unSati_options2
                        },
                        {
                            value: '3',
                            remark: tpFeedback.question_unSati_options3
                        },
                        {
                            value: '4',
                            remark: tpFeedback.question_unSati_options4
                        },
                        {
                            value: '5',
                            remark: tpFeedback.question_unSati_options5
                        },
                        {
                            value: '6',
                            remark: tpFeedback.question_unSati_options6
                        },
                        {
                            value: '7',
                            remark: tpFeedback.question_unSati_options7
                        },
                        {
                            value: '8',
                            remark: tpFeedback.question_unSati_options8
                        }
                    ]
                },
                {
                    type: 'checkbox',
                    show: false,
                    require: true,
                    title: [
                        {
                            title: tpFeedback.question1_title_sati
                        }
                    ],
                    hasOtherReason: true,
                    options: [
                        {
                            value: '1',
                            remark: tpFeedback.question_sati_options1
                        },
                        {
                            value: '2',
                            remark: tpFeedback.question_sati_options2
                        },
                        {
                            value: '3',
                            remark: tpFeedback.question_sati_options3
                        },
                        {
                            value: '4',
                            remark: tpFeedback.question_sati_options4
                        },
                        {
                            value: '5',
                            remark: tpFeedback.question_sati_options5
                        },
                        {
                            value: '6',
                            remark: tpFeedback.question_sati_options6
                        },
                        {
                            value: '7',
                            remark: tpFeedback.question_sati_options7
                        },
                        {
                            value: '8',
                            remark: tpFeedback.question_sati_options8
                        }
                    ]
                },
                {
                    type: 'essay',
                    show: true,
                    require: false,
                    title: [
                        {
                            title: Util.formatEntry(TiLocale.getLocaleWords().tpFeedback.questionLast_title, [this.options.serviceName])
                        }
                    ]
                }
            ]
        };
        // 用户自定义题目
        if (this.options.allQuestion) {
            this.displayData = Object.assign({}, this.options.allQuestion);
        }
        else if (this.options.customQuestion.length > 0) {
            const customQuestionCopy = Object.assign({}, this.options.customQuestion);
            const keys = Object.keys(customQuestionCopy);
            for (const key of keys) {
                this.displayData.questions.splice(this.displayData.questions.length - 1, 0, customQuestionCopy[key]); // 返回修改后数组
            }
        }
        this.questions = this.displayData.questions;
        for (let i = 0; i < this.questions.length; i++) {
            this.questions[i].questionId = 'question_' + i;
            if (this.questions[i].type === 'checkbox' && this.questions[i].hasOtherReason) {
                this.questions[i].showOtherReason = false;
                // 为每个otherreason创建表单control
                this.vaildrules[`reasonInput_${i}`] = new FormControl('');
                this.form = this.fb.group(this.vaildrules);
            }
            // 存储问题答案
            this.submitAnswer[i] = {
                questionId: this.questions[i].questionId,
                subQuestionId: null,
                subName: this.questions[i].title[0].title,
                answer: [],
                subRemark: [],
                reason: '0'
            };
        }
    }
    /**
     * @ignore
     * 满意度评分触发事件
     * @param value 选择评分值
     * @param index 题目下标值
     */
    onChangeScore(value, index) {
        // 单选的回调函数，每次选择都要清空数组
        this.submitAnswer[index].answer = [];
        this.submitAnswer[index].subRemark = [];
        // 单选题answer和remark是保持一致的。
        this.submitAnswer[index].answer.push(value);
        this.submitAnswer[index].subRemark.push(value);
        /**
         * 约束:
         * （1）题目格式：要求的一个母题需要带两个子题的格式
         * （2）题目顺序：母题，第一个子题目（index+1），第二个子题(index+2)
         */
        if (index % 3 === 0) {
            const firstIndex = index + 1;
            const secondIndex = index + 2;
            const oldFirstShow = this.questions[firstIndex].show;
            const oldSecondShow = this.questions[secondIndex].show;
            this.questions[firstIndex].show = value <= 7 ? true : false;
            this.questions[secondIndex].show = value > 7 ? true : false;
            /**
             * 多选题目且其它原因输入框显示时，重置对应控件
             * IE下，输入框（titext，titextarea）placeholder为中文时，初始化时表单控件会被标记为dirty，进行校验，
             * 通过markAsPristine方法在输入框显示时，将该表单控件标记为 pristine（原始状态），需进行延迟处理
             * 先在该组件进行处理，后续优化
             */
            if (this.questions[firstIndex].show !== oldFirstShow && this.questions[firstIndex].showOtherReason) {
                if (TiBrowser.isIE()) {
                    setTimeout(() => {
                        this.form.controls[`reasonInput_${firstIndex}`].markAsPristine();
                    }, 0);
                }
                this.form.setControl(`reasonInput_${firstIndex}`, new FormControl('', [TiValidators.required, TiValidators.maxLength(400)]));
            }
            if (this.questions[secondIndex].show !== oldSecondShow && this.questions[secondIndex].showOtherReason) {
                if (TiBrowser.isIE()) {
                    setTimeout(() => {
                        this.form.controls[`reasonInput_${secondIndex}`].markAsPristine();
                    }, 0);
                }
                this.form.setControl(`reasonInput_${secondIndex}`, new FormControl('', [TiValidators.required, TiValidators.maxLength(400)]));
            }
        }
        this.questions[index].hasfinshed = true;
    }
    /**
     * @ignore
     * 选中项超过三项时，其余项不可选中，并设置"最多选择三项"的样式。
     */
    onClickItem(event) {
        // IE下选择选项后触发click事件，会冒泡到父级触发halfmodal点击事件，导致弹窗关闭，此处阻止事件冒泡，防止弹窗关闭
        event.stopPropagation();
    }
    /**
     * @ignore
     * 复选框选中事件，最多选择三项
     * @param item 复选项数据
     * @param question 题目数据
     * @param index 复选项下标
     */
    onChangeCheckbox(item, question, index) {
        const questionIndex = this.getIndexByQuestionId(question.questionId);
        const submitQuestion = this.submitAnswer[questionIndex];
        // 失焦校验，输入不能为空且字符个数最多为400
        this.validation = {
            type: 'blur'
        };
        if (this.getCheckedNumber(question.options) > 3) {
            question.checkLimit = true;
            /**
             * 此处使用延时处理
             * 原因：在选择第四个选项后，更改checked属性值为false，会再次触发ngModalChange事件，导致再次选择时，该选项会被选中
             */
            setTimeout(() => {
                item.checked = false;
            }, 0);
            return;
        }
        question.checkLimit = false;
        // 约束：其它原因是多选项中的最后一项
        if (question.hasOtherReason && index === question.options.length - 1) {
            question.showOtherReason = item.checked;
            // 其它输入框显示添加校验规则
            if (question.showOtherReason) {
                this.form.setControl(`reasonInput_${questionIndex}`, new FormControl('', [TiValidators.required, TiValidators.maxLength(400)]));
                /**
                 * IE下，输入框（titext，titextarea）placeholder为中文时，初始化时表单控件会被校验，
                 * 通过markAsPristine方法在输入框显示时，将该表单控件标记为 pristine（原始状态），需进行延迟处理
                 * 先在该组件进行处理，后续优化
                 */
                if (TiBrowser.isIE()) {
                    setTimeout(() => {
                        this.form.controls[`reasonInput_${questionIndex}`].markAsPristine();
                    }, 0);
                }
            }
            else {
                submitQuestion.reason = '0';
            }
        }
        if (item.checked) {
            this.questions[questionIndex].hasfinshed = true;
            submitQuestion.answer.push(index);
            submitQuestion.subRemark.push(item.remark);
        }
        else {
            submitQuestion.answer = submitQuestion.answer.filter((answer) => answer !== index);
            submitQuestion.subRemark = submitQuestion.subRemark.filter((remark) => remark !== item.remark);
        }
    }
    /**
     * @ignore
     * 复选项为其它原因，存储用户输入内容
     * @param question 题目数据
     */
    updateOtherReason(question) {
        const questionIndex = this.getIndexByQuestionId(question.questionId);
        this.submitAnswer[questionIndex].reason = this.form.controls[`reasonInput_${questionIndex}`].value;
    }
    /**
     * @ignore
     * 题目为essay时，存储用户输入文本域内容
     * @param textareaValue 文本域输入内容
     * @param index 题目下标
     */
    updateTextarea(textareaValue, index) {
        this.submitAnswer[index].answer[0] = textareaValue;
        this.submitAnswer[index].subRemark[0] = 'null';
    }
    /**
     * @ignore
     * 提交问卷
     */
    onSubmit() {
        CfUtil.getUser().then((user) => {
            const root = user;
            const camel = CfUtil.getHttpService();
            const msgService = CfUtil.getMessage();
            if (!camel || !msgService || !root || !Util.isFunction(camel.post) || !Util.isFunction(msgService.showSuccess)) {
                return;
            }
            // 题目未显示或其它原因不显示时，移除对应控件
            for (let i = 0; i < this.questions.length; i++) {
                if (!this.questions[i].show || !this.questions[i].showOtherReason) {
                    this.form.removeControl(`reasonInput_${i}`);
                }
            }
            const errors = TiValidators.check(this.form);
            if (this.isRequiredComplete(this.questions, this.submitAnswer) && !errors) {
                for (let i = 0; i < this.submitAnswer.length; i++) {
                    this.submitAnswer[i].answer = this.submitAnswer[i].answer.join();
                    this.submitAnswer[i].subRemark = this.submitAnswer[i].subRemark.join();
                    this.submitAnswer[i].show = this.questions[i].show; // 过滤不显示的题目
                }
                // 过滤未显示题目及删除show属性，不需要发送给后台
                this.submitAnswer = this.submitAnswer.filter((answer) => answer.show !== false);
                for (const answer of this.submitAnswer) {
                    delete answer.show;
                }
                const url = `${TpFeedbackContentComponent.config.backend}/api/save`;
                // 发送请求，向后台发送问卷结果
                const sendData = {
                    data: {
                        surveyId: TpFeedbackContentComponent.config.surveyId,
                        serviceId: this.options.serviceId,
                        w3account: root.domainId,
                        answers: this.submitAnswer
                    }
                };
                camel.post({
                    url: {
                        s: url
                    },
                    params: sendData
                })
                    .then(() => { }, () => { });
                this.submit.emit();
                msgService.showSuccess(TiLocale.getLocaleWords().tpFeedback.submit_success);
            }
            else {
                // 未完成则显示'选择不能为空'提示
                this.checkQuestion(this.questions, this.submitAnswer);
            }
        });
    }
    // 通过问题ID得到属于第几道题目
    getIndexByQuestionId(questionId) {
        for (let i = 0; i < this.submitAnswer.length; i++) {
            if (this.submitAnswer[i].questionId === questionId) {
                return i;
            }
        }
    }
    // 题目是否已完成
    isRequiredComplete(questionArray, answerArray) {
        const resultArray = this.checkQuestion(questionArray, answerArray);
        for (const result of resultArray) {
            if (result === false) {
                return false;
            }
        }
        return true;
    }
}
// 类生产测试环境
TpFeedbackContentComponent.devConfig = {
    backend: 'https://console.ulanqab.huawei.com/nps-api',
    surveyId: 'hwcloudbusurvey_key_fbd25bdbdb87'
};
// 现网环境
TpFeedbackContentComponent.prodConfig = {
    backend: 'https://voc.huaweicloud.com/survey-api',
    surveyId: 'hwcloudbusurvey_key_fbd25bdbdb87'
};
/**
 * @ignore
 */
TpFeedbackContentComponent.config = TpFeedbackContentComponent.devConfig;
TpFeedbackContentComponent.decorators = [
    { type: Component, args: [{
                selector: 'tp-feedback-content',
                template: "<ng-container *ngIf=\"showheader\">\r\n    <div class=\"tp-feedback-title\">{{displayData.title}}</div>\r\n    <div class=\"tp-feedback-introduce\">{{displayData.startDesc}}</div>\r\n</ng-container>\r\n<div  class=\"tp-feedback-question\" *ngFor=\"let question of questions; index as i;\">\r\n    <div *ngIf=\"question.show === true\">\r\n        <!-- \u9898\u76EE\u6807\u9898 -->\r\n        <section class=\"tp-feedback-title-space\"\r\n            [ngClass]=\"{\r\n                'tp-feedback-title-space1': question.type !== 'radio',\r\n                'tp-feedback-title-space2': question.title.length > 1}\">\r\n            <ti-icon name=\"staricon\" class=\"tp-feedback-required-icon\" *ngIf=\"question.type !== 'essay'\"></ti-icon><!--\r\n            --><span class=\"tp-feedback-question-title\">{{question.title[0].title}}</span><!--\r\n            --><span *ngIf=\"question.type === 'checkbox'\" class=\"tp-feedback-checked-prompt\"\r\n               [ngClass]=\"{'tp-feedback-checked-error': question.checkLimit}\">{{ 'tpFeedback.question_checked_limited' | tiTranslate }}</span>\r\n        </section>\r\n\r\n        <!-- \u6EE1\u610F\u5EA6\u8BC4\u5206\u503C\u63CF\u8FF0 -->\r\n        <span class=\"tp-feedback-score-prompt\" *ngIf=\"question.title.length > 1\">{{question.title[1].title}}</span>\r\n\r\n        <!-- \u5B8C\u6210\u540E\u6821\u9A8C -->\r\n        <div class=\"tp-feedback-unifyvalid\" *ngIf=\"question.hasfinshed === false\">\r\n            <tp-icon local name=\"cloud-action-state-failed\" class=\"tp-feedback-unifyvalid-icon\"></tp-icon>\r\n            <span>{{ 'tpFeedback.unifyvalid' | tiTranslate }}</span>\r\n        </div>\r\n\r\n        <!-- \u5355\u9009\u8BC4\u5206\u9898\u76EE -->\r\n        <tp-score *ngIf=\"question.type === 'radio'\"\r\n        [(ngModel)]=\"question.value\"\r\n        (ngModelChange)=\"onChangeScore(question.value, i)\"\r\n        [minText]=\" 'tpFeedback.score_text.minText' | tiTranslate \"\r\n        [maxText]=\"'tpFeedback.score_text.maxText' | tiTranslate \"\r\n        [id]=\"appendId('sore')\"></tp-score>\r\n\r\n        <!-- \u591A\u9009\u9898\u76EE -->\r\n        <div *ngIf=\"question.type === 'checkbox'\">\r\n            <div class=\"tp-feedback-checkbox-list\" *ngFor=\"let item of question.options index as j\">\r\n                <input type=\"checkbox\"\r\n                       [(ngModel)]=\"item.checked\"\r\n                       [label]=\"item.remark\"\r\n                       (ngModelChange)=\"onChangeCheckbox(item, question, j)\" tiCheckbox\r\n                       (click)=\"onClickItem($event)\"\r\n                       [id]=\"appendId('checkbox_' + i + '_' + j)\">\r\n            </div>\r\n        </div>\r\n        <form #contain  [formGroup]=\"form\" *ngIf=\"question.showOtherReason === true\">\r\n            <!-- \u5176\u4ED6\u539F\u56E0\u8F93\u5165\u6846\u8F93\u5165 -->\r\n                <input\r\n                class=\"tp-feedback-other-reason\"\r\n                [tiValidation]=\"validation\"\r\n                [errorMessageWrapper]='contain'\r\n                formControlName=\"{{'reasonInput_'+i}}\"\r\n                placeholder=\"{{ 'tpFeedback.placeholder.text' | tiTranslate }}\"\r\n                (blur)=\"updateOtherReason(question)\" [id]=\"appendId('input' + i)\" tiText>\r\n        </form>\r\n\r\n        <!-- \u7B80\u5355\u9898\u76EE\u6587\u672C\u57DF\u8F93\u5165 -->\r\n        <textarea *ngIf=\"question.type === 'essay'\"\r\n        class=\"tp-feedback-other-suggest-textarea\"\r\n        resize=\"none\"\r\n        maxlength=\"400\"\r\n        [placeholder]=\" 'tpFeedback.placeholder.textarea' | tiTranslate \"\r\n        [(ngModel)]=\"question.textareaValue\"\r\n        [tiValidation]='validation'\r\n        (blur)=\"updateTextarea(question.textareaValue, i)\" [id]=\"appendId('textarea' + i)\" tiTextarea></textarea>\r\n\r\n    </div>\r\n</div>\r\n\r\n<!-- \u7528\u6237\u81EA\u5B9A\u4E49\u5185\u5BB9 -->\r\n<div class=\"tp-feedback-external\">\r\n    <ng-content></ng-content>\r\n</div>\r\n\r\n<!-- \u95EE\u5377\u63D0\u4EA4\u6309\u94AE -->\r\n<div class=\"tp-feedback-submit\">\r\n    <button type=\"button\" color=\"danger\" class=\"tp-feedback-submit-button\" tiButton (click)=\"onSubmit()\" [id]=\"appendId('submit')\">{{ 'tpFeedback.submit_button' | tiTranslate}}</button>\r\n</div>\r\n",
                styles: [".ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}::ng-deep :root{--tp-feedback-halfmodal-space:72px;--tp-feedback-halfmodal-width:560px;--tp-feedback-sumbit-height:80px}:host{display:block;margin-bottom:var(--tp-feedback-sumbit-height)}.tp-feedback-title{color:var(--ti-common-color-text-primary);font-size:var(--ti-common-font-size-4);font-weight:700;line-height:var(--ti-common-line-height-number);padding-bottom:var(--ti-common-space-2x);text-align:left}.tp-feedback-introduce{-ms-box-sizing:border-box;border-bottom:1px solid var(--ti-common-color-line-dividing);box-sizing:border-box;color:var(--ti-common-color-text-weaken);margin-bottom:var(--ti-common-space-5x);padding-bottom:var(--ti-common-space-5x)}.tp-feedback-introduce,.tp-feedback-question{font-size:var(--ti-common-font-size-base);line-height:var(--ti-common-line-height-number)}.tp-feedback-question{color:var(--ti-common-color-text-primary);margin-bottom:var(--ti-common-space-4x);position:relative}.tp-feedback-question .ti3-icon-staricon{color:var(--ti-common-color-error);font-size:var(--ti-common-font-size-1);line-height:var(--ti-common-line-height-number);padding-right:var(--ti-common-space-base)}.tp-feedback-question:last-child{margin-bottom:0}.tp-feedback-required-icon{left:-15px;position:absolute}.tp-feedback-question-title{color:var(--ti-common-color-text-primary);font-size:var(--ti-common-font-size-1);font-weight:700;line-height:var(--ti-common-line-height-number)}.tp-feedback-title-space{padding-bottom:var(--ti-common-space-4x)}.tp-feedback-title-space1{padding-bottom:var(--ti-common-space-3x)}.tp-feedback-title-space2{padding-bottom:var(--ti-common-space-base)}.tp-feedback-score-prompt{color:var(--ti-common-color-text-weaken);display:inline-block;margin-bottom:var(--ti-common-space-4x)}.tp-feedback-checked-prompt{color:var(--ti-common-color-text-weaken);padding-bottom:var(--ti-common-space-4x)}.tp-feedback-checked-error{color:var(--ti-common-color-error)}.tp-feedback-checkbox-list{-ms-box-sizing:border-box;box-sizing:border-box;display:inline-block;margin-bottom:var(--ti-common-space-5x);padding-right:var(--ti-common-space-5x);vertical-align:top;width:50%}.tp-feedback-checkbox-list:last-child,.tp-feedback-checkbox-list:nth-last-child(2){margin-bottom:0}.tp-feedback-other-reason{margin-bottom:var(--ti-common-space-2x);margin-top:var(--ti-common-space-4x);width:calc(100% - 17px)}::ng-deep .tp-feedback-other-suggest-textarea{height:136px!important;width:calc(100% - 17px)!important}.tp-feedback-submit{-ms-box-sizing:border-box;animation:show-submit .25s forwards;background:var(--ti-common-color-bg-white-normal);border-top:1px solid var(--ti-common-color-line-dividing);bottom:-1px;box-sizing:border-box;height:var(--tp-feedback-sumbit-height);padding-top:var(--ti-common-space-5x);position:fixed;right:-560px;width:calc(var(--tp-feedback-halfmodal-width) - var(--tp-feedback-halfmodal-space))}.tp-feedback-submit .tp-feedback-submit-button{float:right}@keyframes show-submit{to{right:40px}}.tp-feedback-unifyvalid{align-items:center;color:var(--ti-common-color-error);display:flex;line-height:24px;margin-bottom:var(--ti-common-space-4x);margin-top:calc(-1*var(--ti-common-space-3x))}.tp-feedback-unifyvalid-icon{color:var(--ti-common-color-error);font-size:var(--ti-common-font-size-2);margin-right:var(--ti-common-space-10)}.tp-feedback-external{padding-top:var(--ti-common-space-base)}"]
            },] }
];
TpFeedbackContentComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: FormBuilder }
];
TpFeedbackContentComponent.propDecorators = {
    options: [{ type: Input }],
    submit: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHBGZWVkYmFja0NvbnRlbnRDb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9AY2xvdWQvdGlueXBsdXMzL2NvbXBvbmVudHMvZmVlZGJhY2svVHBGZWVkYmFja0NvbnRlbnRDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzlGLE9BQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUErQixNQUFNLGdCQUFnQixDQUFDO0FBQ3ZGLE9BQU8sRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBc0IsWUFBWSxFQUFFLElBQUksRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUU1RyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFJOUM7O0dBRUc7QUFPSCxNQUFNLE9BQU8sMEJBQTJCLFNBQVEsZUFBZTtJQTJEM0QsWUFBc0IsT0FBbUIsRUFBWSxTQUFvQixFQUNyRCxFQUFlO1FBQy9CLEtBQUssQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFGUixZQUFPLEdBQVAsT0FBTyxDQUFZO1FBQVksY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNyRCxPQUFFLEdBQUYsRUFBRSxDQUFhO1FBeENuQzs7O1dBR0c7UUFDZ0IsV0FBTSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBRWxFOztXQUVHO1FBQ0ksZUFBVSxHQUFZLElBQUksQ0FBQztRQVFsQzs7V0FFRztRQUNLLGlCQUFZLEdBQWUsRUFBRSxDQUFDO1FBaUI5QixlQUFVLEdBQVEsRUFBRSxDQUFDO1FBNFo3QixjQUFjO1FBQ04scUJBQWdCLEdBQStCLENBQUMsU0FBYyxFQUFFLEVBQUU7WUFDdEUsSUFBSSxVQUFVLEdBQVcsQ0FBQyxDQUFDO1lBQzNCLEtBQUssTUFBTSxJQUFJLElBQUksU0FBUyxFQUFFO2dCQUMxQixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7b0JBQ2QsVUFBVSxFQUFFLENBQUM7aUJBQ2hCO2FBQ0o7WUFFRCxPQUFPLFVBQVUsQ0FBQztRQUN0QixDQUFDLENBQUE7UUFFRCxxQkFBcUI7UUFDYixrQkFBYSxHQUFrRCxDQUFDLGFBQWtCLEVBQUUsV0FBZ0IsRUFBRSxFQUFFO1lBQzVHLE1BQU0sV0FBVyxHQUFtQixFQUFFLENBQUM7WUFDdkMsS0FBSyxJQUFJLENBQUMsR0FBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN2RCwyQ0FBMkM7Z0JBQzNDLElBQUksYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxJQUFJLElBQUksYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sS0FBSyxJQUFJLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO29CQUMzRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztvQkFDcEMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQztpQkFDMUI7YUFDSjtZQUVELE9BQU8sV0FBVyxDQUFDO1FBRXZCLENBQUMsQ0FBQTtRQWhiRyxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDbkQsMEJBQTBCLENBQUMsTUFBTSxHQUFHLDBCQUEwQixDQUFDLFVBQVUsQ0FBQztTQUM3RTtJQUNMLENBQUM7SUFFRCxRQUFRO1FBQ0osS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDO0lBRUQsVUFBVTtJQUNGLGFBQWE7UUFDakIsTUFBTSxhQUFhLEdBQTRCLElBQUksQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDO1FBQzNFLElBQUksQ0FBQyxPQUFPLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQy9FLGVBQWU7UUFDZixJQUFJLGFBQWEsSUFBSSxhQUFhLENBQUMsTUFBTSxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDakQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsUUFBUTtZQUN2QyxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztZQUV4QixPQUFPO1NBQ1Y7UUFFRCxlQUFlO1FBQ2YsTUFBTSxVQUFVLEdBQVEsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQVUsQ0FBQztRQUU3RCxhQUFhO1FBQ2IsSUFBSSxDQUFDLFdBQVcsR0FBRztZQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3JFLFNBQVMsRUFBRSxVQUFVLENBQUMsVUFBVTtZQUNoQyxTQUFTLEVBQUU7Z0JBQ1A7b0JBQ0ksSUFBSSxFQUFFLE9BQU87b0JBQ2IsSUFBSSxFQUFFLElBQUk7b0JBQ1YsT0FBTyxFQUFFLElBQUk7b0JBQ2IsS0FBSyxFQUFFO3dCQUNIOzRCQUNJLEtBQUssRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDOzRCQUMvRSxJQUFJLEVBQUUsTUFBTTt5QkFDZjt3QkFDRDs0QkFDSSxLQUFLLEVBQUUsVUFBVSxDQUFDLG9CQUFvQjt5QkFDekM7cUJBQ0o7aUJBQ0o7Z0JBQ0Q7b0JBQ0ksSUFBSSxFQUFFLFVBQVU7b0JBQ2hCLElBQUksRUFBRSxLQUFLO29CQUNYLE9BQU8sRUFBRSxJQUFJO29CQUNiLEtBQUssRUFBRTt3QkFDSDs0QkFDSSxLQUFLLEVBQUUsVUFBVSxDQUFDLHNCQUFzQjt5QkFDM0M7cUJBQ0o7b0JBQ0QsY0FBYyxFQUFFLElBQUk7b0JBQ3BCLE9BQU8sRUFBRTt3QkFDTDs0QkFDSSxLQUFLLEVBQUUsR0FBRzs0QkFDVixNQUFNLEVBQUUsVUFBVSxDQUFDLHdCQUF3Qjt5QkFDOUM7d0JBQ0Q7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyx3QkFBd0I7eUJBQzlDO3dCQUNEOzRCQUNJLEtBQUssRUFBRSxHQUFHOzRCQUNWLE1BQU0sRUFBRSxVQUFVLENBQUMsd0JBQXdCO3lCQUM5Qzt3QkFDRDs0QkFDSSxLQUFLLEVBQUUsR0FBRzs0QkFDVixNQUFNLEVBQUUsVUFBVSxDQUFDLHdCQUF3Qjt5QkFDOUM7d0JBQ0Q7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyx3QkFBd0I7eUJBQzlDO3dCQUNEOzRCQUNJLEtBQUssRUFBRSxHQUFHOzRCQUNWLE1BQU0sRUFBRSxVQUFVLENBQUMsd0JBQXdCO3lCQUM5Qzt3QkFDRDs0QkFDSSxLQUFLLEVBQUUsR0FBRzs0QkFDVixNQUFNLEVBQUUsVUFBVSxDQUFDLHdCQUF3Qjt5QkFDOUM7d0JBQ0Q7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyx3QkFBd0I7eUJBQzlDO3FCQUNKO2lCQUNKO2dCQUNEO29CQUNJLElBQUksRUFBRSxVQUFVO29CQUNoQixJQUFJLEVBQUUsS0FBSztvQkFDWCxPQUFPLEVBQUUsSUFBSTtvQkFDYixLQUFLLEVBQUU7d0JBQ0g7NEJBQ0ksS0FBSyxFQUFFLFVBQVUsQ0FBQyxvQkFBb0I7eUJBQ3pDO3FCQUNKO29CQUNELGNBQWMsRUFBRSxJQUFJO29CQUNwQixPQUFPLEVBQUU7d0JBQ0w7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyxzQkFBc0I7eUJBQzVDO3dCQUNEOzRCQUNJLEtBQUssRUFBRSxHQUFHOzRCQUNWLE1BQU0sRUFBRSxVQUFVLENBQUMsc0JBQXNCO3lCQUM1Qzt3QkFDRDs0QkFDSSxLQUFLLEVBQUUsR0FBRzs0QkFDVixNQUFNLEVBQUUsVUFBVSxDQUFDLHNCQUFzQjt5QkFDNUM7d0JBQ0Q7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyxzQkFBc0I7eUJBQzVDO3dCQUNEOzRCQUNJLEtBQUssRUFBRSxHQUFHOzRCQUNWLE1BQU0sRUFBRSxVQUFVLENBQUMsc0JBQXNCO3lCQUM1Qzt3QkFDRDs0QkFDSSxLQUFLLEVBQUUsR0FBRzs0QkFDVixNQUFNLEVBQUUsVUFBVSxDQUFDLHNCQUFzQjt5QkFDNUM7d0JBQ0Q7NEJBQ0ksS0FBSyxFQUFFLEdBQUc7NEJBQ1YsTUFBTSxFQUFFLFVBQVUsQ0FBQyxzQkFBc0I7eUJBQzVDO3dCQUNEOzRCQUNJLEtBQUssRUFBRSxHQUFHOzRCQUNWLE1BQU0sRUFBRSxVQUFVLENBQUMsc0JBQXNCO3lCQUM1QztxQkFDSjtpQkFDSjtnQkFDRDtvQkFDSSxJQUFJLEVBQUUsT0FBTztvQkFDYixJQUFJLEVBQUUsSUFBSTtvQkFDVixPQUFPLEVBQUUsS0FBSztvQkFDZCxLQUFLLEVBQUU7d0JBQ0g7NEJBQ0ksS0FBSyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7eUJBQy9HO3FCQUNKO2lCQUNKO2FBQ0o7U0FDSixDQUFDO1FBRUYsVUFBVTtRQUNWLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUU7WUFDMUIsSUFBSSxDQUFDLFdBQVcscUJBQVEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUUsQ0FBQztTQUN0RDthQUFNLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMvQyxNQUFNLGtCQUFrQixxQkFBYSxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBRSxDQUFDO1lBQ25FLE1BQU0sSUFBSSxHQUFRLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUNsRCxLQUFLLE1BQU0sR0FBRyxJQUFJLElBQUksRUFBRTtnQkFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVO2FBQ25IO1NBQ0o7UUFDRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDO1FBRTVDLEtBQUssSUFBSSxDQUFDLEdBQVcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNwRCxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsR0FBRyxXQUFXLEdBQUcsQ0FBQyxDQUFDO1lBQy9DLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssVUFBVSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxFQUFFO2dCQUMzRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7Z0JBRTFDLDRCQUE0QjtnQkFDNUIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQzFELElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2FBRTlDO1lBRUQsU0FBUztZQUNULElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLEdBQUc7Z0JBQ25CLFVBQVUsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVU7Z0JBQ3hDLGFBQWEsRUFBRSxJQUFJO2dCQUNuQixPQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSztnQkFDekMsTUFBTSxFQUFFLEVBQUU7Z0JBQ1YsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsTUFBTSxFQUFFLEdBQUc7YUFDZCxDQUFDO1NBQ0w7SUFDTCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxhQUFhLENBQUMsS0FBYSxFQUFFLEtBQWE7UUFDdEMscUJBQXFCO1FBQ3JCLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUNyQyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFFeEMsMEJBQTBCO1FBQzFCLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFL0M7Ozs7V0FJRztRQUNILElBQUksS0FBSyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDakIsTUFBTSxVQUFVLEdBQVcsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUNyQyxNQUFNLFdBQVcsR0FBVyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sWUFBWSxHQUFZLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQzlELE1BQU0sYUFBYSxHQUFZLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBRWhFLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxHQUFHLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBQzVELElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBRTVEOzs7OztlQUtHO1lBQ0gsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksS0FBSyxZQUFZLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxlQUFlLEVBQUU7Z0JBQ2hHLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxFQUFFO29CQUNsQixVQUFVLENBQUMsR0FBRyxFQUFFO3dCQUNaLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsVUFBVSxFQUFFLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDckUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2lCQUNUO2dCQUNELElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsVUFBVSxFQUFFLEVBQUUsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUFFLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxZQUFZLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ2hJO1lBRUQsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksS0FBSyxhQUFhLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxlQUFlLEVBQUU7Z0JBQ25HLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxFQUFFO29CQUNsQixVQUFVLENBQUMsR0FBRyxFQUFFO3dCQUNaLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsV0FBVyxFQUFFLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDdEUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2lCQUNUO2dCQUNELElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsV0FBVyxFQUFFLEVBQUUsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUFFLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxZQUFZLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ2pJO1NBQ0o7UUFFRCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7SUFFNUMsQ0FBQztJQUVEOzs7T0FHRztJQUNILFdBQVcsQ0FBQyxLQUFZO1FBQ3BCLGlFQUFpRTtRQUNqRSxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILGdCQUFnQixDQUFDLElBQVMsRUFBRSxRQUFhLEVBQUUsS0FBYTtRQUNwRCxNQUFNLGFBQWEsR0FBVyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzdFLE1BQU0sY0FBYyxHQUFRLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFN0QseUJBQXlCO1FBQ3pCLElBQUksQ0FBQyxVQUFVLEdBQUc7WUFDZCxJQUFJLEVBQUUsTUFBTTtTQUNmLENBQUM7UUFFRixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQzdDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQzNCOzs7ZUFHRztZQUNILFVBQVUsQ0FBQyxHQUFHLEVBQUU7Z0JBQ1osSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDekIsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRU4sT0FBTztTQUNWO1FBRUQsUUFBUSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDNUIsb0JBQW9CO1FBQ3BCLElBQUksUUFBUSxDQUFDLGNBQWMsSUFBSSxLQUFLLEtBQUssUUFBUSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ2xFLFFBQVEsQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUV4QyxnQkFBZ0I7WUFDaEIsSUFBSSxRQUFRLENBQUMsZUFBZSxFQUFFO2dCQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxlQUFlLGFBQWEsRUFBRSxFQUFFLElBQUksV0FBVyxDQUFDLEVBQUUsRUFBRSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDaEk7Ozs7bUJBSUc7Z0JBQ0gsSUFBSSxTQUFTLENBQUMsSUFBSSxFQUFFLEVBQUU7b0JBQ2xCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7d0JBQ1osSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxhQUFhLEVBQUUsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUN4RSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7aUJBQ1Q7YUFDSjtpQkFBTTtnQkFDSCxjQUFjLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQzthQUMvQjtTQUNKO1FBRUQsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQ2hELGNBQWMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2xDLGNBQWMsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUM5QzthQUFNO1lBQ0gsY0FBYyxDQUFDLE1BQU0sR0FBRyxjQUFjLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQVcsRUFBRSxFQUFFLENBQUMsTUFBTSxLQUFLLEtBQUssQ0FBQyxDQUFDO1lBQ3hGLGNBQWMsQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFXLEVBQUUsRUFBRSxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDdkc7SUFDTCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILGlCQUFpQixDQUFDLFFBQWE7UUFDM0IsTUFBTSxhQUFhLEdBQVcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUM3RSxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLGFBQWEsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDO0lBQ3ZHLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILGNBQWMsQ0FBQyxhQUFxQixFQUFFLEtBQWE7UUFDL0MsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsYUFBYSxDQUFDO1FBQ25ELElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQztJQUNuRCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsUUFBUTtRQUNKLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtZQUNoQyxNQUFNLElBQUksR0FBUSxJQUFJLENBQUM7WUFDdkIsTUFBTSxLQUFLLEdBQVEsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQzNDLE1BQU0sVUFBVSxHQUFRLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUM1QyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsVUFBVSxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsRUFBRTtnQkFDNUcsT0FBTzthQUNWO1lBRUQsd0JBQXdCO1lBQ3hCLEtBQUssSUFBSSxDQUFDLEdBQVcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDcEQsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlLEVBQUU7b0JBQy9ELElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztpQkFDL0M7YUFDSjtZQUVELE1BQU0sTUFBTSxHQUE0QixZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUV0RSxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFFdkUsS0FBSyxJQUFJLENBQUMsR0FBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUN2RCxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQkFDakUsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7b0JBQ3ZFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsV0FBVztpQkFDbEU7Z0JBRUQsNEJBQTRCO2dCQUM1QixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBVyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDO2dCQUNyRixLQUFLLE1BQU0sTUFBTSxJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUU7b0JBQ3BDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQztpQkFDdEI7Z0JBRUQsTUFBTSxHQUFHLEdBQVcsR0FBRywwQkFBMEIsQ0FBQyxNQUFNLENBQUMsT0FBTyxXQUFXLENBQUM7Z0JBRTVFLGlCQUFpQjtnQkFDakIsTUFBTSxRQUFRLEdBQVE7b0JBQ2xCLElBQUksRUFBRTt3QkFDRixRQUFRLEVBQUUsMEJBQTBCLENBQUMsTUFBTSxDQUFDLFFBQVE7d0JBQ3BELFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVM7d0JBQ2pDLFNBQVMsRUFBRSxJQUFJLENBQUMsUUFBUTt3QkFDeEIsT0FBTyxFQUFFLElBQUksQ0FBQyxZQUFZO3FCQUM3QjtpQkFDSixDQUFDO2dCQUVGLEtBQUssQ0FBQyxJQUFJLENBQUM7b0JBQ1AsR0FBRyxFQUFFO3dCQUNELENBQUMsRUFBRSxHQUFHO3FCQUNUO29CQUNELE1BQU0sRUFBRSxRQUFRO2lCQUNuQixDQUFDO3FCQUNHLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7Z0JBRWhDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ25CLFVBQVUsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQzthQUMvRTtpQkFBTTtnQkFDSCxtQkFBbUI7Z0JBQ25CLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7YUFDekQ7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxrQkFBa0I7SUFDVixvQkFBb0IsQ0FBQyxVQUFrQjtRQUMzQyxLQUFLLElBQUksQ0FBQyxHQUFXLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDdkQsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsS0FBSyxVQUFVLEVBQUU7Z0JBQ2hELE9BQU8sQ0FBQyxDQUFDO2FBQ1o7U0FDSjtJQUVMLENBQUM7SUE2QkQsVUFBVTtJQUNGLGtCQUFrQixDQUFDLGFBQWtCLEVBQUUsV0FBZ0I7UUFDM0QsTUFBTSxXQUFXLEdBQVEsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDeEUsS0FBSyxNQUFNLE1BQU0sSUFBSSxXQUFXLEVBQUU7WUFDOUIsSUFBSSxNQUFNLEtBQUssS0FBSyxFQUFFO2dCQUNsQixPQUFPLEtBQUssQ0FBQzthQUNoQjtTQUNKO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQzs7QUF6ZkQsVUFBVTtBQUNLLG9DQUFTLEdBQVE7SUFDNUIsT0FBTyxFQUFFLDRDQUE0QztJQUNyRCxRQUFRLEVBQUUsa0NBQWtDO0NBQy9DLENBQUM7QUFDRixPQUFPO0FBQ1EscUNBQVUsR0FBUTtJQUM3QixPQUFPLEVBQUUsd0NBQXdDO0lBQ2pELFFBQVEsRUFBRSxrQ0FBa0M7Q0FDL0MsQ0FBQztBQUVGOztHQUVHO0FBQ1csaUNBQU0sR0FBUSwwQkFBMEIsQ0FBQyxTQUFTLENBQUM7O1lBckJwRSxTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLHFCQUFxQjtnQkFDL0IsaXZJQUFzQzs7YUFFekM7OztZQWZtQixVQUFVO1lBQStCLFNBQVM7WUFDN0QsV0FBVzs7O3NCQW1DZixLQUFLO3FCQUtMLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtQ29udHJvbCwgRm9ybUdyb3VwLCBWYWxpZGF0aW9uRXJyb3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBUaUJhc2VDb21wb25lbnQsIFRpQnJvd3NlciwgVGlMb2NhbGUsIFRpVmFsaWRhdGlvbkNvbmZpZywgVGlWYWxpZGF0b3JzLCBVdGlsIH0gZnJvbSAnQGNsb3VkL3RpbnkzJztcclxuXHJcbmltcG9ydCB7IENmVXRpbCB9IGZyb20gJy4uLy4uL2NmdXRpbHMvQ2ZVdGlsJztcclxuXHJcbmltcG9ydCB7IFRwRmVlZGJhY2tPcHRpb25zLCBUcFF1ZXN0aW9uT3B0aW9uIH0gZnJvbSAnLi9UcEZlZWRiYWNrSW50ZXJmYWNlJztcclxuXHJcbi8qKlxyXG4gKiBAaWdub3JlXHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAndHAtZmVlZGJhY2stY29udGVudCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZmVlZGJhY2stY29udGVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2ZlZWRiYWNrLWNvbnRlbnQubGVzcyddXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgVHBGZWVkYmFja0NvbnRlbnRDb21wb25lbnQgZXh0ZW5kcyBUaUJhc2VDb21wb25lbnQge1xyXG4gICAgLy8g57G755Sf5Lqn5rWL6K+V546v5aKDXHJcbiAgICBwcml2YXRlIHN0YXRpYyBkZXZDb25maWc6IGFueSA9IHtcclxuICAgICAgICBiYWNrZW5kOiAnaHR0cHM6Ly9jb25zb2xlLnVsYW5xYWIuaHVhd2VpLmNvbS9ucHMtYXBpJyxcclxuICAgICAgICBzdXJ2ZXlJZDogJ2h3Y2xvdWRidXN1cnZleV9rZXlfZmJkMjViZGJkYjg3J1xyXG4gICAgfTtcclxuICAgIC8vIOeOsOe9keeOr+Wig1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgcHJvZENvbmZpZzogYW55ID0ge1xyXG4gICAgICAgIGJhY2tlbmQ6ICdodHRwczovL3ZvYy5odWF3ZWljbG91ZC5jb20vc3VydmV5LWFwaScsXHJcbiAgICAgICAgc3VydmV5SWQ6ICdod2Nsb3VkYnVzdXJ2ZXlfa2V5X2ZiZDI1YmRiZGI4NydcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgY29uZmlnOiBhbnkgPSBUcEZlZWRiYWNrQ29udGVudENvbXBvbmVudC5kZXZDb25maWc7XHJcbiAgICAvKipcclxuICAgICAqIOe7hOS7tuaVsOaNrlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBvcHRpb25zOiBUcEZlZWRiYWNrT3B0aW9ucztcclxuICAgIC8qKlxyXG4gICAgICogMTAuMS405paw5aKeXHJcbiAgICAgKiDmj5DkuqTpl67ljbfmiJDlip/lkI7kuovku7ZcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpIHJlYWRvbmx5IHN1Ym1pdDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG93aGVhZGVyOiBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIOWIneWni+WMlueUqOadpeWtmOWCqOetlOahiOeahOaVsOe7hFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZGlzcGxheURhdGE6IGFueTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMlueUqOadpeWtmOWCqOetlOahiOeahOaVsOe7hFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN1Ym1pdEFuc3dlcjogQXJyYXk8YW55PiA9IFtdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcXVlc3Rpb25zOiBhbnk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB2YWxpZGF0aW9uOiBUaVZhbGlkYXRpb25Db25maWc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBmb3JtOiBGb3JtR3JvdXA7XHJcblxyXG4gICAgcHJpdmF0ZSB2YWlsZHJ1bGVzOiBhbnkgPSB7fTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaG9zdFJlZjogRWxlbWVudFJlZiwgcHJvdGVjdGVkIHJlbmRlcmVyMjogUmVuZGVyZXIyLFxyXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBmYjogRm9ybUJ1aWxkZXIpIHtcclxuICAgICAgICBzdXBlcihob3N0UmVmLCByZW5kZXJlcjIpO1xyXG4gICAgICAgIGlmIChsb2NhdGlvbi5ob3N0bmFtZS5pbmRleE9mKCdodWF3ZWljbG91ZC5jb20nKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIFRwRmVlZGJhY2tDb250ZW50Q29tcG9uZW50LmNvbmZpZyA9IFRwRmVlZGJhY2tDb250ZW50Q29tcG9uZW50LnByb2RDb25maWc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nT25Jbml0KCk7XHJcbiAgICAgICAgdGhpcy5zaG93UXVlc3Rpb25zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yid5aeL5YyW5bGV56S66aKY55uuXHJcbiAgICBwcml2YXRlIHNob3dRdWVzdGlvbnMoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgcXVlc3Rpb25BcnJheTogQXJyYXk8VHBRdWVzdGlvbk9wdGlvbj4gPSB0aGlzLm9wdGlvbnMuY3VzdG9tUXVlc3Rpb247XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLmN1c3RvbVF1ZXN0aW9uID0gVXRpbC5pc0FycmF5KHF1ZXN0aW9uQXJyYXkpID8gcXVlc3Rpb25BcnJheSA6IFtdO1xyXG4gICAgICAgIC8vIOmXrumimOeahOS4quaVsOW/hemhu+aYrzPnmoTlgI3mlbBcclxuICAgICAgICBpZiAocXVlc3Rpb25BcnJheSAmJiBxdWVzdGlvbkFycmF5Lmxlbmd0aCAlIDMgIT09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+iHquWumuS5iemimOebrueahOagvOW8j+S4jeespuWQiOinhOiMg++8gScpOyAvLyDkvpvmnI3liqHmn6XnnItcclxuICAgICAgICAgICAgdGhpcy5zaG93aGVhZGVyID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDojrflj5ZGZWVkYmFja+ivjeadoVxyXG4gICAgICAgIGNvbnN0IHRwRmVlZGJhY2s6IGFueSA9IFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBGZWVkYmFjaztcclxuXHJcbiAgICAgICAgLy8g5qih5p2/5Lit5pyA57uI5riy5p+T55qE5pWw5o2uXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5RGF0YSA9IHtcclxuICAgICAgICAgICAgdGl0bGU6IFV0aWwuZm9ybWF0RW50cnkodHBGZWVkYmFjay50aXRsZSwgW3RoaXMub3B0aW9ucy5zZXJ2aWNlTmFtZV0pLFxyXG4gICAgICAgICAgICBzdGFydERlc2M6IHRwRmVlZGJhY2sudGl0bGVfZGVzYyxcclxuICAgICAgICAgICAgcXVlc3Rpb25zOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3JhZGlvJyxcclxuICAgICAgICAgICAgICAgICAgICBzaG93OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFV0aWwuZm9ybWF0RW50cnkodHBGZWVkYmFjay5xdWVzdGlvbjFfdGl0bGUsIFt0aGlzLm9wdGlvbnMuc2VydmljZU5hbWVdKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdtYWluJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHBGZWVkYmFjay5xdWVzdGlvbjFfdGl0bGVfZGVzY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRwRmVlZGJhY2sucXVlc3Rpb24xX3RpdGxlX3VuU2F0aVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNPdGhlclJlYXNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnMxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnMyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnMzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnM0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnM1XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnM2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnM3XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnOCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fdW5TYXRpX29wdGlvbnM4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcsXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHBGZWVkYmFjay5xdWVzdGlvbjFfdGl0bGVfc2F0aVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNPdGhlclJlYXNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fc2F0aV9vcHRpb25zMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJzInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtYXJrOiB0cEZlZWRiYWNrLnF1ZXN0aW9uX3NhdGlfb3B0aW9uczJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICczJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFyazogdHBGZWVkYmFjay5xdWVzdGlvbl9zYXRpX29wdGlvbnMzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fc2F0aV9vcHRpb25zNFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJzUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtYXJrOiB0cEZlZWRiYWNrLnF1ZXN0aW9uX3NhdGlfb3B0aW9uczVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICc2JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFyazogdHBGZWVkYmFjay5xdWVzdGlvbl9zYXRpX29wdGlvbnM2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnNycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcms6IHRwRmVlZGJhY2sucXVlc3Rpb25fc2F0aV9vcHRpb25zN1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJzgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtYXJrOiB0cEZlZWRiYWNrLnF1ZXN0aW9uX3NhdGlfb3B0aW9uczhcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vzc2F5JyxcclxuICAgICAgICAgICAgICAgICAgICBzaG93OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBVdGlsLmZvcm1hdEVudHJ5KFRpTG9jYWxlLmdldExvY2FsZVdvcmRzKCkudHBGZWVkYmFjay5xdWVzdGlvbkxhc3RfdGl0bGUsIFt0aGlzLm9wdGlvbnMuc2VydmljZU5hbWVdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8g55So5oi36Ieq5a6a5LmJ6aKY55uuXHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5hbGxRdWVzdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlEYXRhID0geyAuLi50aGlzLm9wdGlvbnMuYWxsUXVlc3Rpb24gfTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5jdXN0b21RdWVzdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbVF1ZXN0aW9uQ29weTogYW55ID0geyAuLi50aGlzLm9wdGlvbnMuY3VzdG9tUXVlc3Rpb24gfTtcclxuICAgICAgICAgICAgY29uc3Qga2V5czogYW55ID0gT2JqZWN0LmtleXMoY3VzdG9tUXVlc3Rpb25Db3B5KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5RGF0YS5xdWVzdGlvbnMuc3BsaWNlKHRoaXMuZGlzcGxheURhdGEucXVlc3Rpb25zLmxlbmd0aCAtIDEsIDAsIGN1c3RvbVF1ZXN0aW9uQ29weVtrZXldKTsgLy8g6L+U5Zue5L+u5pS55ZCO5pWw57uEXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5xdWVzdGlvbnMgPSB0aGlzLmRpc3BsYXlEYXRhLnF1ZXN0aW9ucztcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IHRoaXMucXVlc3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb25zW2ldLnF1ZXN0aW9uSWQgPSAncXVlc3Rpb25fJyArIGk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uc1tpXS50eXBlID09PSAnY2hlY2tib3gnICYmIHRoaXMucXVlc3Rpb25zW2ldLmhhc090aGVyUmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uc1tpXS5zaG93T3RoZXJSZWFzb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDkuLrmr4/kuKpvdGhlcnJlYXNvbuWIm+W7uuihqOWNlWNvbnRyb2xcclxuICAgICAgICAgICAgICAgIHRoaXMudmFpbGRydWxlc1tgcmVhc29uSW5wdXRfJHtpfWBdID0gbmV3IEZvcm1Db250cm9sKCcnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybSA9IHRoaXMuZmIuZ3JvdXAodGhpcy52YWlsZHJ1bGVzKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOWtmOWCqOmXrumimOetlOahiFxyXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdEFuc3dlcltpXSA9IHtcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uSWQ6IHRoaXMucXVlc3Rpb25zW2ldLnF1ZXN0aW9uSWQsIC8vIOmimOebrklkXHJcbiAgICAgICAgICAgICAgICBzdWJRdWVzdGlvbklkOiBudWxsLCAvLyBOcHPnuqbmnZ/vvIznn6npmLXpopjpnZ5udWxsXHJcbiAgICAgICAgICAgICAgICBzdWJOYW1lOiB0aGlzLnF1ZXN0aW9uc1tpXS50aXRsZVswXS50aXRsZSwgLy8g5Y+q5a2Y5pS+5Li75qCH6aKYXHJcbiAgICAgICAgICAgICAgICBhbnN3ZXI6IFtdLFxyXG4gICAgICAgICAgICAgICAgc3ViUmVtYXJrOiBbXSxcclxuICAgICAgICAgICAgICAgIHJlYXNvbjogJzAnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog5ruh5oSP5bqm6K+E5YiG6Kem5Y+R5LqL5Lu2XHJcbiAgICAgKiBAcGFyYW0gdmFsdWUg6YCJ5oup6K+E5YiG5YC8XHJcbiAgICAgKiBAcGFyYW0gaW5kZXgg6aKY55uu5LiL5qCH5YC8XHJcbiAgICAgKi9cclxuICAgIG9uQ2hhbmdlU2NvcmUodmFsdWU6IG51bWJlciwgaW5kZXg6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIC8vIOWNlemAieeahOWbnuiwg+WHveaVsO+8jOavj+asoemAieaLqemDveimgea4heepuuaVsOe7hFxyXG4gICAgICAgIHRoaXMuc3VibWl0QW5zd2VyW2luZGV4XS5hbnN3ZXIgPSBbXTtcclxuICAgICAgICB0aGlzLnN1Ym1pdEFuc3dlcltpbmRleF0uc3ViUmVtYXJrID0gW107XHJcblxyXG4gICAgICAgIC8vIOWNlemAiemimGFuc3dlcuWSjHJlbWFya+aYr+S/neaMgeS4gOiHtOeahOOAglxyXG4gICAgICAgIHRoaXMuc3VibWl0QW5zd2VyW2luZGV4XS5hbnN3ZXIucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5zdWJtaXRBbnN3ZXJbaW5kZXhdLnN1YlJlbWFyay5wdXNoKHZhbHVlKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog57qm5p2fOlxyXG4gICAgICAgICAqIO+8iDHvvInpopjnm67moLzlvI/vvJropoHmsYLnmoTkuIDkuKrmr43popjpnIDopoHluKbkuKTkuKrlrZDpopjnmoTmoLzlvI9cclxuICAgICAgICAgKiDvvIgy77yJ6aKY55uu6aG65bqP77ya5q+N6aKY77yM56ys5LiA5Liq5a2Q6aKY55uu77yIaW5kZXgrMe+8ie+8jOesrOS6jOS4quWtkOmimChpbmRleCsyKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlmIChpbmRleCAlIDMgPT09IDApIHtcclxuICAgICAgICAgICAgY29uc3QgZmlyc3RJbmRleDogbnVtYmVyID0gaW5kZXggKyAxO1xyXG4gICAgICAgICAgICBjb25zdCBzZWNvbmRJbmRleDogbnVtYmVyID0gaW5kZXggKyAyO1xyXG4gICAgICAgICAgICBjb25zdCBvbGRGaXJzdFNob3c6IGJvb2xlYW4gPSB0aGlzLnF1ZXN0aW9uc1tmaXJzdEluZGV4XS5zaG93O1xyXG4gICAgICAgICAgICBjb25zdCBvbGRTZWNvbmRTaG93OiBib29sZWFuID0gdGhpcy5xdWVzdGlvbnNbc2Vjb25kSW5kZXhdLnNob3c7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uc1tmaXJzdEluZGV4XS5zaG93ID0gdmFsdWUgPD0gNyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbnNbc2Vjb25kSW5kZXhdLnNob3cgPSB2YWx1ZSA+IDcgPyB0cnVlIDogZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog5aSa6YCJ6aKY55uu5LiU5YW25a6D5Y6f5Zug6L6T5YWl5qGG5pi+56S65pe277yM6YeN572u5a+55bqU5o6n5Lu2XHJcbiAgICAgICAgICAgICAqIElF5LiL77yM6L6T5YWl5qGG77yIdGl0ZXh077yMdGl0ZXh0YXJlYe+8iXBsYWNlaG9sZGVy5Li65Lit5paH5pe277yM5Yid5aeL5YyW5pe26KGo5Y2V5o6n5Lu25Lya6KKr5qCH6K6w5Li6ZGlydHnvvIzov5vooYzmoKHpqozvvIxcclxuICAgICAgICAgICAgICog6YCa6L+HbWFya0FzUHJpc3RpbmXmlrnms5XlnKjovpPlhaXmoYbmmL7npLrml7bvvIzlsIbor6XooajljZXmjqfku7bmoIforrDkuLogcHJpc3RpbmXvvIjljp/lp4vnirbmgIHvvInvvIzpnIDov5vooYzlu7bov5/lpITnkIZcclxuICAgICAgICAgICAgICog5YWI5Zyo6K+l57uE5Lu26L+b6KGM5aSE55CG77yM5ZCO57ut5LyY5YyWXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBpZiAodGhpcy5xdWVzdGlvbnNbZmlyc3RJbmRleF0uc2hvdyAhPT0gb2xkRmlyc3RTaG93ICYmIHRoaXMucXVlc3Rpb25zW2ZpcnN0SW5kZXhdLnNob3dPdGhlclJlYXNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKFRpQnJvd3Nlci5pc0lFKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmNvbnRyb2xzW2ByZWFzb25JbnB1dF8ke2ZpcnN0SW5kZXh9YF0ubWFya0FzUHJpc3RpbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5zZXRDb250cm9sKGByZWFzb25JbnB1dF8ke2ZpcnN0SW5kZXh9YCwgbmV3IEZvcm1Db250cm9sKCcnLCBbVGlWYWxpZGF0b3JzLnJlcXVpcmVkLCBUaVZhbGlkYXRvcnMubWF4TGVuZ3RoKDQwMCldKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uc1tzZWNvbmRJbmRleF0uc2hvdyAhPT0gb2xkU2Vjb25kU2hvdyAmJiB0aGlzLnF1ZXN0aW9uc1tzZWNvbmRJbmRleF0uc2hvd090aGVyUmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoVGlCcm93c2VyLmlzSUUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY29udHJvbHNbYHJlYXNvbklucHV0XyR7c2Vjb25kSW5kZXh9YF0ubWFya0FzUHJpc3RpbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5zZXRDb250cm9sKGByZWFzb25JbnB1dF8ke3NlY29uZEluZGV4fWAsIG5ldyBGb3JtQ29udHJvbCgnJywgW1RpVmFsaWRhdG9ycy5yZXF1aXJlZCwgVGlWYWxpZGF0b3JzLm1heExlbmd0aCg0MDApXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnF1ZXN0aW9uc1tpbmRleF0uaGFzZmluc2hlZCA9IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICog6YCJ5Lit6aG56LaF6L+H5LiJ6aG55pe277yM5YW25L2Z6aG55LiN5Y+v6YCJ5Lit77yM5bm26K6+572uXCLmnIDlpJrpgInmi6nkuInpoblcIueahOagt+W8j+OAglxyXG4gICAgICovXHJcbiAgICBvbkNsaWNrSXRlbShldmVudDogRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAvLyBJReS4i+mAieaLqemAiemhueWQjuinpuWPkWNsaWNr5LqL5Lu277yM5Lya5YaS5rOh5Yiw54i257qn6Kem5Y+RaGFsZm1vZGFs54K55Ye75LqL5Lu277yM5a+86Ie05by556qX5YWz6Zet77yM5q2k5aSE6Zi75q2i5LqL5Lu25YaS5rOh77yM6Ziy5q2i5by556qX5YWz6ZetXHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlpI3pgInmoYbpgInkuK3kuovku7bvvIzmnIDlpJrpgInmi6nkuInpoblcclxuICAgICAqIEBwYXJhbSBpdGVtIOWkjemAiemhueaVsOaNrlxyXG4gICAgICogQHBhcmFtIHF1ZXN0aW9uIOmimOebruaVsOaNrlxyXG4gICAgICogQHBhcmFtIGluZGV4IOWkjemAiemhueS4i+agh1xyXG4gICAgICovXHJcbiAgICBvbkNoYW5nZUNoZWNrYm94KGl0ZW06IGFueSwgcXVlc3Rpb246IGFueSwgaW5kZXg6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHF1ZXN0aW9uSW5kZXg6IG51bWJlciA9IHRoaXMuZ2V0SW5kZXhCeVF1ZXN0aW9uSWQocXVlc3Rpb24ucXVlc3Rpb25JZCk7XHJcbiAgICAgICAgY29uc3Qgc3VibWl0UXVlc3Rpb246IGFueSA9IHRoaXMuc3VibWl0QW5zd2VyW3F1ZXN0aW9uSW5kZXhdO1xyXG5cclxuICAgICAgICAvLyDlpLHnhKbmoKHpqozvvIzovpPlhaXkuI3og73kuLrnqbrkuJTlrZfnrKbkuKrmlbDmnIDlpJrkuLo0MDBcclxuICAgICAgICB0aGlzLnZhbGlkYXRpb24gPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdibHVyJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmdldENoZWNrZWROdW1iZXIocXVlc3Rpb24ub3B0aW9ucykgPiAzKSB7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uLmNoZWNrTGltaXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog5q2k5aSE5L2/55So5bu25pe25aSE55CGXHJcbiAgICAgICAgICAgICAqIOWOn+WboO+8muWcqOmAieaLqeesrOWbm+S4qumAiemhueWQju+8jOabtOaUuWNoZWNrZWTlsZ7mgKflgLzkuLpmYWxzZe+8jOS8muWGjeasoeinpuWPkW5nTW9kYWxDaGFuZ2Xkuovku7bvvIzlr7zoh7Tlho3mrKHpgInmi6nml7bvvIzor6XpgInpobnkvJrooqvpgInkuK1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcXVlc3Rpb24uY2hlY2tMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOe6puadn++8muWFtuWug+WOn+WboOaYr+WkmumAiemhueS4reeahOacgOWQjuS4gOmhuVxyXG4gICAgICAgIGlmIChxdWVzdGlvbi5oYXNPdGhlclJlYXNvbiAmJiBpbmRleCA9PT0gcXVlc3Rpb24ub3B0aW9ucy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uLnNob3dPdGhlclJlYXNvbiA9IGl0ZW0uY2hlY2tlZDtcclxuXHJcbiAgICAgICAgICAgIC8vIOWFtuWug+i+k+WFpeahhuaYvuekuua3u+WKoOagoemqjOinhOWImVxyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24uc2hvd090aGVyUmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uc2V0Q29udHJvbChgcmVhc29uSW5wdXRfJHtxdWVzdGlvbkluZGV4fWAsIG5ldyBGb3JtQ29udHJvbCgnJywgW1RpVmFsaWRhdG9ycy5yZXF1aXJlZCwgVGlWYWxpZGF0b3JzLm1heExlbmd0aCg0MDApXSkpO1xyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBJReS4i++8jOi+k+WFpeahhu+8iHRpdGV4dO+8jHRpdGV4dGFyZWHvvIlwbGFjZWhvbGRlcuS4uuS4reaWh+aXtu+8jOWIneWni+WMluaXtuihqOWNleaOp+S7tuS8muiiq+agoemqjO+8jFxyXG4gICAgICAgICAgICAgICAgICog6YCa6L+HbWFya0FzUHJpc3RpbmXmlrnms5XlnKjovpPlhaXmoYbmmL7npLrml7bvvIzlsIbor6XooajljZXmjqfku7bmoIforrDkuLogcHJpc3RpbmXvvIjljp/lp4vnirbmgIHvvInvvIzpnIDov5vooYzlu7bov5/lpITnkIZcclxuICAgICAgICAgICAgICAgICAqIOWFiOWcqOivpee7hOS7tui/m+ihjOWkhOeQhu+8jOWQjue7reS8mOWMllxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBpZiAoVGlCcm93c2VyLmlzSUUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY29udHJvbHNbYHJlYXNvbklucHV0XyR7cXVlc3Rpb25JbmRleH1gXS5tYXJrQXNQcmlzdGluZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3VibWl0UXVlc3Rpb24ucmVhc29uID0gJzAnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb25zW3F1ZXN0aW9uSW5kZXhdLmhhc2ZpbnNoZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBzdWJtaXRRdWVzdGlvbi5hbnN3ZXIucHVzaChpbmRleCk7XHJcbiAgICAgICAgICAgIHN1Ym1pdFF1ZXN0aW9uLnN1YlJlbWFyay5wdXNoKGl0ZW0ucmVtYXJrKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdWJtaXRRdWVzdGlvbi5hbnN3ZXIgPSBzdWJtaXRRdWVzdGlvbi5hbnN3ZXIuZmlsdGVyKChhbnN3ZXI6IGFueSkgPT4gYW5zd2VyICE9PSBpbmRleCk7XHJcbiAgICAgICAgICAgIHN1Ym1pdFF1ZXN0aW9uLnN1YlJlbWFyayA9IHN1Ym1pdFF1ZXN0aW9uLnN1YlJlbWFyay5maWx0ZXIoKHJlbWFyazogYW55KSA9PiByZW1hcmsgIT09IGl0ZW0ucmVtYXJrKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDlpI3pgInpobnkuLrlhbblroPljp/lm6DvvIzlrZjlgqjnlKjmiLfovpPlhaXlhoXlrrlcclxuICAgICAqIEBwYXJhbSBxdWVzdGlvbiDpopjnm67mlbDmja5cclxuICAgICAqL1xyXG4gICAgdXBkYXRlT3RoZXJSZWFzb24ocXVlc3Rpb246IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHF1ZXN0aW9uSW5kZXg6IG51bWJlciA9IHRoaXMuZ2V0SW5kZXhCeVF1ZXN0aW9uSWQocXVlc3Rpb24ucXVlc3Rpb25JZCk7XHJcbiAgICAgICAgdGhpcy5zdWJtaXRBbnN3ZXJbcXVlc3Rpb25JbmRleF0ucmVhc29uID0gdGhpcy5mb3JtLmNvbnRyb2xzW2ByZWFzb25JbnB1dF8ke3F1ZXN0aW9uSW5kZXh9YF0udmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDpopjnm67kuLplc3NheeaXtu+8jOWtmOWCqOeUqOaIt+i+k+WFpeaWh+acrOWfn+WGheWuuVxyXG4gICAgICogQHBhcmFtIHRleHRhcmVhVmFsdWUg5paH5pys5Z+f6L6T5YWl5YaF5a65XHJcbiAgICAgKiBAcGFyYW0gaW5kZXgg6aKY55uu5LiL5qCHXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZVRleHRhcmVhKHRleHRhcmVhVmFsdWU6IG51bWJlciwgaW5kZXg6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc3VibWl0QW5zd2VyW2luZGV4XS5hbnN3ZXJbMF0gPSB0ZXh0YXJlYVZhbHVlO1xyXG4gICAgICAgIHRoaXMuc3VibWl0QW5zd2VyW2luZGV4XS5zdWJSZW1hcmtbMF0gPSAnbnVsbCc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiDmj5DkuqTpl67ljbdcclxuICAgICAqL1xyXG4gICAgb25TdWJtaXQoKTogdm9pZCB7XHJcbiAgICAgICAgQ2ZVdGlsLmdldFVzZXIoKS50aGVuKCh1c2VyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgcm9vdDogYW55ID0gdXNlcjtcclxuICAgICAgICAgICAgY29uc3QgY2FtZWw6IGFueSA9IENmVXRpbC5nZXRIdHRwU2VydmljZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBtc2dTZXJ2aWNlOiBhbnkgPSBDZlV0aWwuZ2V0TWVzc2FnZSgpO1xyXG4gICAgICAgICAgICBpZiAoIWNhbWVsIHx8ICFtc2dTZXJ2aWNlIHx8ICFyb290IHx8ICFVdGlsLmlzRnVuY3Rpb24oY2FtZWwucG9zdCkgfHwgIVV0aWwuaXNGdW5jdGlvbihtc2dTZXJ2aWNlLnNob3dTdWNjZXNzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDpopjnm67mnKrmmL7npLrmiJblhbblroPljp/lm6DkuI3mmL7npLrml7bvvIznp7vpmaTlr7nlupTmjqfku7ZcclxuICAgICAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IHRoaXMucXVlc3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucXVlc3Rpb25zW2ldLnNob3cgfHwgIXRoaXMucXVlc3Rpb25zW2ldLnNob3dPdGhlclJlYXNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5yZW1vdmVDb250cm9sKGByZWFzb25JbnB1dF8ke2l9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwgPSBUaVZhbGlkYXRvcnMuY2hlY2sodGhpcy5mb3JtKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUmVxdWlyZWRDb21wbGV0ZSh0aGlzLnF1ZXN0aW9ucywgdGhpcy5zdWJtaXRBbnN3ZXIpICYmICFlcnJvcnMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpOiBudW1iZXIgPSAwOyBpIDwgdGhpcy5zdWJtaXRBbnN3ZXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdEFuc3dlcltpXS5hbnN3ZXIgPSB0aGlzLnN1Ym1pdEFuc3dlcltpXS5hbnN3ZXIuam9pbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QW5zd2VyW2ldLnN1YlJlbWFyayA9IHRoaXMuc3VibWl0QW5zd2VyW2ldLnN1YlJlbWFyay5qb2luKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXRBbnN3ZXJbaV0uc2hvdyA9IHRoaXMucXVlc3Rpb25zW2ldLnNob3c7IC8vIOi/h+a7pOS4jeaYvuekuueahOmimOebrlxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIOi/h+a7pOacquaYvuekuumimOebruWPiuWIoOmZpHNob3flsZ7mgKfvvIzkuI3pnIDopoHlj5HpgIHnu5nlkI7lj7BcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0QW5zd2VyID0gdGhpcy5zdWJtaXRBbnN3ZXIuZmlsdGVyKChhbnN3ZXI6IGFueSkgPT4gYW5zd2VyLnNob3cgIT09IGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYW5zd2VyIG9mIHRoaXMuc3VibWl0QW5zd2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFuc3dlci5zaG93O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHVybDogc3RyaW5nID0gYCR7VHBGZWVkYmFja0NvbnRlbnRDb21wb25lbnQuY29uZmlnLmJhY2tlbmR9L2FwaS9zYXZlYDtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDlj5HpgIHor7fmsYLvvIzlkJHlkI7lj7Dlj5HpgIHpl67ljbfnu5PmnpxcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbmREYXRhOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdXJ2ZXlJZDogVHBGZWVkYmFja0NvbnRlbnRDb21wb25lbnQuY29uZmlnLnN1cnZleUlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlSWQ6IHRoaXMub3B0aW9ucy5zZXJ2aWNlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHczYWNjb3VudDogcm9vdC5kb21haW5JZCwgLy8g55So5oi3SURcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5zd2VyczogdGhpcy5zdWJtaXRBbnN3ZXJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhbWVsLnBvc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzOiB1cmxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogc2VuZERhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB9LCAoKSA9PiB7IH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0LmVtaXQoKTtcclxuICAgICAgICAgICAgICAgIG1zZ1NlcnZpY2Uuc2hvd1N1Y2Nlc3MoVGlMb2NhbGUuZ2V0TG9jYWxlV29yZHMoKS50cEZlZWRiYWNrLnN1Ym1pdF9zdWNjZXNzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOacquWujOaIkOWImeaYvuekuifpgInmi6nkuI3og73kuLrnqbon5o+Q56S6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrUXVlc3Rpb24odGhpcy5xdWVzdGlvbnMsIHRoaXMuc3VibWl0QW5zd2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmAmui/h+mXrumimElE5b6X5Yiw5bGe5LqO56ys5Yeg6YGT6aKY55uuXHJcbiAgICBwcml2YXRlIGdldEluZGV4QnlRdWVzdGlvbklkKHF1ZXN0aW9uSWQ6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IHRoaXMuc3VibWl0QW5zd2VyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN1Ym1pdEFuc3dlcltpXS5xdWVzdGlvbklkID09PSBxdWVzdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5b6X5Yiw5aSN6YCJ5qGG6YCJ5Lit6aG555qE5Liq5pWwXHJcbiAgICBwcml2YXRlIGdldENoZWNrZWROdW1iZXI6IChpdGVtQXJyYXk6IGFueSkgPT4gbnVtYmVyID0gKGl0ZW1BcnJheTogYW55KSA9PiB7XHJcbiAgICAgICAgbGV0IGNoZWNrZWROdW06IG51bWJlciA9IDA7XHJcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1BcnJheSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjaGVja2VkTnVtKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjaGVja2VkTnVtO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOajgOafpeavj+S4qumimOebrueahOWujOaIkOaDheWGte+8jOi/lOWbnuS4gOS4quaVsOe7hFxyXG4gICAgcHJpdmF0ZSBjaGVja1F1ZXN0aW9uOiAocXVlc3Rpb25BcnJheTogYW55LCBhbnN3ZXJBcnJheTogYW55KSA9PiBhbnkgPSAocXVlc3Rpb25BcnJheTogYW55LCBhbnN3ZXJBcnJheTogYW55KSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0QXJyYXk6IEFycmF5PGJvb2xlYW4+ID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IHF1ZXN0aW9uQXJyYXkubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIOWIpOaWremXrumimOaYr+WQpuW3suato+ehruWhq+WGmS4g77yIMe+8ieW/heWhqyDvvIgy77yJc2hvdz10cnVlICgzKeacieWhq+WGmemXruWNt1xyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb25BcnJheVtpXS5zaG93ID09PSB0cnVlICYmIHF1ZXN0aW9uQXJyYXlbaV0ucmVxdWlyZSA9PT0gdHJ1ZSAmJiBhbnN3ZXJBcnJheVtpXS5hbnN3ZXIubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVzdGlvbkFycmF5W2ldLmhhc2ZpbnNoZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5W2ldID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRBcnJheTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8g6aKY55uu5piv5ZCm5bey5a6M5oiQXHJcbiAgICBwcml2YXRlIGlzUmVxdWlyZWRDb21wbGV0ZShxdWVzdGlvbkFycmF5OiBhbnksIGFuc3dlckFycmF5OiBhbnkpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCByZXN1bHRBcnJheTogYW55ID0gdGhpcy5jaGVja1F1ZXN0aW9uKHF1ZXN0aW9uQXJyYXksIGFuc3dlckFycmF5KTtcclxuICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRBcnJheSkge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19