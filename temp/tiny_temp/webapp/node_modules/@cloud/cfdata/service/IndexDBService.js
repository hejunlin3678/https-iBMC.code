"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.cfApiCacheCtrl = void 0;
var StorageService_1 = require("./StorageService");
var PromisificationError = /** @class */ (function (_super) {
    __extends(PromisificationError, _super);
    function PromisificationError(message) {
        var _this = _super.call(this, message) || this;
        _this.name = 'PromisificationError';
        return _this;
    }
    return PromisificationError;
}(Error));
if (!window.cfDataIndexedDBS) {
    window.cfDataIndexedDBS = {};
}
var cfIndexedDBservice = {
    /*
        @params {string} dbName 要连接的数据库名
        @params {string} dbVersion 要连接的数据库版本号
        @params {{name:option{keyPath,autoIncrement}} 数据对象信息
        @return {Promise.resolve(IDBDatabase)/Promise.reject()} 连接成功返回该库的操作实例IDBDatabase实例对象
    */
    openDB: function (dbName, dbVersion, stores) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var indexedDB = _this._checkedIDBSupport();
            if (!indexedDB) {
                reject(new PromisificationError('checkedIDBSupport false'));
                return;
            }
            if (!window.cfDataIndexedDBS[dbName] || dbVersion) {
                dbVersion = dbVersion || 1;
                var cfCacheDB_1 = indexedDB.open(dbName, dbVersion);
                cfCacheDB_1.onupgradeneeded = function () {
                    // 如果客户端没有数据库则触发
                    // ...执行初始化...
                    var db = cfCacheDB_1.result;
                    var keys = Object.keys(stores);
                    keys.forEach(function (item) {
                        if (db.objectStoreNames.contains(item)) {
                            db.deleteObjectStore(item);
                        }
                        db.createObjectStore(item, stores[item]);
                    });
                };
                cfCacheDB_1.onsuccess = function () {
                    window.cfDataIndexedDBS[dbName] = cfCacheDB_1.result;
                    resolve(window.cfDataIndexedDBS[dbName]);
                };
                cfCacheDB_1.onerror = function () {
                    reject(new PromisificationError('open cfIndexedDB error'));
                };
            }
            else {
                resolve(window.cfDataIndexedDBS[dbName]);
            }
        });
    },
    /*
        @params {string} dbName 要连接的数据库名
        @params {obj} datas 要存储的数据对象，键是表名，数据是存往该表的数据集
        @return {Promise.resolve(datas)/Promise.reject()} 连接成功返回所存的数据对象
    */
    setData: function (dbName, datas) {
        return new Promise(function (resolve, reject) {
            if (window.cfDataIndexedDBS[dbName].objectStoreNames.length > 0) {
                var stores = Object.keys(datas);
                var transaction_1 = window.cfDataIndexedDBS[dbName].transaction(stores[0], 'readwrite');
                stores.forEach(function (store) {
                    var cfCacheWrite = transaction_1.objectStore(store);
                    datas[store].forEach(function (item) {
                        cfCacheWrite.put(item); // 键相同则替换之
                    });
                });
                transaction_1.oncomplete = function () {
                    resolve(datas);
                };
                transaction_1.onerror = function (_err) {
                    reject(new PromisificationError('transaction setData error'));
                };
            }
        });
    },
    /*
        @params {string} dbName 要连接的数据库名
        @params {string} store 数据所在的表
        @params {string} key 键
        @return {Promise.resolve(data)/Promise.reject()} 所查的数据
    */
    getDataByKey: function (dbName, store, key) {
        return new Promise(function (resolve, reject) {
            if (window.cfDataIndexedDBS[dbName]) {
                var data_1 = window.cfDataIndexedDBS[dbName]
                    .transaction(store, 'readonly')
                    .objectStore(store)
                    .get(key);
                data_1.onsuccess = function () {
                    if (data_1.result) {
                        resolve(data_1.result);
                    }
                    else {
                        reject(new PromisificationError('transaction getData error'));
                    }
                };
                data_1.onerror = function () {
                    reject(new PromisificationError('transaction getData error'));
                };
            }
            else {
                reject(new PromisificationError('cfIndexedDB instance not exist'));
            }
        });
    },
    // indexedDB 兼容性检测
    _checkedIDBSupport: function () {
        var indexedDB = window.indexedDB ||
            window.mozIndexedDB ||
            window.webkitIndexedDB ||
            window.msIndexedDB ||
            false;
        return indexedDB;
    },
};
// cfApiCacheStore cfCacheDB
exports.cfApiCacheCtrl = {
    cfIndexedDBservice: cfIndexedDBservice,
    isSupportIDB: true,
    dbname: 'cfCacheDB',
    store: 'cfApiCacheStore',
    toFetchList: [],
    initCFCache: function (dbname, version, stores) {
        var _this = this;
        // 获取缓存indexedDB操作对象，和缓存时间表
        return new Promise(function (resolve) {
            _this.dbname = dbname;
            _this.cfIndexedDBservice
                .openDB(dbname, version, stores)
                .then(function (_result) {
                resolve(_this.isSupportIDB);
            })
                .catch(function (_err) {
                _this.isSupportIDB = false;
                resolve(_this.isSupportIDB);
            });
        });
    },
    setCache: function (realKey, data, cacheConfig) {
        var _this = this;
        var store = cacheConfig.store || this.store;
        var dbname = cacheConfig.dbname || this.dbname;
        var cacheTimeout = cacheConfig.cacheTimeout || 3600;
        var cacheVersion = cacheConfig.cacheVersion || 'cfdata-default';
        var initConfig = {
            store: store,
            dbname: dbname,
            cacheTimeout: cacheTimeout,
            cacheVersion: cacheVersion,
        };
        var datas = {};
        datas[initConfig.store] = [
            {
                key: realKey,
                value: data,
                cacheDeadTime: Date.now() + initConfig.cacheTimeout * 1000,
                cacheVersion: initConfig.cacheVersion,
            },
        ];
        if (realKey === 'cf_regions_zh-cn' || realKey === 'cf_regions_en-us') {
            var data_2 = datas[initConfig.store][0].value;
            StorageService_1.StorageService.setLocalStorage(realKey, data_2, initConfig.cacheTimeout, cacheVersion);
        }
        return new Promise(function (resolve) {
            _this.cfIndexedDBservice
                .setData(initConfig.dbname, datas)
                .then(function (data) {
                resolve(data);
            })
                .catch(function () {
                var data = datas[initConfig.store][0].value;
                StorageService_1.StorageService.setLocalStorage(realKey, data, initConfig.cacheTimeout);
                resolve(data);
            });
        });
    },
    // 超时数据如果是缓存优先读取,则返回null,如果是容灾场景则返回
    getCache: function (key, cacheVersion, store, dbname, isErr) {
        var _this = this;
        if (store === void 0) { store = this.store; }
        if (dbname === void 0) { dbname = this.dbname; }
        if (isErr === void 0) { isErr = false; }
        cacheVersion = cacheVersion || 'cfdata-default';
        return new Promise(function (resolve) {
            _this.cfIndexedDBservice
                .getDataByKey(dbname, store, key)
                .then(function (result) {
                var data;
                if (result) {
                    if (isErr || (result.cacheVersion === cacheVersion && Date.now() < result.cacheDeadTime)) {
                        data = result.value;
                        resolve(data);
                    }
                    else {
                        resolve(null);
                    }
                }
                else {
                    data = StorageService_1.StorageService.getLocalStorage(key, isErr, cacheVersion);
                    resolve(data);
                }
            })
                .catch(function () {
                var data = StorageService_1.StorageService.getLocalStorage(key, isErr, cacheVersion);
                resolve(data);
            });
        });
    },
    cfCacheApiPromise: function (promise, realKey, cacheConfig) {
        var _this = this;
        var store = cacheConfig.store || this.store;
        var dbname = cacheConfig.dbname || this.dbname;
        var cacheTimeout = cacheConfig.cacheTimeout || 3600;
        var cacheVersion = cacheConfig.cacheVersion || 'cfdata-default';
        var initConfig = {
            store: store,
            dbname: dbname,
            cacheTimeout: cacheTimeout,
            cacheVersion: cacheVersion,
        };
        return new Promise(function (resolve, reject) {
            promise
                .then(function (data) {
                if (!cacheConfig.noCache) {
                    // 如果是缓存优先，则此处data本身就为缓存数据，无需再次缓存
                    _this.setCache(realKey, data, initConfig);
                }
                resolve(data);
            })
                .catch(function () {
                _this.getCache(realKey, cacheVersion, store, dbname, true).then(function (data) {
                    if (data) {
                        resolve(data);
                    }
                    else {
                        reject(new PromisificationError('no cache data'));
                    }
                });
            });
        });
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW5kZXhEQlNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2VydmljZS9JbmRleERCU2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsbURBQWtEO0FBRWxEO0lBQW1DLHdDQUFLO0lBQ3BDLDhCQUFZLE9BQU87UUFBbkIsWUFDSSxrQkFBTSxPQUFPLENBQUMsU0FFakI7UUFERyxLQUFJLENBQUMsSUFBSSxHQUFHLHNCQUFzQixDQUFDOztJQUN2QyxDQUFDO0lBQ0wsMkJBQUM7QUFBRCxDQUFDLEFBTEQsQ0FBbUMsS0FBSyxHQUt2QztBQUVELElBQUksQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUU7SUFDMUIsTUFBTSxDQUFDLGdCQUFnQixHQUFHLEVBQUUsQ0FBQztDQUNoQztBQUVELElBQUksa0JBQWtCLEdBQUc7SUFDckI7Ozs7O01BS0U7SUFDRixNQUFNLEVBQU4sVUFBTyxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU07UUFBaEMsaUJBaUNDO1FBaENHLE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBQyxPQUFPLEVBQUUsTUFBTTtZQUMvQixJQUFJLFNBQVMsR0FBRyxLQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUMxQyxJQUFJLENBQUMsU0FBUyxFQUFFO2dCQUNaLE1BQU0sQ0FBQyxJQUFJLG9CQUFvQixDQUFDLHlCQUF5QixDQUFDLENBQUMsQ0FBQztnQkFDNUQsT0FBTzthQUNWO1lBQ0QsSUFBSSxDQUFFLE1BQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxTQUFTLEVBQUU7Z0JBQ3hELFNBQVMsR0FBRyxTQUFTLElBQUksQ0FBQyxDQUFDO2dCQUMzQixJQUFJLFdBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztnQkFDbEQsV0FBUyxDQUFDLGVBQWUsR0FBRztvQkFDeEIsZ0JBQWdCO29CQUNoQixj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